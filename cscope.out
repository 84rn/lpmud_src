cscope 15 $HOME/Projects/mud/src               0001123755
	@alloca.c

2 
	~<°dio.h
>

31 #i‚de‡
löt


32 
	gSCCSid
[] = "@(#)alloca.c 1.1";

35 
	#NULL
 0

	)

37 
‰ì
();

38 *
mÆloc
();

50 #i‚de‡
STACK_DIRECTION


51 
	#STACK_DIRECTION
 0

	)

54 #i‡
STACK_DIRECTION
 != 0

56 
	#STACK_DIR
 
STACK_DIRECTION


	)

60 
	g°ack_dú
;

61 
	#STACK_DIR
 
°ack_dú


	)

64 
	$föd_°ack_dúe˘i⁄
 ( )

66 *
addr
 = 
NULL
;

68 autÿ
dummy
;

70 i‡(
addr
 =
NULL
)

72 
addr
 = &
dummy
;

73 
	`föd_°ack_dúe˘i⁄
 ();

76 i‡(&
dummy
 > 
addr
)

77 
°ack_dú
 = 1;

79 
°ack_dú
 = -1;

80 
	}
}

93 #i‚def 
ALIGN_SIZE


94 
	#ALIGN_SIZE
 ()

	)

97 
	uhdr


99 
	mÆign
[
ALIGN_SIZE
];

102 
hdr
 *
	m√xt
;

103 *
	mdìp
;

104 } 
	mh
;

105 } 
	thódî
;

116 
hódî
 *
	gœ°_Æloˇ_hódî
 = 
NULL
;

119 
	$Æloˇ
 (
size
)

122 autÿ
¥obe
;

123 *
dïth
 = &
¥obe
;

125 #i‡
STACK_DIRECTION
 == 0

126 i‡(
STACK_DIR
 == 0)

127 
	`föd_°ack_dúe˘i⁄
 ();

134 
hódî
 *
hp
;

136 
hp
 = 
œ°_Æloˇ_hódî
; h∞!
NULL
;)

137 i‡(
STACK_DIR
 > 0 && 
hp
->
h
.
dìp
 > 
dïth


138 || 
STACK_DIR
 < 0 && 
hp
->
h
.
dìp
 < 
dïth
)

140 
hódî
 *
≈
 = 
hp
->
h
.
√xt
;

142 
	`‰ì
 ((*Ë
hp
);

144 
hp
 = 
≈
;

149 
œ°_Æloˇ_hódî
 = 
hp
;

152 i‡(
size
 == 0)

153  
NULL
;

158 *
√w
 = 
	`mÆloc
 ( (
hódî
Ë+ 
size
);

160 i‡(!
√w
Ë{ ()
	`Ârötf
(
°dîr
,"Æloˇ: faûed!");  
NULL
; }

162 ((
hódî
 *)
√w
)->
h
.
√xt
 = 
œ°_Æloˇ_hódî
;

163 ((
hódî
 *)
√w
)->
h
.
dìp
 = 
dïth
;

165 
œ°_Æloˇ_hódî
 = (
hódî
 *)
√w
;

169  (*)((*)
√w
 + (
hódî
));

171 
	}
}

	@alloca.h

1 *
Æloˇ
();

	@array.c

1 
	~<°rög.h
>

2 
	~<°dio.h
>

3 
	~<°dlib.h
>

4 #i‡
deföed
(
sun
Ë|| deföed(
__osf__
)

5 
	~<Æloˇ.h
>

8 
	~"c⁄fig.h
"

9 
	~"löt.h
"

10 
	~"m°rög.h
"

11 
	~"öãΩªt.h
"

12 
	~"obje˘.h
"

13 
	~"ªgexp.h
"

14 
	~"m≠pög.h
"

15 
	~"exec.h
"

16 
	~"maö.h
"

17 
	~"simuœã.h
"

19 
	~"ölöe_eqs.h
"

20 
	~"ölöe_svÆue.h
"

22 
svÆue
 *
•
;

29 
d_Êag
;

31 
	gnum_¨øys
;

32 
	gtŸÆ_¨øy_size
;

38 
ve˘‹
 
	gnuŒ_ve˘‹
 = {

46 
ve˘‹
 *

47 
	$Æloˇã_¨øy
(
n
)

49 
i
;

50 
ve˘‹
 *
p
;

52 i‡(
n
 < 0 ||Ç > 
MAX_ARRAY_SIZE
)

53 
	`îr‹
("Illegalárray size.\n");

54 i‡(
n
 == 0) {

55 
p
 = &
nuŒ_ve˘‹
;

56 
	`INCREF
(
p
->
ªf
);

57  
p
;

59 
num_¨øys
++;

60 
tŸÆ_¨øy_size
 + (
ve˘‹
Ë+  (
svÆue
) *

61 (
n
-1);

62 
p
 = 
	`ALLOC_VECTOR
(
n
);

63 
p
->
ªf
 = 1;

64 
p
->
size
 = 
n
;

65 
i
=0; i<
n
; i++)

66 
p
->
ôem
[
i
] = 
c⁄°0
;

67  
p
;

68 
	}
}

71 
	$‰ì_ve˘‹
(
ve˘‹
 *
p
)

73 
i
;

74 i‡(!
p
->
ªf
 || --p->ref > 0)

77 i‡(
p
->
ªf
 < 0) {

78 
	`debug_mesßge
("ArrayÑeference count < 0 in free_vector.\n");

82 #i‡
	`deföed
(
DEBUG
)

83 i‡(
p
 =&
nuŒ_ve˘‹
)

85 
p
->
ªf
 = 1;

86 
	`debug_mesßge
("TriedÅo freeÅhe zero-size shared vector.\n");

90 
i
 = 0; i < 
p
->
size
; i++)

91 
	`‰ì_svÆue
(&
p
->
ôem
[
i
]);

92 
num_¨øys
--;

93 
tŸÆ_¨øy_size
 - (
ve˘‹
Ë+  (
svÆue
) *

94 (
p
->
size
-1);

95 
	`‰ì
((*)
p
);

96 
	}
}

98 
ve˘‹
 *

99 
	$ex∂ode_°rög
(*
°r
, *
dñ
)

101 *
p
, *
beg
;

102 
num
, 
exåa
;

103 
ve˘‹
 *
ªt
;

104 
size_t
 
Àn
;

105 *
buff
;

107 
Àn
 = 
	`°æí
(
dñ
);

113 i‡(
Àn
 == 0)

115 
Àn
 = 
	`°æí
(
°r
);

116 
ªt
 = 
	`Æloˇã_¨øy
(()
Àn
);

117 
num
 = 0;Çum < 
Àn
;Çum++)

119 
ªt
->
ôem
[
num
].
ty≥
 = 
T_STRING
;

120 
ªt
->
ôem
[
num
].
°rög_ty≥
 = 
STRING_MSTRING
;

121 
ªt
->
ôem
[
num
].
u
.
°rög
 = 
	`Æloˇã_m°rög
(1);

122 
ªt
->
ôem
[
num
].
u
.
°rög
[0] = 
°r
[num];

123 
ªt
->
ôem
[
num
].
u
.
°rög
[1] = '\0';

125  
ªt
;

128 i‡(!*
°r
)

129  
	`Æloˇã_¨øy
(0);

131 #ifde‡
OLD_EXPLODE


135 
	`°∫cmp
(
°r
, 
dñ
, 
Àn
) == 0)

137 
°r
 +
Àn
;

138 i‡(
°r
[0] == '\0')

139  
	`Æloˇã_¨øy
(0);

145 
exåa
 = 1;

146 
num
 = 0;

147 
p
 = 
°r
; *p;)

149 i‡(
	`°∫cmp
(
p
, 
dñ
, 
Àn
) == 0)

151 
num
++;

152 
p
 +
Àn
;

153 
exåa
 = 0;

157 
p
 += 1;

158 
exåa
 = 1;

165 i‡(
exåa
)

166 
num
++;

167 
buff
 = 
	`Æloˇ
(
	`°æí
(
°r
) + 1);

168 
ªt
 = 
	`Æloˇã_¨øy
(
num
);

169 
beg
 = 
°r
;

170 
num
 = 0;

171 
p
 = 
°r
; *p; )

173 i‡(
	`°∫cmp
(
p
, 
dñ
, 
Àn
) == 0)

175 ()
	`°∫˝y
(
buff
, 
beg
, (
size_t
)(
p
 - beg));

176 
buff
[
p
-
beg
] = '\0';

177 i‡(
num
 >
ªt
->
size
)

178 
	`Áèl
("Too big index inÉxplode !\n");

180 
ªt
->
ôem
[
num
].
ty≥
 = 
T_STRING
;

181 
ªt
->
ôem
[
num
].
°rög_ty≥
 = 
STRING_MSTRING
;

182 
ªt
->
ôem
[
num
].
u
.
°rög
 = 
	`make_m°rög
(
buff
);

183 
num
++;

184 
beg
 = 
p
 + 
Àn
;

185 
p
 = 
beg
;

189 
p
 += 1;

193 i‡(*
beg
 != '\0') {

195 i‡(
num
 >
ªt
->
size
)

196 
	`Áèl
("Too big index inÉxplode !\n");

197 
ªt
->
ôem
[
num
].
ty≥
 = 
T_STRING
;

198 
ªt
->
ôem
[
num
].
°rög_ty≥
 = 
STRING_MSTRING
;

199 
ªt
->
ôem
[
num
].
u
.
°rög
 = 
	`make_m°rög
(
beg
);

201  
ªt
;

202 
	}
}

205 
	$im∂ode_°rög
(
ve˘‹
 *
¨r
, *
dñ
)

207 
size_t
 
size
, 
Àn
;

208 
i
, 
num
;

209 *
p
, *
q
;

211 
size
 = 0;

212 
num
 = 0;

213 
i
=0; i < 
¨r
->
size
; i++)

215 i‡(
¨r
->
ôem
[
i
].
ty≥
 =
T_STRING
)

217 
size
 +
	`°æí
(
¨r
->
ôem
[
i
].
u
.
°rög
);

218 
num
++;

221 i‡(
num
 == 0)

222  
	`°rög_c›y
("");

223 
Àn
 = 
	`°æí
(
dñ
);

224 
p
 = 
	`xÆloc
(
size
 + (
num
-1Ë* 
Àn
 + 1);

225 
q
 = 
p
;

226 
p
[0] = '\0';

227 
size
 = 0;

228 
num
 = 0;

229 
i
 = 0; i < 
¨r
->
size
; i++)

231 i‡(
¨r
->
ôem
[
i
].
ty≥
 =
T_STRING
)

233 i‡(
num
 > 0)

235 ()
	`°r˝y
(
p
, 
dñ
);

236 
p
 +
Àn
;

238 ()
	`°r˝y
(
p
, 
¨r
->
ôem
[
i
].
u
.
°rög
);

239 
p
 +
	`°æí
(
¨r
->
ôem
[
i
].
u
.
°rög
);

240 
num
++;

243  
q
;

244 
	}
}

246 
ve˘‹
 *

247 
	$u£rs
()

249 
num_∂ayî
;

250 
i
;

251 
ve˘‹
 *
ªt
;

253 i‡(!
num_∂ayî
)

254  
	`Æloˇã_¨øy
(0);

256 
ªt
 = 
	`Æloˇã_¨øy
(
num_∂ayî
);

257 
i
 = 0; i < 
num_∂ayî
; i++) {

258 
ªt
->
ôem
[
i
].
ty≥
 = 
T_OBJECT
;

259 
	`add_ªf
(
ªt
->
ôem
[
i
].
u
.
ob
 = 
	`gë_öãø˘ive_obje˘
(i),"users");

261  
ªt
;

262 
	}
}

267 
ve˘‹
 *

268 
	$¶i˚_¨øy
(
ve˘‹
 *
p
, 
‰om
, 
to
)

270 
ve˘‹
 *
d
;

271 
˙t
;

273 i‡(
‰om
 < 0)

274 
‰om
 = 
p
->
size
 + from;

275 i‡(
‰om
 < 0)

276 
‰om
 = 0;

277 i‡(
‰om
 >
p
->
size
)

278  
	`Æloˇã_¨øy
(0);

279 i‡(
to
 < 0)

280 
to
 = 
p
->
size
 +Åo;

281 i‡(
to
 >
p
->
size
)

282 
to
 = 
p
->
size
 - 1;

283 i‡(
to
 < 
‰om
)

284  
	`Æloˇã_¨øy
(0);

286 
d
 = 
	`Æloˇã_¨øy
(
to
 - 
‰om
 + 1);

287 
˙t
 = 
‰om
; c¡ <
to
; cnt++)

288 
	`assign_svÆue_no_‰ì
 (&
d
->
ôem
[
˙t
 - 
‰om
], &
p
->item[cnt]);

290  
d
;

291 
	}
}

299 
ve˘‹
 *

300 
	$fûãr_¨r
(
ve˘‹
 *
p
, 
˛osuª
 *
fun
)

302 
ve˘‹
 *
r
;

303 *
Êags
;

304 
˙t
,
ªs
;

306 i‡(
p
->
size
<1)

307  
	`Æloˇã_¨øy
(0);

309 
ªs
 = 0;

310 
Êags
 = 
	`tm∑Œoc
((
size_t
)
p
->
size
 + 1);

311 
˙t
 = 0; c¡ < 
p
->
size
; cnt++) {

312 
	`push_svÆue
(&
p
->
ôem
[
˙t
]);

313 ()
	`ˇŒ_v¨
(1, 
fun
);

314 i‡(
•
->
ty≥
 =
T_NUMBER
 && sp->
u
.
numbî
) {

315 
Êags
[
˙t
] = 1;

316 
ªs
++;

318 
Êags
[
˙t
] = 0;

319 
	`p›_°ack
();

321 
r
 = 
	`Æloˇã_¨øy
(
ªs
);

322 
˙t
 = 
ªs
 = 0;Ñe†< 
r
->
size
 && c¡ < 
p
->size; cnt++) {

323 i‡(
Êags
[
˙t
])

324 
	`assign_svÆue_no_‰ì
(&
r
->
ôem
[
ªs
++], &
p
->ôem[
˙t
]);

327  
r
;

328 
	}
}

352 
	sunique


354 
	mcou¡
;

355 
svÆue
 *
	mvÆ
;

356 
svÆue
 
	mm¨k
;

357 
unique
 *
	mßme
;

358 
unique
 *
	m√xt
;

362 
	$put_ö
(
unique
 **
uli°
, 
svÆue
 *
m¨kî
, svÆuê*
ñem
)

364 
unique
 *
Œök
, *
¶ök
, *
éök
;

365 
˙t
,
fixed
;

367 
Œök
 = *
uli°
;

368 
˙t
 = 0; 
fixed
 = 0;

369 
Œök
)

371 i‡((!
fixed
Ë&& (
	`equÆ_svÆue
(
m¨kî
, &(
Œök
->
m¨k
))))

373 
éök
 = 
Œök
;Ålök->
ßme
;Ålink =Ålink->same)

374 (
éök
->
cou¡
)++;

375 (
éök
->
cou¡
)++;

376 
¶ök
 = (
unique
 *Ë
	`tm∑Œoc
((unique));

377 
¶ök
->
cou¡
 = 1;

378 
	`assign_svÆue_no_‰ì
(&
¶ök
->
m¨k
, 
m¨kî
);

379 
¶ök
->
vÆ
 = 
ñem
;

380 
¶ök
->
ßme
 = 0;

381 
¶ök
->
√xt
 = 0;

382 
éök
->
ßme
 = 
¶ök
;

383 
fixed
 = 1;

385 
Œök
 =Ülök->
√xt
;

386 
˙t
++;

388 i‡(
fixed
)

389  
˙t
;

390 
Œök
 = (
unique
 *Ë
	`tm∑Œoc
((unique));

391 
Œök
->
cou¡
 = 1;

392 
	`assign_svÆue_no_‰ì
(&
Œök
->
m¨k
, 
m¨kî
);

393 
Œök
->
vÆ
 = 
ñem
;

394 
Œök
->
ßme
 = 0;

395 
Œök
->
√xt
 = *
uli°
;

396 *
uli°
 = 
Œök
;

397  
˙t
 + 1;

398 
	}
}

401 
ve˘‹
 *

402 
	$make_unique
(
ve˘‹
 *
¨r
, *
func
, 
svÆue
 *
skùnum
)

404 
svÆue
 *
v
;

405 
ve˘‹
 *
ªs
, *
ªt
;

406 
unique
 *
hód
, *
nxt
, *
nxt2
;

408 
˙t
, 
™t
, 
˙t2
;

410 i‡(
¨r
->
size
 < 1)

411  
	`Æloˇã_¨øy
(0);

413 
hód
 = 0;

414 
™t
 = 0;

415 
	`INCREF
(
¨r
->
ªf
);

416 
˙t
 = 0; c¡ < 
¨r
->
size
; cnt++)

418 i‡(
¨r
->
ôem
[
˙t
].
ty≥
 =
T_OBJECT
)

420 
v
 = 
	`≠∂y
(
func
, 
¨r
->
ôem
[
˙t
].
u
.
ob
, 0, 1);

421 i‡((!
v
Ë|| (v->
ty≥
 !
skùnum
->ty≥Ë|| !
	`equÆ_svÆue
(v, skipnum))

422 i‡(
v
)

423 
™t
 = 
	`put_ö
(&
hód
, 
v
, &(
¨r
->
ôem
[
˙t
]));

426 
	`DECREF
(
¨r
->
ªf
);

427 
ªt
 = 
	`Æloˇã_¨øy
(
™t
);

429 
˙t
 = 
™t
 - 1; cnt >= 0; cnt--)

431 
ªt
->
ôem
[
˙t
].
ty≥
 = 
T_POINTER
;

432 
ªt
->
ôem
[
˙t
].
u
.
vec
 = 
ªs
 = 
	`Æloˇã_¨øy
(
hód
->
cou¡
);

433 
nxt2
 = 
hód
;

434 
hód
 = hód->
√xt
;

435 
˙t2
 = 0;

436 
nxt2
)

438 
	`assign_svÆue_no_‰ì
 (&
ªs
->
ôem
[
˙t2
++], 
nxt2
->
vÆ
);

439 
	`‰ì_svÆue
(&
nxt2
->
m¨k
);

440 
nxt
 = 
nxt2
->
ßme
;

442 
nxt2
 = 
nxt
;

444 i‡(!
hód
)

447  
ªt
;

448 
	}
}

457 
ve˘‹
 *

458 
	$add_¨øy
(
ve˘‹
 *
p
, ve˘‹ *
r
)

460 
˙t
,
ªs
;

461 
ve˘‹
 *
d
;

463 
d
 = 
	`Æloˇã_¨øy
(
p
->
size
 + 
r
->size);

464 
ªs
 = 0;

465 
˙t
 = 0; c¡ < 
p
->
size
; cnt++)

467 
	`assign_svÆue_no_‰ì
 (&
d
->
ôem
[
ªs
],&
p
->ôem[
˙t
]);

468 
ªs
++;

470 
˙t
 = 0; c¡ < 
r
->
size
; cnt++)

472 
	`assign_svÆue_no_‰ì
 (&
d
->
ôem
[
ªs
],&
r
->ôem[
˙t
]);

473 
ªs
++;

475  
d
;

476 
	}
}

481 
ve˘‹
 *

482 
	$Æl_övít‹y
(
obje˘
 *
ob
)

484 
ve˘‹
 *
d
;

485 
obje˘
 *
cur
;

486 
˙t
,
ªs
;

488 
˙t
 = 0;

489 
cur
 = 
ob
->
c⁄èös
; cur; cu∏cur->
√xt_öv
)

490 
˙t
++;

492 i‡(!
˙t
)

493  
	`Æloˇã_¨øy
(0);

495 
d
 = 
	`Æloˇã_¨øy
(
˙t
);

496 
cur
 = 
ob
->
c⁄èös
;

498 
ªs
 = 0;Ñe†< 
˙t
;Ñes++)

500 
d
->
ôem
[
ªs
].
ty≥
 = 
T_OBJECT
;

501 
d
->
ôem
[
ªs
].
u
.
ob
 = 
cur
;

502 
	`add_ªf
(
cur
, "all_inventory");

503 
cur
 = cur->
√xt_öv
;

505  
d
;

506 
	}
}

512 
ve˘‹
 *

513 
	$m≠_¨øy
 (
ve˘‹
 *
¨r
, 
˛osuª
 *
fun
)

515 
ve˘‹
 *
r
;

516 
˙t
;

518 
r
 = 
	`Æloˇã_¨øy
(
¨r
->
size
);

519 
	`push_ve˘‹
(
r
, 0);

520 
˙t
 = 0; c¡ < 
¨r
->
size
; cnt++) {

521 
	`push_svÆue
(&
¨r
->
ôem
[
˙t
]);

522 ()
	`ˇŒ_v¨
(1, 
fun
);

523 
r
->
ôem
[
˙t
] = *
•
;

524 
•
--;

526 
•
--;

527  
r
;

528 
	}
}

538 
ve˘‹
 *

539 
	$dìp_övít‹y
(
obje˘
 *
ob
, 
èke_t›
)

541 
ve˘‹
 *
döv
, *
aöv
, *
söv
, *
töv
;

542 
û
;

544 
aöv
 = 
	`Æl_övít‹y
(
ob
);

545 i‡(
èke_t›
)

547 
söv
 = 
	`Æloˇã_¨øy
(1);

548 
söv
->
ôem
[0].
ty≥
 = 
T_OBJECT
;

549 
	`add_ªf
(
ob
,"deep_inventory");

550 
söv
->
ôem
[0].
u
.
ob
 = ob;

551 
döv
 = 
	`add_¨øy
(
söv
, 
aöv
);

552 
	`‰ì_ve˘‹
(
söv
);

553 
	`‰ì_ve˘‹
(
aöv
);

554 
aöv
 = 
döv
;

556 
söv
 = 
aöv
;

557 
û
 = 
èke_t›
 ? 1 : 0 ; i»< 
aöv
->
size
 ; il++)

559 i‡(
aöv
->
ôem
[
û
].
u
.
ob
->
c⁄èös
)

561 
döv
 = 
	`dìp_övít‹y
(
aöv
->
ôem
[
û
].
u
.
ob
,0);

562 
töv
 = 
	`add_¨øy
(
söv
, 
döv
);

563 i‡(
söv
 !
aöv
)

564 
	`‰ì_ve˘‹
(
söv
);

565 
söv
 = 
töv
;

566 
	`‰ì_ve˘‹
(
döv
);

569 i‡(
aöv
 !
söv
)

570 
	`‰ì_ve˘‹
(
aöv
);

571  
söv
;

572 
	}
}

574 
ve˘‹
 *

575 
	$m©ch_ªgexp
(
ve˘‹
 *
v
, *
∑âîn
)

577 
ªgexp
 *
ªg
;

578 *
ªs
;

579 
i
, 
num_m©ch
;

580 
ve˘‹
 *
ªt
;

581 
evÆ_co°
;

583 i‡(
v
->
size
 == 0)

584  
	`Æloˇã_¨øy
(0);

585 
ªg
 = 
	`ªgcomp
(
∑âîn
, 0);

586 i‡(
ªg
 == 0)

588 
ªs
 = (*)
	`Æloˇ
((
size_t
)
v
->
size
);

589 
num_m©ch
=
i
=0; i < 
v
->
size
; i++)

591 
ªs
[
i
] = 0;

592 i‡(
v
->
ôem
[
i
].
ty≥
 !
T_STRING
)

594 
evÆ_co°
++;

595 i‡(
	`ªgexec
(
ªg
, 
v
->
ôem
[
i
].
u
.
°rög
) == 0)

597 
ªs
[
i
] = 1;

598 
num_m©ch
++;

600 
ªt
 = 
	`Æloˇã_¨øy
(
num_m©ch
);

601 
num_m©ch
=
i
=0; i < 
v
->
size
; i++)

603 i‡(
ªs
[
i
] == 0)

605 
	`assign_svÆue_no_‰ì
(&
ªt
->
ôem
[
num_m©ch
], &
v
->ôem[
i
]);

606 
num_m©ch
++;

608 
	`‰ì
((*)
ªg
);

609  
ªt
;

610 
	}
}

615 
	#SETARR_SUBTRACT
 1

	)

616 
	#SETARR_INTERSECT
 2

	)

618 
ve˘‹
 *

619 
	$£t_m™ùuœã_¨øy
(
ve˘‹
 *
¨r1
, ve˘‹ *
¨r2
, 
›
)

621 
m≠pög
 *
m
;

622 
ve˘‹
 *
r
;

623 
svÆue
 
tmp
, *
v
;

624 *
Êags
;

625 
˙t
, 
ªs
;

627 i‡(
¨r1
->
size
 < 1 || 
¨r2
->size < 1)

629 
›
)

631 
SETARR_SUBTRACT
:

632 
	`INCREF
(
¨r1
->
ªf
);

633  
¨r1
;

635 
SETARR_INTERSECT
:

636  
	`Æloˇã_¨øy
(0);

640 
m
 = 
	`make_m≠pög
(
¨r2
, 0);

641 
tmp
.
ty≥
 = 
T_NUMBER
;

642 #ifde‡
PURIFY


643 
tmp
.
°rög_ty≥
 = -1;

645 
tmp
.
u
.
numbî
 = 1;

646 
	`assign_svÆue_no_‰ì
(
	`gë_m≠_lvÆue
(
m
, &
¨r2
->
ôem
[0], 1), &
tmp
);

648 
ªs
 = 0;

650 
Êags
 = 
	`Æloˇ
((
size_t
)
¨r1
->
size
 + 1);

651 
˙t
 = 0; c¡ < 
¨r1
->
size
; cnt++)

653 
Êags
[
˙t
] = 0;

654 
v
 = 
	`gë_m≠_lvÆue
(
m
, &(
¨r1
->
ôem
[
˙t
]), 0);

655 i‡(
›
 =
SETARR_INTERSECT
 && 
v
 !&
c⁄°0
)

657 
Êags
[
˙t
] = 1;

658 
ªs
++;

660 i‡(
›
 =
SETARR_SUBTRACT
 && 
v
 =&
c⁄°0
)

662 
Êags
[
˙t
] = 1;

663 
ªs
++;

666 
r
 = 
	`Æloˇã_¨øy
(
ªs
);

667 i‡(
ªs
)

669 
˙t
 = 
ªs
 = 0; c¡ < 
¨r1
->
size
; cnt++)

671 i‡(
Êags
[
˙t
])

672 
	`assign_svÆue_no_‰ì
(&
r
->
ôem
[
ªs
++], &
¨r1
->ôem[
˙t
]);

675 
	`‰ì_m≠pög
(
m
);

676  
r
;

677 
	}
}

679 
INLINE
 
ve˘‹
 *

680 
	$öãr£˘_¨øy
(
ve˘‹
 *
¨r1
, ve˘‹ *
¨r2
)

682  
	`£t_m™ùuœã_¨øy
(
¨r1
, 
¨r2
, 
SETARR_INTERSECT
);

683 
	}
}

685 
INLINE
 
ve˘‹
 *

686 
	$subåa˘_¨øy
(
ve˘‹
 *
¨r1
, ve˘‹ *
¨r2
)

688  
	`£t_m™ùuœã_¨øy
(
¨r1
, 
¨r2
, 
SETARR_SUBTRACT
);

689 
	}
}

691 
INLINE
 
ve˘‹
 *

692 
	$uni⁄_¨øy
(
ve˘‹
 *
¨r1
, ve˘‹ *
¨r2
)

694 
i
, 
size
;

695 
m≠pög
 *
mp
;

696 
ve˘‹
 *
¨r3
;

697 *
£t
;

699 i‡(
¨r1
->
size
 == 0)

701 
	`INCREF
(
¨r2
->
ªf
);

702  
¨r2
;

705 i‡(
¨r2
->
size
 == 0)

707 
	`INCREF
(
¨r1
->
ªf
);

708  
¨r1
;

711 
mp
 = 
	`Æloˇã_m≠
(
¨r1
->
size
);

713 
i
 = 0; i < 
¨r1
->
size
; i++)

714 
	`assign_svÆue
(
	`gë_m≠_lvÆue
(
mp
, &
¨r1
->
ôem
[
i
], 1), &
c⁄°1
);

716 
£t
 = 
	`Æloˇ
((
size_t
)
¨r2
->
size
);

718 
i
 = 
size
 = 0; i < 
¨r2
->size; i++)

720 i‡(
	`gë_m≠_lvÆue
(
mp
, &
¨r2
->
ôem
[
i
], 0Ë=&
c⁄°0
)

721 
£t
[
i
] = 1, 
size
++;

723 
£t
[
i
] = 0;

726 
	`‰ì_m≠pög
(
mp
);

728 
¨r3
 = 
	`Æloˇã_¨øy
(
¨r1
->
size
 + size);

730 
i
 = 0; i < 
¨r1
->
size
; i++)

731 
	`assign_svÆue_no_‰ì
(&
¨r3
->
ôem
[
i
], &
¨r1
->item[i]);

733 
size
 = 
¨r1
->size;

735 
i
 = 0; i < 
¨r2
->
size
; i++)

736 i‡(
£t
[
i
])

737 
	`assign_svÆue_no_‰ì
(&
¨r3
->
ôem
[
size
++], &
¨r2
->ôem[
i
]);

739  
¨r3
;

740 
	}
}

	@backend.c

1 
	~<°dio.h
>

2 
	~<°rög.h
>

3 
	~<sig«l.h
>

4 
	~<˘y≥.h
>

5 
	~<sys/ty≥s.h
>

6 
	~<sys/°©.h
>

7 
	~<f˙é.h
>

8 
	~<sys/times.h
>

9 
	~<m©h.h
>

10 
	~<mem‹y.h
>

11 
	~<uni°d.h
>

12 
	~<sys/time.h
>

13 #i‡
deföed
(
sun
Ë|| deföed(
__osf__
)

14 
	~<Æloˇ.h
>

17 
	~"c⁄fig.h
"

18 
	~"löt.h
"

19 
	~"öãΩªt.h
"

20 
	~"ndesc.h
"

21 
	~"obje˘.h
"

22 
	~"exec.h
"

23 
	~"comm.h
"

24 
	~"mud°©.h
"

25 
	~"su≥r_¢o›.h
"

26 
	~"sig«ls.h
"

27 
	~"comm1.h
"

28 
	~"simuœã.h
"

30 
gdex˚±i⁄
 *
	gex˚±i⁄
 = 
NULL
;

34 
	gcuºít_time
;

35 
	gÆ¨m_time
;

37 
obje˘
 *
comm™d_givî
, *
cuºít_öãø˘ive
, *
obj_li°_de°ru˘
;

38 
num_∂ayî
, 
d_Êag
, 
s_Êag
;

39 
obje˘
 *
¥evious_ob
, *
ma°î_ob
;

41 #ifde‡
USE_SWAP


42 
u£d_mem‹y
;

45 
tmp˛ón
 ();

46 
¥ï¨e_ùc
(),

47 
shutdowngame
(), 
ed_cmd
 (*),

48 
¥öt_¥om±
(), 
ˇŒ_out
(
timevÆ
 *),

49 
de°ru˘2
 (
obje˘
 *);

50 #ifde‡
USE_SWAP


51 
åy_to_sw≠
();

54 
∂ayî_∑r£r
 (*),

55 
ˇŒ_fun˘i⁄_öãø˘ive
 (
öãø˘ive
 *, *);

57 
t_Êag
;

69 
	$˛ór_°©e
()

71 
obje˘
 *
¥evious_ob
;

73 
cuºít_obje˘
 = 0;

74 
comm™d_givî
 = 0;

75 
cuºít_öãø˘ive
 = 0;

76 
¥evious_ob
 = 0;

77 
cuºít_¥og
 = 0;

78 
	`ª£t_machöe
(0);

79 #i‡
	`deföed
(
RUSAGE
Ë&& deföed(
PROFILE_OBJS
)

80 
	`˛ór_˝u_°ack
();

83 
	}
}

86 
	$log⁄
(
obje˘
 *
ob
)

88 
svÆue
 *
ªt
;

89 
obje˘
 *
ßve
 = 
cuºít_obje˘
;

95 
cuºít_obje˘
 = 
ob
;

96 
ªt
 = 
	`≠∂y
("log⁄", 
ob
, 0, 0);

97 i‡(
ªt
 == 0) {

98 ()
	`add_mesßge
("¥og %s:\n", 
ob
->
«me
);

99 
	`Áèl
("CouldÇŸ födÜog⁄ o¿thê∂ayî %s\n", 
ob
->
«me
);

101 
cuºít_obje˘
 = 
ßve
;

102 
	}
}

110 
	$∑r£_comm™d
(*
°r
, 
obje˘
 *
ob
)

112 
obje˘
 *
ßve
 = 
comm™d_givî
;

113 
ªs
;

115 
comm™d_givî
 = 
ob
;

116 
ªs
 = 
	`∂ayî_∑r£r
(
°r
);

117 
comm™d_givî
 = 
ßve
;

118  
ªs
;

119 
	}
}

131 **
	gtmpmem
 = 0;

132 
size_t
 
	gtmp_size
 = 0;

133 
	gtmp_cur
 = 0;

135 
	#TMPMEM_CHUNK
 1024

	)

138 
	$tmp˛ón
()

140 
û
;

142 
û
 = 
tmp_cur
 - 1; il >=0; il--)

143 
	`‰ì
(
tmpmem
[
û
]);

144 
tmp_cur
 = 0;

145 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


146 i‡(
tmp_size
 > 0)

148 
	`‰ì
(
tmpmem
);

149 
tmpmem
 = 
NULL
;

150 
tmp_size
 = 0;

153 
	}
}

156 
	$tm∑Œoc
(
size_t
 
size
)

158 **
li°
;

160 i‡(
tmp_cur
 >
tmp_size
)

162 
li°
 = (**)
	`xÆloc
((
tmp_size
 + 
TMPMEM_CHUNK
) * (*));

164 i‡(
tmp_size
 > 0)

166 ()
	`mem˝y
(
li°
, 
tmpmem
, 
tmp_size
 * (*));

167 
	`‰ì
((*)
tmpmem
);

170 
tmpmem
 = 
li°
;

171 
tmp_size
 +
TMPMEM_CHUNK
;

173  
tmpmem
[
tmp_cur
++] = 
	`xÆloc
(
size
);

174 
	}
}

177 
	$tmp°rög_c›y
(*
˝
)

179 *
xp
;

181 
xp
 = 
	`tm∑Œoc
(
	`°æí
(
˝
) + 1);

182 ()
	`°r˝y
(
xp
, 
˝
);

183  
xp
;

184 
	}
}

186 
	gevÆ_co°
;

189 
	$sigÂe_h™dÀr
(
sig
)

191 #ifde‡
löt


192 
sig
 = sig;

194 #ifde‡
SYSV


195 
	`sig«l
(
SIGFPE
, 
sifg≥_h™dÀr
);

197 
	`îr‹
("FloatingÖointÉrror.\n");

198 
	}
}

204 
	$backíd
()

206 
gdex˚±i⁄
 
ex˚±i⁄_‰ame
;

207 
timevÆ
 
tv
;

208 
game_is_beög_shut_down
;

209 
¶ow_shut_down_to_do
;

211 #ifde‡
SUPER_SNOOP


212 
	`ªad_¢o›_fûe
();

214 (Ë
	`¥ötf
("Setting up ipc.\n");

215 ()
	`fÊush
(
°dout
);

216 
	`¥ï¨e_ùc
();

217 (Ë
	`sig«l
(
SIGFPE
, 
sigÂe_h™dÀr
);

219 
ex˚±i⁄_‰ame
.
e_ex˚±i⁄
 = 
NULL
;

220 
ex˚±i⁄_‰ame
.
e_ˇtch
 = 0;

221 ()
	`£tjmp
(
ex˚±i⁄_‰ame
.
e_c⁄ãxt
);

222 
ex˚±i⁄
 = &
ex˚±i⁄_‰ame
;

229 
	`£t_cuºít_time
();

240 
	`˛ór_°©e
();

241 
	`tmp˛ón
();

242 
evÆ_co°
 = 0;

243 
	`ªmove_de°ru˘ed_obje˘s
();

245 
	`dñivî_sig«ls
();

246 #ifde‡
DEBUG


247 i‡(
d_Êag
 & 
DEBUG_CHK_REF
)

248 
	`check_a_lŸ_ªf_cou¡s
(0);

250 i‡(
game_is_beög_shut_down
) {

251 
	`shutdowngame
();

254 i‡(
¶ow_shut_down_to_do
)

256 
tmp
 = 
¶ow_shut_down_to_do
;

257 
¶ow_shut_down_to_do
 = 0;

258 
	`¶ow_shut_down
(
tmp
);

261 
	`ˇŒ_out
(&
tv
);

262 
	`nd_£À˘
(&
tv
);

264 #ifde‡
USE_SWAP


265 
	`åy_to_sw≠
();

268 
	}
}

280 
	$¥ñﬂd_obje˘s
(
eÊag
)

282 
gdex˚±i⁄
 
ex˚±i⁄_‰ame
;

283 
ve˘‹
 *
¥efûes
;

284 
svÆue
 *
ªt
 = 
NULL
;

285 vﬁ©ûê
ix
;

287 i‡(
	`£tjmp
(
ex˚±i⁄_‰ame
.
e_c⁄ãxt
))

289 
	`˛ór_°©e
();

290 ()
	`add_mesßge
("Error in start_boot() in master_ob.\n");

291 
ex˚±i⁄
 = 
NULL
;

296 
ex˚±i⁄_‰ame
.
e_ex˚±i⁄
 = 
NULL
;

297 
ex˚±i⁄_‰ame
.
e_ˇtch
 = 0;

298 
ex˚±i⁄
 = &
ex˚±i⁄_‰ame
;

299 
	`push_numbî
(
eÊag
);

300 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_START_BOOT
, 1);

303 i‡((
ªt
 =0Ë|| (ªt->
ty≥
 !
T_POINTER
))

306 
¥efûes
 = 
ªt
->
u
.
vec
;

308 i‡((
¥efûes
 =0Ë|| (¥efûes->
size
 < 1))

311 
	`INCREF
(
¥efûes
->
ªf
);

313 
ix
 = -1;

314 i‡(
	`£tjmp
(
ex˚±i⁄_‰ame
.
e_c⁄ãxt
))

316 
	`˛ór_°©e
();

317 ()
	`add_mesßge
("Anomaly inÅhe fabric of world space.\n");

320 ++
ix
 < 
¥efûes
->
size
)

322 i‡(
s_Êag
)

323 
	`ª£t_mud°©us
();

324 
evÆ_co°
 = 0;

325 
	`push_svÆue
(&(
¥efûes
->
ôem
[
ix
]));

326 ()
	`≠∂y_ma°î_ob
(
M_PRELOAD_BOOT
, 1);

327 i‡(
s_Êag
)

328 
	`¥öt_mud°©us
(
¥efûes
->
ôem
[
ix
].
u
.
°rög
, 
evÆ_co°
,

329 
	`gë_mûlôime
(), 
	`gë_¥o˚s°ime
());

330 
	`tmp˛ón
();

332 
	`‰ì_ve˘‹
(
¥efûes
);

333 
ex˚±i⁄
 = 
NULL
;

334 
	}
}

341 
	$ªmove_de°ru˘ed_obje˘s
()

343 
obje˘
 *
ob
, *
√xt
;

344 
ob
 = 
obj_li°_de°ru˘
; ob; ob = 
√xt
)

346 
√xt
 = 
ob
->
√xt_Æl
;

347 
	`de°ru˘2
(
ob
);

349 
obj_li°_de°ru˘
 = 0;

350 
	}
}

356 
	$wrôe_fûe
(*
fûe
, *
°r
)

358 
FILE
 *
f
;

360 
fûe
 = 
	`check_vÆid_∑th
(fûe, 
cuºít_obje˘
, "write_file", 1);

362 i‡(!
fûe
)

364 
f
 = 
	`f›í
(
fûe
, "a");

365 i‡(
f
 == 0)

366 
	`îr‹
("Wr⁄gÖîmissi⁄†f‹ o≥nög fûê%†f‹áµíd.\n", 
fûe
);

367 i‡(
s_Êag
)

368 
num_fûewrôe
++;

369 i‡(
	`fwrôe
(
°r
, 
	`°æí
(°r), 1, 
f
) != 1) {

370 ()
	`f˛o£
(
f
);

373 i‡(
	`f˛o£
(
f
Ë=
EOF
)

376 
	}
}

378 
	gªad_fûe_Àn
;

381 
	$ªad_fûe
(*
fûe
, 
°¨t
, 
Àn
)

383 
°©
 
°
;

384 
FILE
 *
f
;

385 *
°r
, *
p
, *
p2
, *
íd
, 
c
;

386 
size_t
 
size
;

388 
ªad_fûe_Àn
 = 
Àn
;

389 i‡(
Àn
 < 0)  0;

391 
fûe
 = 
	`check_vÆid_∑th
(fûe, 
cuºít_obje˘
, "read_file", 0);

393 i‡(!
fûe
)

395 
f
 = 
	`f›í
(
fûe
, "r");

396 i‡(
f
 == 0)

399 #ifde‡
PURIFY


400 ()
	`mem£t
(&
°
, '\0', (st));

403 i‡(
	`f°©
(
	`fûío
(
f
), &
°
) == -1)

404 
	`Áèl
("CouldÇot statán open file.\n");

405 
size
 = ()
°
.
°_size
;

406 i‡(
s_Êag
)

407 
num_fûîód
++;

408 i‡(
size
 > 
READ_FILE_MAX_SIZE
)

410 i‡–
°¨t
 || 
Àn
 )

411 
size
 = 
READ_FILE_MAX_SIZE
;

414 ()
	`f˛o£
(
f
);

418 i‡(!
°¨t
)

419 
°¨t
 = 1;

420 i‡(!
Àn
)

421 
ªad_fûe_Àn
 = 
Àn
 = 
READ_FILE_MAX_SIZE
;

422 
°r
 = 
	`xÆloc
(
size
 + 1);

423 
°r
[
size
] = '\0';

426 i‡(
size
 > ()
°
.
°_size
)

427 
size
 = ()
°
.
°_size
;

428 i‡(
	`‰ód
(
°r
, 
size
, 1, 
f
) != 1)

430 ()
	`f˛o£
(
f
);

431 
	`‰ì
(
°r
);

434 
°
.
°_size
 -
size
;

435 
íd
 = 
°r
 + 
size
;

436 
p
 = 
°r
; ( 
p2
 = 
	`memchr
’, '\n', (
size_t
)(
íd
 -Ö)ËË&& --
°¨t
; )

437 
p
 = 
p2
 + 1;

438 }  
°¨t
 > 1 );

440 
p2
 = 
°r
; 
p
 !
íd
; )

442 
c
 = *
p
++;

443 i‡(!
	`i•röt
(
c
Ë&& !
	`is•a˚
(c))

444 
c
 = ' ';

445 *
p2
++ = 
c
;

446 i‡–
c
 == '\n' )

447 i‡(!--
Àn
)

450 i‡(
Àn
 && 
°
.
°_size
)

452 
size
 -(
p2
 - 
°r
) ;

453 i‡(
size
 > ()
°
.
°_size
)

454 
size
 = ()
°
.
°_size
;

455 i‡(
	`‰ód
(
p2
, 
size
, 1, 
f
) != 1)

457 ()
	`f˛o£
(
f
);

458 
	`‰ì
(
°r
);

461 
°
.
°_size
 -
size
;

462 
íd
 = 
p2
 + 
size
;

463 ; 
p2
 !
íd
; )

465 
c
 = *
p2
;

466 i‡(!
	`i•röt
(
c
Ë&& !
	`is•a˚
(c))

467 *
p2
 = ' ';

468 
p2
++;

469 i‡(
c
 == '\n')

470 i‡(!--
Àn
) ;

472 i‡–
°
.
°_size
 && 
Àn
 )

475 ()
	`f˛o£
(
f
);

476 
	`‰ì
(
°r
);

480 
ªad_fûe_Àn
 -
Àn
;

481 *
p2
 = '\0';

482 ()
	`f˛o£
(
f
);

483  
°r
;

484 
	}
}

487 
	$ªad_byãs
(*
fûe
, 
°¨t
, 
size_t
 
Àn
)

489 
°©
 
°
;

491 *
°r
,*
p
;

492 
size
;

493 
f
;

495 if(
Àn
 > 
MAX_BYTE_TRANSFER
)

498 
fûe
 = 
	`check_vÆid_∑th
(fûe, 
cuºít_obje˘
, "read_bytes", 0);

500 i‡(!
fûe
)

502 
f
 = 
	`›í
(
fûe
, 
O_RDONLY
);

503 i‡(
f
 < 0)

506 #ifde‡
PURIFY


507 ()
	`mem£t
(&
°
, '\0', (st));

510 i‡(
	`f°©
(
f
, &
°
) == -1)

511 
	`Áèl
("CouldÇot statán open file.\n");

512 
size
 = ()
°
.
°_size
;

513 if(
°¨t
 < 0)

514 
°¨t
 = 
size
 + start;

516 i‡(
°¨t
 >
size
)

518 ()
	`˛o£
(
f
);

521 i‡((
°¨t
+
Àn
Ë> 
size
)

522 
Àn
 = (
size
 - 
°¨t
);

524 i‡((
size
 = ()
	`l£ek
(
f
, (
off_t
)
°¨t
, 0)) < 0)

526 ()
	`˛o£
(
f
);

530 
°r
 = 
	`Æloˇ
(
Àn
 + 1);

532 
size
 = 
	`ªad
(
f
, 
°r
, 
Àn
);

534 ()
	`˛o£
(
f
);

536 i‡(
size
 <= 0)

550 
°r
[
size
] = '\0';

552 
p
 = 
	`°rög_c›y
(
°r
);

554  
p
;

555 
	}
}

558 
	$wrôe_byãs
(*
fûe
, 
°¨t
, *
°r
)

560 
°©
 
°
;

562 
size
, 
f
;

564 
fûe
 = 
	`check_vÆid_∑th
(fûe, 
cuºít_obje˘
, "write_bytes", 1);

566 i‡(!
fûe
)

568 i‡(
	`°æí
(
°r
Ë> 
MAX_BYTE_TRANSFER
)

570 
f
 = 
	`›í
(
fûe
, 
O_WRONLY
);

571 i‡(
f
 < 0)

574 #ifde‡
PURIFY


575 ()
	`mem£t
(&
°
, '\0', (st));

578 i‡(
	`f°©
(
f
, &
°
) == -1)

579 
	`Áèl
("CouldÇot statán open file.\n");

580 
size
 = ()
°
.
°_size
;

581 if(
°¨t
 < 0)

582 
°¨t
 = 
size
 + start;

584 i‡(
°¨t
 >
size
)

586 ()
	`˛o£
(
f
);

589 i‡((
°¨t
 + 
	`°æí
(
°r
)Ë> 
size
)

591 ()
	`˛o£
(
f
);

595 i‡((
size
 = ()
	`l£ek
(
f
, (
off_t
)
°¨t
, 0)) < 0)

597 ()
	`˛o£
(
f
);

601 
size
 = 
	`wrôe
(
f
, 
°r
, 
	`°æí
(str));

603 ()
	`˛o£
(
f
);

605 i‡(
size
 <= 0) {

610 
	}
}

614 
	$fûe_size
(*
fûe
)

616 
°©
 
°
;

618 
fûe
 = 
	`check_vÆid_∑th
(fûe, 
cuºít_obje˘
, "file_size", 0);

619 i‡(!
fûe
)

622 i‡(
fûe
[0] == '/')

623 
fûe
++;

625 i‡(!
	`ÀgÆ_∑th
(
fûe
))

628 #ifde‡
PURIFY


629 ()
	`mem£t
(&
°
, '\0', (st));

632 i‡(
	`°©
(
fûe
, &
°
) == -1)

634 i‡(
S_IFDIR
 & 
°
.
°_mode
)

636  ()
°
.
°_size
;

637 
	}
}

640 
	$fûe_time
(*
fûe
)

642 
°©
 
°
;

644 
fûe
 = 
	`check_vÆid_∑th
(fûe, 
cuºít_obje˘
, "file_time", 0);

646 i‡(!
fûe
)

649 #ifde‡
PURIFY


650 ()
	`mem£t
(&
°
, '\0', (st));

653 i‡(
	`°©
(
fûe
, &
°
) == -1)

655  ()
°
.
°_mtime
;

656 
	}
}

658 
	gÆ¨m_av
 = 0.0;

661 
	$upd©e_Æ¨m_av
()

663 
c⁄°s
[5];

664 
œ°_time
;

665 
n
;

666 
c
;

667 
acc
 = 0;

669 
acc
++;

670 i‡(
cuºít_time
 =
œ°_time
)

672 
n
 = 
cuºít_time
 - 
œ°_time
;

673 i‡(
n
 <  
c⁄°s
 /  consts[0])

674 
c
 = 
c⁄°s
[
n
];

676 
c
 = 
	`exp
(- 
n
 / 900.0);

677 
Æ¨m_av
 = 
c
 *áœrm_av + 
acc
 * (1 - cË/ 
n
;

678 
œ°_time
 = 
cuºít_time
;

679 
acc
 = 0;

680 
	}
}

682 
	glﬂd_av
 = 0.0;

685 
	$upd©e_lﬂd_av
()

687 
c⁄°s
[5];

688 
œ°_time
;

689 
n
;

690 
c
;

691 
acc
 = 0;

693 
acc
++;

694 i‡(
cuºít_time
 =
œ°_time
)

696 
n
 = 
cuºít_time
 - 
œ°_time
;

697 i‡(
n
 <  
c⁄°s
 /  consts[0])

698 
c
 = 
c⁄°s
[
n
];

700 
c
 = 
	`exp
(- 
n
 / 900.0);

701 
lﬂd_av
 = 
c
 *Üﬂd_av + 
acc
 * (1 - cË/ 
n
;

702 
œ°_time
 = 
cuºít_time
;

703 
acc
 = 0;

704 
	}
}

706 
	gcompûe_av
 = 0.0;

709 
	$upd©e_compûe_av
(
löes
)

711 
c⁄°s
[5];

712 
œ°_time
;

713 
n
;

714 
c
;

715 
acc
 = 0;

717 
acc
 +
löes
;

718 i‡(
cuºít_time
 =
œ°_time
)

720 
n
 = 
cuºít_time
 - 
œ°_time
;

721 i‡(
n
 <  
c⁄°s
 /  consts[0])

722 
c
 = 
c⁄°s
[
n
];

724 
c
 = 
	`exp
(- 
n
 / 900.0);

725 
compûe_av
 = 
c
 * compûe_av + 
acc
 * (1 - cË/ 
n
;

726 
œ°_time
 = 
cuºít_time
;

727 
acc
 = 0;

728 
	}
}

731 
	$quîy_lﬂd_av
()

733 
buff
[100];

735 ()
	`•rötf
(
buff
, "%.2‡cmds/s, %.2‡com∞löes/s, %.2‡Æ¨ms/s", 
lﬂd_av
, 
compûe_av
, 
Æ¨m_av
);

736  
buff
;

737 
	}
}

	@bibopmalloc.c

1 #ifde‡
MALLOC_bib›mÆloc


52 
	#PARANOIA


	)

54 
	~<°dio.h
>

55 
	~<°dlib.h
>

56 
	~<°rög.h
>

57 
	~"c⁄fig.h
"

58 
	~<m©h.h
>

60 
	~"löt.h
"

61 #ifde‡
DEBUG


62 
	~"m°rög.h
"

63 
	~"simuœã.h
"

66 #ifde‡
__Æpha


67 
	#SMALL_SIZE
 96

	)

68 
	#PAGE_SIZE
 0x10000

	)

69 
	#SIZE_SLOP
 96

	)

71 
	#SMALL_SIZE
 56

	)

72 
	#PAGE_SIZE
 0x8000

	)

73 
	#SIZE_SLOP
 56

	)

75 
	#NFREE
 20

	)

77 
	tÆig¡y≥
;

78 
	#ALIGNMENT
 ((
Æig¡y≥
)Ë

	)

79 
	tm≠w‹d
;

81 
	#BITS_PER_BYTE
 8

	)

83 
	#CEIL
(
x
Ë(((x)+
ALIGNMENT
-1Ë& ~(ALIGNMENT-1))

	)

84 
	#PAGEMASK
 (~(
PAGE_SIZE
-1))

	)

86 
	#PTR_SIZE
 ((*))

	)

88 
	#BITS_PER_MAPWORD
 ((
m≠w‹d
Ë* 
BITS_PER_BYTE
)

	)

90 
	sbib›
 {

91 
	mobjsize
;

92 
	mobj‰ì
;

93 
	mmaxobj‰ì
;

94 
m≠w‹d
 *
	m‰ìm≠
;

95 
	m√xt‰ì
;

96 
	mmax‰ì
;

97 *
	mobjs
;

99 
	#BIBOPMAGIC
 0x55AA5A01

	)

100 
	gp_bib›
, 
	gm_bib›
, 
	gf_bib›
;

101 
	gs_bib›
;

103 
	smedium
 {

105 
	m‰ì˙t
;

106 
	mmax‰ì
;

108 
Æig¡y≥
 
	md©a
;

110 
	#ALLOCMAGIC
 0x55AA5A02

	)

111 
	gp_Æloc
, 
	gm_Æloc
, 
	gf_Æloc
;

112 
	gs_Æloc
;

113 
	#OBJSIZE
(
cur
Ë((*)cur->
√xt
 - (*)
	`OBJ_TO_DATA
(cur))

	)

115 
	s‰ìblk
 {

116 
‰ìblk
 *
	mfwd
, *
	mbwd
;

117 #ifde‡
FREESTAT


118 
‰ìhód
 *
	mhód
;

121 
	s‰ìhód
 {

122 
‰ìblk
 
	mh
;

123 
	mmaxsize
;

124 
	m«Œoc
, 
	mƒól
, 
	mn•lô
, 
	mn‰ì
, 
	mnjoö
, 
	mnjoö1
, 
	mnjoö2
, 
	mndr›
, 
	mnwhy
, 
	mnskù
;

126 
‰ìhód
 
	g‰ìhód
[
NFREE
];

127 
	#FDEL
(
p
Ë{ (p)->
bwd
->
fwd
 = (p)->fwd; (p)->fwd->bwd = (p)->bwd; }

	)

128 
	#FINS
(
p
, 
q
Ë{ (p)->
fwd
 = (q)->fwd; (q)->fwd = (p); (p)->
bwd
 = (q); (p)->fwd->bwd = (p); }

	)

130 
	sbig
 {

131 
	m≈ages
;

132 
Æig¡y≥
 
	md©a
;

134 
	#BIGMAGIC
 0x55AA5A03

	)

135 
	gp_big
, 
	gm_big
, 
	gf_big
;

136 
	gs_big
;

138 
	sdes¸
 {

139 
	mmagic
;

140 
des¸
 *
	md√xt
;

142 
bib›
 
	mbib›
;

143 
medium
 
	mmedium
;

144 
big
 
	mbig
;

145 } 
	mu
;

148 #ifde‡
USE_SWAP


149 
u£d_mem‹y
;

152 
des¸
 *
	gbib›s
[(
SMALL_SIZE
+
ALIGNMENT
-1)/ALIGNMENT];

154 
des¸
 *
√wbib›
();

156 
des¸
 *
	gfú°∑ge
;

158 
	tPTR
;

160 
des¸
 *
	g‰ì∑ge
 = 0;

161 
	gp_‰ì
;

163 
	sblock
 {

164 #ifde‡
BIBOP_DEBUG


165 
	mbmagic
;

167 
	mbusy
;

168 
block
 *
	m√xt
;

170 
Æig¡y≥
 
	md©a
;

171 
‰ìblk
 
	mfb
;

172 } 
	mu
;

174 
	#DATA_TO_OBJ
(
p
Ë((
block
 *)–(*Ì - ()&((block *)0)->
u
.
d©a
 ))

	)

175 
	#OBJ_TO_DATA
(
p
Ë((*)&p->
u
.
d©a
)

	)

176 
	#BMAGIC
 0x19930921

	)

178 *
	g√xçage
, *
	gfú°sbrk
;

180 
	göôd⁄e
 = 0;

182 #i‡
deföed
(
__O≥nBSD__
Ë|| deföed(
__NëBSD__
Ë|| deföed(
__FªeBSD__
Ë|| deföed(
__bsdi__
)

183 *
sbrk
();

184 #ñi‡
deföed
(
SOLARIS
)

185 *
sbrk
();

187 *
sbrk
();

190 *
dump_mÆloc_d©a
();

191 
bib›_öô
();

193 
	#OFFSET
(
t
,
f
Ë((Ë&((— *)0)->f))

	)

197 
	$ö£π‰ì∑ge
(
des¸
 *
p
)

199 
des¸
 **
Â
;

201 #ifde‡
BIBOP_DEBUG


202 ()
	`Ârötf
(
°dîr
, "‰ìög %dÖage†© %lx", 
p
->
u
.
big
.
≈ages
,Ö);

205 
Â
 = &
‰ì∑ge
; *Â && 
p
 > *Â; f∞&(*Â)->
d√xt
)

208 
p
->
d√xt
 = *
Â
;

209 *
Â
 = 
p
;

211 i‡((*)
p
->
d√xt
 =(*Ì +Ö->
u
.
big
.
≈ages
 * 
PAGE_SIZE
) {

212 
p
->
u
.
big
.
≈ages
 +p->
d√xt
->u.big.npages;

213 
p
->
d√xt
 =Ö->dnext->dnext;

214 #ifde‡
BIBOP_DEBUG


215 ()
	`Ârötf
(
°dîr
, ", join withÇext block");

219 i‡(
Â
 !&
‰ì∑ge
) {

220 
des¸
 *
q
;

221 
q
 = (
des¸
 *)((*)
Â
 - 
	`OFFSET
(des¸, 
d√xt
));

222 i‡((*)
q
->
d√xt
 =(*)q + q->
u
.
big
.
≈ages
 * 
PAGE_SIZE
) {

223 
q
->
u
.
big
.
≈ages
 +q->
d√xt
->u.big.npages;

224 
q
->
d√xt
 = q->dnext->dnext;

225 #ifde‡
BIBOP_DEBUG


226 ()
	`Ârötf
(
°dîr
, ", join withÖrevious block");

230 #ifde‡
BIBOP_DEBUG


232 
des¸
 *
f
;

233 ()
	`Ârötf
(
°dîr
, "\n‰ìÖagêli° (√xçage=%lx):\n", 
√xçage
);

234 
f
 = 
‰ì∑ge
; f; f = f->
d√xt
) {

235 ()
	`Ârötf
(
°dîr
, " %lx (%lxË%d\n", 
f
, (*)‡+ f->
u
.
big
.
≈ages
 * 
PAGE_SIZE
, f->u.big.npages);

239 
	}
}

243 
	$∑ges
(
n
)

245 *
r
;

247 #ifde‡
BIBOP_DEBUG


248 ()
	`Ârötf
(
°dîr
, "Æloˇtög %dÖages", 
n
);

251 i‡(
‰ì∑ge
) {

254 
des¸
 **
p
, **
œ°
 = 0, **
be°
 = 0, *
b
;

255 
p
 = &
‰ì∑ge
; *p; 
œ°
 =Ö,Ö = &(*p)->
d√xt
) {

256 i‡((*
p
)->
u
.
big
.
≈ages
 =
n
) {

257 
be°
 = 
p
;

259 } i‡((*
p
)->
u
.
big
.
≈ages
 > 
n
) {

260 i‡(!
be°
 || (*
p
)->
u
.
big
.
≈ages
 < (*best)->u.big.npages)

261 
be°
 = 
p
;

264 i‡(!
be°
) {

266 i‡((*)(*
œ°
Ë+ (*œ°)->
u
.
big
.
≈ages
 * 
PAGE_SIZE
 =
√xçage
) {

267 
k
 = 
n
 - (*
œ°
)->
u
.
big
.
≈ages
;

268 
r
 = 
	`sbrk
(
k
*
PAGE_SIZE
);

269 i‡(!
r
 ||Ñ == (*)-1) {

270 ()
	`Ârötf
(
°dîr
, "sbrk(%ld) failed %ld(0x%lx)\n",

271 (Ë
k
*
PAGE_SIZE
, ()(
√xçage
 - 
fú°sbrk
),

272 ()(
√xçage
 - 
fú°sbrk
));

275 
√xçage
 +
k
*
PAGE_SIZE
;

276 (*
œ°
)->
u
.
big
.
≈ages
 +
k
;

277 
be°
 = 
œ°
;

278 
p_‰ì
 +
k
;

279 #ifde‡
BIBOP_DEBUG


280 ()
	`Ârötf
(
°dîr
, ",Éxãndög %d", 
k
);

283 
nŸfound
;

285 #ifde‡
BIBOP_DEBUG


286 ()
	`Ârötf
(
°dîr
, ", from freeÜist");

289 
b
 = *
be°
;

290 
r
 = 
b
;

291 i‡(
b
->
u
.
big
.
≈ages
 > 
n
) {

293 *
be°
 = (
des¸
 *)((*)
b
 + 
n
 * 
PAGE_SIZE
);

294 (*
be°
)->
magic
 = 
b
->magic;

295 (*
be°
)->
u
.
big
.
≈ages
 = 
b
->u.big.≈age†- 
n
;

296 (*
be°
)->
d√xt
 = 
b
->dnext;

297 #ifde‡
BIBOP_DEBUG


298 ()
	`Ârötf
(
°dîr
, ", s∂ô ià%d %d", 
b
->
u
.
big
.
≈ages
, 
n
);

301 *
be°
 = 
b
->
d√xt
;

303 
p_‰ì
 -
n
;

304 #ifde‡
BIBOP_DEBUG


306 
des¸
 *
f
;

307 ()
	`Ârötf
(
°dîr
, "\n‰ìÖagêli° (√xçage=%lx):\n", 
√xçage
);

308 
f
 = 
‰ì∑ge
; f; f = f->
d√xt
) {

309 ()
	`Ârötf
(
°dîr
, " %lx (%lxË%d\n", 
f
, (*)‡+ f->
u
.
big
.
≈ages
 * 
PAGE_SIZE
, f->u.big.npages);

313  
r
;

316 
nŸfound
:

317 #ifde‡
BIBOP_DEBUG


318 ()
	`Ârötf
(
°dîr
, " fresh\n");

320 
r
 = 
	`sbrk
(
n
*
PAGE_SIZE
);

321 i‡(!
r
 ||Ñ == (*)-1)

323 ()
	`Ârötf
(
°dîr
, "sbrk faûed %ld\n", ()(
√xçage
 - 
fú°sbrk
));

326 i‡(!(
√xçage
 - 
PAGE_SIZE
 <(*)
r
 && (*)r <=Çextpage + PAGE_SIZE))

328 ()
	`Ârötf
(
°dîr
, "bad sbrk %lx %lx\n", (Ë
r
,

329 (Ë
√xçage
);

331 
r
 = 
√xçage
;

332 
√xçage
 +
n
*
PAGE_SIZE
;

333  
r
;

334 
	}
}

338 
	$ös‰ì
(
block
 *
b
, 
how
)

340 
s
 = 
	`OBJSIZE
(
b
);

341 
i
;

343 
i
 = 0; i < 
NFREE
 && 
‰ìhód
[i].
maxsize
 <
s
; i++)

345 #ifde‡
PARANOIA


346 i‡(
i
 =
NFREE
) {

347 ()
	`Ârötf
(
°dîr
, "ös‰ì %d\n", 
s
);

348 
	`ab‹t
();

351 
	`FINS
(&
b
->
u
.
fb
, &
‰ìhód
[
i
].
h
);

352 #ifde‡
FREESTAT


353 i‡(
how
 =1Ë
‰ìhód
[
i
].
n•lô
++;

354 i‡(
how
 =2Ë
‰ìhód
[
i
].
n‰ì
++;

355 i‡(
how
 =3Ë
‰ìhód
[
i
].
njoö
++;

356 
b
->
u
.
fb
.
hód
 = &
‰ìhód
[
i
];

357 #ñi‡
	`deföed
(
löt
)

358 
how
--;

360 
	}
}

364 
	$öô_Ælo˝age
(
des¸
 *
p
)

366 
block
 *
fú°
, *
œ°
;

368 
p
->
magic
 = 
ALLOCMAGIC
;

370 
p
->
u
.
medium
.
‰ì˙t
 = 1;

372 
p
->
d√xt
 = 0;

373 
fú°
 = (
block
 *)&
p
->
u
.
medium
.
d©a
;

374 
œ°
 = (
block
 *)((*)
p
 + 
PAGE_SIZE
 - (block));

375 #ifde‡
BIBOP_DEBUG


376 
fú°
->
bmagic
 = 
BMAGIC
;

377 
œ°
->
bmagic
 = 
BMAGIC
;

379 
fú°
->
busy
 = 0;

380 
fú°
->
√xt
 = 
œ°
;

381 
œ°
->
busy
 = 0;

382 
œ°
->
√xt
 = 0;

383 
	`ös‰ì
(
fú°
, 0);

385 
p
->
u
.
medium
.
max‰ì
 = 
	`OBJSIZE
(
fú°
);

387 
	}
}

391 
	$bigmÆloc
(
size
)

393 
des¸
 *
p
;

394 
block
 *
cur
, *
√xt
;

395 
cursize
;

397 i‡(
size
 > 
PAGE_SIZE
 - (
des¸
Ë- 
ALIGNMENT
 - 
PTR_SIZE
) {

399 
n
 = (
size
 + (
des¸
Ë+ 
PAGE_SIZE
 - 1) / PAGE_SIZE;

400 
des¸
 *
bigp
 = 
	`∑ges
(
n
);

401 i‡(!
bigp
)

403 #ifde‡
USE_SWAP


404 
u£d_mem‹y
 +
n
 * 
PAGE_SIZE
;

406 
p_big
 +
n
;

407 
bigp
->
magic
 = 
BIGMAGIC
;

408 
bigp
->
u
.
big
.
≈ages
 = 
n
;

409 
m_big
++;

410 
s_big
 +
size
;

411  (*)&
bigp
->
u
.
big
.
d©a
;

416 
p
 = 
fú°∑ge
;Ö;Ö =Ö->
√xt
) {

417 i‡(
p
->
u
.
medium
.
‰ì˙t
 =0 ||Ö->u.medium.
max‰ì
 &&Ö->u.medium.max‰ì < 
size
)

419 
cur
 = (
block
 *)&
p
->
u
.
medium
.
d©a
; cur->
√xt
; cur = cur->next) {

420 i‡(
cur
->
busy
)

422 
√xt
 = 
cur
->next;

423 
cursize
 = 
	`OBJSIZE
(
cur
);

424 i‡(
cursize
 > 
p
->
u
.
medium
.
max‰ì
)

425 
p
->
u
.
medium
.
max‰ì
 = 
cursize
;

426 i‡(
cursize
 >
size
)

427 
found
;

433 
i
;

434 
i
 = 0; i < 
NFREE
; i++) {

435 i‡(
‰ìhód
[
i
].
maxsize
 > 
size
) {

436 
‰ìblk
 *
Â
;

437 
Â
 = 
‰ìhód
[
i
].
h
.
fwd
; fp != &freehead[i].h; fp = fp->fwd) {

438 
cur
 = 
	`DATA_TO_OBJ
(
Â
);

439 
cursize
 = 
	`OBJSIZE
(
cur
);

440 i‡(
cursize
 >
size
) {

441 
p
 = (
des¸
 *)((
PTR
)
cur
 & 
PAGEMASK
);

442 
found
;

445 
‰ìhód
[
i
].
nskù
++;

451 
p
 = 
	`∑ges
(1);

452 i‡(!
p
)

454 
p_Æloc
++;

455 
	`öô_Ælo˝age
(
p
);

456 
p
->
d√xt
 = 
fú°∑ge
;

457 
fú°∑ge
 = 
p
;

458 
cur
 = (
block
 *)&
p
->
u
.
medium
.
d©a
;

459 
cursize
 = 
	`OBJSIZE
(
cur
);

460 
found
:

461 #ifde‡
BIBOP_DEBUG


462 i‡(
cur
->
bmagic
 !
BMAGIC
) {

463 ()
	`Ârötf
(
°dîr
, "bad magic 2\n");

464 
	`ab‹t
();

468 
p
->
u
.
medium
.
‰ì˙t
--;

470 
	`FDEL
(&
cur
->
u
.
fb
);

471 #ifde‡
FREESTAT


472 
cur
->
u
.
fb
.
hód
->
«Œoc
++;

474 
i
;

475 
i
 = 0; i < 
NFREE
 && 
‰ìhód
[i].
maxsize
 < 
size
; i++)

477 #ifde‡
PARANOIA


478 i‡(
i
 =
NFREE
)

479 
	`ab‹t
();

481 
‰ìhód
[
i
].
ƒól
++;

482 i‡(
cur
 =(
block
 *)&
p
->
u
.
medium
.
d©a
 && cur->
√xt
->next == 0)

483 
‰ìhód
[
i
].
nwhy
++;

486 i‡(
size
 + 
SIZE_SLOP
 < 
cursize
) {

488 
√xt
 = (
block
 *)((*)
cur
 + 
size
 + (block));

489 #ifde‡
BIBOP_DEBUG


490 
√xt
->
bmagic
 = 
BMAGIC
;

492 
√xt
->
busy
 = 0;

493 #ifde‡
PARANOIA


494 i‡((
des¸
 *)((
PTR
)
cur
->
√xt
 & 
PAGEMASK
Ë!
p
)

495 
	`ab‹t
();

497 
√xt
->√xà
cur
->next;

498 
cur
->
√xt
 =Çext;

499 #ifde‡
PARANOIA


500 i‡((
des¸
 *)((
PTR
)
cur
->
√xt
 & 
PAGEMASK
Ë!
p
)

501 
	`ab‹t
();

504 
p
->
u
.
medium
.
‰ì˙t
++;

505 i‡(
p
->
u
.
medium
.
max‰ì
 =
cursize
)

506 
p
->
u
.
medium
.
max‰ì
 = 
	`OBJSIZE
(
√xt
);

508 
	`ös‰ì
(
√xt
, 1);

510 
cur
->
busy
 = 1;

511 
m_Æloc
++;

512 
s_Æloc
 +
size
;

514 i‡(
p
->
u
.
medium
.
max‰ì
 =
cursize
)

515 
p
->
u
.
medium
.
max‰ì
 = 0;

517 #ifde‡
USE_SWAP


518 
u£d_mem‹y
 +
	`OBJSIZE
(
cur
);

520  (*)&
cur
->
u
.
d©a
;

521 
	}
}

524 
	gÊsb
[] = {

545 
	$mÆloc
(
size_t
 
size
)

547 
des¸
 *
bp
;

548 
i
, 
j
;

549 
m≠w‹d
 
m
;

551 
size
 = 
	`CEIL
(size);

552 i‡(!
öôd⁄e
)

553 
	`bib›_öô
();

554 i‡(
size
 >
SMALL_SIZE
)

555  
	`bigmÆloc
(
size
);

556 
bp
 = 
bib›s
[
size
/
ALIGNMENT
 - 1]; b∞&& bp->
u
.
bib›
.
obj‰ì
 =0; b∞bp->
d√xt
)

558 i‡(!
bp
) {

560 
bp
 = 
	`√wbib›
(
size
);

561 i‡(!
bp
)

563 
bp
->
d√xt
 = 
bib›s
[
size
/
ALIGNMENT
 - 1];

564 
bib›s
[
size
/
ALIGNMENT
 - 1] = 
bp
;

567 
i
 = 
bp
->
u
.
bib›
.
√xt‰ì
; ;) {

568 
m
 = 
bp
->
u
.
bib›
.
‰ìm≠
[
i
];

569 i‡(
m
)

571 i‡(++
i
 >
bp
->
u
.
bib›
.
max‰ì
)

572 
i
 = 0;

573 #ifde‡
PARANOIA


574 i‡(
i
 =
bp
->
u
.
bib›
.
√xt‰ì
) {

576 ()
	`Ârötf
(
°dîr
, "bmÆlo¯wøµedáround, sizê%ld\n", ()
size
);

577 
	`ab‹t
();

581 
bp
->
u
.
bib›
.
√xt‰ì
 = 
i
;

583 
	#ONES
 (~(
m≠w‹d
)0)

	)

584 
j
 = 0;

585 i‡((
m
 & (
ONES
 >> (
BITS_PER_MAPWORD
/2))) == 0)

586 
j
 +
BITS_PER_MAPWORD
/2, 
m
 >>= BITS_PER_MAPWORD/2;

588 
m
 &(
ONES
 >> (
BITS_PER_MAPWORD
/2));

589 i‡((
m
 & (
ONES
 >> (3*
BITS_PER_MAPWORD
/4))) == 0)

590 
j
 +
BITS_PER_MAPWORD
/4, 
m
 >>= BITS_PER_MAPWORD/4;

592 
m
 &(
ONES
 >> (3*
BITS_PER_MAPWORD
/4));

593 i‡((
m
 & (
ONES
 >> (7*
BITS_PER_MAPWORD
/8))) == 0)

594 
j
 +
BITS_PER_MAPWORD
/8, 
m
 >>= BITS_PER_MAPWORD/8;

596 
m
 &(
ONES
 >> (7*
BITS_PER_MAPWORD
/8));

600 
j
 +
Êsb
[()
m
];

601 
bp
->
u
.
bib›
.
‰ìm≠
[
i
] &~ ((
m≠w‹d
)1<<
j
);

602 
bp
->
u
.
bib›
.
obj‰ì
--;

603 #ifde‡
USE_SWAP


604 
u£d_mem‹y
 +
bp
->
u
.
bib›
.
objsize
;

606 
m_bib›
++;

607 
s_bib›
 +
size
;

608  (*Ë((*)
bp
->
u
.
bib›
.
objs
 + (
i
 * 
BITS_PER_MAPWORD
 + 
j
Ë* 
size
);

609 
	}
}

613 
	$ˇŒoc
(
size_t
 
nmemb
, size_à
size
)

615 *
p
;

617 
p
 = 
	`mÆloc
(
nmemb
 * 
size
);

618 i‡(
p
 !
NULL
)

619 
	`mem£t
(
p
, '\0', 
nmemb
 * 
size
);

620  
p
;

621 
	}
}

625 
	$‰ì
(*
±r
)

627 
des¸
 *
bp
;

628 
offs
;

629 
i
, 
j
;

631 i‡(!
±r
)

634 i‡(!
öôd⁄e
)

636 #ifde‡
DEBUG


637 i‡(
	`m°rög_magic
(
±r
Ë=
MSTRING_MAGIC
)

638 
	`Áèl
("‰ìög m-magi¯°rög: %s\n", 
±r
);

639 i‡(
	`s°rög_magic
(
±r
Ë=
SSTRING_MAGIC
)

640 
	`Áèl
("‰ìög s-magi¯°rög: %s\n", 
±r
);

642 
bp
 = (
des¸
 *)((
PTR
)
±r
 & 
PAGEMASK
);

643 i‡(
bp
->
magic
 =
BIGMAGIC
) {

645 
n
 = 
bp
->
u
.
big
.
≈ages
;

647 #ifde‡
USE_SWAP


648 
u£d_mem‹y
 -
n
 * 
PAGE_SIZE
;

650 
	`ö£π‰ì∑ge
(
bp
);

651 
f_big
++;

652 
p_big
 -
n
;

653 
p_‰ì
 +
n
;

654 } i‡(
bp
->
magic
 =
ALLOCMAGIC
) {

656 
block
 *
this
, *
cur
, *
√xt
;

658 
cursize
;

661 #ifde‡
USE_SWAP


662 
u£d_mem‹y
 -
	`OBJSIZE
(
	`DATA_TO_OBJ
(
±r
));

664 #ifde‡
BIBOP_DEBUG


665 i‡(
	`DATA_TO_OBJ
(
±r
)->
bmagic
 !
BMAGIC
) {

666 ()
	`Ârötf
(
°dîr
, "bad magic 3\n");

667 
	`ab‹t
();

670 
this
 = 
	`DATA_TO_OBJ
(
±r
);

671 #ifde‡
PARANOIA


672 i‡(!
this
->
busy
)

673 
	`ab‹t
();

675 
this
->
busy
 = 0;

677 
bp
->
u
.
medium
.
‰ì˙t
++;

679 
	`ös‰ì
(
this
, 2);

681 
cur
 = (
block
 *)&
bp
->
u
.
medium
.
d©a
; cur->
√xt
; cur = cur->next)

682 i‡(
cur
 =
this
 || (cur->
√xt
 =thi†&& !cur->
busy
))

684 #ifde‡
PARANOIA


685 i‡(!
cur
->
√xt
 || cur->
busy
)

686 
	`ab‹t
();

690 
√xt
 = 
cur
->next;

691 #ifde‡
BIBOP_DEBUG


692 i‡(
√xt
->
bmagic
 !
BMAGIC
) {

693 ()
	`Ârötf
(
°dîr
, "bad magic 1\n");

694 
	`ab‹t
();

697 i‡(!
√xt
->√xà||Çext->
busy
)

699 
cur
->
√xt
 =Çext->next;

700 #ifde‡
BIBOP_DEBUG


701 
√xt
->
bmagic
 = 0;

703 #ifde‡
PARANOIA


704 i‡((
des¸
 *)((
PTR
)
cur
->
√xt
 & 
PAGEMASK
Ë!
bp
)

705 
	`ab‹t
();

708 
bp
->
u
.
medium
.
‰ì˙t
--;

710 #ifde‡
FREESTAT


711 
cur
->
u
.
fb
.
hód
->
njoö1
++;

712 
√xt
->
u
.
fb
.
hód
->
njoö2
++;

714 
	`FDEL
(&
cur
->
u
.
fb
);

715 
	`FDEL
(&
√xt
->
u
.
fb
);

716 
	`ös‰ì
(
cur
, 3);

719 
cursize
 = 
	`OBJSIZE
(
cur
);

720 i‡(
cursize
 > 
bp
->
u
.
medium
.
max‰ì
)

721 
bp
->
u
.
medium
.
max‰ì
 = 
cursize
;

724 i‡(((
block
 *)&
bp
->
u
.
medium
.
d©a
)->
√xt
->next == 0) {

726 
des¸
 **
p
;

727 
block
 *
blk
 = (block *)&
bp
->
u
.
medium
.
d©a
;

728 
	`FDEL
(&
blk
->
u
.
fb
);

729 #ifde‡
FREESTAT


730 
blk
->
u
.
fb
.
hód
->
ndr›
++;

732 
p
 = &
fú°∑ge
; *∞!
bp
;Ö = &(*p)->
d√xt
)

734 *
p
 = (*p)->
d√xt
;

735 
bp
->
u
.
big
.
≈ages
 = 1;

736 
	`ö£π‰ì∑ge
(
bp
);

737 
p_‰ì
++;

738 
p_Æloc
--;

740 
f_Æloc
++;

741 } i‡(
bp
->
magic
 =
BIBOPMAGIC
) {

742 
offs
 = ((*)
±r
 - (*)
bp
->
u
.
bib›
.
objs
Ë/ bp->u.bib›.
objsize
;

743 
i
 = 
offs
 / 
BITS_PER_MAPWORD
;

744 
j
 = 
offs
 % 
BITS_PER_MAPWORD
;

745 #ifde‡
PARANOIA


746 i‡(
bp
->
u
.
bib›
.
‰ìm≠
[
i
] & (
m≠w‹d
)1<<
j
)

747 
	`ab‹t
();

749 
bp
->
u
.
bib›
.
‰ìm≠
[
i
] |(
m≠w‹d
)1<<
j
;

750 
bp
->
u
.
bib›
.
√xt‰ì
 = 
i
;

751 
bp
->
u
.
bib›
.
obj‰ì
++;

752 
f_bib›
++;

753 #ifde‡
USE_SWAP


754 
u£d_mem‹y
 -
bp
->
u
.
bib›
.
objsize
;

758 ()
	`Ârötf
(
°dîr
, "Warning, bad magicÇumber in free %x (%p)\n",

759 
bp
->
magic
, 
±r
);

761 
	}
}

765 
	$c‰ì
(*
±r
)

767 
	`‰ì
(
±r
);

768 
	}
}

773 
	$objsize
(*
±r
)

775 
des¸
 *
bp
;

777 
bp
 = (
des¸
 *)((
PTR
)
±r
 & 
PAGEMASK
);

778 i‡(
bp
->
magic
 =
BIGMAGIC
) {

779  
bp
->
u
.
big
.
≈ages
 * 
PAGE_SIZE
;

780 } i‡(
bp
->
magic
 =
ALLOCMAGIC
) {

781  
	`OBJSIZE
(
	`DATA_TO_OBJ
(
±r
));

782 } i‡(
bp
->
magic
 =
BIBOPMAGIC
) {

783  
bp
->
u
.
bib›
.
objsize
;

787 
	}
}

792 
	$ªÆloc
(*
ﬁd
, 
size_t
 
size
)

794 
des¸
 *
bp
;

795 
size_t
 
osize
;

796 *
√w
;

798 i‡(!
ﬁd
)

799  
	`mÆloc
(
size
);

800 
bp
 = (
des¸
 *)((
PTR
)
ﬁd
 & 
PAGEMASK
);

801 
bp
->
magic
)

803 
BIGMAGIC
:

804 
osize
 = 
bp
->
u
.
big
.
≈ages
 * 
PAGE_SIZE
;

806 
ALLOCMAGIC
:

807 
osize
 = 
	`OBJSIZE
(
	`DATA_TO_OBJ
(
ﬁd
));

809 
BIBOPMAGIC
:

810 
osize
 = 
bp
->
u
.
bib›
.
objsize
;

813 ()
	`Ârötf
(
°dîr
, "Bad magi¯numbî i¿ªÆlo¯%x\n", 
bp
->
magic
);

814 
osize
 = 0;

817 i‡(
osize
 > 
size
)

818 
osize
 = 
size
;

819 i‡(
osize
 =
size
)

820  
ﬁd
;

823 
√w
 = 
	`mÆloc
(
size
);

824 i‡(!
√w
)

827 ()
	`mem˝y
(
√w
, 
ﬁd
, 
osize
);

829 
	`‰ì
(
ﬁd
);

830  
√w
;

831 
	}
}

834 
des¸
 *

835 
	$√wbib›
(
size
)

836 
size
;

838 
des¸
 *
bp
;

839 
nobj
, 
nm≠
, 
¬m≠
;

840 
i
, 
j
;

843 
bp
 = 
	`∑ges
(1);

844 i‡(!
bp
)

846 
p_bib›
++;

848 
nm≠
 = 0, 
¬m≠
 = -1;Çmap !=Çnmap;) {

849 
nobj
 = (
PAGE_SIZE
 - (
des¸
Ë- 
nm≠
 * (
m≠w‹d
Ë- 2 * 
ALIGNMENT
Ë/ 
size
;

850 
¬m≠
 = 
nm≠
;

851 
nm≠
 = (
nobj
 + 
BITS_PER_MAPWORD
 - 1) / BITS_PER_MAPWORD;

853 
bp
->
magic
 = 
BIBOPMAGIC
;

854 
bp
->
u
.
bib›
.
objsize
 = 
size
;

855 
bp
->
u
.
bib›
.
obj‰ì
 = 
nobj
;

856 
bp
->
u
.
bib›
.
maxobj‰ì
 = 
nobj
;

857 
bp
->
u
.
bib›
.
‰ìm≠
 = (*Ë((*)b∞+ 
	`CEIL
((
des¸
)));

858 
bp
->
u
.
bib›
.
√xt‰ì
 = 0;

859 
bp
->
u
.
bib›
.
max‰ì
 = 
nm≠
;

860 
bp
->
u
.
bib›
.
objs
 = (*Ë((*)bp->u.bib›.
‰ìm≠
 + 
	`CEIL
(
nm≠
 * (
m≠w‹d
)));

861 
bp
->
d√xt
 = 0;

864 
i
 = 0; i < 
nm≠
-1; i++)

865 
bp
->
u
.
bib›
.
‰ìm≠
[
i
] = (
m≠w‹d
)~0;

866 
j
 = 
nobj
 % 
BITS_PER_MAPWORD
;

867 i‡(
j
)

868 
bp
->
u
.
bib›
.
‰ìm≠
[
i
] = ((
m≠w‹d
)~0Ë>> (
BITS_PER_MAPWORD
 - 
j
);

870 
bp
->
u
.
bib›
.
‰ìm≠
[
i
] = (
m≠w‹d
)~0;

871  
bp
;

872 
	}
}

876 
	$bib›_öô
()

878 
mös
, 
maxs
;

879 
sÁ˘
, 
smu…
, 
s
;

880 
i
;

882 i‡(
öôd⁄e
)

884 
öôd⁄e
++;

886 
fú°sbrk
 = 
√xçage
 = (*)––(
PTR
)
	`sbrk
(
PAGE_SIZE
+1Ë& 
PAGEMASK
) + PAGE_SIZE );

888 
mös
 = 
SMALL_SIZE
;

889 
maxs
 = 
PAGE_SIZE
;

890 
sÁ˘
 = ()
maxs
 / 
mös
;

891 
smu…
 = 
	`exp
(
	`log
(
sÁ˘
Ë/ 
NFREE
);

892 
s
 = 
smu…
, 
i
 = 0; i < 
NFREE
; i++, s *= smult) {

893 
‰ìhód
[
i
].
h
.
fwd
 = &freehead[i].h;

894 
‰ìhód
[
i
].
h
.
bwd
 = &freehead[i].h;

895 
‰ìhód
[
i
].
maxsize
 = (Ë(
mös
 * 
s
);

897 #ifde‡
FREESTAT


898 
‰ìhód
[
i
].
h
.
hód
 = &freehead[i];

901 
	}
}

905 
	$dump_mÆloc_d©a
()

907 
mbuf
[3000];

908 
u_bib›
, 
u_Æloc
, 
u_big
, 
n_bib›
, 
n_Æloc
, 
n_big
, 
a_bib›
, 
a_Æloc
, 
a_big
;

909 
des¸
 *
p
;

910 
i
, 
n
;

912 
u_bib›
 = 
u_Æloc
 = 
u_big
 = 
n_bib›
 = 
n_Æloc
 = 
n_big
 = 
a_bib›
 = 
a_Æloc
 = 
a_big
 = 0;

913 
i
 = 0; i < (
SMALL_SIZE
+
ALIGNMENT
-1)/ALIGNMENT; i++) {

914 
p
 = 
bib›s
[
i
];Ö;Ö =Ö->
d√xt
) {

915 
n
 = 
p
->
u
.
bib›
.
obj‰ì
 *Ö->u.bib›.
objsize
;

916 
n_bib›
 +
n
;

917 
u_bib›
 +
PAGE_SIZE
 - 
n
;

918 
a_bib›
 +
p
->
u
.
bib›
.
obj‰ì
;

921 
p
 = 
fú°∑ge
;Ö;Ö =Ö->
d√xt
) {

922 
block
 *
q
;

923 
q
 = (
block
 *)&
p
->
u
.
medium
.
d©a
; q->
√xt
; q = q->next) {

924 i‡(
q
->
busy
)

925 
u_Æloc
 +
	`OBJSIZE
(
q
);

927 
n_Æloc
 +
	`OBJSIZE
(
q
), 
a_Æloc
++;

930 
u_big
 = 
PAGE_SIZE
 * 
p_big
;

931 ()
	`•rötf
(
mbuf
, "\
%-17s %10s %10s %10s %10s\n\
%-17s %10d %10d %10d %10d\n\
%-17s %10d %10d %10d %10d (%d in freeÖages)\n\
%-17s %10d %10d %10d %10d\n\
%-17s %10d %10d %10d %10d\n\
%-17s %10d %10d %10d %10d (%d free) = %d bytes (page=%d)\n\
\n\
%-17s %10d %10d %10d %10d\n\
%-17s %10d %10d %10d %10d\n\
%-17s %10ld %10ld %10ld %10ld\n\
\n\
Ñequests: %d %d (a) \n\
",

946 "u£d mem‹y", 
u_bib›
, 
u_Æloc
, 
u_big
, u_bibop+u_alloc+u_big,

947 "‰ì mem‹y", 
n_bib›
, 
n_Æloc
, 
n_big
,Ç_bib›+n_Æloc+n_big+
p_‰ì
*
PAGE_SIZE
,Ö_free*PAGE_SIZE,

948 "u£d blocks", 
m_bib›
-
f_bib›
, 
m_Æloc
-
f_Æloc
, 
m_big
-
f_big
, m_bibop+m_alloc+m_big-(f_bibop+f_alloc+f_big),

949 "‰ì blocks", 
a_bib›
, 
a_Æloc
, 
a_big
,á_bibop +á_alloc +á_big,

950 "ÆloˇãdÖages", 
p_bib›
, 
p_Æloc
, 
p_big
,Ö_bib›+p_Æloc+p_big+
p_‰ì
+1,Ö_‰ì, (p_bib›+p_Æloc+p_big+p_‰ì+1)*
PAGE_SIZE
, PAGE_SIZE,

952 "# o‡mÆloc()", 
m_bib›
, 
m_Æloc
, 
m_big
, m_bibop+m_alloc+m_big,

953 "# o‡‰ì()", 
f_bib›
, 
f_Æloc
, 
f_big
, f_bibop+f_alloc+f_big,

954 "tŸÆáŒoˇti⁄", 
s_bib›
, 
s_Æloc
, 
s_big
, s_bibop+s_alloc+s_big,

955 
p_bib›
+
p_Æloc
+
p_big
+
p_‰ì
+1, (p_bib›+p_Æloc+p_big+p_‰ì+1)*
PAGE_SIZE
);

956 #ifde‡
FREESTAT


958 
xxxxx
[2000];

959 
k
, 
tf
;

960 ()
	`°r˝y
(
xxxxx
, "medium sizes:\n size unus split free joinálloc join1 join2 dropÑeal why skip\n");

961 
tf
 = 0, 
k
 = 0; k < 
NFREE
; k++) {

962 
‰ìblk
 *
p
;

963 
s
;

964 
s
 = 0, 
p
 = 
‰ìhód
[
k
].
h
.
fwd
;Ö != &freehead[k].h;Ö =Ö->fwd, s++)

966 ()
	`•rötf
(
xxxxx
+
	`°æí
(xxxxx), "%5d %4d %6d %6d %6d %6d %5d %5d %4d %5d %3d %5d\n",

967 
‰ìhód
[
k
].
maxsize
, 
s
,

968 
‰ìhód
[
k
].
n•lô
, fªehód[k].
n‰ì
, fªehód[k].
njoö
,

969 
‰ìhód
[
k
].
«Œoc
, fªehód[k].
njoö1
, fªehód[k].
njoö2
, fªehód[k].
ndr›
,

970 
‰ìhód
[
k
].
ƒól
, fªehód[k].
nwhy
, fªehód[k].
nskù
);

971 
tf
 +
s
;

973 ()
	`•rötf
(
xxxxx
+
	`°æí
(xxxxx), "tŸ=%d(%d)\n", 
tf
, 
a_Æloc
);

974 ()
	`°rˇt
(
mbuf
, 
xxxxx
);

977  
mbuf
;

978 
	}
}

	@bibopmalloc.h

1 *
dump_mÆloc_d©a
();

	@binaries.c

6 
	~<°rög.h
>

7 
	~<°dio.h
>

8 
	~<time.h
>

9 
	~<sys/ty≥s.h
>

10 
	~<sys/°©.h
>

11 
	~<°dlib.h
>

13 
	~"c⁄fig.h
"

15 #ifde‡
BINARIES


16 
	~"löt.h
"

17 
	~"m°rög.h
"

18 
	~"öãΩªt.h
"

19 
	~"obje˘.h
"

20 
	~"exec.h
"

21 
	~"sw≠.h
"

23 
FILE
 *
¸fûe
(*);

25 
	#MAGIC
 "CDBIN"

	)

27 
cuºít_time
;

28 
drivî_mtime
;

29 
comp_Êag
;

31 
FILE
 *
	$¸fûe
(
«me
)

32 *
«me
;

34 *
±r
, *
dú
 = 
	`°rög_c›y
(
«me
);

35 
°©
 
°
;

37 
±r
 = 
dú
;

38 
±r
 = 
	`°rchr
(ptr, '/');Ötr;Ötr = strchr(ptr + 1, '/'))

40 *
±r
 = '\0';

42 i‡(
	`°©
(
dú
, &
°
) == -1)

44 i‡(
	`mkdú
(
dú
, 0774) == -1)

46 
	`‰ì
(
dú
);

47  (
FILE
 *) 0;

50 i‡((
°
.
°_mode
 & 
S_IFMT
Ë!
S_IFDIR
)

52 i‡(
	`u∆ök
(
dú
) == -1 ||

53 
	`mkdú
(
dú
, 0774) == -1)

55 
	`‰ì
(
dú
);

56  (
FILE
 *) 0;

60 *
±r
 = '/';

62 
	`‰ì
(
dú
);

64  
	`f›í
(
«me
, "w");

65 
	}
}

68 
	$ˇlcuœã_off£ts
(
¥ogøm
 *
de°
, ¥ogøm *
¥og
)

70 
i
, 
j
;

72 
i
 = 0; 
£gm_desc
[i].
£˘i⁄s
; i++)

74 
£˘i⁄_desc
 *
£c
;

75 *
block
;

77 i‡(
£gm_desc
[
i
].
±r_off£t
 != -1)

78 
block
 = *(**)(((*)
¥og
Ë+ 
£gm_desc
[
i
].
±r_off£t
);

80 
block
 = (*)
¥og
;

81 
£c
 = 
£gm_desc
[
i
].
£˘i⁄s
;

83 
j
 = 0; 
£c
[j].
£˘i⁄
 != -1; j++)

85 i‡(
£c
[
j
].
±r_off£t
 != -1)

87 *(*)(((*)
de°
Ë+ 
£c
[
j
].
±r_off£t
) =

88 *(**)(((*)
¥og
Ë+ 
£c
[
j
].
±r_off£t
Ë- 
block
;

92 
	}
}

95 
	$ª°‹e_£˘i⁄s
(
¥ogøm
 *
de°
, ¥ogøm *
¥og
)

97 
i
, 
j
;

99 
i
 = 0; 
£gm_desc
[i].
£˘i⁄s
; i++)

101 
£˘i⁄_desc
 *
£c
;

102 *
block
;

104 i‡(
£gm_desc
[
i
].
±r_off£t
 != -1)

105 
block
 = *(**)(((*)
¥og
Ë+ 
£gm_desc
[
i
].
±r_off£t
);

107 
block
 = (*)
de°
;

109 i‡(
£gm_desc
[
i
].
sw≠_idx_off£t
 != -1)

110 *(*)(((*)
de°
Ë+ 
£gm_desc
[
i
].
sw≠_idx_off£t
) = 0;

112 
£c
 = 
£gm_desc
[
i
].
£˘i⁄s
;

114 
j
 = 0; 
£c
[j].
£˘i⁄
 != -1; j++)

116 i‡(
£c
[
j
].
±r_off£t
 != -1)

118 *(**)(((*)
de°
Ë+ 
£c
[
j
].
±r_off£t
) =

119 
block
 + *(*)(((*)
de°
Ë+ 
£c
[
j
].
±r_off£t
);

123 
	}
}

126 
	$ßve_bö¨y
(
¥og
)

127 
¥ogøm
 *
¥og
;

129 
i
;

130 
drivî_mtime
;

131 *
bö«me
;

132 
obje˘
 *
ma°î_ob
;

133 *
	`add_¶ash
(*);

134 
FILE
 *
f
;

135 
size_t
 
°rsize
 = 0;

136 
¥ogøm
 
pgm
;

137 
°rsize_ãŒ
;

138 
svÆue
 *
ªt
;

140 i‡(
ma°î_ob
)

142 
	`push_m°rög
(
	`add_¶ash
(
¥og
->
«me
));

143 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_VALID_SAVE_BINARY
, 1);

144 i‡(
ªt
 && (ªt->
ty≥
 !
T_NUMBER
 ||Ñë->
u
.
numbî
 == 0))

146 i‡(
comp_Êag
)

147 ()
	`Ârötf
(
°dîr
, "BIN Save for %sÇotállowed!\n",

148 
¥og
->
«me
);

152 
bö«me
 = (*)
	`Æloˇ
(
	`°æí
(
BINARIES
) +

153 
	`°æí
(
¥og
->
«me
) + 1);

154 ()
	`•rötf
(
bö«me
, "%s%s", 
BINARIES
, 
¥og
->
«me
);

156 i‡((
f
 = 
	`¸fûe
(
bö«me
)Ë=
NULL
)

158 i‡(
comp_Êag
)

159 ()
	`Ârötf
(
°dîr
, "BIN Can't create file %s!\n",

160 
bö«me
);

164 i‡(
	`fwrôe
(
MAGIC
, (), 
	`°æí
(MAGIC), 
f
) != strlen(MAGIC)) {

165 ()
	`f˛o£
(
f
);

166 ()
	`u∆ök
(
bö«me
);

167 i‡(
comp_Êag
)

168 ()
	`Ârötf
(
°dîr
, "BIN Error writing file %s!\n",

169 
bö«me
);

172 i‡(
	`fwrôe
((*)&
drivî_mtime
, (drivî_mtime), 1, 
f
) != 1) {

173 ()
	`f˛o£
(
f
);

174 ()
	`u∆ök
(
bö«me
);

175 i‡(
comp_Êag
)

176 ()
	`Ârötf
(
°dîr
, "BIN Error writing file %s!\n",

177 
bö«me
);

180 
°rsize_ãŒ
 = ()
	`·ñl
(
f
);

181 i‡(
	`fwrôe
((*)&
°rsize
, (°rsize), 1, 
f
) != 1) {

182 ()
	`f˛o£
(
f
);

183 ()
	`u∆ök
(
bö«me
);

184 i‡(
comp_Êag
)

185 ()
	`Ârötf
(
°dîr
, "BIN Error writing file %s!\n",

186 
bö«me
);

190 #ifde‡
USE_SWAP


191 
	`lﬂd_löío_‰om_sw≠
(
¥og
);

195 i‡(
	`fwrôe
((*)
¥og
, (
size_t
Ìrog->
tŸÆ_size
, 1, 
f
) != 1) {

196 ()
	`f˛o£
(
f
);

197 ()
	`u∆ök
(
bö«me
);

198 i‡(
comp_Êag
)

199 ()
	`Ârötf
(
°dîr
, "BIN Error writing file %s!\n",

200 
bö«me
);

203 i‡(
	`fwrôe
((*)
¥og
->
¥ogøm
, (
size_t
Ìrog->
exec_size
, 1, 
f
) != 1) {

204 ()
	`f˛o£
(
f
);

205 ()
	`u∆ök
(
bö«me
);

206 i‡(
comp_Êag
)

207 ()
	`Ârötf
(
°dîr
, "BIN Error writing file %s!\n",

208 
bö«me
);

212 i‡(
	`fwrôe
((*)
¥og
->
löe_numbîs
, (
size_t
Ìrog->
debug_size
, 1, 
f
) != 1) {

213 ()
	`f˛o£
(
f
);

214 ()
	`u∆ök
(
bö«me
);

215 i‡(
comp_Êag
)

216 ()
	`Ârötf
(
°dîr
, "BIN Error writing file %s!\n",

217 
bö«me
);

223 
i
 = 0; i < ()
¥og
->
num_öhîôed
; i++)

225 *
°r
;

226 
¥ogøm
 *
ùrog
 = 
¥og
->
öhîô
[
i
].prog;

227 
buff
[100];

229 
°r
 = 
ùrog
->
«me
;

230 i‡(
	`fwrôe
(
°r
, 
	`°æí
(°rË+ 1, 1, 
f
) != 1) {

231 ()
	`f˛o£
(
f
);

232 ()
	`u∆ök
(
bö«me
);

233 i‡(
comp_Êag
)

234 ()
	`Ârötf
(
°dîr
, "BIN Error writing file %s!\n",

235 
bö«me
);

238 
°rsize
 +
	`°æí
(
°r
) + 1;

239 ()
	`•rötf
(
buff
, "%d", 
ùrog
->
mod_time
);

240 i‡(
	`fwrôe
(
buff
, 
	`°æí
(buffË+ 1, 1, 
f
) != 1) {

241 ()
	`f˛o£
(
f
);

242 ()
	`u∆ök
(
bö«me
);

243 i‡(
comp_Êag
)

244 ()
	`Ârötf
(
°dîr
, "BIN Error writing file %s!\n",

245 
bö«me
);

248 
°rsize
 +
	`°æí
(
buff
) + 1;

250 
°r
 = 
¥og
->
öhîô
[
i
].
«me
;

251 i‡(
	`fwrôe
(
°r
, 
	`°æí
(°rË+ 1, 1, 
f
) != 1) {

252 ()
	`f˛o£
(
f
);

253 ()
	`u∆ök
(
bö«me
);

254 i‡(
comp_Êag
)

255 ()
	`Ârötf
(
°dîr
, "BIN Error writing file %s!\n",

256 
bö«me
);

259 
°rsize
 +
	`°æí
(
°r
) + 1;

265 
i
 = 0; i < ()
¥og
->
num_fun˘i⁄s
; i++)

267 *
°r
 = 
¥og
->
fun˘i⁄s
[
i
].
«me
;

269 i‡(
	`fwrôe
(
°r
, 
	`°æí
(°rË+ 1, 1, 
f
) != 1) {

270 ()
	`f˛o£
(
f
);

271 ()
	`u∆ök
(
bö«me
);

272 i‡(
comp_Êag
)

273 ()
	`Ârötf
(
°dîr
, "BIN Error writing file %s!\n",

274 
bö«me
);

277 
°rsize
 +
	`°æí
(
°r
) + 1;

281 
i
 = 0; i < ()
¥og
->
num_v¨übÀs
; i++)

283 *
°r
 = 
¥og
->
v¨übÀ_«mes
[
i
].
«me
;

285 i‡(
	`fwrôe
(
°r
, 
	`°æí
(°rË+ 1, 1, 
f
) != 1) {

286 ()
	`f˛o£
(
f
);

287 ()
	`u∆ök
(
bö«me
);

288 i‡(
comp_Êag
)

289 ()
	`Ârötf
(
°dîr
, "BIN Error writing file %s!\n",

290 
bö«me
);

293 
°rsize
 +
	`°æí
(
°r
) + 1;

296 i‡(!
°rsize
)

298 i‡(
	`fwrôe
((*)&
°rsize
, (°rsize), 1, 
f
) != 1) {

299 ()
	`f˛o£
(
f
);

300 ()
	`u∆ök
(
bö«me
);

301 i‡(
comp_Êag
)

302 ()
	`Ârötf
(
°dîr
, "BIN Error writing file %s!\n",

303 
bö«me
);

306 
°rsize
 = (strsize);

310 i‡(
	`f£ek
(
f
, ()
°rsize_ãŒ
, 
SEEK_SET
) != 0) {

311 ()
	`f˛o£
(
f
);

312 ()
	`u∆ök
(
bö«me
);

313 i‡(
comp_Êag
)

314 ()
	`Ârötf
(
°dîr
, "BIN Error writing file %s!\n",

315 
bö«me
);

318 i‡(
	`fwrôe
((*)&
°rsize
, (°rsize), 1, 
f
) != 1) {

319 ()
	`f˛o£
(
f
);

320 ()
	`u∆ök
(
bö«me
);

321 i‡(
comp_Êag
)

322 ()
	`Ârötf
(
°dîr
, "BIN Error writing file %s!\n",

323 
bö«me
);

329 
pgm
 = *
¥og
;

330 
	`ˇlcuœã_off£ts
(&
pgm
, 
¥og
);

331 i‡(
	`fwrôe
((*)&
pgm
, ’gm), 1, 
f
) != 1) {

332 ()
	`f˛o£
(
f
);

333 ()
	`u∆ök
(
bö«me
);

334 i‡(
comp_Êag
)

335 ()
	`Ârötf
(
°dîr
, "BIN Error writing file %s!\n",

336 
bö«me
);

340 #ifde‡
USE_SWAP


341 
	`sw≠_löío
(
¥og
);

344 i‡(
	`f˛o£
(
f
) != 0) {

345 ()
	`u∆ök
(
bö«me
);

346 i‡(
comp_Êag
)

347 ()
	`Ârötf
(
°dîr
, "BIN Error writing file %s!\n",

348 
bö«me
);

351 i‡(
comp_Êag
)

352 ()
	`Ârötf
(
°dîr
, "BIN %s saved!\n",

353 
bö«me
);

354 
	}
}

357 
	$lﬂd_bö¨y
(
FILE
 *
f
, *
 ame
)

359 
cuºít_id_numbî
;

360 
¥ogøm
 
pgm
;

361 
¥ogøm
 *
¥ogp
;

362 
¥ogøm
 *
¥og
;

363 *
öhîô_fûe
;

364 
drivî_mtime
;

365 
comp_drivî_mtime
;

366 
buf
[100];

367 *
°πab
, *
°Ωå
;

368 
size_t
 
°rsize
;

369 
i
;

370 
tŸÆ_¥og_block_size
, 
tŸÆ_¥ogøm_size
,

371 
tŸÆ_num_¥og_blocks
;

372 
pgm_£ek
;

373 
	`hash_func
 (
size
, 
fun˘i⁄
 *
‰om
,

374 
fun˘i⁄_hash
 *
to
);

375 i‡(
öhîô_fûe
)

377 
	`‰ì
(
öhîô_fûe
);

378 
öhîô_fûe
 = (*)0;

382 ()
	`‰ód
(
buf
, (), 
	`°æí
(
MAGIC
), 
f
);

383 ()
	`‰ód
((*)&
comp_drivî_mtime
, (comp_drivî_mtime), 1, 
f
);

384 i‡(
	`°∫cmp
(
buf
, 
MAGIC
, 
	`°æí
(MAGIC)) ||

385 
comp_drivî_mtime
 !
drivî_mtime
)

387 ()
	`f˛o£
(
f
);

388 i‡(
comp_Êag
)

389 ()
	`Ârötf
(
°dîr
, "BIN Wrong magic for %s!\n",

390 
 ame
);

392 
¥og
 = 0;

397 ()
	`‰ód
((*)&
°rsize
, (°rsize), 1, 
f
);

398 i‡(!
°rsize
)

400 
¥og
 = 0;

404 
pgm_£ek
 = ()
	`·ñl
(
f
);

405 ()
	`‰ód
((*)&
pgm
, ’gm), 1 ,
f
);

408 
¥ogp
 = (
¥ogøm
 *)
	`xÆloc
((
size_t
)
pgm
.
tŸÆ_size
);

409 
pgm
.
¥ogøm
 = 
	`xÆloc
((
size_t
Ìgm.
exec_size
);

410 
pgm
.
löe_numbîs
 = 
	`xÆloc
((
size_t
Ìgm.
debug_size
);

413 ()
	`f£ek
(
f
, ()
pgm_£ek
, 
SEEK_SET
);

414 ()
	`‰ód
((*)
¥ogp
, (
size_t
)
pgm
.
tŸÆ_size
, 1, 
f
);

415 ()
	`‰ód
(
pgm
.
¥ogøm
, (
size_t
Ìgm.
exec_size
, 1, 
f
);

416 ()
	`‰ód
(
pgm
.
löe_numbîs
, (
size_t
Ìgm.
debug_size
, 1, 
f
);

419 
	`ª°‹e_£˘i⁄s
(
¥ogp
, &
pgm
);

422 
°Ωå
 = 
°πab
 = 
	`xÆloc
(
°rsize
);

423 ()
	`‰ód
(
°πab
, 
°rsize
, 1, 
f
);

426 ()
	`f˛o£
(
f
);

429 i‡(
¥ogp
->
sizeof_ö˛ude_fûes
)

431 
°©
 
°b
;

432 
age
;

433 *
t
, *
s
;

435 
t
 = 
¥ogp
->
ö˛ude_fûes
;

436 
t
 < 
¥ogp
->
ö˛ude_fûes
 +Örogp->
sizeof_ö˛ude_fûes
)

438 
age
 = 
	`©oi
(
t
);

439 
s
 = 
	`°rchr
(
t
, ':');

440 i‡(!
s
)

442 i‡(
comp_Êag
)

443 ()
	`Ârötf
(
°dîr
,

445 
 ame
, 
t
);

447 
	`‰ì
(
pgm
.
¥ogøm
);

448 
	`‰ì
((*)
pgm
.
löe_numbîs
);

449 
	`‰ì
((*)
¥ogp
);

450 
	`‰ì
(
°πab
);

451 
¥og
 = 0;

455 
t
 = 
s
 + 1;

456 i‡(
	`°©
(
t
, &
°b
) == -1)

458 i‡(
comp_Êag
)

459 ()
	`Ârötf
(
°dîr
,

461 
 ame
, 
t
);

463 
	`‰ì
(
pgm
.
¥ogøm
);

464 
	`‰ì
((*)
pgm
.
löe_numbîs
);

465 
	`‰ì
((*)
¥ogp
);

466 
	`‰ì
(
°πab
);

467 
¥og
 = 0;

470 i‡(
°b
.
°_mtime
 !
age
)

472 i‡(
comp_Êag
)

473 ()
	`Ârötf
(
°dîr
,"BIN Included file changed (%s->%s)\n",

474 
 ame
, 
t
);

476 
	`‰ì
(
pgm
.
¥ogøm
);

477 
	`‰ì
((*)
pgm
.
löe_numbîs
);

478 
	`‰ì
((*)
¥ogp
);

479 
	`‰ì
(
°πab
);

480 
¥og
 = 0;

483 
t
 +
	`°æí
(t) + 1;

488 
i
 = 0; i < ()
¥ogp
->
num_öhîôed
 - 1; i++)

490 
obje˘
 *
	`föd_obje˘2
(*);

491 
obje˘
 *
ob
;

492 
mod_time
;

494 
ob
 = 
	`föd_obje˘2
(
°Ωå
);

495 i‡(!
ob
)

497 
öhîô_fûe
 = 
	`°rög_c›y
(
°Ωå
);

498 
i
--; i >= 0; i--)

499 
	`‰ì_s°rög
(
¥ogp
->
öhîô
[
i
].
«me
);

500 i‡(
comp_Êag
)

501 ()
	`Ârötf
(
°dîr
,"BIN Inherited fileÇotÜoaded (%s->%s)\n",

502 
 ame
, 
öhîô_fûe
);

504 
	`‰ì
(
pgm
.
¥ogøm
);

505 
	`‰ì
((*)
pgm
.
löe_numbîs
);

506 
	`‰ì
((*)
¥ogp
);

507 
	`‰ì
(
°πab
);

508 
¥og
 = 0;

511 
°Ωå
 +
	`°æí
(strptr) + 1;

512 
mod_time
 = 
	`©oi
(
°Ωå
);

513 i‡(
mod_time
 !
ob
->
¥og
->mod_time)

516 
i
--; i >= 0; i--)

517 
	`‰ì_s°rög
(
¥ogp
->
öhîô
[
i
].
«me
);

518 
	`‰ì
(
pgm
.
¥ogøm
);

519 
	`‰ì
((*)
pgm
.
löe_numbîs
);

520 
	`‰ì
((*)
¥ogp
);

521 
	`‰ì
(
°πab
);

522 i‡(
comp_Êag
)

523 ()
	`Ârötf
(
°dîr
,"BIN Inherited file changed (%s(%d)->%s(%d))\n",

524 
 ame
, 
mod_time
, 
ob
->
¥og
->
«me
, mod_time);

525 
¥og
 = 0;

528 
°Ωå
 +
	`°æí
(strptr) + 1;

529 
¥ogp
->
öhîô
[
i
].
¥og
 = 
ob
->prog;

530 
¥ogp
->
öhîô
[
i
].
«me
 = 
	`make_s°rög
(
°Ωå
);

531 
°Ωå
 +
	`°æí
(strptr) + 1;

536 i‡(
	`°rcmp
(
 ame
, 
°Ωå
))

538 i‡(
comp_Êag
)

539 ()
	`Ârötf
(
°dîr
,"BIN Wrong fileÇame (%s->%s)\n",

540 
 ame
, 
°Ωå
);

542 
i
--; i >= 0; i--)

543 
	`‰ì_s°rög
(
¥ogp
->
öhîô
[
i
].
«me
);

544 
	`‰ì
(
pgm
.
¥ogøm
);

545 
	`‰ì
((*)
pgm
.
löe_numbîs
);

546 
	`‰ì
((*)
¥ogp
);

547 
	`‰ì
(
°πab
);

548 
¥og
 = 0;

551 
¥ogp
->
«me
 = 
	`°rög_c›y
(
°Ωå
);

552 
°Ωå
 +
	`°æí
(strptr) + 1;

553 
°Ωå
 +
	`°æí
(strptr) + 1;

554 
¥ogp
->
öhîô
[
i
].
«me
 = 
	`make_s°rög
(
°Ωå
);

555 
°Ωå
 +
	`°æí
(strptr) + 1;

556 
¥ogp
->
öhîô
[
i
].
¥og
 =Örogp;

560 
i
 = 0; i < ()
¥ogp
->
num_fun˘i⁄s
; i++)

562 
¥ogp
->
fun˘i⁄s
[
i
].
«me
 =

563 
	`make_s°rög
(
°Ωå
);

564 
°Ωå
 +
	`°æí
(strptr) + 1;

565 #ifde‡
PROFILE_FUNS


566 
¥ogp
->
fun˘i⁄s
[
i
].
num_ˇŒs
 = 0;

567 
¥ogp
->
fun˘i⁄s
[
i
].
time_•ít
 = 0;

568 #ifde‡
SOLARIS


569 
¥ogp
->
fun˘i⁄s
[
i
].
ticks_ˇŒ
 = 0;

571 
¥ogp
->
fun˘i⁄s
[
i
].
°ime_ˇŒ
 = 0;

572 
¥ogp
->
fun˘i⁄s
[
i
].
utime_ˇŒ
 = 0;

578 
i
 = 0; i < ()
¥ogp
->
num_v¨übÀs
; i++)

580 
¥ogp
->
v¨übÀ_«mes
[
i
].
«me
 =

581 
	`make_s°rög
(
°Ωå
);

582 
°Ωå
 +
	`°æí
(strptr) + 1;

585 
	`‰ì
(
°πab
);

589 
	`hash_func
(
¥ogp
->
num_fun˘i⁄s
,Örogp->
fun˘i⁄s
,Örogp->
func_hash
);

591 
¥ogp
->
ªf
 = 1;

592 
¥ogp
->
sw≠_num
 = 0;

593 
¥ogp
->
id_numbî
 = 
cuºít_id_numbî
++;

594 #i‡
	`deföed
(
RUSAGE
Ë&& deföed(
PROFILE_OBJS
)

595 
¥ogp
->
˝u
 = 0;

597 
¥ogp
->
sw≠_löío_ödex
 = 0;

598 
¥ogp
->
lﬂd_time
 = 
cuºít_time
;

600 
i
 = 0; i < ()
¥ogp
->
num_öhîôed
 - 1; i++)

601 
	`ª„ªn˚_¥og
(
¥ogp
->
öhîô
[
i
].
¥og
, "inheritance");

603 
tŸÆ_¥og_block_size
 +
¥ogp
->
tŸÆ_size
;

604 
tŸÆ_¥ogøm_size
 +
¥ogp
->
exec_size
;

606 
tŸÆ_num_¥og_blocks
 += 1;

607 
	`ªgi°î_¥ogøm
(
¥ogp
);

608 
¥ogp
->
lﬂd_time
 = 
cuºít_time
;

609 #ifde‡
USE_SWAP


610 
	`sw≠_löío
(
¥ogp
);

613 
¥og
 = 
¥ogp
;

615 
	}
}

	@binaries.h

2 
	#LOAD_OK
 0

	)

3 
	#LOAD_INHERIT
 0

	)

4 
	#LIB_NOT_MAGIC
 1

	)

5 
	#LIB_LOAD_OBJ
 2

	)

6 
	#LIB_LOAD_PROG
 3

	)

7 
	#LIB_BLIB_SIZE
 4

	)

8 
	#LIB_YOUNG_INHERIT
 5

	)

9 
	#LIB_MEMSIZE
 6

	)

10 
	#LIB_YOUNG_INCLUDE
 7

	)

11 
	#LIB_BAD_INCLUDE
 8

	)

12 
	#MAGIC
 "BLIB"

	)

	@call_out.c

6 
	~<mem‹y.h
>

7 
	~<sig«l.h
>

8 
	~<°dio.h
>

9 
	~<sys/time.h
>

11 
	~"c⁄fig.h
"

12 
	~"löt.h
"

13 
	~"m°rög.h
"

14 
	~"öãΩªt.h
"

15 
	~"exec.h
"

16 
	~"obje˘.h
"

17 
	~"mud°©.h
"

18 
	~"maö.h
"

19 
	~"simuœã.h
"

20 
	~"ˇŒ_out.h
"

22 
öô_ˇŒ_out
();

23 
ˇŒ_out
(
timevÆ
 *);

25 #ifde‡
USE_SWAP


26 
	#FUNC_NAME
(
ob
, 
c›
)\

27 (
	`ac˚ss_¥ogøm
(
ob
->
¥og
->
öhîô
[
c›
->inherit].prog),\

28 
ob
->
¥og
->
öhîô
[
c›
->öhîô].¥og->
fun˘i⁄s
[c›->
fun
].
«me
)

	)

30 
	#FUNC_NAME
(
ob
, 
c›
)\

31 (
ob
->
¥og
->
öhîô
[
c›
->öhîô].¥og->
fun˘i⁄s
[c›->
fun
].
«me
)

	)

33 *
°rög_c›y
(*);

34 
evÆ_co°
, 
s_Êag
;

35 
Æ¨m_time
;

36 
svÆue
 *
•
;

37 
obje˘
 *
¥evious_ob
;

39 
	sˇŒ
 {

40 
˛osuª
 *
	mfunc
;

41 
	mªlﬂd
;

42 
	mwhí
;

43 
	mid
;

44 
ˇŒ
 *
	m√xt
;

45 
obje˘
 *
	mcomm™d_givî
;

48 
obje˘
 *
	gˇŒ_outs
[
NUM_SLOTS
];

49 
	gœ°
;

51 
	gnum_ˇŒ
;

52 
	gˇŒ_out_size
;

53 
	gˇŒ_id
;

58 
	$timî_Æ¨m
(
s
)

60 #ifde‡
USE_SWAP


61 
acc_sw≠_out_¥og
[60];

62 
acc_sw≠_out_obj
[60];

63 
acc_sw≠_ö_¥og
[60];

64 
acc_sw≠_ö_obj
[60];

65 
acc2_sw≠_out_¥og
[60];

66 
acc2_sw≠_out_obj
[60];

67 
acc2_sw≠_ö_¥og
[60];

68 
acc2_sw≠_ö_obj
[60];

69 
sw≠_out_obj_£c
, 
sw≠_out_obj_mö
, 
sw≠_out_obj
;

70 
sw≠_out_¥og_£c
, 
sw≠_out_¥og_mö
, 
sw≠_out_¥og
;

71 
sw≠_ö_obj_£c
, 
sw≠_ö_obj_mö
, 
sw≠_ö_obj
;

72 
sw≠_ö_¥og_£c
, 
sw≠_ö_¥og_mö
, 
sw≠_ö_¥og
;

73 
sw≠_out_obj_hour
, 
sw≠_ö_obj_hour
;

74 
sw≠_out_¥og_hour
, 
sw≠_ö_¥og_hour
;

76 i‡(
now
 % 
TIME_RES
 == 0)

78 
£c
 = 
now
 / 
TIME_RES
 % 60;

80 
sw≠_out_obj_mö
 = sw≠_out_obj_mö - 
acc_sw≠_out_obj
[
£c
] +

81 (
acc_sw≠_out_obj
[
£c
] = 
sw≠_out_obj_£c
 = 
sw≠_out_obj
);

82 
sw≠_out_obj
 = 0;

84 
sw≠_out_¥og_mö
 = sw≠_out_¥og_mö - 
acc_sw≠_out_¥og
[
£c
] +

85 (
acc_sw≠_out_¥og
[
£c
] = 
sw≠_out_¥og_£c
 = 
sw≠_out_¥og
);

86 
sw≠_out_¥og
 = 0;

89 
sw≠_ö_obj_mö
 = sw≠_ö_obj_mö - 
acc_sw≠_ö_obj
[
£c
] +

90 (
acc_sw≠_ö_obj
[
£c
] = 
sw≠_ö_obj_£c
 = 
sw≠_ö_obj
);

91 
sw≠_ö_obj
 = 0;

93 
sw≠_ö_¥og_mö
 = sw≠_ö_¥og_mö - 
acc_sw≠_ö_¥og
[
£c
] +

94 (
acc_sw≠_ö_¥og
[
£c
] = 
sw≠_ö_¥og_£c
 = 
sw≠_ö_¥og
);

95 
sw≠_ö_¥og
 = 0;

96 i‡(
now
 % (
TIME_RES
 * 60) == 0)

98 
mö
 = 
now
 / (
TIME_RES
 * 60) % 60;

100 
sw≠_out_obj_hour
 = sw≠_out_obj_hou∏- 
acc2_sw≠_out_obj
[
mö
] +

101 (
acc2_sw≠_out_obj
[
mö
] = 
sw≠_out_obj_mö
);

103 
sw≠_out_¥og_hour
 = sw≠_out_¥og_hou∏- 
acc2_sw≠_out_¥og
[
mö
] +

104 (
acc2_sw≠_out_¥og
[
mö
] = 
sw≠_out_¥og_mö
);

107 
sw≠_ö_obj_hour
 = sw≠_ö_obj_hou∏- 
acc2_sw≠_ö_obj
[
mö
] +

108 (
acc2_sw≠_ö_obj
[
mö
] = 
sw≠_ö_obj_mö
);

110 
sw≠_ö_¥og_hour
 = sw≠_ö_¥og_hou∏- 
acc2_sw≠_ö_¥og
[
mö
] +

111 (
acc2_sw≠_ö_¥og
[
mö
] = 
sw≠_ö_¥og_mö
);

115 
now
++;

116 
	}
}

120 
	$öô_ˇŒ_out
()

122 
ˇŒ_id
 = 1;

123 
œ°
 = 0;

124 #i‡
TIME_RES
 * 60 >
NUM_SLOTS


125 #îr‹ 
Thîe
 
mu°
 
be
 
m‹e
 
¶Ÿs
 
ö
 
the
 
ˇŒ_out
 
èbÀ


128 ()
	`sig«l
(
SIGALRM
, 
timî_Æ¨m
);

129 ()
	`uÆ¨m
(1000000/
TIME_RES
, 1000000/TIME_RES);

131 
	}
}

134 
	$num_ˇŒ_outs
(
obje˘
 *
ob
)

136 
ˇŒ
 *
c
;

137 
num_co
;

139 
num_co
 = 0, 
c
 = 
ob
->
ˇŒ_outs
; c;

140 
num_co
++, 
c
 = c->
√xt
) ;

141  
num_co
;

142 
	}
}

145 
	$ˇŒ_out_sw≠_obje˘s
(
obje˘
 *
ob1
, obje˘ *
ob2
)

147 
¶Ÿ
;

148 
obje˘
 **
obp
;

149 
ˇŒ
 *
tmp_co
;

151 i‡(
ob1
->
ˇŒ_outs
)

153 
¶Ÿ
 = 
ob1
->
ˇŒ_outs
->
whí
 & (
NUM_SLOTS
 - 1);

154 
obp
 = &(
ˇŒ_outs
[
¶Ÿ
]); *ob∞&& *ob∞!
ob1
;

155 
obp
 = &(*obp)->
√xt_ˇŒ_out
) ;

156 i‡(!*
obp
)

157 
	`Áèl
("Error in calloutÜist.\n");

158 *
obp
 = 
ob1
->
√xt_ˇŒ_out
;

160 i‡(
ob2
->
ˇŒ_outs
)

162 
¶Ÿ
 = 
ob2
->
ˇŒ_outs
->
whí
 & (
NUM_SLOTS
 - 1);

163 
obp
 = &(
ˇŒ_outs
[
¶Ÿ
]); *ob∞&& *ob∞!
ob2
;

164 
obp
 = &(*obp)->
√xt_ˇŒ_out
) ;

165 i‡(!*
obp
)

166 
	`Áèl
("Error in calloutÜist.\n");

167 *
obp
 = 
ob2
->
√xt_ˇŒ_out
;

170 
tmp_co
 = 
ob1
->
ˇŒ_outs
;

171 
ob1
->
ˇŒ_outs
 = 
ob2
->call_outs;

172 
ob2
->
ˇŒ_outs
 = 
tmp_co
;

174 i‡(
ob1
->
ˇŒ_outs
)

176 
¶Ÿ
 = 
ob1
->
ˇŒ_outs
->
whí
 & (
NUM_SLOTS
 - 1);

177 
obp
 = &(
ˇŒ_outs
[
¶Ÿ
]); *obp &&

178 (*
obp
)->
ˇŒ_outs
->
whí
 < 
ob1
->call_outs->when;

179 
obp
 = &(*obp)->
√xt_ˇŒ_out
) ;

180 
ob1
->
√xt_ˇŒ_out
 = *
obp
;

181 *
obp
 = 
ob1
;

184 i‡(
ob2
->
ˇŒ_outs
)

186 
¶Ÿ
 = 
ob2
->
ˇŒ_outs
->
whí
 & (
NUM_SLOTS
 - 1);

187 
obp
 = &(
ˇŒ_outs
[
¶Ÿ
]); *obp &&

188 (*
obp
)->
ˇŒ_outs
->
whí
 < 
ob2
->call_outs->when;

189 
obp
 = &(*obp)->
√xt_ˇŒ_out
) ;

190 
ob2
->
√xt_ˇŒ_out
 = *
obp
;

191 *
obp
 = 
ob2
;

194 
	}
}

197 
	$ö£π_ˇŒ_out
(
obje˘
 *
ob
, 
ˇŒ
 *
c›
)

199 
ˇŒ
 **
c›p
;

200 
obje˘
 **
obp
;

201 
¶Ÿ
;

205 
c›p
 = &
ob
->
ˇŒ_outs
; *c›∞&& (*c›p)->
whí
 < 
c›
->when;

206 
c›p
 = &(*c›p)->
√xt
) ;

207 
c›
->
√xt
 = *
c›p
;

208 *
c›p
 = 
c›
;

211 i‡(
c›p
 =&
ob
->
ˇŒ_outs
)

214 i‡(
c›
->
√xt
)

216 
¶Ÿ
 = 
c›
->
√xt
->
whí
 & (
NUM_SLOTS
 - 1);

217 
obp
 = &(
ˇŒ_outs
[
¶Ÿ
]); *ob∞&& *ob∞!
ob
;

218 
obp
 = &(*obp)->
√xt_ˇŒ_out
) ;

219 i‡(!*
obp
)

220 
	`Áèl
("Error in calloutÜist.\n");

221 *
obp
 = 
ob
->
√xt_ˇŒ_out
;

225 
¶Ÿ
 = 
ob
->
ˇŒ_outs
->
whí
 & (
NUM_SLOTS
 - 1);

226 
obp
 = &(
ˇŒ_outs
[
¶Ÿ
]);

227 *
obp
 && (*obp)->
ˇŒ_outs
->
whí
 < 
ob
->call_outs->when;

228 
obp
 = &(*obp)->
√xt_ˇŒ_out
) ;

229 
ob
->
√xt_ˇŒ_out
 = *
obp
;

230 *
obp
 = 
ob
;

232 
	}
}

235 
	$‰ì_ˇŒ
(
ˇŒ
 *
c›
)

237 
	`‰ì_˛osuª
(
c›
->
func
);

238 i‡(
c›
->
comm™d_givî
)

239 
	`‰ì_obje˘
(
c›
->
comm™d_givî
, "free_call");

240 
	`‰ì
((*)
c›
);

241 
num_ˇŒ
--;

242 
ˇŒ_out_size
 -(
ˇŒ
);

243 
	}
}

246 
	$√w_ˇŒ_out
(
˛osuª
 *
fun
, 
dñay
, 
ªlﬂd
)

248 
ˇŒ
 *
c›
;

250 i‡(
dñay
 <= 0)

251 
dñay
 = 1;

253 i‡(
ªlﬂd
 <= 0)

254 
ªlﬂd
 = 0;

256 i‡(
	`num_ˇŒ_outs
(
cuºít_obje˘
Ë>
MAX_CALL_OUT
) {

257 
	`dñëe_Æl_ˇŒs
(
cuºít_obje˘
);

258 
	`îr‹
("too manyálarms in object\n");

261 
c›
 = (
ˇŒ
 *)
	`xÆloc
((call));

262 
num_ˇŒ
++;

263 
ˇŒ_out_size
 +(
ˇŒ
);

265 
c›
->
func
 = 
fun
;

266 
	`INCREF
(
fun
->
ªf
);

267 
c›
->
ªlﬂd
 =Ñeload;

268 
c›
->
whí
 = 
Æ¨m_time
 + 
dñay
;

270 i‡(
c›
->
whí
 < 
œ°
)

271 
	`Áèl
("Error in callout!\n");

272 
c›
->
id
 = 
ˇŒ_id
++;

273 
c›
->
comm™d_givî
 = command_giver;

274 i‡(
comm™d_givî
)

275 
	`INCREF
(
comm™d_givî
->
ªf
);

276 
	`ö£π_ˇŒ_out
(
cuºít_obje˘
, 
c›
);

277  
c›
->
id
;

278 
	}
}

281 
	$dñëe_ˇŒ
(
obje˘
 *
ob
, 
ˇŒ_idít
)

283 
ˇŒ
 **
c›p
, *
c›
;

284 
obje˘
 **
pob
;

286 
c›p
 = &
ob
->
ˇŒ_outs
; *c›∞&& (*c›p)->
id
 !
ˇŒ_idít
;

287 
c›p
 = &(*c›p)->
√xt
) ;

288 i‡(!*
c›p
)

291 
c›
 = *
c›p
;

292 *
c›p
 = (*c›p)->
√xt
;

295 i‡(
c›p
 =&
ob
->
ˇŒ_outs
)

297 
¶Ÿ
;

299 
¶Ÿ
 = 
c›
->
whí
 & (
NUM_SLOTS
 - 1);

300 
pob
 = &
ˇŒ_outs
[
¶Ÿ
]; *pob && *pob !
ob
;

301 
pob
 = &(*pob)->
√xt_ˇŒ_out
) ;

302 i‡(!*
pob
)

303 
	`Áèl
("Corrupted calloutÜist.\n");

304 *
pob
 = 
ob
->
√xt_ˇŒ_out
;

307 i‡(
ob
->
ˇŒ_outs
)

309 
¶Ÿ
 = 
ob
->
ˇŒ_outs
->
whí
 & (
NUM_SLOTS
 - 1);

310 
pob
 = &
ˇŒ_outs
[
¶Ÿ
];

311 *
pob
 && (*pob)->
ˇŒ_outs
->
whí
 < 
ob
->call_outs->when;

312 
pob
 = &(*pob)->
√xt_ˇŒ_out
) ;

313 
ob
->
√xt_ˇŒ_out
 = (*
pob
);

314 *
pob
 = 
ob
;

317 
	`‰ì_ˇŒ
(
c›
);

318 
	}
}

321 
	$dñëe_Æl_ˇŒs
(
obje˘
 *
ob
)

323 
¶Ÿ
;

324 
obje˘
 **
pob
;

325 
ˇŒ
 *
√xt
, *
c›
;

327 i‡(!(
ob
->
ˇŒ_outs
))

329 
¶Ÿ
 = 
ob
->
ˇŒ_outs
->
whí
 & (
NUM_SLOTS
 - 1);

330 
pob
 = &
ˇŒ_outs
[
¶Ÿ
]; *pob && *pob !
ob
;

331 
pob
 = &(*pob)->
√xt_ˇŒ_out
);

332 i‡(!*
pob
)

333 
	`Áèl
("Corrupt calloutÜist.\n");

335 *
pob
 = 
ob
->
√xt_ˇŒ_out
;

336 
c›
 = 
ob
->
ˇŒ_outs
; c›; c› = 
√xt
)

338 
√xt
 = 
c›
->next;

339 
	`‰ì_ˇŒ
(
c›
);

341 
ob
->
ˇŒ_outs
 = 0;

342 
	}
}

351 
ve˘‹
 *

352 
	$gë_ˇŒ
(
obje˘
 *
ob
, 
ˇŒ_idít
)

354 
ve˘‹
 *
vÆ
;

355 
ˇŒ
 *
c›
;

357 
c›
 = 
ob
->
ˇŒ_outs
; c› && c›->
id
 !
ˇŒ_idít
; c› = c›->
√xt
)

359 i‡(!
c›
)

362 
vÆ
 = 
	`Æloˇã_¨øy
(5);

364 
vÆ
->
ôem
[0].
ty≥
 = 
T_NUMBER
;

365 
vÆ
->
ôem
[0].
u
.
numbî
 = 
c›
->
id
;

367 
vÆ
->
ôem
[1].
ty≥
 = 
T_STRING
;

368 
vÆ
->
ôem
[1].
°rög_ty≥
 = 
STRING_MSTRING
;

369 
vÆ
->
ôem
[1].
u
.
°rög
 = 
	`make_m°rög
(
	`gë˛osuª«me
(
c›
->
func
));

371 
vÆ
->
ôem
[2].
ty≥
 = 
T_FLOAT
;

372 
vÆ
->
ôem
[2].
u
.
ªÆ
 = (()
c›
->
whí
 - 
Æ¨m_time
Ë/ 
TIME_RES
;

373 i‡(
vÆ
->
ôem
[2].
u
.
ªÆ
 < 0.0)

374 
vÆ
->
ôem
[2].
u
.
ªÆ
 = 0.0;

375 
vÆ
->
ôem
[3].
ty≥
 = 
T_FLOAT
;

376 
vÆ
->
ôem
[3].
u
.
ªÆ
 = (()
c›
->
ªlﬂd
Ë/ 
TIME_RES
;

378 
vÆ
->
ôem
[4].
ty≥
 = 
T_POINTER
;

379 
vÆ
->
ôem
[4].
u
.
vec
 = 
c›
->
func
->
fu«rgs
;

380 
	`INCREF
(
c›
->
func
->
fu«rgs
->
ªf
);

382  
vÆ
;

383 
	}
}

392 
ve˘‹
 *

393 
	$gë_ˇŒs
(
obje˘
 *
ob
)

395 
ve˘‹
 *
ªt
;

396 
ˇŒ
 *
c›
;

397 
i
;

399 
i
 = 0, 
c›
 = 
ob
->
ˇŒ_outs
; c›; i++, c› = c›->
√xt
)

401 
ªt
 = 
	`Æloˇã_¨øy
(
i
);

403 
i
 = 0, 
c›
 = 
ob
->
ˇŒ_outs
; c›; i++, c› = c›->
√xt
)

405 
ve˘‹
 *
vÆ
;

407 
vÆ
 = 
	`Æloˇã_¨øy
(5);

409 
vÆ
->
ôem
[0].
ty≥
 = 
T_NUMBER
;

410 
vÆ
->
ôem
[0].
u
.
numbî
 = 
c›
->
id
;

412 
vÆ
->
ôem
[1].
ty≥
 = 
T_STRING
;

413 
vÆ
->
ôem
[1].
°rög_ty≥
 = 
STRING_MSTRING
;

414 
vÆ
->
ôem
[1].
u
.
°rög
 = 
	`make_m°rög
(
	`gë˛osuª«me
(
c›
->
func
));

416 
vÆ
->
ôem
[2].
ty≥
 = 
T_FLOAT
 ;

417 
vÆ
->
ôem
[2].
u
.
ªÆ
 = (()
c›
->
whí
 - 
Æ¨m_time
Ë/ 
TIME_RES
;

418 i‡(
vÆ
->
ôem
[2].
u
.
ªÆ
 < 0.0)

419 
vÆ
->
ôem
[2].
u
.
ªÆ
 = 0.0;

421 
vÆ
->
ôem
[3].
ty≥
 = 
T_FLOAT
;

422 
vÆ
->
ôem
[3].
u
.
ªÆ
 = (()
c›
->
ªlﬂd
Ë/ 
TIME_RES
;

424 
vÆ
->
ôem
[4].
ty≥
 = 
T_POINTER
;

425 
vÆ
->
ôem
[4].
u
.
vec
 = 
c›
->
func
->
fu«rgs
;

426 
	`INCREF
(
c›
->
func
->
fu«rgs
->
ªf
);

428 
ªt
->
ôem
[
i
].
ty≥
 = 
T_POINTER
;

429 
ªt
->
ôem
[
i
].
u
.
vec
 = 
vÆ
;

431  
ªt
;

432 
	}
}

434 
	gcuºít_ˇŒ_out_id
;

435 
obje˘
 *
	gcuºít_ˇŒ_out_obje˘
;

437 
	göhibôˇŒouts
 = 0;

443 
	$√xt_ˇŒ_out
(
œ°_Æ¨m
, 
timevÆ
 *
tvp
)

445 
íd
, 
¶Ÿ
;

450 
íd
 = (
Æ¨m_time
 + 60 * 
TIME_RES
Ë& (
NUM_SLOTS
 - 1);

451 
¶Ÿ
 = 
œ°_Æ¨m
 & (
NUM_SLOTS
 - 1);

456 i‡(
ˇŒ_outs
[
¶Ÿ
]) {

460 i‡(
ˇŒ_outs
[
¶Ÿ
]->ˇŒ_outs->
whí
 < 
Æ¨m_time
) {

461 
tvp
->
tv_£c
 = 0;

462 
tvp
->
tv_u£c
 = 0;

469 i‡(
ˇŒ_outs
[
¶Ÿ
]->ˇŒ_outs->
whí
 - 
Æ¨m_time
 < 
TIME_RES
 * 60) {

470 
tvp
->
tv_£c
 = (
ˇŒ_outs
[
¶Ÿ
]->ˇŒ_outs->
whí
 - 
Æ¨m_time
Ë/ 
TIME_RES
;

471 
tvp
->
tv_u£c
 = (
ˇŒ_outs
[
¶Ÿ
]->ˇŒ_outs->
whí
 - 
Æ¨m_time
Ë% 
TIME_RES
 * 1000000 / TIME_RES;

475 
¶Ÿ
 = (¶Ÿ + 1Ë& (
NUM_SLOTS
 - 1);

476 } 
¶Ÿ
 !
íd
);

477 
	}
}

480 
	$ˇŒ_out
(
timevÆ
 *
tvp
)

482 
ˇŒ
 *
c›
, **
c›p
;

483 
obje˘
 *
ob
, **
obp
;

484 
gdex˚±i⁄
 
ex˚±i⁄_‰ame
;

485 
obje˘
 *
comm™d_givî
;

486 
obje˘
 *
cuºít_öãø˘ive
;

487 vﬁ©ûê
sum_evÆ
 = 0;

488 vﬁ©ûê
sum_time
 = 0;

489 vﬁ©ûê
sum_±ime
 = 0;

490 vﬁ©ûê
num_d⁄e
 = 0;

491 
ˇodesc
[100];

492 
˛osuª
 *
thefun
;

494 
tvp
->
tv_£c
 = 60;

495 
tvp
->
tv_u£c
 = 0;

497 i‡(
öhibôˇŒouts
)

500 i‡(
œ°
 >
Æ¨m_time
)

502 
	`√xt_ˇŒ_out
(
œ°
, 
tvp
);

506 
ex˚±i⁄_‰ame
.
e_ex˚±i⁄
 = 
ex˚±i⁄
;

507 
ex˚±i⁄_‰ame
.
e_ˇtch
 = 0;

509 
cuºít_öãø˘ive
 = 0;

510 ; 
œ°
 <
Æ¨m_time
;Üast++)

512 
¶Ÿ
, 
n¶Ÿ
;

514 
¶Ÿ
 = 
œ°
 & (
NUM_SLOTS
 - 1);

516 
ˇŒ_outs
[
¶Ÿ
] &&

517 
ˇŒ_outs
[
¶Ÿ
]->ˇŒ_outs->
whí
 <
œ°
)

520 
ob
 = 
ˇŒ_outs
[
¶Ÿ
];

521 
ˇŒ_outs
[
¶Ÿ
] = 
ob
->
√xt_ˇŒ_out
;

522 
c›
 = 
ob
->
ˇŒ_outs
;

523 
ob
->
ˇŒ_outs
 = 
c›
->
√xt
;

525 i‡(
c›
->
ªlﬂd
 > 0)

527 
cuºít_ˇŒ_out_id
 = 
c›
->
id
;

528 
c›
->
whí
 = 
Æ¨m_time
 + c›->
ªlﬂd
;

529 i‡(
c›
->
whí
 < 
œ°
)

530 
	`Áèl
("Error in callouts!\n");

532 
c›p
 = &
ob
->
ˇŒ_outs
;

533 *
c›p
 && (*c›p)->
whí
 < 
c›
->when;

534 
c›p
 = &(*c›p)->
√xt
) ;

535 
c›
->
√xt
 = *
c›p
;

536 *
c›p
 = 
c›
;

539 
cuºít_ˇŒ_out_id
 = 0;

541 i‡(
ob
->
ˇŒ_outs
)

543 
n¶Ÿ
 = 
ob
->
ˇŒ_outs
->
whí
 & (
NUM_SLOTS
 - 1);

544 
obp
 = &
ˇŒ_outs
[
n¶Ÿ
];

545 *
obp
 && (*obp)->
ˇŒ_outs
->
whí
 < 
ob
->call_outs->when;

546 
obp
 = &(*obp)->
√xt_ˇŒ_out
) ;

547 
ob
->
√xt_ˇŒ_out
 = *
obp
;

548 *
obp
 = 
ob
;

552 i‡(
c›
->
comm™d_givî
 &&

553 
c›
->
comm™d_givî
->
Êags
 & 
O_DESTRUCTED
)

555 
	`‰ì_obje˘
(
c›
->
comm™d_givî
, "call_out");

556 
c›
->
comm™d_givî
 = 0;

560 i‡(
c›
->
comm™d_givî
 &&

561 
c›
->
comm™d_givî
->
Êags
 & 
O_ENABLE_COMMANDS
)

562 
comm™d_givî
 = 
c›
->command_giver;

563 i‡(
ob
->
Êags
 & 
O_ENABLE_COMMANDS
)

564 
comm™d_givî
 = 
ob
;

566 
comm™d_givî
 = 0;

567 i‡(
s_Êag
)

568 
	`ª£t_mud°©us
();

569 
evÆ_co°
 = 0;

571 
cuºít_ˇŒ_out_obje˘
 = 
cuºít_obje˘
 = 
ob
;

572 
	`INCREF
(
cuºít_ˇŒ_out_obje˘
->
ªf
);

574 
thefun
 = 
c›
->
func
;

575 
	`INCREF
(
thefun
->
ªf
);

576 i‡(
c›
->
ªlﬂd
 <= 0)

577 
	`‰ì_ˇŒ
(
c›
);

578 i‡(
thefun
->
funobj
 !
ob
)

579 
¥evious_ob
 = 
ob
;

581 i‡(
	`£tjmp
(
ex˚±i⁄_‰ame
.
e_c⁄ãxt
)) {

582 
	`˛ór_°©e
();

584 
	`˛ór_°©e
();

585 
	`debug_mesßge
("Error in call out.\n");

586 i‡(
cuºít_ˇŒ_out_id
)

589 
	`debug_mesßge
("CÆ»ouà%†tu∫ed of‡ö %s.\n", 
	`gë˛osuª«me
(
thefun
),

590 
cuºít_ˇŒ_out_obje˘
->
«me
);

591 
	`dñëe_ˇŒ
(
cuºít_ˇŒ_out_obje˘
, 
cuºít_ˇŒ_out_id
);

593 
	`‰ì_˛osuª
(
thefun
);

594 
	`‰ì_obje˘
(
cuºít_ˇŒ_out_obje˘
, "call_out");

598 
	`upd©e_Æ¨m_av
();

600 
ex˚±i⁄
 = &
ex˚±i⁄_‰ame
;

601 
	`upd©e_Æ¨m_av
();

602 ()
	`ˇŒ_v¨
(0, 
thefun
);

603 
	`p›_°ack
();

605 i‡(
s_Êag
)

607 
num_d⁄e
++;

608 
sum_evÆ
 +
evÆ_co°
;

609 
sum_time
 +
	`gë_mûlôime
();

610 
sum_±ime
 +
	`gë_¥o˚s°ime
();

611 ()
	`•rötf
(
ˇodesc
,"CAO:%s", 
	`gë˛osuª«me
(
thefun
));

612 
	`¥öt_mud°©us
(
ˇodesc
, 
evÆ_co°
,

613 
	`gë_mûlôime
(), 
	`gë_¥o˚s°ime
());

615 
	`‰ì_˛osuª
(
thefun
);

616 
	`‰ì_obje˘
(
cuºít_ˇŒ_out_obje˘
, "call_out");

618 
¥evious_ob
 = 0;

621 
ex˚±i⁄
 = 
ex˚±i⁄_‰ame
.
e_ex˚±i⁄
;

622 
	`√xt_ˇŒ_out
(
œ°
, 
tvp
);

623 i‡(
s_Êag
 && 
num_d⁄e
)

625 
	`ª£t_mud°©us
();

626 ()
	`•rötf
(
ˇodesc
,"CÆl_ouà(%d)", 
num_d⁄e
);

627 
	`¥öt_mud°©us
(
ˇodesc
, 
sum_evÆ
, 
sum_time
, 
sum_±ime
);

629 
	}
}

631 #ifde‡
DEBUG


633 
	$cou¡_ªf_‰om_ˇŒ_outs
()

635 
i
;

636 
obje˘
 *
ob
;

637 
ˇŒ
 *
c›
;

639 
i
 = 0; i < 
NUM_SLOTS
; i++)

640 
ob
 = 
ˇŒ_outs
[
i
]; ob; ob = ob->
√xt_ˇŒ_out
)

641 
c›
 = 
ob
->
ˇŒ_outs
; c›; c› = c›->
√xt
)

644 
c›
->
v
->
ôem
->
ty≥
)

646 
T_POINTER
:

647 
c›
->
v
->
ôem
->
u
.
vec
->
exåa_ªf
++;

649 
T_OBJECT
:

650 
c›
->
v
->
ôem
->
u
.
ob
->
exåa_ªf
++;

654 i‡(
c›
->
comm™d_givî
)

655 
c›
->
comm™d_givî
->
exåa_ªf
++;

657 
	}
}

	@call_out.h

1 
dñëe_Æl_ˇŒs
(
obje˘
 *
ob
);

	@clib/efun.c

1 
	~<°dio.h
>

2 
	~<°rög.h
>

4 
	~"../löt.h
"

5 
	~"../öãrÁ˚.h
"

6 
	~"../obje˘.h
"

7 
	~"../m°rög.h
"

8 
	~"../simuœã.h
"

11 
obje˘
 *
¥evious_ob
;

12 
obje˘
 *
cuºít_öãø˘ive
;

27 
	#QS_MAX_REC
 32

	)

28 
	#A
 
Â
->
u
.
vec
->
ôem


	)

31 
	$efun_s‹t
(
svÆue
 *
Â
)

33 
l
, 
c
, 
r
, 
i
;

34 
ss
[
QS_MAX_REC
], 
es
[QS_MAX_REC], 
p
;

35 
°¨t
, 
íd
;

36 
˛osuª
 *
com∑ª
 = 
NULL
;

37 
svÆue
 
h
, 
t
;

39 i‡(
Â
[0].
ty≥
 =
T_POINTER
)

41 
°¨t
 = 
p
 = 0;

42 
íd
 = 
Â
[0].
u
.
vec
->
size
;

43 i‡(
Â
[1].
ty≥
 =
T_FUNCTION
) {

44 
com∑ª
 = 
Â
[1].
u
.
func
;

45 
p
 || (
íd
 - 
°¨t
) > 1)

47 i‡((
íd
 - 
°¨t
) < 2)

49 
°¨t
 = 
ss
[--
p
];

50 
íd
 = 
es
[
p
];

54 
h
 = 
A
[((
°¨t
 + 
íd
) / 2)];

55 
c
 = 
l
 = 
°¨t
, 
r
 = 
íd
; c <Ñ;)

57 
	`push_svÆue
(&
A
[
c
]);

58 
	`push_svÆue
(&
h
);

59 ()
	`ˇŒ_v¨
(2, 
com∑ª
);

60 
i
 = ((
•
->
ty≥
 =
T_NUMBER
Ë? (•->
u
.
numbî
) : 0);

61 
	`p›_°ack
();

62 i‡(
i
 < 0)

64 
t
 = 
A
[
l
];

65 
A
[
l
++] = A[
c
];

66 
A
[
c
++] = 
t
;

68 i‡(
i
 > 0)

70 
t
 = 
A
[--
r
];

71 
A
[
r
] = A[
c
];

72 
A
[
c
] = 
t
;

75 
c
++;

77 i‡((
l
 - 
°¨t
Ë< (
íd
 - 
c
))

79 
ss
[
p
] = 
c
;

80 
es
[
p
++] = 
íd
;

81 
íd
 = 
l
;

85 
ss
[
p
] = 
°¨t
;

86 
es
[
p
++] = 
l
;

87 
°¨t
 = 
c
;

94 
p
 || (
íd
 - 
°¨t
) > 1)

96 i‡((
íd
 - 
°¨t
) < 2)

98 
°¨t
 = 
ss
[--
p
];

99 
íd
 = 
es
[
p
];

103 
h
 = 
A
[((
°¨t
 + 
íd
) / 2)];

104 
c
 = 
l
 = 
°¨t
, 
r
 = 
íd
; c <Ñ;)

106 (
A
[
c
].
ty≥
 =
h
.type) ? A[c].type : 0)

108 
T_NUMBER
:

109 
i
 = (
A
[
c
].
u
.
numbî
 - 
h
.u.number);

111 
T_FLOAT
:

112 
i
 = (((
A
[
c
].
u
.
ªÆ
 - 
h
.u.real) < 0) ?

114 ((
A
[
c
].
u
.
ªÆ
 - 
h
.u.real) > 0) ? 1 : 0);

116 
T_STRING
:

117 
i
 = (
	`°rcmp
(
A
[
c
].
u
.
°rög
, 
h
.u.string ));

120 
i
 = (
A
[
c
].
ty≥
 - 
h
.type);

122 i‡(
i
 < 0)

124 
t
 = 
A
[
l
];

125 
A
[
l
++] = A[
c
];

126 
A
[
c
++] = 
t
;

128 i‡(
i
 > 0)

130 
t
 = 
A
[--
r
];

131 
A
[
r
] = A[
c
];

132 
A
[
c
] = 
t
;

135 
c
++;

137 i‡((
l
 - 
°¨t
Ë< (
íd
 - 
c
))

139 
ss
[
p
] = 
c
;

140 
es
[
p
++] = 
íd
;

141 
íd
 = 
l
;

145 
ss
[
p
] = 
°¨t
;

146 
es
[
p
++] = 
l
;

147 
°¨t
 = 
c
;

153 
	`push_svÆue
(
Â
);

154 
	}
}

156 
func
 
	gfunc_s‹t
 =

159 
efun_s‹t


163 
	$efun_ˇt_fûe
(
svÆue
 *
Â
)

165 
ªad_fûe_Àn
;

166 *
°r
;

168 i‡(
Â
[0].
ty≥
 !
T_STRING
 || fp[1].ty≥ !
T_NUMBER


169 || 
Â
[2].
ty≥
 !
T_NUMBER
)

171 
	`push_numbî
(0);

174 
°r
 = 
	`ªad_fûe
(
Â
[0].
u
.
°rög
, fp[1].u.
numbî
, fp[2].u.number);

175 i‡(
°r
)

177 
	`push_m°rög
(
	`make_m°rög
(
°r
));

178 
	`‰ì
(
°r
);

179 i‡(
comm™d_givî
)

180 ()
	`≠∂y
("ˇtch_ãŒ", 
comm™d_givî
, 1, 0);

182 ()
	`≠∂y
("ˇtch_ãŒ", 
cuºít_öãø˘ive
, 1, 0);

183 
	`push_numbî
(
ªad_fûe_Àn
);

186 
	`push_numbî
(0);

187 
	}
}

189 
func
 
	gfunc_ˇt_fûe
 =

192 
efun_ˇt_fûe
,

196 
	$efun_ãŒ_room
(
svÆue
 *
Â
)

198 
obje˘
 *
room
 = 0, *
ob
, *
ç
;

199 
svÆue
 *
obli°
 = 
NULL
;

200 
i
, 
¥öt
, 
size
;

202 
	`push_numbî
(0);

204 i‡(
Â
[3].
ty≥
 =
T_OBJECT
)

205 
ç
 = 
Â
[3].
u
.
ob
;

206 i‡(
comm™d_givî
 && !(comm™d_givî->
Êags
 & 
O_DESTRUCTED
))

207 
ç
 = 
comm™d_givî
;

209 
ç
 = 0;

211 i‡(
Â
[0].
ty≥
 =
T_STRING
)

212 
room
 = 
	`föd_obje˘2
(
Â
[0].
u
.
°rög
);

213 i‡(
Â
[0].
ty≥
 =
T_OBJECT
)

214 
room
 = 
Â
[0].
u
.
ob
;

215 i‡(!
room
)

217 
Â
[2].
ty≥
)

219 
T_OBJECT
:

220 
size
 = 1;

221 
obli°
 = &
Â
[2];

223 
T_POINTER
:

224 
size
 = 
Â
[2].
u
.
vec
->size;

225 
obli°
 = 
Â
[2].
u
.
vec
->
ôem
;

228 
size
 = 0;

233 
ob
 = 
room
->
c⁄èös
; ob; ob = ob->
√xt_öv
)

235 
¥öt
 = 1;

236 
i
 = 0; i < 
size
; i++)

237 i‡(
obli°
[
i
].
u
.
ob
 == ob)

239 
¥öt
 = 0;

243 i‡((
ob
->
Êags
 & 
O_ENABLE_COMMANDS
Ë&& 
¥öt
)

245 
	`push_svÆue
(&
Â
[1]);

246 
	`push_obje˘
(
ç
);

247 ()
	`≠∂y
("ˇtch_msg", 
ob
, 2, 0);

252 
¥öt
 = 1; 
ob
 = 
room
;

253 
i
 = 0; i < 
size
; i++)

254 i‡(
obli°
[
i
].
u
.
ob
 == ob)

256 
¥öt
 = 0;

259 i‡((
ob
->
Êags
 & 
O_ENABLE_COMMANDS
Ë&& 
¥öt
)

261 
	`push_svÆue
(&
Â
[1]);

262 
	`push_obje˘
(
ç
);

263 ()
	`≠∂y
("ˇtch_msg", 
ob
, 2, 0);

265 
	}
}

268 
func
 
	gfunc_ãŒ_room
 =

271 
efun_ãŒ_room
,

275 
	$efun_wrôe
(
svÆue
 *
Â
)

277 
	`push_numbî
(0);

279 i‡(!
comm™d_givî
)

281 i‡(
Â
[0].
ty≥
 =
T_STRING
)

282 ()
	`¥ötf
("%s", 
Â
[0].
u
.
°rög
);

285 
	`push_svÆue
(
Â
);

286 ()
	`≠∂y
("ˇtch_ãŒ", 
comm™d_givî
, 1, 0);

287 
	}
}

288 
func
 
	gfunc_wrôe
 =

291 
efun_wrôe
,

296 
	$efun_ßy
(
svÆue
 *
Â
)

298 
obje˘
 *
ç
, *
ob
;

299 
svÆue
 
ç_svÆue
, *
obli°
 = 
NULL
;

301 
size
, 
i
;

302 
¥öt
;

304 
	`push_numbî
(0);

306 i‡(
comm™d_givî
 && !(comm™d_givî->
Êags
 & 
O_DESTRUCTED
))

307 
ç
 = 
comm™d_givî
;

309 
ç
 = 
¥evious_ob
;

311 
ç_svÆue
.
ty≥
=
T_OBJECT
;

312 #ifde‡
PURIFY


313 
ç_svÆue
.
°rög_ty≥
 = -1;

315 
ç_svÆue
.
u
.
ob
=
ç
;

317 
Â
[1].
ty≥
)

319 
T_OBJECT
:

320 
size
 = 1;

321 
obli°
 = &
Â
[1];

323 
T_POINTER
:

324 
size
 = 
Â
[1].
u
.
vec
->size;

325 
obli°
 = 
Â
[1].
u
.
vec
->
ôem
;

328 i‡(
ç
)

330 
size
 = 1;

331 
obli°
 = &
ç_svÆue
;

333 
size
 = 0;

338 i‡(
ç
 &&Åp->
su≥r
)

340 
ob
 = 
ç
->
su≥r
->
c⁄èös
; ob; ob = ob->
√xt_öv
)

342 
¥öt
 = 1;

343 
i
 = 0; i < 
size
; i++)

344 i‡(
obli°
[
i
].
u
.
ob
 == ob)

345 
¥öt
 = 0;

347 i‡((
ob
->
Êags
 & 
O_ENABLE_COMMANDS
Ë&& 
¥öt
)

349 
	`push_svÆue
(
Â
);

350 
	`push_svÆue
(&
ç_svÆue
);

351 ()
	`≠∂y
("ˇtch_msg", 
ob
, 2, 0);

356 
¥öt
 = 1; 
ob
 = 
ç
->
su≥r
;

357 
i
 = 0; i < 
size
; i++)

358 i‡(
obli°
[
i
].
u
.
ob
 == ob)

359 
¥öt
 = 0;

360 i‡((
ob
->
Êags
 & 
O_ENABLE_COMMANDS
Ë&& 
¥öt
)

362 
	`push_svÆue
(
Â
);

363 
	`push_svÆue
(&
ç_svÆue
);

364 ()
	`≠∂y
("ˇtch_msg", 
ob
, 2, 0);

369 
ob
 = 
ç
->
c⁄èös
; ob; ob = ob->
√xt_öv
)

371 
¥öt
 = 1;

372 
i
 = 0; i < 
size
; i++)

373 i‡(
obli°
[
i
].
u
.
ob
 == ob)

374 
¥öt
 = 0;

376 i‡((
ob
->
Êags
 & 
O_ENABLE_COMMANDS
Ë&& 
¥öt
)

378 
	`push_svÆue
(
Â
);

379 
	`push_svÆue
(&
ç_svÆue
);

380 ()
	`≠∂y
("ˇtch_msg", 
ob
, 2, 0);

385 
¥öt
 = 1; 
ob
 = 
ç
;

386 
i
 = 0; i < 
size
; i++)

387 i‡(
obli°
[
i
].
u
.
ob
 == ob)

388 
¥öt
 = 0;

389 i‡(
ob
 && (ob->
Êags
 & 
O_ENABLE_COMMANDS
Ë&& 
¥öt
)

391 
	`push_svÆue
(
Â
);

392 
	`push_svÆue
(&
ç_svÆue
);

393 ()
	`≠∂y
("ˇtch_msg", 
ob
, 2, 0);

395 
	}
}

397 
func
 
	gfunc_ßy
 =

400 
efun_ßy
,

404 
	$efun_©oi
(
svÆue
 *
Â
)

406 i‡(
Â
->
ty≥
 =
T_STRING
)

407 
	`push_numbî
(
	`©oi
(
Â
->
u
.
°rög
));

409 
	`push_numbî
(0);

410 
	}
}

411 
func
 
	gfunc_©oi
 =

414 
efun_©oi
,

419 
	gv¨
 *(
	gv¨s
[]) =

424 
	gfunc
 *(
	gfuncs
[]) =

426 &
func_s‹t
,

427 &
func_ˇt_fûe
,

428 &
func_ßy
,

429 &
func_wrôe
,

430 &
func_ãŒ_room
,

431 &
func_©oi
,

436 
öãrÁ˚
 
	gefun
 =

439 
v¨s
,

440 
funcs
,

	@clib/gl_language.c

1 
	~<°dio.h
>

2 
	~<°rög.h
>

3 #i‡
deföed
(
sun
Ë|| deföed(
__osf__
)

4 
	~<Æloˇ.h
>

7 
	~"../löt.h
"

8 
	~"../öãrÁ˚.h
"

9 
	~"../obje˘.h
"

11 
obje˘
 *
¥evious_ob
;

15 #ifde‡
_SEQUENT_


16 *
Æloˇ
();

19 
	$lowî
(
c
)

21 
ªt
;

23 
ªt
 = 
c
;

24 i‡(
ªt
 < 96)

25 
ªt
 += 32;

26  
ªt
;

27 
	}
}

30 
	$globÆ_¨ti˛e
(
svÆue
 *
Â
)

32 *
tmp
;

34 i‡(
Â
[0].
ty≥
 !
T_STRING
)

36 
	`push_numbî
(0);

39 
tmp
 = 
	`Æloˇ
((
	`°æí
(
Â
[0].
u
.
°rög
) + 2));

40 ()
	`°r˝y
(
tmp
, (*)(
Â
[0].
u
.
°rög
));

41 ()
	`°rˇt
(
tmp
, " ");

42 
tmp
[0] = ()
	`lowî
(tmp[0]);

44 i‡(!
	`°∫cmp
(
tmp
, "the ", 4))

46 
	`push_°rög
("", 
STRING_CSTRING
);

49 i‡(
tmp
[0] == 'a' ||Åmp[0] == 'e' ||Åmp[0] == 'i' ||

50 
tmp
[0] == 'o' ||Åmp[0] == 'u')

52 
	`push_°rög
("™", 
STRING_CSTRING
);

55 
	`push_°rög
("a", 
STRING_CSTRING
);

57 
	}
}

59 
func
 
	gfunc_¨ti˛e
 =

62 
globÆ_¨ti˛e
,

66 
	$globÆ_∂uøl_w‹d
(
svÆue
 *
Â
)

68 *
tmp
, *
°r
, 
u…im©e
, 
≥nu…im©e
;

69 
size_t
 
¶
;

71 i‡(
Â
[0].
ty≥
 !
T_STRING
)

73 
	`push_numbî
(0);

76 
°r
 = 
Â
[0].
u
.
°rög
;

78 i‡(
	`°rcmp
(
°r
, "tooth") == 0)

80 
	`push_°rög
("ãëh", 
STRING_CSTRING
); ;

82 i‡(
	`°rcmp
(
°r
, "foot") == 0)

84 
	`push_°rög
("„ë", 
STRING_CSTRING
); ;

86 i‡(
	`°rcmp
(
°r
, "man") == 0)

88 
	`push_°rög
("mí", 
STRING_CSTRING
); ;

90 i‡(
	`°rcmp
(
°r
, "woman") == 0)

92 
	`push_°rög
("womí", 
STRING_CSTRING
); ;

94 i‡(
	`°rcmp
(
°r
, "child") == 0)

96 
	`push_°rög
("chûdªn", 
STRING_CSTRING
); ;

98 i‡(
	`°rcmp
(
°r
, "sheep") == 0)

100 
	`push_°rög
("shìp", 
STRING_CSTRING
); ;

102 i‡(
	`°rcmp
(
°r
, "key") == 0)

104 
	`push_°rög
("keys", 
STRING_CSTRING
); ;

107 i‡((
¶
 = 
	`°æí
(
°r
)) < 3)

109 
	`push_°rög
(
°r
, 
Â
[0].
°rög_ty≥
);

112 
tmp
 = 
	`Æloˇ
((
	`°æí
((*)
°r
) + 10));

113 ()
	`°∫˝y
(
tmp
, 
°r
, 
¶
);

114 
u…im©e
 = 
°r
[
¶
 - 1];

115 
≥nu…im©e
 = 
°r
[
¶
 - 2];

116 
tmp
[
¶
] = '\0';

118 
u…im©e
)

123 ()
	`°rˇt
(
tmp
, "es");

126 i‡(
≥nu…im©e
 == 'a' ||Öenultimate == 'e' ||Öenultimate == 'o')

127 ()
	`°rˇt
(
tmp
, "s");

130 
tmp
[
¶
 - 1] = '\0';

131 ()
	`°rˇt
(
tmp
, "ies");

135 i‡(
≥nu…im©e
 == 'f')

137 
tmp
[
¶
 - 2] = '\0';

138 ()
	`°rˇt
(
tmp
, "ves");

141 ()
	`°rˇt
(
tmp
, "s");

144 
tmp
[
¶
 - 1] = '\0';

145 ()
	`°rˇt
(
tmp
, "ves");

148 ()
	`°rˇt
(
tmp
, "s");

151 
	`push_°rög
(
tmp
, 
STRING_MSTRING
);

153 
	}
}

155 
func
 
	gfunc_∂uøl_w‹d
 =

158 
globÆ_∂uøl_w‹d
,

162 
	gfunc
 *(
	gfuncs
[]) =

164 &
func_¨ti˛e
,

165 &
func_∂uøl_w‹d
,

168 
	gv¨
 *(
	gv¨s
[]) =

173 
öãrÁ˚
 
	ggl_œnguage
 =

176 
v¨s
,

177 
funcs
,

	@clib/stdobject.c

1 
	~<°dio.h
>

2 
	~<°rög.h
>

3 #i‡
deföed
(
sun
Ë|| deföed(
__osf__
)

4 
	~<Æloˇ.h
>

7 
	~"../löt.h
"

8 
	~"../öãrÁ˚.h
"

9 
	~"../obje˘.h
"

10 
	~"../m°rög.h
"

11 
	~"../m≠pög.h
"

12 
	~"../simuœã.h
"

14 
	~"../ölöe_svÆue.h
"

17 
obje˘
 *
¥evious_ob
;

22 
v¨
 
	gobj_¥ev
 = { "obj_previous", 0 };

23 
v¨
 
	gobj_¥›s
 = { "obj_props", 0 };

24 
v¨
 
	gobj_no_ch™ge
 = { "obj_no_change", 0 };

26 
v¨
 
	gobj_«mes
 = { "obj_names", 0 };

27 
v¨
 
	gobj_≤ames
 = { "obj_pnames", 0 };

28 
v¨
 
	gobj_rodzaje
 = { "obj_rodzaje", 0 };

29 
v¨
 
	gobj_¥odzaje
 = { "obj_prodzaje", 0 };

36 
	$obje˘_check_ˇŒ
(
svÆue
 *
Â
)

38 
svÆue
 
c⁄°0
;

39 
svÆue
 *
	`¥o˚ss_vÆue
 (*, );

40 *
	`¥o˚ss_°rög
(*, );

41 
obje˘
 *
cuºít_obje˘
;

42 
˛osuª
 *
fun
;

44 
svÆue
 *
ªt
 = 
NULL
;

45 *
p
, *
p2
, *
°r
, *
ªt°r
 = 
NULL
;

47 i‡(
Â
[0].
ty≥
 !
T_STRING
 && fp[0].ty≥ !
T_FUNCTION
)

49 
	`push_svÆue
(&
Â
[0]);

53 
	`assign_svÆue
(&
	`VAR
(
obj_¥ev
), &
Â
[1]);

55 i‡(
Â
[0].
ty≥
 =
T_FUNCTION
)

57 
fun
 = 
Â
[0].
u
.
func
;

58 ()
	`ˇŒ_v¨
(0, 
fun
);

59 
	`assign_svÆue
(&
	`VAR
(
obj_¥ev
), &
c⁄°0
);

63 
°r
 = 
Â
[0].
u
.
°rög
;

64 i‡(
°r
[0] == '@' && str[1] == '@')

66 
p
 = &
°r
[2];

67 
p2
 = &
p
[-1];

68 (
p2
 = (*Ë
	`°rchr
(&p2[1], '@')) &&

69 (
p2
[1] != '@'))

71 i‡(!
p2
)

73 
ªt
 = 
	`¥o˚ss_vÆue
(
p
, 1);

75 i‡(
p2
[2] == '\0')

77 
size_t
 
Àn
 = 
	`°æí
(
p
);

78 
p2
 = (*Ë
	`Æloˇ
(
Àn
 - 1);

79 ()
	`°∫˝y
(
p2
, 
p
, 
Àn
 - 2);

80 
p2
[
Àn
 - 2] = '\0';

81 
ªt
 = 
	`¥o˚ss_vÆue
(
p2
, 1);

84 
ªt°r
 = 
	`¥o˚ss_°rög
(
°r
, 1);

87 
ªt°r
 = 
	`¥o˚ss_°rög
(
°r
, 1);

89 i‡(
ªt
)

91 
	`push_svÆue
(
ªt
);

95 
	`push_°rög
(
ªt°r
, 
STRING_MSTRING
);

96 i‡(
°r
 !
ªt°r
)

97 
	`‰ì
(
ªt°r
);

100 
	`assign_svÆue
(&
	`VAR
(
obj_¥ev
), &
c⁄°0
);

101 
	}
}

103 
func
 
	gfunc_check_ˇŒ
 =

106 
obje˘_check_ˇŒ
,

110 
	$obje˘_usun_°¨e_«zwy
(
svÆue
 *
Â
)

112 
ve˘‹
 *
¨r
, *
w‹k¨r
, *
¨g¨r
, *
ªt_«zwy
, *
ªt_rodzaje
;

113 
svÆue
 
ñ
, *
w‹kôem
, *
rodzajôem
;

114 
size_¨g
, 
size_w‹k
, 
ix
, 
cx
, 
dx
, 
¨r_ix
;

116 i‡(
Â
[0].
ty≥
 !
T_POINTER
)

118 i‡(
Â
[0].
ty≥
 !
T_STRING
)

120 
	`push_numbî
(1);

124 
¨r
 = 
	`Æloˇã_¨øy
(1);

125 
	`assign_svÆue_no_‰ì
(&
¨r
->
ôem
[0], 
Â
);

126 
ñ
.
ty≥
 = 
T_POINTER
;

127 
ñ
.
u
.
vec
 = 
¨r
;

128 
	`assign_svÆue
(
Â
, &
ñ
);

130 i‡(!
Â
[0].
u
.
vec
->
size
)

132 
	`push_numbî
(1);

136 
¨g¨r
 = 
Â
[0].
u
.
vec
;

138 i‡(!
Â
[2].
u
.
numbî
)

140 
w‹kôem
 = &(
	`VAR
(
obj_«mes
).
u
.
vec
->
ôem
[
Â
[1].u.
numbî
]);

141 
rodzajôem
 = &(
	`VAR
(
obj_rodzaje
).
u
.
vec
->
ôem
[
Â
[1].u.
numbî
]);

145 
w‹kôem
 = &(
	`VAR
(
obj_≤ames
).
u
.
vec
->
ôem
[
Â
[1].u.
numbî
]);

146 
rodzajôem
 = &(
	`VAR
(
obj_¥odzaje
).
u
.
vec
->
ôem
[
Â
[1].u.
numbî
]);

149 i‡(
w‹kôem
->
ty≥
 !
T_POINTER
)

151 
	`push_numbî
(1);

155 
w‹k¨r
 = 
w‹kôem
->
u
.
vec
;

156 
size_w‹k
 = 
w‹k¨r
->
size
;

157 
size_¨g
 = 
¨g¨r
->
size
;

159 i‡(!
size_w‹k
)

161 
	`push_numbî
(1);

166 i‡(
¨g¨r
->
size
 == 1)

168 i‡((
¨g¨r
->
ôem
[0].
ty≥
 !
T_STRING
) ||

169 (
w‹k¨r
->
ôem
[0].
ty≥
 !
T_STRING
))

170 
	`Ârötf
(
°dîr
, "ROZNI SIE\n");

171 i‡(!
	`°rcmp
(
¨g¨r
->
ôem
[0].
u
.
°rög
, 
w‹k¨r
->item[0].u.string))

173 
	`push_numbî
(0);

179 
size_w‹k
--;

181 
ix
 = 
size_¨g
;

182 --
ix
 >= 0)

184 
cx
 = 
size_w‹k
;

185 
cx
 >= 0)

187 i‡((
¨g¨r
->
ôem
[
ix
].
ty≥
 !
T_STRING
) ||

188 (
w‹k¨r
->
ôem
[
cx
].
ty≥
 !
T_STRING
))

190 
cx
--;

193 i‡(
	`°rcmp
(
¨g¨r
->
ôem
[
ix
].
u
.
°rög
, 
w‹k¨r
->ôem[
cx
].u.string))

195 
cx
--;

199 
ªt_«zwy
 = 
	`Æloˇã_¨øy
(
size_w‹k
);

200 
ªt_rodzaje
 = 
	`Æloˇã_¨øy
(
size_w‹k
);

202 
	`Ârötf
(
°dîr
, "CKK 3,Çazwa = '%s', '%s'\n",

203 
¨g¨r
->
ôem
[
ix
].
u
.
°rög
, 
cuºít_obje˘
->
«me
);

205 
¨r_ix
 = 0;

206 
dx
 = 0; dx < 
cx
; dx++)

208 
	`assign_svÆue_no_‰ì
(&
ªt_«zwy
->
ôem
[
¨r_ix
],

209 &
w‹k¨r
->
ôem
[
dx
]);

210 
	`assign_svÆue_no_‰ì
(&
ªt_rodzaje
->
ôem
[
¨r_ix
++],

211 &(
rodzajôem
->
u
.
vec
->
ôem
[
dx
]));

213 
dx
 = 
cx
 + 1; dx <
size_w‹k
; dx++)

215 
	`assign_svÆue_no_‰ì
(&
ªt_«zwy
->
ôem
[
¨r_ix
],

216 &
w‹k¨r
->
ôem
[
dx
]);

217 
	`assign_svÆue_no_‰ì
(&
ªt_rodzaje
->
ôem
[
¨r_ix
++],

218 &(
rodzajôem
->
u
.
vec
->
ôem
[
dx
]));

221 
	`‰ì_ve˘‹
(
w‹kôem
->
u
.
vec
);

222 
	`‰ì_ve˘‹
(
rodzajôem
->
u
.
vec
);

224 
w‹kôem
->
u
.
vec
 = 
ªt_«zwy
;

225 
rodzajôem
->
u
.
vec
 = 
ªt_rodzaje
;

234 
	`push_numbî
(1);

236 
	}
}

238 
func
 
	gfunc_usun_°¨e_«zwy
 =

241 
obje˘_usun_°¨e_«zwy
,

245 
	$obje˘_quîy_¥›
(
svÆue
 *
Â
)

247 
svÆue
 
c⁄°0
;

248 
svÆue
 *
	`¥o˚ss_vÆue
 (*, );

249 *
	`¥o˚ss_°rög
(*, );

250 
obje˘
 *
cuºít_obje˘
;

252 
svÆue
 *
ªt
 = 
NULL
;

253 
svÆue
 *
vÆ
;

254 
svÆue
 
tmp
;

255 
˛osuª
 *
fun
;

257 *
p
, *
p2
, *
°r
, *
ªt°r
 = 
NULL
;

259 
svÆue
 *
	`gë_m≠_lvÆue
(
m≠pög
 *,

260 
svÆue
 *, );

261 i‡(
	`VAR
(
obj_¥›s
).
ty≥
 !
T_MAPPING
)

263 
	`push_numbî
(0);

267 
vÆ
 = 
	`gë_m≠_lvÆue
(
	`VAR
(
obj_¥›s
).
u
.
m≠
, 
Â
, 0);

268 i‡(
vÆ
->
ty≥
 !
T_STRING
 && vÆ->ty≥ !
T_FUNCTION
)

270 i‡(
vÆ
->
ty≥
 =
T_OBJECT
 && (vÆ->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
))

271 
	`‰ì_svÆue
(
vÆ
);

272 
	`push_svÆue
(
vÆ
);

276 i‡(
¥evious_ob
 !
NULL
) {

277 
tmp
.
ty≥
 = 
T_OBJECT
;

278 
tmp
.
u
.
ob
 = 
¥evious_ob
;

279 
	`assign_svÆue
(&
	`VAR
(
obj_¥ev
), &
tmp
);

282 
	`assign_svÆue
(&
	`VAR
(
obj_¥ev
), &
c⁄°0
);

285 i‡(
vÆ
->
ty≥
 =
T_FUNCTION
)

287 
fun
 = 
vÆ
->
u
.
func
;

288 ()
	`ˇŒ_v¨
(0, 
fun
);

289 
	`assign_svÆue
(&
	`VAR
(
obj_¥ev
), &
c⁄°0
);

293 
°r
 = 
vÆ
->
u
.
°rög
;

294 i‡(
°r
[0] == '@' && str[1] == '@')

296 
p
 = &
°r
[2];

297 
p2
 = &
p
[-1];

298 (
p2
 = (*Ë
	`°rchr
(&p2[1], '@')) &&

299 (
p2
[1] != '@'))

301 i‡(!
p2
)

303 
ªt
 = 
	`¥o˚ss_vÆue
(
p
, 1);

305 i‡(
p2
[2] == '\0')

307 
size_t
 
Àn
 = 
	`°æí
(
p
);

308 
p2
 = (*Ë
	`Æloˇ
(
Àn
 - 1);

309 ()
	`°∫˝y
(
p2
, 
p
, 
Àn
 - 2);

310 
p2
[
Àn
 - 2] = '\0';

311 
ªt
 = 
	`¥o˚ss_vÆue
(
p2
, 1);

314 
ªt°r
 = 
	`¥o˚ss_°rög
(
°r
, 1);

317 
ªt°r
 = 
	`¥o˚ss_°rög
(
°r
, 1);

319 i‡(
ªt
)

321 
	`push_svÆue
(
ªt
);

325 
	`push_°rög
(
ªt°r
, 
STRING_MSTRING
);

326 i‡(
°r
 !
ªt°r
)

327 
	`‰ì
(
ªt°r
);

330 
	`assign_svÆue
(&
	`VAR
(
obj_¥ev
), &
c⁄°0
);

331 
	}
}

334 
func
 
	gfunc_quîy_¥›
 =

337 
obje˘_quîy_¥›
,

341 
	$obje˘_add_¥›
(
svÆue
 *
Â
)

343 
svÆue
 *
	`gë_m≠_lvÆue
(
m≠pög
 *,

344 
svÆue
 *, );

345 
svÆue
 *
ovÆ
;

347 i‡(
	`VAR
(
obj_no_ch™ge
).
u
.
numbî
 || VAR(
obj_¥›s
).
ty≥
 !
T_MAPPING
)

349 
	`push_numbî
(0);

353 
	`assign_svÆue
((
ovÆ
=
	`gë_m≠_lvÆue
(
	`VAR
(
obj_¥›s
).
u
.
m≠
,
Â
,1)),&fp[1]);

355 i‡(
cuºít_obje˘
->
su≥r
)

357 
	`push_svÆue
(&
Â
[0]);

358 
	`push_svÆue
(
	`gë_m≠_lvÆue
(
	`VAR
(
obj_¥›s
).
u
.
m≠
,
Â
,0));

359 
	`push_svÆue
(
ovÆ
);

360 ()
	`≠∂y
("nŸify_ch™ge_¥›",
cuºít_obje˘
->
su≥r
,3,0);

363 
	`push_numbî
(0);

365 
	}
}

367 
func
 
	gfunc_add_¥›
 =

370 
obje˘_add_¥›
,

373 
func
 
	gfunc_ch™ge_¥›
 =

376 
obje˘_add_¥›
,

380 
	gv¨
 *(
	gv¨s
[]) =

382 &
obj_¥ev
,

383 &
obj_¥›s
,

384 &
obj_no_ch™ge
,

386 &
obj_«mes
,

387 &
obj_≤ames
,

388 &
obj_rodzaje
,

389 &
obj_¥odzaje
,

393 
	gfunc
 *(
	gfuncs
[]) =

395 &
func_check_ˇŒ
,

396 &
func_quîy_¥›
,

397 &
func_add_¥›
,

398 &
func_ch™ge_¥›
,

400 &
func_usun_°¨e_«zwy
,

405 
öãrÁ˚
 
	g°dobje˘
 =

408 
v¨s
,

409 
funcs
,

	@comm.h

1 
	~<sys/sockë.h
>

2 #ifde‡
_AIX


3 
	~<sys/sockëv¨.h
>

5 
	~<√töë/ö.h
>

6 
	~<¨∑/öë.h
>

8 #ifde‡
löux


9 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

12 
	#MAX_WRITE_SOCKET_SIZE
 8192

	)

14 
	söãø˘ive
 {

15 *
	mç
;

16 
obje˘
 *
	mob
;

17 
£¡í˚
 *
	möput_to
;

18 
sockaddr_ö
 
	maddr
;

19 *
	m¥om±
;

20 
	m˛osög
;

21 
	mdo_˛o£
;

22 
öãø˘ive
 *
	m¢o›_⁄
, *
	m¢o›_by
;

23 
	mn€cho
;

24 
	mno°rù_vbfc
;

25 
	mœ°_time
;

26 *
	mdeÁu…_îr_mesßge
;

27 #ifde‡
TRACE_CODE


28 
	måa˚_Àvñ
;

29 *
	måa˚_¥efix
;

31 
ed_buf„r
 *
	med_buf„r
;

32 *
	m∫ame
;

33 
	mÕ‹t
;

34 
	mΩ‹t
;

35 #ifde‡
SUPER_SNOOP


36 
	m¢o›_fd
;

38 #ifde‡
WORD_WRAP


39 
	ms¸ìn_width
;

40 
	mcuºít_cﬁumn
;

45 
add_ù_íåy
(, *);

46 
ªmove_öãø˘ive
(
öãø˘ive
 *, );

47 
öãø˘ive_öput
(
öãø˘ive
 *, *);

48 *
√w_∂ayî
(*, 
sockaddr_ö
 *, 
size_t
);

	@comm1.c

1 
	~<sys/ty≥s.h
>

2 
	~<sys/time.h
>

3 
	~<sys/io˘l.h
>

4 
	~<sys/fûe.h
>

5 #i‡
deföed
(
_SEQUENT_
)

6 
	~<sys/¥oc°©s.h
>

8 
	~<f˙é.h
>

9 
	~<°d¨g.h
>

10 
	~<¨∑/ã ë.h
>

11 
	~<√tdb.h
>

12 
	~<°dio.h
>

13 
	~<î∫o.h
>

14 
	~<°rög.h
>

15 
	~<˘y≥.h
>

16 
	~<sig«l.h
>

17 
	~<mem‹y.h
>

18 
	~<f˙é.h
>

19 
	~<°dlib.h
>

20 
	~"c⁄fig.h
"

21 
	~"löt.h
"

22 
	~"m°rög.h
"

23 
	~"öãΩªt.h
"

24 
	~"comm.h
"

25 
	~"obje˘.h
"

26 
	~"£¡.h
"

27 
	~"simuœã.h
"

28 
	~"su≥r_¢o›.h
"

29 
	~"ndesc.h
"

30 
	~"h«me.h
"

31 
	~"nqueue.h
"

32 
	~"ã ë.h
"

33 
	~"t˝svc.h
"

34 
	~"udpsvc.h
"

36 
	#MAX_SNOOP_MSG_SIZE
 10000

	)

38 
£t_¥om±
 (*);

39 
¥öt_¥om±
 ();

40 
¥ï¨e_ùc
 ();

41 
ùc_ªmove
 ();

42 *
quîy_ù_numbî
 (
obje˘
 *);

43 *
quîy_ho°_«me
 ();

44 
add_ù_íåy
 (, *);

46 *
°rög_c›y
(*);

47 
d_Êag
;

48 
s_Êag
;

49 
no_ù_dem⁄
;

50 
cuºít_time
;

51 
evÆ_co°
;

52 
svÆue
 *
•
;

54 
ªmove_öãø˘ive
(
öãø˘ive
 *, ), 
add_ªf
(
obje˘
 *, *);

56 
debug_mesßge
(*, ...), 
‰ì_£¡í˚
(
£¡í˚
 *);

58 
öãø˘ive
 *
	gÆl_∂ayîs
[
MAX_PLAYERS
];

60 
î∫o
;

61 
obje˘
 *
cuºít_öãø˘ive
;

62 
obje˘
 *
¥evious_ob
;

63 #ifde‡
CATCH_UDP_PORT


64 
udp_p‹t
;

67 *
√w_∂ayî
(*, 
sockaddr_ö
 *, 
size_t
);

69 
	gnum_∂ayî
;

75 
p‹t_numbî
;

77 #ifde‡
COMM_STAT


78 
	gadd_mesßge_ˇŒs
=0;

79 
	göë_∑ckës
=0;

80 
	göë_vﬁume
=0;

84 
	$¥ï¨e_ùc
()

86 
	`nd_öô
();

87 #i‚de‡
NO_IP_DEMON


88 i‡(!
no_ù_dem⁄
)

89 
	`h«me_öô
();

91 
	`ã ë_öô
((
u_sh‹t
)
p‹t_numbî
);

92 #ifde‡
SERVICE_PORT


93 
	`t˝svc_öô
();

95 #ifde‡
CATCH_UDP_PORT


96 
	`udpsvc_öô
(
udp_p‹t
);

99 ()
	`sig«l
(
SIGPIPE
, 
SIG_IGN
);

100 
	}
}

106 
	$ùc_ªmove
()

108 ()
	`¥ötf
("Shutting down ipc...\n");

109 
	`nd_shutdown
();

110 
	}
}

111 
wrôe_sockë
(*, 
obje˘
 *);

120 
	$add_mesßge2
(
obje˘
 *
ob
, *
fmt
, ...)

122 
buff
[
MAX_SNOOP_MSG_SIZE
];

123 
va_li°
 
¨gp
;

124 
	`va_°¨t
(
¨gp
, 
fmt
);

125 ()
	`v¢¥ötf
(
buff
, (buff), 
fmt
, 
¨gp
);

127 
	`va_íd
(
¨gp
);

128 i‡(
ob
 && !(ob->
Êags
 & 
O_DESTRUCTED
))

130 
	`push_°rög
(
buff
, 
STRING_MSTRING
);

131 ()
	`≠∂y
("ˇtch_ãŒ", 
ob
, 1, 1);

134 
	`wrôe_sockë
(
buff
, (
obje˘
 *)0);

136 
	}
}

139 
	$add_mesßge
(*
fmt
, ...)

141 
buff
[10000];

142 
va_li°
 
¨gp
;

143 
	`va_°¨t
(
¨gp
, 
fmt
);

144 ()
	`v•rötf
(
buff
, 
fmt
, 
¨gp
);

146 
	`va_íd
(
¨gp
);

147 i‡(
comm™d_givî
 && !(comm™d_givî->
Êags
 & 
O_DESTRUCTED
))

149 
	`push_°rög
(
buff
, 
STRING_MSTRING
);

150 ()
	`≠∂y
("ˇtch_ãŒ", 
comm™d_givî
, 1, 1);

153 
	`wrôe_sockë
(
buff
, (
obje˘
 *)0);

154 
	}
}

157 
	$wrôe_sockë
(*
˝
, 
obje˘
 *
ob
)

159 
öãø˘ive
 *
ù
;

160 #ifde‡
WORD_WRAP


161 
Àn
, 
cuºít_cﬁumn
;

162 *
bp
, 
buf
[
MAX_WRITE_SOCKET_SIZE
 + 2];

165 i‡(
ob
 =
NULL
 || ob->
Êags
 & 
O_DESTRUCTED
 ||

166 (
ù
 = 
ob
->
öãø˘ive
Ë=
NULL
 ||

167 
ù
->
do_˛o£
) {

168 ()
	`Âuts
(
˝
, 
°dîr
);

169 ()
	`fÊush
(
°dîr
);

173 #ifde‡
SUPER_SNOOP


174 i‡(
ù
->
¢o›_fd
 != -1)

175 ()
	`wrôe
(
ù
->
¢o›_fd
, 
˝
, 
	`°æí
(cp));

178 i‡(
ù
->
¢o›_by
 !
NULL
)

180 i‡((
	`°æí
(
˝
Ë+ 10Ë> 
MAX_SNOOP_MSG_SIZE
)

181 
˝
[
MAX_SNOOP_MSG_SIZE
 - 10] = '\0';

183 
	`add_mesßge2
(
ù
->
¢o›_by
->
ob
, "%%%s", 
˝
);

186 #ifde‡
WORD_WRAP


187 i‡(
ù
->
s¸ìn_width
 != 0)

189 
cuºít_cﬁumn
 = 
ù
->current_column;

191 
bp
 = 
buf
;

195 i‡(*
˝
 == '\0')

198 i‡(
bp
 >&
buf
[
MAX_WRITE_SOCKET_SIZE
])

199 
	`îr‹
("TooÜong message!\n");

201 i‡(*
˝
 == '\n')

203 
cuºít_cﬁumn
 = 0;

204 *
bp
++ = *
˝
++;

208 i‡(
bp
 >&
buf
[
MAX_WRITE_SOCKET_SIZE
])

209 
	`îr‹
("TooÜong message!\n");

211 i‡(*
˝
 == '\t')

213 
cuºít_cﬁumn
 &= ~7;

214 
cuºít_cﬁumn
 += 8;

215 i‡(
cuºít_cﬁumn
 >
ù
->
s¸ìn_width
)

217 
cuºít_cﬁumn
 = 0;

218 *
bp
++ = '\n';

219 *
˝
 == ' ' || *cp == '\t')

220 
˝
++;

224 *
bp
++ = *
˝
++;

229 
Àn
 = 1;

230 
˝
[
Àn
] > ' ' && cp[len - 1] != '-')

231 
Àn
++;

233 i‡(
cuºít_cﬁumn
 + 
Àn
 >
ù
->
s¸ìn_width
)

235 i‡(
cuºít_cﬁumn
 > 
ù
->
s¸ìn_width
 * 4 / 5)

237 
cuºít_cﬁumn
 = 0;

238 *
bp
++ = '\n';

239 *
˝
 == ' ' || *cp == '\t')

240 
˝
++;

241 i‡(*
˝
 == '\n')

242 
˝
++;

247 i‡(
bp
 + 
Àn
 >&
buf
[
MAX_WRITE_SOCKET_SIZE
])

248 
	`îr‹
("TooÜong message!\n");

250 
cuºít_cﬁumn
 +
Àn
;

251 ; 
Àn
 > 0;Üen--)

252 *
bp
++ = *
˝
++;

255 *
bp
 = '\0';

257 
ù
->
cuºít_cﬁumn
 = current_column;

259 
	`ã ë_ouçut
(
ù
->
ç
, (
u_ch¨
 *)
buf
);

264 i‡(
	`°æí
(
˝
Ë> 
MAX_WRITE_SOCKET_SIZE
)

265 
	`îr‹
("TooÜong message!\n");

267 
	`ã ë_ouçut
(
ù
->
ç
, (
u_ch¨
 *)
˝
);

269 
	}
}

271 
	#MSR_SIZE
 20

	)

273 
	gm£cs_ª•⁄£
[
MSR_SIZE
];

274 
	gm§_poöt
 = -1;

277 
	$gë_m£cs_ª•⁄£
(
ix
)

279  (
ix
 >0 && ix < 
MSR_SIZE
Ë? 
m£cs_ª•⁄£
[ix] : -1;

280 
	}
}

286 
	$ªmove_öãø˘ive
(
öãø˘ive
 *
ù
, 
lök_dód
)

288 
obje˘
 *
ßve
 = 
comm™d_givî
;

289 
obje˘
 *
ob
 = 
ù
->ob;

290 
i
;

292 i‡(!
ob
 || !(ob->
öãø˘ive
))

294 
i
 = 0; i < 
MAX_PLAYERS
; i++)

296 i‡(
Æl_∂ayîs
[
i
] !
ob
->
öãø˘ive
)

298 i‡(
ob
->
öãø˘ive
->
˛osög
)

299 
	`Áèl
("Double callÅoÑemove_interactive()\n");

301 
comm™d_givî
 = 
ob
;

303 i‡(
ob
->
öãø˘ive
->
ed_buf„r
)

305 
	`ßve_ed_buf„r
();

312 ()
	`add_mesßge
("SavingÉditor buffer.\n");

313 
	`ßve_ed_buf„r
();

315 i‡(
ob
->
öãø˘ive
 =
NULL
)

317 
ob
->
öãø˘ive
->
˛osög
 = 1;

318 i‡(
ob
->
öãø˘ive
->
¢o›_by
)

320 
ob
->
öãø˘ive
->
¢o›_by
->
¢o›_⁄
 = 0;

321 
ob
->
öãø˘ive
->
¢o›_by
 = 0;

323 i‡(
ob
->
öãø˘ive
->
¢o›_⁄
)

325 
ob
->
öãø˘ive
->
¢o›_⁄
->
¢o›_by
 = 0;

326 
ob
->
öãø˘ive
->
¢o›_⁄
 = 0;

328 
	`øndom
() % 2)

330 0: 
	`wrôe_sockë
("Dÿzobaczíü!\n", 
comm™d_givî
); ;

331 1: 
	`wrôe_sockë
("OpuszczaszÑó y swüt.\n", 
comm™d_givî
); ;

333 
	`ã ë_dëach
(
ob
->
öãø˘ive
->
ç
);

334 #ifde‡
SUPER_SNOOP


335 i‡(
ob
->
öãø˘ive
->
¢o›_fd
 >= 0) {

336 ()
	`˛o£
(
ob
->
öãø˘ive
->
¢o›_fd
);

337 
ob
->
öãø˘ive
->
¢o›_fd
 = -1;

340 
num_∂ayî
--;

341 i‡(
ob
->
öãø˘ive
->
öput_to
)

343 
	`‰ì_£¡í˚
(
ob
->
öãø˘ive
->
öput_to
);

344 
ob
->
öãø˘ive
->
öput_to
 = 0;

346 if(
ob
->
öãø˘ive
->
∫ame
)

347 
	`‰ì
(
ob
->
öãø˘ive
->
∫ame
);

349 
	`‰ì
((*)
ob
->
öãø˘ive
);

350 
ob
->
öãø˘ive
 = 0;

351 
Æl_∂ayîs
[
i
] = 0;

352 
	`‰ì_obje˘
(
ob
, "remove_interactive");

354 
	`push_obje˘
(
ob
);

355 
	`push_numbî
(
lök_dód
);

356 ()
	`≠∂y_ma°î_ob
(
M_REMOVE_INTERACTIVE
,2);

358 
comm™d_givî
 = 
ßve
;

361 
	`Áèl
("CouldÇŸ födándÑemovê∂ayî %s\n", 
ob
->
«me
);

362 
	}
}

369 
obje˘
 *

370 
	$gë_öãø˘ive_obje˘
(
i
)

371 
i
;

373 
n
;

375 i‡(
i
 >
num_∂ayî
)

376 
	`Áèl
("Gë i¡îa˘ivê(%dËwôh o∆y %dÖœyîs!\n", 
i
, 
num_∂ayî
);

378 
n
 = 0;Ç < 
MAX_PLAYERS
;Ç++)

379 i‡(
Æl_∂ayîs
[
n
])

380 i‡(!(
i
--))

381 (
Æl_∂ayîs
[
n
]->
ob
);

383 
	`Áèl
("Get interactive:Ölayer %dÇot found! (num_players = %d)\n",

384 
i
, 
num_∂ayî
);

386 
	}
}

389 
	$√w_∂ayî
(*
ç
, 
sockaddr_ö
 *
addr
, 
size_t
 
Àn
)

391 
i
;

393 
i
 = 0; i < 
MAX_PLAYERS
; i++)

395 
obje˘
 *
ob
;

396 
svÆue
 *
ªt
;

397 
obje˘
 *
ma°î_ob
;

399 i‡(
Æl_∂ayîs
[
i
] != 0)

401 
comm™d_givî
 = 
ma°î_ob
;

402 
ma°î_ob
->
öãø˘ive
 =

403 (
öãø˘ive
 *)
	`xÆloc
( (interactive));

404 
ma°î_ob
->
öãø˘ive
->
deÁu…_îr_mesßge
 = 0;

405 
ma°î_ob
->
Êags
 |
O_ONCE_INTERACTIVE
;

407 
ma°î_ob
->
öãø˘ive
->
∫ame
 = 0;

408 
ma°î_ob
->
öãø˘ive
->
ob
 = master_ob;

409 
ma°î_ob
->
öãø˘ive
->
öput_to
 = 0;

410 
ma°î_ob
->
öãø˘ive
->
˛osög
 = 0;

411 
ma°î_ob
->
öãø˘ive
->
¢o›_⁄
 = 0;

412 
ma°î_ob
->
öãø˘ive
->
¢o›_by
 = 0;

413 
ma°î_ob
->
öãø˘ive
->
do_˛o£
 = 0;

414 
ma°î_ob
->
öãø˘ive
->
n€cho
 = 0;

415 #ifde‡
TRACE_CODE


416 
ma°î_ob
->
öãø˘ive
->
åa˚_Àvñ
 = 0;

417 
ma°î_ob
->
öãø˘ive
->
åa˚_¥efix
 = 0;

419 
ma°î_ob
->
öãø˘ive
->
œ°_time
 = 
cuºít_time
;

420 
ma°î_ob
->
öãø˘ive
->
ed_buf„r
 = 0;

421 #ifde‡
SUPER_SNOOP


422 
ma°î_ob
->
öãø˘ive
->
¢o›_fd
 = -1;

424 #ifde‡
WORD_WRAP


425 
ma°î_ob
->
öãø˘ive
->
cuºít_cﬁumn
 = 0;

426 
ma°î_ob
->
öãø˘ive
->
s¸ìn_width
 = 0;

428 
Æl_∂ayîs
[
i
] = 
ma°î_ob
->
öãø˘ive
;

429 
Æl_∂ayîs
[
i
]->
ç
 =Åp;

430 
	`£t_¥om±
(
NULL
);

431 ()
	`mem˝y
((*)&
Æl_∂ayîs
[
i
]->
addr
, (*Ôddr, 
Àn
);

432 
Æl_∂ayîs
[
i
]->
Ω‹t
 = 
	`¡ohs
(
addr
->
sö_p‹t
);

433 
Æl_∂ayîs
[
i
]->
Õ‹t
 = 
p‹t_numbî
;

434 
num_∂ayî
++;

439 
	`add_ªf
(
ma°î_ob
, "new_player");

440 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_CONNECT
, 0);

441 i‡(
ªt
 =0 ||Ñë->
ty≥
 !
T_OBJECT
)

443 
	`ªmove_öãø˘ive
(
ma°î_ob
->
öãø˘ive
, 0);

444  
NULL
;

450 
ob
 = 
ªt
->
u
.ob;

451 
ob
->
öãø˘ive
 = 
ma°î_ob
->interactive;

452 
ob
->
öãø˘ive
->ob = ob;

453 
ob
->
Êags
 |
O_ONCE_INTERACTIVE
;

454 
ma°î_ob
->
Êags
 &~
O_ONCE_INTERACTIVE
;

455 
ma°î_ob
->
öãø˘ive
 = 0;

456 
	`‰ì_obje˘
(
ma°î_ob
, "reconnect");

457 
	`add_ªf
(
ob
, "new_player");

458 
comm™d_givî
 = 
ob
;

459 #i‚de‡
NO_IP_DEMON


460 i‡(!
no_ù_dem⁄
)

461 
	`h«me_£ndªq
(
	`quîy_ù_numbî
(
ob
),

462 (
u_sh‹t
)
Æl_∂ayîs
[
i
]->
Õ‹t
,

463 (
u_sh‹t
)
Æl_∂ayîs
[
i
]->
Ω‹t
);

465 #ifde‡
SUPER_SNOOP


466 
	`check_su≥r¢o›
(
ob
);

468 
	`log⁄
(
ob
);

469  
Æl_∂ayîs
[
i
];

471 
	`ã ë_ouçut
(
ç
, (
u_ch¨
 *)"Lpmud is full. Come backÜater.\n");

472  
NULL
;

473 
	}
}

476 
	$ˇŒ_fun˘i⁄_öãø˘ive
(
öãø˘ive
 *
i
, *
°r
)

478 
˛osuª
 *
func
;

480 i‡(!
i
->
öput_to
)

482 
func
 = 
i
->
öput_to
->
fun˘
;

487 i‡(!
	`ÀgÆ_˛osuª
(
func
))

490 
	`‰ì_£¡í˚
(
i
->
öput_to
);

491 
i
->
öput_to
 = 0;

495 
	`INCREF
(
func
->
ªf
);

496 
	`‰ì_£¡í˚
(
i
->
öput_to
);

501 
i
->
öput_to
 = 0;

502 
	`push_°rög
(
°r
, 
STRING_MSTRING
);

503 
cuºít_obje˘
 = 
func
->
funobj
;

504 ()
	`ˇŒ_v¨
(1, 
func
);

505 
	`‰ì_˛osuª
(
func
);

507 
	}
}

510 
	$£t_ˇŒ
(
obje˘
 *
ob
, 
£¡í˚
 *
£¡
, 
n€cho
)

512 
obje˘
 *
ßve
 = 
comm™d_givî
;

513 i‡(
ob
 =0 || 
£¡
 == 0)

515 i‡(
ob
->
öãø˘ive
 =0 || ob->öãø˘ive->
öput_to
)

517 
ob
->
öãø˘ive
->
öput_to
 = 
£¡
;

518 
ob
->
öãø˘ive
->
n€cho
 =Çoecho;

519 
comm™d_givî
 = 
ob
;

520 i‡(
n€cho
)

521 
	`ã ë_íabÀ_echo
(
ob
->
öãø˘ive
->
ç
);

522 
comm™d_givî
 = 
ßve
;

524 
	}
}

527 
	$ªmove_Æl_∂ayîs
()

529 
svÆue
 *
ªt
;

530 
gdex˚±i⁄
 
ex˚±i⁄_‰ame
;

532 
ex˚±i⁄_‰ame
.
e_ex˚±i⁄
 = 
NULL
;

533 
ex˚±i⁄_‰ame
.
e_ˇtch
 = 0;

535 i‡(
	`£tjmp
(
ex˚±i⁄_‰ame
.
e_c⁄ãxt
))

537 
	`˛ór_°©e
();

538 ()
	`add_mesßge
("Anomaly inÅhe fabric of world space.\n");

539 
ªt
 = 
NULL
;

543 
ex˚±i⁄
 = &
ex˚±i⁄_‰ame
;

544 
evÆ_co°
 = 0;

545 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_START_SHUTDOWN
, 0);

547 i‡(
ªt
 &&Ñë->
ty≥
 =
T_POINTER
)

549 vﬁ©ûê
i
;

550 
ve˘‹
 *
u∆ﬂd_vec
 = 
ªt
->
u
.
vec
;

552 
	`INCREF
(
u∆ﬂd_vec
->
ªf
);

554 
i
 = 0; i < 
u∆ﬂd_vec
->
size
; i++)

555 i‡(
	`£tjmp
(
ex˚±i⁄_‰ame
.
e_c⁄ãxt
))

557 
	`˛ór_°©e
();

558 ()
	`add_mesßge
("Anomaly inÅhe fabric of world space.\n");

562 
ex˚±i⁄
 = &
ex˚±i⁄_‰ame
;

563 
	`push_svÆue
(&(
u∆ﬂd_vec
->
ôem
[
i
]));

564 
evÆ_co°
 = 0;

565 ()
	`≠∂y_ma°î_ob
(
M_CLEANUP_SHUTDOWN
, 1);

567 
	`‰ì_ve˘‹
(
u∆ﬂd_vec
);

569 i‡(
	`£tjmp
(
ex˚±i⁄_‰ame
.
e_c⁄ãxt
))

571 
	`˛ór_°©e
();

572 ()
	`add_mesßge
("Anomaly inÅhe fabric of world space.\n");

576 
ex˚±i⁄
 = &
ex˚±i⁄_‰ame
;

577 
evÆ_co°
 = 0;

578 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_FINAL_SHUTDOWN
, 0);

580 
ex˚±i⁄
 = 
NULL
;

581 
	}
}

584 
	$£t_¥om±
(*
°r
)

586 i‡(
°r
)

587 
comm™d_givî
->
öãø˘ive
->
¥om±
 = 
°r
;

589 
comm™d_givî
->
öãø˘ive
->
¥om±
 = "> ";

590 
	}
}

596 
	$¥öt_¥om±
()

598 i‡(
comm™d_givî
 == 0)

599 
	`Áèl
("command_giver == 0.\n");

600 i‡(
comm™d_givî
->
öãø˘ive
->
öput_to
 == 0)

602 i‡(!(
comm™d_givî
->
Êags
 & 
O_DESTRUCTED
) &&

603 
comm™d_givî
->
öãø˘ive
->
¥om±
)

604 ()
	`add_mesßge
("%s", 
comm™d_givî
->
öãø˘ive
->
¥om±
);

607 
	}
}

622 
	$£t_¢o›
(
obje˘
 *
me
, obje˘ *
you
)

624 
öãø˘ive
 *
⁄
 = 0, *
by
 = 0, *
tmp
;

625 
i
;

626 
svÆue
 *
ªt
;

627 
obje˘
 *
ma°î_ob
;

631 i‡(
me
->
Êags
 & 
O_DESTRUCTED
)

633 i‡(
you
 && (you->
Êags
 & 
O_DESTRUCTED
))

637 
i
 = 0 ; i < 
MAX_PLAYERS
 && (
⁄
 =0 || 
by
 == 0); i++)

639 i‡(
Æl_∂ayîs
[
i
] == 0)

641 i‡(
Æl_∂ayîs
[
i
]->
ob
 =
me
)

642 
by
 = 
Æl_∂ayîs
[
i
];

643 i‡(
Æl_∂ayîs
[
i
]->
ob
 =
you
)

644 
⁄
 = 
Æl_∂ayîs
[
i
];

648 i‡(
cuºít_obje˘
 !
ma°î_ob
)

650 
	`push_obje˘
(
cuºít_obje˘
);

651 
	`push_obje˘
(
me
);

652 i‡(
you
 == 0)

653 
	`push_numbî
(0);

655 
	`push_obje˘
(
you
);

656 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_VALID_SNOOP
, 3);

658 i‡(
ªt
 && (ªt->
ty≥
 !
T_NUMBER
 ||Ñë->
u
.
numbî
 == 0))

662 i‡(
you
 == 0)

664 i‡(
by
 == 0)

665 
	`îr‹
("CouldÇot find snooperÅo stop snoop on.\n");

666 i‡(
by
->
¢o›_⁄
 == 0)

668 
by
->
¢o›_⁄
->
¢o›_by
 = 0;

669 
by
->
¢o›_⁄
 = 0;

674 i‡(
⁄
 =0 || 
by
 == 0)

678 
tmp
 = 
⁄
;Åmp;Åm∞tmp->
¢o›_⁄
)

680 i‡(
tmp
 =
by
)

685 i‡(
by
->
¢o›_⁄
)

687 
by
->
¢o›_⁄
->
¢o›_by
 = 0;

688 
by
->
¢o›_⁄
 = 0;

690 i‡(
⁄
->
¢o›_by
)

692 
⁄
->
¢o›_by
->
¢o›_⁄
 = 0;

693 
⁄
->
¢o›_by
 = 0;

696 
⁄
->
¢o›_by
 = 
by
;

697 
by
->
¢o›_⁄
 = 
⁄
;

700 
	}
}

702 
	#IPSIZE
 200

	)

703 
	sùíåy


705 
	maddr
;

706 *
	m«me
;

707 } 
	gùèbÀ
[
IPSIZE
];

708 
	gùcur
;

710 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


712 
	$˛ór_ù_èbÀ
()

714 
i
;

716 
i
 = 0; i < 
IPSIZE
; i++)

717 i‡(
ùèbÀ
[
i
].
«me
) {

718 
	`‰ì_s°rög
(
ùèbÀ
[
i
].
«me
);

719 
ùèbÀ
[
i
].
«me
 = 
NULL
;

721 
	}
}

725 
	$quîy_ù_«me
(
obje˘
 *
ob
)

727 
i
;

729 i‡(
ob
 == 0)

730 
ob
 = 
comm™d_givî
;

731 i‡(!
ob
 || ob->
öãø˘ive
 == 0)

733 
i
 = 0; i < 
IPSIZE
; i++)

735 i‡(
ùèbÀ
[
i
].
addr
 ==

736 (
ob
->
öãø˘ive
->
addr
.
sö_addr
.
s_addr
 & 0xffffffff) &&

737 
ùèbÀ
[
i
].
«me
)

738  
ùèbÀ
[
i
].
«me
;

740  
	`öë_¡ﬂ
(
ob
->
öãø˘ive
->
addr
.
sö_addr
);

741 
	}
}

744 
	$add_ù_íåy
(
addr
, *
«me
)

746 
i
;

748 
i
 = 0; i < 
IPSIZE
; i++)

750 i‡(
ùèbÀ
[
i
].
addr
 ==áddr)

753 
ùèbÀ
[
ùcur
].
addr
 =áddr;

754 i‡(
ùèbÀ
[
ùcur
].
«me
)

755 
	`‰ì_s°rög
(
ùèbÀ
[
ùcur
].
«me
);

756 
ùèbÀ
[
ùcur
].
«me
 = 
	`make_s°rög
(name);

757 
ùcur
 = (ùcur+1Ë% 
IPSIZE
;

758 
	}
}

761 
	$quîy_ù_numbî
(
obje˘
 *
ob
)

763 i‡(
ob
 == 0)

764 
ob
 = 
comm™d_givî
;

765 i‡(!
ob
 || ob->
öãø˘ive
 == 0)

767  
	`öë_¡ﬂ
(
ob
->
öãø˘ive
->
addr
.
sö_addr
);

768 
	}
}

770 #i‚de‡
INET_NTOA_OK


772 
	$öë_¡ﬂ
(
ö_addr
 
ö
)

774 
b
[18];

775 *
p
;

777 
p
 = (*)&
ö
;

778 
	#UC
(
b
Ë((()bË& 0xFF)

	)

779 ()
	`•rötf
(
b
, "%d.%d.%d.%d", 
	`UC
(
p
[0]), UC(p[1]), UC(p[2]), UC(p[3]));

780 #unde‡
UC


781  
b
;

782 
	}
}

786 
	$quîy_ho°_«me
()

788 
«me
[36];

790 ()
	`gëho°«me
(
«me
, Çame);

791 
«me
[Çame - 1] = '\0';

792  
«me
;

793 
	}
}

795 
obje˘
 *

796 
	$quîy_¢o›
(
obje˘
 *
ob
)

798 i‡(
ob
->
öãø˘ive
->
¢o›_by
 == 0)

800  
ob
->
öãø˘ive
->
¢o›_by
->ob;

801 
	}
}

804 
	$quîy_idÀ
(
obje˘
 *
ob
)

806 i‡(!
ob
->
öãø˘ive
)

807 
	`îr‹
("query_idle() ofÇon-interactive object.\n");

808  
cuºít_time
 - 
ob
->
öãø˘ive
->
œ°_time
;

809 
	}
}

812 
	$nŸify_no_comm™d
()

814 *
p
,*
m
;

815 
obje˘
 *
vbfc_obje˘
;

817 i‡(!
comm™d_givî
->
öãø˘ive
)

819 
p
 = 
comm™d_givî
->
öãø˘ive
->
deÁu…_îr_mesßge
;

820 i‡(
p
)

824 
m
 = 
	`¥o˚ss_°rög
(
p
, 
vbfc_obje˘
 != 0);

825 ()
	`add_mesßge
("%s", 
m
);

826 i‡(
m
 !
p
)

827 
	`‰ì
(
m
);

828 
	`‰ì_s°rög
(
p
);

829 
comm™d_givî
->
öãø˘ive
->
deÁu…_îr_mesßge
 = 0;

832 ()
	`add_mesßge
("Slucham?\n");

833 
	}
}

836 
	$˛ór_nŸify
()

838 i‡(!
comm™d_givî
 || !comm™d_givî->
öãø˘ive
)

840 i‡(
comm™d_givî
->
öãø˘ive
->
deÁu…_îr_mesßge
)

842 
	`‰ì_s°rög
(
comm™d_givî
->
öãø˘ive
->
deÁu…_îr_mesßge
);

843 
comm™d_givî
->
öãø˘ive
->
deÁu…_îr_mesßge
 = 0;

845 
	}
}

848 
	$£t_nŸify_Áû_mesßge
(*
°r
, 
¥i
)

850 i‡(!
comm™d_givî
 || !comm™d_givî->
öãø˘ive
)

852 i‡(
comm™d_givî
->
öãø˘ive
->
deÁu…_îr_mesßge
 && 
¥i
 == 0)

854 
	`˛ór_nŸify
();

855 i‡(
comm™d_givî
->
öãø˘ive
->
deÁu…_îr_mesßge
)

856 
	`‰ì_s°rög
(
comm™d_givî
->
öãø˘ive
->
deÁu…_îr_mesßge
);

857 
comm™d_givî
->
öãø˘ive
->
deÁu…_îr_mesßge
 = 
	`make_s°rög
(
°r
);

858 
	}
}

861 
	$ª∂a˚_öãø˘ive
(
obje˘
 *
ob
, obje˘ *
ob‰om
,

862  *
«me
)

864 
svÆue
 *
v
;

869 
	`push_°rög
(
«me
, 
STRING_MSTRING
);

870 i‡(
ob
)

871 
	`push_obje˘
(
ob
);

873 
	`push_numbî
(0);

874 
	`push_obje˘
(
ob‰om
);

875 
v
 = 
	`≠∂y_ma°î_ob
(
M_VALID_EXEC
, 3);

876 i‡(
v
 && (v->
ty≥
 !
T_NUMBER
 || v->
u
.
numbî
 == 0))

880 i‡(
ob
 && ob->
öãø˘ive
)

881 
	`îr‹
("Badárgument1ÅoÉxec(), wasán interactive\n");

882 i‡(!
ob‰om
->
öãø˘ive
)

883 
	`îr‹
("Badárgument2ÅoÉxec(), wasÇotán interactive\n");

884 i‡(
ob
)

886 #ifde‡
SUPER_SNOOP


887 i‡(
ob‰om
->
öãø˘ive
->
¢o›_fd
 >= 0) {

888 ()
	`˛o£
(
ob‰om
->
öãø˘ive
->
¢o›_fd
);

889 
ob‰om
->
öãø˘ive
->
¢o›_fd
 = -1;

892 
ob
->
öãø˘ive
 = 
ob‰om
->interactive;

893 
ob
->
öãø˘ive
->ob = ob;

894 
ob
->
Êags
 |
O_ONCE_INTERACTIVE
;

895 
	`add_ªf
(
ob
, "exec");

896 
	`‰ì_obje˘
(
ob‰om
, "exec");

897 
ob‰om
->
öãø˘ive
 = 0;

898 
ob‰om
->
Êags
 &~
O_ONCE_INTERACTIVE
;

899 #ifde‡
SUPER_SNOOP


900 
	`check_su≥r¢o›
(
ob
);

904 
	`ªmove_öãø˘ive
(
ob‰om
->
öãø˘ive
, 0);

905 i‡(
ob‰om
 =
comm™d_givî
Ëcomm™d_givî = 
ob
;

907 
	}
}

909 #ifde‡
DEBUG


915 
	$upd©e_ªf_cou¡s_f‹_∂ayîs
()

917 
i
;

919 
i
 = 0; i<
MAX_PLAYERS
; i++)

921 i‡(
Æl_∂ayîs
[
i
] == 0)

923 
Æl_∂ayîs
[
i
]->
ob
->
exåa_ªf
++;

924 i‡(
Æl_∂ayîs
[
i
]->
öput_to
)

925 
Æl_∂ayîs
[
i
]->
öput_to
->
fun˘
->
funobj
->
exåa_ªf
++;

927 
	}
}

931 
	$öãø˘ive_öput
(
öãø˘ive
 *
ù
, *
˝
)

933 
	`¥öt_mud°©us
(*, , , );

934 
	`ª£t_mud°©us
();

935 
	`upd©e_lﬂd_av
();

936 
	`gë_¥o˚s°ime
();

937 
	`gë_mûlôime
();

938 
	`ed_cmd
(*);

939 
gdex˚±i⁄
 
ex˚±i⁄_‰ame
;

941 #ifde‡
WORD_WRAP


942 
ù
->
cuºít_cﬁumn
 = 0;

945 i‡(
ù
->
n€cho
 && (
˝
[0] !'!' || !ù->
ob
->
su≥r
))

947 
ù
->
n€cho
 = 0;

948 
	`ã ë_dißbÀ_echo
(
ù
->
ç
);

952 #ifde‡
SUPER_SNOOP


953 i‡(
ù
->
¢o›_fd
 != -1)

955 ()
	`wrôe
(
ù
->
¢o›_fd
, "#", 1);

956 ()
	`wrôe
(
ù
->
¢o›_fd
, 
˝
, 
	`°æí
(cp));

957 ()
	`wrôe
(
ù
->
¢o›_fd
, "\n", 1);

961 i‡(
ù
->
¢o›_by
 !
NULL
)

963 i‡((
	`°æí
(
˝
Ë+ 10Ë> 
MAX_SNOOP_MSG_SIZE
)

964 
˝
[
MAX_SNOOP_MSG_SIZE
 - 10] = '\0';

966 
	`add_mesßge2
(
ù
->
¢o›_by
->
ob
, "%% %s\n", 
˝
);

970 
ù
->
œ°_time
 = 
cuºít_time
;

972 
	`upd©e_lﬂd_av
();

973 
evÆ_co°
 = 0;

991 
comm™d_givî
 = 
ù
->
ob
;

992 
cuºít_obje˘
 = 
NULL
;

993 
cuºít_öãø˘ive
 = 
comm™d_givî
;

994 
¥evious_ob
 = 
comm™d_givî
;

996 #ifde‡
DEBUG


997 i‡(!
comm™d_givî
->
öãø˘ive
)

998 
	`Áèl
("Non interactiveÖlayer in mainÜoop!\n");

1001 i‡(
s_Êag
)

1003 
	`ª£t_mud°©us
();

1006 
ex˚±i⁄_‰ame
.
e_ex˚±i⁄
 = 
ex˚±i⁄
;

1007 
ex˚±i⁄_‰ame
.
e_ˇtch
 = 0;

1008 
ex˚±i⁄
 = &
ex˚±i⁄_‰ame
;

1010 i‡(
	`£tjmp
(
ex˚±i⁄_‰ame
.
e_c⁄ãxt
) == 0)

1012 i‡(
˝
[0] ='!' && 
comm™d_givî
->
su≥r
)

1013 ()
	`∑r£_comm™d
(
˝
 + 1, 
comm™d_givî
);

1015 i‡(
comm™d_givî
->
öãø˘ive
->
ed_buf„r
)

1016 
	`ed_cmd
(
˝
);

1018 i‡(!
	`ˇŒ_fun˘i⁄_öãø˘ive
(
comm™d_givî
->
öãø˘ive
, 
˝
))

1019 ()
	`∑r£_comm™d
(
˝
, 
comm™d_givî
);

1022 
ex˚±i⁄
 = 
ex˚±i⁄_‰ame
.
e_ex˚±i⁄
;

1024 i‡(
comm™d_givî
 !
NULL
 && comm™d_givî->
öãø˘ive
 != NULL)

1026 
	`¥öt_¥om±
();

1028 i‡(
s_Êag
)

1030 
	`¥öt_mud°©us
(
comm™d_givî
->
«me
, 
evÆ_co°
, 
	`gë_mûlôime
(), 
	`gë_¥o˚s°ime
());

1033 
	}
}

	@comm1.h

1 
wrôe_sockë
(*, 
obje˘
 *);

2 
add_mesßge
(*
fmt
, ...);

3 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


4 
˛ór_ù_èbÀ
();

	@config.h

6 #i‚de‡
__Õc_c⁄fig_h_


7 
	#__Õc_c⁄fig_h_


	)

12 
	#READ_FILE_MAX_SIZE
 50000

	)

17 
	#GAME_VERSION
 "CD.04."

	)

22 
	#USE_SWAP


	)

27 
	#SWAP_STDIO


	)

33 #unde‡
DO_CLEANUP


38 #unde‡
OLD_EXPLODE


43 
	#ED_INDENT


	)

48 
	#WARN_INCLUDES


	)

53 
	#STATIC_ADD_ACTIONS


	)

58 
	#COMPAT_ADD_ACTIONS


	)

63 
	#TIME_RES
 10

	)

68 
	#NUM_SLOTS
 0x4000

	)

73 
	#MAX_CALL_OUT
 128

	)

82 
	#EXTRACT_UCHAR
(
p
Ë(*(*)’))

	)

88 
	#EVALUATOR_STACK_SIZE
 4000

	)

93 
	#MAX_TRACE
 0x100

	)

99 
	#COMPILER_STACK_SIZE
 4000

	)

105 #unde‡
TRACE_CODE


110 
	#RUSAGE


	)

123 
	#BINARIES
 "bö¨õs/"

	)

136 
	#GLOBAL_CACHE
 0x4000

	)

139 #unde‡
CACHE_STATS


147 
	#USE_ENCOUNTER_NOT_INIT


	)

153 
	#MAX_BITS
 4002

	)

158 
	#LIVING_HASH_SIZE
 0x1000

	)

163 
	#PORTNO
 2300

	)

168 
	#MAX_LOCAL
 30

	)

174 
	#PTR_HASH
(
±r
, 
size
)\

175 ––(((*Ë&(
±r
))[0] / (*)) ^ \

176 (((*Ë&(
±r
))[1] / (*)ËË% ()(
size
Ë)

	)

181 
	#MAX_COST
 500000

	)

190 
	#EXTRA_COST
 1000

	)

195 
	#MAX_STRING_LENGTH
 60000

	)

200 
	#MAX_INHERIT
 42

	)

205 
	#MAX_INCLUDE
 10

	)

211 
	#SWAP_FILE
 "LP_SWAP.4"

	)

216 
	#MAX_ARRAY_SIZE
 5000

	)

221 
	#MAX_MAPPING_SIZE
 5000

	)

232 
	#INET_NTOA_OK


	)

239 
	#MAX_PLAYERS
 500

	)

248 
	#ALLOWED_ED_CMDS
 20

	)

255 
	#RESERVED_SIZE
 1000000

	)

268 
	#HTABLE_SIZE
 0x8000

	)

276 
	#OTABLE_SIZE
 0x4000

	)

282 #unde‡
SYSV


287 #unde‡
FCHMOD_MISSING


293 
	#MAX_BYTE_TRANSFER
 10000

	)

303 
	#CATCH_UDP_PORT
 2500

	)

313 #unde‡
UDP_SEND_HOSTNAME


323 
	#SERVICE_PORT
 3003

	)

342 #unde‡
OPCPROF


355 #unde‡
PROFILE_OBJS


367 #unde‡
PROFILE_FUNS


378 #unde‡
SUPER_SNOOP


390 
	#P1
 701

	)

391 
	#P2
 14009

	)

392 
	#P3
 54001

	)

396 
	#BITNUM
(
n
) (( \

397 ((
n
)&010101010101)+\

398 (((
n
)&020202020202)>>1)+\

399 (((
n
)&000404040404)>>2)+\

400 (((
n
)&001010101010)>>3)+\

401 (((
n
)&002020202020)>>4)+\

402 (((
n
)&004040404040)>>5)\

403 Ë% 63)

	)

	@debug.c

8 
	~<v¨¨gs.h
>

9 
	~<°dio.h
>

10 
	~<°rög.h
>

11 
	~<˘y≥.h
>

12 
	~<sys/time.h
>

13 
	~<sys/ty≥s.h
>

14 
	~<sys/°©.h
>

16 
	~<mem‹y.h
>

18 
	~"c⁄fig.h
"

19 
	~"löt.h
"

20 
	~"m°rög.h
"

21 
	~"exec.h
"

22 
	~"öãΩªt.h
"

23 
	~"sw≠.h
"

24 
	~"udpsvc.h
"

26 #ifde‡
RUSAGE


27 #ifde‡
SOLARIS


28 
	~<sys/times.h
>

29 
	~<limôs.h
>

31 
	~<sys/ªsour˚.h
>

32 
gërußge
 (, 
rußge
 *);

33 #ifde‡
sun


34 
gë∑gesize
 ();

36 #i‚de‡
RUSAGE_SELF


37 
	#RUSAGE_SELF
 0

	)

40 #ifde‡
PROFILE_OBJS


41 
ve˘‹
 *
make_˝u_¨øy
 (,
¥ogøm
 *[]);

46 
	~"obje˘.h
"

47 
	~"ö°rs.h
"

48 
	~"∑tchÀvñ.h
"

49 
	~"comm.h
"

50 
	~"m≠pög.h
"

51 
	~"mud°©.h
"

52 
	~"bib›mÆloc.h
"

53 
	~"simuœã.h
"

54 
	~"comm1.h
"

55 
	~"su≥r_¢o›.h
"

57 
	~"ölöe_svÆue.h
"

59 
	#DUMP_FILE
 "OBJECT_DUMP"

	)

66 *
	gdebc
[] = { "index",

108 
ve˘‹
 *
öhîô_li°
 (
obje˘
 *);

109 #ifde‡
FUNCDEBUG


110 
dumpfuncs
();

112 #ifde‡
OPCPROF


113 
›cdump
();

116 
svÆue
 *

117 
	$debug_comm™d
(*
debcmd
, 
¨gc
, 
svÆue
 *
¨gv
)

119 
svÆue
 
ªtvÆ
;

120 
dbnum
, 
dbi
, 
û
;

122 
dbi
 = -1, 
dbnum
 = 0; 
debc
[dbnum]; dbnum++)

124 i‡(
	`°rcmp
(
debcmd
, 
debc
[
dbnum
]) == 0)

125 
dbi
 = 
dbnum
;

127 i‡(
dbi
 < 0)

129 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

130 
ªtvÆ
.
u
.
numbî
 = 0;

131  &
ªtvÆ
;

134 
dbi
)

137 
ªtvÆ
.
ty≥
 = 
T_POINTER
;

138 
ªtvÆ
.
u
.
vec
 = 
	`Æloˇã_¨øy
(
dbnum
);

139 
û
 = 0; i»< 
dbnum
; il++)

141 
ªtvÆ
.
u
.
vec
->
ôem
[
û
].
ty≥
 = 
T_STRING
;

142 
ªtvÆ
.
u
.
vec
->
ôem
[
û
].
°rög_ty≥
 = 
STRING_CSTRING
;

143 
ªtvÆ
.
u
.
vec
->
ôem
[
û
].u.
°rög
 = 
debc
[il];

145  &
ªtvÆ
;

147 
ªtvÆ
.
ty≥
 = 
T_STRING
;

148 
ªtvÆ
.
°rög_ty≥
 = 
STRING_MSTRING
;

149 
ªtvÆ
.
u
.
°rög
 = 
	`make_m°rög
((*)
	`dump_mÆloc_d©a
());

150  &
ªtvÆ
;

153 
ªtvÆ
.
ty≥
 = 
T_STRING
;

154 
ªtvÆ
.
°rög_ty≥
 = 
STRING_MSTRING
;

155 
ªtvÆ
.
u
.
°rög
 = (*)
	`gë_gamedrivî_öfo
(
debc
[
dbi
]);

156  &
ªtvÆ
;

158 i‡(
¨gc
 < 3 ||

159 
¨gv
[0].
ty≥
 !
T_STRING
 ||

160 
¨gv
[1].
ty≥
 !
T_NUMBER
 ||

161 
¨gv
[2].
ty≥
 !
T_NUMBER
)

163 i‡(
	`°rcmp
(
¨gv
[0].
u
.
°rög
, "on") == 0)

164 
	`mud°©us_£t
(1, 
¨gv
[1].
u
.
numbî
,árgv[2].u.number);

165 i‡(
	`°rcmp
(
¨gv
[0].
u
.
°rög
, "off") == 0)

166 
	`mud°©us_£t
(0, 
¨gv
[1].
u
.
numbî
,árgv[2].u.number);

169 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

170 
ªtvÆ
.
u
.
numbî
 = 1;

171  &
ªtvÆ
;

173 i‡(
¨gc
 < 1 || 
¨gv
[0].
ty≥
 !
T_OBJECT
)

175 #ifde‡
USE_SWAP


176 
	`ac˚ss_¥ogøm
(
¨gv
->
u
.
ob
->
¥og
);

178 
ªtvÆ
.
ty≥
 = 
T_POINTER
;

179 
ªtvÆ
.
u
.
vec
 = 
	`Æloˇã_¨øy
(
¨gv
[0].u.
ob
->
¥og
->
num_fun˘i⁄s
);

180 
û
 = 0; i»< ()
¨gv
[0].
u
.
ob
->
¥og
->
num_fun˘i⁄s
; il++)

182 
ªtvÆ
.
u
.
vec
->
ôem
[
û
].
ty≥
 = 
T_STRING
;

183 
ªtvÆ
.
u
.
vec
->
ôem
[
û
].
°rög_ty≥
 = 
STRING_SSTRING
;

184 
ªtvÆ
.
u
.
vec
->
ôem
[
û
].u.
°rög
 =

185 
	`ª„ªn˚_s°rög
(
¨gv
[0].
u
.
ob
->
¥og
->
fun˘i⁄s
[
û
].
«me
);

187 #ifde‡
USE_SWAP


188 
	`ac˚ss_¥ogøm
(
cuºít_¥og
);

190  &
ªtvÆ
;

191 #ifde‡
RUSAGE


194 
buff
[1000];

195 #ifde‡
SOLARIS


196 
tms
 
buf„r
;

198 i‡(
	`times
(&
buf„r
) == -1)

199 
buff
[0] = 0;

201 ()
	`•rötf
(
buff
, "%ld %ld (s/%ld)",

202 
buf„r
.
tms_utime
, buf„r.
tms_°ime
, 
CLK_TCK
);

204 
rußge
 
rus
;

205 
utime
, 
°ime
;

206 
maxrss
;

208 i‡(
	`gërußge
(
RUSAGE_SELF
, &
rus
) < 0)

209 
buff
[0] = 0;

211 
utime
 = 
rus
.
ru_utime
.
tv_£c
 * 1000 +Ñus.ru_utime.
tv_u£c
 / 1000;

212 
°ime
 = 
rus
.
ru_°ime
.
tv_£c
 * 1000 +Ñus.ru_°ime.
tv_u£c
 / 1000;

213 
maxrss
 = 
rus
.
ru_maxrss
;

214 #ifde‡
sun


215 
maxrss
 *
	`gë∑gesize
() / 1024;

217 ()
	`•rötf
(
buff
, "userÅime used\t\t\t%ld\nsystemÅime used\t\t%ld\n",

218 
utime
, 
°ime
);

219 ()
	`•rötf
(
buff
, "%smaximumÑesident set size\t%ld\n",

220 
buff
, 
maxrss
);

221 ()
	`•rötf
(
buff
, "%sintegral shared memory size\t%ld\n",

222 
buff
, 
rus
.
ru_ixrss
);

223 ()
	`•rötf
(
buff
, "%sintegral unshared memory size\t%ld\n",

224 
buff
, 
rus
.
ru_idrss
);

225 ()
	`•rötf
(
buff
, "%sintegral unshared stack size\t%ld\n",

226 
buff
, 
rus
.
ru_i§ss
);

227 ()
	`•rötf
(
buff
, "%spageÑeclaims\t\t\t%ld\npage faults\t\t\t%ld\n",

228 
buff
, 
rus
.
ru_möÊt
,Ñus.
ru_majÊt
);

229 ()
	`•rötf
(
buff
, "%sswaps\t\t\t\t%ld\nblock input operations\t\t%ld\n",

230 
buff
, 
rus
.
ru_nsw≠
,Ñus.
ru_öblock
);

231 ()
	`•rötf
(
buff
, "%sblock output operations\t\t%ld\nmessages sent\t\t\t%ld\n",

232 
buff
, 
rus
.
ru_oublock
,Ñus.
ru_msg¢d
);

233 ()
	`•rötf
(
buff
, "%smessagesÑeceived\t\t%ld\nsignalsÑeceived\t\t%ld\n",

234 
buff
, 
rus
.
ru_msgrcv
,Ñus.
ru_nsig«ls
);

235 ()
	`•rötf
(
buff
, "%svoluntary context switches\t%ld\ninvoluntary context switches\t%ld\n",

236 
buff
, 
rus
.
ru_nvcsw
,Ñus.
ru_nivcsw
);

237 ()
	`•rötf
(
buff
, "%s\n", buff);

240 
ªtvÆ
.
ty≥
 = 
T_STRING
;

241 
ªtvÆ
.
°rög_ty≥
 = 
STRING_MSTRING
;

242 
ªtvÆ
.
u
.
°rög
 = 
	`make_m°rög
(
buff
);

243  &
ªtvÆ
;

245 #ifde‡
PROFILE_OBJS


248 
	#NUMBER_OF_TOP_TEN
 10

	)

249 
¥ogøm
 *
p
[
NUMBER_OF_TOP_TEN
];

250 
obje˘
 *
ob
;

251 
ve˘‹
 *
v
;

252 
i
, 
j
;

253 
i
 = 0; i < 
NUMBER_OF_TOP_TEN
; i++)

254 
p
[
i
] = (
¥ogøm
 *)0L;

255 
ob
 = 
obj_li°
;

258 i‡(!
ob
->
¥og
)

261 
i
 = 
NUMBER_OF_TOP_TEN
-1; i >= 0; i--)

263 i‡–
p
[
i
] && (
ob
->
¥og
->
˝u
 <=Ö[i]->cpu))

267 i‡(
i
 < (
NUMBER_OF_TOP_TEN
 - 1))

268 
j
 = 0; j <
i
; j++)

269 i‡(
	`°rcmp
(
p
[
j
]->
«me
,
ob
->
¥og
->name) == 0)

271 
i
 = 
NUMBER_OF_TOP_TEN
-1;

275 i‡(
i
 < (
NUMBER_OF_TOP_TEN
 - 1))

277 
j
 = 
NUMBER_OF_TOP_TEN
 - 2;

278 
j
 > 
i
)

280 
p
[
j
 + 1] =Ö[j];

281 
j
--;

283 
p
[
i
 + 1] = 
ob
->
¥og
;

285 } 
obj_li°
 !(
ob
 = ob->
√xt_Æl
));

286 
v
 = 
	`make_˝u_¨øy
(
NUMBER_OF_TOP_TEN
, 
p
);

287 i‡(
v
)

289 
ªtvÆ
.
ty≥
 = 
T_POINTER
;

290 
ªtvÆ
.
u
.
vec
 = 
v
;

291  &
ªtvÆ
;

294 #unde‡
NUMBER_OF_TOP_TEN


298 
ªtvÆ
.
ty≥
 = 
T_STRING
;

299 
ªtvÆ
.
°rög_ty≥
 = 
STRING_CSTRING
;

300 
ªtvÆ
.
u
.
°rög
 = "Only valid if GD compiled with PROFILE_OBJS flag.\n";

301  &
ªtvÆ
;

305 
c_num
;

307 i‡(
¨gc
 && (
¨gv
[0].
ty≥
 =
T_OBJECT
))

309 #ifde‡
PROFILE_OBJS


310 
˝u
 = 
¨gv
[0].
u
.
ob
->
¥og
->cpu;

311 
c_num
 = ()
˝u
;

313 
ªtvÆ
.
ty≥
 = 
T_STRING
;

314 
ªtvÆ
.
°rög_ty≥
 = 
STRING_CSTRING
;

315 
ªtvÆ
.
u
.
°rög
 = "Only valid if GD compiled with PROFILE_OBJS flag.\n";

316  &
ªtvÆ
;

321 #ifde‡
SOLARIS


322 
tms
 
buf„r
;

324 i‡(
	`times
(&
buf„r
) == -1)

325 
c_num
 = -1;

327 
c_num
 = 
buf„r
.
tms_utime
 + buf„r.
tms_°ime
;

329 
rußge
 
rus
;

331 i‡(
	`gërußge
(
RUSAGE_SELF
, &
rus
) < 0)

333 
c_num
 = -1;

337 
c_num
 = ()(
rus
.
ru_utime
.
tv_£c
 * 1000 +

338 
rus
.
ru_utime
.
tv_u£c
 / 1000 +

339 
rus
.
ru_°ime
.
tv_£c
 * 1000 +

340 
rus
.
ru_°ime
.
tv_u£c
 / 1000);

344 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

345 
ªtvÆ
.
u
.
numbî
 = 
c_num
;

346  &
ªtvÆ
;

352 
ªtvÆ
.
ty≥
 = 
T_STRING
;

353 
ªtvÆ
.
°rög_ty≥
 = 
STRING_CSTRING
;

354 
ªtvÆ
.
u
.
°rög
 = "Only valid if GD compiled with RUSAGE flag.\n";

355  &
ªtvÆ
;

360 i‡(
¨gc
 && (
¨gv
[0].
ty≥
 =
T_OBJECT
))

361 ()
	`sw≠
(
¨gv
[0].
u
.
ob
);

363 
ªtvÆ
 = 
c⁄°1
;

364  &
ªtvÆ
;

367 
buff
[11];

368 ()
	`•rötf
(
buff
, "%6.8s%02d", 
GAME_VERSION
, 
PATCH_LEVEL
);

369 
ªtvÆ
.
ty≥
 = 
T_STRING
;

370 
ªtvÆ
.
°rög_ty≥
 = 
STRING_MSTRING
;

371 
ªtvÆ
.
u
.
°rög
 = 
	`make_m°rög
(
buff
);

372  &
ªtvÆ
;

376 #ifde‡
TRACE_CODE


377 
Ÿ
 = -1;

378 
obje˘
 *
cuºít_öãø˘ive
;

379 i‡(
cuºít_öãø˘ive
 && cuºít_öãø˘ive->
öãø˘ive
)

381 i‡(
¨gc
 && (
¨gv
[0].
ty≥
 =
T_NUMBER
))

383 
Ÿ
 = 
cuºít_öãø˘ive
->
öãø˘ive
->
åa˚_Àvñ
;

384 
cuºít_öãø˘ive
->
öãø˘ive
->
åa˚_Àvñ
 = 
¨gv
[0].
u
.
numbî
;

388 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

389 
ªtvÆ
.
u
.
numbî
 = 
Ÿ
;

390  &
ªtvÆ
;

392 
ªtvÆ
.
ty≥
 = 
T_STRING
;

393 
ªtvÆ
.
°rög_ty≥
 = 
STRING_CSTRING
;

394 
ªtvÆ
.
u
.
°rög
 = "Only valid if GD compiled with TRACE_CODE flag.\n";

395  &
ªtvÆ
;

400 #ifde‡
TRACE_CODE


401 *
ﬁd
 = 0;

403 
obje˘
 *
cuºít_öãø˘ive
;

404 i‡(
cuºít_öãø˘ive
 && cuºít_öãø˘ive->
öãø˘ive
)

406 i‡(
¨gc
)

408 
ﬁd
 = 
cuºít_öãø˘ive
->
öãø˘ive
->
åa˚_¥efix
;

409 i‡(
¨gv
[0].
ty≥
 =
T_STRING
)

411 
cuºít_öãø˘ive
->
öãø˘ive
->
åa˚_¥efix
 =

412 
	`make_s°rög
(
¨gv
[0].
u
.
°rög
);

415 
cuºít_öãø˘ive
->
öãø˘ive
->
åa˚_¥efix
 = 0;

419 i‡(
ﬁd
)

421 
ªtvÆ
.
ty≥
 = 
T_STRING
;

422 
ªtvÆ
.
°rög_ty≥
 = 
STRING_SSTRING
;

423 
ªtvÆ
.
u
.
°rög
 = 
ﬁd
;

426 
ªtvÆ
 = 
c⁄°0
;

428  &
ªtvÆ
;

430 
ªtvÆ
.
ty≥
 = 
T_STRING
;

431 
ªtvÆ
.
°rög_ty≥
 = 
STRING_CSTRING
;

432 
ªtvÆ
.
u
.
°rög
 = "Only valid if GD compiled with TRACE_CODE flag.\n";

433  &
ªtvÆ
;

438 
ve˘‹
 *
	`gë_ˇŒs
(
obje˘
 *);

439 i‡(
¨gv
[0].
ty≥
 !
T_OBJECT
)

441 
ªtvÆ
.
ty≥
 = 
T_POINTER
;

442 
ªtvÆ
.
u
.
vec
 = 
	`gë_ˇŒs
(
¨gv
[0].u.
ob
);

443  &
ªtvÆ
;

446 i‡(
¨gc
 && (
¨gv
[0].
ty≥
 =
T_OBJECT
))

448 
ªtvÆ
.
ty≥
 = 
T_POINTER
;

449 
ªtvÆ
.
u
.
vec
 = 
	`öhîô_li°
(
¨gv
[0].u.
ob
);

450  &
ªtvÆ
;

454 
ªtvÆ
 = 
c⁄°0
;

455  &
ªtvÆ
;

458 
ªtvÆ
.
ty≥
 = 
T_STRING
;

459 
ªtvÆ
.
°rög_ty≥
 = 
STRING_MSTRING
;

460 
ªtvÆ
.
u
.
°rög
 = 
	`make_m°rög
(
	`quîy_lﬂd_av
());

461  &
ªtvÆ
;

464 
	`°¨tshutdowngame
(0);

465 
ªtvÆ
 = 
c⁄°1
;

466  &
ªtvÆ
;

470 
obje˘
 *
ob
;

471 
db_buff
[1024], 
tdb
[200];

472 
i
;

474 i‡(
¨gc
 < 2 || 
¨gv
[0].
ty≥
 !
T_NUMBER
 ||árgv[1].ty≥ !
T_OBJECT
)

477 i‡(
¨gv
[0].
u
.
numbî
 == 0)

479 
Êags
;

480 
obje˘
 *
obj2
;

482 i‡–
¨gv
[1].
ty≥
 !
T_OBJECT
)

484 
ob
 = 
¨gv
[1].
u
.ob;

485 
Êags
 = 
ob
->flags;

486 ()
	`•rötf
(
db_buff
,"O_ENABLE_COMMANDS : %s\nO_CLONE : %s\nO_DESTRUCTED : %s\nO_SWAPPED : %s\nO_ONCE_INTERACTIVE: %s\nO_CREATED : %s\n",

487 
Êags
&
O_ENABLE_COMMANDS
 ?"TRUE":"FALSE",

488 
Êags
&
O_CLONE
 ?"TRUE":"FALSE",

489 
Êags
&
O_DESTRUCTED
 ?"TRUE":"FALSE",

490 
Êags
&
O_SWAPPED
 ?"TRUE":"FALSE",

491 
Êags
&
O_ONCE_INTERACTIVE
?"TRUE":"FALSE",

492 
Êags
&
O_CREATED
 ?"TRUE":"FALSE");

494 ()
	`•rötf
(
tdb
,"time_of_ª‡: %d\n", 
ob
->
time_of_ªf
);

495 ()
	`°rˇt
(
db_buff
, 
tdb
);

496 ()
	`•rötf
(
tdb
,"ª‡ : %d\n", 
ob
->
ªf
);

497 ()
	`°rˇt
(
db_buff
, 
tdb
);

498 #ifde‡
DEBUG


499 ()
	`•rötf
(
tdb
,"exåa_ª‡ : %d\n", 
ob
->
exåa_ªf
);

500 ()
	`°rˇt
(
db_buff
, 
tdb
);

502 ()
	`•rötf
(
tdb
,"sw≠_num : %d\n", 
ob
->
sw≠_num
);

503 ()
	`°rˇt
(
db_buff
, 
tdb
);

504 ()
	`•rötf
(
tdb
,"«mê : '%s'\n", 
ob
->
«me
);

505 ()
	`°rˇt
(
db_buff
, 
tdb
);

506 ()
	`•rötf
(
tdb
,"next_all : OBJ(%s)\n",

507 
ob
->
√xt_Æl
?ob->√xt_Æl->
«me
:"NULL");

508 ()
	`°rˇt
(
db_buff
, 
tdb
);

509 i‡(
obj_li°
 =
ob
)

511 ()
	`°rˇt
(
db_buff
, "This object isÅhe head ofÅhe objectÜist.\n");

514 
obj2
 = 
obj_li°
;

515 
i
 = 1;

517 i‡(
obj2
->
√xt_Æl
 =
ob
)

519 ()
	`•rötf
(
tdb
,"Previous object in objectÜist: OBJ(%s)\n",

520 
obj2
->
«me
);

521 ()
	`°rˇt
(
db_buff
, 
tdb
);

522 ()
	`•rötf
(
tdb
, "posôi⁄ i¿obje˘Üi°:%d\n",
i
);

523 ()
	`°rˇt
(
db_buff
, 
tdb
);

526 
obj_li°
 !(
obj2
 = obj2->
√xt_Æl
));

528 i‡(
¨gv
[0].
u
.
numbî
 == 1)

530 i‡(
¨gv
[1].
ty≥
 !
T_OBJECT
)

532 
ob
 = 
¨gv
[1].
u
.ob;

534 ()
	`•rötf
(
db_buff
,"¥ogømÑef'†%d\n", 
ob
->
¥og
->
ªf
);

535 ()
	`•rötf
(
tdb
,"Namê%s\n", 
ob
->
¥og
->
«me
);

536 ()
	`°rˇt
(
db_buff
, 
tdb
);

537 ()
	`•rötf
(
tdb
,"¥ogøm sizê%d\n", 
ob
->
¥og
->
¥ogøm_size
);

538 ()
	`°rˇt
(
db_buff
, 
tdb
);

539 ()
	`•rötf
(
tdb
, "num func'†%u (%uË\n", 
ob
->
¥og
->
num_fun˘i⁄s


540 ,
ob
->
¥og
->
num_fun˘i⁄s
 * (Ë(
fun˘i⁄
));

541 ()
	`°rˇt
(
db_buff
, 
tdb
);

542 ()
	`•rötf
(
tdb
,"sizeo‡rod©®%d\n", 
ob
->
¥og
->
rod©a_size
);

543 ()
	`°rˇt
(
db_buff
, 
tdb
);

544 ()
	`•rötf
(
tdb
,"num v¨†%u (%u)\n", 
ob
->
¥og
->
num_v¨übÀs


545 ,
ob
->
¥og
->
num_v¨übÀs
 * (Ë(
v¨übÀ
));

546 ()
	`°rˇt
(
db_buff
, 
tdb
);

547 ()
	`•rötf
(
tdb
,"num inhîô†%u (%u)\n", 
ob
->
¥og
->
num_öhîôed


548 ,
ob
->
¥og
->
num_öhîôed
 * (Ë(
öhîô
));

549 ()
	`°rˇt
(
db_buff
, 
tdb
);

550 ()
	`•rötf
(
tdb
,"tŸÆ sizê%d\n", 
ob
->
¥og
->
tŸÆ_size
);

551 ()
	`°rˇt
(
db_buff
, 
tdb
);

555 ()
	`•rötf
(
db_buff
, "BadÇumberárgumentÅo object_info: %d\n",

556 
¨gv
[0].
u
.
numbî
);

558 
ªtvÆ
.
ty≥
 = 
T_STRING
;

559 
ªtvÆ
.
°rög_ty≥
 = 
STRING_MSTRING
;

560 
ªtvÆ
.
u
.
°rög
 = 
	`make_m°rög
(
db_buff
);

561  &
ªtvÆ
;

565 #ifde‡
OPCPROF


566 
	`›cdump
();

567 
ªtvÆ
 = 
c⁄°1
;

568  &
ªtvÆ
;

570 
ªtvÆ
.
ty≥
 = 
T_STRING
;

571 
ªtvÆ
.
°rög_ty≥
 = 
STRING_CSTRING
;

572 
ªtvÆ
.
u
.
°rög
 = "Only valid if GD compiled with OPCPROF flag.\n";

573  &
ªtvÆ
;

578 
tmp
;

580 i‡(
¨gc
 < 3 ||

581 
¨gv
[0].
ty≥
 !
T_STRING
 ||

582 
¨gv
[1].
ty≥
 !
T_NUMBER
 ||

583 
¨gv
[2].
ty≥
 !
T_STRING
)

585 #ifde‡
CATCH_UDP_PORT


586 
tmp
 = 
	`udpsvc_£nd
(
¨gv
[0].
u
.
°rög
,árgv[1].u.
numbî
,árgv[2].u.string);

587 i‡(
tmp
)

588 
ªtvÆ
 = 
c⁄°1
;

591 
ªtvÆ
 = 
c⁄°0
;

592  &
ªtvÆ
;

596 
p‹t_numbî
;

597 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

598 
ªtvÆ
.
u
.
numbî
 = 
p‹t_numbî
;

599  &
ªtvÆ
;

603 #ifde‡
CATCH_UDP_PORT


604 
udp_p‹t
;

605 
ªtvÆ
.
u
.
numbî
 = 
udp_p‹t
;

607 
ªtvÆ
.
u
.
numbî
 = -1;

609 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

610  &
ªtvÆ
;

614 i‡(
¨gc
 && (
¨gv
[0].
ty≥
 =
T_OBJECT
))

616 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

617 
ªtvÆ
.
u
.
numbî
 = 
¨gv
[0].u.
ob
->
Êags
;

618  &
ªtvÆ
;

620 
ªtvÆ
 = 
c⁄°0
;

621  &
ªtvÆ
;

625 
svÆue
 
	`gë_v¨übÀs
(
obje˘
 *);

626 
svÆue
 
	`gë_v¨übÀ
(
obje˘
 *, *);

628 
¨gc
)

631 i‡–
¨gv
[0].
ty≥
 !
T_OBJECT
)

633 
ªtvÆ
 = 
c⁄°0
;

634  &
ªtvÆ
;

636 
ªtvÆ
 = 
	`gë_v¨übÀs
(
¨gv
[0].
u
.
ob
);

637  &
ªtvÆ
;

639 i‡–
¨gv
[0].
ty≥
 !
T_OBJECT
 ||árgv[1].ty≥ !
T_STRING
)

641 
ªtvÆ
 = 
c⁄°0
;

642  &
ªtvÆ
;

644 
ªtvÆ
 = 
	`gë_v¨übÀ
(
¨gv
[0].
u
.
ob
,árgv[1].u.
°rög
);

645  &
ªtvÆ
;

647 i‡–
¨gv
[0].
ty≥
 =
T_OBJECT
 &&árgv[1].ty≥ =
T_STRING
)

649 
ªtvÆ
 = 
	`gë_v¨übÀ
(
¨gv
[0].
u
.
ob
,árgv[1].u.
°rög
);

650  &
ªtvÆ
;

652 i‡–
¨gv
[0].
ty≥
 =
T_OBJECT
)

654 
ªtvÆ
 = 
	`gë_v¨übÀs
(
¨gv
[0].
u
.
ob
);

655  &
ªtvÆ
;

657 
ªtvÆ
 = 
c⁄°0
;

658  &
ªtvÆ
;

660 
ªtvÆ
 = 
c⁄°0
;

661  &
ªtvÆ
;

667 
evÆ_co°
;

668 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

669 
ªtvÆ
.
u
.
numbî
 = 
evÆ_co°
;

670  &
ªtvÆ
;

675 #ifde‡
DEBUG_MALLOC


676 
	`debug_mÆloc
();

678 
ªtvÆ
 = 
c⁄°1
;

679  &
ªtvÆ
;

683 #i‚de‡
PROFILE_FUNS


684 
ªtvÆ
.
ty≥
 = 
T_STRING
;

685 
ªtvÆ
.
°rög_ty≥
 = 
STRING_CSTRING
;

686 
ªtvÆ
.
u
.
°rög
 = "Only valid if GD compiled with PROFILE_FUNS flag.\n";

687  &
ªtvÆ
;

689 i‡(
¨gc
 < 1 || 
¨gv
[0].
ty≥
 !
T_OBJECT
)

691 
ªtvÆ
.
ty≥
 = 
T_POINTER
;

692 
ªtvÆ
.
u
.
vec
 = 
	`Æloˇã_¨øy
(
¨gv
[0].u.
ob
->
¥og
->
num_fun˘i⁄s
);

693 #ifde‡
USE_SWAP


694 
	`ac˚ss_¥ogøm
(
¨gv
[0].
u
.
ob
->
¥og
);

696 
û
 = 0; i»< ()
¨gv
[0].
u
.
ob
->
¥og
->
num_fun˘i⁄s
; il++)

698 
buff
[200];

700 ()
	`•rötf
(
buff
, "%09d:%09ld: %s",

701 
¨gv
[0].
u
.
ob
->
¥og
->
fun˘i⁄s
[
û
].
num_ˇŒs
,

702 
¨gv
[0].
u
.
ob
->
¥og
->
fun˘i⁄s
[
û
].
time_•ít
 / 100,

703 
¨gv
[0].
u
.
ob
->
¥og
->
fun˘i⁄s
[
û
].
«me
);

704 
ªtvÆ
.
u
.
vec
->
ôem
[
û
].
ty≥
 = 
T_STRING
;

705 
ªtvÆ
.
u
.
vec
->
ôem
[
û
].
°rög_ty≥
 = 
STRING_MSTRING
;

706 
ªtvÆ
.
u
.
vec
->
ôem
[
û
].u.
°rög
 = 
	`make_m°rög
(
buff
);

708 #ifde‡
USE_SWAP


709 
	`ac˚ss_¥ogøm
(
cuºít_¥og
);

711  &
ªtvÆ
;

716 
	`gë_m£cs_ª•⁄£
();

717 
m§_poöt
;

718 
sum
, 
num
, 
tmp
;

720 i‡(
m§_poöt
 >=0)

722 
sum
 = 0;

723 
num
 = 0;

724 
û
 = 0; il < 100; il++)

726 i‡((
tmp
 = 
	`gë_m£cs_ª•⁄£
(
û
)) >=0)

728 
sum
 +
tmp
;

729 
num
++;

732 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

733 
ªtvÆ
.
u
.
numbî
 = (
num
 > 0Ë? 
sum
 /Çum : 0;

734  &
ªtvÆ
;

741 
	`de°ru˘_obje˘
(
obje˘
 *);

743 i‡(
¨gc
 && 
¨gv
[0].
ty≥
 =
T_OBJECT
 &&

744 !(
¨gv
[0].
u
.
ob
->
Êags
 & 
O_DESTRUCTED
))

745 
	`de°ru˘_obje˘
(
¨gv
[0].
u
.
ob
);

749 #ifde‡
SUPER_SNOOP


750 
	`upd©e_¢o›_fûe
();

752 
ªtvÆ
.
ty≥
 = 
T_STRING
;

753 
ªtvÆ
.
°rög_ty≥
 = 
STRING_CSTRING
;

754 
ªtvÆ
.
u
.
°rög
 = "Only valid if GD compiled with SUPER_SNOOP flag.\n";

759 
FILE
 *
ufûe
;

760 *
	`mem_v¨übÀs
(
obje˘
 *);

761 
obje˘
 *
ob
, *
nob
;

762 
löe
[255];

764 i‡((
ufûe
 = 
	`f›í
(
DUMP_FILE
, "w")Ë=
NULL
)

766 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

767 
ªtvÆ
.
u
.
numbî
 = -1;

768  &
ªtvÆ
;

771 
ob
 = 
obj_li°
;

774 i‡(
ob
)

776 
	`num_ˇŒ_outs
(
obje˘
 *);

777 
num_co
, 
num_öv
;

778 
obje˘
 *
o
;

780 
num_co
 = 
	`num_ˇŒ_outs
(
ob
);

782 
num_öv
 = 0, 
o
 = 
ob
->
c⁄èös
; o;

783 
num_öv
++, 
o
 = o->
√xt_öv
) ;

785 ()
	`•rötf
(
löe
, "%s %s in %s callouts %d inventory %d\n",

786 
	`mem_v¨übÀs
(
ob
), ob->
«me
,

787 
ob
->
su≥r
 ? ob->su≥r->
«me
 : "(void)",

788 
num_co
, 
num_öv
);

790 i‡(
	`Âuts
(
löe
, 
ufûe
) < 0)

792 ()
	`f˛o£
(
ufûe
);

795 
nob
 = 
ob
->
√xt_Æl
;

797 
obj_li°
 !(
ob
 = 
nob
));

798 ()
	`f˛o£
(
ufûe
);

802 #ifde‡
USE_SWAP


804 
max_sw≠_mem‹y
;

805 
mö_sw≠_mem‹y
;

806 
mö_sw≠_time
;

807 
max_sw≠_time
;

808 
ve˘‹
 *
v
;

810 i‡(!
¨gc
 || 
¨gv
[0].
ty≥
 !
T_POINTER
 ||

811 
¨gv
[0].
u
.
vec
->
size
 != 4)

813 
v
 = 
¨gv
[0].
u
.
vec
;

814 i‡(
v
->
ôem
[0].
ty≥
 !
T_NUMBER
 ||

815 
v
->
ôem
[0].
u
.
numbî
 < 0)

818 i‡(
v
->
ôem
[1].
ty≥
 !
T_NUMBER
 ||

819 
v
->
ôem
[1].
u
.
numbî
 < v->item[0].u.number)

822 i‡(
v
->
ôem
[2].
ty≥
 !
T_NUMBER
 ||

823 
v
->
ôem
[2].
u
.
numbî
 < 0)

826 i‡(
v
->
ôem
[3].
ty≥
 !
T_NUMBER
 ||

827 
v
->
ôem
[3].
u
.
numbî
 < v->item[2].u.number)

829 
mö_sw≠_mem‹y
 = 
v
->
ôem
[0].
u
.
numbî
;

830 
max_sw≠_mem‹y
 = 
v
->
ôem
[1].
u
.
numbî
;

831 
mö_sw≠_time
 = 
v
->
ôem
[2].
u
.
numbî
;

832 
max_sw≠_time
 = 
v
->
ôem
[3].
u
.
numbî
;

833 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

834 
ªtvÆ
.
u
.
numbî
 = 1;

835  &
ªtvÆ
;

838 
ªtvÆ
.
ty≥
 = 
T_STRING
;

839 
ªtvÆ
.
°rög_ty≥
 = 
STRING_CSTRING
;

840 
ªtvÆ
.
u
.
°rög
 = "Only valid if GD compiled with USE_SWAP flag.\n";

841  &
ªtvÆ
;

845 #ifde‡
USE_SWAP


847 i‡(
¨gc
 =0 || (
¨gv
[0].
ty≥
 =
T_NUMBER
 &&árgv[0].
u
.
numbî
 == 0))

849 
max_sw≠_mem‹y
;

850 
mö_sw≠_mem‹y
;

851 
mö_sw≠_time
;

852 
max_sw≠_time
;

853 
ve˘‹
 *
v
;

855 
v
 = 
	`Æloˇã_¨øy
(4);

856 
v
->
ôem
[0].
ty≥
 = 
T_NUMBER
;

857 
v
->
ôem
[0].
u
.
numbî
 = 
mö_sw≠_mem‹y
;

858 
v
->
ôem
[1].
ty≥
 = 
T_NUMBER
;

859 
v
->
ôem
[1].
u
.
numbî
 = 
max_sw≠_mem‹y
;

860 
v
->
ôem
[2].
ty≥
 = 
T_NUMBER
;

861 
v
->
ôem
[2].
u
.
numbî
 = 
mö_sw≠_time
;

862 
v
->
ôem
[3].
ty≥
 = 
T_NUMBER
;

863 
v
->
ôem
[3].
u
.
numbî
 = 
max_sw≠_time
;

865 
ªtvÆ
.
ty≥
 = 
T_POINTER
;

866 
ªtvÆ
.
u
.
vec
 = 
v
;

867  &
ªtvÆ
;

869 i‡(
¨gv
[0].
ty≥
 =
T_NUMBER
)

871 
u£d_mem‹y
;

872 
sw≠_out_obj_£c
, 
sw≠_out_obj_mö
;

873 
sw≠_out_¥og_£c
, 
sw≠_out_¥og_mö
;

874 
sw≠_ö_obj_£c
, 
sw≠_ö_obj_mö
;

875 
sw≠_ö_¥og_£c
, 
sw≠_ö_¥og_mö
;

876 
sw≠_out_obj_hour
, 
sw≠_ö_obj_hour
;

877 
sw≠_out_¥og_hour
, 
sw≠_ö_¥og_hour
;

878 
obje˘
 *
sw≠_ob
;

879 
¥ogøm
 *
sw≠_¥og
;

881 
¨gv
[0].
u
.
numbî
)

885 
ve˘‹
 *
v
, *
v0
;

887 
v
 = 
	`Æloˇã_¨øy
(4);

889 
v0
 = 
	`Æloˇã_¨øy
(3);

890 
v0
->
ôem
[0].
ty≥
 = 
T_NUMBER
;

891 
v0
->
ôem
[0].
u
.
numbî
 = 
sw≠_ö_obj_£c
;

892 
v0
->
ôem
[1].
ty≥
 = 
T_NUMBER
;

893 
v0
->
ôem
[1].
u
.
numbî
 = 
sw≠_ö_obj_mö
;

894 
v0
->
ôem
[2].
ty≥
 = 
T_NUMBER
;

895 
v0
->
ôem
[2].
u
.
numbî
 = 
sw≠_ö_obj_hour
;

896 
v
->
ôem
[0].
ty≥
 = 
T_POINTER
;

897 
v
->
ôem
[0].
u
.
vec
 = 
v0
;

899 
v0
 = 
	`Æloˇã_¨øy
(3);

900 
v0
->
ôem
[0].
ty≥
 = 
T_NUMBER
;

901 
v0
->
ôem
[0].
u
.
numbî
 = 
sw≠_ö_¥og_£c
;

902 
v0
->
ôem
[1].
ty≥
 = 
T_NUMBER
;

903 
v0
->
ôem
[1].
u
.
numbî
 = 
sw≠_ö_¥og_mö
;

904 
v0
->
ôem
[2].
ty≥
 = 
T_NUMBER
;

905 
v0
->
ôem
[2].
u
.
numbî
 = 
sw≠_ö_¥og_hour
;

906 
v
->
ôem
[1].
ty≥
 = 
T_POINTER
;

907 
v
->
ôem
[1].
u
.
vec
 = 
v0
;

909 
v0
 = 
	`Æloˇã_¨øy
(3);

910 
v0
->
ôem
[0].
ty≥
 = 
T_NUMBER
;

911 
v0
->
ôem
[0].
u
.
numbî
 = 
sw≠_out_obj_£c
;

912 
v0
->
ôem
[1].
ty≥
 = 
T_NUMBER
;

913 
v0
->
ôem
[1].
u
.
numbî
 = 
sw≠_out_obj_mö
;

914 
v0
->
ôem
[2].
ty≥
 = 
T_NUMBER
;

915 
v0
->
ôem
[2].
u
.
numbî
 = 
sw≠_out_obj_hour
;

916 
v
->
ôem
[2].
ty≥
 = 
T_POINTER
;

917 
v
->
ôem
[2].
u
.
vec
 = 
v0
;

919 
v0
 = 
	`Æloˇã_¨øy
(3);

920 
v0
->
ôem
[0].
ty≥
 = 
T_NUMBER
;

921 
v0
->
ôem
[0].
u
.
numbî
 = 
sw≠_out_¥og_£c
;

922 
v0
->
ôem
[1].
ty≥
 = 
T_NUMBER
;

923 
v0
->
ôem
[1].
u
.
numbî
 = 
sw≠_out_¥og_mö
;

924 
v0
->
ôem
[2].
ty≥
 = 
T_NUMBER
;

925 
v0
->
ôem
[2].
u
.
numbî
 = 
sw≠_out_¥og_hour
;

926 
v
->
ôem
[3].
ty≥
 = 
T_POINTER
;

927 
v
->
ôem
[3].
u
.
vec
 = 
v0
;

929 
ªtvÆ
.
ty≥
 = 
T_POINTER
;

930 
ªtvÆ
.
u
.
vec
 = 
v
;

931  &
ªtvÆ
;

934 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

935 
ªtvÆ
.
u
.
numbî
 =

936 (
sw≠_¥og
->
time_of_ªf
 < 
sw≠_ob
->time_of_ref ?

937 
sw≠_¥og
->
time_of_ªf
 :

938 
sw≠_¥og
->
time_of_ªf
);

939  &
ªtvÆ
;

941 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

942 
ªtvÆ
.
u
.
numbî
 = 
u£d_mem‹y
;

943  &
ªtvÆ
;

949 
ªtvÆ
.
ty≥
 = 
T_STRING
;

950 
ªtvÆ
.
°rög_ty≥
 = 
STRING_CSTRING
;

951 
ªtvÆ
.
u
.
°rög
 = "Only valid if GD compiled with USE_SWAP flag.\n";

952  &
ªtvÆ
;

954 #ifde‡
FUNCDEBUG


956 
	`dumpfuncs
();

957 
ªtvÆ
 = 
c⁄°0
;

958  &
ªtvÆ
;

961 i‡(
¨gc
 && (
¨gv
[0].
ty≥
 =
T_STRING
))

963 
öhibôˇŒouts
;

964 
ﬁd
;

966 
ﬁd
 = 
öhibôˇŒouts
;

967 i‡(
	`°rcmp
(
¨gv
[0].
u
.
°rög
, "on") == 0)

968 
öhibôˇŒouts
 = 1;

970 
öhibôˇŒouts
 = 0;

971 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

972 
ªtvÆ
.
u
.
numbî
 = 
ﬁd
;

973  &
ªtvÆ
;

977 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

978 
ªtvÆ
.
u
.
numbî
 = -1;

979  &
ªtvÆ
;

982 i‡(
¨gc
 && (
¨gv
[0].
ty≥
 =
T_STRING
))

984 
w¨nobsﬁëeÊag
;

985 
ﬁd
;

987 
ﬁd
 = 
w¨nobsﬁëeÊag
;

988 i‡(
	`°rcmp
(
¨gv
[0].
u
.
°rög
, "on") == 0)

989 
w¨nobsﬁëeÊag
 = 1;

991 
w¨nobsﬁëeÊag
 = 0;

992 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

993 
ªtvÆ
.
u
.
numbî
 = 
ﬁd
;

994  &
ªtvÆ
;

998 
ªtvÆ
.
ty≥
 = 
T_NUMBER
;

999 
ªtvÆ
.
u
.
numbî
 = -1;

1000  &
ªtvÆ
;

1003 #ifde‡
DEBUG


1004 
	`dump_s°rögs
();

1005 
ªtvÆ
 = 
c⁄°0
;

1007 
ªtvÆ
.
ty≥
 = 
T_STRING
;

1008 
ªtvÆ
.
°rög_ty≥
 = 
STRING_CSTRING
;

1009 
ªtvÆ
.
u
.
°rög
 = "Only valid if GD compiled with DEBUG flag.\n";

1011  &
ªtvÆ
;

1013 
ªtvÆ
 = 
c⁄°0
;

1014  &
ªtvÆ
;

1015 
	}
}

1017 #i‡
deföed
(
RUSAGE
Ë&& deföed(
PROFILE_OBJS
)

1018 
ve˘‹
 *

1019 
	$make_˝u_¨øy
(
i
, 
¥ogøm
 *
¥og
[])

1021 
num
;

1022 
ve˘‹
 *
ªt
;

1023 
buff
[1024];

1025 i‡(
i
 <= 0)

1027 
ªt
 = 
	`Æloˇã_¨øy
(
i
);

1029 
num
 = 0;Çum < 
i
;Çum++)

1031 ()
	`•rötf
(
buff
, "%8.8ld:%s", 
¥og
 ?Örog[
num
]->
˝u
 : 0L,

1032 
¥og
 ?Örog[
num
]->
«me
 : "");

1033 
	`‰ì_svÆue
(&
ªt
->
ôem
[
num
]);

1034 
ªt
->
ôem
[
num
].
ty≥
 = 
T_STRING
;

1035 
ªt
->
ôem
[
num
].
°rög_ty≥
 = 
STRING_MSTRING
;

1036 
ªt
->
ôem
[
num
].
u
.
°rög
 = 
	`make_m°rög
(
buff
);

1038  
ªt
;

1039 
	}
}

1042 
svÆue


1043 
	$gë_v¨übÀs
(
obje˘
 *
ob
)

1045 
i
, 
j
;

1046 
ve˘‹
 *
«mes
;

1047 
ve˘‹
 *
vÆues
;

1048 
svÆue
 
ªs
;

1049 
num_v¨
;

1051 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

1052  
c⁄°0
;

1054 #ifde‡
USE_SWAP


1055 
	`ac˚ss_obje˘
(
ob
);

1058 i‡(!
ob
->
v¨übÀs
)

1059  
c⁄°0
;

1061 
num_v¨
 = 
ob
->
¥og
->
num_v¨übÀs
 + ob->¥og->
öhîô
[ob->¥og->
num_öhîôed
 - 1]

1062 .
v¨übÀ_ödex_off£t
;

1064 
«mes
 = 
	`Æloˇã_¨øy
(
num_v¨
);

1065 
vÆues
 = 
	`Æloˇã_¨øy
(
num_v¨
);

1067 
j
 = 
ob
->
¥og
->
num_öhîôed
 - 1; j >= 0; j--)

1068 i‡(!(
ob
->
¥og
->
öhîô
[
j
].
ty≥
 & 
TYPE_MOD_SECOND
) &&

1069 
ob
->
¥og
->
öhîô
[
j
].¥og->
num_v¨übÀs
 > 0)

1071 #ifde‡
USE_SWAP


1072 
	`ac˚ss_¥ogøm
(
ob
->
¥og
->
öhîô
[
j
].prog);

1074 
i
 = 0; i < ()
ob
->
¥og
->
öhîô
[
j
].¥og->
num_v¨übÀs
; i++)

1076 i‡(
num_v¨
 == 0)

1077 
	`îr‹
("WrongÇumber of variables in object.\n");

1078 
«mes
->
ôem
[--
num_v¨
].
ty≥
 = 
T_STRING
;

1079 
«mes
->
ôem
[
num_v¨
].
°rög_ty≥
 = 
STRING_SSTRING
;

1080 
«mes
->
ôem
[
num_v¨
].
u
.
°rög
 =

1081 
	`ª„ªn˚_s°rög
(
ob
->
¥og
->
öhîô
[
j
].prog->

1082 
v¨übÀ_«mes
[
i
].
«me
);

1083 
	`assign_svÆue_no_‰ì
(&
vÆues
->
ôem
[
num_v¨
],

1084 &
ob
->
v¨übÀs
[ob->
¥og
->
öhîô
[
j
]

1085 .
v¨übÀ_ödex_off£t
 + 
i
]);

1088 
ªs
.
ty≥
 = 
T_MAPPING
;

1089 
ªs
.
u
.
m≠
 = 
	`make_m≠pög
(
«mes
, 
vÆues
);

1090 
	`‰ì_ve˘‹
(
«mes
);

1091 
	`‰ì_ve˘‹
(
vÆues
);

1092 #ifde‡
USE_SWAP


1093 
	`ac˚ss_obje˘
(
cuºít_obje˘
);

1094 
	`ac˚ss_¥ogøm
(
cuºít_¥og
);

1096  
ªs
;

1097 
	}
}

1099 
svÆue


1100 
	$gë_v¨übÀ
(
obje˘
 *
ob
, *
v¨_«me
)

1102 
i
;

1103 
svÆue
 
ªs
 = 
c⁄°0
;

1105 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

1106  
ªs
;

1108 #ifde‡
USE_SWAP


1109 
	`ac˚ss_obje˘
(
ob
);

1112 i‡(!
ob
->
v¨übÀs
)

1113  
c⁄°0
;

1115 i‡((
i
 = 
	`föd_°©us
(
ob
->
¥og
, 
v¨_«me
,0)) != -1)

1116 
	`assign_svÆue_no_‰ì
(&
ªs
, &
ob
->
v¨übÀs
[
i
]);

1117 #ifde‡
USE_SWAP


1118 
	`ac˚ss_obje˘
(
cuºít_obje˘
);

1120  
ªs
;

1121 
	}
}

1124 
	gm≠pög_ñem
, 
	g¨øy_ñem
, 
	g°rög_size
, 
	gnum_°rög
;

1125 
	gnum_m≠
, 
	gnum_¨r
, 
	gnum_num
, 
	gnum_ob
, 
	gnum_Êﬂt
, 
	gnum_func
;

1126 
	gfun˘i⁄_size
;

1128 
mem_m≠pög
(
m≠pög
 *);

1129 
mem_¨øy
(
ve˘‹
 *);

1131 
INLINE
 

1132 
	$mem_ö¸
(
svÆue
 *
v¨
)

1134 
v¨
->
ty≥
)

1136 
T_FUNCTION
:

1137 
fun˘i⁄_size
 + (
˛osuª
);

1138 
num_func
++;

1139 i‡(
v¨
->
u
.
func
->
fu«rgs
)

1140 
	`mem_¨øy
(
v¨
->
u
.
func
->
fu«rgs
);

1142 
T_MAPPING
:

1143 
m≠pög_ñem
 +
v¨
->
u
.
m≠
->
size
;

1144 
num_m≠
++;

1145 
	`mem_m≠pög
(
v¨
->
u
.
m≠
);

1147 
T_POINTER
:

1148 
¨øy_ñem
 +
v¨
->
u
.
vec
->
size
;

1149 
num_¨r
++;

1150 
	`mem_¨øy
(
v¨
->
u
.
vec
);

1152 
T_STRING
:

1153 
°rög_size
 +
	`°æí
(
v¨
->
u
.
°rög
);

1154 
num_°rög
++;

1156 
T_OBJECT
:

1158 i‡(
v¨
->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
)

1160 
num_num
++;

1161 
	`‰ì_svÆue
(
v¨
);

1164 
num_ob
++;

1166 
T_FLOAT
:

1167 
num_Êﬂt
++;

1169 
T_NUMBER
:

1170 
num_num
++;

1175 
	}
}

1178 
	$mem_m≠pög
(
m≠pög
 *
m
)

1180 
≠aú
 **
p
;

1181 
i
;

1182 
size
;

1184 i‡(
m
->
size
 < 0)

1186 
size
 = 
m
->size;

1187 
m
->
size
 = -1;

1188 
i
 = 0 ; i < 
size
 ; i++)

1190 
p
 = &
m
->
∑ús
[
i
]; *p; )

1193 i‡((*
p
)->
¨g
.
ty≥
 =
T_OBJECT
 &&

1194 ((*
p
)->
¨g
.
u
.
ob
->
Êags
 & 
O_DESTRUCTED
))

1196 
≠aú
 *
f
;

1198 
f
 = *
p
;

1199 *
p
 = 
f
->
√xt
;

1200 
f
->
√xt
 = 0;

1201 
m
->
ˇrd
 -
	`‰ì_≠aús
(
f
);

1202 
m≠pög_ñem
--;

1206 
	`mem_ö¸
(&(*
p
)->
¨g
);

1207 
	`mem_ö¸
(&(*
p
)->
vÆ
);

1208 
p
 = &(*p)->
√xt
;

1212 
m
->
size
 = size;

1213 
	}
}

1216 
	$mem_¨øy
(
ve˘‹
 *
v
)

1218 
i
;

1219 
size
;

1221 i‡(
v
->
size
 < 0)

1223 
size
 = 
v
->size;

1224 
v
->
size
 = -1;

1225 
i
 = 0; i < 
size
; i++)

1226 
	`mem_ö¸
(&
v
->
ôem
[
i
]);

1227 
v
->
size
 = size;

1228 
	}
}

1231 
	$mem_v¨übÀs
(
obje˘
 *
ob
)

1233 
i
;

1234 
num_v¨
;

1235 
buf
[128];

1236 #ifde‡
USE_SWAP


1237 
was_sw≠≥d
;

1238 
	`sw≠_obje˘
(
obje˘
 *);

1241 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

1244 i‡(
ob
->
Êags
 & 
O_SWAPPED
)

1245 #ifde‡
USE_SWAP


1247 
	`lﬂd_ob_‰om_sw≠
(
ob
);

1248 
was_sw≠≥d
 = 1;

1251 
was_sw≠≥d
 = 0;

1256 i‡(!
ob
->
v¨übÀs
)

1259 
m≠pög_ñem
 = 0;

1260 
¨øy_ñem
 = 0;

1261 
°rög_size
 = 0;

1262 
num_°rög
 = 0;

1263 
num_¨r
 = 0;

1264 
num_m≠
 = 0;

1265 
num_ob
 = 0;

1266 
num_num
 = 0;

1267 
num_Êﬂt
 = 0;

1269 
num_v¨
 = 
ob
->
¥og
->
num_v¨übÀs
 +

1270 
ob
->
¥og
->
öhîô
[ob->¥og->
num_öhîôed
 - 1].
v¨übÀ_ödex_off£t
;

1272 
i
 = -1; i < 
num_v¨
; i++)

1274 
	`mem_ö¸
(&
ob
->
v¨übÀs
[
i
]);

1276 ()
	`•rötf
(
buf
, "A %6d %6d M %6d %6d S %6d %6d O %6d N %6d F %6d",

1277 
num_¨r
, 
¨øy_ñem
, 
num_m≠
, 
m≠pög_ñem
,

1278 
num_°rög
, 
°rög_size
, 
num_ob
, 
num_num
, 
num_Êﬂt
);

1279 #ifde‡
USE_SWAP


1280 i‡(
was_sw≠≥d
)

1281 
	`sw≠_obje˘
(
ob
);

1283  
buf
;

1284 
	}
}

	@debugmalloc.c

1 
	~<°dio.h
>

2 
	~<mem‹y.h
>

3 
	~<machöe/ªg.h
>

4 
	~<°rög.h
>

5 
	~"löt.h
"

8 
	#Áke
(
s
)

	)

10 #i‚de‡
DEBUG_MALLOC


11 
	#smÆloc
 
mÆloc


	)

13 
	#s‰ì
 
‰ì


	)

14 
	#§óŒoc
 
ªÆloc


	)

16 
	#my_mÆloc
 
mÆloc


	)

17 
	#my_ªÆloc
 
ªÆloc


	)

18 
	#my_‰ì
 
‰ì


	)

21 
	#SMALL_BLOCK_MAX_BYTES
 32

	)

22 
	#SMALL_CHUNK_SIZE
 0x4000

	)

23 
	#CHUNK_SIZE
 0x40000

	)

25 
	#SINT
 ()

	)

26 
	#SMALL_BLOCK_MAX
 (
SMALL_BLOCK_MAX_BYTES
/
SINT
)

	)

28 
	#PREV_BLOCK
 0x80000000

	)

29 
	#THIS_BLOCK
 0x40000000

	)

30 
	#USED_BLOCK
 0x20000000

	)

31 
	#MARKED_BLOCK
 0x10000000

	)

32 
	#MASK
 0x0FFFFFFF

	)

34 
	#MAGIC
 0x17952932

	)

38 
	tu
;

40 
u
 *
	gsÊèbÀ
[
SMALL_BLOCK_MAX
];

41 
u
 *
	g√xt_unu£d
;

42 
u
 
	gunu£d_size
;

46 
u
 *
	g‰ì_li°
;

47 
u
 *
	g°¨t_√xt_block
;

51 
	gsmÆl_cou¡
[
SMALL_BLOCK_MAX
];

52 
	gsmÆl_tŸÆ
[
SMALL_BLOCK_MAX
];

53 
	gsmÆl_max
[
SMALL_BLOCK_MAX
];

54 
	gsmÆl_‰ì
[
SMALL_BLOCK_MAX
];

56 °ru˘ { 
	mcou¡î
, 
	msize
; } 
	t°©
;

57 
	#cou¡
(
a
,
b
Ë{á.
size
+=(b); i‡((b)<0Ë--a.
cou¡î
; ++a.cou¡î; }

	)

59 
	gdebugmÆloc
;

65 *
œrge_mÆloc
();

66 
œrge_‰ì
();

68 
	#s_size_±r
(
p
Ë’)

	)

69 
	#s_√xt_±r
(
p
Ë((
u
 **Ë’+1))

	)

71 
°©
 
	gsmÆl_Æloc_°©
;

72 
°©
 
	gsmÆl_‰ì_°©
;

73 
°©
 
	gsmÆl_chunk_°©
;

76 
	$smÆloc
(
u
 
size
)

78 
i
;

79 
u
 *
ãmp
;

81 i‡(
size
 == 0)

82 
	`Áèl
("Malloc size 0.\n");

83 i‡(
size
>
SMALL_BLOCK_MAX_BYTES
)

84  
	`œrge_mÆloc
(
size
,0);

86 
i
 = (
size
 - 1) >> 2;

87 
size
 = 
i
+2;

88 
	`cou¡
(
smÆl_Æloc_°©
,
size
 << 2);

90 
smÆl_cou¡
[
i
] += 1;

91 
smÆl_tŸÆ
[
i
] += 1;

92 i‡(
smÆl_cou¡
[
i
] >
smÆl_max
[i])

93 
smÆl_max
[
i
] = 
smÆl_cou¡
[i];

95 i‡(
sÊèbÀ
[
i
])

97 
	`cou¡
(
smÆl_‰ì_°©
, -(Ë(
size
 << 2));

98 
ãmp
 = 
sÊèbÀ
[
i
];

99 
sÊèbÀ
[
i
] = * (
u
 **Ë(
ãmp
+1);

100 
	`Áke
("From freeÜist.");

101  (*Ë(
ãmp
+1);

104 i‡(
unu£d_size
<
size
)

106 i‡(
unu£d_size
 >= 2)

109 
i
 = 
unu£d_size
 - 2;

110 
	`cou¡
(
smÆl_‰ì_°©
, 
unu£d_size
 << 2);

111 
smÆl_tŸÆ
[
i
]++;

112 
smÆl_‰ì
[
i
]++;

113 
smÆl_cou¡
[
i
]++;

114 i‡(
smÆl_cou¡
[
i
] >
smÆl_max
[i])

115 
smÆl_max
[
i
] = 
smÆl_cou¡
[i];

116 *
	`s_size_±r
(
√xt_unu£d
Ë
unu£d_size
;

117 *
	`s_√xt_±r
(
√xt_unu£d
Ë
sÊèbÀ
[
i
];

118 
sÊèbÀ
[
i
] = 
√xt_unu£d
;

122 
√xt_unu£d
 = (
u
 *Ë
	`œrge_mÆloc
(
SMALL_CHUNK_SIZE
,1);

123 i‡(
√xt_unu£d
 == 0)

125 
	`cou¡
(
smÆl_chunk_°©
, 
SMALL_CHUNK_SIZE
+
SINT
);

126 
unu£d_size
 = 
SMALL_CHUNK_SIZE
 / 
SINT
;

128 
	`Áke
("Allocated from chunk.");

131 
ãmp
 = (
u
 *Ë
	`s_√xt_±r
(
√xt_unu£d
);

133 *
	`s_size_±r
(
√xt_unu£d
Ë
size
;

134 
√xt_unu£d
 +
size
;

135 
unu£d_size
 -
size
;

137  (*Ë
ãmp
;

138 
	}
}

140 *
	gdebug_‰ì_±r
;

143 
	$s‰ì
(*
±r
)

145 
u
 *
block
;

146 
u
 
i
;

148 
debug_‰ì_±r
 = 
±r
;

149 
block
 = (
u
 *Ë
±r
;

150 
block
 -= 1;

151 i‡((*
	`s_size_±r
(
block
Ë& 
MASK
Ë> 
SMALL_BLOCK_MAX
 + 1)

152 { 
	`œrge_‰ì
(
±r
); ; }

154 
i
 = *
block
 - 2;

155 
	`cou¡
(
smÆl_Æloc_°©
, - (Ë((
i
+2) << 2));

156 
	`cou¡
(
smÆl_‰ì_°©
, (
i
+2) << 2);

157 *
	`s_√xt_±r
(
block
Ë
sÊèbÀ
[
i
];

158 
sÊèbÀ
[
i
] = 
block
;

159 
smÆl_‰ì
[
i
] += 1;

160 
	`Áke
("Freed");

161 
	}
}

167 
	#BEST_FIT
 0

	)

168 
	#FIRST_FIT
 1

	)

169 
	#HYBRID
 2

	)

170 
	gfô_°yÀ
 =
BEST_FIT
;

172 
	#l_size_±r
(
p
Ë’)

	)

173 
	#l_√xt_±r
(
p
Ë(*((
u
 **Ë’+1)))

	)

174 
	#l_¥ev_±r
(
p
Ë(*((
u
 **Ë’+2)))

	)

175 
	#l_√xt_block
(
p
Ë’ + (*’)))

	)

176 
	#l_¥ev_block
(
p
Ë’ - (*’-1)))

	)

177 
	#l_¥ev_‰ì
(
p
Ë(!(*∞& 
PREV_BLOCK
))

	)

178 
	#l_√xt_‰ì
(
p
Ë(!(*
	`l_√xt_block
’Ë& 
THIS_BLOCK
))

	)

180 
	$show_block
(
±r
)

181 
u
 *
±r
;

183 ()
	`¥ötf
("[%c%d: %d] ",(*
±r
 & 
THIS_BLOCK
 ? '+' : '-'),

184 (Ë
±r
, *±∏& 
MASK
);

185 
	}
}

188 
	$show_‰ì_li°
()

190 
u
 *
p
;

191 
p
 = 
‰ì_li°
;

192 
p
) {

193 
	`show_block
(
p
);

194 
p
 = 
	`l_√xt_±r
(p);

196 ()
	`¥ötf
("\n");

197 
	}
}

199 
°©
 
	gœrge_‰ì_°©
;

201 
	$ªmove_‰om_‰ì_li°
(
u
 
±r
)

203 
	`cou¡
(
œrge_‰ì_°©
, - (Ë(*
±r
 & 
MASK
) << 2);

205 i‡(
	`l_¥ev_±r
(
±r
))

206 
	`l_√xt_±r
(
	`l_¥ev_±r
(
±r
)) =Ü_next_ptr(ptr);

208 
‰ì_li°
 = 
	`l_√xt_±r
(
±r
);

210 i‡(
	`l_√xt_±r
(
±r
))

211 
	`l_¥ev_±r
(
	`l_√xt_±r
(
±r
)) =Ü_prev_ptr(ptr);

212 
	}
}

213 
u
 *
	gœ°_block
 = 0;

214 
u
 *
	gfú°_block
 = 0;

217 
	$add_to_‰ì_li°
(
u
 *
±r
)

219 
	`puts
();

220 
	`cou¡
(
œrge_‰ì_°©
, (*
±r
 & 
MASK
) << 2);

221 i‡((
u
)
±r
 > (u)
œ°_block
)Üast_block =Ötr;

222 i‡(!
fú°_block
Ëfú°_block = 
±r
;

224 i‡(
‰ì_li°
 && 
	`l_¥ev_±r
(free_list))

225 
	`puts
("FreeÜist consistencyÉrror.");

227 
	`l_√xt_±r
(
±r
Ë
‰ì_li°
;

228 i‡(
‰ì_li°
)

229 
	`l_¥ev_±r
(
‰ì_li°
Ë
±r
;

230 
	`l_¥ev_±r
(
±r
) = 0;

231 
‰ì_li°
 = 
±r
;

232 
	}
}

235 
	$buûd_block
(
u
 *
±r
, u 
size
)

237 *(
±r
Ë(*±∏& 
PREV_BLOCK
Ë| 
size
;

238 *(
±r
+
size
-1) = size;

239 *(
±r
+
size
Ë&(
MASK
 | 
THIS_BLOCK
);

240 
	}
}

243 
	$m¨k_block
(
u
 *
±r
)

245 *
	`l_√xt_block
(
±r
Ë|
PREV_BLOCK
;

246 *
±r
 |
THIS_BLOCK
;

247 
	}
}

253 
°©
 
	gsbrk_°©
;

254 *
	gcuºít_bªak
;

256 
	$esbrk
(
u
 
size
)

258 *
	`sbrk
();

259 
	`brk
();

261 i‡(
cuºít_bªak
 == 0)

262 
cuºít_bªak
 = 
	`sbrk
(0);

263 i‡(
	`brk
(
cuºít_bªak
 + 
size
) == -1)

265 
	`cou¡
(
sbrk_°©
,
size
);

266 
cuºít_bªak
 +
size
;

267  
cuºít_bªak
 - 
size
;

268 
	}
}

270 
°©
 
	gœrge_Æloc_°©
;

272 
	$œrge_mÆloc
(
u
 
size
, 
f‹˚_m‹e
)

274 
u
 
be°_size
, 
ªÆ_size
;

275 
u
 *
fú°
, *
be°
, *
±r
;

277 
size
 = (size + 7) >> 2;

279 
fú°
 = 
be°
 = 0;

280 
be°_size
 = 
MASK
;

282 i‡(
f‹˚_m‹e
)

283 
±r
 = 0;

285 
±r
 = 
‰ì_li°
;

287 
±r
) {

288 
u
 
ãmpsize
;

290 
ãmpsize
 = *
±r
 & 
MASK
;

291 i‡(
ãmpsize
 =
size
) {

292 
be°
 = 
fú°
 = 
±r
;

297 i‡(
ãmpsize
 > 
size
)

300 i‡(!
fú°
)

302 
fú°
 = 
±r
;

303 i‡(
fô_°yÀ
 =
FIRST_FIT
)

307 
ãmpsize
 -
size
;

308 i‡(
ãmpsize
>0 &&Åempsize<=
be°_size
)

310 
be°
 = 
±r
;

311 
be°_size
 = 
ãmpsize
;

314 
±r
 = 
	`l_√xt_±r
(ptr);

317 i‡(
fô_°yÀ
==
BEST_FIT
Ë
±r
 = 
be°
;

318 
±r
 = 
fú°
;

320 i‡(!
±r
)

322 
u
 
chunk_size
, 
block_size
;

323 
block_size
 = 
size
*
SINT
;

324 i‡(
f‹˚_m‹e
 || (
block_size
>
CHUNK_SIZE
))

325 
chunk_size
 = 
block_size
;

327 
chunk_size
 = 
CHUNK_SIZE
;

329 i‡(!
°¨t_√xt_block
) {

330 
°¨t_√xt_block
 = (
u
 *Ë
	`esbrk
(
SINT
);

331 i‡(!
°¨t_√xt_block
)

333 *(
°¨t_√xt_block
Ë
PREV_BLOCK
;

334 
	`Áke
("AllocatedÜittle fake block");

337 
±r
 = (
u
 *Ë
	`esbrk
(
chunk_size
);

338 i‡(
±r
 == 0)

340 
±r
 -= 1;

341 
block_size
 = 
chunk_size
 / 
SINT
;

345 
	`buûd_block
(
±r
,
block_size
);

346 i‡(
f‹˚_m‹e
)

347 
	`Áke
("BuildÜittle block");

349 
	`Áke
("Built memory block description.");

350 *
	`l_√xt_block
(
±r
)=
THIS_BLOCK
;

351 
	`add_to_‰ì_li°
(
±r
);

353 
	`ªmove_‰om_‰ì_li°
(
±r
);

354 
ªÆ_size
 = *
±r
 & 
MASK
;

356 i‡(
ªÆ_size
 - 
size
 > 
SMALL_BLOCK_MAX
) {

358 
	`buûd_block
(
±r
+
size
, 
ªÆ_size
-size);

359 
	`Áke
("BuiltÉmpty block");

360 
	`add_to_‰ì_li°
(
±r
+
size
);

361 
	`buûd_block
(
±r
, 
size
);

362 
ªÆ_size
 = 
size
;

364 
	`cou¡
(
œrge_Æloc_°©
, 
ªÆ_size
 << 2);

366 
	`m¨k_block
(
±r
);

367 
	`Áke
("builtállocated block");

368  (*Ë(
±r
 + 1);

369 
	}
}

372 
	$œrge_‰ì
(*
±r
)

374 
u
 
size
, *
p
;

375 
p
 = (
u
 *Ë
±r
;

376 
p
-=1;

377 
size
 = *
p
 & 
MASK
;

378 
	`cou¡
(
œrge_Æloc_°©
, - (Ë(
size
 << 2));

380 i‡(
	`l_√xt_‰ì
(
p
)) {

381 
	`ªmove_‰om_‰ì_li°
(
	`l_√xt_block
(
p
));

382 
size
 +(*
	`l_√xt_block
(
p
Ë& 
MASK
);

383 *
p
 = (*∞& 
PREV_BLOCK
Ë| 
size
;

386 i‡(
	`l_¥ev_‰ì
(
p
)) {

387 
	`ªmove_‰om_‰ì_li°
(
	`l_¥ev_block
(
p
));

388 
size
 +(*
	`l_¥ev_block
(
p
Ë& 
MASK
);

389 
p
 = 
	`l_¥ev_block
(p);

392 
	`buûd_block
(
p
, 
size
);

394 
	`add_to_‰ì_li°
(
p
);

395 
	}
}

398 
	$§óŒoc
(*
p
, 
u
 
size
)

400 *
q
, 
ﬁd_size
;

401 *
t
;

403 
q
 = (*Ë
p
;

404 --
q
;

405 
ﬁd_size
 = ((*
q
 & 
MASK
)-1)*();

406 i‡(
ﬁd_size
 >
size
)

407  
p
;

409 
t
 = 
	`mÆloc
(
size
);

410 i‡(
t
 == 0)  (*) 0;

412 ()
	`mem˝y
(
t
, 
p
, 
ﬁd_size
);

413 
	`‰ì
(
p
);

414  
t
;

415 
	}
}

417 
	#dump_°©
(
°r
Ë()
	`°rˇt
(
mbuf
, så)

	)

418 
	#dump_°©1
(
°r
,
p
Ë()
	`•rötf
(
smbuf
,°r,p); ()
	`°rˇt
(
mbuf
, smbuf)

	)

419 
	#dump_°©2
(
°r
,
°©
Ë()
	`•rötf
(
smbuf
,°r,°©.
cou¡î
,°©.
size
); ()
	`°rˇt
(
mbuf
,smbuf)

	)

421 
	$dump_mÆloc_d©a
()

423 
mbuf
[1024];

424 
smbuf
[100];

426 ()
	`°r˝y
(
mbuf
,"Type Count Space (bytes)\n");

427 
	`dump_°©2
("sbrkÑeque°s: %8d %10d (a)\n",
sbrk_°©
);

428 
	`dump_°©2
("œrgêblocks: %8d %10d (b)\n",
œrge_Æloc_°©
);

429 
	`dump_°©2
("œrgê‰ì blocks: %8d %10d (c)\n\n",
œrge_‰ì_°©
);

430 
	`dump_°©2
("smÆ»chunks: %8d %10d (d)\n",
smÆl_chunk_°©
);

431 
	`dump_°©2
("smÆ»blocks: %8d %10d (e)\n",
smÆl_Æloc_°©
);

432 
	`dump_°©2
("smÆ»‰ì blocks: %8d %10d (f)\n",
smÆl_‰ì_°©
);

434 
	`dump_°©1
("unu£d from cuºíàchunk %10d (g)\n\n",
unu£d_size
<<2);

435 
	`dump_°©
(" Small blocksáre stored in small chunks, whicháreállocatedás\n");

436 
	`dump_°©
("large blocks. Therefore,ÅheÅotalÜarge blocksállocated (b)Ölus\n");

437 
	`dump_°©
("theÜarge free blocks (c) shouldÉqualÅotal storage from sbrk (a).\n");

438 
	`dump_°©
("Similarly, (e) + (f) + (g)Équals (d). TheÅotalámount of storage\n");

439 
	`dump_°©
("wasted is (c) + (f) + (g);Åheámountállocated is (b) - (f) - (g).\n");

440  
mbuf
;

441 
	}
}

447 
	$ˇŒoc
(
√Àm
, 
sizñ
)

449 *
p
;

451 i‡(
√Àm
 =0 || 
sizñ
 == 0)

453 
p
 = 
	`mÆloc
(
√Àm
 * 
sizñ
);

454 i‡(
p
 == 0)

456 ()
	`mem£t
(
p
, '\0', 
√Àm
 * 
sizñ
);

457  
p
;

458 
	}
}

466 
	gdebugmÆloc
;

471 
	$vîify_sÊèbÀ
()

473 
u
 *
p
;

474 
i
, 
j
;

475 
íd
;

477 i‡(!
debugmÆloc
)

479 i‡(
unu£d_size
 > 
SMALL_CHUNK_SIZE
 / 
SINT
)

480 
	`≠a
();

481 
i
=0; i < 
SMALL_BLOCK_MAX
; i++) {

482 
j
=0, 
p
 = 
sÊèbÀ
[
i
];Ö;Ö = * (
u
 **) (p + 1), j++) {

483 i‡(
p
 < (
u
 *)&
íd
 ||Ö > (u *) 0xfffff)

484 
	`≠a
();

485 i‡(*
p
 - 2 !
i
)

486 
	`≠a
();

488 i‡(
p
 >
√xt_unu£d
 &&Ö <Çext_unu£d + 
unu£d_size
)

489 
	`≠a
();

491 
p
 = 
‰ì_li°
;

492 
p
) {

493 i‡(
p
 >
√xt_unu£d
 &&Ö <Çext_unu£d + 
unu£d_size
)

494 
	`≠a
();

495 
p
 = 
	`l_√xt_±r
(p);

497 
	}
}

499 
	$vîify_‰ì
(
±r
)

500 
u
 *
±r
;

502 
u
 *
p
;

503 
i
, 
j
;

505 i‡(!
debugmÆloc
)

507 
i
=0; i < 
SMALL_BLOCK_MAX
; i++) {

508 
j
=0, 
p
 = 
sÊèbÀ
[
i
];Ö;Ö = * (
u
 **) (p + 1), j++) {

509 i‡(*
p
 - 2 !
i
)

510 
	`≠a
();

511 i‡(
±r
 >
p
 &&Ötr <Ö + *p)

512 
	`≠a
();

513 i‡(
p
 >
±r
 &&Ö <Ötr + *ptr)

514 
	`≠a
();

515 i‡(
p
 >
√xt_unu£d
 &&Ö <Çext_unu£d + 
unu£d_size
)

516 
	`≠a
();

520 
p
 = 
‰ì_li°
;

521 
p
) {

522 i‡(
±r
 >
p
 &&Öå <Ö + (*∞& 
MASK
))

523 
	`≠a
();

524 i‡(
p
 >
±r
 &&Ö <Öå + (*±∏& 
MASK
))

525 
	`≠a
();

526 i‡(
p
 >
√xt_unu£d
 &&Ö <Çext_unu£d + 
unu£d_size
)

527 
	`≠a
();

528 
p
 = 
	`l_√xt_±r
(p);

530 i‡(
±r
 >
√xt_unu£d
 &&Öå <Çext_unu£d + 
unu£d_size
)

531 
	`≠a
();

532 
	}
}

534 
	$≠a
() {

535 
i
;

536 
i
/0;

537 
	}
}

539 *
	gªf
;

540 
	$ã°_mÆloc
(
p
)

541 *
p
;

543 i‡(
p
 =
ªf
)

544 ()
	`¥ötf
("Found 0x%x\n", 
p
);

545 
	}
}

550 #i‡
DEBUG_MALLOC


551 
	gunm¨ked_blocks
;

552 
	gnum_blocks
;

553 
	gu£d_blocks
;

554 
	gÆloc_blocks
;

556 
	$m¨k_u£d
(
±r
)

557 
u
 *
±r
;

559 
u
 *
block
 = 
fú°_block
;

560 *
˝å
 = (*)
±r
;

562 
i
;

564 i‡–(()
±r
 & 1) ||

565 (
u
)
±r
 <(u)
fú°_block
 ||

566 (
u
)
±r
 >(u)
œ°_block
 + (*œ°_block & 
MASK
) )

569 
±r
 > 
block
 + (*block & 
MASK
))

570 
block
 +*block & 
MASK
;

572 i‡(
±r
 !
block
 + block[1] + 1 &&

573 (
˝å
 - (*) - ()) !=

574 
block
 + block[1] + 1) ;

576 i‡–*
block
 & 
USED_BLOCK
) ;

577 *
block
 |
USED_BLOCK
;

578 
u£d_blocks
++;

579 
unm¨ked_blocks
++;

580 
	}
}

582 
	$m¨k_blocks
()

584 
u
 *
block
;

586 
u
 
i
;

587 
block
 = 
fú°_block
; block <
œ°_block
; block +(*block & 
MASK
))

588 i‡((*
block
 & (
USED_BLOCK
 | 
MARKED_BLOCK
)) == USED_BLOCK)

590 *
block
 |
MARKED_BLOCK
;

591 
unm¨ked_blocks
--;

592 
i
 = 
block
[1] + 1; i < (*block & 
MASK
); i++)

593 
	`m¨k_u£d
(
block
[
i
]);

595 
	}
}

597 
	$¥ï¨e
()

599 
u
 *
block
;

600 
num_blocks
 = 0;

601 
u£d_blocks
 = 0;

602 
unm¨ked_blocks
 = 0;

603 
Æloc_blocks
 = 0;

605 
block
 = 
fú°_block
; (
u
)block <(u)
œ°_block
 ; block +*block & 
MASK
)

607 
num_blocks
++;

608 i‡(*
block
 & 
THIS_BLOCK
)

610 
Æloc_blocks
++;

611 *
block
 &~(
USED_BLOCK
 | 
MARKED_BLOCK
);

614 *
block
 |
USED_BLOCK
 | 
MARKED_BLOCK
;

616 
	}
}

618 
	gc•
;

619 
	gt•
;

621 
	$gë_•
()

623 
rwödow
 *
•
 
	`asm
("%sp");

624 
rwödow
 *
Â
 
	`asm
("%fp");

625 
rwödow
* 
l•
 = 
•
;

626 
rwödow
* 
lÂ
 = 
Â
;

628 
	`asm
("ta 3");

629 
lÂ
 = 
Â
;ÜÂ->
rw_Â
;ÜÂ = (
rwödow
 *)lfp->rw_fp);

630 
t•
 = ()
lÂ
;

631 
c•
 = ()
Â
;

632 
	}
}

634 
	$m¨k_d©a
()

636 
u
 *
i
;

637 
ívú⁄
, 
íd
;

640 
i
 = &
ívú⁄
; i < &
íd
; i++)

641 
	`m¨k_u£d
(*
i
);

643 
	`gë_•
();

644 
i
 = (*)
c•
; i < (*)
t•
; i++)

645 
	`m¨k_u£d
(*
i
);

647 
unm¨ked_blocks
)

649 
	`m¨k_blocks
();

652 
	}
}

654 
	$found_Àak
(
block
)

655 *
block
;

657 
buff
[2048];

658 
i
;

660 ()
	`•rötf
(
buff
,"block %#x sizê%#x backåa˚", 
block
,

661 ((
block
[-1] & 
MASK
) - 1 - block[0]) * ());

662 ()
	`wrôe
(1,
buff
,
	`°æí
(buff));

663 
i
 = 1; i < 
block
[0] - 1; i++)

665 ()
	`•rötf
(
buff
," %#x",
block
[
i
]);

666 ()
	`wrôe
(1,
buff
,
	`°æí
(buff));

668 ()
	`wrôe
(1,"Énd backtrace\n",15);

669 
	}
}

671 
	$ª˛aim
()

673 
u
 *
block
;

674 
block
 = 
fú°_block
; (
u
)block <(u)
œ°_block
; block +*block & 
MASK
)

675 i‡(!(*
block
 & 
USED_BLOCK
))

676 
	`found_Àak
(
block
 + 1);

677 
	}
}

679 *
	$backåack
()

681 
rwödow
 *
Â
 
	`asm
("%fp");

682 
rwödow
 *
lÂ
 = 
Â
;

683 
buff
[1024], 
i
 = 1;

685 
	`asm
("ta 3");

686 
lÂ
 = 
Â
;ÜÂ->
rw_Â
;ÜÂ = (
rwödow
 *)lfp->rw_fp)

688 
buff
[
i
++] = 
lÂ
->
rw_πn
;

690 
buff
[
i
++] = 0;

691 
buff
[
i
] = i + 1;

692 
buff
[0] = 
i
 + 1;

693  
buff
;

694 
	}
}

696 *
	$my_mÆloc
(
size
)

697 
size
;

699 *
bt
 = 
	`backåack
();

700 *
block
;

701 
nsize
 = 
size
 + 
bt
[0] * ();

703 i‡(
nsize
 < 32)

704 
nsize
 = 32;

705 
block
 = 
	`œrge_mÆloc
(
nsize
);

706 i‡(
block
 =
NULL
)  block;

708 #i‡
	`deföed
(
sun
Ë&& !deföed(
SOLARIS
)

709 
	`bc›y
(
bt
, 
block
, () * bt[0]);

711 
	`memmove
(
block
, 
bt
, () * bt[0]);

713  
block
 + 
bt
[0] * ();

714 
	}
}

716 
	$my_‰ì
(
±r
)

717 *
±r
;

719 *
u±r
 = (*)
±r
;

720 
	`œrge_‰ì
(
u±r
 - uptr[-1]);

721 
	}
}

723 *
	$my_ªÆloc
(
±r
,
size
)

724 *
±r
;

725 
size
;

727 *
u±r
 = (*)
±r
;

728 *
bt
;

729 *
block
;

730 
nsize
;

731 
osize
 = ((
u±r
[u±r[-1] - 1] & 
MASK
) - 1) * ();

732 
osize2
 = 
osize
 - 
±r
[-1] * ();

734 
bt
 = 
	`backåack
();

735 
nsize
 = 
size
 + 
bt
[0] * ();

736 i‡(
nsize
 < 32)

737 
nsize
 = 32;

739 
block
 = 
	`œrge_mÆloc
(
nsize
);

740 i‡(
block
 =
NULL
)  block;

742 #i‡
	`deföed
(
sun
Ë&& !deföed(
SOLARIS
)

743 
	`bc›y
(
bt
, 
block
, () * bt[0]);

744 
	`bc›y
(
±r
, 
block
 + 
bt
[0] * (),

745 
size
 < 
osize2
 ? size : osize2);

747 
	`memmove
(
block
, 
bt
, () * bt[0]);

748 
	`memmove
(
block
 + 
bt
[0] * (), 
±r
, 
size
 < 
osize2
 ? size : osize2);

750 
	`œrge_‰ì
(
u±r
 - uptr[-1]);

751  
block
 + 
bt
[0] * ();

752 
	}
}

754 
	$debug_mÆloc
()

756 
	`¥ï¨e
();

757 
	`m¨k_d©a
();

758 
	`ª˛aim
();

759 
	}
}

	@dmalloc.c

2 
	$dump_mÆloc_d©a
()

5 
	}
}

	@doc/function_references/for_each.c

9 
	$f‹_óch
(
mixed
 
ñemíts
, 
fun˘i⁄
 
m≠func
)

11 
i
;

13 
¨r
=
ñemíts
;

14 i‡(
	`m≠pögp
(
ñemíts
))

15 
ñemíts
 = 
	`m_vÆues
(elements);

16 
i
=0;i<(
¨r
);i++)

17 
	`m≠func
(
ñemíts
[
i
]);

18 
	}
}

	@doc/function_references/funtest.c

5 
	göhîô
 "/std/object";

8 
	$¸óã_obje˘
()

10 
	`£t_«me
("funtest");

11 
	`£t_≤ame
("funtest");

12 
	`£t_sh‹t
("funtest");

13 
	`£t_psh‹t
("funtest");

14 
	`£t_l⁄g
("test object, don't use it\n");

15 
	}
}

18 
	$afun
(
i
, 
j
)

20 
	`wrôe
("ˇŒedáfu¿"); wrôe(
i
); write("\n");

21  123+
i
+10*
j
;

22 
	}
}

24 
	$squ¨e
(
x
Ë{  x*x; 
	}
}

26 
	$cube
(
x
Ë{  x*x*x; 
	}
}

28 
	$baz
()

30 
fun˘i⁄
 *
fu«º
;

31 
fun˘i⁄
 
c_‹_s
;

33 
fu«º
 = ({ 
squ¨e
, 
cube
 });

34 
c_‹_s
 = 
fu«º
[1];

35 
	`wrôe
(
	`c_‹_s
(3));

36 
	}
}

38 
mixed


39 
	$compo£_utû
(
fun˘i⁄
 
f
, fun˘i⁄ 
g
, 
mixed
 
x
)

41  
	`f
(
	`g
(
x
));

42 
	}
}

44 
fun˘i⁄


45 
	$compo£
(
fun˘i⁄
 
f
, fun˘i⁄ 
g
)

47  &
compo£_utû
{
f
,
g
};

48 
	}
}

50 
fun˘i⁄
 
	gglobf
;

52 
	$œrm
(
°rög
 
s1
, såög 
s2
, såög 
s3
)

54 
	`wrôe
("œrm "+
s1
+
s2
+
s3
+"\n");

55 
	}
}

58 
	$fu¡e°
(
°rög
 
°r
)

60 
fun˘i⁄
 
f
, 
g
;

61 
i
;

62 
°rög
 
s
;

63 
obje˘
 
ob
;

64 
fun˘i⁄
 
h
;

66 
i
 = ()
	`globf
(15);

67 
	`wrôe
(
i
); write("\n");

69 
h
 = 
	`compo£
(
squ¨e
, 
cube
);

70 
	`wrôe
(
	`h
(2)); write("\n");

72 
f
 = 
	`this_∂ayî
()->
quîy_«me
;

73 
	`wrôe
(
	`f
() + "\n");

74 
f
 = 
˘ime
;

75 
s
 = (
°rög
)
	`f
(100000);

76 
	`wrôe
(
s
+"\n");

77 
f
 = 
©oi
;

78 
i
 = ()
	`f
("1234");

79 
	`wrôe
(
i
); write("\n");

80 
f
 = 
afun
;

81 
g
 = &
f
{10};

82 
i
 = ()
	`f
(1,1000);

83 
	`wrôe
("ã°ô: "+
°r
+" f(...)=");wrôe(
i
);write("\n");

84 
i
 = ()
	`g
(10000);

85 
	`wrôe
("ã°ô: "+
°r
+" g(...)=");wrôe(
i
);write("\n");

86 
f
 = &
g
{100000};

87 
i
 = ()
	`f
();

88 
	`wrôe
("ã°ô: "+
°r
+" f(...)=");wrôe(
i
);write("\n");

89 
	`f
(88);

90 i‡(
	`fun˘i⁄p
(
afun
)Ë
	`wrôe
("ok1\n");

91 i‡(
	`fun˘i⁄p
(
f
)Ë
	`wrôe
("ok2\n");

92 i‡(
	`fun˘i⁄p
(
i
)Ë
	`wrôe
("bad1\n");

93 
f
 = 
squ¨e
;

94 
	`wrôe
(
	`f
(5)); write("\n");

95 
	`baz
(); 
	`wrôe
("\n");

96 
h
 = 
	`compo£
(
squ¨e
, 
cube
);

97 
	`wrôe
(
	`h
(2)); write("\n");

99 
i
 = 
	`£t_Æ¨m
(2.0, 0.0, &
œrm
{"arg1","arg2"}, "arg3");

100 
s
 = 
	`•rötf
("L¨m id=%d\n", 
i
);

101 
	`wrôe
(
s
);

103 
	}
}

106 
	$©e°
(
°rög
 
°r
)

108 
i
;

109 *
a
, *
b
;

110 
a
 = ({ 1, 2 });

111 
b
 = ({ 3, 4 });

112 
i
 = 0;

113 
i
 = 
b
[
a
[i]];

114 
	`wrôe
(
i
); write("\n");

116 
	}
}

119 
fun˘i⁄
 
	gglobg
;

122 
	$Àvñ
()

124 
	`wrôe
(
	`•rötf
("Àvñ=%d\n", 
	`globg
()));

126 
	}
}

129 
	$ôe°1
(
°rög
 
öp
, såög 
s
)

131 
	`wrôe
(
s
+
öp
+"\n");

132 
	}
}

135 
	$ôe°
()

137 
	`wrôe
("say something");

138 
	`öput_to
(&
ôe°1
{"yes"});

140 
	}
}

143 
	$d⁄e
(
°rög
 
s
)

145 
	`wrôe
(
s
+" done\n");

146 
	}
}

150 
	$d€d
()

152 
	`ed
("foo", &
d⁄e
{"it's"});

154 
	}
}

157 
	$öô
()

159 
globf
 = 
squ¨e
;

160 
globg
 = 
	`this_∂ayî
()->
quîy_wiz_Àvñ
;

161 
	`add_a˘i⁄
(
fu¡e°
, "funtest", 0);

162 
	`add_a˘i⁄
(
Àvñ
, "level", 0);

163 
	`add_a˘i⁄
(
©e°
, "atest", 0);

164 
	`add_a˘i⁄
(
ôe°
, "itest", 0);

165 
	`add_a˘i⁄
(
d€d
, "doed", 0);

166 
	}
}

	@drand48.c

1 
	~"dønd48.h
"

14 #i‚de‡
HAVEFP


15 
	#HAVEFP
 1

	)

17 
	#N
 16

	)

18 
	#MASK
 (()(1 << (
N
 - 1)Ë+ (1 << (N - 1)Ë- 1)

	)

19 
	#LOW
(
x
Ë(()(xË& 
MASK
)

	)

20 
	#HIGH
(
x
Ë
	`LOW
((xË>> 
N
)

	)

21 
	#MUL
(
x
, 
y
, 
z
Ë{ 
l
 = ()(x) * ()(y); \

22 (
z
)[0] = 
	`LOW
(
l
); (z)[1] = 
	`HIGH
÷); }

	)

23 
	#CARRY
(
x
, 
y
Ë(()(xË+ ()(yË> 
MASK
)

	)

24 
	#ADDEQU
(
x
, 
y
, 
z
Ë(z = 
	`CARRY
(x, (y)), x = 
	`LOW
(x + (y)))

	)

25 
	#X0
 0x330E

	)

26 
	#X1
 0xABCD

	)

27 
	#X2
 0x1234

	)

28 
	#A0
 0xE66D

	)

29 
	#A1
 0xDEEC

	)

30 
	#A2
 0x5

	)

31 
	#C
 0xB

	)

32 
	#SET3
(
x
, 
x0
, 
x1
, 
x2
Ë((x)[0] = (x0), (x)[1] = (x1), (x)[2] = (x2))

	)

33 
	#SETLOW
(
x
, 
y
, 
n
Ë
	`SET3
(x, 
	`LOW
((y)[n]), LOW((y)[“)+1]), LOW((y)[“)+2]))

	)

34 
	#SEED
(
x0
, 
x1
, 
x2
Ë(
	`SET3
(
x
, x0, x1, x2), SET3(
a
, 
A0
, 
A1
, 
A2
), 
c
 = 
C
)

	)

35 
	#REST
(
v
Ë
i
 = 0; i < 3; i++Ë{ 
xsubi
[i] = 
x
[i]; x[i] = 
ãmp
[i]; } \

36  (
v
);

	)

37 
	#NEST
(
TYPE
, 
f
, 
F
ËTYPE 
	`f
(
xsubi
) *xsubi; { \

38 
i
; 
TYPE
 
v
; 
ãmp
[3]; \

39 
i
 = 0; i < 3; i++Ë{ 
ãmp
[i] = 
x
[i]; x[i] = 
	`LOW
(
xsubi
[i]); } \

40 
v
 = 
	`F
(); 
	`REST
(v); }

	)

41 
	#HI_BIT
 (1UL << (2 * 
N
 - 1))

	)

43 
	gx
[3] = { 
X0
, 
X1
, 
X2
 }, 
	ga
[3] = { 
A0
, 
A1
, 
A2
 }, 
	gc
 = 
C
;

44 
	gœ°x
[3];

45 
√xt
();

47 #i‡
HAVEFP


49 
	$dønd48
()

51 #i‡
pdp11


52 
two16m
;

53 
two16m
 = 1.0 / (1L << 
N
);

55 
two16m
 = 1.0 / (1L << 
N
);

58 
	`√xt
();

59  (
two16m
 * (two16m * (two16m * 
x
[0] + x[1]) + x[2]));

60 
	}
}

62 
NEST
(, 
î™d48
, 
dønd48
);

67 
	$ú™d48
(
m
)

71 
m
;

73 
r
[4], 
p
[2], 
ˇºy0
 = 0;

75 
	`√xt
();

76 
	`MUL
(
m
, 
x
[0], &
r
[0]);

77 
	`MUL
(
m
, 
x
[2], &
r
[2]);

78 
	`MUL
(
m
, 
x
[1], 
p
);

79 i‡(
	`CARRY
(
r
[1], 
p
[0]))

80 
	`ADDEQU
(
r
[2], 1, 
ˇºy0
);

81  (
r
[3] + 
ˇºy0
 + 
	`CARRY
‘[2], 
p
[1]));

82 
	}
}

85 
	$kønd48
(
xsubi
, 
m
)

87 *
xsubi
;

88 
m
;

90 
i
;

91 
iv
;

92 
ãmp
[3];

94 
i
 = 0; i < 3; i++) {

95 
ãmp
[
i
] = 
x
[i];

96 
x
[
i
] = 
xsubi
[i];

98 
iv
 = 
	`ú™d48
(
m
);

99 
	`REST
(
iv
);

100 
	}
}

104 
	$Ã™d48
()

106 
	`√xt
();

107  ((()
x
[2] << (
N
 - 1)) + (x[1] >> 1));

108 
	}
}

111 
	$mønd48
()

113 
l
;

115 
	`√xt
();

118  ((
l
 = (()
x
[2] << 
N
Ë+ x[1]Ë& 
HI_BIT
 ?Ü | -HI_BIT :Ü);

119 
	}
}

122 
	$√xt
()

124 
p
[2], 
q
[2], 
r
[2], 
ˇºy0
, 
ˇºy1
;

126 
	`MUL
(
a
[0], 
x
[0], 
p
);

127 
	`ADDEQU
(
p
[0], 
c
, 
ˇºy0
);

128 
	`ADDEQU
(
p
[1], 
ˇºy0
, 
ˇºy1
);

129 
	`MUL
(
a
[0], 
x
[1], 
q
);

130 
	`ADDEQU
(
p
[1], 
q
[0], 
ˇºy0
);

131 
	`MUL
(
a
[1], 
x
[0], 
r
);

132 
x
[2] = 
	`LOW
(
ˇºy0
 + 
ˇºy1
 + 
	`CARRY
(
p
[1], 
r
[0]Ë+ 
q
[1] +Ñ[1] +

133 
a
[0] * 
x
[2] +á[1] * x[1] +á[2] * x[0]);

134 
x
[1] = 
	`LOW
(
p
[1] + 
r
[0]);

135 
x
[0] = 
	`LOW
(
p
[0]);

136 
	}
}

139 
	$§™d48
(
£edvÆ
)

140 
£edvÆ
;

142 
	`SEED
(
X0
, 
	`LOW
(
£edvÆ
), 
	`HIGH
(seedval));

143 
	}
}

146 
	$£ed48
(
£ed16v
)

147 
£ed16v
[3];

149 
	`SETLOW
(
œ°x
, 
x
, 0);

150 
	`SEED
(
	`LOW
(
£ed16v
[0]), LOW(seed16v[1]), LOW(seed16v[2]));

151  (
œ°x
);

152 
	}
}

155 
	$lc⁄g48
(
∑øm
)

156 
∑øm
[7];

158 
	`SETLOW
(
x
, 
∑øm
, 0);

159 
	`SETLOW
(
a
, 
∑øm
, 3);

160 
c
 = 
	`LOW
(
∑øm
[6]);

161 
	}
}

163 
NEST
(, 
ƒ™d48
, 
Ã™d48
);

165 
NEST
(, 
jønd48
, 
mønd48
);

167 #ifde‡
DRIVER


174 
	~<°dio.h
>

176 
	$maö
()

178 
i
;

180 
i
 = 0; i < 80; i++) {

181 ()
	`¥ötf
("%4d ", ()(4096 * 
	`dønd48
()));

182 ()
	`¥ötf
("%.4X%.4X%.4X\n", 
x
[2], x[1], x[0]);

184 
	}
}

	@drand48.h

1 
dønd48
();

2 
î™d48
([3]);

3 
jønd48
([3]);

4 
lc⁄g48
([7]);

5 
Ã™d48
();

6 
mønd48
();

7 
ƒ™d48
([3]);

8 *
£ed48
([3]);

9 
§™d48
();

	@ed.c

38 
	#PROMPT
 ":"

	)

40 
	gvîsi⁄
 = 6;

42 
	~<°dio.h
>

43 
	~<°rög.h
>

44 #ifde‡
__STDC__


45 
	~<mem‹y.h
>

47 
	~<sys/ty≥s.h
>

48 
	~<˘y≥.h
>

53 
	~"c⁄fig.h
"

54 
	~"löt.h
"

55 
	~"ªgexp.h
"

56 
	~"öãΩªt.h
"

57 
	~"obje˘.h
"

58 
	~"exec.h
"

59 
	~"comm.h
"

60 
	~"comm1.h
"

61 
	~"m°rög.h
"

62 
	~"m≠pög.h
"

63 
	~"simuœã.h
"

65 
	~"ölöe_svÆue.h
"

68 
	#NO_END_DOLLAR_SIGN


	)

72 
	#NUL
 0x00

	)

73 
	#EOS
 0x00

	)

74 
	#SOH
 0x01

	)

75 
	#STX
 0x02

	)

76 
	#ETX
 0x03

	)

77 
	#EOT
 0x04

	)

78 
	#ENQ
 0x05

	)

79 
	#ACK
 0x06

	)

80 
	#BEL
 0x07

	)

81 
	#BS
 0x08

	)

82 
	#HT
 0x09

	)

83 
	#LF
 0x0®

	)

84 
	#NL
 '\n'

	)

85 
	#VT
 0x0b

	)

86 
	#FF
 0x0¯

	)

87 
	#CR
 0x0d

	)

88 
	#SO
 0x0ê

	)

89 
	#SI
 0x0‡

	)

90 
	#DLE
 0x10

	)

91 
	#DC1
 0x11

	)

92 
	#DC2
 0x12

	)

93 
	#DC3
 0x13

	)

94 
	#DC4
 0x14

	)

95 
	#NAK
 0x15

	)

96 
	#SYN
 0x16

	)

97 
	#ETB
 0x17

	)

98 
	#CAN
 0x18

	)

99 
	#EM
 0x19

	)

100 
	#SUB
 0x1®

	)

101 
	#ESC
 0x1b

	)

102 
	#FS
 0x1¯

	)

103 
	#GS
 0x1d

	)

105 
	#US
 0x1‡

	)

106 
	#SP
 0x20

	)

107 
	#DEL
 0x7‡

	)

108 
	#ESCAPE
 '\\'

	)

110 
	#TAB
 '\t'

	)

111 
	#LB
 '{'

	)

112 
	#RB
 '}'

	)

113 
	#LC
 '('

	)

114 
	#RC
 ')'

	)

115 
	#LS
 '['

	)

116 
	#RS
 ']'

	)

117 
	#PP
 '\"'

	)

118 
	#EOL
 '\0'

	)

121 
	#TRUE
 1

	)

122 
	#FALSE
 0

	)

123 
	#ERR
 -2

	)

124 
	#FATAL
 (
ERR
-1)

	)

125 
	#CHANGED
 (
ERR
-2)

	)

126 
	#SET_FAIL
 (
ERR
-3)

	)

127 
	#SUB_FAIL
 (
ERR
-4)

	)

128 
	#MEM_FAIL
 (
ERR
-5)

	)

129 
	#UNSPEC_FAIL
 (
ERR
-6)

	)

131 
	#BUFFER_SIZE
 2048

	)

133 
	#LINFREE
 1

	)

134 
	#LGLOB
 2

	)

136 
	#MAXLINE
 512

	)

137 
	#MAXPAT
 256

	)

138 
	#MAXFNAME
 256

	)

143 
¥ogøm
 *
cuºít_¥og
;

144 
obje˘
 *
ma°î_ob
;

146 
	gEdEº
 = 0;

148 
	slöe
 {

149 
	ml_°©
;

150 
löe
 *
	ml_¥ev
;

151 
löe
 *
	ml_√xt
;

152 
	ml_buff
[1];

154 
löe
 
	tLINE
;

156 
obje˘
 *
comm™d_givî
;

157 
£t_¥om±
 (*);

159 #i‚de‡
touµî


160 
touµî
 ();

163 
d›∫t
 (, );

164 
ös
 (*);

165 
deÊt
 (, );

166 
doglob
 ();

167 
£t
 ();

168 
gël°
 ();

169 
gë⁄e
 ();

170 
ckglob
 ();

171 
£t_ed_buf
 ();

172 
ßve_ed_buf„r
 ();

173 #ifde‡
ED_INDENT


174 
ödít_code
 ();

176 
¥öt_hñp
 (
¨g
);

177 
¥öt_hñp2
 ();

178 
cou¡_bœnks
 (
löe
);

179 
_cou¡_bœnks
 (*
°r
, 
bœnks
);

180 
‰ì_ed_buf„r
 ();

182 
	#ED_BUFFER
 (
comm™d_givî
->
öãø˘ive
->
ed_buf„r
)

	)

184 
	#P_DIAG
 (
ED_BUFFER
->
düg
)

	)

185 
	#P_TRUNCFLG
 (
ED_BUFFER
->
åuncÊg
)

	)

186 
	#P_NONASCII
 (
ED_BUFFER
->
n⁄ascii
)

	)

187 
	#P_NULLCHAR
 (
ED_BUFFER
->
nuŒch¨
)

	)

188 
	#P_TRUNCATED
 (
ED_BUFFER
->
åunˇãd
)

	)

189 
	#P_FNAME
 (
ED_BUFFER
->
‚ame
)

	)

190 
	#P_FCHANGED
 (
ED_BUFFER
->
fch™ged
)

	)

191 
	#P_NOFNAME
 (
ED_BUFFER
->
no‚ame
)

	)

192 
	#P_MARK
 (
ED_BUFFER
->
m¨k
)

	)

193 
	#P_OLDPAT
 (
ED_BUFFER
->
ﬁd∑t
)

	)

194 
	#P_LINE0
 (
ED_BUFFER
->
Löe0
)

	)

195 
	#P_CURLN
 (
ED_BUFFER
->
CurLn
)

	)

196 
	#P_CURPTR
 (
ED_BUFFER
->
CurPå
)

	)

197 
	#P_LASTLN
 (
ED_BUFFER
->
La°Ln
)

	)

198 
	#P_LINE1
 (
ED_BUFFER
->
Löe1
)

	)

199 
	#P_LINE2
 (
ED_BUFFER
->
Löe2
)

	)

200 
	#P_NLINES
 (
ED_BUFFER
->
∆öes
)

	)

201 
	#P_SHIFTWIDTH
 (
ED_BUFFER
->
shi·width
)

	)

202 
	#P_FLAGS
 (
ED_BUFFER
->
Êags
)

	)

203 
	#P_APPENDING
 (
ED_BUFFER
->
≠≥ndög
)

	)

204 
	#P_MORE
 (
ED_BUFFER
->
m‹ög
)

	)

205 
	#P_LEADBLANKS
 (
ED_BUFFER
->
Àadög_bœnks
)

	)

206 
	#P_CUR_AUTOIND
 (
ED_BUFFER
->
cur_autoödít
)

	)

209 
	#NFLG_MASK
 0x0010

	)

210 
	#P_NFLG
 ( 
P_FLAGS
 & 
NFLG_MASK
 )

	)

211 
	#LFLG_MASK
 0x0020

	)

212 
	#P_LFLG
 ( 
P_FLAGS
 & 
LFLG_MASK
 )

	)

213 
	#PFLG_MASK
 0x0040

	)

214 
	#P_PFLG
 ( 
P_FLAGS
 & 
PFLG_MASK
 )

	)

215 
	#EIGHTBIT_MASK
 0x0080

	)

216 
	#P_EIGHTBIT
 ( 
P_FLAGS
 & 
EIGHTBIT_MASK
 )

	)

217 
	#AUTOINDFLG_MASK
 0x0100

	)

218 
	#P_AUTOINDFLG
 ( 
P_FLAGS
 & 
AUTOINDFLG_MASK
 )

	)

219 
	#EXCOMPAT_MASK
 0x0200

	)

220 
	#P_EXCOMPAT
 ( 
P_FLAGS
 & 
EXCOMPAT_MASK
 )

	)

221 
	#TABINDENT_MASK
 0x0400

	)

222 
	#P_TABINDENT
 ( 
P_FLAGS
 & 
TABINDENT_MASK
 )

	)

223 
	#SHIFTWIDTH_MASK
 0x000f

	)

224 
	#ALL_FLAGS_MASK
 0x07f0

	)

227 
	gölö
[
MAXLINE
];

228 *
	gö±r
;

229 
	sed_buf„r
 {

230 
	mdüg
;

231 
	måuncÊg
;

232 
	mn⁄ascii
;

233 
	mnuŒch¨
;

234 
	måunˇãd
;

235 
	m‚ame
[
MAXFNAME
];

236 
	mfch™ged
;

237 
	mno‚ame
;

238 
	mm¨k
['z'-'a'+1];

239 
ªgexp
 *
	mﬁd∑t
;

241 
LINE
 
	mLöe0
;

242 
	mCurLn
;

243 
LINE
 *
	mCurPå
;

244 
	mLa°Ln
;

245 
	mLöe1
, 
	mLöe2
, 
	m∆öes
;

246 
	mÊags
;

248 
	meightbô
;

249 
	mnÊg
;

250 
	mlÊg
;

251 
	mpÊg
;

253 
	m≠≥ndög
;

254 
	mm‹ög
;

255 
˛osuª
 *
	mexô_func
;

256 
	mshi·width
;

257 
	mÀadög_bœnks
;

258 
	mcur_autoödít
;

261 
	stbl
 {

262 *
	mt_°r
;

263 
	mt_™d_mask
;

264 
	mt_‹_mask
;

265 } *
	gt
, 
	gtbl
[] = {

266 { "numbî", ~
FALSE
, 
NFLG_MASK
, },

267 { "n⁄umbî", ~
NFLG_MASK
, 
FALSE
, },

268 { "li°", ~
FALSE
, 
LFLG_MASK
, },

269 { "nﬁi°", ~
LFLG_MASK
, 
FALSE
, },

270 { "¥öt", ~
FALSE
, 
PFLG_MASK
, },

271 { "n›röt", ~
PFLG_MASK
, 
FALSE
, },

272 { "eightbô", ~
FALSE
, 
EIGHTBIT_MASK
, },

273 { "n€ightbô", ~
EIGHTBIT_MASK
, 
FALSE
, },

274 { "autoödít", ~
FALSE
, 
AUTOINDFLG_MASK
, },

275 { "nﬂutoödít", ~
AUTOINDFLG_MASK
, 
FALSE
, },

276 { "excom∑tibÀ", ~
FALSE
, 
EXCOMPAT_MASK
, },

277 { "n€xcom∑tibÀ",~
EXCOMPAT_MASK
,
FALSE
, },

278 { "èbödít", ~
FALSE
, 
TABINDENT_MASK
, },

279 { "nŸabödít",~
TABINDENT_MASK
, 
FALSE
, },

286 
LINE
 *
gë±r
();

287 
¥¡ 
(*, , ), 
îr‹
(*, ...);

288 
ªgexp
 *
›ç©
();

293 #i‚de‡
max


294 
	#max
(
a
,
b
Ë(◊Ë> (bË? (aË: (b))

	)

297 #i‚de‡
mö


298 
	#mö
(
a
,
b
Ë(◊Ë< (bË? (aË: (b))

	)

301 
	#√xén
(
l
Ë(÷)+1 > 
P_LASTLN
 ? 0 : (l)+1)

	)

302 
	#¥ev 
(
l
Ë(÷)-1 < 0 ? 
P_LASTLN
 : (l)-1)

	)

304 
	#gëtxé
(
lö
Ë(÷ö)->
l_buff
)

	)

305 
	#gëtxt
(
num
Ë(
	`gëtxé
–
	`gë±r
“umË))

	)

307 
	#gë√xçå
(
p
Ë(’)->
l_√xt
)

	)

308 
	#gë¥ev±r
(
p
Ë(’)->
l_¥ev
)

	)

310 
	#£tCurLn
–
lö
 ) ( 
P_CURPTR
 = 
	`gë±r
–
P_CURLN
 = (löËË)

	)

311 
	#√xtCurLn
(Ë–
P_CURLN
 = 
	`√xén
(P_CURLN), 
P_CURPTR
 = 
	`gë√xçå
–P_CURPTR ) )

	)

312 
	#¥evCurLn
(Ë–
P_CURLN
 = 
	`¥ev 
(P_CURLN), 
P_CURPTR
 = 
	`gë¥ev±r
–P_CURPTR ) )

	)

314 
	#˛rbuf
(Ë
	`dñ
(1, 
P_LASTLN
)

	)

316 
	#Skù_Whôe_S∑˚
 {*
ö±r
==
SP
 || *ö±r==
HT
Ëö±r++;}

	)

318 
	#ªlök
(
a
, 
x
, 
y
, 
b
Ë{ (x)->
l_¥ev
 = (a); (y)->
l_√xt
 = (b); }

	)

328 
	$≠≥nd
(
löe
, 
glob
)

330 if(
glob
)

331 (
ERR
);

332 
	`£tCurLn
–
löe
 );

333 
P_APPENDING
 = 1;

334 if(
P_NFLG
)

335 ()
	`add_mesßge
("%6d. ",
P_CURLN
+1);

336 i‡(
P_CUR_AUTOIND
)

337 ()
	`add_mesßge
("%*s",
P_LEADBLANKS
,"");

338 
	`£t_¥om±
("*\b");

340 
	}
}

343 
	$m‹e_≠≥nd
(*
°r
)

345 if(
°r
[0] == '.' && str[1] == '\0')

347 
P_APPENDING
 = 0;

348 
	`£t_¥om±
(
PROMPT
);

351 if(
P_NFLG
)

352 ()
	`add_mesßge
("%6d. ",
P_CURLN
+2);

353 i‡–
P_CUR_AUTOIND
 )

355 
i
;

356 
Àss_ödít_Êag
 = 0;

358  *
°r
=='\004' || *str == '\013' )

360 
°r
++;

361 
P_LEADBLANKS
-=
P_SHIFTWIDTH
;

362 i‡–
P_LEADBLANKS
 < 0 ) P_LEADBLANKS=0;

363 
Àss_ödít_Êag
=1;

365  
i
 = 0; i < 
P_LEADBLANKS
; )

366 
ölö
[
i
++] = ' ';

367 ()
	`°∫˝y
(
ölö
 + 
P_LEADBLANKS
, 
°r
, (
size_t
)(
MAXLINE
 - P_LEADBLANKS));

368 
ölö
[
MAXLINE
-1] = '\0';

369 
	`_cou¡_bœnks
(
ölö
,0);

370 ()
	`add_mesßge
("%*s",
P_LEADBLANKS
,"");

371 i‡–!*
°r
 && 
Àss_ödít_Êag
 )

373 
°r
 = 
ölö
;

375 i‡(
	`°æí
(
°r
Ë>
MAXLINE
) {

376 ()
	`add_mesßge
("[lineÅooÜong,Åruncated]\n");

377 
°r
[
MAXLINE
-1] = '\0';

379 ()
	`ös
(
°r
);

380 
	}
}

383 
	$cou¡_bœnks
(
löe
)

385 
	`_cou¡_bœnks
(
	`gëtxé
(
	`gë±r
(
löe
)), 0);

386 
	}
}

389 
	$_cou¡_bœnks
(*
°r
, 
bœnks
)

391  ; *
°r
; str++ )

393 i‡–*
°r
 =' ' ) 
bœnks
++;

394 i‡–*
°r
 ='\t' ) 
bœnks
 += 8 - blanks % 8 ;

397 
P_LEADBLANKS
 = 
bœnks
 < 
MAXLINE
 ? blanks : MAXLINE ;

398 
	}
}

403 
	$ckglob
()

405 
ªgexp
 *
glb∑t
;

406 
c
, 
dñim
, *
lö
;

407 
num
;

408 
LINE
 *
±r
;

410 
c
 = *
ö±r
;

412 if(
c
 != 'g' && c != 'v')

414 i‡(
	`deÊt
(1, 
P_LASTLN
) < 0)

415 (
ERR
);

417 
dñim
 = *++
ö±r
;

418 if(
dñim
 <= ' ')

419 (
ERR
);

421 
glb∑t
 = 
	`›ç©
();

422 if(*
ö±r
 =
dñim
)

423 
ö±r
++;

424 
±r
 = 
	`gë±r
(1);

425 
num
 = 1;Çum <
P_LASTLN
;Çum++)

427 
±r
->
l_°©
 &~
LGLOB
;

428 i‡(
P_LINE1
 <
num
 &&Çum <
P_LINE2
)

432 i‡(
glb∑t
)

434 
lö
 = 
	`gëtxé
(
±r
);

435 if(
	`ªgexec
(
glb∑t
, 
lö
 )) {

436 i‡(
c
 == 'g')

437 
±r
->
l_°©
 |
LGLOB
;

438 i‡(
c
 == 'v')

439 
±r
->
l_°©
 |
LGLOB
;

442 
±r
 = 
	`gë√xçå
(ptr);

446 
	}
}

455 
	$deÊt
(
def1
, 
def2
)

457 if(
P_NLINES
 == 0)

459 
P_LINE1
 = 
def1
;

460 
P_LINE2
 = 
def2
;

462  ((
P_LINE1
 > 
P_LINE2
 || P_LINE1 <0Ë? 
ERR
 : 0);

463 
	}
}

476 
	$dñ
(
‰om
, 
to
)

478 
LINE
 *
fú°
, *
œ°
, *
√xt
, *
tmp
;

480 if(
‰om
 < 1)

481 
‰om
 = 1;

482 
fú°
 = 
	`gë¥ev±r
–
	`gë±r
–
‰om
 ) );

483 
œ°
 = 
	`gë√xçå
–
	`gë±r
–
to
 ) );

484 
√xt
 = 
fú°
->
l_√xt
;

485 
√xt
 !
œ°
 &&Çexà!&
P_LINE0
)

487 
tmp
 = 
√xt
->
l_√xt
;

488 
	`‰ì
((*)
√xt
);

489 
√xt
 = 
tmp
;

491 
	`ªlök
(
fú°
, 
œ°
, first,Üast);

492 
P_LASTLN
 -(
to
 - 
‰om
)+1;

493 
	`£tCurLn
(
	`¥ev 
(
‰om
));

495 
	}
}

499 
	$dﬁ°
(
löe1
, 
löe2
)

501 
ﬁdÊags
 = 
P_FLAGS
, 
p
;

503 
P_FLAGS
 |
LFLG_MASK
;

504 
p
 = 
	`d›∫t
(
löe1
, 
löe2
);

505 
P_FLAGS
 = 
ﬁdÊags
;

506  
p
;

507 
	}
}

512 
	$d›∫t
(
‰om
, 
to
)

514 
‰om
 = (from < 1) ? 1 : from;

515 
to
 = (tÿ> 
P_LASTLN
) ? P_LASTLN :Åo;

517 if(
to
 != 0)

519 
	`£tCurLn
–
‰om
 );

520  
P_CURLN
 <
to
 )

522 
	`¥¡ 
–
	`gëtxé
–
P_CURPTR
 ), 
P_LFLG
, (
P_NFLG
 ? 
P_CURLN
 : 0));

523 if–
P_CURLN
 =
to
 )

525 
	`√xtCurLn
();

529 
	}
}

531 
	$¥¡ 
(*
°r
, 
vÊg
, 
Àn
)

533 *
löe
, 
°¨t
[(
MAXLINE
 << 1) + 2];

535 
löe
 = 
°¨t
;

536 i‡(
Àn
)

537 ()
	`add_mesßge
("%4d ", 
Àn
);

538 *
°r
 && *°∏!
NL
)

540 i‡(*
°r
 < ' ' || *°∏>
DEL
)

542 *
°r
)

545 *
löe
++ = *
°r
;

547 
DEL
:

548 *
löe
++ = '^';

549 *
löe
++ = '?';

552 *
löe
++ = '^';

553 *
löe
++ = (*
°r
 & 0x1F) | '@';

558 *
löe
++ = *
°r
;

559 
°r
++;

561 #i‡!
	`deföed
(
NO_END_DOLLAR_SIGN
Ë|| deföed(
löt
)

562 i‡(
vÊg
)

563 *
löe
++ = '$';

565 *
löe
 = 
EOS
;

566 ()
	`add_mesßge
("%s\n", 
°¨t
);

567 
	}
}

572 
	$egës
(*
°r
, 
size
, 
FILE
 *
°ªam
)

574 
c
 = 0, 
cou¡
;

575 *
˝
;

577 
cou¡
 = 0, 
˝
 = 
°r
; 
size
 > count;)

579 
c
 = 
	`gëc
(
°ªam
);

580 if(
c
 =
EOF
)

582 *
˝
 = 
EOS
;

583 if(
cou¡
)

584 ()
	`add_mesßge
("[IncompleteÜastÜine]\n");

585 (
cou¡
);

587 if(
c
 =
NL
)

589 *
˝
 = 
EOS
;

590 (++
cou¡
);

592 i‡(
c
 == 0)

593 
P_NULLCHAR
++;

596 if(
c
 > 127)

598 if(!
P_EIGHTBIT
)

599 
c
 = c & 127;

600 
P_NONASCII
++;

602 *
˝
++ = 
c
;

603 
cou¡
++;

606 
°r
[
cou¡
 - 1] = 
EOS
;

607 if(
c
 !
NL
)

609 ()
	`add_mesßge
("truncatingÜine\n");

610 
P_TRUNCATED
++;

611 (
c
 = 
	`gëc
(
°ªam
)Ë!
EOF
)

612 if(
c
 =
NL
)

615 (
cou¡
);

616 
	}
}

620 
	$d‹ód
(
lö
, *
‚ame
)

622 
FILE
 *
Â
;

623 
îr
;

624 
byãs
;

625 
löes
;

626 
°r
[
MAXLINE
];

628 
îr
 = 0;

629 
P_NONASCII
 = 
P_NULLCHAR
 = 
P_TRUNCATED
 = 0;

631 i‡(
P_DIAG
)

632 ()
	`add_mesßge
("\"%s\" ",
‚ame
);

633 if–(
Â
 = 
	`f›í
(
‚ame
, "r")Ë=
NULL
 )

635 ()
	`add_mesßge
("'%s' i¢'àªadabÀ.\n", 
‚ame
);

636 –
ERR
 );

638 
	`£tCurLn
–
lö
 );

639 
löes
 = 0, 
byãs
 = 0;(
îr
 = 
	`egës
(
°r
,
MAXLINE
,
Â
)) > 0;)

641 
byãs
 +
îr
;

642 if(
	`ös
(
°r
) < 0)

644 
îr
 = 
MEM_FAIL
;

647 
löes
++;

649 ()
	`f˛o£
(
Â
);

650 if(
îr
 < 0)

651 (
îr
);

652 i‡(
P_DIAG
)

654 ()
	`add_mesßge
("%uÜöe†%u byãs",
löes
,
byãs
);

655 if(
P_NONASCII
)

656 ()
	`add_mesßge
(" [%dÇ⁄-ascii]",
P_NONASCII
);

657 if(
P_NULLCHAR
)

658 ()
	`add_mesßge
(" [%dÇul]",
P_NULLCHAR
);

659 if(
P_TRUNCATED
)

660 ()
	`add_mesßge
(" [%dÜöe†åunˇãd]",
P_TRUNCATED
);

661 ()
	`add_mesßge
("\n");

663 –
îr
 );

664 
	}
}

668 
	$dowrôe
(
‰om
, 
to
, *
‚ame
, 
≠Êg
)

670 
FILE
 *
Â
;

671 
lö
, 
îr
;

672 
löes
;

673 
byãs
;

674 *
°r
;

675 
LINE
 *
Õå
;

677 
îr
 = 0;

678 
löes
 = 0;

679 
byãs
 = 0;

681 ()
	`add_mesßge
("\"%s\" ",
‚ame
);

682 if((
Â
 = 
	`f›í
(
‚ame
,(
≠Êg
 ? "a" : "w"))Ë=
NULL
)

684 ()
	`add_mesßge
(" can't be opened for writing!\n");

685 –
ERR
 );

688 
Õå
 = 
	`gë±r
(
‰om
);

689 
lö
 = 
‰om
;Üö <
to
;Üin++)

691 
°r
 = 
Õå
->
l_buff
;

692 
löes
++;

693 
byãs
 +
	`°æí
(
°r
) + 1;

694 if(
	`Âuts
(
°r
, 
Â
Ë=
EOF
)

696 ()
	`add_mesßge
("file writeÉrror\n");

697 
îr
++;

700 ()
	`Âutc
('\n', 
Â
);

701 
Õå
 =Ü±r->
l_√xt
;

703 ()
	`add_mesßge
("%uÜöe†%lu byãs\n",
löes
,
byãs
);

704 ()
	`f˛o£
(
Â
);

705 –
îr
 );

706 
	}
}

711 
	$föd
(
ªgexp
 *
∑t
, 
dú
)

713 
i
, 
num
;

714 
LINE
 *
lö
;

716 i‡(
dú
)

717 
	`√xtCurLn
();

719 
	`¥evCurLn
();

720 
num
 = 
P_CURLN
;

721 
lö
 = 
P_CURPTR
;

722 i‡(!
∑t
)

723  (
ERR
);

724 
i
 = 0; i < 
P_LASTLN
; i++ )

726 if(
	`ªgexec
–
∑t
, 
	`gëtxé
–
lö
 ) ))

727 (
num
);

728 i‡(
EdEº
) { EdErr = 0; ; }

729 if–
dú
 )

730 
num
 = 
	`√xén
“um), 
lö
 = 
	`gë√xçå
(lin);

732 
num
 = 
	`¥ev 
“um), 
lö
 = 
	`gë¥ev±r
(lin);

734  ( 
ERR
 );

735 
	}
}

742 
	$födg
(
ªgexp
 *
∑t
, 
dú
)

744 
i
, 
num
,
cou¡
;

745 
LINE
 *
lö
;

747 
cou¡
=0;

748 
num
 = 
P_CURLN
;

749 
lö
 = 
P_CURPTR
;

750 
i
 = 0; i < 
P_LASTLN
; i++ )

752 if(
	`ªgexec
–
∑t
, 
	`gëtxé
–
lö
 ) ))

754 
	`¥¡ 
–
	`gëtxé
–
lö
 ), 
P_LFLG
, (
P_NFLG
 ? 
P_CURLN
 : 0));

755 
cou¡
++;

757 if–
dú
 )

758 
num
 = 
	`√xén
“um), 
lö
 = 
	`gë√xçå
(lin);

760 
num
 = 
	`¥ev 
“um), 
lö
 = 
	`gë¥ev±r
(lin);

761 
	`√xtCurLn
();

763 i‡(!
cou¡
)

764  ( 
ERR
 );

765  (
cou¡
);

766 
	}
}

772 
	$gë‚
(
wrôeÊg
)

774 
fûe
[
MAXFNAME
];

775 *
˝
;

776 *
fûe2
;

777 
svÆue
 *
ªt
;

780 i‡(*
ö±r
 =
NL
)

782 
P_NOFNAME
=
TRUE
;

783 
fûe
[0] = '/';

784 ()
	`°r˝y
(
fûe
+1, 
P_FNAME
);

788 
P_NOFNAME
=
FALSE
;

789 
Skù_Whôe_S∑˚
;

791 
˝
 = 
fûe
;

792 *
ö±r
 && *ö±∏!
NL
 && *ö±∏!
SP
 && *ö±∏!
HT
)

793 *
˝
++ = *
ö±r
++;

794 *
˝
 = '\0';

797 if(*
fûe
 == '\0')

799 ()
	`add_mesßge
("Bad fileÇame.\n");

800 –
NULL
 );

803 i‡(
fûe
[0] != '/')

805 
	`push_°rög
(
fûe
, 
STRING_MSTRING
);

806 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_MAKE_PATH_ABSOLUTE
, 1);

807 i‡(
ªt
 =0 ||Ñë->
ty≥
 !
T_STRING
)

808  
NULL
;

809 ()
	`°∫˝y
(
fûe
, 
ªt
->
u
.
°rög
,  file - 1);

811 
fûe2
 = 
	`check_vÆid_∑th
(
fûe
, 
comm™d_givî
,

812 "ed_°¨t", 
wrôeÊg
);

814 i‡(!
fûe2
)

815 –
NULL
 );

816 ()
	`°∫˝y
(
fûe
, 
fûe2
, 
MAXFNAME
-1);

817 
fûe
[
MAXFNAME
-1] = 0;

819 if(*
fûe
 == '\0') {

820 ()
	`add_mesßge
("no fileÇame\n");

821 (
NULL
);

823 –
fûe
 );

824 
	}
}

828 
	$gënum
(
fú°
)

830 
ªgexp
 *
§ch∑t
;

831 
num
;

832 
c
;

834 
Skù_Whôe_S∑˚
;

836 if(*
ö±r
 >= '0' && *inptr <= '9')

838 
num
 = 0; *
ö±r
 >= '0' && *inptr <= '9'; ++inptr) {

839 
num
 = (num * 10Ë+ (*
ö±r
 - '0');

841  
num
;

844 
c
 = *
ö±r
)

847 
ö±r
++;

848  (
P_CURLN
);

851 
ö±r
++;

852  (
P_LASTLN
);

856 
§ch∑t
 = 
	`›ç©
();

857 if(*
ö±r
 =
c
)

858 
ö±r
++;

859 (
	`föd
(
§ch∑t
,
c
 == '/'?1:0));

864 
§ch∑t
 = 
	`›ç©
();

865 if(*
ö±r
 =
c
)

866 
ö±r
++;

867 (
	`födg
(
§ch∑t
, 
c
 == '^' ? 1 : 0));

872 (
fú°
 ? 
P_CURLN
 : 1);

875 
ö±r
++;

876 i‡(*
ö±r
 < 'a' || *inptr > 'z')

877 (
EOF
);

878  
P_MARK
[ *
ö±r
++ - 'a' ];

881  ( 
fú°
 ? 
EOF
 : 1 );

883 
	}
}

889 
	#FIRST
 1

	)

890 
	#NOTFIRST
 0

	)

893 
	$gë⁄e
()

895 
c
, 
i
, 
num
;

897 if((
num
 = 
	`gënum
(
FIRST
)) >= 0)

901 
Skù_Whôe_S∑˚
;

902 if(*
ö±r
 != '+' && *inptr != '-')

905 
c
 = *
ö±r
++;

906 if((
i
 = 
	`gënum
(
NOTFIRST
)) < 0)

907  ( 
i
 );

908 if(
c
 == '+')

909 
num
 +
i
;

911 
num
 -
i
;

914  ( 
num
>
P_LASTLN
 ? 
ERR
 :Çum );

915 
	}
}

918 
	$gël°
()

920 
num
;

922 
P_LINE2
 = 0;

923 
P_NLINES
 = 0; (
num
 = 
	`gë⁄e
()) >= 0;)

925 
P_LINE1
 = 
P_LINE2
;

926 
P_LINE2
 = 
num
;

927 
P_NLINES
++;

928 if(*
ö±r
 != ',' && *inptr != ';')

930 if(*
ö±r
 == ';')

931 
	`£tCurLn
–
num
 );

932 
ö±r
++;

934 
P_NLINES
 = 
	`mö
(P_NLINES, 2);

935 if(
P_NLINES
 == 0)

936 
P_LINE2
 = 
P_CURLN
;

937 if(
P_NLINES
 <= 1)

938 
P_LINE1
 = 
P_LINE2
;

940  ( (
num
 =
ERR
Ë?Çum : 
P_NLINES
 );

941 
	}
}

946 
LINE
 *
	$gë±r
(
num
)

947 
num
;

949 
LINE
 *
±r
;

950 
j
;

952 i‡(2*
num
>
P_LASTLN
 &&Çum<=P_LASTLN) {

953 
±r
 = 
P_LINE0
.
l_¥ev
;

954 
j
 = 
P_LASTLN
; j>
num
; j--)

955 
±r
 =Öå->
l_¥ev
;

957 
±r
 = &
P_LINE0
;

958 
j
 = 0; j < 
num
; j++)

959 
±r
 =Öå->
l_√xt
;

961 (
±r
);

962 
	}
}

968 
	$gërhs
(*
sub
)

970 
dñim
 = *
ö±r
++;

971 *
outmax
 = 
sub
 + 
MAXPAT
;

972 if–
dñim
 =
NL
 || *
ö±r
 == NL)

973 –
ERR
 );

974  *
ö±r
 !
dñim
 && *ö±∏!
NL
 )

976 i‡–
sub
 > 
outmax
 )

977  
ERR
;

978 i‡–*
ö±r
 =
ESCAPE
 )

980  *++
ö±r
 )

983 *
sub
++ = '\r';

984 
ö±r
++;

987 
ESCAPE
:

988 *
sub
++ = 
ESCAPE
;

989 *
sub
++ = 
ESCAPE
;

990 
ö±r
++;

993 *
sub
++ = '\n';

994 
ö±r
++;

997 *
sub
++ = '\b';

998 
ö±r
++;

1001 *
sub
++ = '\t';

1002 
ö±r
++;

1005 
i
=3;

1006 *
sub
 = 0;

1009 i‡(*++
ö±r
<'0' || *inptr >'7')

1011 *
sub
 = (*sub<<3Ë| (*
ö±r
-'0');

1012 } --
i
 != 0);

1013 
sub
++;

1018 i‡–*
ö±r
 !
dñim
 )

1019 *
sub
++ = 
ESCAPE
;

1032 *
sub
++ = 
ESCAPE
;

1036 *
sub
++ = *
ö±r
;

1037 i‡–*
ö±r
 !
NL
 )

1038 
ö±r
++;

1041 *
sub
++ = *
ö±r
++;

1043 *
sub
 = '\0';

1045 
ö±r
++;

1046 
Skù_Whôe_S∑˚
;

1047 if(*
ö±r
 == 'g')

1049 
ö±r
++;

1053 
	}
}

1057 
	$ös
(*
°r
)

1059 *
˝
;

1060 
LINE
 *
√w
, *
nxt
;

1061 
size_t
 
Àn
;

1065 
˝
 = 
°r
; *˝ && *˝ !
NL
; cp++)

1067 
Àn
 = 
˝
 - 
°r
;

1070 if((
√w
 = (
LINE
 *Ë
	`xÆloc
((LINEË+ 
Àn
)Ë=
NULL
)

1071 –
MEM_FAIL
 );

1073 
√w
->
l_°©
=0;

1074 ()
	`°∫˝y
(
√w
->
l_buff
, 
°r
, 
Àn
);

1075 
√w
->
l_buff
[
Àn
] = 
EOS
;

1076 
nxt
 = 
	`gë√xçå
(
P_CURPTR
);

1077 
	`ªlök
(
P_CURPTR
, 
√w
,Çew, 
nxt
);

1078 
	`ªlök
(
√w
, 
nxt
, 
P_CURPTR
,Çew);

1079 
P_LASTLN
++;

1080 
P_CURLN
++;

1081 
P_CURPTR
 = 
√w
;

1082 
°r
 = 
˝
 + 1;

1084  *
˝
 !
EOS
 );

1086 
	}
}

1092 
	$joö
(
fú°
, 
œ°
)

1094 
buf
[
MAXLINE
];

1095 *
˝
 = 
buf
, *
°r
;

1096 
LINE
 *
lö
;

1097 
num
, 
Êag
;

1099 i‡(
fú°
 <0 || fú° > 
œ°
 ||Üa° > 
P_LASTLN
)

1100 (
ERR
);

1101 i‡(
fú°
 =
œ°
)

1103 
	`£tCurLn
–
fú°
 );

1106 
lö
 = 
	`gë±r
(
fú°
);

1107 
Êag
 = 1, 
num
 = 
fú°
;Çum <
œ°
;Çum++)

1109 
°r
 = 
	`gëtxé
(
lö
);

1110 *
°r
)

1112 i‡(
Êag
 || (*
°r
 !
TAB
 && *°∏!
SP
))

1114 i‡(!
Êag
)

1115 *
˝
++ = 
SP
;

1116 i‡(
˝
 >
buf
 + 
MAXLINE
 - 1 )

1118 ()
	`add_mesßge
("lineÅooÜong\n");

1119 (
ERR
);

1121 *
˝
++ = *
°r
;

1122 
Êag
 = 1;

1124 
°r
++;

1126 
Êag
 = 0;

1127 
lö
 = 
	`gë√xçå
(lin);

1129 *
˝
 = 
EOS
;

1130 ()
	`dñ
(
fú°
, 
œ°
);

1131 if–
	`ös
(
buf
) < 0 )

1132  
MEM_FAIL
;

1133 
P_FCHANGED
 = 
TRUE
;

1135 
	}
}

1144 
	$moveblock
(
num
)

1146 
ønge
;

1147 
LINE
 *
bef‹e
, *
fú°
, *
œ°
, *
a·î
;

1149 if–
P_LINE1
 <
num
 &&Çum <
P_LINE2
 )

1150 –
ERR
 );

1151 
ønge
 = 
P_LINE2
 - 
P_LINE1
 + 1;

1152 
bef‹e
 = 
	`gë±r
(
	`¥ev 
(
P_LINE1
));

1153 
fú°
 = 
	`gë±r
(
P_LINE1
);

1154 
œ°
 = 
	`gë±r
(
P_LINE2
);

1155 
a·î
 = 
	`gë±r
(
	`√xén
(
P_LINE2
));

1157 
	`ªlök
(
bef‹e
, 
a·î
, before,áfter);

1158 
P_LASTLN
 -
ønge
;

1159 i‡(
num
 > 
P_LINE1
)

1160 
num
 -
ønge
;

1162 
bef‹e
 = 
	`gë±r
(
num
);

1163 
a·î
 = 
	`gë±r
(
	`√xén
(
num
));

1164 
	`ªlök
(
bef‹e
, 
fú°
, 
œ°
, 
a·î
);

1165 
	`ªlök
(
œ°
, 
a·î
, 
bef‹e
, 
fú°
);

1166 
P_LASTLN
 +
ønge
;

1167 
	`£tCurLn
–
num
 + 
ønge
 );

1169 
	}
}

1173 
	$å™s„r
(
num
)

1175 
mid
, 
lö
, 
¡øns
;

1177 i‡(
P_LINE1
 <0 || P_LINE1 > 
P_LINE2
)

1178 (
ERR
);

1180 
mid
 = 
num
 < 
P_LINE2
 ?Çum : P_LINE2;

1182 
	`£tCurLn
–
num
 );

1183 
¡øns
 = 0;

1185 
lö
 = 
P_LINE1
;Üö <
mid
;Üin++)

1187 if–
	`ös
(
	`gëtxt
(
lö
)) < 0 )

1188  
MEM_FAIL
;

1189 
¡øns
++;

1191 
lö
+=
¡øns
;

1192 
P_LINE2
+=
¡øns
;

1194  ; 
lö
 <
P_LINE2
;Üin += 2 )

1196 if–
	`ös
(
	`gëtxt
(
lö
)) < 0 )

1197  
MEM_FAIL
;

1198 
P_LINE2
++;

1201 
	}
}

1206 
ªgexp
 *

1207 
	$›ç©
()

1209 
dñim
, 
°r
[
MAXPAT
], *
˝
;

1211 
dñim
 = *
ö±r
++;

1212 i‡(
dñim
 =
NL
)

1213  
P_OLDPAT
;

1214 
˝
 = 
°r
;

1215 *
ö±r
 !
dñim
 && *ö±∏!
NL
 && *ö±∏!
EOS
 &&

1216 
˝
 < 
°r
 + 
MAXPAT
 - 1)

1218 if(*
ö±r
 =
ESCAPE
 && i≈å[1] !
NL
)

1219 *
˝
++ = *
ö±r
++;

1220 *
˝
++ = *
ö±r
++;

1223 *
˝
 = 
EOS
;

1224 if(*
°r
 =
EOS
)

1225 (
P_OLDPAT
);

1226 if(
P_OLDPAT
)

1227 
	`‰ì
((*Ë
P_OLDPAT
);

1228  
P_OLDPAT
 = 
	`ªgcomp
(
°r
, 
P_EXCOMPAT
);

1229 
	}
}

1233 
	$ªgîr‹
(*
s
)

1235 ()
	`add_mesßge
("ed: %s\n", 
s
 );

1236 
	}
}

1239 
	$£t
()

1241 
w‹d
[16];

1242 
i
;

1244 if(*(++
ö±r
) != 't') {

1245 if(*
ö±r
 !
SP
 && *ö±∏!
HT
 && *ö±∏!
NL
)

1246 (
ERR
);

1248 
ö±r
++;

1250 i‡–(*
ö±r
 =
NL
))

1252 ()
	`add_mesßge
("ed vîsi⁄ %d.%d\n", 
vîsi⁄
/100, version%100);

1253 
t
 = 
tbl
;Å->
t_°r
;Å+=2) {

1254 ()
	`add_mesßge
("%s:%†", 
t
->
t_°r
,

1255 
P_FLAGS
 & 
t
->
t_‹_mask
 ?"on":"off");

1257 ()
	`add_mesßge
("\nshi·width:%d\n",
P_SHIFTWIDTH
);

1261 
Skù_Whôe_S∑˚
;

1262 
i
 = 0; *
ö±r
 !
SP
 && *ö±∏!
HT
 && *ö±∏!
NL
;)

1264 i‡(
i
 = 
w‹d
 - 1) {

1265 ()
	`add_mesßge
("TooÜongárgumentÅo 'set'!\n");

1268 
w‹d
[
i
++] = *
ö±r
++;

1270 
w‹d
[
i
] = 
EOS
;

1271 
t
 = 
tbl
;Å->
t_°r
;Å++)

1273 if(
	`°rcmp
(
w‹d
,
t
->
t_°r
) == 0)

1275 
P_FLAGS
 = (P_FLAGS & 
t
->
t_™d_mask
Ë|Å->
t_‹_mask
;

1280 i‡(
	`°rcmp
(
w‹d
, "save") == 0)

1282 
svÆue
 *
ªt
;

1283 
	`push_obje˘
(
comm™d_givî
);

1285 
	`push_numbî
–
P_SHIFTWIDTH
 | 
P_FLAGS
 );

1286 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_SAVE_ED_SETUP
,2);

1287 i‡–
ªt
 &&Ñë->
ty≥
 =
T_NUMBER
 &&Ñë->
u
.
numbî
 > 0 )

1290 i‡(
	`°rcmp
(
w‹d
, "shiftwidth") == 0)

1292 
Skù_Whôe_S∑˚
;

1293 i‡–
	`isdigô
(*
ö±r
) )

1295 
P_SHIFTWIDTH
 = *
ö±r
-'0';

1299  
SET_FAIL
;

1300 
	}
}

1302 #i‚de‡
ªlök


1304 
	$ªlök
(
LINE
 *
a
, LINE *
x
, LINE *
y
, LINE *
b
)

1306 
x
->
l_¥ev
 = 
a
;

1307 
y
->
l_√xt
 = 
b
;

1308 
	}
}

1312 
	$£t_ed_buf
()

1314 
	`ªlök
(&
P_LINE0
, &P_LINE0, &P_LINE0, &P_LINE0);

1315 
P_CURLN
 = 
P_LASTLN
 = 0;

1316 
P_CURPTR
 = &
P_LINE0
;

1317 
	}
}

1323 
	$sub°
(
ªgexp
 *
∑t
, *
sub
, 
gÊg
, 
pÊag
)

1325 
nchngd
 = 0;

1326 *
txçå
;

1327 *
√w
, *
ﬁd
, 
buf
[
MAXLINE
];

1328 
•a˚
;

1329 
°ûl_ru¬ög
 = 1;

1330 
LINE
 *
œ°löe
 = 
	`gë±r
–
P_LINE2
 );

1332 if(
P_LINE1
 <= 0)

1333 –
SUB_FAIL
 );

1334 
nchngd
 = 0;

1336  
	`£tCurLn
–
	`¥ev 
–
P_LINE1
 ) ); 
°ûl_ru¬ög
; )

1338 
	`√xtCurLn
();

1339 
√w
 = 
buf
;

1340 
•a˚
 = 
MAXLINE
;

1341 i‡–
P_CURPTR
 =
œ°löe
 )

1342 
°ûl_ru¬ög
 = 0;

1343 i‡–
	`ªgexec
–
∑t
, 
txçå
 = 
	`gëtxé
–
P_CURPTR
 ) ) )

1348 
size_t
 
diff
 = 
∑t
->
°¨ç
[0] - 
txçå
;

1350 i‡–(
•a˚
-=
diff
) < 0 )

1351  
SUB_FAIL
;

1352 ()
	`°∫˝y
–
√w
, 
txçå
, 
diff
 );

1353 
√w
 +
diff
;

1355 
ﬁd
 = 
√w
;

1356 
√w
 = 
	`ªgsub
–
∑t
, 
sub
,Çew, 
•a˚
);

1357 i‡(!
√w
 || (
•a˚
-√w-
ﬁd
) < 0)

1358  
SUB_FAIL
;

1359 i‡(
txçå
 =
∑t
->
ídp
[0])

1362 i‡–!*
txçå
 ) ;

1363 i‡(--
•a˚
 < 0Ë 
SUB_FAIL
;

1364 *
√w
++ = *
txçå
++;

1367 
txçå
 = 
∑t
->
ídp
[0];

1369  
gÊg
 && !
∑t
->
ªg™ch
 && 
	`ªgexec
–∑t, 
txçå
 ));

1375 i‡–(
•a˚
 -
	`°æí
(
txçå
) + 1 ) < 0 )

1376  
SUB_FAIL
;

1377 ()
	`°r˝y
(
√w
, 
txçå
);

1378 ()
	`dñ
(
P_CURLN
, P_CURLN);

1379 if–
	`ös
(
buf
) < 0 )

1380  
MEM_FAIL
;

1381 
nchngd
++;

1382 if(
pÊag
)

1383 ()
	`d›∫t
(
P_CURLN
, P_CURLN);

1386  (–
nchngd
 =0 && !
gÊg
 ) ? 
SUB_FAIL
 :Çchngd);

1387 
	}
}

1389 #ifde‡
ED_INDENT


1393 
	glöío
, 
	gîrs
;

1394 
	gshi
;

1395 
	gfuŒ_shi·
, 
	gsmÆl_shi·
;

1398 
	$shi·
(*
ãxt
)

1400 
idx
;

1405 
idx
 = 0;

1406 *
ãxt
 == ' ' || *text == '\t')

1408 i‡(*
ãxt
++ == ' ')

1409 
idx
++;

1411 
idx
 = (idx + 8) & ~7;

1417 i‡(*
ãxt
 != '\0')

1419 
idx
 +
shi
;

1420 i‡(
idx
 < 
MAXLINE
)

1422 
buf„r
[
MAXLINE
];

1423 *
p
;

1425 
p
 = 
buf„r
;

1429 i‡(
P_TABINDENT
)

1430 
idx
 >= 8)

1432 *
p
++ = '\t';

1433 
idx
 -= 8;

1435 
idx
 > 0)

1437 *
p
++ = ' ';

1438 
idx
--;

1440 i‡(
p
 - 
buf„r
 + 
	`°æí
(
ãxt
Ë< 
MAXLINE
)

1442 ()
	`°r˝y
(
p
, 
ãxt
);

1443 ()
	`dñ
(
löío
,Üineno);

1444 ()
	`ös
(
buf„r
);

1448 ()
	`add_mesßge
("Resu… o‡shi· would bêtoÿl⁄g,Üöê%d\n", 
löío
);

1449 
îrs
++;

1451 
	}
}

1453 
	#STACKSZ
 1024

	)

1458 
	#SEMICOLON
 0

	)

1459 
	#LBRACKET
 1

	)

1460 
	#RBRACKET
 2

	)

1461 
	#LOPERATOR
 3

	)

1462 
	#ROPERATOR
 4

	)

1463 
	#LHOOK
 5

	)

1464 
	#LHOOK2
 6

	)

1465 
	#RHOOK
 7

	)

1466 
	#TOKEN
 8

	)

1467 
	#ELSE
 9

	)

1468 
	#IF
 10

	)

1469 
	#FOR
 11

	)

1470 
	#WHILE
 12

	)

1471 
	#DO
 13

	)

1472 
	#XEOT
 14

	)

1474 
	sµs_°ack
 {

1475 *
	m°ack
, *
	m°ackbŸ
;

1476 *
	möd
, *
	mödbŸ
;

1477 
µs_°ack
 *
	mœ°
;

1478 } *
	gµs
;

1480 *
	g°ack
, *
	g°ackbŸ
;

1481 *
	göd
, *
	gödbŸ
;

1482 
	gquŸe
;

1483 
	gö_µc⁄åﬁ
, 
	gö_commít
, 
	ga·î_keyw‹d
;

1486 
	$ödít
(*
buf
)

1490 
f
[] = { 7, 1, 7, 1, 2, 1, 1, 6, 4, 2, 6, 7, 7, 2, 0, };

1491 
g
[] = { 2, 2, 1, 7, 1, 5, 5, 1, 3, 6, 2, 2, 2, 2, 0, };

1492 
ãxt
[
MAXLINE
], 
idít
[MAXLINE];

1493 *
p
, *
i•
;

1494 *
ù
;

1495 
ödít_ödex
;

1496 
t›
, 
tokí
;

1497 *
°¨t
;

1498 
do_ödít
;

1506 ()
	`°r˝y
(
ãxt
, 
buf
);

1508 
do_ödít
 = 
FALSE
;

1509 
ödít_ödex
 = 0;

1510 
p
 = 
ãxt
;

1515 i‡(
quŸe
 != '\0')

1516 
shi
 = 0;

1517 i‡((
ö_µc⁄åﬁ
 || *
p
 == '#') &&Ö[1] != '\'')

1519 i‡(*
p
 == '#')

1524 
°¨t
 = 
p
; 
	`is•a˚
(*++start); )

1526 i‡(
	`°∫cmp
(
°¨t
, "if", 2) == 0)

1528 
µs_°ack
 *
nx
;

1529 
ssz
, 
isz
;

1532 
nx
 = (
µs_°ack
 *)
	`xÆloc
((pps_stack));

1533 
nx
->
°ack
 = stack;

1534 
nx
->
°ackbŸ
 = stackbot;

1535 
nx
->
öd
 = ind;

1536 
nx
->
ödbŸ
 = indbot;

1537 
nx
->
œ°
 = 
µs
;

1538 
µs
 = 
nx
;

1539 
ssz
 = 
°ack
 - 
°ackbŸ
;

1540 
isz
 = 
öd
 - 
ödbŸ
;

1541 
°ackbŸ
 = (*)
	`xÆloc
((Ë* 
STACKSZ
);

1542 #ifde‡
PURIFY


1543 ()
	`mem£t
(
°ackbŸ
, '\0', (Ë* 
STACKSZ
);

1545 
°ack
 = 
°ackbŸ
 + 
ssz
;

1546 
ödbŸ
 = (*)
	`xÆloc
((Ë* 
STACKSZ
);

1547 #ifde‡
PURIFY


1548 ()
	`mem£t
(
ödbŸ
, '\0', (Ë* 
STACKSZ
);

1550 
öd
 = 
ödbŸ
 + 
isz
;

1551 ()
	`mem˝y
(
°ack
, 
nx
->°ack, (
size_t
)(
STACKSZ
 - 
ssz
));

1552 ()
	`mem˝y
(
öd
, 
nx
->öd, (Ë* (
STACKSZ
 - 
isz
));

1554 i‡(
	`°∫cmp
(
°¨t
, "else", 4) == 0)

1556 
µs_°ack
 *
nx
;

1563 
nx
 = 
µs
;

1564 i‡(!
nx
 || !nx->
°ackbŸ
)

1566 ()
	`add_mesßge
("#ñ£ wôhouà#i‡öÜöê%d\n", 
löío
);

1567 
îrs
++;

1570 
	`‰ì
(
°ackbŸ
);

1571 
	`‰ì
(
ödbŸ
);

1572 
°ack
 = 
nx
->stack;

1573 
°ackbŸ
 = 
nx
->stackbot;

1574 
öd
 = 
nx
->ind;

1575 
ödbŸ
 = 
nx
->indbot;

1576 
nx
->
°ackbŸ
 = 0;

1577 
nx
->
ödbŸ
 = 0;

1579 i‡(
	`°∫cmp
(
°¨t
, "endif", 5) == 0)

1581 
µs_°ack
 *
nx
;

1586 
nx
 = 
µs
;

1587 i‡(!
nx
)

1589 ()
	`add_mesßge
("#ídi‡wôhouà#i‡öÜöê%d\n", 
löío
);

1590 
îrs
++;

1593 
	`‰ì
(
nx
->
°ackbŸ
);

1594 
	`‰ì
(
nx
->
ödbŸ
);

1595 
µs
 = 
nx
->
œ°
;

1596 
	`‰ì
(
nx
);

1599 *
p
 != '\0')

1601 i‡(*
p
 == '\\' && *++p == '\0')

1603 
ö_µc⁄åﬁ
 = 
TRUE
;

1606 
p
++;

1608 
ö_µc⁄åﬁ
 = 
FALSE
;

1616 *
p
 == ' ' || *p == '\t')

1618 i‡(*
p
++ == ' ')

1619 
ödít_ödex
++;

1621 
ödít_ödex
 = (indent_index + 8) & ~7;

1623 i‡(*
p
 == '\0')

1625 ()
	`dñ
(
löío
,Üineno);

1626 ()
	`ös
(
p
);

1629 i‡(
ö_commít
)

1630 
	`shi·
(
ãxt
);

1632 
do_ödít
 = 
TRUE
;

1638 
°¨t
 = 
p
;

1639 *
p
 != '\0')

1644 
idít
[0] = '\0';

1645 i‡(
ö_commít
)

1650 *
p
 != '*')

1652 i‡(*
p
 == '\0')

1654 
p
++;

1656 *
p
 == '*')

1657 
p
++;

1658 i‡(*
p
 == '/')

1660 
ö_commít
 = 
FALSE
;

1661 
p
++;

1665 i‡(
quŸe
 != '\0')

1672 i‡(*
p
 =
quŸe
)

1674 
quŸe
 = '\0';

1675 
p
++;

1678 i‡(*
p
 == '\0')

1680 ()
	`add_mesßge
("U¡înö©ed såög o¿löê%d\n", 
löío
);

1681 
îrs
++;

1684 i‡(*
p
 == '\\' && *++p == '\0')

1686 
p
++;

1688 
tokí
 = 
TOKEN
;

1693 *
p
++)

1700 i‡((
	`iß um
(*
p
) || *p == '_') &&Ö[1] &&Ö[1] != '\'')

1703 ++
p
;

1704 
	`iß um
(*
p
) || *p == '_');

1705 
tokí
 = 
TOKEN
;

1708 i‡(*
p
 == '(' &&Ö[1] == '{')

1713 
tokí
 = 
TOKEN
;

1718 
quŸe
 = 
p
[-1];

1722 i‡(*
p
 == '*')

1724 
ö_commít
 = 
TRUE
;

1725 i‡(
do_ödít
)

1728 
shi
 = ()(*
öd
 - 
ödít_ödex
);

1729 
	`shi·
(
ãxt
);

1730 
do_ödít
 = 
FALSE
;

1734 *
q
;

1735 
ödex2
;

1742 
ödex2
 = *
öd
;

1743 
q
 = 
°¨t
; q < 
p
 - 1;)

1745 i‡(*
q
++ == '\t')

1747 
ödít_ödex
 = (indent_index + 8) & ~7;

1748 
ödex2
 = (index2 + 8) & ~7;

1752 
ödít_ödex
++;

1753 
ödex2
++;

1756 
shi
 = ()(
ödex2
 - 
ödít_ödex
);

1758 
p
++;

1761 i‡(*
p
 == '/')

1762 
p
 = 
	`°rchr
(p, '\0');

1763 
tokí
 = 
TOKEN
;

1767 
tokí
 = 
LBRACKET
;

1771 i‡(
a·î_keyw‹d
)

1779 
tokí
 = 
LOPERATOR
;

1782 i‡(*
p
 == '{' || *p == '[')

1784 
p
++;

1785 
tokí
 = 
LHOOK2
;

1790 
tokí
 = 
LHOOK
;

1794 i‡(*
p
 != ')')

1796 
tokí
 = 
RBRACKET
;

1800 
p
++;

1801 
tokí
 = 
RHOOK
;

1804 i‡(*
p
 == ')' &&

1805 (*
°ack
 =
LHOOK2
 ||

1806 (*
°ack
 !
XEOT
 &&

1807 (
°ack
[1] =
LHOOK2
 ||

1808 (
°ack
[1] =
ROPERATOR
 && sèck[2] =
LHOOK2
)))))

1809 
p
++;

1812 
tokí
 = 
RHOOK
;

1816 
tokí
 = 
SEMICOLON
;

1820 i‡(
	`ißÕha
(*--
p
) || *p == '_')

1822 *
q
;

1827 
q
 = 
idít
;

1829 *
q
++ = *
p
++;

1830 
	`iß um
(*
p
) || *p == '_');

1831 *
q
 = '\0';

1833 i‡(
	`°rcmp
(
idít
, "if" ) =0Ë
tokí
 = 
IF
;

1834 i‡(
	`°rcmp
(
idít
, "ñ£" ) =0Ë
tokí
 = 
ELSE
;

1835 i‡(
	`°rcmp
(
idít
, "f‹" ) =0Ë
tokí
 = 
FOR
;

1836 i‡(
	`°rcmp
(
idít
, "whûe"Ë=0Ë
tokí
 = 
WHILE
;

1837 i‡(
	`°rcmp
(
idít
, "do" ) =0Ë
tokí
 = 
DO
;

1838 
tokí
 = 
TOKEN
;

1845 
p
++;

1846 
tokí
 = 
TOKEN
;

1853 
i•
 = 
°ack
;

1854 
ù
 = 
öd
;

1857 
t›
 = *
i•
;

1859 i‡(
t›
 =
LOPERATOR
 && 
tokí
 =
RHOOK
)

1860 
tokí
 = 
ROPERATOR
;

1862 i‡(
f
[
t›
] <
g
[
tokí
])

1864 
i
;

1866 i‡(
i•
 =
°ackbŸ
)

1871 
	`îr‹
("NestingÅoo deep inÜine %d\n");

1877 
i
 = *
ù
;

1881 i‡((
tokí
 =
LBRACKET
 &&

1882 (*
i•
 =
ROPERATOR
 || *i• =
ELSE
 || *i• =
DO
)) ||

1883 
tokí
 =
RBRACKET
 ||

1884 (
tokí
 =
IF
 && *
i•
 =
ELSE
))

1889 
i
 -
fuŒ_shi·
;

1891 i‡(
tokí
 =
RHOOK
 ||Åokí =
ROPERATOR
)

1892 
i
 -
smÆl_shi·
;

1897 i‡(
do_ödít
)

1899 
shi
 = ()(
i
 - 
ödít_ödex
);

1903 i‡(
tokí
 =
TOKEN
 && *
i•
 =
LBRACKET
 &&

1904 (
	`°rcmp
(
idít
, "case") == 0 ||

1905 
	`°rcmp
(
idít
, "default") == 0))

1906 
shi
 -
fuŒ_shi·
;

1907 
	`shi·
(
ãxt
);

1908 
do_ödít
 = 
FALSE
;

1913 
tokí
)

1915 
LBRACKET
:

1916 
ROPERATOR
:

1917 
ELSE
:

1918 
DO
:

1922 
i
 +
fuŒ_shi·
;

1924 
LOPERATOR
:

1925 
LHOOK
:

1926 
LHOOK2
:

1930 
i
 +
smÆl_shi·
;

1932 
SEMICOLON
:

1936 i‡(*
i•
 =
ROPERATOR
 || *i• =
ELSE
)

1937 
i
 -
fuŒ_shi·
;

1941 *--
i•
 = 
tokí
;

1942 *--
ù
 = 
i
;

1951 
t›
 = *
i•
++;

1952 
ù
++;

1954 
f
[()*
i•
] >
g
[
t›
]);

1956 
°ack
 = 
i•
;

1957 
öd
 = 
ù
;

1958 
a·î_keyw‹d
 = (
tokí
 >
IF
);

1960 
	}
}

1963 
	$˛ón_µs_°ack
()

1965 
µs_°ack
 *
nx
;

1966 (
nx
 = 
µs
Ë!
NULL
)

1968 
µs
 = 
nx
->
œ°
;

1969 
	`‰ì
(
nx
->
°ackbŸ
);

1970 
	`‰ì
(
nx
->
ödbŸ
);

1971 
	`‰ì
(
nx
);

1973 
	}
}

1976 
	$ödít_code
()

1981 
°ackbŸ
 = (*)
	`xÆloc
((Ë* 
STACKSZ
);

1982 
ödbŸ
 = (*)
	`xÆloc
((Ë* 
STACKSZ
);

1983 #ifde‡
PURIFY


1984 ()
	`mem£t
(
°ackbŸ
, '\0', (Ë* 
STACKSZ
);

1985 ()
	`mem£t
(
ödbŸ
, '\0', (Ë* 
STACKSZ
);

1987 
°ack
 = 
°ackbŸ
 + 
STACKSZ
 - 1;

1988 *
°ack
 = 
XEOT
;

1989 
öd
 = 
ödbŸ
 + 
STACKSZ
 - 1;

1990 *
öd
 = 0;

1991 
µs
 = 0;

1993 
quŸe
 = '\0';

1994 
ö_µc⁄åﬁ
 = 
FALSE
;

1995 
ö_commít
 = 
FALSE
;

1997 
P_FCHANGED
 = 
TRUE
;

1998 
îrs
 = 0;

1999 
fuŒ_shi·
 = 
P_SHIFTWIDTH
;

2000 
smÆl_shi·
 = 
fuŒ_shi·
 / 2;

2002 
P_FCHANGED
 = 
TRUE
;

2003 
löío
 = 1;Üöíÿ<
P_LASTLN
;Üineno++)

2005 
	`£tCurLn
(
löío
);

2006 
	`ödít
(
	`gëtxé
(
P_CURPTR
));

2007 i‡(
îrs
 != 0)

2009 
	`˛ón_µs_°ack
();

2010  
ERR
;

2013 
	`˛ón_µs_°ack
();

2015 
	}
}

2024 
	$docmd
(
glob
)

2026 
rhs
[
MAXPAT
];

2027 
ªgexp
 *
sub∑t
;

2028 
c
, 
îr
, 
löe3
;

2029 
≠Êg
, 
pÊag
, 
gÊag
;

2030 
nchng
;

2031 *
Âå
;

2033 
pÊag
 = 
FALSE
;

2034 
Skù_Whôe_S∑˚
;

2036 
c
 = *
ö±r
++;

2037 
c
) {

2038 
NL
:

2039 if–
P_NLINES
 =0 && (
P_LINE2
 = 
	`√xén
(
P_CURLN
)) == 0 )

2040 (
ERR
);

2041 
	`£tCurLn
–
P_LINE2
 );

2045 ()
	`add_mesßge
("%d\n",
P_LINE2
);

2051 
P_CUR_AUTOIND
 = 
c
=='a' ? 
P_AUTOINDFLG
 : !P_AUTOINDFLG;

2052 if(*
ö±r
 !
NL
 || 
P_NLINES
 > 1)

2053 (
ERR
);

2055 i‡–
P_CUR_AUTOIND
 ) 
	`cou¡_bœnks
(
P_LINE1
);

2056 if(
	`≠≥nd
(
P_LINE1
, 
glob
) < 0)

2057 (
ERR
);

2058 
P_FCHANGED
 = 
TRUE
;

2062 if(*
ö±r
 !
NL
)

2063 (
ERR
);

2065 if(
	`deÊt
(
P_CURLN
, P_CURLN) < 0)

2066 (
ERR
);

2068 
P_CUR_AUTOIND
 = 
P_AUTOINDFLG
;

2069 i‡–
P_AUTOINDFLG
 ) 
	`cou¡_bœnks
(
P_LINE1
);

2070 if(
	`dñ
(
P_LINE1
, 
P_LINE2
) < 0)

2071 (
ERR
);

2072 if(
	`≠≥nd
(
P_CURLN
, 
glob
) < 0)

2073 (
ERR
);

2074 
P_FCHANGED
 = 
TRUE
;

2078 i‡(*
ö±r
 == 'p') {

2079 
ö±r
++;

2080 
pÊag
++;

2083 if(*
ö±r
 !
NL
)

2084 (
ERR
);

2086 if(
	`deÊt
(
P_CURLN
, P_CURLN) < 0)

2087 (
ERR
);

2089 if(
	`dñ
(
P_LINE1
, 
P_LINE2
) < 0)

2090 (
ERR
);

2091 if(
	`√xén
(
P_CURLN
) != 0)

2092 
	`√xtCurLn
();

2093 
P_FCHANGED
 = 
TRUE
;

2094 i‡(
pÊag
 && 
	`d›∫t
(
P_CURLN
, P_CURLN) < 0)

2095 (
ERR
);

2099 if(
P_NLINES
 > 0)

2100 (
ERR
);

2101 if(
P_FCHANGED
)

2102  
CHANGED
;

2105 if(
P_NLINES
 > 0)

2106 (
ERR
);

2108 if(*
ö±r
 !' ' && *ö±∏!
HT
 && *ö±∏!
NL
)

2109 (
ERR
);

2111 if((
Âå
 = 
	`gë‚
(0)Ë=
NULL
)

2112 (
ERR
);

2114 ()
	`˛rbuf
();

2115 ()
	`d‹ód
(0, 
Âå
);

2117 ()
	`°r˝y
(
P_FNAME
, 
Âå
);

2118 
P_FCHANGED
 = 
FALSE
;

2122 if(
P_NLINES
 > 0)

2123 (
ERR
);

2125 if(*
ö±r
 !' ' && *ö±∏!
HT
 && *ö±∏!
NL
)

2126 (
ERR
);

2128 
Âå
 = 
	`gë‚
(0);

2130 i‡(
P_NOFNAME
)

2131 ()
	`add_mesßge
("%s\n", 
P_FNAME
);

2133 if(
Âå
 =
NULL
Ë(
ERR
);

2134 ()
	`°r˝y
(
P_FNAME
, 
Âå
);

2140 if(*
ö±r
 !
NL
 || 
P_NLINES
 > 1)

2141 (
ERR
);

2143 
P_CUR_AUTOIND
 = 
P_AUTOINDFLG
;

2144 i‡–
P_AUTOINDFLG
 ) 
	`cou¡_bœnks
(
P_LINE1
);

2145 if(
	`≠≥nd
(
	`¥ev 
(
P_LINE1
), 
glob
) < 0)

2146 (
ERR
);

2147 
P_FCHANGED
 = 
TRUE
;

2151 i‡(*
ö±r
 == 'p')

2153 
ö±r
++;

2154 
pÊag
++;

2156 i‡(*
ö±r
 !
NL
 || 
	`deÊt
(
P_CURLN
, P_CURLN+1)<0)

2157 (
ERR
);

2158 i‡(
	`joö
(
P_LINE1
, 
P_LINE2
) < 0)

2159 (
ERR
);

2160 i‡(
pÊag
 || 
P_PFLG
)

2161 i‡(
	`d›∫t
(
P_CURLN
, P_CURLN) < 0)

2162 (
ERR
);

2166 
Skù_Whôe_S∑˚
;

2168 i‡(*
ö±r
 < 'a' || *inptr > 'z')

2169  
ERR
;

2170 
c
*
ö±r
++;

2172 if(*
ö±r
 !' ' && *ö±∏!
HT
 && *ö±∏!
NL
)

2173 (
ERR
);

2175 
P_MARK
[
c
-'a'] = 
P_LINE1
;

2179 if(*
ö±r
 !
NL
)

2180 (
ERR
);

2181 if(
	`deÊt
(
P_CURLN
,P_CURLN) < 0)

2182 (
ERR
);

2183 i‡(
	`dﬁ°
(
P_LINE1
,
P_LINE2
) < 0)

2184 (
ERR
);

2188 if((
löe3
 = 
	`gë⁄e
()) < 0)

2189 (
ERR
);

2190 if(
	`deÊt
(
P_CURLN
,P_CURLN) < 0)

2191 (
ERR
);

2192 if(
	`moveblock
(
löe3
) < 0)

2193 (
ERR
);

2194 
P_FCHANGED
 = 
TRUE
;

2197 if(*
ö±r
 !
NL
)

2198 (
ERR
);

2199 
P_FLAGS
 ^
NFLG_MASK
;

2200 
P_DIAG
=!P_DIAG;

2201 ()
	`add_mesßge
("number %s,Üist %s\n",

2202 
P_NFLG
?"⁄":"off", 
P_LFLG
?"on":"off");

2205 #ifde‡
ED_INDENT


2207 if(
P_NLINES
 > 0)

2208 (
ERR
);

2209 if(*
ö±r
 !
NL
)

2210 (
ERR
);

2211 ()
	`add_mesßge
("IndentingÉntire code...\n");

2212 i‡(
	`ödít_code
())

2213 ()
	`add_mesßge
("Indention halted.\n");

2215 ()
	`add_mesßge
("Done indenting.\n");

2221 
	`¥öt_hñp
(*(
ö±r
++));

2226 if(*
ö±r
 !
NL
)

2227 (
ERR
);

2228 if(
	`deÊt
(
P_CURLN
,P_CURLN) < 0)

2229 (
ERR
);

2230 if(
	`d›∫t
(
P_LINE1
,
P_LINE2
) < 0)

2231 (
ERR
);

2235 i‡(
P_FCHANGED
)

2236  
CHANGED
;

2239 ()
	`˛rbuf
();

2240 if(*
ö±r
 =
NL
 && 
P_NLINES
 =0 && !
glob
)

2241 (
EOF
);

2243 (
ERR
);

2246 if(
P_NLINES
 > 1)

2247 (
ERR
);

2249 if(
P_NLINES
 == 0)

2250 
P_LINE2
 = 
P_LASTLN
;

2253 if(*
ö±r
 !' ' && *ö±∏!
HT
 && *ö±∏!
NL
)

2254 (
ERR
);

2256 if((
Âå
 = 
	`gë‚
(0)Ë=
NULL
)

2257 (
ERR
);

2259 if((
îr
 = 
	`d‹ód
(
P_LINE2
, 
Âå
)) < 0)

2260 (
îr
);

2261 
P_FCHANGED
 = 
TRUE
;

2265 if(*
ö±r
 == 'e')

2266 (
	`£t
());

2267 
Skù_Whôe_S∑˚
;

2268 if((
sub∑t
 = 
	`›ç©
()Ë=
NULL
)

2269 (
ERR
);

2270 if((
gÊag
 = 
	`gërhs
(
rhs
)) < 0)

2271 (
ERR
);

2272 if(*
ö±r
 == 'p')

2273 
pÊag
++;

2274 if(
	`deÊt
(
P_CURLN
, P_CURLN) < 0)

2275 (
ERR
);

2276 i‡((
nchng
 = 
	`sub°
(
sub∑t
, 
rhs
, 
gÊag
, 
pÊag
 || 
P_PFLG
)) < 0)

2277 (
ERR
);

2278 if(
nchng
)

2279 
P_FCHANGED
 = 
TRUE
;

2283 if((
löe3
 = 
	`gë⁄e
()) < 0)

2284 (
ERR
);

2285 if(
	`deÊt
(
P_CURLN
,P_CURLN) < 0)

2286 (
ERR
);

2287 if(
	`å™s„r
(
löe3
) < 0)

2288 (
ERR
);

2289 
P_FCHANGED
 = 
TRUE
;

2294 
≠Êg
 = (
c
=='W');

2296 if(*
ö±r
 !' ' && *ö±∏!
HT
 && *ö±∏!
NL
)

2297 (
ERR
);

2299 if((
Âå
 = 
	`gë‚
(1)Ë=
NULL
)

2300 (
ERR
);

2302 if(
	`deÊt
(1, 
P_LASTLN
) < 0)

2303 (
ERR
);

2304 if(
	`dowrôe
(
P_LINE1
, 
P_LINE2
, 
Âå
, 
≠Êg
) < 0)

2305 (
ERR
);

2306 
P_FCHANGED
 = 
FALSE
;

2310 if(*
ö±r
 =
NL
 && 
P_NLINES
 =0 && !
glob
) {

2311 if((
Âå
 = 
	`gë‚
(1)Ë=
NULL
)

2312 (
ERR
);

2313 if(
	`dowrôe
(1, 
P_LASTLN
, 
Âå
, 0) >= 0)

2315 ()
	`˛rbuf
();

2316 (
EOF
);

2319 (
ERR
);

2322 if(
	`deÊt
(
P_CURLN
,P_CURLN) < 0)

2323 (
ERR
);

2325 *
ö±r
) {

2327 if(
	`d›∫t
(
P_LINE1
-21,P_LINE1) < 0)

2328 (
ERR
);

2332 if(
	`d›∫t
(
P_LINE1
-11,P_LINE1+10) < 0)

2333 (
ERR
);

2338 if(
	`d›∫t
(
P_LINE1
,P_LINE1+21) < 0)

2339 (
ERR
);

2345 if(
	`deÊt
(
P_CURLN
,P_CURLN) < 0)

2346 (
ERR
);

2348 *
ö±r
) {

2350 if(
	`d›∫t
(
P_LINE1
-41,P_LINE1) < 0)

2351 (
ERR
);

2355 if(
	`d›∫t
(
P_LINE1
-21,P_LINE1+20) < 0)

2356 (
ERR
);

2361 if(
	`d›∫t
(
P_LINE1
,P_LINE1+41) < 0)

2362 (
ERR
);

2367 (
ERR
);

2371 
	}
}

2376 
	$doglob
()

2378 
lö
, 
°©us
;

2379 *
cmd
;

2380 
LINE
 *
±r
;

2382 
cmd
 = 
ö±r
;

2386 
±r
 = 
	`gë±r
(1);

2387 
lö
=1;Üö<=
P_LASTLN
;Üin++)

2389 i‡(
±r
->
l_°©
 & 
LGLOB
)

2391 
±r
 = 
	`gë√xçå
(ptr);

2393 i‡(
lö
 > 
P_LASTLN
)

2396 
±r
->
l_°©
 &~
LGLOB
;

2397 
P_CURLN
 = 
lö
; 
P_CURPTR
 = 
±r
;

2398 
ö±r
 = 
cmd
;

2399 if((
°©us
 = 
	`gël°
()) < 0)

2400 (
°©us
);

2401 if((
°©us
 = 
	`docmd
(1)) < 0)

2402 (
°©us
);

2404 (
P_CURLN
);

2405 
	}
}

2417 
	$ed_°¨t
(*
fûe_¨g
, 
˛osuª
 *
exô_func
)

2419 
svÆue
 *
£tup
;

2420 i‡(!
comm™d_givî
->
öãø˘ive
)

2421 
	`îr‹
("TriedÅo startánÉd session onáÇon-interativeÖlayer.\n");

2422 i‡(
ED_BUFFER
)

2423 
	`îr‹
("TriedÅo startánÉd session, whenálreadyáctive.\n");

2425 
ED_BUFFER
 = (
ed_buf„r
 *)
	`xÆloc
( (ed_buffer));

2426 ()
	`mem£t
((*)
comm™d_givî
->
öãø˘ive
->
ed_buf„r
, '\0',

2427  (
ed_buf„r
));

2428 
ED_BUFFER
->
åuncÊg
 = 1;

2429 
ED_BUFFER
->
Êags
 |
EIGHTBIT_MASK
 | 
TABINDENT_MASK
;

2430 
ED_BUFFER
->
shi·width
 = 4;

2432 
	`push_obje˘
(
comm™d_givî
);

2433 
£tup
 = 
	`≠∂y_ma°î_ob
(
M_RETRIEVE_ED_SETUP
,1);

2434 i‡–
£tup
 && sëup->
ty≥
 =
T_NUMBER
 && sëup->
u
.
numbî
 )

2436 
ED_BUFFER
->
Êags
 = 
£tup
->
u
.
numbî
 & 
ALL_FLAGS_MASK
;

2437 
ED_BUFFER
->
shi·width
 = 
£tup
->
u
.
numbî
 & 
SHIFTWIDTH_MASK
;

2439 
ED_BUFFER
->
CurPå
 = &ED_BUFFER->
Löe0
;

2440 
ED_BUFFER
->
exô_func
 =Éxit_func;

2441 
	`£t_ed_buf
();

2449 i‡(
fûe_¨g
 &&

2450 (
fûe_¨g
 = 
	`check_vÆid_∑th
(fûe_¨g, 
comm™d_givî
,

2451 "ed_°¨t", 0)Ë!
NULL
)

2453 i‡(!
	`d‹ód
(0, 
fûe_¨g
))

2454 
	`£tCurLn
( 1 );

2457 
	`push_obje˘
(
comm™d_givî
);

2458 
	`push_°rög
(
fûe_¨g
, 
STRING_MSTRING
);

2459 i‡((
£tup
 = 
	`≠∂y_ma°î_ob
(
M_GET_ED_EMPTY_FILE
,2)Ë!
NULL
)

2461 
i
;

2463 
£tup
->
ty≥
)

2465 
T_POINTER
:

2466 
i
 = 0; i < 
£tup
->
u
.
vec
->
size
; ++i)

2467 i‡(
£tup
->
u
.
vec
->
ôem
[
i
].
ty≥
 =
T_STRING
)

2468 ()
	`ös
(
£tup
->
u
.
vec
->
ôem
[
i
].u.
°rög
);

2470 
T_STRING
:

2471 ()
	`ös
(
£tup
->
u
.
°rög
);

2473 
	`‰ì_svÆue
(
£tup
);

2477 i‡(
fûe_¨g
)

2479 ()
	`°∫˝y
(
P_FNAME
, 
fûe_¨g
, 
MAXFNAME
-1);

2480 
P_FNAME
[
MAXFNAME
-1] = 0;

2483 ()
	`add_mesßge
("No file.\n");

2484 
	`£t_¥om±
(
PROMPT
);

2486 
	}
}

2489 
	$‰ì_ed_buf„r
()

2491 
gdex˚±i⁄
 
ex˚±i⁄_‰ame
;

2492 
˛osuª
 *
fun˘i⁄
;

2493 
evÆ_co°
;

2495 ()
	`˛rbuf
();

2497 
fun˘i⁄
 = 
ED_BUFFER
->
exô_func
;

2498 
	`‰ì
((*)
ED_BUFFER
);

2499 
ED_BUFFER
 = 0;

2500 
	`£t_¥om±
("> ");

2502 i‡(
fun˘i⁄
)

2504 
ex˚±i⁄_‰ame
.
e_ex˚±i⁄
 = 
NULL
;

2505 
ex˚±i⁄_‰ame
.
e_ˇtch
 = 1;

2507 i‡(
	`£tjmp
(
ex˚±i⁄_‰ame
.
e_c⁄ãxt
))

2508 
	`˛ór_°©e
();

2511 
ex˚±i⁄
 = &
ex˚±i⁄_‰ame
;

2512 
evÆ_co°
 = 0;

2514 ()
	`ˇŒ_v¨
(0, 
fun˘i⁄
);

2516 
	`‰ì_˛osuª
(
fun˘i⁄
);

2519 ()
	`add_mesßge
("Exit fromÉd.\n");

2521 
	}
}

2524 
	$ed_cmd
(*
°r
)

2526 
°©us
;

2528 i‡(
P_MORE
)

2530 
	`¥öt_hñp2
();

2533 i‡(
P_APPENDING
)

2535 
	`m‹e_≠≥nd
(
°r
);

2538 i‡(
	`°æí
(
°r
Ë< 
MAXLINE
)

2539 ()
	`°rˇt
(
°r
, "\n");

2541 ()
	`°∫˝y
(
ölö
, 
°r
, 
MAXLINE
 - 1);

2542 
ölö
[
MAXLINE
 - 1] = 0;

2543 
ö±r
 = 
ölö
;

2544 if(
	`gël°
() >= 0) {

2545 if((
°©us
 = 
	`ckglob
()) != 0)

2547 if(
°©us
 >0 && (°©u†
	`doglob
()) >= 0)

2549 
	`£tCurLn
–
°©us
 );

2555 if((
°©us
 = 
	`docmd
(0)) >= 0)

2557 if(
°©us
 == 1)

2558 ()
	`d›∫t
(
P_CURLN
, P_CURLN);

2563 
°©us
 = 
UNSPEC_FAIL
;

2565 
°©us
)

2567 
EOF
:

2568 
	`‰ì_ed_buf„r
();

2570 
FATAL
:

2571 i‡(
ED_BUFFER
->
exô_func
)

2572 
	`‰ì_˛osuª
(
ED_BUFFER
->
exô_func
);

2573 
	`‰ì
((*)
ED_BUFFER
);

2574 
ED_BUFFER
 = 0;

2575 ()
	`add_mesßge
("FATAL ERROR\n");

2576 
	`£t_¥om±
(
PROMPT
);

2578 
CHANGED
:

2579 ()
	`add_mesßge
("File has been changed.\n");

2581 
SET_FAIL
:

2582 ()
	`add_mesßge
("`set' command failed.\n");

2584 
SUB_FAIL
:

2585 ()
	`add_mesßge
("string substitution failed.\n");

2587 
MEM_FAIL
:

2588 ()
	`add_mesßge
("Out of memory:Åext may have beenÜost.\n" );

2591 ()
	`add_mesßge
("Unrecognized or failed command.\n");

2595 
	}
}

2598 
	$ßve_ed_buf„r
()

2600 
svÆue
 *
°mp
;

2601 *
‚ame
;

2603 
	`push_°rög
(
P_FNAME
, 
STRING_SSTRING
);

2604 
°mp
 = 
	`≠∂y_ma°î_ob
(
M_GET_ED_BUFFER_SAVE_FILE_NAME
,1);

2605 i‡(
°mp
) {

2606 i‡(
°mp
->
ty≥
 =
T_STRING
) {

2607 
‚ame
 = 
°mp
->
u
.
°rög
;

2608 i‡(*
‚ame
 == '/') fname++;

2609 ()
	`dowrôe
(1, 
P_LASTLN
, 
‚ame
 , 0);

2612 
	`‰ì_svÆue
(
°mp
);

2614 
	`‰ì_ed_buf„r
();

2615 
	}
}

2618 
	$¥öt_hñp
(
¨g
)

2620 
¨g
)

2622 #ifde‡
ED_INDENT


2624 ()
	`add_mesßge
(" Automatic Indentation (V 1.0)\n");

2625 ()
	`add_mesßge
("------------------------------------\n");

2626 ()
	`add_mesßge
(" by Qixx [Update: 7/10/91]\n");

2627 ()
	`add_mesßge
("\nBy usingÅhe command 'I',áÖrogram isÑun which will\n");

2628 ()
	`add_mesßge
("automatically indentállÜines in your code. AsÅhis is\n");

2629 ()
	`add_mesßge
("being done,ÅheÖrogram willálso search for some basic\n");

2630 ()
	`add_mesßge
("errors (which don't show up good during compiling) suchás\n");

2631 ()
	`add_mesßge
("Unterminated String, Mismatched Bracketsánd Parentheses,\n");

2632 ()
	`add_mesßge
("and indented code isÉasyÅo understandánd debug, since if\n");

2633 ()
	`add_mesßge
("your bracketsáre off --Åhe code will LOOK wrong. Please\n");

2634 ()
	`add_mesßge
("mail meát gaunt@mcs.anl.gov withányÖieces of code which\n");

2635 ()
	`add_mesßge
("don't get indentedÖroperly.\n");

2640 ()
	`add_mesßge
("Command: ^ Usage: ^pattern\n");

2641 ()
	`add_mesßge
("This command is similiarÅo grep, inÅhat it searchesÅhe\n");

2642 ()
	`add_mesßge
("entire file,ÖrintingÉveryÜineÅhat containsÅhe specified\n");

2643 ()
	`add_mesßge
("pattern. To getÅheÜineÇumbers of foundÜines,Åurn onÜine\n");

2644 ()
	`add_mesßge
("numberÖrinting withÅhe 'n' command.\n");

2648 ()
	`add_mesßge
("Command:Ç Usage:Ç\n");

2649 ()
	`add_mesßge
("This commandÅogglesÅhe internal flag which will causeÜine\n");

2650 ()
	`add_mesßge
("numbersÅo beÖrinted wheneveráÜine isÜisted.\n");

2653 ()
	`add_mesßge
("Command:á Usage:á\n");

2654 ()
	`add_mesßge
("Append causesÅheÉditorÅoÉnter input mode, insertingállÅext\n");

2655 ()
	`add_mesßge
("starting AFTERÅhe currentÜine. Useá '.' oná blankÜineÅoÉxit\n");

2656 ()
	`add_mesßge
("this mode.\n");

2659 ()
	`add_mesßge
("Command: A Usage: A\n\
Åhe 'a' command, but uses inverseáutoindent mode.\n");

2663 ()
	`add_mesßge
("Command: i Usage: i\n");

2664 ()
	`add_mesßge
("Insert causesÅheÉditorÅoÉnter input mode, insertingállÅext\n");

2665 ()
	`add_mesßge
("starting BEFOREÅhe currentÜine. Useá '.' oná blankÜineÅoÉxit\n");

2666 ()
	`add_mesßge
("this mode.\n");

2669 ()
	`add_mesßge
("Command: c Usage: c\n");

2670 ()
	`add_mesßge
("Change command causesÅhe currentÜineÅo be wiped from memory.\n");

2671 ()
	`add_mesßge
("TheÉditorÉnters input modeándállÅext is inserted whereÅheÖrevious\n");

2672 ()
	`add_mesßge
("lineÉxisted.\n");

2675 ()
	`add_mesßge
("Command: d Usage: d or [range]d\n");

2676 ()
	`add_mesßge
("DeletesÅhe currentÜine unlessÖreceeded witháÑange ofÜines,\n");

2677 ()
	`add_mesßge
("thenÅheÉntireÑange will be deleted.\n");

2680 ()
	`add_mesßge
("Commmand:É Usage:É filename\n");

2681 ()
	`add_mesßge
("CausesÅhe current fileÅo be wiped from memory,ándÅheÇew file\n");

2682 ()
	`add_mesßge
("to beÜoaded in.\n");

2685 ()
	`add_mesßge
("Commmand: E Usage: E filename\n");

2686 ()
	`add_mesßge
("CausesÅhe current fileÅo be wiped from memory,ándÅheÇew file\n");

2687 ()
	`add_mesßge
("to beÜoaded in. Different from 'e' inÅhe factÅhat it will wipe\n");

2688 ()
	`add_mesßge
("the current fileÉven ifÅhereáre unsaved modifications.\n");

2691 ()
	`add_mesßge
("Command: f Usage: f or f filename\n");

2692 ()
	`add_mesßge
("Display or setÅhe current filename. If filename is givenás \nanárgument,Åhe file (f) command changesÅhe current filenameÅo\nfilename; otherwise, itÖrintsÅhe current filename.\n");

2695 ()
	`add_mesßge
("Command: g Usage: g/re/p\n");

2696 ()
	`add_mesßge
("Search inállÜines forÉxpression 're',ándÖrint\n");

2697 ()
	`add_mesßge
("every match. Command 'l' canálso be given\n");

2698 ()
	`add_mesßge
("Unlike in unixÉd, you canálso supplyáÑange ofÜines\n");

2699 ()
	`add_mesßge
("to search in\n");

2700 ()
	`add_mesßge
("Compare with command 'v'.\n");

2703 ()
	`add_mesßge
("Command: h Usage: h or hc (where c isá command)\n");

2704 ()
	`add_mesßge
("Help filesádded by Qixx.\n");

2707 ()
	`add_mesßge
("Command: j Usage: j or [range]j\n");

2708 ()
	`add_mesßge
("Join Lines. RemoveÅhe NEWLINE character from betweenÅheÅwo\naddressedÜines. The defaultsáreÅhe currentÜineándÅheÜine\nfollowing. IfÉxactly oneáddress is given,Åhis command does\nnothing. The joinedÜine isÅheÑesulting currentÜine.\n");

2711 ()
	`add_mesßge
("Command: k Usage: kc (where c isá character)\n");

2712 ()
	`add_mesßge
("MarkÅheáddressedÜine withÅheÇame c,áÜower-case\nletter. Theáddress-form, 'c,áddressesÅheÜine\nmarked by c. káccepts oneáddress;Åhe default isÅhe\ncurrentÜine. The currentÜine isÜeft unchanged.\n");

2715 ()
	`add_mesßge
("Command:Ü Usage:Ü or [range]l\n");

2716 ()
	`add_mesßge
("ListÅhe currentÜine oráÑange ofÜines inán unambiguous\nway suchÅhatÇon-printing charactersáreÑepresentedás\nsymbols (specifically New-Lines).\n");

2719 ()
	`add_mesßge
("Command: m Usage: mADDRESS or [range]mADDRESS\n");

2720 ()
	`add_mesßge
("MoveÅhe currentÜine (orÑange ofÜines if specified)Åoá\nlocation justáfterÅhe specified ADDRESS. Address 0 isÅhe\nbeginning ofÅhe fileándÅhe default destination isÅhe\ncurrentÜine.\n");

2723 ()
	`add_mesßge
("Command:Ö Usage:Ö or [range]p\n");

2724 ()
	`add_mesßge
("PrintÅhe currentÜine (orÑange ofÜines if specified)ÅoÅhe\nscreen. SeeÅhe command 'n' ifÜineÇumbering is desired.\n");

2727 ()
	`add_mesßge
("Command: q Usage: q\n");

2728 ()
	`add_mesßge
("QuitÅheÉditor. NoteÅhat you can't quitÅhis way ifÅhere\nareány unsaved changes. See 'w' for writing changesÅo file.\n");

2731 ()
	`add_mesßge
("Command: Q Usage: Q\n");

2732 ()
	`add_mesßge
("Force Quit. QuitÅheÉditorÉven ifÅhe buffer contains unsaved\nmodifications.\n");

2735 ()
	`add_mesßge
("Command:Ñ Usage:Ñ filename\n");

2736 ()
	`add_mesßge
("ReadsÅhe given filename intoÅhe current buffer starting\natÅhe currentÜine.\n");

2739 ()
	`add_mesßge
("Command:Å Usage:ÅADDRESS or [range]tADDRESS\n");

2740 ()
	`add_mesßge
("Transposeá copy ofÅhe currentÜine (orÑange ofÜines if specified)\ntoáÜocation justáfterÅhe specified ADDRESS. Address 0 isÅhe\nbeginning ofÅhe fileándÅhe default destination\nisÅhe currentÜine.\n");

2743 ()
	`add_mesßge
("Command: v Usage: v/re/p\n");

2744 ()
	`add_mesßge
("Search inállÜines withoutÉxpression 're',ándÖrint\n");

2745 ()
	`add_mesßge
("every match. Other commandsÅhan 'p' canálso be given\n");

2746 ()
	`add_mesßge
("Compare with command 'g'.\n");

2749 ()
	`add_mesßge
("Command: z Usage: z or z- or z.\n");

2750 ()
	`add_mesßge
("Displays 20Üines startingátÅhe currentÜine.\nIfÅhe command is 'z.'Åhen 20Üinesáre displayed being\ncentered onÅhe currentÜine. The command 'z-' displays\nthe 20Üines beforeÅhe currentÜine.\n");

2753 ()
	`add_mesßge
("Command: Z Usage: Z or Z- or Z.\n");

2754 ()
	`add_mesßge
("Displays 40Üines startingátÅhe currentÜine.\nIfÅhe command is 'Z.'Åhen 40Üinesáre displayed being\ncentered onÅhe currentÜine. The command 'Z-' displays\nthe 40Üines beforeÅhe currentÜine.\n");

2757 ()
	`add_mesßge
("Command: x Usage: x\n");

2758 ()
	`add_mesßge
("Save file underÅhe currentÇame,ándÅhenÉxit fromÉd.\n");

2761 i‡–*
ö±r
=='e' && *(inptr+1)=='t' ) {

2762 ()
	`add_mesßge
("\
árguments: show current settings.\n\
'set save' willÖreserveÅhe current settings for subsequent invocations ofÉd.\n\
:\n\
\n\
 willÖrintÜineÇumbers beforeÖrinting or insertingáÜines\n\
 willÖrint control characters inÖ(rint)ánd z commandÜike inÜ(ist)\n\
 will show currentÜineáfterá single substitution\n\
\n\
 willÖreserve current indentation whileÉnteringÅext.\n\
 ^D or ^KÅo get back one step backÅoÅheÑight.\n\
 willÉxchangeÅhe meaning of \\(ánd (ás wellás \\)ánd )\n\
\n\
 option can be cleared byÖrepending it with 'no' inÅhe set command,É.g.\n\
'setÇolist'ÅoÅurn offÅheÜist option.\n\
\n\
 shiftwidth <digit> will store <digit> inÅhe shiftwidth variable, which\n\
 how much blanksáreÑemoved fromÅhe current indentation when\n\
 ^D or ^K inÅheáutoindent mode.\n");

2789 ()
	`add_mesßge
("SorryÇo help yet forÅhis command. TryágainÜater.\n");

2792 ()
	`add_mesßge
(" Help for Ed (V 2.0)\n");

2793 ()
	`add_mesßge
("---------------------------------\n");

2794 ()
	`add_mesßge
(" by Qixx [Update: 7/10/91]\n");

2795 ()
	`add_mesßge
("\n\nCommands\n--------\n");

2796 ()
	`add_mesßge
("/\tsearch forward forÖattern\n");

2797 ()
	`add_mesßge
("?\tsearch backward foráÖattern\n");

2799 ()
	`add_mesßge
("=\tshow currentÜineÇumber\n");

2800 ()
	`add_mesßge
("a\tappendÅext startingáfterÅhisÜine\n");

2801 ()
	`add_mesßge
("A\tlike 'a' but with inverseáutoindent mode\n"),

2802 ()
	`add_mesßge
("c\tchange currentÜine, query forÑeplacementÅext\n");

2803 ()
	`add_mesßge
("d\tdeleteÜine(s)\n");

2804 ()
	`add_mesßge
("e\treplaceÅhis file withánother file\n");

2805 ()
	`add_mesßge
("E\tsameás 'e' but works if file has been modified\n");

2806 ()
	`add_mesßge
("f\tshow/change current fileÇame\n");

2807 ()
	`add_mesßge
("g\tSearchándÉxecute command onány matchingÜine.\n");

2808 ()
	`add_mesßge
("h\thelp file (displayÅhis message)\n");

2809 ()
	`add_mesßge
("i\tinsertÅext starting beforeÅhisÜine\n");

2810 #ifde‡
ED_INDENT


2811 ()
	`add_mesßge
("I\tindentÅheÉntire code (Qixx version 1.0)\n");

2813 ()
	`add_mesßge
("\n--ReturnÅo continue--");

2814 
P_MORE
=1;

2817 
	}
}

2820 
	$¥öt_hñp2
()

2822 
P_MORE
 = 0;

2823 ()
	`add_mesßge
("j\tjoinÜinesÅogether\n");

2824 ()
	`add_mesßge
("k\tmarkÅhisÜine withá character -ÜaterÑeferencedás 'a\n");

2825 ()
	`add_mesßge
("l\tlineÜine(s) with control characters displayed\n");

2826 ()
	`add_mesßge
("m\tmoveÜine(s)Åo specifiedÜine\n");

2827 ()
	`add_mesßge
("n\ttoggleÜineÇumbering\n");

2828 ()
	`add_mesßge
("p\tprintÜine(s) inÑange\n");

2829 ()
	`add_mesßge
("q\tquitÉditor\n");

2830 ()
	`add_mesßge
("Q\tquitÉditorÉven if file modifiedándÇot saved\n\
\tread file intoÉditorátÉnd of file or behindÅhe givenÜine\n");

2832 ()
	`add_mesßge
("s\tsearchándÑeplace\n");

2833 ()
	`add_mesßge
("set\tquery, change or save option settings\n");

2834 ()
	`add_mesßge
("t\tmove copy ofÜine(s)Åo specifiedÜine\n");

2835 ()
	`add_mesßge
("v\tSearchándÉxecute command onányÇon-matchingÜine.\n");

2836 ()
	`add_mesßge
("x\tsave fileánd quit\n");

2837 ()
	`add_mesßge
("w\twriteÅo current file (or specified file)\n");

2838 ()
	`add_mesßge
("W\tlikeÅhe 'w' command butáppends instead\n");

2839 ()
	`add_mesßge
("z\tdisplay 20Üines,Öossibleárgsáre . + -\n");

2840 ()
	`add_mesßge
("Z\tdisplay 40Üines,Öossibleárgsáre . + -\n");

2841 ()
	`add_mesßge
("\nFor further informationÅype 'hc' where c isÅhe command\nthat help is desired for.\n");

2842 
	}
}

	@exec.h

30 
	~"c⁄fig.h
"

32 
	sªloc


34 *
	m«me
;

35 
	mvÆue
;

36 
	maddªss
;

37 
	mty≥
;

38 
	mmodifõr
;

41 
	scfun_desc


43 
	möh
;

44 
	midx
;

47 
	#R_VAR
 1

	)

48 
	#R_CALL
 2

	)

50 
	sfun˘i⁄
 {

51 *
	m«me
;

53 #i‡
deföed
(
PROFILE_FUNS
Ë&& deföed(
RUSAGE
)

54 
	mtime_•ít
;

55 
	mnum_ˇŒs
;

56 #ifde‡
SOLARIS


57 
	mticks_ˇŒ
;

59 
	m°ime_ˇŒ
;

60 
	mutime_ˇŒ
;

63 
	mhash_idx
;

64 
	mty≥_Êags
;

67 
	moff£t
;

69 
	mnum_loˇl
;

70 
	mnum_¨g
;

73 
	mfú°_deÁu…
;

75 
	sfun˘i⁄_hash
 {

76 *
	m«me
;

77 
	m√xt_hashed_fun˘i⁄
;

78 
	mfunc_ödex
;

81 
	sv¨übÀ
 {

82 *
	m«me
;

83 
	mty≥
;

86 
	söhîô
 {

87 
¥ogøm
 *
	m¥og
;

88 *
	m«me
;

89 
	mv¨übÀ_ödex_off£t
;

92 
	mty≥
;

96 
	s£gmít_desc


98 
	m±r_off£t
;

99 
	msw≠_idx_off£t
;

100 
	msize_off£t
;

101 
	s£˘i⁄_desc


103 
	m£˘i⁄
;

104 
	m±r_off£t
;

105 
	mnum_off£t
;

106 
	mít_size
;

107 } *
	m£˘i⁄s
;

109 
£gmít_desc
 
£gm_desc
[];

111 
	#A_HEADER
 0

	)

112 
	#A_PROGRAM
 1

	)

113 
	#A_FUNCTIONS
 2

	)

114 
	#A_RODATA
 3

	)

115 
	#A_VARIABLES
 4

	)

116 
	#A_LINENUMBERS
 5

	)

117 
	#A_INHERITS
 6

	)

118 
	#A_ARGUMENT_TYPES
 7

	)

119 
	#A_ARGUMENT_INDEX
 8

	)

120 
	#A_INCLUDES
 9

	)

121 
	#A_RELOC
 10

	)

122 
	#A_FUNC_HASH
 11

	)

123 
	#A_CFUN
 12

	)

124 
	#NUMPAREAS
 13

	)

126 
	#A_CASE_NUMBERS
 (
NUMPAREAS
 + 0)

	)

127 
	#A_CASE_STRINGS
 (
NUMPAREAS
 + 1)

	)

128 
	#A_CASE_LABELS
 (
NUMPAREAS
 + 2)

	)

129 
	#A_STRTAB
 (
NUMPAREAS
 + 3)

	)

130 
	#A_LABELS
 (
NUMPAREAS
 + 4)

	)

131 
	#A_JUMPS
 (
NUMPAREAS
 + 5)

	)

132 
	#NUMAREAS
 (
NUMPAREAS
 + 6)

	)

133 
	#A_NUM
 
NUMAREAS


	)

135 
	#S_HDR
 0

	)

136 
	#S_EXEQ
 1

	)

137 
	#S_DBG
 2

	)

138 
	#S_NULL
 3

	)

139 
	#S_NUM
 4

	)

141 
	s¥ogøm
 {

142 *
	m¥ogøm
;

143 *
	m«me
;

144 
¥ogøm
 *
	m√xt_Æl
, *
	m¥ev_Æl
;

146 *
	mlöe_numbîs
;

150 
fun˘i⁄
 *
	mfun˘i⁄s
;

151 
fun˘i⁄_hash
 *
	mfunc_hash
;

152 *
	mrod©a
;

153 
v¨übÀ
 *
	mv¨übÀ_«mes
;

154 
öhîô
 *
	möhîô
;

155 
cfun_desc
 *
	mcfuns
;

166 *
	m¨gumít_ty≥s
;

167 
	#INDEX_START_NONE
 65535

	)

168 *
	mty≥_°¨t
;

170 *
	mö˛ude_fûes
;

172 #i‡
deföed
(
RUSAGE
Ë&& deföed(
PROFILE_OBJS
)

173 
	m˝u
;

175 
	mªf
;

176 
	msw≠_num
;

177 
	mtime_of_ªf
;

179 #ifde‡
DEBUG


180 
	mexåa_ªf
;

182 
	mtŸÆ_size
;

183 
	mdebug_size
;

184 
	mexec_size
;

186 
	mlﬂd_time
;

187 
	mid_numbî
;

190 
	msw≠_löío_ödex
;

191 
	mmod_time
;

194 
	möv¨ü¡
;

195 
	mdt‹_ödex
;

196 
	m˘‹_ödex
;

197 
	mdebug_Êags
;

202 
	m¥ogøm_size
;

203 
	mnum_fun˘i⁄s
;

204 
	mrod©a_size
;

205 
	mnum_v¨übÀs
;

206 
	mnum_öhîôed
;

208 
	msizeof_ö˛ude_fûes
;

209 
	msizeof_löe_numbîs
;

210 
	msizeof_¨gumít_ty≥s
;

211 
	mÊags
;

212 
	#PRAGMA_NO_CLONE
 1

	)

213 
	#PRAGMA_NO_INHERIT
 2

	)

214 
	#PRAGMA_NO_SHADOW
 4

	)

215 
	#PRAGMA_RESIDENT
 8

	)

218 
¥ogøm
 *
cuºít_¥og
;

219 
öh_off£t
;

227 
	#TYPE_UNKNOWN
 0

	)

228 
	#TYPE_NUMBER
 1

	)

229 
	#TYPE_STRING
 2

	)

230 
	#TYPE_VOID
 3

	)

231 
	#TYPE_OBJECT
 4

	)

232 
	#TYPE_ANY
 5

	)

233 
	#TYPE_MAPPING
 6

	)

234 
	#TYPE_FLOAT
 7

	)

235 
	#TYPE_FUNCTION
 8

	)

236 
	#TYPE_NONE
 9

	)

238 
	#TYPE_LVALUE
 0x10

	)

242 
	#TYPE_MOD_STATIC
 0x0100

	)

243 
	#TYPE_MOD_NO_MASK
 0x0200

	)

244 
	#TYPE_MOD_POINTER
 0x0400

	)

245 
	#TYPE_MOD_PRIVATE
 0x0800

	)

246 
	#TYPE_MOD_PUBLIC
 0x1000

	)

247 
	#TYPE_MOD_VARARGS
 0x2000

	)

248 
	#TYPE_MOD_TRUE_VARARGS
 0x4000

	)

250 
	#TYPE_MOD_SECOND
 0x0080

	)

264 
	#NAME_STRICT_TYPES
 0x10

	)

265 
	#NAME_PROTOTYPE
 0x20

	)

266 
	#NAME_ABSTRACT
 0x40

	)

268 
	#TYPE_MASK
 (~(
TYPE_MOD_STATIC
 | 
TYPE_MOD_NO_MASK
 |\

269 
TYPE_MOD_PRIVATE
 | 
TYPE_MOD_PUBLIC
 |\

270 
TYPE_MOD_VARARGS
 | 
TYPE_MOD_TRUE_VARARGS
 |\

271 
NAME_ABSTRACT
 | 
NAME_STRICT_TYPES
 |\

272 
NAME_PROTOTYPE
))

	)

273 
	#TYPE_MOD_MASK
 (
TYPE_MOD_STATIC
 | 
TYPE_MOD_NO_MASK
 |\

274 
TYPE_MOD_PRIVATE
 | 
TYPE_MOD_PUBLIC
 |\

275 
TYPE_MOD_VARARGS
 | 
TYPE_MOD_TRUE_VARARGS
)

	)

	@func_spec.c

11 
	~"c⁄fig.h
"

13 
add_a˘i⁄
(
°rög
|
fun˘i⁄
, |string, |);

14 
obje˘
 *
Æl_övít‹y
(obje˘ : 
F_THIS_OBJECT
);

15 
mixed
 *
Æloˇã
();

16 #ifde‡
DEBUG


17 
bªak_poöt
();

19 
°rög
 
bªak_°rög
(|string, , ||string);

20 
mixed
 
ˇŒ_Ÿhî
(
m≠pög
|
obje˘
|
°rög
||object *, string, ...);

21 
mixed
 
ˇŒ_Ÿhîv
(
m≠pög
|
obje˘
|
°rög
||object *, string, mixed *);

22 
mixed
 
ˇŒ_£lf
(
°rög
, ...);

23 
mixed
 
ˇŒ_£lfv
(
°rög
, mixed *);

24 
obje˘
 
ˇŒög_obje˘
(: 
F_CONST0
);

25 
°rög
 
ˇŒög_¥ogøm
(: 
F_CONST0
);

26 
°rög
 
ˇŒög_fun˘i⁄
(: 
F_CONST0
);

27 
°rög
 
ˇpôÆize
(string|);

28 
°rög
 
˛ór_bô
(string, );

29 
obje˘
 
˛⁄e_obje˘
(
°rög
);

30 
comm™d
(
°rög
);

31 
mixed
 *
comm™ds
(
obje˘
|: 
F_THIS_OBJECT
);

32 
°rög
 
¸y±
(string, string|);

33 
°rög
 
˘ime
();

34 
mixed
 
debug
(
°rög
, ...);

35 
obje˘
 *
dìp_övít‹y
(|obje˘ : 
F_THIS_OBJECT
);

36 
de°ru˘
();

37 
dißbÀ_comm™ds
();

38 
ed
(|
°rög
, |°rög|
fun˘i⁄
);

39 
íabÀ_comm™ds
();

40 
obje˘
 
ívú⁄mít
(obje˘ : 
F_THIS_OBJECT
);

41 
exec
(
obje˘
|, object);

42 
°rög
 *
ex∂ode
(string, string);

43 
°rög
 
exåa˘
(string, |, |);

44 
°rög
 
fûe_«me
(
obje˘
 : 
F_THIS_OBJECT
);

45 
fûe_size
(
°rög
);

46 
fûe_time
(
°rög
);

47 
mixed
 *
fûãr
(|
m≠pög
|mixed *, 
°rög
|
fun˘i⁄
, |
obje˘
|string, |mixed);

48 
mixed
 
föd_livög
(
°rög
, |);

49 
obje˘
 
föd_obje˘
(
°rög
);

50 
obje˘
 
föd_∂ayî
(
°rög
);

51 
Êﬂç
(
mixed
);

52 
°rög
 
fun˘i⁄_exi°s
(°rög, 
obje˘
 : 
F_THIS_OBJECT
);

53 
obje˘
 
fun˘i⁄_obje˘
(
fun˘i⁄
);

54 
°rög
 
fun˘i⁄_«me
(
fun˘i⁄
);

55 
fun˘i⁄p
(
mixed
);

56 
°rög
 *
gë_dú
(string);

57 
mixed
 *
gë_Æl_Æ¨ms
();

58 
mixed
 *
gë_Æ¨m
();

59 
°rög
 
im∂ode
(|string *, string);

60 
öput_to
(
°rög
|
fun˘i⁄
, ...);

61 
öç
(
mixed
);

62 
œ°_ª„ªn˚_time
();

63 
livög
(
obje˘
|);

64 
°rög
 
lowî_ˇ£
(|string);

65 
°rög
 
uµî_ˇ£
(|string);

66 
m≠pög
 
m_dñëe
(|m≠pög, 
mixed
);

67 
mixed
 *
m_ödexes
(|
m≠pög
);

68 
mixed
 *
m_vÆues
(|
m≠pög
);

69 
m_sizeof
(|
m≠pög
);

70 
m_ª°‹e_obje˘
(
m≠pög
);

71 
m≠pög
 
m_ßve_obje˘
();

72 
m≠pögp
(
mixed
);

73 
mixed
 *
m≠
(|
m≠pög
|mixed *, 
°rög
|
fun˘i⁄
, |
obje˘
|string, |mixed);

74 
mixed
 
max
(|
°rög
|, ...);

75 
membî_¨øy
(
mixed
, |mixed *);

76 
mixed
 
mö
(|
°rög
|, ...);

77 
mkdú
(
°rög
);

78 
fun˘i⁄
 
mkfun˘i⁄
(
°rög
, 
obje˘
 : 
F_THIS_OBJECT
);

79 
m≠pög
 
mkm≠pög
(|
mixed
 *, |mixed *);

80 
move_obje˘
(
obje˘
|
°rög
);

81 
nŸify_Áû
(
°rög
, |);

82 
°rög
 
oblicz_¥zym
(string, string, , , );

83 
obje˘
 *
obje˘_˛⁄es
(object);

84 
obje˘_time
(
obje˘
 : 
F_THIS_OBJECT
);

85 
obje˘p
(
mixed
);

86 
obsﬁëe
(
°rög
);

87 
fun˘i⁄
 
∑µlyv
(fun˘i⁄, 
mixed
 *);

88 
poöãΩ
(
mixed
);

89 
obje˘
 
¥e£¡
(|obje˘|
°rög
, obje˘ *|obje˘ : 
F_THIS_OBJECT
);

90 
obje˘
 
¥evious_obje˘
(: 
F_CONST0
);

91 
°rög
 
¥o˚ss_°rög
(°rög, : 
F_CONST0
);

92 
mixed
 
¥o˚ss_vÆue
(
°rög
, : 
F_CONST0
);

93 
mixed
 
quîy_auth
(
obje˘
);

94 
°rög
 
quîy_ho°_«me
();

95 
quîy_idÀ
(
obje˘
);

96 
quîy_öãø˘ive
(
obje˘
|);

97 
°rög
 
quîy_ù_«me
(|
obje˘
);

98 
°rög
 
quîy_ù_numbî
(|
obje˘
);

99 
°rög
 
quîy_ù_idít
(
obje˘
 : 
F_THIS_OBJECT
);

100 
obje˘
 
quîy_¢o›
(object);

101 
°rög
 
quîy_åigvîb
();

102 
°rög
 
quîy_vîb
();

103 
øndom
(, |);

104 
°rög
 
ªad_byãs
(string, |, |);

105 
°rög
 
ªad_fûe
(string, |, |);

106 
°rög
 
ªadabÀ_°rög
(string);

107 
°rög
 *
ªgexp
(string *, string);

108 
ªmove_Æ¨m
();

109 
ª«me
(
°rög
, string);

110 
ª°‹e_obje˘
(
°rög
);

111 
m≠pög
 
ª°‹e_m≠
(
°rög
);

112 
rm
(
°rög
);

113 
rmdú
(
°rög
);

114 
ßve_obje˘
(
°rög
);

115 
ßve_m≠
(
m≠pög
, 
°rög
);

116 
£t_Æ¨m
(, , 
°rög
|
fun˘i⁄
, ...);

117 
£t_Æ¨mv
(, , 
°rög
, 
mixed
 *);

118 
£t_auth
(
obje˘
,
mixed
);

119 
°rög
 
£t_bô
(string, );

120 
£t_livög_«me
(
°rög
);

121 
obje˘
 
shadow
(object, );

122 
£t_this_∂ayî
(|
obje˘
 : 
F_THIS_OBJECT
);

123 (|
	gmixed
 *);

124 
obje˘
 
¢o›
(|object, |object);

125 
°rög
 
•rötf
(string, ...);

126 
sqπ
();

127 
°rögp
(
mixed
);

128 
°æí
(|
°rög
);

129 
mixed
 
°r2vÆ
(
°rög
);

130 
èû
(
°rög
);

131 
ã°_bô
(
°rög
, );

132 
obje˘
 
this_obje˘
();

133 
obje˘
 
this_∂ayî
();

134 
obje˘
 
this_öãø˘ive
();

135 
throw
(
mixed
);

136 
time
();

137 
mixed
 *
unique_¨øy
(|mixed *, 
°rög
, |mixed);

138 
upd©e_a˘i⁄s
(
obje˘
 : 
F_THIS_OBJECT
);

139 
obje˘
 *
u£rs
();

140 
°rög
 
vÆ2°r
(
mixed
);

141 
wûdm©ch
(
°rög
, string);

142 
wrôe_byãs
(
°rög
, , string);

143 
wrôe_fûe
(
°rög
, string);

144 
wrôe_sockë
(
°rög
|);

145 
ôof
();

146 
·oi
();

147 
sö
();

148 
cos
();

149 
èn
();

150 
asö
();

151 
acos
();

152 
©™
();

153 
©™2
(, );

154 
exp
();

155 
log
();

156 
pow
(, );

157 
söh
();

158 
cosh
();

159 
ènh
();

160 #i‡!
deföed
(
_SEQUENT_
)

161 
asöh
();

162 
acosh
();

163 
©™h
();

165 
abs
();

166 
Á˘
();

167 
°rög
 
·ﬂ
();

168 
∫d
();

170 #ifde‡
WORD_WRAP


174 
£t_s¸ìn_width
();

175 
quîy_s¸ìn_width
();

	@gc.c

2 
	~<°dio.h
>

4 *
gc_mÆloc
(), *
gc_ªÆloc
();

5 
gc_‰ì
();

6 
	sblock_°©us


8 *
	mÆloc_addªss
;

9 
	msize
;

12 
	#Æign
(
size
, 
d©a
) ( (size) + (data) * \

13 !!–(
size
Ë% (
d©a
) ) \

14 - ( (
size
Ë% (
d©a
ËË)

	)

16 
	gã°p
 = 0;

17 *
	$dump_mÆloc_d©a
()

20 
	}
}

22 
	$ªp‹t_Àak
(
p
, 
sz
)

23 *
p
;

24 
sz
;

26 
block_°©us
 *
addªss
;

27 
size
;

30 i‡(
sz
 < 0) sz = -sz;

31 
size
 = 
sz
<<2;

32 
addªss
 = (
block_°©us
 *)

33 ((*)(
p
 + 
size
 - (
block_°©us
)));

35 
	`gc_¥ötf
("Found unfreed blockátáddress %#x,Ñeal_size %#x,"

37 
p
, 
size
, 
addªss
->size,addªss->
Æloc_addªss
);

39 
	}
}

43 
	$mÆloc
(
size
)

45 *
who_ˇŒed
 
	`asm
 ("%i7");

46 
block_°©us
 *
ßve_addr
;

47 
ªÆ_size
 = 
	`Æign
(
size
 + (
block_°©us
), *);

49 *
p
 = 
	`gc_mÆloc
(
ªÆ_size
);

50 i‡(
p
 =(*Ë(
ã°p
 * 10))

51 ()
	`¥ötf
("FOUND malloc!\n");

53 
ßve_addr
 = (
block_°©us
 *)

54 ((*)(
p
 + 
ªÆ_size
 - (
block_°©us
)));

55 
ßve_addr
->
Æloc_addªss
 = 
who_ˇŒed
;

56 
ßve_addr
->
size
 = size;

57 
	`gc_¥ötf
("Allocated dataátáddress %#x, size %#x,"

59 
p
, 
size
, 
ªÆ_size
, 
who_ˇŒed
);

61  
p
;

62 
	}
}

65 
	$‰ì
(*
p
)

67 i‡(
p
 =(*)(
ã°p
*10))

68 ()
	`¥ötf
("FOUND free!\n");

69 
	`gc_‰ì
(
p
);

70 
	}
}

73 
	$ˇŒoc
(
a
, 
b
)

75 *
p
;

76 *
who_ˇŒed
 
	`asm
 ("%i7");

77 
block_°©us
 *
ßve_addr
;

78 
ªÆ_size
 = 
	`Æign
(
a
*
b
 + (
block_°©us
), *);

80 
p
 = 
	`gc_mÆloc
(
ªÆ_size
);

82 
ßve_addr
 = (
block_°©us
 *)

83 ((*)(
p
 + 
ªÆ_size
 - (
block_°©us
)));

84 
ßve_addr
->
Æloc_addªss
 = 
who_ˇŒed
;

85 
ßve_addr
->
size
 = 
a
*
b
;

86 
	`gc_¥ötf
("Allocated dataátáddress %#x, size %#x,"

88 
p
, 
a
*
b
, 
ªÆ_size
, 
who_ˇŒed
);

90  
p
;

91 
	}
}

94 
	$ªÆloc
(*
p
, 
size
)

96 *
p2
;

97 *
who_ˇŒed
 
	`asm
 ("%i7");

98 
block_°©us
 *
ßve_addr
;

99 
ªÆ_size
 = 
	`Æign
(
size
 + (
block_°©us
), *);

100 
p2
 = 
	`gc_ªÆloc
(
ªÆ_size
);

101 
ßve_addr
 = (
block_°©us
 *)

102 ((*)(
p2
 + 
ªÆ_size
 - (
block_°©us
)));

103 
ßve_addr
->
Æloc_addªss
 = 
who_ˇŒed
;

104 
ßve_addr
->
size
 = size;

105 
	`gc_¥ötf
("Rellocated dataátáddress %#xÅoáddress %#x, size %#x,"

107 
p2
, 
p
, 
size
, 
ªÆ_size
, 
who_ˇŒed
);

109  
p2
;

111 
	}
}

	@genfkntab.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<°rög.h
>

4 
	~<˘y≥.h
>

6 #ifde‡
VAX_BSD


7 
vax_bsd_touµî
(
s
);

9 
	#xtouµî
(
s
Ë
	`vax_bsd_touµî
(s)

	)

11 
	#xtouµî
(
s
Ë
	`touµî
(s)

	)

15 
	$maö
(
¨gc
, **
¨gv
)

17 
i
 = 0, 
j
;

18 
«me
[160];

19 *
func_«me
;

20 *
¥efix
;

21 *
‚ame
;

22 
FILE
 *
hódî_fûe
, *
d©a_fûe
;

23 i‡(
¨gc
 < 3)

24 
	`exô
(1);

26 
¥efix
 = 
¨gv
[1];

27 
‚ame
 = 
¨gv
[2];

28 
j
 = 0; 
¥efix
[j]; j++)

29 
¥efix
[
j
] = 
	`xtouµî
(prefix[j]);

31 ()
	`•rötf
(
«me
, "%s.h", 
‚ame
);

32 
hódî_fûe
 = 
	`f›í
(
«me
, "w");

33 ()
	`•rötf
(
«me
, "%s.t", 
‚ame
);

34 
d©a_fûe
 = 
	`f›í
(
«me
, "w");

36 ()
	`Ârötf
(
d©a_fûe
, "°©i¯°ru˘ fk¡ab %s_fk¡ab[] =\n{\n", 
‚ame
);

38 ()
	`fgës
(
«me
, “ame), 
°dö
);

39 !
	`„of
(
°dö
);

40 ()
	`fgës
(
«me
, “ame), 
°dö
))

42 i‡((
func_«me
 = 
	`°rchr
(
«me
, '\n')Ë!
NULL
)

43 *
func_«me
 = '\0';

44 i‡(!*
«me
 || *name == '#')

46 
func_«me
 = 
«me
;

47 
j
 = 0; 
«me
[j]; j++)

49 i‡(
«me
[
j
] == '\t' ||

50 
«me
[
j
] == ' ')

52 
«me
[
j
] = '\0';

53 
j
++;

54 
«me
[
j
] ||Çame[j] == ' ' ||Çame[j] == '\t')

55 
j
++;

56 i‡(
«me
[
j
])

57 
func_«me
 = &
«me
[
j
];

62 ()
	`Ârötf
(
d©a_fûe
, " {\"%s\", 0, 0},\n", 
func_«me
);

63 
j
 = 0; 
«me
[j]; j++)

64 
«me
[
j
] = 
	`xtouµî
(name[j]);

65 ()
	`Ârötf
(
hódî_fûe
, "#deföê%s_%†%d\n", 
¥efix
, 
«me
, 
i
++);

68 ()
	`Âuts
(" {NULL, 0, 0}\n};\n", 
d©a_fûe
);

69 
	`exô
(0);

71 
	}
}

73 #ifde‡
VAX_BSD


75 
	$vax_bsd_touµî
(
s
)

77 i‡(
s
 == '_')

78  
s
;

80  
	`touµî
(
s
);

81 
	}
}

	@gmalloc.c

25 
	#__ONEFILE


	)

73 #i‚def 
_ANSIDECL_H


75 
	#_ANSIDECL_H
 1

	)

83 #ifdef 
__STDC__


85 
	#PTR
 *

	)

86 
	#PTRCONST
 *
CONST


	)

87 
	#LONG_DOUBLE
 

	)

89 
	#AND
 ,

	)

90 
	#NOARGS
 

	)

91 
	#CONST
 c⁄°

	)

92 
	#VOLATILE
 vﬁ©ûe

	)

93 
	#SIGNED
 sig√d

	)

94 
	#DOTS
 , ...

	)

96 
	#EXFUN
(
«me
, 
¥Ÿo
Ë«mê
	)
proto

97 
	#DEFUN
(
«me
, 
¨gli°
, 
¨gs
Ë
	`«me
◊rgs)

	)

98 
	#DEFUN_VOID
(
«me
Ë
	`«me
(
NOARGS
)

	)

102 
	#PTR
 *

	)

103 
	#PTRCONST
 
PTR


	)

104 
	#LONG_DOUBLE
 

	)

106 
	#AND
 ;

	)

107 
	#NOARGS


	)

108 
	#CONST


	)

109 
	#VOLATILE


	)

110 
	#SIGNED


	)

111 
	#DOTS


	)

113 
	#EXFUN
(
«me
, 
¥Ÿo
Ë
	`«me
()

	)

114 
	#DEFUN
(
«me
, 
¨gli°
, 
¨gs
Ë«mê¨gli°árgs;

	)

115 
	#DEFUN_VOID
(
«me
Ë
	`«me
()

	)

122 #ifde‡
__STDC__


123 
	~<limôs.h
>

127 
	#CHAR_BIT
 8

	)

130 
	#MB_LEN_MAX
 1

	)

133 
	#SCHAR_MIN
 -128

	)

134 
	#SCHAR_MAX
 127

	)

137 
	#UCHAR_MAX
 255U

	)

140 #ifde‡
__CHAR_UNSIGNED__


141 
	#CHAR_MIN
 0

	)

142 
	#CHAR_MAX
 255U

	)

144 
	#CHAR_MIN
 -128

	)

145 
	#CHAR_MAX
 127

	)

149 
	#SHRT_MIN
 -32768

	)

150 
	#SHRT_MAX
 32767

	)

153 
	#USHRT_MAX
 65535U

	)

156 
	#INT_MIN
 -2147483648

	)

157 
	#INT_MAX
 2147483647

	)

160 
	#UINT_MAX
 4294967295U

	)

164 
	#LONG_MIN
 (-
LONG_MAX
-1)

	)

165 
	#LONG_MAX
 2147483647

	)

168 
	#ULONG_MAX
 4294967295U

	)

171 #ifde‡
__STDC__


172 
	~<°ddef.h
>

175 #i‚de‡
_STDDEF_H


176 
	#_STDDEF_H


	)

180 
	t±rdiff_t
;

184 #i‚de‡
_SIZE_T


185 
	#_SIZE_T


	)

186 
	tsize_t
;

191 #unde‡
NULL


192 
	#NULL
 0

	)

196 
	#off£tof
(
TYPE
, 
MEMBER
Ë((
size_t
Ë&((TYPE *)0)->MEMBER)

	)

204 #i‚de‡
__ONEFILE


205 
	~<°ddef.h
>

208 
EXFUN
(
ab‹t
, ());

209 
EXFUN
(
‰ì
, (
PTR
));

210 
PTR
 
EXFUN
(
mÆloc
, (
size_t
));

211 
PTR
 
EXFUN
(
ªÆloc
, (PTR, 
size_t
));

215 #i‚de‡
__ONEFILE


216 
	~<°ddef.h
>

219 
PTR
 
EXFUN
(
mem˝y
, (PTR, PTR, 
size_t
));

220 
PTR
 
EXFUN
(
mem£t
, (PTR, , 
size_t
));

221 
	#memmove
 
mem˝y


	)

223 
	#_MALLOC_INTERNAL


	)

246 #i‚de‡
_MALLOC_H


248 
	#_MALLOC_H
 1

	)

250 #i‚de‡
__ONEFILE


251 
	#__√ed_NULL


	)

252 
	#__√ed_size_t


	)

253 
	#__√ed_±rdiff_t


	)

254 
	~<°ddef.h
>

257 #ifde‡
_MALLOC_INTERNAL


259 #i‚de‡
__ONEFILE


260 
	~<limôs.h
>

268 
	#INT_BIT
 (
CHAR_BIT
 * ())

	)

269 
	#BLOCKLOG
 (
INT_BIT
 > 16 ? 12 : 9)

	)

270 
	#BLOCKSIZE
 (1 << 
BLOCKLOG
)

	)

271 
	#BLOCKIFY
(
SIZE
Ë(((SIZEË+ 
BLOCKSIZE
 - 1Ë/ BLOCKSIZE)

	)

275 
	#HEAP
 (
INT_BIT
 > 16 ? 4194304 : 65536)

	)

279 
	#FINAL_FREE_BLOCKS
 8

	)

285 
	#MALLOC_SEARCH_START
 
_hópödex


	)

294 
	mty≥
;

300 
size_t
 
	mn‰ì
;

301 
size_t
 
	mfú°
;

302 } 
	m‰ag
;

304 
size_t
 
	msize
;

305 } 
	möfo
;

306 } 
	mbusy
;

309 
size_t
 
	msize
;

310 
size_t
 
	m√xt
;

311 
size_t
 
	m¥ev
;

312 } 
	m‰ì
;

313 } 
	tmÆloc_öfo
;

316 *
_hópba£
;

319 
mÆloc_öfo
 *
_hópöfo
;

322 
	#BLOCK
(
A
Ë(((*Ë(AË- 
_hópba£
Ë/ 
BLOCKSIZE
 + 1)

	)

323 
	#ADDRESS
(
B
Ë((
PTR
Ë(((BË- 1Ë* 
BLOCKSIZE
 + 
_hópba£
))

	)

326 
size_t
 
_hópödex
;

329 
size_t
 
_hó∂imô
;

332 
	sli°


334 
li°
 *
	m√xt
;

335 
li°
 *
	m¥ev
;

339 
li°
 
_‰aghód
[];

342 
size_t
 
_chunks_u£d
;

343 
size_t
 
_byãs_u£d
;

344 
size_t
 
_chunks_‰ì
;

345 
size_t
 
_byãs_‰ì
;

351 
PTR
 
EXFUN
((*
__m‹ec‹e
), (
±rdiff_t
 
__size
));

354 
PTR
 
EXFUN
(
__deÁu…_m‹ec‹e
, (
±rdiff_t
 
__size
));

357 
__mÆloc_öôülized
;

360 
EXFUN
((*
__‰ì_hook
), (
PTR
 
__±r
));

361 
PTR
 
EXFUN
((*
__mÆloc_hook
), (
size_t
 
__size
));

362 
PTR
 
EXFUN
((*
__ªÆloc_hook
), (PTR 
__±r
, 
size_t
 
__size
));

365 
EXFUN
(
mcheck
, (
NOARGS
));

368 
	sm°©s


370 
size_t
 
	mbyãs_tŸÆ
;

371 
size_t
 
	mchunks_u£d
;

372 
size_t
 
	mbyãs_u£d
;

373 
size_t
 
	mchunks_‰ì
;

374 
size_t
 
	mbyãs_‰ì
;

378 
m°©s
 
EXFUN
(m°©s, (
NOARGS
));

404 #i‚de‡
__ONEFILE


405 
	~"™side˛.h
"

406 
	~<°ddef.h
>

407 
	~<°dlib.h
>

409 
	#_MALLOC_INTERNAL


	)

410 
	~"mÆloc.h
"

414 
EXFUN
((*
__‰ì_hook
), (
PTR
 
__±r
));

418 
DEFUN
(
‰ì
, (
±r
), 
PTR
Ötr)

420 
	gty≥
;

421 
size_t
 
	gblock
, 
	gblocks
;

422 
size_t
 
	gi
;

423 
li°
 *
	g¥ev
, *
	g√xt
;

425 i‡(
	g±r
 =
NULL
)

428 i‡(
	g__‰ì_hook
 !
NULL
)

430 (*
__‰ì_hook
)(
±r
);

434 
	gblock
 = 
BLOCK
(
±r
);

436 
	gty≥
 = 
_hópöfo
[
block
].
busy
.
ty≥
;

437 
	gty≥
)

441 --
_chunks_u£d
;

442 
	g_byãs_u£d
 -
_hópöfo
[
block
].
busy
.
öfo
.
size
 * 
BLOCKSIZE
;

443 
	g_byãs_‰ì
 +
_hópöfo
[
block
].
busy
.
öfo
.
size
 * 
BLOCKSIZE
;

448 
	gi
 = 
_hópödex
;

449 i‡(
	gi
 > 
	gblock
)

450 
	gi
 > 
	gblock
)

451 
	gi
 = 
_hópöfo
[
i
].
‰ì
.
¥ev
;

455 
	gi
 = 
_hópöfo
[
i
].
‰ì
.
√xt
;

456 
	gi
 > 0 && i < 
	gblock
);

457 
	gi
 = 
_hópöfo
[
i
].
‰ì
.
¥ev
;

461 i‡(
	gblock
 =
i
 + 
_hópöfo
[i].
‰ì
.
size
)

464 
_hópöfo
[
i
].
‰ì
.
size
 +_hópöfo[
block
].
busy
.
öfo
.size;

465 
	gblock
 = 
i
;

470 
	g_hópöfo
[
block
].
	g‰ì
.
	gsize
 = 
_hópöfo
[block].
busy
.
öfo
.
size
;

471 
	g_hópöfo
[
block
].
	g‰ì
.
	g√xt
 = 
_hópöfo
[
i
].
‰ì
.
√xt
;

472 
	g_hópöfo
[
block
].
	g‰ì
.
	g¥ev
 = 
i
;

473 
	g_hópöfo
[
i
].
	g‰ì
.
	g√xt
 = 
block
;

474 
	g_hópöfo
[
_hópöfo
[
block
].
	g‰ì
.
	g√xt
].‰ì.
	g¥ev
 = block;

475 ++
	g_chunks_‰ì
;

481 i‡(
	gblock
 + 
	g_hópöfo
[
block
].
	g‰ì
.
	gsize
 =
_hópöfo
[block].
‰ì
.
√xt
)

483 
_hópöfo
[
block
].
‰ì
.
size


484 +
_hópöfo
[_hópöfo[
block
].
‰ì
.
√xt
].‰ì.
size
;

485 
	g_hópöfo
[
block
].
	g‰ì
.
	g√xt


486 
_hópöfo
[_hópöfo[
block
].
‰ì
.
√xt
].free.next;

487 
	g_hópöfo
[
_hópöfo
[
block
].
	g‰ì
.
	g√xt
].‰ì.
	g¥ev
 = block;

488 --
	g_chunks_‰ì
;

492 
	gblocks
 = 
_hópöfo
[
block
].
‰ì
.
size
;

493 i‡(
	gblocks
 >
FINAL_FREE_BLOCKS
 && 
block
 + 
blocks
 =
_hó∂imô


494 && (*
__m‹ec‹e
)(0Ë=
ADDRESS
(
block
 + 
blocks
))

496 
size_t
 
byãs
 = 
blocks
 * 
BLOCKSIZE
;

497 
	g_hó∂imô
 -
blocks
;

498 (*
	g__m‹ec‹e
)(- 
	gbyãs
);

499 
	g_hópöfo
[
_hópöfo
[
block
].
	g‰ì
.
	g¥ev
].‰ì.
	g√xt


500 
_hópöfo
[
block
].
‰ì
.
√xt
;

501 
	g_hópöfo
[
_hópöfo
[
block
].
	g‰ì
.
	g√xt
].‰ì.
	g¥ev


502 
_hópöfo
[
block
].
‰ì
.
¥ev
;

503 
	gblock
 = 
_hópöfo
[
block
].
‰ì
.
¥ev
;

504 --
	g_chunks_‰ì
;

505 
	g_byãs_‰ì
 -
byãs
;

509 
	g_hópödex
 = 
block
;

514 --
_chunks_u£d
;

515 
	g_byãs_u£d
 -1 << 
ty≥
;

516 ++
	g_chunks_‰ì
;

517 
	g_byãs_‰ì
 +1 << 
ty≥
;

520 
	g¥ev
 = (
li°
 *Ë((*Ë
ADDRESS
(
block
) +

521 (
_hópöfo
[
block
].
busy
.
öfo
.
‰ag
.
fú°
 << 
ty≥
));

523 i‡(
	g_hópöfo
[
block
].
	gbusy
.
	göfo
.
	g‰ag
.
	gn‰ì
 =(
BLOCKSIZE
 >> 
ty≥
) - 1)

527 
√xt
 = 
¥ev
;

528 
	gi
 = 1; i < 
	gBLOCKSIZE
 >> 
	gty≥
; ++i)

529 
	g√xt
 = 
√xt
->next;

530 
	g¥ev
->¥ev->
	g√xt
 = 
√xt
;

531 i‡(
	g√xt
 !
NULL
)

532 
√xt
->
¥ev
 =Örev->prev;

533 
	g_hópöfo
[
block
].
	gbusy
.
	gty≥
 = 0;

534 
	g_hópöfo
[
block
].
	gbusy
.
	göfo
.
	gsize
 = 1;

537 ++
	g_chunks_u£d
;

538 
	g_byãs_u£d
 +
BLOCKSIZE
;

539 
	g_chunks_‰ì
 -
BLOCKSIZE
 >> 
ty≥
;

540 
	g_byãs_‰ì
 -
BLOCKSIZE
;

542 
‰ì
(
ADDRESS
(
block
));

544 i‡(
	g_hópöfo
[
block
].
	gbusy
.
	göfo
.
	g‰ag
.
	gn‰ì
 != 0)

549 
√xt
 = (
li°
 *Ë
±r
;

550 
	g√xt
->√xà
¥ev
->
√xt
;

551 
	g√xt
->
	g¥ev
 = 
¥ev
;

552 
	g¥ev
->
	g√xt
 = 
√xt
;

553 i‡(
	g√xt
->√xà!
NULL
)

554 
√xt
->√xt->
¥ev
 =Çext;

555 ++
	g_hópöfo
[
block
].
	gbusy
.
	göfo
.
	g‰ag
.
	gn‰ì
;

562 
	g¥ev
 = (
li°
 *Ë
±r
;

563 
	g_hópöfo
[
block
].
	gbusy
.
	göfo
.
	g‰ag
.
	gn‰ì
 = 1;

564 
	g_hópöfo
[
block
].
	gbusy
.
	göfo
.
	g‰ag
.
	gfú°
 = ()

565 (((*Ë
±r
 - (*Ë
NULL
Ë% 
BLOCKSIZE
 >> 
ty≥
);

566 
	g¥ev
->
	g√xt
 = 
_‰aghód
[
ty≥
].
√xt
;

567 
	g¥ev
->¥ev = &
_‰aghód
[
ty≥
];

568 
	g¥ev
->¥ev->
	g√xt
 = 
¥ev
;

569 i‡(
	g¥ev
->
	g√xt
 !
NULL
)

570 
¥ev
->
√xt
->prev =Örev;

598 #i‚de‡
__ONEFILE


599 
	~"™side˛.h
"

600 
	~<°ddef.h
>

601 
	~<°dlib.h
>

602 
	~<°rög.h
>

604 
	#_MALLOC_INTERNAL


	)

605 
	~"mÆloc.h
"

609 
PTR
 
EXFUN
((*
__m‹ec‹e
), (
±rdiff_t
 
__size
)Ë
__deÁu…_m‹ec‹e
;

612 
PTR
 
EXFUN
((*
__mÆloc_hook
), (
size_t
 
__size
));

615 *
	g_hópba£
;

618 
mÆloc_öfo
 *
	g_hópöfo
;

621 
size_t
 
	ghópsize
;

624 
size_t
 
	g_hópödex
;

627 
size_t
 
	g_hó∂imô
;

630 
li°
 
	g_‰aghód
[
BLOCKLOG
];

633 
size_t
 
	g_chunks_u£d
;

634 
size_t
 
	g_byãs_u£d
;

635 
size_t
 
	g_chunks_‰ì
;

636 
size_t
 
	g_byãs_‰ì
;

639 
	g__mÆloc_öôülized
;

642 
PTR


643 
DEFUN
(
Æign
, (
size
), 
size_t
 size)

645 
PTR
 
	gªsu…
;

646 
	gadj
;

648 
	gªsu…
 = (*
__m‹ec‹e
)(
size
);

649 
	gadj
 = (Ë((*Ë
ªsu…
 - (*Ë
NULL
Ë% 
BLOCKSIZE
;

650 i‡(
	gadj
 != 0)

652 
adj
 = 
BLOCKSIZE
 -ádj;

653 (Ë(*
	g__m‹ec‹e
)(
	gadj
);

654 
	gªsu…
 = (*Ë
ªsu…
 + 
adj
;

656  
	gªsu…
;

661 
	$DEFUN_VOID
(
öôülize
)

663 
hópsize
 = 
HEAP
 / 
BLOCKSIZE
;

664 
_hópöfo
 = (
mÆloc_öfo
 *Ë
	`Æign
(
hópsize
 * (malloc_info));

665 i‡(
_hópöfo
 =
NULL
)

667 ()
	`mem£t
(
_hópöfo
, 0, 
hópsize
 * (
mÆloc_öfo
));

668 
_hópöfo
[0].
‰ì
.
size
 = 0;

669 
_hópöfo
[0].
‰ì
.
√xt
 = _hópöfo[0].‰ì.
¥ev
 = 0;

670 
_hópödex
 = 0;

671 
_hópba£
 = (*Ë
_hópöfo
;

672 
__mÆloc_öôülized
 = 1;

674 
	}
}

678 
PTR


679 
DEFUN
(
m‹ec‹e
, (
size
), 
size_t
 size)

681 
PTR
 
	gªsu…
;

682 
mÆloc_öfo
 *
	g√wöfo
, *
	gﬁdöfo
;

683 
size_t
 
	g√wsize
;

685 
	gªsu…
 = 
Æign
(
size
);

686 i‡(
	gªsu…
 =
NULL
)

687  
NULL
;

690 i‡(
BLOCK
((*Ë
ªsu…
 + 
size
Ë> 
	ghópsize
)

692 
	g√wsize
 = 
hópsize
;

693 
BLOCK
((*Ë
ªsu…
 + 
size
Ë> 
	g√wsize
)

694 
	g√wsize
 *= 2;

695 
	g√wöfo
 = (
mÆloc_öfo
 *Ë
Æign
(
√wsize
 * (malloc_info));

696 i‡(
	g√wöfo
 =
NULL
)

698 (*
__m‹ec‹e
)(- 
size
);

699  
	gNULL
;

701 ()
mem£t
(
√wöfo
, 0, 
√wsize
 * (
mÆloc_öfo
));

702 ()
mem˝y
(
√wöfo
, 
_hópöfo
, 
hópsize
 * (
mÆloc_öfo
));

703 
	gﬁdöfo
 = 
_hópöfo
;

704 
	g√wöfo
[
BLOCK
(
ﬁdöfo
)].
	gbusy
.
	gty≥
 = 0;

705 
	g√wöfo
[
BLOCK
(
ﬁdöfo
)].
	gbusy
.
	göfo
.
	gsize


706 
BLOCKIFY
(
hópsize
 * (
mÆloc_öfo
));

707 
	g_hópöfo
 = 
√wöfo
;

708 
‰ì
(
ﬁdöfo
);

709 
	ghópsize
 = 
√wsize
;

712 
	g_hó∂imô
 = 
BLOCK
((*Ë
ªsu…
 + 
size
);

713  
	gªsu…
;

717 
PTR


718 
DEFUN
(
mÆloc
, (
size
), 
size_t
 size)

720 
PTR
 
	gªsu…
;

721 
size_t
 
	gblock
, 
	gblocks
, 
	gœ°blocks
, 
	g°¨t
;

722 
size_t
 
	gi
;

723 
li°
 *
	g√xt
;

725 i‡(
	gsize
 == 0)

726  
NULL
;

728 i‡(
	g__mÆloc_hook
 !
NULL
)

729  (*
__mÆloc_hook
)(
size
);

731 i‡(!
	g__mÆloc_öôülized
)

732 i‡(!
öôülize
())

733  
	gNULL
;

735 i‡(
	gsize
 < (
	gli°
))

736 
	gsize
 = (
li°
);

739 i‡(
	gsize
 <
BLOCKSIZE
 / 2)

743 
size_t
 
log
 = 1;

744 --
	gsize
;

745 (
	gsize
 /= 2) != 0)

746 ++
log
;

750 
	g√xt
 = 
_‰aghód
[
log
].
√xt
;

751 i‡(
	g√xt
 !
NULL
)

756 
ªsu…
 = (
PTR
Ë
√xt
;

757 
	g√xt
->
	g¥ev
->√xà
√xt
->next;

758 i‡(
	g√xt
->√xà!
NULL
)

759 
√xt
->√xt->
¥ev
 =Çext->prev;

760 
	gblock
 = 
BLOCK
(
ªsu…
);

761 i‡(--
	g_hópöfo
[
block
].
	gbusy
.
	göfo
.
	g‰ag
.
	gn‰ì
 != 0)

762 
_hópöfo
[
block
].
busy
.
öfo
.
‰ag
.
fú°
 = ()

763 (((*Ë
√xt
->√xà- (*Ë
NULL
Ë% 
BLOCKSIZE
Ë>> 
log
;

766 ++
	g_chunks_u£d
;

767 
	g_byãs_u£d
 +1 << 
log
;

768 --
	g_chunks_‰ì
;

769 
	g_byãs_‰ì
 -1 << 
log
;

775 
	gªsu…
 = 
mÆloc
(
BLOCKSIZE
);

776 i‡(
	gªsu…
 =
NULL
)

777  
NULL
;

780 
	gi
 = 1; i < 
	gBLOCKSIZE
 >> 
	glog
; ++i)

782 
	g√xt
 = (
li°
 *Ë((*Ë
ªsu…
 + (
i
 << 
log
));

783 
	g√xt
->√xà
_‰aghód
[
log
].
√xt
;

784 
	g√xt
->
	g¥ev
 = &
_‰aghód
[
log
];

785 
	g√xt
->
	g¥ev
->√xà
√xt
;

786 i‡(
	g√xt
->√xà!
NULL
)

787 
√xt
->√xt->
¥ev
 =Çext;

791 
	gblock
 = 
BLOCK
(
ªsu…
);

792 
	g_hópöfo
[
block
].
	gbusy
.
	gty≥
 = 
log
;

793 
	g_hópöfo
[
block
].
	gbusy
.
	göfo
.
	g‰ag
.
	gn‰ì
 = 
i
 - 1;

794 
	g_hópöfo
[
block
].
	gbusy
.
	göfo
.
	g‰ag
.
	gfú°
 = 
i
 - 1;

796 
	g_chunks_‰ì
 +(
BLOCKSIZE
 >> 
log
) - 1;

797 
	g_byãs_‰ì
 +
BLOCKSIZE
 - (1 << 
log
);

806 
	gblocks
 = 
BLOCKIFY
(
size
);

807 
	g°¨t
 = 
block
 = 
MALLOC_SEARCH_START
;

808 
	g_hópöfo
[
block
].
	g‰ì
.
	gsize
 < 
	gblocks
)

810 
	gblock
 = 
_hópöfo
[
block
].
‰ì
.
√xt
;

811 i‡(
	gblock
 =
°¨t
)

816 
block
 = 
_hópöfo
[0].
‰ì
.
¥ev
;

817 
	gœ°blocks
 = 
_hópöfo
[
block
].
‰ì
.
size
;

818 i‡(
	g_hó∂imô
 !0 && 
block
 + 
œ°blocks
 =
_hó∂imô
 &&

819 (*
__m‹ec‹e
)(0Ë=
ADDRESS
(
block
 + 
œ°blocks
) &&

820 (
m‹ec‹e
((
blocks
 - 
œ°blocks
Ë* 
BLOCKSIZE
)Ë!
NULL
)

822 
_hópöfo
[
block
].
‰ì
.
size
 = 
blocks
;

823 
	g_byãs_‰ì
 +(
blocks
 - 
œ°blocks
Ë* 
BLOCKSIZE
;

826 
	gªsu…
 = 
m‹ec‹e
(
blocks
 * 
BLOCKSIZE
);

827 i‡(
	gªsu…
 =
NULL
)

828  
NULL
;

829 
	gblock
 = 
BLOCK
(
ªsu…
);

830 
	g_hópöfo
[
block
].
	gbusy
.
	gty≥
 = 0;

831 
	g_hópöfo
[
block
].
	gbusy
.
	göfo
.
	gsize
 = 
blocks
;

832 ++
	g_chunks_u£d
;

833 
	g_byãs_u£d
 +
blocks
 * 
BLOCKSIZE
;

834  
	gªsu…
;

840 
	gªsu…
 = 
ADDRESS
(
block
);

841 i‡(
	g_hópöfo
[
block
].
	g‰ì
.
	gsize
 > 
	gblocks
)

845 
	g_hópöfo
[
block
 + 
blocks
].
	g‰ì
.
	gsize


846 
_hópöfo
[
block
].
‰ì
.
size
 - 
blocks
;

847 
	g_hópöfo
[
block
 + 
blocks
].
	g‰ì
.
	g√xt


848 
_hópöfo
[
block
].
‰ì
.
√xt
;

849 
	g_hópöfo
[
block
 + 
blocks
].
	g‰ì
.
	g¥ev


850 
_hópöfo
[
block
].
‰ì
.
¥ev
;

851 
	g_hópöfo
[
_hópöfo
[
block
].
	g‰ì
.
	g¥ev
].‰ì.
	g√xt


852 
_hópöfo
[_hópöfo[
block
].
‰ì
.
√xt
].‰ì.
¥ev


853 
_hópödex
 = 
block
 + 
blocks
;

859 
	g_hópöfo
[
_hópöfo
[
block
].
	g‰ì
.
	g√xt
].‰ì.
	g¥ev


860 
_hópöfo
[
block
].
‰ì
.
¥ev
;

861 
	g_hópöfo
[
_hópöfo
[
block
].
	g‰ì
.
	g¥ev
].‰ì.
	g√xt


862 
_hópödex
 = 
_hópöfo
[
block
].
‰ì
.
√xt
;

863 --
	g_chunks_‰ì
;

866 
	g_hópöfo
[
block
].
	gbusy
.
	gty≥
 = 0;

867 
	g_hópöfo
[
block
].
	gbusy
.
	göfo
.
	gsize
 = 
blocks
;

868 ++
	g_chunks_u£d
;

869 
	g_byãs_u£d
 +
blocks
 * 
BLOCKSIZE
;

870 
	g_byãs_‰ì
 -
blocks
 * 
BLOCKSIZE
;

873  
	gªsu…
;

898 #i‚de‡
__ONEFILE


899 
	~"™side˛.h
"

900 
	~<°dlib.h
>

901 
	~<°rög.h
>

903 
	#_MALLOC_INTERNAL


	)

904 
	~"mÆloc.h
"

907 
	#MIN
(
A
, 
B
Ë((AË< (BË? (AË: (B))

	)

910 
PTR
 
EXFUN
((*
__ªÆloc_hook
), (PTR 
__±r
, 
size_t
 
__size
));

918 
PTR


919 
DEFUN
(
ªÆloc
, (
±r
, 
size
), 
PTR
Öå 
AND
 
size_t
 size)

921 
PTR
 
	gªsu…
;

922 
	gty≥
;

923 
size_t
 
	gblock
, 
	gblocks
, 
	gﬁdlimô
;

925 i‡(
	gsize
 == 0)

927 
‰ì
(
±r
);

928  
	gNULL
;

930 i‡(
	g±r
 =
NULL
)

931  
mÆloc
(
size
);

933 i‡(
	g__ªÆloc_hook
 !
NULL
)

934  (*
__ªÆloc_hook
)(
±r
, 
	gsize
);

936 
	gblock
 = 
BLOCK
(
±r
);

938 
	gty≥
 = 
_hópöfo
[
block
].
busy
.
ty≥
;

939 
	gty≥
)

943 i‡(
size
 <
BLOCKSIZE
 / 2)

945 
ªsu…
 = 
mÆloc
(
size
);

946 i‡(
	gªsu…
 !
NULL
)

948 ()
mem˝y
(
ªsu…
, 
±r
, 
size
);

949 
‰ì
(
±r
);

950  
	gªsu…
;

956 
	gblocks
 = 
BLOCKIFY
(
size
);

957 i‡(
	gblocks
 < 
	g_hópöfo
[
block
].
	gbusy
.
	göfo
.
	gsize
)

961 
	g_hópöfo
[
block
 + 
blocks
].
	gbusy
.
	gty≥
 = 0;

962 
	g_hópöfo
[
block
 + 
blocks
].
	gbusy
.
	göfo
.
	gsize


963 
_hópöfo
[
block
].
busy
.
öfo
.
size
 - 
blocks
;

964 
	g_hópöfo
[
block
].
	gbusy
.
	göfo
.
	gsize
 = 
blocks
;

965 
‰ì
(
ADDRESS
(
block
 + 
blocks
));

966 
	gªsu…
 = 
±r
;

968 i‡(
	gblocks
 =
_hópöfo
[
block
].
busy
.
öfo
.
size
)

970 
ªsu…
 = 
±r
;

976 
	gblocks
 = 
_hópöfo
[
block
].
busy
.
öfo
.
size
;

978 
	gﬁdlimô
 = 
_hó∂imô
;

979 
	g_hó∂imô
 = 0;

980 
‰ì
(
±r
);

981 
	g_hó∂imô
 = 
ﬁdlimô
;

982 
	gªsu…
 = 
mÆloc
(
size
);

983 i‡(
	gªsu…
 =
NULL
)

985 (Ë
mÆloc
(
blocks
 * 
BLOCKSIZE
);

986  
	gNULL
;

988 i‡(
	g±r
 !
ªsu…
)

989 ()
memmove
(
ªsu…
, 
±r
, 
blocks
 * 
BLOCKSIZE
);

996 i‡(
size
 > 1 << (
ty≥
 - 1) && size <= 1 <<Åype)

998 
ªsu…
 = 
±r
;

1003 
	gªsu…
 = 
mÆloc
(
size
);

1004 i‡(
	gªsu…
 =
NULL
)

1005  
NULL
;

1006 ()
mem˝y
(
ªsu…
, 
±r
, 
MIN
(
size
, 1 << 
ty≥
));

1007 
‰ì
(
±r
);

1012  
	gªsu…
;

1037 #i‚de‡
__ONEFILE


1038 
	~"™side˛.h
"

1039 
	~<°ddef.h
>

1041 
	#_MALLOC_INTERNAL


	)

1042 
	~"mÆloc.h
"

1045 
PTR
 
EXFUN
(
sbrk
, (
±rdiff_t
 
size
));

1047 
PTR


1048 
DEFUN
(
__deÁu…_m‹ec‹e
, (
size
), 
±rdiff_t
 size)

1050 
PTR
 
	gªsu…
;

1052 
	gªsu…
 = 
sbrk
(
size
);

1053 i‡(
	gªsu…
 =(
PTR
) -1)

1054  
NULL
;

1055  
	gªsu…
;

1058 
	#__gë∑gesize
 
gë∑gesize


	)

1081 #i‚de‡
__ONEFILE


1082 
	~"™side˛.h
"

1083 
	~<°dlib.h
>

1086 
size_t
 
EXFUN
(
__gë∑gesize
, (
NOARGS
));

1088 
size_t
 
	g∑gesize
;

1090 
PTR


1091 
DEFUN
(
vÆloc
, (
size
), 
size_t
 size)

1093 
PTR
 
	gªsu…
;

1094 
	gadj
;

1096 i‡(
	g∑gesize
 == 0)

1097 
∑gesize
 = 
__gë∑gesize
();

1099 
	gªsu…
 = 
mÆloc
(
size
 + 
∑gesize
);

1100 i‡(
	gªsu…
 =
NULL
)

1101  
NULL
;

1102 
	gadj
 = (Ë((*Ë
ªsu…
 - (*Ë
NULL
Ë% 
∑gesize
;

1103 i‡(
	gadj
 != 0)

1104 
ªsu…
 = (*Ëªsu… + 
∑gesize
 - 
adj
;

1105  
	gªsu…
;

1108 
m°©s


1109 
	$DEFUN_VOID
(
m°©s
)

1111 
m°©s
 
ªsu…
;

1113 
ªsu…
.
byãs_tŸÆ
 = (*Ë(*
__m‹ec‹e
)(0Ë- 
_hópba£
;

1114 
ªsu…
.
chunks_u£d
 = 
_chunks_u£d
;

1115 
ªsu…
.
byãs_u£d
 = 
_byãs_u£d
;

1116 
ªsu…
.
chunks_‰ì
 = 
_chunks_‰ì
;

1117 
ªsu…
.
byãs_‰ì
 = 
_byãs_‰ì
;

1118  
ªsu…
;

1119 
	}
}

1120 *
	$dump_mÆloc_d©a
()

1122 
buff
[2048];

1123 
m°©s
 
m°©
;

1124 
m°©
 = 
	`m°©s
();

1125 ()
	`•rötf
(
buff
,"\n\n\n"

1131 
m°©
.
chunks_u£d
, m°©.
byãs_u£d
,

1132 
m°©
.
chunks_‰ì
, m°©.
byãs_‰ì
,

1133 
m°©
.
chunks_u£d
 + m°©.
chunks_‰ì
,

1134 
m°©
.
byãs_u£d
 + m°©.
byãs_‰ì
,

1135 
m°©
.
byãs_tŸÆ
);

1136  
buff
;

1137 
	}
}

	@hash.c

7 
	gT
[] = {

27 
	$hash°r16
(*
s
, 
maxn
)

29 *
p
;

30 
h1
, 
h2
;

31 
i
;

33 i‡(!*
s
)  0;

35 
p
 = (*)
s
;

36 
h1
 = 0;

37 
h2
 = 
p
[0];

38 
i
 = 
maxn
; 
p
[1] && --i ;Ö++)

40 
h1
 = 
T
[h1 ^ 
p
[0]];

41 
h2
 = 
T
[h2 ^ 
p
[1]];

43  (
h1
 << 8Ë| 
h2
;

44 
	}
}

47 
	$hash°r
(*
s
, 
maxn
, 
hashs
)

52 
h
;

53 *
p
;

54 
i
;

56 i‡(
hashs
 <= 256)

58 
p
 = (*)
s
;

59 
h
 = 0;

60 
i
 = 
maxn
; *
p
 && --i >= 0;Ö++)

61 
h
 = 
T
[h ^ *
p
];

65 
h
 = 
	`hash°r16
(
s
, 
maxn
);

67  ()
h
 % ()
hashs
;

69 
	}
}

81 
	$whash°r
(*
s
, 
maxn
)

83 
h
;

84 *
p
;

85 
i
;

86 
h
 = 0, 
i
 = 
maxn
, 
p
 = (*)
s
; *p && --i >= 0;Ö++)

87 
h
 = 
T
[h ^ *
p
];

88 i‡(*
s
)

90 
oh
 = 
h
 << 8;

91 
i
 = 
maxn
, 
p
 = (*)
s
, 
h
 = (*p++ + 1)&0xff;

92 *
p
 && --
i
 ;Ö++)

93 
h
 = 
T
[h ^ *
p
];

94  
oh
 + 
h
;

96  
h
;

97 
	}
}

100 
	$chash°r
(*
s
, 
maxn
)

102 
h
;

103 *
p
;

104 
i
;

105 
h
 = 0, 
i
 = 
maxn
, 
p
 = (*)
s
; *p && --i >= 0;Ö++)

106 
h
 = 
T
[h ^ *
p
];

107  
h
;

108 
	}
}

	@hash.h

1 
hash°r16
(*
s
, 
maxn
);

2 
hash°r
(*
s
, 
maxn
, 
hashs
);

	@hname.c

32 
	~<°dio.h
>

33 
	~<°rög.h
>

34 
	~<î∫o.h
>

35 
	~<sig«l.h
>

36 
	~<sys/∑øm.h
>

37 
	~<sys/ty≥s.h
>

38 
	~<sys/sockë.h
>

39 
	~<√töë/ö.h
>

40 
	~<¨∑/öë.h
>

41 
	~"c⁄fig.h
"

42 
	~"löt.h
"

43 
	~"√t.h
"

44 
	~"comm.h
"

45 
	~"nqueue.h
"

46 
	~"ndesc.h
"

47 
	~"h«me.h
"

49 #i‚de‡
INADDR_LOOPBACK


50 
	#INADDR_LOOPBACK
 0x7f000001

	)

53 #i‚de‡
INADDR_NONE


54 
	#INADDR_NONE
 0xffffffff

	)

57 #i‚de‡
EPROTO


58 
	#EPROTO
 
EPROTOTYPE


	)

61 
öãø˘ive
 *
Æl_∂ayîs
[
MAX_PLAYERS
];

63 #i‚de‡
NO_IP_DEMON


73 
u_ch¨
 
	mh_Êags
;

74 
nqueue_t
 * 
	mh_øwq
;

75 
nqueue_t
 * 
	mh_ˇnq
;

76 
nqueue_t
 * 
	mh_outq
;

77 } 
	th«me_t
;

82 
	#HF_CLOSE
 0x01

	)

83 
	#HF_ENABR
 0x02

	)

84 
	#HF_ENABW
 0x04

	)

89 
	#HNAME_RAWQ_SIZE
 128

	)

90 
	#HNAME_CANQ_SIZE
 128

	)

91 
	#HNAME_OUTQ_SIZE
 128

	)

93 
ndesc_t
 *
	gh«me_nd
 = 
NULL
;

98 
h«me_t
 *

99 
	$h«me_Æloc
()

101 
h«me_t
 *
hp
;

103 
hp
 = 
	`xÆloc
( (
h«me_t
));

104 
hp
->
h_Êags
 = 
HF_ENABW
;

105 
hp
->
h_øwq
 = 
	`nq_Æloc
(
HNAME_RAWQ_SIZE
);

106 
hp
->
h_ˇnq
 = 
	`nq_Æloc
(
HNAME_CANQ_SIZE
);

107 
hp
->
h_outq
 = 
	`nq_Æloc
(
HNAME_OUTQ_SIZE
);

109  
hp
;

110 
	}
}

116 
	$h«me_‰ì
(
h«me_t
 *
hp
)

118 
	`nq_‰ì
(
hp
->
h_øwq
);

119 
	`nq_‰ì
(
hp
->
h_ˇnq
);

120 
	`nq_‰ì
(
hp
->
h_outq
);

121 
	`‰ì
(
hp
);

122 
	}
}

128 
	$h«me_öput
(*
˝
)

130 
¡ok
, 
Õ‹t
, 
Ω‹t
, 
i
;

131 *
tok
[5];

132 
u_l⁄g
 
addr
;

133 
öãø˘ive
 *
ù
;

134 *
£p
[5] = { " ", ",\n", ",", ":", "\n" };

136 
¡ok
 = 0;Çtok < 5;Çtok++)

138 
˝
 = 
	`°πok
(
¡ok
 =0 ? c∞: 
NULL
, 
£p
[ntok]);

139 i‡(
˝
 =
NULL
)

141 
tok
[
¡ok
] = 
˝
;

144 i‡(
¡ok
 != 2 &&Çtok != 4 &&Çtok != 5)

147 
addr
 = 
	`öë_addr
(
tok
[0]);

148 i‡(
addr
 =
INADDR_NONE
)

151 
	`add_ù_íåy
(
addr
, 
tok
[1]);

153 i‡(
¡ok
 != 5)

156 
Õ‹t
 = 
	`©oi
(
tok
[2]);

157 
Ω‹t
 = 
	`©oi
(
tok
[3]);

159 
i
 = 0; i < 
MAX_PLAYERS
; i++)

161 
ù
 = 
Æl_∂ayîs
[
i
];

162 i‡(
ù
 =
NULL
)

165 i‡(
ù
->
addr
.
sö_addr
.
s_addr
 ==áddr &&

166 
ù
->
Õ‹t
 ==Üport &&

167 
ù
->
Ω‹t
 ==Ñport)

169 i‡(
ù
->
∫ame
 !
NULL
)

170 
	`‰ì
(
ù
->
∫ame
);

171 
ù
->
∫ame
 = 
	`xÆloc
(
	`°æí
(
tok
[4]) + 1);

172 
	`°r˝y
(
ù
->
∫ame
, 
tok
[4]);

176 
	}
}

182 
	$h«me_£ndªq
(*
addr
, 
u_sh‹t
 
Õ‹t
, u_sh‹à
Ω‹t
)

184 
ªq
[32];

185 
h«me_t
 *
hp
;

187 i‡(
h«me_nd
 =
NULL
)

190 
hp
 = 
	`nd_vp
(
h«me_nd
);

192 
	`•rötf
(
ªq
, "%s;%u,%u\n", 
addr
, 
Õ‹t
, 
Ω‹t
);

194 i‡(
	`nq_avaû
(
hp
->
h_outq
Ë< 
	`°æí
(
ªq
))

197 
	`nq_puts
(
hp
->
h_outq
, (
u_ch¨
 *)
ªq
);

199 i‡(
hp
->
h_Êags
 & 
HF_ENABW
)

201 
hp
->
h_Êags
 &~
HF_ENABW
;

202 
	`nd_íabÀ
(
h«me_nd
, 
ND_W
);

204 
	}
}

210 
	$h«me_disc⁄√˘
(
ndesc_t
 *
nd
, 
h«me_t
 *
hp
)

212 i‡(
hp
->
h_Êags
 & 
HF_CLOSE
)

215 
hp
->
h_Êags
 |
HF_CLOSE
;

216 
	`nd_íabÀ
(
nd
, 
ND_C
);

217 
	}
}

223 
	$h«me_ªad
(
ndesc_t
 *
nd
, 
h«me_t
 *
hp
)

225 
cc
;

227 i‡(!
	`nq_fuŒ
(
hp
->
h_øwq
))

229 
cc
 = 
	`nq_ªcv
(
hp
->
h_øwq
, 
	`nd_fd
(
nd
), 
NULL
);

230 i‡(
cc
 == -1)

232 
î∫o
)

234 
EWOULDBLOCK
:

235 
EINTR
:

236 
EPROTO
:

240 
	`h«me_disc⁄√˘
(
nd
, 
hp
);

245 i‡(
cc
 == 0)

247 
	`h«me_disc⁄√˘
(
nd
, 
hp
);

251 
	`nd_íabÀ
(
nd
, 
ND_C
);

253 i‡(!
	`nq_fuŒ
(
hp
->
h_øwq
))

257 
hp
->
h_Êags
 |
HF_ENABR
;

258 
	`nd_dißbÀ
(
nd
, 
ND_R
);

259 
	}
}

265 
	$h«me_wrôe
(
ndesc_t
 *
nd
, 
h«me_t
 *
hp
)

267 i‡(!
	`nq_em±y
(
hp
->
h_outq
))

269 i‡(
	`nq_£nd
(
hp
->
h_outq
, 
	`nd_fd
(
nd
), 
NULL
) == -1)

271 
î∫o
)

273 
EWOULDBLOCK
:

274 
EINTR
:

275 
EPROTO
:

279 
	`h«me_disc⁄√˘
(
nd
, 
hp
);

284 i‡(!
	`nq_em±y
(
hp
->
h_outq
))

288 
	`nq_öô
(
hp
->
h_outq
);

290 
hp
->
h_Êags
 |
HF_ENABW
;

291 
	`nd_dißbÀ
(
nd
, 
ND_W
);

292 
	}
}

298 
	$h«me_shutdown
(
ndesc_t
 *
nd
, 
h«me_t
 *
hp
)

300 ()
	`˛o£
(
	`nd_fd
(
nd
));

301 
	`nd_dëach
(
nd
);

302 
	`h«me_‰ì
(
hp
);

303 
h«me_nd
 = 
NULL
;

304 
	}
}

310 
	$h«me_˛ónup
(
ndesc_t
 *
nd
, 
h«me_t
 *
hp
)

312 
u_ch¨
 
c
;

314 i‡(
hp
->
h_Êags
 & 
HF_CLOSE
)

316 
	`h«me_shutdown
(
nd
, 
hp
);

322 i‡(
	`nq_em±y
(
hp
->
h_øwq
))

324 
	`nq_öô
(
hp
->
h_øwq
);

325 i‡(
hp
->
h_Êags
 & 
HF_ENABR
)

327 
hp
->
h_Êags
 &~
HF_ENABR
;

328 
	`nd_íabÀ
(
nd
, 
ND_R
);

330 
	`nd_dißbÀ
(
nd
, 
ND_C
);

333 
c
 = 
	`nq_gëc
(
hp
->
h_øwq
);

334 i‡(
c
 == '\n')

336 i‡(!
	`nq_fuŒ
(
hp
->
h_ˇnq
))

337 
	`nq_putc
(
hp
->
h_ˇnq
, 
c
);

340 i‡(!
	`nq_fuŒ
(
hp
->
h_ˇnq
))

342 
	`nq_putc
(
hp
->
h_ˇnq
, '\0');

343 
	`h«me_öput
((*)
	`nq_Ωå
(
hp
->
h_ˇnq
));

346 
	`nq_öô
(
hp
->
h_ˇnq
);

348 
	}
}

354 
	$h«me_öô
()

356 
s
, 
ns
, 
addæí
, 
pid
;

357 
sockaddr_ö
 
addr
;

358 
∑th
[
MAXPATHLEN
];

359 
h«me_t
 *
hp
;

361 
s
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 
IPPROTO_TCP
);

362 i‡(
s
 == -1)

365 
	`mem£t
(&
addr
, 0,  (addr));

366 
addr
.
sö_Ámûy
 = 
AF_INET
;

367 
addr
.
sö_p‹t
 = 0;

368 
addr
.
sö_addr
.
s_addr
 = 
	`ht⁄l
(
INADDR_LOOPBACK
);

370 i‡(
	`böd
(
s
, (
sockaddr
 *)&
addr
,  (addr)) == -1)

372 ()
	`˛o£
(
s
);

376 
addæí
 =  (
addr
);

378 i‡(
	`gësock«me
(
s
, (
sockaddr
 *)&
addr
, &
addæí
) == -1)

380 ()
	`˛o£
(
s
);

384 i‡(
	`li°í
(
s
, 1) == -1)

386 ()
	`˛o£
(
s
);

390 
pid
 = 
	`f‹k
();

391 i‡(
pid
 == -1)

393 ()
	`˛o£
(
s
);

397 i‡(
pid
 == 0)

399 
ns
 = 
	`ac˚±
(
s
, (
sockaddr
 *)&
addr
, &
addæí
);

400 i‡(
ns
 == -1)

402 ()
	`˛o£
(
s
);

403 
	`exô
(1);

406 ()
	`˛o£
(
s
);

408 ()
	`dup2
(
ns
, 0);

409 ()
	`dup2
(
ns
, 1);

411 
s
 = 3; s < 
FD_SETSIZE
; s++)

412 ()
	`˛o£
(
s
);

414 
	`°∫˝y
(
∑th
, 
BINDIR
,  (path));

415 
	`°∫ˇt
(
∑th
, "/hname",  (path));

417 ()
	`exe˛
(
∑th
, "hname", 0);

419 ()
	`Ârötf
(
°dîr
, "exec of hname failed.\n");

421 
	`exô
(1);

425 ()
	`˛o£
(
s
);

427 
s
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 
IPPROTO_TCP
);

428 i‡(
s
 == -1)

430 
	`kûl
(
pid
, 
SIGKILL
);

434 i‡(
	`c⁄√˘
(
s
, (
sockaddr
 *)&
addr
,  (addr)) == -1)

436 ()
	`˛o£
(
s
);

437 
	`kûl
(
pid
, 
SIGKILL
);

441 
	`íabÀ_nbio
(
s
);

443 
hp
 = 
	`h«me_Æloc
();

444 
h«me_nd
 = 
	`nd_©èch
(
s
, 
h«me_ªad
, 
h«me_wrôe
, 
NULL
,

445 
h«me_˛ónup
, 
h«me_shutdown
, 
hp
);

446 
	`nd_íabÀ
(
h«me_nd
, 
ND_R
);

448 
	}
}

	@hname.h

32 
h«me_öô
();

33 
h«me_£ndªq
(*, 
u_sh‹t
, u_short);

	@incralloc.h

8 
	smem_block
 {

9 *
	mblock
;

10 
	mcuºít_size
;

11 
	mmax_size
;

14 
	#START_BLOCK_SIZE
 4096

	)

	@inline_eqs.h

1 #i‡
deföed
(
PROFILE
Ë|| !deföed(
__GNUC__
)

2 
equÆ_svÆue
(c⁄° 
svÆue
 *, const svalue *);

4 
__ölöe__
 

5 
	$equÆ_svÆue
(c⁄° 
svÆue
 *
svÆ1
, c⁄° svÆuê*
svÆ2
)

7 i‡(
svÆ1
->
ty≥
 =
T_NUMBER
 && svÆ1->
u
.
numbî
 == 0 &&

8 
svÆ2
->
ty≥
 =
T_OBJECT
 && svÆ2->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
)

10 i‡(
svÆ2
->
ty≥
 =
T_NUMBER
 && svÆ2->
u
.
numbî
 == 0 &&

11 
svÆ1
->
ty≥
 =
T_OBJECT
 && svÆ1->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
)

13 i‡(
svÆ2
->
ty≥
 =
T_NUMBER
 && svÆ2->
u
.
numbî
 == 0 &&

14 
svÆ1
->
ty≥
 =
T_FUNCTION
 && !
	`ÀgÆ_˛osuª
(svÆ1->
u
.
func
))

16 i‡(
svÆ2
->
ty≥
 =
T_NUMBER
 && svÆ2->
u
.
numbî
 == 0 &&

17 
svÆ1
->
ty≥
 =
T_FUNCTION
 && !
	`ÀgÆ_˛osuª
(svÆ1->
u
.
func
))

19 i‡(
svÆ1
->
ty≥
 !
svÆ2
->type)

21 
svÆ1
->
ty≥
) {

22 
T_NUMBER
:

23  
svÆ1
->
u
.
numbî
 =
svÆ2
->u.number;

24 
T_POINTER
:

25  
svÆ1
->
u
.
vec
 =
svÆ2
->u.vec;

26 
T_MAPPING
:

27  
svÆ1
->
u
.
m≠
 =
svÆ2
->u.map;

28 
T_STRING
:

29  
svÆ1
->
u
.
°rög
 =
svÆ2
->u.string ||

30 
	`°rcmp
(
svÆ1
->
u
.
°rög
, 
svÆ2
->u.string) == 0;

31 
T_OBJECT
:

32  ((
svÆ1
->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
Ë&& (
svÆ2
->u.ob->flags & O_DESTRUCTED)) ||

33 
svÆ1
->
u
.
ob
 =
svÆ2
->u.ob;

34 
T_FLOAT
:

35  
svÆ1
->
u
.
ªÆ
 =
svÆ2
->u.real;

36 
T_FUNCTION
:

37  
svÆ1
->
u
.
func
 =
svÆ2
->u.func;

40 
	}
}

	@inline_svalue.h

1 #i‡
deföed
(
PROFILE
Ë|| !deföed(
__GNUC__
)

2 
‰ì_svÆue
(
svÆue
 *);

4 
__ölöe__
 

5 
	$‰ì_svÆue
(
svÆue
 *
v
)

7 i‡(
v
->
ty≥
 & 
T_LVALUE
)

9 
v
->
ty≥
) {

10 
T_NUMBER
:

11 
T_FLOAT
:

13 
T_STRING
:

14 
v
->
°rög_ty≥
) {

15 
STRING_MSTRING
:

16 
	`‰ì_m°rög
(
v
->
u
.
°rög
);

18 
STRING_SSTRING
:

19 
	`‰ì_s°rög
(
v
->
u
.
°rög
);

21 
STRING_CSTRING
:

25 
T_OBJECT
:

26 
	`‰ì_obje˘
(
v
->
u
.
ob
, "free_svalue");

28 
T_POINTER
:

29 
	`‰ì_ve˘‹
(
v
->
u
.
vec
);

31 
T_MAPPING
:

32 
	`‰ì_m≠pög
(
v
->
u
.
m≠
);

34 
T_FUNCTION
:

35 
	`‰ì_˛osuª
(
v
->
u
.
func
);

38 
	`Áèl
("Invalid value of variable!\n");

41 *
v
 = 
c⁄°0
;

42 
	}
}

	@instrs.h

7 
	sö°r
 {

8 
	mmax_¨g
, 
	mmö_¨g
;

9 
	mty≥
[2];

10 
	mDeÁu…
;

11 
	mªt_ty≥
;

12 *
	m«me
;

13 
	m¨g_ödex
;

16 
ö°r
 
ö°rs
[];

	@interface.c

1 
	~<°dio.h
>

2 
	~<°rög.h
>

3 
	~"löt.h
"

4 
	~"öãrÁ˚.h
"

6 
öô_cfuns
();

8 
öãrÁ˚
 
efun
;

9 
öãrÁ˚
 
°dobje˘
;

10 
öãrÁ˚
 
gl_œnguage
;

12 
	göãrÁ˚
 *(interface[]) =

14 &
efun
,

15 &
°dobje˘
,

16 &
gl_œnguage
,

17 (
öãrÁ˚
 *)0,

22 
	$gë_C_fun_addªss
(*
¥og_«me
, *
«me
))(
svÆue
 *)

24 
i
, 
j
;

25 
i
 = 0; 
öãrÁ˚
[i]; i++)

26 i‡(
	`°rcmp
(
öãrÁ˚
[
i
]->
¥ogøm
, 
¥og_«me
) == 0)

27 
j
 = 0; 
öãrÁ˚
[
i
]->
funcs
[j]; j++)

28 i‡(
	`°rcmp
(
öãrÁ˚
[
i
]->
funcs
[
j
]->
«me
,Çame) == 0)

29  
öãrÁ˚
[
i
]->
funcs
[
j
]->
addªss
;

31  ((*)(
svÆue
 *))0;

32 
	}
}

35 
	$öô_cfuns
()

37 
i
,
j
;

39 
i
 = 0; 
öãrÁ˚
[i]; i++)

40 
j
 = 0; 
öãrÁ˚
[
i
]->
v¨s
[j]; j++)

41 
öãrÁ˚
[
i
]->
v¨s
[
j
]->
num
 = j;

42 
	}
}

	@interface.h

1 
	~"c⁄fig.h
"

2 
	~"exec.h
"

3 
	~"öãΩªt.h
"

5 
	#VAR
(
i
Ë(
cuºít_obje˘
->
v¨übÀs
[\

6 
cuºít_obje˘
->
¥og
->
öhîô
[
öh_off£t
 +\

7 
cuºít_¥og
->
cfuns
[(
i
).
num
].
öh
].\

8 
v¨übÀ_ödex_off£t
 +\

9 
cuºít_¥og
->
cfuns
[(
i
).
num
].
idx
])

	)

11 
	sv¨_öfo


13 *
	m«me
;

14 
	mnum
;

15 } 
	tv¨
;

17 
	sfunc_öfo


19 *
	m«me
;

20 (*
	maddªss
)(
	msvÆue
 *);

21 } 
	tfunc
;

23 
	söãrÁ˚


25 *
	m¥ogøm
;

26 
v¨
 **
	mv¨s
;

27 
func
 **
	mfuncs
;

30 
öãrÁ˚
 *(interface[]);

	@interpret.c

1 
	~<v¨¨gs.h
>

2 
	~<°dio.h
>

3 
	~<°dlib.h
>

4 
	~<°rög.h
>

5 
	~<˘y≥.h
>

6 
	~<sys/time.h
>

7 
	~<sys/ty≥s.h
>

8 
	~<sys/°©.h
>

10 
	~<mem‹y.h
>

12 
	~<limôs.h
>

13 
	~<m©h.h
>

14 
	~<Êﬂt.h
>

16 
	~"c⁄fig.h
"

17 
	~"löt.h
"

18 
	~"m°rög.h
"

19 
	~"œng.h
"

20 
	~"exec.h
"

21 
	~"öãΩªt.h
"

22 
	~"obje˘.h
"

23 
	~"ö°rs.h
"

24 
	~"comm.h
"

25 
	~"m≠pög.h
"

26 
	~"mud°©.h
"

27 
	~"Àx.h
"

28 
	~"comm1.h
"

29 
	~"simuœã.h
"

30 
	~"sw≠.h
"

31 
	~"maö.h
"

33 
	~"ölöe_eqs.h
"

34 
	~"ölöe_svÆue.h
"

36 
	~"efun_èbÀ.h
"

38 #ifde‡
RUSAGE


39 #i‚de‡
SOLARIS


40 
	~<sys/ªsour˚.h
>

41 
gërußge
 (, 
rußge
 *);

42 #ifde‡
sun


43 
gë∑gesize
();

45 #i‚de‡
RUSAGE_SELF


46 
	#RUSAGE_SELF
 0

	)

49 
	~<sys/times.h
>

50 
	~<limôs.h
>

54 
	#FLOATASGOP
(
lhs
, 
›
, 
rhs
) { \

55 
x
, 
y
; \

56 
x
 = ()
rhs
; \

57 
y
 = ()
lhs
; \

58 
y
 
›
 
x
; \

59 
x
 = 
	`Ábs
(
y
); \

60 i‡(
x
 > 
FLT_MAX
Ë
	`îr‹
("FloatingÖoint overflow"); \

61 i‡(
x
 < 
FLT_MIN
Ë
y
 = 0.0; \

62 
lhs
 = ()
y
; \

63 }

	)

65 
	sfk¡ab


67 *
	m«me
;

68 
	möhîô_ödex
;

69 
	mfun˘i⁄_ödex
;

72 
obje˘
 *
ma°î_ob
;

74 
ve˘‹
 *
öhîô_li°
 (
obje˘
 *);

75 
svÆue
 *
ßµly
 (*, 
obje˘
 *, , );

76 #ifde‡
TRACE_CODE


77 
do_åa˚
 (*, *, *);

78 
°Ωªf
 (*, *);

80 
≠∂y_low
 (*, 
obje˘
 *, , );

81 
do_ª«me
 (*, *);

82 
öãr_ssˇnf
 ();

83 
wûdm©
(*, *);

84 
˛osuª
 *
Æloc_obj˛osuª
(
·y≥
, 
funöh
, 
fu¬o
, 
obje˘
 *
ob
, *
ªf°r
, 
u£ˇche
);

85 
˛osuª
 *
Æloc_obj˛osuª°r
(
·y≥
, *
fun°r
, 
obje˘
 *
ob
, *
ªf°r
, 
u£ˇche
);

86 
INLINE
 
£¨ch_f‹_fun˘i⁄
(*
«me
, 
¥ogøm
 *
¥og
);

87 #ifde‡
DEBUG


88 
bªak_poöt
 ();

90 
s_f_f
(*
«me
, 
¥ogøm
 *
¥og
);

91 
ma°î_ob_lﬂded
 ();

93 
obje˘
 *
¥evious_ob
;

94 *
œ°_vîb
, *
åig_vîb
;

95 
¥ogøm
 *
	gcuºít_¥og
;

96 
cuºít_time
, 
s_Êag
, 
u∆imôed
;

97 
obje˘
 *
cuºít_öãø˘ive
;

98 
	gv¨übÀ_ödex_found
;

99 
	gv¨übÀ_öhîô_found
;

100 
	gv¨übÀ_ty≥_mod_found
;

101 
	gˇche_åõs
 = 0, 
	gˇche_hôs
 = 0;

103 
	gnum_˛osuªs
, 
	gtŸÆ_˛osuª_size
;

105 #ifde‡
CACHE_STATS


106 
	gˇŒ_ˇche_ßves
 = 0;

107 
	gglobÆ_ˇche_ßves
 = 0;

108 
	g£¨ches_√eded
 = 0;

109 
	g£¨ches_d⁄e
 = 0;

111 
	gglobÆ_fú°_ßves
 = 0;

112 
	gˇŒ_fú°_ßves
 = 0;

115 
	gåa˚dïth
;

116 
	#TRACE_CALL
 1

	)

117 
	#TRACE_CALL_OTHER
 2

	)

118 
	#TRACE_RETURN
 4

	)

119 
	#TRACE_ARGS
 8

	)

120 
	#TRACE_EXEC
 16

	)

121 
	#TRACE_TOS
 32

	)

122 
	#TRACE_APPLY
 64

	)

123 
	#TRACE_OBJNAME
 128

	)

124 
	#TRACE_HEART_BEAT
 512

	)

125 
	#TRACETST
(
b
Ë(
cuºít_öãø˘ive
->
öãø˘ive
->
åa˚_Àvñ
 & (b))

	)

126 
	#TRACEP
(
b
) \

127 (
cuºít_öãø˘ive
 && cuºít_öãø˘ive->
öãø˘ive
 && 
	`TRACETST
(
b
) && \

128 (
cuºít_öãø˘ive
->
öãø˘ive
->
åa˚_¥efix
 == 0 || \

129 (
cuºít_obje˘
 && 
	`°Ωªf
(
cuºít_öãø˘ive
->
öãø˘ive
->
åa˚_¥efix
, \

130 
cuºít_obje˘
->
«me
))Ë)

	)

145 
d_Êag
;

147 
cuºít_löe
, 
evÆ_co°
;

155 *
	gpc
;

156 
svÆue
 *
	gÂ
;

157 
svÆue
 *
	g•
;

158 
	göh_off£t
;

160 
svÆue
 
	g°¨t_of_°ack
[
EVALUATOR_STACK_SIZE
];

161 
svÆue
 
	gˇtch_vÆue
;

163 
c⁄åﬁ_°ack
 
	gc⁄åﬁ_°ack
[
MAX_TRACE
];

164 
c⁄åﬁ_°ack
 *
	gc•
;

166 #ifde‡
COUNT_CALLS


167 
	gnum_ˇŒ_£lf
, 
	gnum_ˇŒ_down
, 
	gnum_ˇŒ_Ÿhî
;

174 
	gfun˘i⁄_öhîô_found
 = -1;

175 
¥ogøm
 *
	gfun˘i⁄_¥og_found
 = 0;

176 
	gfun˘i⁄_ödex_found
 = -1;

177 
	gfun˘i⁄_ty≥_mod_found
 = 0;

200 
INLINE
 

201 
	$¥obe_°ack
(
n
)

203 i‡(
•
 + 
n
 >&
°¨t_of_°ack
[
EVALUATOR_STACK_SIZE
])

204 
	`îr‹
("stack overflow\n");

205 
	}
}

210 
INLINE
 

211 
	$exãnd_°ack
()

213 
	`¥obe_°ack
(1);

214 ++
•
;

215 
	}
}

222 
INLINE
 

223 
	$push_obje˘
(
obje˘
 *
ob
)

225 
	`exãnd_°ack
();

226 i‡(
ob
 !
NULL
 && !(ob->
Êags
 & 
O_DESTRUCTED
))

228 
•
->
ty≥
 = 
T_OBJECT
;

229 
•
->
u
.
ob
 = ob;

230 
	`add_ªf
(
ob
, "push_object");

234 *
•
 = 
c⁄°0
;

236 
	}
}

241 
INLINE
 

242 
	$push_numbî
(
n
)

244 
	`exãnd_°ack
();

245 
•
->
ty≥
 = 
T_NUMBER
;

246 
•
->
u
.
numbî
 = 
n
;

247 
	}
}

249 
INLINE
 

250 
	$push_Êﬂt
(
f
)

252 
	`exãnd_°ack
();

253 i‡(
	`Ábs
(
f
Ë> 
FLT_MAX
)

254 
	`îr‹
("FloatingÖointer overflow.");

255 i‡(
	`Ábs
(
f
Ë< 
FLT_MIN
)

256 
f
 = 0.0;

257 
•
->
ty≥
 = 
T_FLOAT
;

258 
•
->
u
.
ªÆ
 = 
f
;

259 
	}
}

262 
	$chkÊﬂå™ge
(
f
)

264 i‡(
	`Ábs
(
f
Ë> 
FLT_MAX
)

265 
	`îr‹
("FloatingÖointer overflow.");

266 i‡(
	`Ábs
(
f
Ë< 
FLT_MIN
)

267 
f
 = 0.0;

268  ()
f
;

269 
	}
}

271 
INLINE
 

272 
	$push_fun˘i⁄
(
˛osuª
 *
func
, 
boﬁ_t
 
ª„ªn˚
)

274 
	`exãnd_°ack
();

275 
•
->
ty≥
 = 
T_FUNCTION
;

276 
•
->
u
.
func
 = func;

277 i‡(
ª„ªn˚
)

278 
	`INCREF
(
func
->
ªf
);

279 
	}
}

284 
INLINE
 

285 
	$push_°rög
(*
p
, 
ty≥
)

287 
	`exãnd_°ack
();

288 
•
->
ty≥
 = 
T_STRING
;

289 
•
->
°rög_ty≥
 = 
ty≥
;

290 
ty≥
) {

291 
STRING_MSTRING
:

292 
•
->
u
.
°rög
 = 
	`make_m°rög
(
p
);

294 
STRING_SSTRING
:

295 
•
->
u
.
°rög
 = 
	`make_s°rög
(
p
);

297 
STRING_CSTRING
:

298 
•
->
u
.
°rög
 = 
p
;

301 
	}
}

306 
INLINE
 
svÆue
 *

307 
	$föd_vÆue
(
öh
, 
∫um
)

309 
num
;

310 i‡((
öh
 =255 && 
∫um
 == 255))

312 
	`îr‹
("Referencing undefined variable (inh == %d, var_num == %d, variablesáre %s).\n",

313 
öh
, 
∫um
, 
cuºít_obje˘
->
v¨übÀs
?"defined":"undefined");

315 i‡(
öh
 == 255)

316 
öh
 = 0;

318 
öh
 -
cuºít_¥og
->
num_öhîôed
 - 1;

319 #ifde‡
DEBUG


320 i‡(
öh
 > 0)

321 
	`Áèl
("Illegal variableáccess, %d(off %d). SeeÅraceábove.\n",

322 
öh
, 
cuºít_¥og
->
num_öhîôed
);

323 i‡(
∫um
 > 
cuºít_obje˘
->
¥og
->
öhîô
[
öh_off£t
 + 
öh
].¥og->
num_v¨übÀs
 - 1)

324 
	`Áèl
("Illegal variableáccess, variable %d(off %d, in %d). SeeÅraceábove.\n",

325 
∫um
, 
cuºít_obje˘
->
¥og
->
öhîô
[
öh_off£t
 + 
öh
].¥og->
num_v¨übÀs
,

326 
öh_off£t
 + 
öh
);

328 
num
 = 
cuºít_obje˘
->
¥og
->

329 
öhîô
[
öh_off£t
 + 
öh
].
v¨übÀ_ödex_off£t
 + 
∫um
;

331  &
cuºít_obje˘
->
v¨übÀs
[
num
];

332 
	}
}

338 #i‡
deföed
(
PROFILE
Ë|| !deföed(
__GNUC__
)

340 
	$‰ì_svÆue
(
svÆue
 *
v
)

342 i‡(
v
->
ty≥
 & 
T_LVALUE
)

344 
v
->
ty≥
) {

345 
T_NUMBER
:

346 
T_FLOAT
:

348 
T_STRING
:

349 
v
->
°rög_ty≥
) {

350 
STRING_MSTRING
:

351 
	`‰ì_m°rög
(
v
->
u
.
°rög
);

353 
STRING_SSTRING
:

354 
	`‰ì_s°rög
(
v
->
u
.
°rög
);

356 
STRING_CSTRING
:

360 
T_OBJECT
:

361 
	`‰ì_obje˘
(
v
->
u
.
ob
, "free_svalue");

363 
T_POINTER
:

364 
	`‰ì_ve˘‹
(
v
->
u
.
vec
);

366 
T_MAPPING
:

367 
	`‰ì_m≠pög
(
v
->
u
.
m≠
);

369 
T_FUNCTION
:

370 
	`‰ì_˛osuª
(
v
->
u
.
func
);

373 
	`Áèl
("Invalid value of variable!\n");

376 *
v
 = 
c⁄°0
;

377 
	}
}

380 
	$equÆ_svÆue
(c⁄° 
svÆue
 *
svÆ1
, c⁄° svÆuê*
svÆ2
)

382 i‡(
svÆ1
->
ty≥
 =
T_NUMBER
 && svÆ1->
u
.
numbî
 == 0 &&

383 
svÆ2
->
ty≥
 =
T_OBJECT
 && svÆ2->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
)

385 i‡(
svÆ2
->
ty≥
 =
T_NUMBER
 && svÆ2->
u
.
numbî
 == 0 &&

386 
svÆ1
->
ty≥
 =
T_OBJECT
 && svÆ1->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
)

388 i‡(
svÆ2
->
ty≥
 =
T_NUMBER
 && svÆ2->
u
.
numbî
 == 0 &&

389 
svÆ1
->
ty≥
 =
T_FUNCTION
 && !
	`ÀgÆ_˛osuª
(svÆ1->
u
.
func
))

391 i‡(
svÆ2
->
ty≥
 =
T_NUMBER
 && svÆ2->
u
.
numbî
 == 0 &&

392 
svÆ1
->
ty≥
 =
T_FUNCTION
 && !
	`ÀgÆ_˛osuª
(svÆ1->
u
.
func
))

394 i‡(
svÆ1
->
ty≥
 !
svÆ2
->type)

396 
svÆ1
->
ty≥
) {

397 
T_NUMBER
:

398  
svÆ1
->
u
.
numbî
 =
svÆ2
->u.number;

399 
T_POINTER
:

400  
svÆ1
->
u
.
vec
 =
svÆ2
->u.vec;

401 
T_MAPPING
:

402  
svÆ1
->
u
.
m≠
 =
svÆ2
->u.map;

403 
T_STRING
:

404  
svÆ1
->
u
.
°rög
 =
svÆ2
->u.string ||

405 
	`°rcmp
(
svÆ1
->
u
.
°rög
, 
svÆ2
->u.string) == 0;

406 
T_OBJECT
:

407  ((
svÆ1
->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
Ë&& (
svÆ2
->u.ob->flags & O_DESTRUCTED)) ||

408 
svÆ1
->
u
.
ob
 =
svÆ2
->u.ob;

409 
T_FLOAT
:

410  
svÆ1
->
u
.
ªÆ
 =
svÆ2
->u.real;

411 
T_FUNCTION
:

412  
svÆ1
->
u
.
func
 =
svÆ2
->u.func;

415 
	}
}

422 
	$add_¶ash
(*
˝
)

424 
size_t
 
Àn
;

425 *
xp
;

427 
Àn
 = 
	`°æí
(
˝
) + 1;

428 
xp
 = 
	`Æloˇã_m°rög
(
Àn
);

429 
xp
[0] = '/';

430 ()
	`mem˝y
(&
xp
[1], 
˝
, 
Àn
);

431  
xp
;

432 
	}
}

440 
INLINE
 

441 
	$assign_svÆue_no_‰ì
(
svÆue
 *
to
, svÆuê*
‰om
)

443 #ifde‡
DEBUG


444 i‡(
‰om
 == 0)

445 
	`Áèl
("NullÖointerÅoássign_svalue().\n");

447 *
to
 = *
‰om
;

448 
‰om
->
ty≥
) {

449 
T_STRING
:

450 
‰om
->
°rög_ty≥
) {

451 
STRING_MSTRING
:

452 ()
	`ª„ªn˚_m°rög
(
‰om
->
u
.
°rög
);

454 
STRING_SSTRING
:

455 ()
	`ª„ªn˚_s°rög
(
‰om
->
u
.
°rög
);

457 
STRING_CSTRING
:

460 
	`Áèl
("Bad såögÅy≥ %d\n", 
‰om
->
°rög_ty≥
);

463 
T_OBJECT
:

464 
	`add_ªf
(
to
->
u
.
ob
, "assÅo var");

466 
T_POINTER
:

467 
	`INCREF
(
to
->
u
.
vec
->
ªf
);

469 
T_MAPPING
:

470 
	`INCREF
(
to
->
u
.
m≠
->
ªf
);

472 
T_FUNCTION
:

473 
	`INCREF
(
to
->
u
.
func
->
ªf
);

476 
	}
}

478 
INLINE
 

479 
	$assign_svÆue
(
svÆue
 *
de°
, svÆuê*
v
)

482 
	`‰ì_svÆue
(
de°
);

483 
	`assign_svÆue_no_‰ì
(
de°
, 
v
);

484 
	}
}

491 
	$push_svÆue
(
svÆue
 *
v
)

493 
	`exãnd_°ack
();

494 
	`assign_svÆue_no_‰ì
(
•
, 
v
);

495 
	}
}

503 
INLINE


504 
	$p›_°ack
()

506 #ifde‡
DEBUG


507 i‡(
•
 < 
°¨t_of_°ack
)

508 
	`Áèl
("Stack underflow.\n");

510 
	`‰ì_svÆue
(
•
--);

511 
	}
}

516 
INLINE
 

517 
	$push_ödexed_lvÆue
(
√edlvÆ
)

519 
svÆue
 *
i
, *
vec
, *
ôem
;

520 
öd
 = 0;

522 
i
 = 
•
;

523 
vec
 = 
•
 - 1;

524 i‡(
vec
->
ty≥
 !
T_MAPPING
)

526 i‡(
i
->
ty≥
 !
T_NUMBER
 || i->
u
.
numbî
 < 0)

527 
	`îr‹
("Illegal index\n");

528 
öd
 = 
i
->
u
.
numbî
;

530 
vec
->
ty≥
) {

531 
T_STRING
: {

532 
svÆue
 
⁄e_ch¨a˘î
;

534 
	`p›_°ack
();

535 
⁄e_ch¨a˘î
.
ty≥
 = 
T_NUMBER
;

536 i‡(
öd
 > 
	`°æí
(
vec
->
u
.
°rög
) || ind < 0)

537 
⁄e_ch¨a˘î
.
u
.
numbî
 = 0;

539 
⁄e_ch¨a˘î
.
u
.
numbî
 = 
vec
->u.
°rög
[
öd
];

540 
	`‰ì_svÆue
(
•
);

541 
•
->
ty≥
 = 
T_LVALUE
;

542 
•
->
u
.
lvÆue
 = &
⁄e_ch¨a˘î
;

544 
T_POINTER
:

545 
	`p›_°ack
();

546 i‡(
öd
 >
vec
->
u
.vec->
size
)

547 
	`îr‹
 ("Index out of bounds. Vector size: %d, index: %d\n",

548 
vec
->
u
.vec->
size
, 
öd
);

549 
ôem
 = &
vec
->
u
.vec->ôem[
öd
];

550 i‡(
vec
->
u
.vec->
ªf
 == 1) {

551 
svÆue
 
quickfix
 = { 
T_NUMBER
 };

554 
	`assign_svÆue
 (&
quickfix
, 
ôem
);

555 
ôem
 = &
quickfix
;

557 
	`‰ì_svÆue
(
•
);

558 
•
->
ty≥
 = 
T_LVALUE
;

559 
•
->
u
.
lvÆue
 = 
ôem
;

561 
T_MAPPING
:

562 
ôem
 = 
	`gë_m≠_lvÆue
(
vec
->
u
.
m≠
, 
i
, 
√edlvÆ
);

563 
	`p›_°ack
();

564 i‡(
vec
->
u
.
m≠
->
ªf
 == 1) {

565 
svÆue
 
quickfix
 = { 
T_NUMBER
 };

566 
	`assign_svÆue
 (&
quickfix
, 
ôem
);

567 
ôem
 = &
quickfix
;

569 
	`‰ì_svÆue
(
•
);

570 
•
->
ty≥
 = 
T_LVALUE
;

571 
•
->
u
.
lvÆue
 = 
ôem
;

574 
	`îr‹
("Indexing on illegalÅype.\n");

577 
	}
}

579 #ifde‡
OPCPROF


580 
	#MAXOPC
 512

	)

581 
	g›cou¡
[
MAXOPC
];

587 
INLINE


588 
	$p›_n_ñems
(
n
)

590 #ifde‡
DEBUG


591 i‡(
n
 < 0)

592 
	`Áèl
("p›_n_ñems: %dÉÀmíts.\n", 
n
);

594 ; 
n
 > 0;Ç--)

595 
	`p›_°ack
();

596 
	}
}

599 
	$bad_¨g
(
¨g
, 
ö°r
, 
svÆue
 *
sv
)

601 *
ty≥_«me
 = "Unknown";

603 
sv
->
ty≥
)

605 
T_NUMBER
:

606 
ty≥_«me
 = "Integer";

608 
T_STRING
:

609 
ty≥_«me
 = "String";

611 
T_POINTER
:

612 
ty≥_«me
 = "Array";

614 
T_OBJECT
:

615 
ty≥_«me
 = "Object";

617 
T_MAPPING
:

618 
ty≥_«me
 = "Mapping";

620 
T_FLOAT
:

621 
ty≥_«me
 = "Float";

623 
T_FUNCTION
:

624 
ty≥_«me
 = "Function";

628 
	`îr‹
("Badárgumíà%dÅÿ%s(),Ñe˚ivedÅy≥ wa†%†\n", 
¨g
, 
	`gë_f_«me
(
ö°r
), 
ty≥_«me
);

629 
	}
}

631 #ifde‡
PROFILE_FUNS


636 
	$time_funs
(
fun˘i⁄
 *
to
, fun˘i⁄ *
‰om
)

638 #ifde‡
RUSAGE


639 #ifde‡
SOLARIS


640 
tms
 
buf„r
;

641 
˛ock_t
 
ticks
;

643 i‡(
	`times
(&
buf„r
) != -1)

645 
ticks
 = 
buf„r
.
tms_utime
 + buf„r.
tms_°ime
;

646 i‡(
‰om
)

647 
‰om
->
time_•ít
 +=

648 (
ticks
 - 
‰om
->
ticks_ˇŒ
);

649 i‡(
to
)

650 
to
->
ticks_ˇŒ
 = 
ticks
;

653 
rußge
 
rus
;

654 
˝u_s
 = 0, 
˝u_us
 = 0;

656 i‡(
	`gërußge
(
RUSAGE_SELF
, &
rus
) >= 0)

658 
˝u_s
 = 
rus
.
ru_utime
.
tv_£c
 +Ñus.
ru_°ime
.tv_sec;

659 
˝u_us
 = 
rus
.
ru_utime
.
tv_u£c
 +Ñus.
ru_°ime
.tv_usec;

662 i‡(
‰om
)

664 
‰om
->
time_•ít
 +(
˝u_s
 - from->
°ime_ˇŒ
) * 100000 +

665 (
˝u_us
 - 
‰om
->
utime_ˇŒ
) / 10;

667 i‡(
to
)

669 
to
->
°ime_ˇŒ
 = 
˝u_s
;

670 
to
->
utime_ˇŒ
 = 
˝u_us
;

674 
	}
}

678 
	$ßve_c⁄åﬁ_c⁄ãxt
(
c⁄åﬁ_°ack
 *
c•1
)

680 #ifde‡
DEBUG


681 i‡(
cuºít_¥og
 && 
pc
 - cuºít_¥og->
¥ogøm
 >cuºít_¥og->
¥ogøm_size
)

682 
	`Áèl
("Invalid offset during context save\n");

684 
c•1
->
ob
 = 
cuºít_obje˘
;

685 
c•1
->
¥ev_ob
 = 
¥evious_ob
;

686 
c•1
->
Â
 = fp;

687 
c•1
->
fu≈
 = 0;

688 
c•1
->
¥og
 = 
cuºít_¥og
;

689 
c•1
->
exã∫_ˇŒ
 = 0;

690 i‡(
cuºít_¥og
)

691 
c•1
->
pc
 =Ö¯- 
cuºít_¥og
->
¥ogøm
;

692 #ifde‡
DEBUG


694 
c•1
->
pc
 = 0xdeadbeef;

696 
c•1
->
öh_off£t
 = inh_offset;

697 
	}
}

700 
	$push_c⁄åﬁ_°ack
(
fun˘i⁄
 *
fu≈
)

702 i‡(
c•
 >&
c⁄åﬁ_°ack
[
MAX_TRACE
-1])

703 
	`îr‹
("Too deepÑecursion.\n");

704 
c•
++;

705 
	`ßve_c⁄åﬁ_c⁄ãxt
(
c•
);

706 
c•
->
fu≈
 = funp;

707 #ifde‡
PROFILE_FUNS


708 i‡(
fu≈
)

709 
fu≈
->
num_ˇŒs
++;

710 
	`time_funs
(
c•
->
fu≈
, (c• =
c⁄åﬁ_°ack
) ? 0 : (csp-1)->funp);

712 
	}
}

719 
	$ª°‹e_c⁄åﬁ_c⁄ãxt
(
c⁄åﬁ_°ack
 *
c•1
)

721 
cuºít_obje˘
 = 
c•1
->
ob
;

722 #ifde‡
USE_SWAP


723 i‡(
cuºít_obje˘
)

724 
	`ac˚ss_obje˘
(
c•1
->
ob
);

727 
cuºít_¥og
 = 
c•1
->
¥og
;

728 if(
cuºít_¥og
)

730 #ifde‡
USE_SWAP


731 
	`ac˚ss_¥ogøm
(
c•1
->
¥og
);

733 
pc
 = 
cuºít_¥og
->
¥ogøm
 + 
c•1
->pc;

735 
¥evious_ob
 = 
c•1
->
¥ev_ob
;

736 
Â
 = 
c•1
->fp;

737 
öh_off£t
 = 
c•1
->inh_offset;

738 
	}
}

741 
	$p›_c⁄åﬁ_°ack
()

743 #ifde‡
DEBUG


744 i‡(
c•
 =
c⁄åﬁ_°ack
 - 1)

745 
	`Áèl
("Popped out ofÅhe control stack\n");

747 
	`ª°‹e_c⁄åﬁ_c⁄ãxt
(
c•
);

748 #ifde‡
PROFILE_FUNS


749 
	`time_funs
(
c•
 =
c⁄åﬁ_°ack
 ? 0 : (c•-1)->
fu≈
, csp->funp);

751 
c•
--;

752 
	}
}

759 
INLINE
 

760 
	$push_ve˘‹
(
ve˘‹
 *
v
, 
boﬁ_t
 
ª„ªn˚
)

762 
	`exãnd_°ack
();

763 i‡(
ª„ªn˚
)

764 
	`INCREF
(
v
->
ªf
);

765 
•
->
ty≥
 = 
T_POINTER
;

766 
•
->
u
.
vec
 = 
v
;

767 
	}
}

769 
INLINE
 

770 
	$push_m≠pög
(
m≠pög
 *
v
, 
boﬁ_t
 
ª„ªn˚
)

772 
	`exãnd_°ack
();

773 i‡(
ª„ªn˚
)

774 
	`INCREF
(
v
->
ªf
);

775 
•
->
ty≥
 = 
T_MAPPING
;

776 
•
->
u
.
m≠
 = 
v
;

777 
	}
}

782 
INLINE
 

783 
	$push_m°rög
(*
p
)

785 
	`exãnd_°ack
();

786 
•
->
ty≥
 = 
T_STRING
;

787 
•
->
°rög_ty≥
 = 
STRING_MSTRING
;

788 
•
->
u
.
°rög
 = 
p
;

789 
	}
}

791 *
°rög_¥öt_f‹m©ãd
 (, *, , 
svÆue
 *);

793 #ifde‡
TRACE_CODE


795 
	$do_åa˚_ˇŒ
(
fun˘i⁄
 *
fu≈
)

797 
	`do_åa˚
("CÆ»dúe˘ ", 
fu≈
->
«me
, " ");

798 i‡(
	`TRACETST
(
TRACE_ARGS
))

800 
i
;

801 
buff
[1024];

803 ()
	`•rötf
(
buff
, " wôh %dárgumíts: ", 
fu≈
->
num_¨g
);

804 
	`wrôe_sockë
(
buff
, 
comm™d_givî
);

805 
i
 = 0; i < 
fu≈
->
num_¨g
; i++)

806 
	`wrôe_sockë
(
	`°rög_¥öt_f‹m©ãd
(0, "%O ", 1, &
Â
[
i
]),

807 
comm™d_givî
);

809 
	`wrôe_sockë
("\n", 
comm™d_givî
);

810 
	}
}

813 
	g¥evious_ob_ac˚ss_time
;

822 
	$£tup_√w_‰ame
(
fun˘i⁄
 *
fu≈
)

824 
ˇŒed_¨gs
;

825 
≈c
;

826 *
off
;

829 
¥evious_ob_ac˚ss_time
 = 
cuºít_obje˘
->
time_of_ªf
;

831 #ifde‡
USE_SWAP


832 
	`ac˚ss_¥ogøm
(
cuºít_¥og
);

833 
	`ac˚ss_obje˘
(
cuºít_obje˘
);

836 i‡(
fu≈
->
ty≥_Êags
 & 
TYPE_MOD_TRUE_VARARGS
)

838 i‡(
c•
->
num_loˇl_v¨übÀs
 >
fu≈
->
num_¨g
)

840 
ve˘‹
 *
v
;

841 
i
, 
«rg
;

842 
v
 = 
	`Æloˇã_¨øy
(
«rg
 = 
c•
->
num_loˇl_v¨übÀs
 -

843 (
fu≈
->
num_¨g
 - 1));

844 
i
 = 
«rg
 - 1; i >= 0; i--)

845 
	`assign_svÆue_no_‰ì
(&
v
->
ôem
[
«rg
 - 1 - 
i
], &
•
[-i]);

846 
	`p›_n_ñems
(
«rg
);

847 
	`push_ve˘‹
(
v
, 
FALSE
);

848 
c•
->
num_loˇl_v¨übÀs
 -
«rg
 - 1;

852 
c•
->
num_loˇl_v¨übÀs
 > 
fu≈
->
num_¨g
)

854 
	`p›_°ack
();

855 
c•
->
num_loˇl_v¨übÀs
--;

858 
ˇŒed_¨gs
 = 
c•
->
num_loˇl_v¨übÀs
;

859 
c•
->
num_loˇl_v¨übÀs
 < 
fu≈
->
num_¨g
 + ()fu≈->
num_loˇl
)

861 
	`push_numbî
(0);

862 
c•
->
num_loˇl_v¨übÀs
++;

864 #ifde‡
DEBUG


865 i‡(
ˇŒed_¨gs
 > 
fu≈
->
num_¨g
)

866 
	`Áèl
("Error in seting up call frame!\n");

868 i‡(
ˇŒed_¨gs
 =
fu≈
->
num_¨g
)

869 
≈c
 = 
fu≈
->
off£t
 + fu≈->
num_¨g
 * 2;

872 
off
 = 
cuºít_¥og
->
¥ogøm
 + 
fu≈
->
off£t
 + 
ˇŒed_¨gs
 * 2;

873 ((*)&
≈c
)[0] = 
off
[0];

874 ((*)&
≈c
)[1] = 
off
[1];

876 
åa˚dïth
++;

877 
Â
 = 
•
 - 
c•
->
num_loˇl_v¨übÀs
 + 1;

878 #ifde‡
TRACE_CODE


879 i‡(
	`TRACEP
(
TRACE_CALL
)) {

880 
	`do_åa˚_ˇŒ
(
fu≈
);

883  
cuºít_¥og
->
¥ogøm
 + 
≈c
;

884 
	}
}

886 #ifde‡
DEBUG


888 
	$bªak_poöt
()

890 i‡(
•
 - 
Â
 - 
c•
->
num_loˇl_v¨übÀs
 + 1 != 0)

891 
	`Áèl
("Bad stackÖointer.\n");

892 
	}
}

908 
	$push_p›_îr‹_c⁄ãxt
 (
push
)

910 
	sîr‹_c⁄ãxt_°ack


912 
gdex˚±i⁄
 *
ex˚±i⁄
;

913 
c⁄åﬁ_°ack
 *
ßve_c•
;

914 
obje˘
 *
ßve_comm™d_givî
;

915 
svÆue
 *
ßve_•
;

916 
îr‹_c⁄ãxt_°ack
 *
√xt
;

917 
c⁄åﬁ_°ack
 
c°ack
;

918 } *
ec•
 = 0, *
p
;

920 i‡(
push
 == 1) {

926 
p
 = (
îr‹_c⁄ãxt_°ack
 *)
	`xÆloc
 ( *p);

927 
	`ßve_c⁄åﬁ_c⁄ãxt
(&(
p
->
c°ack
));

928 
p
->
ßve_•
 = 
•
;

929 
p
->
ßve_c•
 = 
c•
;

930 
p
->
ßve_comm™d_givî
 = 
comm™d_givî
;

931 
p
->
ex˚±i⁄
 =Éxception;

932 
p
->
√xt
 = 
ec•
;

933 
ec•
 = 
p
;

935 
p
 = 
ec•
;

936 i‡(
p
 == 0)

937 
	`Áèl
("Catch:Érror context stack underflow\n");

938 i‡(
push
 == 0) {

939 #ifde‡
DEBUG


941 i‡(
c•
 !
p
->
ßve_c•
-1)

942 
	`Áèl
("Catch: LostÅrack of csp\n");

950 
c•
 = 
p
->
ßve_c•
;

951 
	`p›_n_ñems
 (
•
 - 
p
->
ßve_•
);

952 
comm™d_givî
 = 
p
->
ßve_comm™d_givî
;

954 
ex˚±i⁄
 = 
p
->exception;

955 
ec•
 = 
p
->
√xt
;

956 
	`ª°‹e_c⁄åﬁ_c⁄ãxt
(&(
p
->
c°ack
));

957 
	`‰ì
 ((*)
p
);

959 
	}
}

967 
	$vÆid©e_shadowög
(
obje˘
 *
ob
)

969 
¥ogøm
 *
shadow
 = 
cuºít_obje˘
->
¥og
, *
vi˘im
 = 
ob
->prog;

970 
svÆue
 *
ªt
;

971 
öh
;

973 i‡(
cuºít_obje˘
->
shadowög
)

974 
	`îr‹
("shadow: Already shadowing.\n");

975 i‡(
cuºít_obje˘
->
shadowed
)

976 
	`îr‹
("shadow: Can't shadow when shadowed.\n");

977 i‡(
cuºít_obje˘
->
su≥r
)

978 
	`îr‹
("The shadow mustÇotÑeside insideánother object.\n");

979 i‡(
ob
->
shadowög
 || 
cuºít_obje˘
 == ob)

980 
	`îr‹
("Can't shadowá shadow.\n");

983 
öh
 = 
ob
->
¥og
->
num_öhîôed
 - 1; inh >= 0; inh--)

985 
¥ogøm
 *
¥ogp
 = 
vi˘im
->
öhîô
[
öh
].
¥og
;

986 
fun
;

988 #ifde‡
USE_SWAP


989 
	`ac˚ss_¥ogøm
(
¥ogp
);

991 i‡(
¥ogp
->
Êags
 & 
PRAGMA_NO_SHADOW
)

993 
fun
 = 
¥ogp
->
num_fun˘i⁄s
 - 1; fun >= 0; fun--)

998 i‡((
¥ogp
->
fun˘i⁄s
[
fun
].
ty≥_Êags
 & 
TYPE_MOD_NO_MASK
) &&

999 
	`£¨ch_f‹_fun˘i⁄
(
¥ogp
->
fun˘i⁄s
[
fun
].
«me
, 
shadow
))

1000 
	`îr‹
("IllegalÅo shadow 'nomask' function \"%s\".\n",

1001 
¥ogp
->
fun˘i⁄s
[
fun
].
«me
);

1005 i‡(
cuºít_obje˘
 =
ma°î_ob
)

1008 
	`push_obje˘
(
ob
);

1009 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_QUERY_ALLOW_SHADOW
, 1);

1010 i‡(!(
ob
->
Êags
 & 
O_DESTRUCTED
) &&

1011 
ªt
 && !‘ë->
ty≥
 =
T_NUMBER
 &&Ñë->
u
.
numbî
 == 0))

1016 
	}
}

1034 
	$check_f‹_de°r
(
svÆue
 *
¨g
)

1036 
i
, 
ch™ge
;

1037 
ve˘‹
 *
v
;

1038 
m≠pög
 *
m
;

1039 
≠aú
 *
p
, **
µ
;

1041 
¨g
->
ty≥
)

1043 
T_FUNCTION
:

1044 
v
 = 
¨g
->
u
.
func
->
fu«rgs
;

1045 
¨πe°
;

1046 
T_POINTER
:

1047 
v
 = 
¨g
->
u
.
vec
;

1048 
¨πe°
:

1049 
i
 = 0; i < 
v
->
size
; i++)

1051 i‡(
v
->
ôem
[
i
].
ty≥
 =
T_OBJECT
)

1053 i‡(!(
v
->
ôem
[
i
].
u
.
ob
->
Êags
 & 
O_DESTRUCTED
))

1056 i‡(
v
->
ôem
[
i
].
ty≥
 =
T_FUNCTION
 && 
	`ÀgÆ_˛osuª
(v->ôem[i].
u
.
func
))

1060 
	`assign_svÆue
(&
v
->
ôem
[
i
], &
c⁄°0
);

1064 
T_MAPPING
:

1065 
m
 = 
¨g
->
u
.
m≠
;

1067 
i
 = 0 ; i < 
m
->
size
 ; i++) {

1068 
p
 = 
m
->
∑ús
[
i
];Ö ;Ö =Ö->
√xt
)

1070 i‡((
p
->
vÆ
.
ty≥
 =
T_OBJECT
 &&

1071 (
p
->
vÆ
.
u
.
ob
->
Êags
 & 
O_DESTRUCTED
)) ||

1072 (
p
->
vÆ
.
ty≥
 =
T_FUNCTION
 &&

1073 !
	`ÀgÆ_˛osuª
(
p
->
vÆ
.
u
.
func
)))

1074 
	`assign_svÆue
(&
p
->
vÆ
, &
c⁄°0
);

1078 
ch™ge
 = 1;

1081 
i
 = 0 ; i < 
m
->
size
 ; i++)

1083 
µ
 = &
m
->
∑ús
[
i
]; *pp; )

1085 
p
 = *
µ
;

1086 i‡((
p
->
¨g
.
ty≥
 =
T_OBJECT
 &&

1087 (
p
->
¨g
.
u
.
ob
->
Êags
 & 
O_DESTRUCTED
)) ||

1088 (
p
->
¨g
.
ty≥
 =
T_FUNCTION
 &&

1089 !
	`ÀgÆ_˛osuª
(
p
->
¨g
.
u
.
func
)))

1091 *
µ
 = 
p
->
√xt
;

1092 
	`‰ì_svÆue
(&
p
->
¨g
);

1093 
	`‰ì_svÆue
(&
p
->
vÆ
);

1094 
	`‰ì
((*)
p
);

1095 
m
->
ˇrd
--;

1099 
µ
 = &
p
->
√xt
;

1103 
ch™ge
 = 0;

1104 } 
ch™ge
 != 0);

1108 
	`îr‹
("StrangeÅypeÅo check_for_destr.\n");

1111 
	}
}

1123 #ifde‡
TRACE_CODE


1124 
	#TRACE_SIZE
 20000

	)

1125 
	g¥evious_ö°ru˘i⁄
[
TRACE_SIZE
];

1126 
	g°ack_size
[
TRACE_SIZE
];

1127 *
	g¥evious_pc
[
TRACE_SIZE
];

1128 
	gcuπø˚dïth
[
TRACE_SIZE
];

1129 
	gœ°
;

1132 *
°rög_¥öt_f‹m©ãd
 (, *, , 
svÆue
 *);

1133 *
bªak_°rög
 (*, , 
svÆue
 *);

1134 
m≠pög
 *
c›y_m≠pög
(mapping *);

1135 *
quîy_ù_numbî
 (
obje˘
 *);

1136 *
quîy_ù_«me
 (
obje˘
 *);

1137 
ve˘‹
 *
gë_loˇl_comm™ds
 (
obje˘
 *);

1138 
ve˘‹
 *
subåa˘_¨øy
 (vector *,vector*);

1139 
ve˘‹
 *
öãr£˘_¨øy
 (vector *, vector *);

1140 
ve˘‹
 *
uni⁄_¨øy
 (vector *, vector *);

1141 *
°rög_¥öt_f‹m©ãd
 (, *, , 
svÆue
 *);

1142 
svÆue
 *
debug_comm™d
 (*, , svalue *);

1143 
ve˘‹
 *
subåa˘_¨øy
 (vector*,vector*);

1144 
ve˘‹
 *
öãr£˘_¨øy
 (vector*,vector*);

1145 
ve˘‹
 *
make_unique
 (ve˘‹ *
¨r
,*
func
, 
svÆue
 *
skùnum
);

1146 
evÆ_ö°ru˘i⁄
(*);

1148 #i‡
deföed
(
RUSAGE
Ë&& deföed(
PROFILE_OBJS
)

1149 
	#MAX_CPU_STACK
 1000

	)

1150 
	g¥og˝ui
;

1151 
	s¥og˝uS
 {

1152 
¥ogøm
 *
	m¥og
;

1153 
	m˝u
;

1154 } 
	g¥og˝u
[
MAX_CPU_STACK
];

1157 
	$˛ór_˝u_°ack
()

1159 
¥og˝ui
 = 1;

1160 
¥og˝u
[0].
¥og
 = 0;

1161 
¥og˝u
[0].
˝u
 = (-1);

1162 
	}
}

1167 
	$f_œ°_ª„ªn˚_time
(
xxx
)

1169 
	`push_numbî
(()
¥evious_ob_ac˚ss_time
);

1170 
	}
}

1174 
	$f_as£πi⁄
(
xxx
)

1176 
off£t
;

1177 
as£πi⁄_ty≥
;

1178 ((*)&
as£πi⁄_ty≥
)[0] = *
pc
++;

1179 ((*)&
as£πi⁄_ty≥
)[1] = *
pc
++;

1180 ((*)&
off£t
)[0] = *
pc
++;

1181 ((*)&
off£t
)[1] = *
pc
++;

1182 i‡((
cuºít_¥og
->
debug_Êags
 | 
cuºít_obje˘
->debug_flags) &

1183 
as£πi⁄_ty≥
)

1186 
pc
 = 
cuºít_¥og
->
¥ogøm
 + 
off£t
;

1187 
	}
}

1191 
	$f_Áû_¥ec⁄d
(
xxx
)

1193 
vÆ
;

1194 
vÆ
 = 
•
->
u
.
numbî
;

1195 
	`p›_°ack
();

1196 i‡(!
vÆ
)

1197 
	`îr‹
("Precondition failed!\n");

1198 
	}
}

1202 
	$f_Áû_po°c⁄d
(
xxx
)

1204 
vÆ
;

1205 
vÆ
 = 
•
->
u
.
numbî
;

1206 
	`p›_°ack
();

1207 i‡(!
vÆ
)

1208 
	`îr‹
("Postcondition failed!\n");

1209 
	}
}

1213 
	$f_Áû_öv¨ü¡
(
xxx
)

1215 
vÆ
;

1216 
vÆ
 = 
•
->
u
.
numbî
;

1217 
	`p›_°ack
();

1218 i‡(!
vÆ
)

1219 
	`îr‹
("Invariant failed!\n");

1220 
	}
}

1224 
	$f_Áû_as£πi⁄
(
xxx
)

1226 
vÆ
;

1227 
vÆ
 = 
•
->
u
.
numbî
;

1228 
	`p›_°ack
();

1229 i‡(!
vÆ
)

1230 
	`îr‹
("Assertion failed!\n");

1231 
	}
}

1235 
	$f_do_¥ec⁄d
(
xxx
)

1237 
off£t
;

1238 i‡((
cuºít_¥og
->
debug_Êags
 |

1239 
cuºít_obje˘
->
debug_Êags
) & 0x100)

1241 ((*)&
off£t
)[0] = 
pc
[0];

1242 ((*)&
off£t
)[1] = 
pc
[1];

1243 
pc
 = 
cuºít_¥og
->
¥ogøm
 + 
off£t
;

1246 
pc
 += 2;

1247 
	}
}

1251 
	$f_do_po°c⁄d
(
xxx
)

1253 
off£t
;

1254 i‡((
cuºít_¥og
->
debug_Êags
 |

1255 
cuºít_obje˘
->
debug_Êags
) & 0x200)

1257 ((*)&
off£t
)[0] = 
pc
[0];

1258 ((*)&
off£t
)[1] = 
pc
[1];

1259 
pc
 = 
cuºít_¥og
->
¥ogøm
 + 
off£t
;

1262 
pc
 += 2;

1263 
	}
}

1267 
	$f_do_öv¨ü¡s
(
xxx
)

1269 
i
;

1270 
i
 = 
cuºít_¥og
->
num_öhîôed
 - 1; i >= 0; i--)

1272 i‡((
cuºít_¥og
->
öhîô
[
i
].
¥og
->
debug_Êags
 |

1273 
cuºít_obje˘
->
debug_Êags
) & 0x400 &&

1274 
cuºít_¥og
->
öhîô
[
i
].
¥og
->
öv¨ü¡
 !=

1276 !(
cuºít_¥og
->
öhîô
[
i
].
ty≥
 & 
TYPE_MOD_SECOND
))

1278 
	`ˇŒ_fun˘i⁄
(
cuºít_obje˘
, 
öh_off£t
 + 
i
 -

1279 (
cuºít_¥og
->
num_öhîôed
 - 1),

1280 ()
cuºít_¥og
->
öhîô
[
i
].
¥og
->
öv¨ü¡
, 0);

1281 
	`p›_°ack
();

1284 
	}
}

1288 
	$f_ext
(
xxx
)

1290 
	`Áèl
("f_ext shouldÇot be called.\n");

1291 
	}
}

1295 
	$f_ˇŒ_vút
(
xxx
)

1297 
fix
, 
fiix
;

1298 
fun˘i⁄
 *
fu≈
;

1299 
num_¨g
;

1300 *
func
;

1302 #ifde‡
COUNT_CALLS


1303 
num_ˇŒ_£lf
++;

1305 
ˇche_åõs
++;

1307 
fiix
 = 
	`EXTRACT_UCHAR
(
pc
);

1308 
pc
++;

1309 ((*)&
fix
)[0] = 
pc
[0];

1310 ((*)&
fix
)[1] = 
pc
[1];

1311 
pc
 += 2;

1313 
num_¨g
 = 
	`EXTRACT_UCHAR
(
pc
);

1314 
pc
++;

1316 i‡(
cuºít_obje˘
->
¥og
 =
cuºít_¥og
)

1318 
ˇche_hôs
++;

1319 #ifde‡
CACHE_STATS


1320 
ˇŒ_fú°_ßves
 +
cuºít_¥og
->
num_öhîôed
 - 
fiix
;

1322 
fun˘i⁄_¥og_found
 = 
cuºít_obje˘
->
¥og
->

1323 
öhîô
[
fiix
].
¥og
;

1324 
fun˘i⁄_öhîô_found
 = 
fiix
;

1325 
fun˘i⁄_ödex_found
 = 
fix
;

1329 #ifde‡
USE_SWAP


1330 
	`ac˚ss_¥ogøm
(
cuºít_¥og
->
öhîô
[
fiix
].
¥og
);

1332 
func
 = 
cuºít_¥og
->
öhîô
[
fiix
].
¥og
->
fun˘i⁄s
[
fix
].
«me
;

1333 ()
	`s_f_f
(
func
, 
cuºít_obje˘
->
¥og
);

1334 i‡(
fun˘i⁄_ty≥_mod_found
 & 
TYPE_MOD_PRIVATE
 &&

1335 
öh_off£t
 < 
fun˘i⁄_öhîô_found
 -

1336 ()
fun˘i⁄_¥og_found
->
num_öhîôed
 + 1)

1337 
	`îr‹
("Attempted call ofÖrivate function.\n");

1340 #ifde‡
USE_SWAP


1341 
	`ac˚ss_¥ogøm
(
fun˘i⁄_¥og_found
);

1343 
fu≈
 = &(
fun˘i⁄_¥og_found
->
fun˘i⁄s
[
fun˘i⁄_ödex_found
]);

1347 
	`push_c⁄åﬁ_°ack
 (
fu≈
);

1348 
öh_off£t
 = 
fun˘i⁄_öhîô_found
;

1349 
cuºít_¥og
 = 
fun˘i⁄_¥og_found
;

1350 
c•
->
ext_ˇŒ
 = 0;

1351 
c•
->
num_loˇl_v¨übÀs
 = 
num_¨g
;

1352 
pc
 = 
	`£tup_√w_‰ame
(
fu≈
);

1353 
c•
->
exã∫_ˇŒ
 = 0;

1355 #i‡
	`deföed
(
RUSAGE
Ë&& deföed(
PROFILE_OBJS
)

1357 #ifde‡
SOLARIS


1358 
tms
 
buf„r
;

1360 
rußge
 
rus
;

1362 
˝u
;

1364 #ifde‡
SOLARIS


1365 i‡(
	`times
(&
buf„r
) != -1)

1366 
˝u
 = (
buf„r
.
tms_utime
 + buf„r.
tms_°ime
);

1368 i‡(
	`gërußge
(
RUSAGE_SELF
, &
rus
) >= 0)

1370 
˝u
 = 
rus
.
ru_utime
.
tv_£c
 * 1000 +Ñus.ru_utime.
tv_u£c
 / 1000 +

1371 
rus
.
ru_°ime
.
tv_£c
 * 1000 +Ñus.ru_°ime.
tv_u£c
 / 1000;

1375 
˝u
 = (-1);

1377 i‡(
¥og˝ui
 >
MAX_CPU_STACK
)

1378 
	`Áèl
("CPU-Stack overflow.\n");

1380 
¥og˝u
[
¥og˝ui
].
¥og
 = 
cuºít_¥og
;

1381 
¥og˝u
[
¥og˝ui
++].
˝u
 = cpu;

1384 
	}
}

1387 
	$f_ˇŒ_£lf
(
num_¨g
)

1389 
fun˘i⁄
 *
fu≈
;

1390 
svÆue
 *
¨g
;

1392 
¨g
 = 
•
 - 
num_¨g
 + 1;

1394 i‡(
	`£¨ch_f‹_fun˘i⁄
(
¨g
->
u
.
°rög
, 
cuºít_obje˘
->
¥og
) == 0 ||

1395 ((
fun˘i⁄_ty≥_mod_found
 & 
TYPE_MOD_PRIVATE
) &&

1396 
öh_off£t
 < 
fun˘i⁄_öhîô_found
 -

1397 ()
fun˘i⁄_¥og_found
->
num_öhîôed
 + 1))

1400 
	`p›_n_ñems
(
num_¨g
);

1401 
	`push_numbî
(0);

1405 
	`‰ì_svÆue
(
¨g
);

1406 
num_¨g
--;

1407 #i‡
	`deföed
(
sun
Ë&& !deföed(
SOLARIS
)

1408 ()
	`bc›y
(&
¨g
[1],árg, 
num_¨g
 * (
svÆue
));

1410 ()
	`memmove
(
¨g
, &¨g[1], 
num_¨g
 * (
svÆue
));

1412 
•
--;

1414 #ifde‡
USE_SWAP


1415 
	`ac˚ss_¥ogøm
(
fun˘i⁄_¥og_found
);

1417 
fu≈
 = &(
fun˘i⁄_¥og_found
->
fun˘i⁄s
[
fun˘i⁄_ödex_found
]);

1421 
	`push_c⁄åﬁ_°ack
 (
fu≈
);

1422 
öh_off£t
 = 
fun˘i⁄_öhîô_found
;

1423 
cuºít_¥og
 = 
fun˘i⁄_¥og_found
;

1424 
c•
->
ext_ˇŒ
 = 0;

1425 
c•
->
num_loˇl_v¨übÀs
 = 
num_¨g
;

1426 
pc
 = 
	`£tup_√w_‰ame
(
fu≈
);

1427 
c•
->
exã∫_ˇŒ
 = 0;

1429 #i‡
	`deföed
(
RUSAGE
Ë&& deföed(
PROFILE_OBJS
)

1431 #ifde‡
SOLARIS


1432 
tms
 
buf„r
;

1434 
rußge
 
rus
;

1436 
˝u
;

1438 #ifde‡
SOLARIS


1439 i‡(
	`times
(&
buf„r
) != -1)

1440 
˝u
 = (
buf„r
.
tms_utime
 + buf„r.
tms_°ime
);

1442 i‡(
	`gërußge
(
RUSAGE_SELF
, &
rus
) >= 0)

1444 
˝u
 = 
rus
.
ru_utime
.
tv_£c
 * 1000 +Ñus.ru_utime.
tv_u£c
 / 1000 +

1445 
rus
.
ru_°ime
.
tv_£c
 * 1000 +Ñus.ru_°ime.
tv_u£c
 / 1000;

1449 
˝u
 = (-1);

1451 i‡(
¥og˝ui
 >
MAX_CPU_STACK
)

1452 
	`Áèl
("CPU-Stack overflow.\n");

1454 
¥og˝u
[
¥og˝ui
].
¥og
 = 
cuºít_¥og
;

1455 
¥og˝u
[
¥og˝ui
++].
˝u
 = cpu;

1458 
	}
}

1462 
	$f_ˇŒ_£lfv
(
xxx
)

1464 
ve˘‹
 *
¨gv
 = 
•
->
u
.
vec
;

1465 
i
;

1466 
num_¨g
;

1468 
	`INCREF
(
¨gv
->
ªf
);

1469 
	`p›_°ack
();

1470 
num_¨g
 = 
¨gv
->
size
 + 1;

1471 
i
 = 0; i < 
¨gv
->
size
; i++)

1473 
	`push_svÆue
(&
¨gv
->
ôem
[
i
]);

1475 
	`‰ì_ve˘‹
(
¨gv
);

1476 
	`f_ˇŒ_£lf
(
num_¨g
);

1477 
	}
}

1481 
	$f_ˇŒ_n⁄_vút
(
xxx
)

1487 
fun˘i⁄
 *
fu≈
;

1488 
öh
, 
num_¨g
;

1489 
fix
, 
fiix
;

1491 #ifde‡
COUNT_CALLS


1492 
num_ˇŒ_down
++;

1495 
fiix
 = 
	`EXTRACT_UCHAR
(
pc
);

1496 
pc
++;

1497 ((*)&
fix
)[0] = 
pc
[0];

1498 ((*)&
fix
)[1] = 
pc
[1];

1499 
pc
 += 2;

1501 
num_¨g
 = 
	`EXTRACT_UCHAR
(
pc
);

1502 
pc
++;

1503 
öh
 = 
fiix
 - (
cuºít_¥og
->
num_öhîôed
 - 1);

1504 
fun˘i⁄_¥og_found
 = 
cuºít_¥og
->
öhîô
[
fiix
].
¥og
;

1505 #ifde‡
USE_SWAP


1506 
	`ac˚ss_¥ogøm
(
fun˘i⁄_¥og_found
);

1508 
fu≈
 = &(
fun˘i⁄_¥og_found
->
fun˘i⁄s
[
fix
]);

1513 
	`push_c⁄åﬁ_°ack
 (
fu≈
);

1514 
öh_off£t
 +
öh
;

1515 
cuºít_¥og
 = 
fun˘i⁄_¥og_found
;

1516 
c•
->
ext_ˇŒ
 = 0;

1517 
c•
->
num_loˇl_v¨übÀs
 = 
num_¨g
;

1518 
pc
 = 
	`£tup_√w_‰ame
(
fu≈
);

1519 
c•
->
exã∫_ˇŒ
 = 0;

1521 #i‡
	`deföed
(
RUSAGE
Ë&& deföed(
PROFILE_OBJS
)

1523 #ifde‡
SOLARIS


1524 
tms
 
buf„r
;

1526 
rußge
 
rus
;

1528 
˝u
;

1530 #ifde‡
SOLARIS


1531 i‡(
	`times
(&
buf„r
) != -1)

1532 
˝u
 = (
buf„r
.
tms_utime
 + buf„r.
tms_°ime
);

1534 i‡(
	`gërußge
(
RUSAGE_SELF
, &
rus
) >= 0)

1536 
˝u
 = 
rus
.
ru_utime
.
tv_£c
 * 1000 +Ñus.ru_utime.
tv_u£c
 / 1000 +

1537 
rus
.
ru_°ime
.
tv_£c
 * 1000 +Ñus.ru_°ime.
tv_u£c
 / 1000;

1541 
˝u
 = (-1);

1543 i‡(
¥og˝ui
 >
MAX_CPU_STACK
)

1544 
	`Áèl
("CPU-Stack overflow.\n");

1546 
¥og˝u
[
¥og˝ui
].
¥og
 = 
cuºít_¥og
;

1547 
¥og˝u
[
¥og˝ui
++].
˝u
 = cpu;

1550 
	}
}

1554 
	$f_ˇŒ_c
(
num_¨g
)

1556 (*
func
)(
svÆue
 *);

1557 
f1
 = 0;

1558 #ifde‡
__Æpha


1559 
f2
 = 0;

1562 ((*)&
f1
)[0] = 
pc
[0];

1563 ((*)&
f1
)[1] = 
pc
[1];

1564 ((*)&
f1
)[2] = 
pc
[2];

1565 ((*)&
f1
)[3] = 
pc
[3];

1566 
pc
 += 4;

1567 #ifde‡
__Æpha


1568 ((*)&
f2
)[0] = 
pc
[0];

1569 ((*)&
f2
)[1] = 
pc
[1];

1570 ((*)&
f2
)[2] = 
pc
[2];

1571 ((*)&
f2
)[3] = 
pc
[3];

1572 
pc
 += 4;

1573 
func
 = ((*)(
svÆue
 *))(()
f1
 | (()
f2
 << 32));

1575 
func
 = ((*)(
svÆue
 *))
f1
;

1577 
	`func
(
Â
);

1578 
	}
}

1582 
	$f_ˇŒ_simul
(
xxx
)

1584 
func_«me_ödex
;

1585 
num_¨g
;

1586 *
func
;

1587 
pc
++;

1589 ((*)&
func_«me_ödex
)[0] = 
pc
[0];

1590 ((*)&
func_«me_ödex
)[1] = 
pc
[1];

1591 
pc
 += 2;

1592 
num_¨g
 = 
	`EXTRACT_UCHAR
(
pc
);

1593 
pc
++;

1595 
func
 = 
cuºít_¥og
->
rod©a
 + 
func_«me_ödex
;

1596 i‡(!
simul_efun_ob
 ||

1597 
cuºít_¥og
 =
simul_efun_ob
->
¥og
 ||

1598 !
	`≠∂y_low
(
func
, 
simul_efun_ob
, 
num_¨g
, 1))

1600 
buff
[200];

1601 ()
	`•rötf
(
buff
, "SimulatedÉfun %sÇot found",

1602 
cuºít_¥og
->
rod©a
 + 
func_«me_ödex
);

1603 
	`îr‹
 (
buff
);

1605 
	}
}

1609 
	$f_¥evious_obje˘
(
num_¨g
)

1611 
n
;

1612 
c⁄åﬁ_°ack
 *
c•i
;

1614 i‡(
•
->
u
.
numbî
 > 0 || (sp->u.number == 0 &&

1615 (
¥evious_ob
 =0 || (¥evious_ob->
Êags
 & 
O_DESTRUCTED
))))

1617 
	`p›_°ack
();

1618 
	`push_numbî
(0);

1621 i‡(
•
->
u
.
numbî
 == 0)

1623 
	`p›_°ack
();

1624 
	`push_obje˘
(
¥evious_ob
);

1627 
n
 = 
•
->
u
.
numbî
;

1628 
	`p›_°ack
();

1629 
c•i
 = 
c•
; 
n
 && c•ò> 
c⁄åﬁ_°ack
; cspi--)

1630 i‡(
c•i
->
ext_ˇŒ
)

1631 
n
++;

1632 i‡(
c•i
 =
c⁄åﬁ_°ack
 || c•i->
ob
 == 0 ||

1633 (
c•i
->
ob
->
Êags
 & 
O_DESTRUCTED
))

1634 
	`push_numbî
(0);

1636 
	`push_obje˘
(
c•i
->
ob
);

1637 
	}
}

1641 
	$f_ˇŒög_¥ogøm
(
num_¨g
)

1643 
n
 = 
•
->
u
.
numbî
;

1644 
c⁄åﬁ_°ack
 *
c•i
;

1646 
	`p›_°ack
();

1647 i‡(
n
 > 0 || -¿> 
MAX_TRACE
)

1649 
	`push_numbî
(0);

1652 
c•i
 = 
c•
 + 
n
;

1653 i‡(
c•i
 <
c⁄åﬁ_°ack
 || c•i->
¥og
 == 0)

1654 
	`push_numbî
(0);

1656 
	`push_°rög
(
c•i
->
¥og
->
«me
, 
STRING_MSTRING
);

1657 
	}
}

1661 
	$f_ˇŒög_obje˘
(
num_¨g
)

1663 
n
 = 
•
->
u
.
numbî
;

1664 
c⁄åﬁ_°ack
 *
c•i
;

1666 
	`p›_°ack
();

1667 i‡(
n
 > 0 || -¿> 
MAX_TRACE
)

1669 
	`push_numbî
(0);

1672 
c•i
 = 
c•
 + 
n
;

1673 i‡(
c•i
 <
c⁄åﬁ_°ack
 || c•i->
ob
 == 0 ||

1674 (
c•i
->
ob
->
Êags
 & 
O_DESTRUCTED
))

1675 
	`push_numbî
(0);

1677 
	`push_obje˘
(
c•i
->
ob
);

1678 
	}
}

1682 
	$f_ˇŒög_fun˘i⁄
(
num_¨g
)

1684 
n
 = 
•
->
u
.
numbî
;

1685 
c⁄åﬁ_°ack
 *
c•i
;

1687 
	`p›_°ack
();

1688 i‡(
n
 > 0 || -¿> 
MAX_TRACE
)

1690 
	`push_numbî
(0);

1693 
c•i
 = 
c•
 + 
n
 - 1;

1694 i‡(
c•i
 < 
c⁄åﬁ_°ack
)

1695 
	`push_numbî
(0);

1696 i‡(
c•i
->
fu≈
)

1697 
	`push_°rög
(
c•i
->
fu≈
->
«me
, 
STRING_MSTRING
);

1699 
	`push_°rög
("<öã∫Æ>", 
STRING_CSTRING
);

1700 
	}
}

1704 
	$f_°‹e
(
num_¨g
)

1706 
	`Áèl
("f_store shouldÇot be called.\n");

1707 
	}
}

1711 
	$f_if
(
num_¨g
)

1713 
	`Áèl
("f_if shouldÇot be called.\n");

1714 
	}
}

1718 
	$f_œnd
(
num_¨g
)

1720 
	`Áèl
("f_land shouldÇot be called.\n");

1721 
	}
}

1725 
	$f_l‹
(
num_¨g
)

1727 
	`Áèl
("f_lor shouldÇot be called.\n");

1728 
	}
}

1732 
	$f_°©us
(
num_¨g
)

1734 
	`Áèl
("f_status shouldÇot be called.\n");

1735 
	}
}

1739 
	$f_comma
(
num_¨g
)

1741 
	`Áèl
("f_comma shouldÇot be called.\n");

1742 
	}
}

1746 
	$f_öt
(
num_¨g
)

1748 
	`Áèl
("f_int shouldÇot be called.\n");

1749 
	}
}

1753 
	$f_°rög_de˛
(
num_¨g
)

1755 
	`Áèl
("f_string_decl shouldÇot be called.\n");

1756 
	}
}

1760 
	$f_ñ£
(
num_¨g
)

1762 
	`Áèl
("f_else shouldÇot be called.\n");

1763 
	}
}

1767 
	$f_des¸ibe
(
num_¨g
)

1769 
	`Áèl
("f_describe shouldÇot be called.\n");

1770 
	}
}

1774 
	$f_c⁄töue
(
num_¨g
)

1776 
	`Áèl
("f_continue shouldÇot be called.\n");

1777 
	}
}

1781 
	$f_öhîô
(
num_¨g
)

1783 
	`Áèl
("f_inherit shouldÇot be called.\n");

1784 
	}
}

1788 
	$f_cﬁ⁄_cﬁ⁄
(
num_¨g
)

1790 
	`Áèl
("f_colon_colon shouldÇot be called.\n");

1791 
	}
}

1795 
	$f_°©ic
(
num_¨g
)

1797 
	`Áèl
("f_static shouldÇot be called.\n");

1798 
	}
}

1802 
	$f_¨row
(
num_¨g
)

1804 
	`Áèl
("f_arrow shouldÇot be called.\n");

1805 
	}
}

1809 
	$f_obje˘
(
num_¨g
)

1811 
	`Áèl
("f_object shouldÇot be called.\n");

1812 
	}
}

1816 
	$f_void
(
num_¨g
)

1818 
	`Áèl
("f_void shouldÇot be called.\n");

1819 
	}
}

1823 
	$f_mixed
(
num_¨g
)

1825 
	`Áèl
("f_mixed shouldÇot be called.\n");

1826 
	}
}

1830 
	$f_¥iv©e
(
num_¨g
)

1832 
	`Áèl
("f_private shouldÇot be called.\n");

1833 
	}
}

1837 
	$f_no_mask
(
num_¨g
)

1839 
	`Áèl
("f_no_mask shouldÇot be called.\n");

1840 
	}
}

1844 
	$f_m≠pög
(
num_¨g
)

1846 
	`Áèl
("f_mapping shouldÇot be called.\n");

1847 
	}
}

1851 
	$f_fun˘i⁄
(
num_¨g
)

1853 
	`Áèl
("f_function shouldÇot be called.\n");

1854 
	}
}

1858 
	$f_›î©‹
(
num_¨g
)

1860 
	`Áèl
("f_operator shouldÇot be called.\n");

1861 
	}
}

1865 
	$f_Êﬂt
(
num_¨g
)

1867 
	`Áèl
("f_float shouldÇot be called.\n");

1868 
	}
}

1872 
	$f_public
(
num_¨g
)

1874 
	`Áèl
("f_public shouldÇot be called.\n");

1875 
	}
}

1879 
	$f_v¨¨gs
(
num_¨g
)

1881 
	`Áèl
("f_varargs shouldÇot be called.\n");

1882 
	}
}

1886 
	$f_v¨¨g
(
num_¨g
)

1888 
	`Áèl
("f_vararg shouldÇot be called.\n");

1889 
	}
}

1893 
	$f_ˇ£
(
num_¨g
)

1895 
	`Áèl
("f_case shouldÇot be called.\n");

1896 
	}
}

1900 
	$f_deÁu…
(
num_¨g
)

1902 
	`Áèl
("f_default shouldÇot be called.\n");

1903 
	}
}

1907 
	$f_ôof
(
num_¨g
)

1909 
•
->
ty≥
 = 
T_FLOAT
;

1910 
•
->
u
.
ªÆ
 = sp->u.
numbî
;

1911 
	}
}

1915 
	$f_·oi
(
num_¨g
)

1917 i‡(
•
->
u
.
ªÆ
 > 
INT_MAX
 || sp->u.ªÆ < 
INT_MIN
)

1918 
	`îr‹
("Integer overflow.\n");

1919 
•
->
ty≥
 = 
T_NUMBER
;

1920 
•
->
u
.
numbî
 = sp->u.
ªÆ
;

1921 
	}
}

1925 
	$f_sö
(
num_¨g
)

1927 
•
->
u
.
ªÆ
 = 
	`sö
(sp->u.real);

1928 
	}
}

1932 
	$f_cos
(
num_¨g
)

1934 
•
->
u
.
ªÆ
 = 
	`cos
(sp->u.real);

1935 
	}
}

1939 
	$f_èn
(
num_¨g
)

1941 
•
->
u
.
ªÆ
 = 
	`chkÊﬂå™ge
(
	`èn
(sp->u.real));

1942 
	}
}

1946 
	$f_asö
(
num_¨g
)

1948 i‡(
	`Ábs
(
•
->
u
.
ªÆ
) > 1.0)

1949 
	`îr‹
("Argument out of boundsÅoásin()\n");

1950 
•
->
u
.
ªÆ
 = 
	`asö
(sp->u.real);

1951 
	}
}

1955 
	$f_acos
(
num_¨g
)

1957 i‡(
	`Ábs
(
•
->
u
.
ªÆ
) > 1.0)

1958 
	`îr‹
("Argument out of boundsÅoácos()\n");

1959 
•
->
u
.
ªÆ
 = 
	`acos
(sp->u.real);

1960 
	}
}

1964 
	$f_©™
(
num_¨g
)

1966 
•
->
u
.
ªÆ
 = 
	`©™
(sp->u.real);

1967 
	}
}

1971 
	$f_©™2
(
num_¨g
)

1973 (
•
-1)->
u
.
ªÆ
 = 
	`©™2
((sp-1)->u.real, sp->u.real);

1974 
•
--;

1975 
	}
}

1979 
	$f_exp
(
num_¨g
)

1981 
•
->
u
.
ªÆ
 = 
	`chkÊﬂå™ge
(
	`exp
(sp->u.real));

1982 
	}
}

1986 
	$f_log
(
num_¨g
)

1988 
•
->
u
.
ªÆ
 = 
	`chkÊﬂå™ge
(
	`log
(sp->u.real));

1989 
	}
}

1993 
	$f_pow
(
num_¨g
)

1995 (
•
-1)->
u
.
ªÆ
 = 
	`chkÊﬂå™ge
(
	`pow
((sp-1)->u.real, sp->u.real));

1996 
•
--;

1997 
	}
}

2001 
	$f_söh
(
num_¨g
)

2003 
•
->
u
.
ªÆ
 = 
	`chkÊﬂå™ge
(
	`söh
(sp->u.real));

2004 
	}
}

2008 
	$f_cosh
(
num_¨g
)

2010 
•
->
u
.
ªÆ
 = 
	`chkÊﬂå™ge
(
	`cosh
(sp->u.real));

2011 
	}
}

2015 
	$f_ènh
(
num_¨g
)

2017 
•
->
u
.
ªÆ
 = 
	`chkÊﬂå™ge
(
	`ènh
(sp->u.real));

2018 
	}
}

2020 #ifde‡
F_ASINH


2023 
	$f_asöh
(
num_¨g
)

2025 
•
->
u
.
ªÆ
 = 
	`chkÊﬂå™ge
(
	`asöh
(sp->u.real));

2026 
	}
}

2029 #ifde‡
F_ACOSH


2032 
	$f_acosh
(
num_¨g
)

2034 i‡(
•
->
u
.
ªÆ
 < 1.0)

2035 
	`îr‹
("Argument out of boundsÅoácosh()\n");

2036 
•
->
u
.
ªÆ
 = 
	`chkÊﬂå™ge
(
	`acosh
(sp->u.real));

2037 
	}
}

2040 #ifde‡
F_ATANH


2043 
	$f_©™h
(
num_¨g
)

2045 i‡(
	`Ábs
(
•
->
u
.
ªÆ
) > 1.0)

2046 
	`îr‹
("Argument out of boundsÅoátanh()\n");

2047 
•
->
u
.
ªÆ
 = 
	`chkÊﬂå™ge
(
	`©™h
(sp->u.real));

2048 
	}
}

2053 
	$f_abs
(
num_¨g
)

2055 
•
->
u
.
ªÆ
 = 
	`Ábs
(sp->u.real);

2056 
	}
}

2060 
	$f_Á˘
(
num_¨g
)

2062 i‡–
•
->
u
.
ªÆ
 < 0.0)

2063 
	`îr‹
("Argument out of boundsÅo fact()\n");

2064 #ifde‡
ns32000


2065 
•
->
u
.
ªÆ
 = 
	`chkÊﬂå™ge
(
	`exp
(
	`gamma
(sp->u.real + 1.0)));

2067 
•
->
u
.
ªÆ
 = 
	`chkÊﬂå™ge
(
	`exp
(
	`lgamma
(sp->u.real + 1.0)));

2069 
	}
}

2073 
	$f_∫d
(
num_¨g
)

2075 
	`øndom_Êﬂt
();

2077 
	`push_Êﬂt
(
	`øndom_Êﬂt
());

2078 
	}
}

2082 
	$f_·ﬂ
(
num_¨g
)

2084 
buf„r
[1024];

2086 ()
	`•rötf
(
buf„r
,"%.8g",
•
->
u
.
ªÆ
);

2087 
•
--;

2088 
	`push_°rög
(
buf„r
, 
STRING_MSTRING
);

2089 
	}
}

2093 
	$f_Êﬂtc
(
num_¨g
)

2095 
f
;

2097 ((*)&
f
)[0] = 
pc
[0];

2098 ((*)&
f
)[1] = 
pc
[1];

2099 ((*)&
f
)[2] = 
pc
[2];

2100 ((*)&
f
)[3] = 
pc
[3];

2101 
pc
 += 4;

2102 
	`push_Êﬂt
(
f
);

2103 
	}
}

2107 
	$f_ªgexp
(
num_¨g
)

2109 
ve˘‹
 *
v
;

2111 
v
 = 
	`m©ch_ªgexp
((
•
-1)->
u
.
vec
, sp->u.
°rög
);

2112 
	`p›_n_ñems
(2);

2113 i‡(
v
 == 0)

2114 
	`push_numbî
(0);

2116 
	`push_ve˘‹
(
v
, 
FALSE
);

2118 
	}
}

2122 
	$f_shadow
(
num_¨g
)

2124 
obje˘
 *
ob
;

2126 
ob
 = (
•
-1)->
u
.ob;

2127 i‡(
•
->
u
.
numbî
 == 0)

2129 
ob
 = ob->
shadowed
;

2130 
	`p›_n_ñems
(2);

2131 
	`push_obje˘
(
ob
);

2134 i‡(
	`vÆid©e_shadowög
(
ob
))

2139 
ob
->
shadowed
)

2140 
ob
 = ob->
shadowed
;

2141 
	`ch™ge_ªf
(
cuºít_obje˘
->
shadowög
, 
ob
, "f_shadow-1");

2142 
cuºít_obje˘
->
shadowög
 = 
ob
;

2143 
	`ch™ge_ªf
(
ob
->
shadowed
, 
cuºít_obje˘
, "f_shadow-2");

2144 
ob
->
shadowed
 = 
cuºít_obje˘
;

2145 
	`p›_n_ñems
(2);

2146 
	`push_obje˘
(
ob
);

2149 
	`p›_n_ñems
(2);

2150 
	`push_numbî
(0);

2151 
	}
}

2155 
	$f_p›_vÆue
(
num_¨g
)

2157 
	`p›_°ack
();

2158 
	}
}

2162 
	$f_dup
(
num_¨g
)

2164 
	`exãnd_°ack
();

2165 
	`assign_svÆue_no_‰ì
(
•
, sp-1);

2166 
	}
}

2170 
	$f_jump_whí_zîo
(
num_¨g
)

2172 
off£t
;

2174 ((*)&
off£t
)[0] = 
pc
[0];

2175 ((*)&
off£t
)[1] = 
pc
[1];

2177 i‡(
•
->
u
.
numbî
 == 0)

2179 
pc
 = 
cuºít_¥og
->
¥ogøm
 + 
off£t
;

2182 
pc
 += 2;

2183 
	`p›_°ack
();

2184 
	}
}

2188 
	$f_skù_nz
(
num_¨g
)

2190 
off£t
;

2192 ((*)&
off£t
)[0] = 
pc
[0];

2193 ((*)&
off£t
)[1] = 
pc
[1];

2194 
pc
 += 2;

2195 i‡(
•
->
ty≥
 =
T_NUMBER
 && sp->
u
.
numbî
 == 0)

2196 
	`p›_°ack
();

2198 
pc
 = 
cuºít_¥og
->
¥ogøm
 + 
off£t
;

2199 
	}
}

2203 
	$f_jump
(
num_¨g
)

2205 
off£t
;

2207 ((*)&
off£t
)[0] = 
pc
[0];

2208 ((*)&
off£t
)[1] = 
pc
[1];

2209 
pc
 = 
cuºít_¥og
->
¥ogøm
 + 
off£t
;

2210 
	}
}

2214 
	$f_jump_whí_n⁄_zîo
(
num_¨g
)

2216 
off£t
;

2218 ((*)&
off£t
)[0] = 
pc
[0];

2219 ((*)&
off£t
)[1] = 
pc
[1];

2220 i‡(
•
->
u
.
numbî
 == 0)

2221 
pc
 += 2;

2223 
pc
 = 
cuºít_¥og
->
¥ogøm
 + 
off£t
;

2224 
	`p›_°ack
();

2225 
	}
}

2229 
	$f_ödúe˘
(
num_¨g
)

2231 #ifde‡
DEBUG


2232 i‡(
•
->
ty≥
 !
T_LVALUE
)

2233 
	`Áèl
("BadÅypeÅo F_INDIRECT\n");

2235 
	`assign_svÆue
(
•
, sp->
u
.
lvÆue
);

2241 i‡((
•
->
ty≥
 =
T_OBJECT
 && (•->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
)) ||

2242 (
•
->
ty≥
 =
T_FUNCTION
 && !
	`ÀgÆ_˛osuª
(•->
u
.
func
)))

2244 
	`‰ì_svÆue
(
•
);

2245 *
•
 = 
c⁄°0
;

2247 
	}
}

2251 
	$f_idítifõr
(
num_¨g
)

2253 
	`exãnd_°ack
();

2254 
	`assign_svÆue_no_‰ì
(
•
, 
	`föd_vÆue
(()
	`EXTRACT_UCHAR
(
pc
),

2255 ()
	`EXTRACT_UCHAR
(
pc
 + 1)));

2256 
pc
 += 2;

2262 i‡((
•
->
ty≥
 =
T_OBJECT
 && (•->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
)) ||

2263 (
•
->
ty≥
 =
T_FUNCTION
 && !
	`ÀgÆ_˛osuª
(•->
u
.
func
)))

2264 
	`assign_svÆue
(
•
, &
c⁄°0
);

2265 
	}
}

2269 
	$f_push_idítifõr_lvÆue
(
num_¨g
)

2271 
	`exãnd_°ack
();

2272 
•
->
ty≥
 = 
T_LVALUE
;

2273 
•
->
u
.
lvÆue
 = 
	`föd_vÆue
(()
	`EXTRACT_UCHAR
(
pc
),()EXTRACT_UCHAR(pc + 1));

2274 
pc
 += 2;

2275 
	}
}

2279 
	$f_push_ödexed_lvÆue
(
num_¨g
)

2281 
	`push_ödexed_lvÆue
(1);

2282 
	}
}

2286 
	$f_ödex
(
num_¨g
)

2288 
	`push_ödexed_lvÆue
(0);

2289 
	`assign_svÆue_no_‰ì
(
•
, sp->
u
.
lvÆue
);

2295 i‡((
•
->
ty≥
 =
T_OBJECT
 && (•->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
)) ||

2296 (
•
->
ty≥
 =
T_FUNCTION
 && !
	`ÀgÆ_˛osuª
(•->
u
.
func
)))

2298 
	`‰ì_svÆue
(
•
);

2299 
•
->
ty≥
 = 
T_NUMBER
;

2300 
•
->
u
.
numbî
 = 0;

2302 
	}
}

2306 
	$f_loˇl_«me
(
num_¨g
)

2308 
	`exãnd_°ack
();

2309 
	`assign_svÆue_no_‰ì
(
•
, 
Â
 + 
	`EXTRACT_UCHAR
(
pc
));

2310 
pc
++;

2316 i‡((
•
->
ty≥
 =
T_OBJECT
 && (•->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
)) ||

2317 (
•
->
ty≥
 =
T_FUNCTION
 && !
	`ÀgÆ_˛osuª
(•->
u
.
func
)))

2319 
	`‰ì_svÆue
(
•
);

2320 *
•
 = 
c⁄°0
;

2322 
	}
}

2326 
	$f_push_loˇl_v¨übÀ_lvÆue
(
num_¨g
)

2328 
	`exãnd_°ack
();

2329 
•
->
ty≥
 = 
T_LVALUE
;

2330 
•
->
u
.
lvÆue
 = 
Â
 + 
	`EXTRACT_UCHAR
(
pc
);

2331 
pc
++;

2332 
	}
}

2336 
	$f_ªtu∫
(
num_¨g
)

2338 
	`Áèl
("f_return shouldÇot be called.\n");

2339 
	}
}

2341 #ifde‡
DEBUG


2344 
	$f_bªak_poöt
(
num_¨g
)

2346 
	`bªak_poöt
();

2347 
	`push_numbî
(0);

2348 
	}
}

2352 
	$f_bªak_°rög
(
num_¨g
)

2354 
svÆue
 *
¨g
 = 
•
- 
num_¨g
 + 1;

2355 *
°r
;

2357 i‡(
¨g
[0].
ty≥
 =
T_STRING
)

2359 
°r
 = 
	`bªak_°rög
(
¨g
[0].
u
.
°rög
,árg[1].u.
numbî
,

2360 (
num_¨g
 > 2 ? &
¨g
[2] : (
svÆue
 *)0));

2361 
	`p›_n_ñems
(
num_¨g
);

2362 
	`push_m°rög
(
	`make_m°rög
(
°r
));

2363 
	`‰ì
(
°r
);

2367 
	`p›_n_ñems
(
num_¨g
);

2368 
	`push_numbî
(0);

2370 
	}
}

2374 
	$f_˛⁄e_obje˘
(
num_¨g
)

2376 
obje˘
 *
ob
;

2378 
ob
 = 
	`˛⁄e_obje˘
(
•
->
u
.
°rög
);

2379 
	`p›_°ack
();

2380 
	`push_obje˘
(
ob
);

2381 
	}
}

2385 
	$f_aggªg©e
(
num_¨g
)

2387 
ve˘‹
 *
v
;

2388 
num
;

2389 
i
;

2391 ((*)&
num
)[0] = 
pc
[0];

2392 ((*)&
num
)[1] = 
pc
[1];

2393 
pc
 += 2;

2394 
v
 = 
	`Æloˇã_¨øy
(()
num
);

2395 
i
 = 0; i < ()
num
; i++)

2396 
	`assign_svÆue_no_‰ì
(&
v
->
ôem
[
i
], 
•
 + i - 
num
 + 1);

2397 
	`p›_n_ñems
(()
num
);

2398 
	`push_ve˘‹
(
v
, 
FALSE
);

2399 
	}
}

2403 
	$f_m_aggªg©e
(
num_¨g
)

2405 
m≠pög
 *
m
;

2406 
num
;

2407 
svÆue
 *
¨g
;

2408 
i
;

2410 ((*)&
num
)[0] = 
pc
[0];

2411 ((*)&
num
)[1] = 
pc
[1];

2412 
pc
 += 2;

2413 
m
 = 
	`Æloˇã_m≠
(()
num
);

2414 
i
 = 0 ; i < ()
num
 ; i += 2)

2416 
¨g
 = 
•
 + 
i
 - 
num
;

2417 
	`assign_svÆue
(
	`gë_m≠_lvÆue
(
m
, 
¨g
 + 1, 1),árg + 2);

2419 
	`p›_n_ñems
(()
num
);

2420 
	`push_m≠pög
(
m
, 
FALSE
);

2421 
	}
}

2425 
	$f_èû
(
num_¨g
)

2427 i‡(
	`èû
(
•
->
u
.
°rög
))

2428 
	`assign_svÆue
(
•
, &
c⁄°1
);

2430 
	`assign_svÆue
(
•
, &
c⁄°0
);

2431 
	}
}

2435 
	$f_ßve_m≠
(
num_¨g
)

2437 
	`ßve_m≠
(
cuºít_obje˘
, (
•
 - 1)->
u
.
m≠
, sp->u.
°rög
);

2438 
	`p›_°ack
();

2439 
	}
}

2443 
	$f_ßve_obje˘
(
num_¨g
)

2445 
	`ßve_obje˘
(
cuºít_obje˘
, 
•
->
u
.
°rög
);

2447 
	}
}

2451 
	$f_m_ßve_obje˘
(
num_¨g
)

2453 
	`push_m≠pög
(
	`m_ßve_obje˘
(
cuºít_obje˘
), 
FALSE
);

2454 
	}
}

2458 
	$f_föd_obje˘
(
num_¨g
)

2460 
obje˘
 *
ob
;

2462 
ob
 = 
	`föd_obje˘2
(
•
->
u
.
°rög
);

2463 
	`p›_°ack
();

2464 
	`push_obje˘
(
ob
);

2465 
	}
}

2469 
	$f_wûdm©ch
(
num_¨g
)

2471 
i
;

2473 
i
 = 
	`wûdm©
(
•
->
u
.
°rög
, (sp-1)->u.string);

2474 
	`p›_n_ñems
(2);

2475 
	`push_numbî
(
i
);

2476 
	}
}

2480 
	$f_wrôe_fûe
(
num_¨g
)

2482 
i
;

2484 
i
 = 
	`wrôe_fûe
((
•
-1)->
u
.
°rög
, sp->u.string);

2485 
	`p›_n_ñems
(2);

2486 
	`push_numbî
(
i
);

2487 
	}
}

2490 
	$f_ªad_fûe
(
num_¨g
)

2492 *
°r
;

2493 
svÆue
 *
¨g
 = 
•
- 
num_¨g
 + 1;

2494 
°¨t
 = 0, 
Àn
 = 0;

2496 i‡(
num_¨g
 > 1)

2497 
°¨t
 = 
¨g
[1].
u
.
numbî
;

2498 i‡(
num_¨g
 == 3)

2500 i‡(
¨g
[2].
ty≥
 !
T_NUMBER
)

2501 
	`bad_¨g
(2, 
F_READ_FILE
, &
¨g
[2]);

2502 
Àn
 = 
¨g
[2].
u
.
numbî
;

2505 
°r
 = 
	`ªad_fûe
(
¨g
[0].
u
.
°rög
, 
°¨t
, 
Àn
);

2506 
	`p›_n_ñems
(
num_¨g
);

2507 i‡(
°r
 == 0)

2508 
	`push_numbî
(0);

2510 
	`push_m°rög
(
	`make_m°rög
(
°r
));

2511 
	`‰ì
(
°r
);

2513 
	}
}

2516 
	$f_ªad_byãs
(
num_¨g
)

2518 *
°r
;

2519 
svÆue
 *
¨g
 = 
•
- 
num_¨g
 + 1;

2520 
°¨t
 = 0;

2521 
size_t
 
Àn
 = 0;

2523 i‡(
num_¨g
 > 1)

2524 
°¨t
 = 
¨g
[1].
u
.
numbî
;

2525 i‡(
num_¨g
 == 3)

2527 i‡(
¨g
[2].
ty≥
 !
T_NUMBER
)

2528 
	`bad_¨g
(2, 
F_READ_BYTES
, &
¨g
[2]);

2529 
Àn
 = 
¨g
[2].
u
.
numbî
;

2532 
°r
 = 
	`ªad_byãs
(
¨g
[0].
u
.
°rög
, 
°¨t
, 
Àn
);

2533 
	`p›_n_ñems
(
num_¨g
);

2534 i‡(
°r
 == 0)

2535 
	`push_numbî
(0);

2538 
	`push_m°rög
(
	`make_m°rög
(
°r
));

2539 
	`‰ì
(
°r
);

2541 
	}
}

2545 
	$f_wrôe_byãs
(
num_¨g
)

2547 
i
;

2549 
i
 = 
	`wrôe_byãs
((
•
-2)->
u
.
°rög
, (•-1)->u.
numbî
, sp->u.string);

2550 
	`p›_n_ñems
(3);

2551 
	`push_numbî
(
i
);

2552 
	}
}

2556 
	$f_fûe_size
(
num_¨g
)

2558 
i
;

2560 
i
 = 
	`fûe_size
(
•
->
u
.
°rög
);

2561 
	`p›_°ack
();

2562 
	`push_numbî
(
i
);

2563 
	}
}

2567 
	$f_fûe_time
(
num_¨g
)

2569 
i
;

2571 
i
 = 
	`fûe_time
(
•
->
u
.
°rög
);

2572 
	`p›_°ack
();

2573 
	`push_numbî
(
i
);

2574 
	}
}

2577 
	$f_föd_livög
(
num_¨g
)

2579 
ve˘‹
 *
	`föd_livög_obje˘s
(*);

2580 
obje˘
 *
ob
 = 
NULL
;

2581 
ve˘‹
 *
obs
 = 
NULL
;

2582 
svÆue
 *
¨g
;

2584 
¨g
 = 
•
 - 
num_¨g
 + 1;

2586 i‡(
num_¨g
 =1 || 
¨g
[1].
u
.
numbî
 == 0)

2587 
ob
 = 
	`föd_livög_obje˘
(
¨g
[0].
u
.
°rög
);

2589 
obs
 = 
	`föd_livög_obje˘s
(
¨g
[0].
u
.
°rög
);

2590 
	`p›_n_ñems
(
num_¨g
);

2591 i‡(
ob
)

2592 
	`push_obje˘
(
ob
);

2593 i‡(
obs
)

2594 
	`push_ve˘‹
(
obs
, 
FALSE
);

2596 
	`push_numbî
(0);

2597 
	}
}

2601 
	$f_föd_∂ayî
(
num_¨g
)

2603 
num_∂ayî
;

2604 
obje˘
 *
ob
;

2605 
i
;

2607 
i
=0 ; i<
num_∂ayî
 ; i++) {

2608 
ob
 = 
	`gë_öãø˘ive_obje˘
(
i
);

2609 i‡(
ob
->
livög_«me
 && 
	`°rcmp
(ob->livög_«me, 
•
->
u
.
°rög
) == 0) {

2610 
	`p›_°ack
();

2611 
	`push_obje˘
(
ob
);

2615 
ob
 = 
	`föd_livög_obje˘
(
•
->
u
.
°rög
);

2616 
	`p›_°ack
();

2617 i‡(
ob
 && (ob->
Êags
 & 
O_ONCE_INTERACTIVE
))

2618 
	`push_obje˘
(
ob
);

2620 
	`push_numbî
(0);

2621 
	}
}

2625 
	$f_wrôe_sockë
(
num_¨g
)

2627 i‡(
•
->
ty≥
 =
T_NUMBER
)

2629 
tmpbuf
[10];

2631 ()
	`•rötf
(
tmpbuf
, "%d", 
•
->
u
.
numbî
);

2632 i‡(
cuºít_obje˘
->
öãø˘ive
)

2633 
	`wrôe_sockë
(
tmpbuf
, 
cuºít_obje˘
);

2634 i‡(
cuºít_obje˘
 =
ma°î_ob
)

2635 
	`wrôe_sockë
(
tmpbuf
, 0);

2639 i‡(
cuºít_obje˘
->
öãø˘ive
)

2640 
	`wrôe_sockë
(
•
->
u
.
°rög
, 
cuºít_obje˘
);

2641 i‡(
cuºít_obje˘
 =
ma°î_ob
)

2642 
	`wrôe_sockë
(
•
->
u
.
°rög
, 0);

2644 
	}
}

2648 
	$f_°r2vÆ
(
num_¨g
)

2650 
svÆue
 
svÆ
 = *
•
;

2651 *
°r
 = 
svÆ
.
u
.
°rög
;

2653 *
•
 = 
c⁄°0
;

2654 ()
	`ª°‹e_⁄e
(
•
, &
°r
);

2655 
	`‰ì_svÆue
(&
svÆ
);

2656 
	}
}

2660 
	$f_obsﬁëe
(
num_¨g
)

2662 
	`WARNOBSOLETE
(
cuºít_obje˘
, 
•
->
u
.
°rög
);

2663 
	}
}

2667 
	$f_vÆ2°r
(
num_¨g
)

2669 *
	`vÆto°r
(
svÆue
 *);

2670 *
ªt
;

2672 
ªt
 = 
	`vÆto°r
(
•
);

2673 
	`p›_°ack
();

2674 
	`push_m°rög
(
	`make_m°rög
(
ªt
));

2675 
	`‰ì
(
ªt
);

2676 
	}
}

2680 
	$f_ª°‹e_m≠
(
num_¨g
)

2682 
m≠pög
 *
m≠
 = 
	`Æloˇã_m≠
(0);

2684 
	`ª°‹e_m≠
(
cuºít_obje˘
, 
m≠
, 
•
->
u
.
°rög
);

2685 
	`p›_°ack
();

2686 
	`push_m≠pög
(
m≠
, 
FALSE
);

2687 
	}
}

2691 
	$f_ª°‹e_obje˘
(
num_¨g
)

2693 
i
;

2695 
i
 = 
	`ª°‹e_obje˘
(
cuºít_obje˘
, 
•
->
u
.
°rög
);

2696 
	`p›_°ack
();

2697 
	`push_numbî
(
i
);

2698 
	}
}

2702 
	$f_m_ª°‹e_obje˘
(
num_¨g
)

2704 
i
;

2706 
i
 = 
	`m_ª°‹e_obje˘
(
cuºít_obje˘
, 
•
->
u
.
m≠
);

2707 
	`p›_°ack
();

2708 
	`push_numbî
(
i
);

2709 
	}
}

2713 
	$f_this_öãø˘ive
(
num_¨g
)

2715 i‡(
cuºít_öãø˘ive
 &&

2716 !(
cuºít_öãø˘ive
->
Êags
 & 
O_DESTRUCTED
))

2717 
	`push_obje˘
(
cuºít_öãø˘ive
);

2719 
	`push_numbî
(0);

2720 
	}
}

2724 
	$f_this_∂ayî
(
num_¨g
)

2726 i‡(
comm™d_givî
 && !(comm™d_givî->
Êags
 & 
O_DESTRUCTED
))

2727 
	`push_obje˘
(
comm™d_givî
);

2729 
	`push_numbî
(0);

2730 
	}
}

2734 
	$f_£t_this_∂ayî
(
num_¨g
)

2736 i‡(
•
->
ty≥
 =
T_NUMBER
)

2738 i‡(
•
->
u
.
numbî
 != 0)

2739 
	`îr‹
("Badárgument 1Åo set_this_player()\n");

2740 
comm™d_givî
 = 0;

2743 i‡(
•
->
u
.
ob
->
Êags
 & 
O_ENABLE_COMMANDS
)

2744 
comm™d_givî
 = 
•
->
u
.
ob
;

2745 
	}
}

2749 
	$f_livög
(
num_¨g
)

2751 i‡(
•
->
ty≥
 =
T_NUMBER
)

2753 
	`assign_svÆue
(
•
, &
c⁄°0
);

2756 i‡(
•
->
u
.
ob
->
Êags
 & 
O_ENABLE_COMMANDS
)

2757 
	`assign_svÆue
(
•
, &
c⁄°1
);

2759 
	`assign_svÆue
(
•
, &
c⁄°0
);

2760 
	}
}

2764 
	$f_£t_auth
(
num_¨g
)

2766 
svÆue
 *
ªt
 = 0;

2767 
svÆue
 *
¨g
 = 
•
 - 1;

2769 i‡(
ma°î_ob
)

2771 
	`push_obje˘
(
cuºít_obje˘
);

2772 
	`push_obje˘
(
¨g
->
u
.
ob
);

2773 
	`push_svÆue
(
¨g
 + 1);

2774 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_VALID_SET_AUTH
, 3);

2776 i‡(!
ªt
)

2778 
	`p›_n_ñems
(2);

2779 
	`push_numbî
(0);

2782 #ifde‡
USE_SWAP


2783 
	`ac˚ss_obje˘
(
¨g
->
u
.
ob
);

2785 
	`assign_svÆue
(&(
¨g
->
u
.
ob
->
v¨übÀs
[-1]), 
ªt
);

2786 #ifde‡
USE_SWAP


2787 
	`ac˚ss_obje˘
(
cuºít_obje˘
);

2789 
	`p›_n_ñems
(2);

2790 
	`push_numbî
(0);

2791 
	}
}

2795 
	$f_quîy_auth
(
num_¨g
)

2797 
i
;

2798 
obje˘
 *
ob
 = 
•
->
u
.ob;

2800 
	`p›_°ack
();

2801 #ifde‡
USE_SWAP


2802 
	`ac˚ss_obje˘
(
ob
);

2804 
ob
->
v¨übÀs
[-1].
ty≥
)

2806 
T_POINTER
:

2807 
	`push_ve˘‹
(
	`Æloˇã_¨øy
(
ob
->
v¨übÀs
[-1].
u
.
vec
->
size
), 
FALSE
);

2808 
i
 = 0; i < 
ob
->
v¨übÀs
[-1].
u
.
vec
->
size
; i++)

2809 
	`assign_svÆue_no_‰ì
(&(
•
->
u
.
vec
->
ôem
[
i
]),

2810 &(
ob
->
v¨übÀs
[-1].
u
.
vec
->
ôem
[
i
]));

2812 
T_MAPPING
:

2813 
	`push_m≠pög
(
	`c›y_m≠pög
(
ob
->
v¨übÀs
[-1].
u
.
m≠
), 
FALSE
);

2817 
	`push_svÆue
(&(
ob
->
v¨übÀs
[-1]));

2820 #ifde‡
USE_SWAP


2821 
	`ac˚ss_obje˘
(
cuºít_obje˘
);

2823 
	}
}

2827 
	$f_ex∂ode
(
num_¨g
)

2829 
ve˘‹
 *
v
;

2831 
v
 = 
	`ex∂ode_°rög
((
•
-1)->
u
.
°rög
, sp->u.string);

2832 
	`p›_n_ñems
(2);

2833 i‡(
v
) {

2834 
	`push_ve˘‹
(
v
, 
FALSE
);

2836 
	`push_numbî
(0);

2838 
	}
}

2841 
	$f_fûãr
(
num_¨g
)

2843 
svÆue
 *
¨g
;

2845 
¨g
 = 
•
 - 
num_¨g
 + 1;

2847 i‡(
num_¨g
 =2 && 
¨g
[1].
ty≥
 =
T_FUNCTION
) {

2849 } i‡(
num_¨g
 >3 && 
¨g
[1].
ty≥
 =
T_STRING
) {

2850 
˛osuª
 *
fun
;

2851 
obje˘
 *
ob
;

2853 i‡(
¨g
[2].
ty≥
 =
T_OBJECT
)

2854 
ob
 = 
¨g
[2].
u
.ob;

2855 i‡(
¨g
[2].
ty≥
 =
T_STRING
)

2856 
ob
 = 
	`föd_obje˘
(
¨g
[2].
u
.
°rög
);

2858 
ob
 = 0;

2860 i‡(!
ob
)

2861 
	`bad_¨g
(3, 
F_FILTER
, &
¨g
[2]);

2864 
fun
 = 
	`Æloc_obj˛osuª°r
(
FUN_LFUNO
, 
¨g
[1].
u
.
°rög
, 
ob
, "f_filter", 0);

2865 i‡(!
fun
) {

2872 
	`îr‹
("Fun˘i⁄ u£d i¿fûã∏couldÇŸ bêfound: %s\n", 
¨g
[1].
u
.
°rög
);

2874 ()
	`¥ötf
("Fun˘i⁄ u£d i¿fûã∏couldÇŸ bêfound: %s\n", 
¨g
[1].
u
.
°rög
);

2875 
	`p›_n_ñems
(
num_¨g
);

2876 
	`push_numbî
(0);

2880 i‡(
num_¨g
 > 3) {

2881 
	`‰ì_ve˘‹
(
fun
->
fu«rgs
);

2882 
fun
->
fu«rgs
 = 
	`Æloˇã_¨øy
(2);

2883 
fun
->
fu«rgs
->
ôem
[0] = 
c⁄°em±y
;

2884 
	`assign_svÆue_no_‰ì
(&
fun
->
fu«rgs
->
ôem
[1], &
¨g
[3]);

2886 
	`‰ì_svÆue
(&
¨g
[1]);

2887 
¨g
[1].
ty≥
 = 
T_FUNCTION
;

2888 
¨g
[1].
u
.
func
 = 
fun
;

2890 
	`WARNOBSOLETE
(
cuºít_obje˘
, "stringás function in filter");

2892 
	`îr‹
("BadárgumentsÅo filter\n");

2894 i‡(
¨g
[0].
ty≥
 =
T_POINTER
) {

2895 
ve˘‹
 *
ªs
;

2896 
	`check_f‹_de°r
(&
¨g
[0]);

2897 
ªs
 = 
	`fûãr_¨r
(
¨g
[0].
u
.
vec
,árg[1].u.
func
);

2898 
	`p›_n_ñems
(
num_¨g
);

2899 i‡(
ªs
) {

2900 
	`push_ve˘‹
(
ªs
, 
FALSE
);

2902 
	`push_numbî
(0);

2903 } i‡(
¨g
[0].
ty≥
 =
T_MAPPING
) {

2904 
m≠pög
 *
m
;

2905 
	`check_f‹_de°r
(&
¨g
[0]);

2906 
m
 = 
	`fûãr_m≠
(
¨g
[0].
u
.
m≠
,árg[1].u.
func
);

2907 
	`p›_n_ñems
(
num_¨g
);

2908 i‡(
m
) {

2909 
	`push_m≠pög
(
m
, 
FALSE
);

2911 
	`push_numbî
(0);

2914 
	`p›_n_ñems
(
num_¨g
);

2915 
	`push_numbî
(0);

2917 
	}
}

2921 
	$f_£t_bô
(
num_¨g
)

2923 
size_t
 
Àn
, 
ﬁd_Àn
;

2924 *
°r
;

2925 
öd
;

2927 i‡(
•
->
u
.
numbî
 > 
MAX_BITS
)

2928 
	`îr‹
("£t_bô:Åoÿbig bôÇumbî: %d\n", 
•
->
u
.
numbî
);

2929 
Àn
 = 
	`°æí
((
•
-1)->
u
.
°rög
);

2930 
ﬁd_Àn
 = 
Àn
;

2931 
öd
 = 
•
->
u
.
numbî
/6;

2932 i‡(
öd
 >
Àn
)

2933 
Àn
 = 
öd
 + 1;

2934 
°r
 = 
	`Æloˇã_m°rög
(
Àn
);

2935 
°r
[
Àn
] = '\0';

2936 i‡(
ﬁd_Àn
)

2937 ()
	`mem˝y
(
°r
, (
•
-1)->
u
.
°rög
, 
ﬁd_Àn
);

2938 i‡(
Àn
 > 
ﬁd_Àn
)

2939 ()
	`mem£t
(
°r
 + 
ﬁd_Àn
, ' ', 
Àn
 - old_len);

2940 i‡(
°r
[
öd
] > 0x3f + ' ' || str[ind] < ' ')

2941 
	`îr‹
("IŒegÆ bôÖ©ã∫ i¿£t_bô ch¨a˘î %d\n", 
öd
);

2942 
°r
[
öd
] = ((°r[öd] - ' 'Ë| (1 << (
•
->
u
.
numbî
 % 6))) + ' ';

2943 
	`p›_n_ñems
(2);

2944 
	`push_m°rög
(
°r
);

2945 
	}
}

2949 
	$f_˛ór_bô
(
num_¨g
)

2951 
size_t
 
Àn
;

2952 *
°r
;

2953 
öd
;

2955 i‡(
•
->
u
.
numbî
 > 
MAX_BITS
)

2956 
	`îr‹
("˛ór_bô:Åoÿbig bôÇumbî: %d\n", 
•
->
u
.
numbî
);

2957 
Àn
 = 
	`°æí
((
•
-1)->
u
.
°rög
);

2958 
öd
 = 
•
->
u
.
numbî
/6;

2959 i‡(
öd
 >
Àn
) {

2961 
	`p›_°ack
();

2964 
°r
 = 
	`Æloˇã_m°rög
(
Àn
);

2965 ()
	`mem˝y
(
°r
, (
•
-1)->
u
.
°rög
, 
Àn
+1);

2966 i‡(
°r
[
öd
] > 0x3f + ' ' || str[ind] < ' ')

2967 
	`îr‹
("IŒegÆ bôÖ©ã∫ i¿˛ór_bô ch¨a˘î %d\n", 
öd
);

2968 
°r
[
öd
] = ((°r[öd] - ' 'Ë& ~(1 << 
•
->
u
.
numbî
 % 6)) + ' ';

2969 
	`p›_n_ñems
(2);

2970 
	`push_m°rög
(
°r
);

2971 
	}
}

2975 
	$f_ã°_bô
(
num_¨g
)

2977 
Àn
;

2979 
Àn
 = 
	`°æí
((
•
-1)->
u
.
°rög
);

2980 i‡(
•
->
u
.
numbî
/6 >
Àn
) {

2981 
	`p›_n_ñems
(2);

2982 
	`push_numbî
(0);

2985 i‡(((
•
-1)->
u
.
°rög
[•->u.
numbî
/6] - ' ') & 1 << sp->u.number % 6) {

2986 
	`p›_n_ñems
(2);

2987 
	`push_numbî
(1);

2989 
	`p›_n_ñems
(2);

2990 
	`push_numbî
(0);

2992 
	}
}

2996 
	$f_ˇtch
(
num_¨g
)

2998 
	`Áèl
("f_catch shouldÇot be called.\n");

2999 
	}
}

3003 
	$f_íd_ˇtch
(
num_¨g
)

3005 
	`Áèl
("f_end_catch shouldÇot be called.\n");

3006 
	}
}

3010 
	$f_throw
(
num_¨g
)

3012 i‡(
•
->
ty≥
 =
T_NUMBER
 && sp->
u
.
numbî
 == 0)

3013 
	`îr‹
("IllegalÅhrow.\n");

3015 
	`assign_svÆue
(&
ˇtch_vÆue
, 
•
);

3016 
	`p›_°ack
();

3018 
	`throw_îr‹
();

3019 
	}
}

3023 
	$f_nŸify_Áû
(
num_¨g
)

3025 
¥i
 = 1;

3027 i‡(
num_¨g
 == 2)

3029 
¥i
 = 
•
->
u
.
numbî
;

3030 
	`p›_°ack
();

3032 
	`£t_nŸify_Áû_mesßge
(
•
->
u
.
°rög
, 
¥i
);

3034 
	`p›_°ack
();

3035 
	`push_numbî
(0);

3036 
	}
}

3040 
	$f_quîy_idÀ
(
num_¨g
)

3042 
i
;

3044 
i
 = 
	`quîy_idÀ
(
•
->
u
.
ob
);

3045 
	`p›_°ack
();

3046 
	`push_numbî
(
i
);

3047 
	}
}

3051 
	$f_quîy_öãø˘ive
(
num_¨g
)

3053 i‡(
•
->
ty≥
 =
T_NUMBER
)

3055 
	`assign_svÆue
(
•
, &
c⁄°0
);

3058 
	`assign_svÆue
(
•
, sp->
u
.
ob
->
öãø˘ive
 ? &
c⁄°1
 : &
c⁄°0
);

3059 
	}
}

3063 
	$f_im∂ode
(
num_¨g
)

3065 *
°r
;

3067 i‡((
•
-1)->
ty≥
 =
T_NUMBER
)

3069 
	`p›_°ack
();

3072 
	`check_f‹_de°r
(
•
-1);

3073 
°r
 = 
	`im∂ode_°rög
((
•
-1)->
u
.
vec
, sp->u.
°rög
);

3074 
	`p›_n_ñems
(2);

3075 i‡(
°r
) {

3076 
	`push_m°rög
(
	`make_m°rög
(
°r
));

3077 
	`‰ì
(
°r
);

3079 
	`push_numbî
(0);

3081 
	}
}

3085 
	$f_quîy_¢o›
(
num_¨g
)

3087 
obje˘
 *
ob
;

3089 i‡(
cuºít_obje˘
 =
ma°î_ob
 && 
•
->
u
.
ob
->
öãø˘ive
)

3090 
ob
 = 
	`quîy_¢o›
(
•
->
u
.ob);

3092 
ob
 = 0;

3093 
	`p›_°ack
();

3094 
	`push_obje˘
(
ob
);

3095 
	}
}

3099 
	$f_quîy_ù_numbî_«me
(
«me
, 
num_¨g
)

3101 *
tmp
;

3103 i‡(
num_¨g
 =1 && 
•
->
ty≥
 !
T_OBJECT
)

3104 
	`îr‹
("Bad optionalárgumentÅo query_ip_number()\n");

3106 i‡(
«me
)

3107 
tmp
 = 
	`quîy_ù_«me
(
num_¨g
 ? 
•
->
u
.
ob
 : 0);

3109 
tmp
 = 
	`quîy_ù_numbî
(
num_¨g
 ? 
•
->
u
.
ob
 : 0);

3110 i‡(
num_¨g
)

3111 
	`p›_°ack
();

3112 i‡(
tmp
 == 0)

3113 
	`push_numbî
(0);

3115 
	`push_°rög
(
tmp
, 
STRING_MSTRING
);

3116 
	}
}

3119 
	$f_quîy_ù_numbî
(
num_¨g
)

3121 
	`f_quîy_ù_numbî_«me
(0, 
num_¨g
);

3122 
	}
}

3125 
	$f_quîy_ù_«me
(
num_¨g
)

3127 
	`f_quîy_ù_numbî_«me
(1, 
num_¨g
);

3128 
	}
}

3132 
	$f_quîy_ù_idít
(
num_¨g
)

3134 
obje˘
 *
ob
 = 
•
->
u
.ob;

3135 
svÆue
 *
ªt
;

3137 
	`p›_°ack
();

3138 
	`push_obje˘
(
cuºít_obje˘
);

3139 
	`push_obje˘
(
ob
);

3140 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_VALID_QUERY_IP_IDENT
, 2);

3141 i‡((
ªt
 && (ªt->
ty≥
 !
T_NUMBER
 ||Ñë->
u
.
numbî
 == 0)) ||

3142 !
ob
->
öãø˘ive
 || !ob->öãø˘ive->
∫ame
)

3144 
	`push_numbî
(0);

3148 
	`push_°rög
(
ob
->
öãø˘ive
->
∫ame
, 
STRING_MSTRING
);

3150 
	}
}

3154 
	$f_quîy_ho°_«me
(
num_¨g
)

3156 *
	`quîy_ho°_«me
();

3157 *
tmp
;

3159 
tmp
 = 
	`quîy_ho°_«me
();

3160 i‡(
tmp
)

3161 
	`push_°rög
(
tmp
, 
STRING_MSTRING
);

3163 
	`push_numbî
(0);

3164 
	}
}

3168 
	$f_Æl_övít‹y
(
num_¨g
)

3170 
ve˘‹
 *
vec
;

3172 
vec
 = 
	`Æl_övít‹y
(
•
->
u
.
ob
);

3173 
	`p›_°ack
();

3174 i‡(
vec
 == 0) {

3175 
	`push_numbî
(0);

3177 
	`push_ve˘‹
(
vec
, 
FALSE
);

3179 
	}
}

3183 
	$f_dìp_övít‹y
(
num_¨g
)

3185 
ve˘‹
 *
vec
;

3187 i‡(
•
->
ty≥
 =
T_NUMBER
)

3188 
vec
 = 
	`Æloˇã_¨øy
(0);

3190 
vec
 = 
	`dìp_övít‹y
(
•
->
u
.
ob
, 0);

3191 
	`‰ì_svÆue
(
•
);

3192 
•
->
ty≥
 = 
T_POINTER
;

3193 
•
->
u
.
vec
 = vec;

3194 
	}
}

3198 
	$f_ívú⁄mít
(
num_¨g
)

3200 
obje˘
 *
ob
;

3202 
ob
 = 
	`ívú⁄mít
(
•
);

3203 
	`p›_°ack
();

3204 
	`push_obje˘
(
ob
);

3205 
	}
}

3209 
	$f_this_obje˘
(
num_¨g
)

3211 
	`push_obje˘
(
cuºít_obje˘
);

3212 
	}
}

3216 
	$f_obje˘_˛⁄es
(
num_¨g
)

3218 
ve˘‹
 *
v
;

3219 
obje˘
 *
ob
;

3220 
i
;

3222 i‡(
•
->
ty≥
 =
T_NUMBER
)

3223 
v
 = 
	`Æloˇã_¨øy
(0);

3226 
ob
 = 
obj_li°
;

3227 
i
 = 0;

3230 i‡(
ob
->
¥og
 =
•
->
u
.ob->¥og && (ob->
Êags
 & 
O_CLONE
))

3231 
i
++;

3232 } (
ob
 = ob->
√xt_Æl
Ë!
obj_li°
);

3233 
v
 = 
	`Æloˇã_¨øy
(
i
);

3234 
ob
 = 
obj_li°
;

3235 
i
 = 0;

3237 i‡(
ob
->
¥og
 =
•
->
u
.ob->¥og && (ob->
Êags
 & 
O_CLONE
))

3239 
v
->
ôem
[
i
].
ty≥
 = 
T_OBJECT
;

3240 
v
->
ôem
[
i
++].
u
.
ob
 = ob;

3241 
	`add_ªf
(
ob
,"object_clones");

3243 (
ob
 = ob->
√xt_Æl
Ë!
obj_li°
) ;

3245 
	`p›_°ack
();

3246 
	`push_ve˘‹
(
v
, 
FALSE
);

3247 
	}
}

3251 
	$f_comm™ds
(
num_¨g
)

3253 
ve˘‹
 *
vec
;

3255 i‡(
•
->
ty≥
 =
T_NUMBER
)

3256 
vec
 = 
	`Æloˇã_¨øy
(0);

3258 
vec
 = 
	`gë_loˇl_comm™ds
(
•
->
u
.
ob
);

3259 
	`p›_°ack
();

3260 
	`push_ve˘‹
(
vec
, 
FALSE
);

3261 
	}
}

3265 
	$f_time
(
num_¨g
)

3267 
	`push_numbî
(
cuºít_time
);

3268 
	}
}

3272 
	$f_max
(
num_¨g
)

3274 
i
;

3275 
svÆue
 *
¨g0
, *
¨gn
, *
maxp
;

3277 
¨g0
 = 
•
 - 
num_¨g
 + 1;

3278 
¨gn
 = 
¨g0
 + 1;

3279 
maxp
 = 
¨g0
;

3281 
¨g0
->
ty≥
)

3283 
T_NUMBER
:

3284 
T_STRING
:

3285 
T_FLOAT
:

3289 
	`bad_¨g
(1, 
F_MIN
, 
¨g0
);

3293 
i
 = 1; i < 
num_¨g
; i++)

3295 i‡(
maxp
->
ty≥
 !
¨gn
->type)

3296 
	`bad_¨g
(
i
 + 1, 
F_MIN
, 
¨g0
 + i);

3298 
¨g0
->
ty≥
)

3300 
T_NUMBER
:

3301 i‡(
maxp
->
u
.
numbî
 < 
¨gn
->u.number)

3302 
maxp
 = 
¨gn
;

3305 
T_STRING
:

3306 i‡(
	`°rcmp
(
maxp
->
u
.
°rög
, 
¨gn
->u.string) < 0)

3307 
maxp
 = 
¨gn
;

3310 
T_FLOAT
:

3311 i‡(
maxp
->
u
.
ªÆ
 < 
¨gn
->u.real)

3312 
maxp
 = 
¨gn
;

3316 
¨gn
++;

3319 i‡(
maxp
 !
¨g0
)

3320 
	`assign_svÆue
(
¨g0
, 
maxp
);

3322 
	`p›_n_ñems
(
num_¨g
 - 1);

3323 
	}
}

3327 
	$f_mö
(
num_¨g
)

3329 
i
;

3330 
svÆue
 *
¨g0
, *
¨gn
, *
möp
;

3332 
¨g0
 = 
•
 - 
num_¨g
 + 1;

3333 
¨gn
 = 
¨g0
 + 1;

3334 
möp
 = 
¨g0
;

3336 
¨g0
->
ty≥
)

3338 
T_NUMBER
:

3339 
T_STRING
:

3340 
T_FLOAT
:

3344 
	`bad_¨g
(1, 
F_MIN
, 
¨g0
);

3348 
i
 = 1; i < 
num_¨g
; i++)

3350 i‡(
möp
->
ty≥
 !
¨gn
->type)

3351 
	`bad_¨g
(
i
 + 1, 
F_MIN
, 
¨g0
 + i);

3353 
¨g0
->
ty≥
)

3355 
T_NUMBER
:

3356 i‡(
möp
->
u
.
numbî
 > 
¨gn
->u.number)

3357 
möp
 = 
¨gn
;

3360 
T_STRING
:

3361 i‡(
	`°rcmp
(
möp
->
u
.
°rög
, 
¨gn
->u.string) > 0)

3362 
möp
 = 
¨gn
;

3365 
T_FLOAT
:

3366 i‡(
möp
->
u
.
ªÆ
 > 
¨gn
->u.real)

3367 
möp
 = 
¨gn
;

3371 
¨gn
++;

3374 i‡(
möp
 !
¨g0
)

3375 
	`assign_svÆue
(
¨g0
, 
möp
);

3377 
	`p›_n_ñems
(
num_¨g
 - 1);

3378 
	}
}

3382 
	$f_add
(
num_¨g
)

3384 
i
;

3387 i‡((
•
-1)->
ty≥
 =
T_STRING
 && sp->type == T_STRING)

3389 *
ªs
;

3390 
l
 = 
	`°æí
((
•
-1)->
u
.
°rög
);

3391 
k
 = 
l
 + 
	`°æí
(
•
->
u
.
°rög
);

3392 i‡(
k
 > 
MAX_STRING_LENGTH
)

3393 
	`îr‹
("TooÜong string.\n");

3394 
ªs
 = 
	`Æloˇã_m°rög
(
k
);

3395 ()
	`°r˝y
(
ªs
, (
•
-1)->
u
.
°rög
);

3396 ()
	`°r˝y
(
ªs
+
l
, 
•
->
u
.
°rög
);

3397 
	`p›_n_ñems
(2);

3398 
	`push_m°rög
(
ªs
);

3400 i‡((
•
-1)->
ty≥
 =
T_NUMBER
 && sp->ty≥ =
T_STRING
)

3402 
buff
[20], *
ªs
;

3403 ()
	`•rötf
(
buff
, "%d", (
•
-1)->
u
.
numbî
);

3404 
ªs
 = 
	`Æloˇã_m°rög
(
	`°æí
(
•
->
u
.
°rög
Ë+ såÀn(
buff
));

3405 ()
	`°r˝y
(
ªs
, 
buff
);

3406 ()
	`°rˇt
(
ªs
, 
•
->
u
.
°rög
);

3407 
	`p›_n_ñems
(2);

3408 
	`push_m°rög
(
ªs
);

3410 i‡(
•
->
ty≥
 =
T_NUMBER
 && (•-1)->ty≥ =
T_STRING
)

3412 
buff
[20];

3413 *
ªs
;

3414 ()
	`•rötf
(
buff
, "%d", 
•
->
u
.
numbî
);

3415 
ªs
 = 
	`Æloˇã_m°rög
(
	`°æí
((
•
-1)->
u
.
°rög
Ë+ såÀn(
buff
));

3416 ()
	`°r˝y
(
ªs
, (
•
-1)->
u
.
°rög
);

3417 ()
	`°rˇt
(
ªs
, 
buff
);

3418 
	`p›_n_ñems
(2);

3419 
	`push_m°rög
(
ªs
);

3421 i‡((
•
-1)->
ty≥
 =
T_NUMBER
 && sp->type == T_NUMBER)

3423 
i
 = 
•
->
u
.
numbî
 + (sp-1)->u.number;

3424 
•
--;

3425 
•
->
u
.
numbî
 = 
i
;

3427 i‡((
•
-1)->
ty≥
 =
T_FLOAT
 && sp->type == T_FLOAT)

3429 
	`FLOATASGOP
((
•
-1)->
u
.
ªÆ
, += , sp->u.real);

3430 
•
--;

3432 i‡((
•
-1)->
ty≥
 =
T_POINTER
 && sp->type == T_POINTER)

3434 
ve˘‹
 *
v
;

3435 
	`check_f‹_de°r
(
•
-1);

3436 
	`check_f‹_de°r
(
•
);

3437 
v
 = 
	`add_¨øy
((
•
-1)->
u
.
vec
,sp->u.vec);

3438 
	`p›_n_ñems
(2);

3439 
	`push_ve˘‹
(
v
, 
FALSE
);

3441 i‡((
•
-1)->
ty≥
 =
T_MAPPING
 && sp->type == T_MAPPING)

3443 
m≠pög
 *
m
;

3444 
	`check_f‹_de°r
(
•
-1);

3445 
	`check_f‹_de°r
(
•
);

3446 
m
 = 
	`add_m≠pög
((
•
-1)->
u
.
m≠
, sp->u.map);

3447 
	`p›_n_ñems
(2);

3448 
	`push_m≠pög
(
m
, 
FALSE
);

3452 
	`îr‹
("BadÅype ofárgÅo '+'\n");

3454 
	}
}

3458 
	$f_subåa˘
(
num_¨g
)

3460 
i
;

3462 i‡((
•
-1)->
ty≥
 =
T_POINTER
 && sp->type == T_POINTER)

3464 
ve˘‹
 *
v
;

3466 
	`check_f‹_de°r
(
•
-1);

3467 
	`check_f‹_de°r
(
•
);

3469 
v
 = 
	`subåa˘_¨øy
((
•
-1)->
u
.
vec
, sp->u.vec);

3471 
	`p›_°ack
();

3472 
	`p›_°ack
();

3474 i‡(
v
 == 0)

3476 
	`push_numbî
(0);

3480 
	`push_ve˘‹
(
v
, 
FALSE
);

3485 i‡((
•
-1)->
ty≥
 =
T_FLOAT
 && sp->type == T_FLOAT)

3487 
	`FLOATASGOP
((
•
-1)->
u
.
ªÆ
, -= , sp->u.real);

3488 
	`p›_°ack
();

3491 i‡((
•
-1)->
ty≥
 !
T_NUMBER
)

3492 
	`bad_¨g
(1, 
F_SUBTRACT
, 
•
-1);

3493 i‡(
•
->
ty≥
 !
T_NUMBER
)

3494 
	`bad_¨g
(2, 
F_SUBTRACT
, 
•
);

3495 
i
 = (
•
-1)->
u
.
numbî
 - sp->u.number;

3496 
	`p›_°ack
();

3497 
•
->
u
.
numbî
 = 
i
;

3498 
	}
}

3502 
	$f_™d
(
num_¨g
)

3504 
i
;

3506 i‡(
•
->
ty≥
 =
T_POINTER
 && (sp-1)->type == T_POINTER)

3508 
ve˘‹
 *
v
;

3510 
v
 = 
	`öãr£˘_¨øy
(
•
->
u
.
vec
, (sp-1)->u.vec);

3512 
	`p›_°ack
();

3513 
	`p›_°ack
();

3514 i‡(
v
 == 0)

3516 
	`push_numbî
(0);

3520 
	`push_ve˘‹
(
v
, 
FALSE
);

3524 i‡((
•
-1)->
ty≥
 !
T_NUMBER
)

3525 
	`bad_¨g
(1, 
F_AND
, 
•
-1);

3526 i‡(
•
->
ty≥
 !
T_NUMBER
)

3527 
	`bad_¨g
(2, 
F_AND
, 
•
);

3528 
i
 = (
•
-1)->
u
.
numbî
 & sp->u.number;

3529 
	`p›_°ack
();

3530 
•
->
u
.
numbî
 = 
i
;

3531 
	}
}

3535 
	$f_‹
(
num_¨g
)

3537 
i
;

3539 i‡(
•
->
ty≥
 =
T_POINTER
 && (sp-1)->type == T_POINTER)

3541 
ve˘‹
 *
v
;

3543 
v
 = 
	`uni⁄_¨øy
((
•
-1)->
u
.
vec
, sp->u.vec);

3545 
	`p›_°ack
();

3546 
	`p›_°ack
();

3548 i‡(
v
 =
NULL
)

3549 
	`push_numbî
(0);

3551 
	`push_ve˘‹
(
v
, 
FALSE
);

3556 i‡((
•
-1)->
ty≥
 !
T_NUMBER
)

3557 
	`bad_¨g
(1, 
F_OR
, 
•
-1);

3558 i‡(
•
->
ty≥
 !
T_NUMBER
)

3559 
	`bad_¨g
(2, 
F_OR
, 
•
);

3560 
i
 = (
•
-1)->
u
.
numbî
 | sp->u.number;

3561 
•
--;

3562 
•
->
u
.
numbî
 = 
i
;

3563 
	}
}

3567 
	$f_x‹
(
num_¨g
)

3569 
i
;

3571 i‡((
•
-1)->
ty≥
 !
T_NUMBER
)

3572 
	`bad_¨g
(1, 
F_XOR
, 
•
-1);

3573 i‡(
•
->
ty≥
 !
T_NUMBER
)

3574 
	`bad_¨g
(2, 
F_XOR
, 
•
);

3575 
i
 = (
•
-1)->
u
.
numbî
 ^ sp->u.number;

3576 
•
--;

3577 
•
->
u
.
numbî
 = 
i
;

3578 
	}
}

3582 
	$f_lsh
(
num_¨g
)

3584 
i
;

3586 i‡((
•
-1)->
ty≥
 !
T_NUMBER
)

3587 
	`bad_¨g
(1, 
F_LSH
, 
•
-1);

3588 i‡(
•
->
ty≥
 !
T_NUMBER
)

3589 
	`bad_¨g
(2, 
F_LSH
, 
•
);

3590 
i
 = (
•
-1)->
u
.
numbî
 << sp->u.number;

3591 
•
--;

3592 
•
->
u
.
numbî
 = 
i
;

3593 
	}
}

3597 
	$f_rsh
(
num_¨g
)

3599 
i
;

3601 i‡((
•
-1)->
ty≥
 !
T_NUMBER
)

3602 
	`bad_¨g
(1, 
F_RSH
, 
•
-1);

3603 i‡(
•
->
ty≥
 !
T_NUMBER
)

3604 
	`bad_¨g
(2, 
F_RSH
, 
•
);

3605 
i
 = ()(()(
•
-1)->
u
.
numbî
 >> sp->u.number);

3606 
•
--;

3607 
•
->
u
.
numbî
 = 
i
;

3608 
	}
}

3612 
	$f_mu…ùly
(
num_¨g
)

3614 
i
;

3616 i‡((
•
-1)->
ty≥
 =
T_FLOAT
 && sp->type == T_FLOAT)

3618 
	`FLOATASGOP
((
•
-1)->
u
.
ªÆ
, *= , sp->u.real);

3619 
•
--;

3622 i‡((
•
-1)->
ty≥
 !
T_NUMBER
)

3623 
	`bad_¨g
(1, 
F_MULTIPLY
, 
•
-1);

3624 i‡(
•
->
ty≥
 !
T_NUMBER
)

3625 
	`bad_¨g
(2, 
F_MULTIPLY
, 
•
);

3626 
i
 = (
•
-1)->
u
.
numbî
 * sp->u.number;

3627 
•
--;

3628 
•
->
u
.
numbî
 = 
i
;

3629 
	}
}

3633 
	$f_divide
(
num_¨g
)

3635 
i
;

3637 i‡((
•
-1)->
ty≥
 =
T_FLOAT
 && sp->type == T_FLOAT)

3639 i‡(
•
->
u
.
ªÆ
 == 0.0)

3640 
	`îr‹
("Division by zero\n");

3641 
	`FLOATASGOP
((
•
-1)->
u
.
ªÆ
, /= , sp->u.real);

3642 
•
--;

3645 i‡((
•
-1)->
ty≥
 !
T_NUMBER
)

3646 
	`bad_¨g
(1, 
F_DIVIDE
, 
•
-1);

3647 i‡(
•
->
ty≥
 !
T_NUMBER
)

3648 
	`bad_¨g
(2, 
F_DIVIDE
, 
•
);

3649 i‡(
•
->
u
.
numbî
 == 0)

3650 
	`îr‹
("Division by zero\n");

3651 
i
 = (
•
-1)->
u
.
numbî
 / sp->u.number;

3652 
•
--;

3653 
•
->
u
.
numbî
 = 
i
;

3654 
	}
}

3658 
	$f_mod
(
num_¨g
)

3660 
i
;

3662 i‡((
•
-1)->
ty≥
 !
T_NUMBER
)

3663 
	`bad_¨g
(1, 
F_MOD
, 
•
-1);

3664 i‡(
•
->
ty≥
 !
T_NUMBER
)

3665 
	`bad_¨g
(2, 
F_MOD
, 
•
);

3666 i‡(
•
->
u
.
numbî
 == 0)

3667 
	`îr‹
("Modulus by zero.\n");

3668 
i
 = (
•
-1)->
u
.
numbî
 % sp->u.number;

3669 
•
--;

3670 
•
->
u
.
numbî
 = 
i
;

3671 
	}
}

3675 
	$f_gt
(
num_¨g
)

3677 
i
;

3679 i‡((
•
-1)->
ty≥
 =
T_STRING
 && sp->type == T_STRING) {

3680 
i
 = 
	`°rcmp
((
•
-1)->
u
.
°rög
, sp->u.string) > 0;

3681 
	`p›_n_ñems
(2);

3682 
	`push_numbî
(
i
);

3685 i‡((
•
-1)->
ty≥
 =
T_FLOAT
 && sp->type == T_FLOAT)

3687 (
•
-1)->
u
.
numbî
 = (•-1)->u.
ªÆ
 > sp->u.real;

3688 
•
--;

3689 
•
->
ty≥
 = 
T_NUMBER
;

3692 i‡((
•
-1)->
ty≥
 !
T_NUMBER
)

3693 
	`bad_¨g
(1, 
F_GT
, 
•
-1);

3694 i‡(
•
->
ty≥
 !
T_NUMBER
)

3695 
	`bad_¨g
(2, 
F_GT
, 
•
);

3696 
i
 = (
•
-1)->
u
.
numbî
 > sp->u.number;

3697 
•
--;

3698 
•
->
u
.
numbî
 = 
i
;

3699 
	}
}

3703 
	$f_ge
(
num_¨g
)

3705 
i
;

3707 i‡((
•
-1)->
ty≥
 =
T_STRING
 && sp->type == T_STRING) {

3708 
i
 = 
	`°rcmp
((
•
-1)->
u
.
°rög
, sp->u.string) >= 0;

3709 
	`p›_n_ñems
(2);

3710 
	`push_numbî
(
i
);

3713 i‡((
•
-1)->
ty≥
 =
T_FLOAT
 && sp->type == T_FLOAT)

3715 (
•
-1)->
u
.
numbî
 = (•-1)->u.
ªÆ
 >= sp->u.real;

3716 
•
--;

3717 
•
->
ty≥
 = 
T_NUMBER
;

3720 i‡((
•
-1)->
ty≥
 !
T_NUMBER
)

3721 
	`bad_¨g
(1, 
F_GE
, 
•
-1);

3722 i‡(
•
->
ty≥
 !
T_NUMBER
)

3723 
	`bad_¨g
(2, 
F_GE
, 
•
);

3724 
i
 = (
•
-1)->
u
.
numbî
 >= sp->u.number;

3725 
•
--;

3726 
•
->
u
.
numbî
 = 
i
;

3727 
	}
}

3731 
	$f_…
(
num_¨g
)

3733 
i
;

3735 i‡((
•
-1)->
ty≥
 =
T_STRING
 && sp->type == T_STRING) {

3736 
i
 = 
	`°rcmp
((
•
-1)->
u
.
°rög
, sp->u.string) < 0;

3737 
	`p›_n_ñems
(2);

3738 
	`push_numbî
(
i
);

3741 i‡((
•
-1)->
ty≥
 =
T_FLOAT
 && sp->type == T_FLOAT)

3743 (
•
-1)->
u
.
numbî
 = (•-1)->u.
ªÆ
 < sp->u.real;

3744 
•
--;

3745 
•
->
ty≥
 = 
T_NUMBER
;

3748 i‡((
•
-1)->
ty≥
 !
T_NUMBER
)

3749 
	`bad_¨g
(1, 
F_LT
, 
•
-1);

3750 i‡(
•
->
ty≥
 !
T_NUMBER
)

3751 
	`bad_¨g
(2, 
F_LT
, 
•
);

3752 
i
 = (
•
-1)->
u
.
numbî
 < sp->u.number;

3753 
•
--;

3754 
•
->
u
.
numbî
 = 
i
;

3755 
	}
}

3759 
	$f_À
(
num_¨g
)

3761 
i
;

3763 i‡((
•
-1)->
ty≥
 =
T_STRING
 && sp->type == T_STRING) {

3764 
i
 = 
	`°rcmp
((
•
-1)->
u
.
°rög
, sp->u.string) <= 0;

3765 
	`p›_n_ñems
(2);

3766 
	`push_numbî
(
i
);

3769 i‡((
•
-1)->
ty≥
 =
T_FLOAT
 && sp->type == T_FLOAT)

3771 (
•
-1)->
u
.
numbî
 = (•-1)->u.
ªÆ
 <= sp->u.real;

3772 
•
--;

3773 
•
->
ty≥
 = 
T_NUMBER
;

3776 i‡((
•
-1)->
ty≥
 !
T_NUMBER
)

3777 
	`bad_¨g
(1, 
F_LE
, 
•
-1);

3778 i‡(
•
->
ty≥
 !
T_NUMBER
)

3779 
	`bad_¨g
(2, 
F_LE
, 
•
);

3780 
i
 = (
•
-1)->
u
.
numbî
 <= sp->u.number;

3781 
	`p›_°ack
();

3782 
•
->
u
.
numbî
 = 
i
;

3783 
	}
}

3787 
	$f_eq
(
num_¨g
)

3789 
i
;

3791 
i
 = 
	`equÆ_svÆue
(
•
-1, sp);

3792 
	`p›_°ack
();

3793 
	`assign_svÆue
(
•
, 
i
 ? &
c⁄°1
 : &
c⁄°0
);

3794 
	}
}

3798 
	$f_√
(
num_¨g
)

3800 
i
;

3802 
i
 = 
	`equÆ_svÆue
(
•
-1, sp);

3803 
	`p›_°ack
();

3804 
	`assign_svÆue
(
•
, 
i
 ? &
c⁄°0
 : &
c⁄°1
);

3805 
	}
}

3809 
	$f_nŸ
(
num_¨g
)

3811 i‡((
•
->
ty≥
 =
T_NUMBER
 && sp->
u
.
numbî
 == 0) ||

3812 (
•
->
ty≥
 =
T_FUNCTION
 && !
	`ÀgÆ_˛osuª
(•->
u
.
func
)) ||

3813 (
•
->
ty≥
 =
T_OBJECT
 && (•->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
)))

3814 
	`assign_svÆue
(
•
, &
c⁄°1
);

3816 
	`assign_svÆue
(
•
, &
c⁄°0
);

3817 
	}
}

3821 
	$f_com∂
(
num_¨g
)

3823 i‡(
•
->
ty≥
 !
T_NUMBER
)

3824 
	`îr‹
("BadárgumentÅo ~\n");

3825 
•
->
u
.
numbî
 = ~ sp->u.number;

3826 
	}
}

3830 
	$f_√g©e
(
num_¨g
)

3832 i‡(
•
->
ty≥
 =
T_FLOAT
)

3834 
•
->
u
.
ªÆ
 = - sp->u.real;

3837 i‡(
•
->
ty≥
 !
T_NUMBER
)

3838 
	`îr‹
("BadárgumentÅo unary minus\n");

3839 
•
->
u
.
numbî
 = - sp->u.number;

3840 
	}
}

3844 
	$f_öc
(
num_¨g
)

3846 i‡(
•
->
ty≥
 !
T_LVALUE
)

3847 
	`îr‹
("BadárgumentÅo ++\n");

3848 i‡(
•
->
u
.
lvÆue
->
ty≥
 !
T_NUMBER
)

3849 
	`îr‹
("++ ofÇon-numericárgument\n");

3850 
•
->
u
.
lvÆue
->u.
numbî
++;

3851 
	`assign_svÆue
(
•
, sp->
u
.
lvÆue
);

3852 
	}
}

3856 
	$f_dec
(
num_¨g
)

3858 i‡(
•
->
ty≥
 !
T_LVALUE
)

3859 
	`îr‹
("BadárgumentÅo --\n");

3860 i‡(
•
->
u
.
lvÆue
->
ty≥
 !
T_NUMBER
)

3861 
	`îr‹
("-- ofÇon-numericárgument\n");

3862 
•
->
u
.
lvÆue
->u.
numbî
--;

3863 
	`assign_svÆue
(
•
, sp->
u
.
lvÆue
);

3864 
	}
}

3868 
	$f_po°_öc
(
num_¨g
)

3870 i‡(
•
->
ty≥
 !
T_LVALUE
)

3871 
	`îr‹
("BadárgumentÅo ++\n");

3872 i‡(
•
->
u
.
lvÆue
->
ty≥
 !
T_NUMBER
)

3873 
	`îr‹
("++ ofÇon-numericárgument\n");

3874 
•
->
u
.
lvÆue
->u.
numbî
++;

3875 
	`assign_svÆue
(
•
, sp->
u
.
lvÆue
);

3876 
•
->
u
.
numbî
--;

3877 
	}
}

3881 
	$f_po°_dec
(
num_¨g
)

3883 i‡(
•
->
ty≥
 !
T_LVALUE
)

3884 
	`îr‹
("BadárgumentÅo --\n");

3885 i‡(
•
->
u
.
lvÆue
->
ty≥
 !
T_NUMBER
)

3886 
	`îr‹
("-- ofÇon-numericárgument\n");

3887 
•
->
u
.
lvÆue
->u.
numbî
--;

3888 
	`assign_svÆue
(
•
, sp->
u
.
lvÆue
);

3889 
•
->
u
.
numbî
++;

3890 
	}
}

3893 
	$f_ˇŒ_Ÿhî
(
num_¨g
)

3895 
obje˘
 *
ob
;

3896 
svÆue
 *
¨g
, *
svp
;

3898 #ifde‡
COUNT_CALLS


3899 
num_ˇŒ_Ÿhî
++;

3901 
¨g
 = 
•
 - 
num_¨g
 + 1;

3902 i‡(
¨g
[0].
ty≥
 =
T_NUMBER
)

3904 i‡(
¨g
[0].
u
.
numbî
 != 0)

3905 
	`îr‹
("Badárgument 1Åo call_other()\n");

3906 
	`p›_n_ñems
(
num_¨g
);

3907 
	`push_numbî
(0);

3910 i‡(
¨g
[0].
ty≥
 =
T_POINTER
)

3912 
ve˘‹
 *
w
, *
v
 = 
	`Æloˇã_¨øy
(
num_¨g
 - 2);

3913 
i
, 
j
;

3915 
i
 = 0; i < 
num_¨g
 - 2; i++)

3916 
	`assign_svÆue_no_‰ì
(&
v
->
ôem
[
i
], &
¨g
[i + 2]);

3917 
	`p›_n_ñems
(
num_¨g
 - 2);

3918 
w
 = 
	`Æloˇã_¨øy
(
¨g
[0].
u
.
vec
->
size
);

3919 
i
 = 0; i < 
¨g
[0].
u
.
vec
->
size
; i++)

3921 i‡(
¨g
[0].
u
.
vec
->
ôem
[
i
].
ty≥
 !
T_OBJECT
 &&

3922 
¨g
[0].
u
.
vec
->
ôem
[
i
].
ty≥
 !
T_STRING
)

3924 i‡(
¨g
[0].
u
.
vec
->
ôem
[
i
].
ty≥
 =
T_OBJECT
)

3925 
ob
 = 
¨g
[0].
u
.
vec
->
ôem
[
i
].u.ob;

3927 
ob
 = 
	`föd_obje˘
(
¨g
[0].
u
.
vec
->
ôem
[
i
].u.
°rög
);

3928 i‡(!
ob
 || (ob->
Êags
 & 
O_DESTRUCTED
))

3930 
j
 = 0; j < 
v
->
size
; j++)

3931 
	`push_svÆue
(&
v
->
ôem
[
j
]);

3932 #ifde‡
TRACE_CODE


3933 i‡(
	`TRACEP
(
TRACE_CALL_OTHER
))

3935 
buff
[1024];

3936 ()
	`•rötf
(
buff
,"%s->%s", 
ob
->
«me
,
¨g
[1].
u
.
°rög
);

3937 
	`do_åa˚
("CÆ»Ÿhî ", 
buff
, "\n");

3940 i‡(
	`≠∂y_low
(
¨g
[1].
u
.
°rög
, 
ob
, 
v
->
size
, 1) == 0)

3942 
w
->
ôem
[
i
] = *
•
--;

3945 
	`p›_n_ñems
(2);

3946 
	`push_ve˘‹
(
w
, 
FALSE
);

3947 
	`‰ì_ve˘‹
(
v
);

3950 i‡(
¨g
[0].
ty≥
 =
T_MAPPING
)

3952 
ve˘‹
 *
w
, *
v
 = 
	`Æloˇã_¨øy
(
num_¨g
 - 2);

3953 
ve˘‹
 *
ix
, *
o
;

3954 
i
, 
j
;

3956 
ix
 = 
	`m≠_domaö
(
¨g
[0].
u
.
m≠
);

3957 
o
 = 
	`m≠_codomaö
(
¨g
[0].
u
.
m≠
);

3958 
i
 = 0; i < 
num_¨g
 - 2; i++)

3959 
	`assign_svÆue_no_‰ì
(&
v
->
ôem
[
i
], &
¨g
[i + 2]);

3960 
	`p›_n_ñems
(
num_¨g
 - 2);

3961 
w
 = 
	`Æloˇã_¨øy
(
o
->
size
);

3962 
i
 = 0; i < 
o
->
size
; i++)

3964 i‡(
o
->
ôem
[
i
].
ty≥
 !
T_OBJECT
 &&

3965 
o
->
ôem
[
i
].
ty≥
 !
T_STRING
)

3967 i‡(
o
->
ôem
[
i
].
ty≥
 =
T_OBJECT
)

3968 
ob
 = 
o
->
ôem
[
i
].
u
.ob;

3970 
ob
 = 
	`föd_obje˘
(
o
->
ôem
[
i
].
u
.
°rög
);

3971 i‡(!
ob
 || (ob->
Êags
 & 
O_DESTRUCTED
))

3973 
j
 = 0; j < 
v
->
size
; j++)

3974 
	`push_svÆue
(&
v
->
ôem
[
j
]);

3975 #ifde‡
TRACE_CODE


3976 i‡(
	`TRACEP
(
TRACE_CALL_OTHER
))

3978 
buff
[1024];

3979 ()
	`•rötf
(
buff
,"%s->%s", 
ob
->
«me
, 
¨g
[1].
u
.
°rög
);

3980 
	`do_åa˚
("CÆ»Ÿhî ", 
buff
, "\n");

3983 i‡(
	`≠∂y_low
(
¨g
[1].
u
.
°rög
, 
ob
, 
v
->
size
, 1) == 0)

3985 
w
->
ôem
[
i
] = *
•
--;

3988 
	`p›_n_ñems
(2);

3989 
	`push_m≠pög
(
	`make_m≠pög
(
ix
,
w
), 
FALSE
);

3990 
	`‰ì_ve˘‹
(
o
);

3991 
	`‰ì_ve˘‹
(
ix
);

3992 
	`‰ì_ve˘‹
(
v
);

3993 
	`‰ì_ve˘‹
(
w
);

3996 i‡(
¨g
[0].
ty≥
 =
T_OBJECT
)

3997 
ob
 = 
¨g
[0].
u
.ob;

4000 
ob
 = 
	`föd_obje˘
(
¨g
[0].
u
.
°rög
);

4001 i‡(
ob
 == 0)

4002 
	`îr‹
("call_other() failed\n");

4004 i‡(
cuºít_obje˘
->
Êags
 & 
O_DESTRUCTED
)

4010 
	`p›_n_ñems
(
num_¨g
);

4011 
	`push_numbî
(0);

4017 #ifde‡
TRACE_CODE


4018 i‡(
	`TRACEP
(
TRACE_CALL_OTHER
))

4020 
buff
[1024];

4021 ()
	`•rötf
(
buff
,"%s->%s", 
ob
->
«me
, 
¨g
[1].
u
.
°rög
);

4022 
	`do_åa˚
("CÆ»Ÿhî ", 
buff
, "\n");

4026 i‡(
	`≠∂y_low
(
¨g
[1].
u
.
°rög
, 
ob
, 
num_¨g
 - 2, 1) == 0)

4029 
	`p›_n_ñems
(2);

4030 
	`push_numbî
(0);

4038 
svp
 = 
•
--;

4039 
	`p›_n_ñems
(2);

4040 *++
•
 = *
svp
;

4041 
	}
}

4045 
	$f_ˇŒ_Ÿhîv
(
xxx
)

4047 
ve˘‹
 *
¨gv
 = 
•
->
u
.
vec
;

4048 
i
;

4049 
num_¨g
;

4051 
	`INCREF
(
¨gv
->
ªf
);

4052 
	`p›_°ack
();

4053 
num_¨g
 = 
¨gv
->
size
 + 2;

4054 
i
 = 0; i < 
¨gv
->
size
; i++)

4056 
	`push_svÆue
(&
¨gv
->
ôem
[
i
]);

4058 
	`‰ì_ve˘‹
(
¨gv
);

4059 
	`f_ˇŒ_Ÿhî
(
num_¨g
);

4060 
	}
}

4064 
	$f_obje˘_time
(
num_¨g
)

4066 
i
;

4068 i‡(
•
->
ty≥
 =
T_OBJECT
)

4070 
i
 = 
•
->
u
.
ob
->
¸óãd
;

4071 
	`p›_°ack
();

4072 
	`push_numbî
(
i
);

4075 
	`assign_svÆue
(
•
, &
c⁄°0
);

4076 
	}
}

4080 
	$f_öç
(
num_¨g
)

4082 
	`assign_svÆue
(
•
, sp->
ty≥
 =
T_NUMBER
 ? &
c⁄°1
 : &
c⁄°0
);

4083 
	}
}

4087 
	$f_°rögp
(
num_¨g
)

4089 
	`assign_svÆue
(
•
, sp->
ty≥
 =
T_STRING
 ? &
c⁄°1
 : &
c⁄°0
);

4090 
	}
}

4094 
	$f_obje˘p
(
num_¨g
)

4096 
	`assign_svÆue
(
•
, sp->
ty≥
 =
T_OBJECT
 ? &
c⁄°1
 : &
c⁄°0
);

4097 
	}
}

4101 
	$f_poöãΩ
(
num_¨g
)

4103 
	`assign_svÆue
(
•
, sp->
ty≥
 =
T_POINTER
 ? &
c⁄°1
 : &
c⁄°0
);

4104 
	}
}

4108 
	$f_m≠pögp
(
num_¨g
)

4110 
	`assign_svÆue
(
•
, sp->
ty≥
 =
T_MAPPING
 ? &
c⁄°1
 : &
c⁄°0
);

4111 
	}
}

4115 
	$f_Êﬂç
(
num_¨g
)

4117 
	`assign_svÆue
(
•
, sp->
ty≥
 =
T_FLOAT
 ? &
c⁄°1
 : &
c⁄°0
);

4118 
	}
}

4122 
	$f_fun˘i⁄_obje˘
(
num_¨g
)

4124 
obje˘
 *
ob
;

4126 
ob
 = 
•
->
u
.
func
->
funobj
;

4127 
	`p›_°ack
();

4128 
	`push_obje˘
(
ob
);

4129 
	}
}

4133 
	$f_fun˘i⁄_«me
(
num_¨g
)

4135 *
p
;

4137 i‡(!
	`ÀgÆ_˛osuª
(
•
->
u
.
func
))

4138 
	`assign_svÆue
(
•
, &
c⁄°0
);

4141 
p
 = 
	`make_m°rög
(
	`show_˛osuª
(
•
->
u
.
func
));

4142 
	`p›_°ack
();

4143 
	`push_m°rög
(
p
);

4145 
	}
}

4149 
	$f_fun˘i⁄p
(
num_¨g
)

4151 
ªt
;

4153 
ªt
 = 0;

4154 i‡(
•
->
ty≥
 =
T_FUNCTION
)

4155 
ªt
 = 
	`ÀgÆ_˛osuª
(
•
->
u
.
func
);

4156 
	`assign_svÆue
(
•
, 
ªt
 ? &
c⁄°1
 : &
c⁄°0
);

4157 
	}
}

4160 
	$f_exåa˘
(
num_¨g
)

4162 
Àn
, 
‰om
, 
to
;

4163 
svÆue
 *
¨g
;

4164 *
ªs
;

4166 
¨g
 = 
•
 - 
num_¨g
 + 1;

4167 
Àn
 = 
	`°æí
(
¨g
[0].
u
.
°rög
);

4168 i‡(
num_¨g
 == 1)

4170 
‰om
 = 
¨g
[1].
u
.
numbî
;

4171 i‡(
‰om
 < 0)

4172 
‰om
 = 
Àn
 + from;

4173 i‡(
‰om
 >
Àn
) {

4174 
	`p›_n_ñems
(
num_¨g
);

4175 
	`push_°rög
("", 
STRING_CSTRING
);

4178 i‡(
num_¨g
 == 2) {

4179 
ªs
 = 
	`make_m°rög
(
¨g
->
u
.
°rög
 + 
‰om
);

4180 
	`p›_n_ñems
(2);

4181 
	`push_m°rög
(
ªs
);

4184 i‡(
¨g
[2].
ty≥
 !
T_NUMBER
)

4185 
	`îr‹
("BadÅhirdárgumentÅoÉxtract()\n");

4186 
to
 = 
¨g
[2].
u
.
numbî
;

4187 i‡(
to
 < 0)

4188 
to
 = 
Àn
 +Åo;

4189 i‡(
to
 < 
‰om
) {

4190 
	`p›_n_ñems
(3);

4191 
	`push_°rög
("", 
STRING_CSTRING
);

4194 i‡(
to
 >
Àn
)

4195 
to
 = 
Àn
-1;

4196 i‡(
to
 =
Àn
-1) {

4197 
ªs
 = 
	`make_m°rög
(
¨g
->
u
.
°rög
 + 
‰om
);

4198 
	`p›_n_ñems
(3);

4199 
	`push_m°rög
(
ªs
);

4202 
ªs
 = 
	`Æloˇã_m°rög
((
size_t
)(
to
 - 
‰om
 + 1));

4203 ()
	`°∫˝y
(
ªs
, 
¨g
[0].
u
.
°rög
 + 
‰om
, (
size_t
)(
to
 - from + 1));

4204 
ªs
[
to
 - 
‰om
 + 1] = '\0';

4205 
	`p›_n_ñems
(3);

4206 
	`push_m°rög
(
ªs
);

4207 
	}
}

4211 
	$f_ønge
(
num_¨g
)

4213 i‡(
•
[-1].
ty≥
 !
T_NUMBER
)

4214 
	`îr‹
("BadÅype of start intervalÅo [ .. ]Ñange.\n");

4215 i‡(
•
[0].
ty≥
 !
T_NUMBER
)

4216 
	`îr‹
("BadÅype ofÉnd intervalÅo [ .. ]Ñange.\n");

4217 i‡(
•
[-2].
ty≥
 =
T_POINTER
) {

4218 
ve˘‹
 *
v
;

4220 
v
 = 
	`¶i˚_¨øy
(
•
[-2].
u
.
vec
, sp[-1].u.
numbî
, sp[0].u.number);

4221 
	`p›_n_ñems
(3);

4222 i‡(
v
) {

4223 
	`push_ve˘‹
(
v
, 
FALSE
);

4225 
	`push_numbî
(0);

4227 } i‡(
•
[-2].
ty≥
 =
T_STRING
) {

4228 
Àn
, 
‰om
, 
to
;

4229 *
ªs
;

4231 
Àn
 = 
	`°æí
(
•
[-2].
u
.
°rög
);

4232 
‰om
 = 
•
[-1].
u
.
numbî
;

4233 i‡(
‰om
 < 0)

4234 
‰om
 = 
Àn
 + from;

4235 i‡(
‰om
 < 0)

4236 
‰om
 = 0;

4237 i‡(
‰om
 >
Àn
) {

4238 
	`p›_n_ñems
(3);

4239 
	`push_°rög
("", 
STRING_CSTRING
);

4242 
to
 = 
•
[0].
u
.
numbî
;

4243 i‡(
to
 < 0)

4244 
to
 = 
Àn
 +Åo;

4245 i‡(
to
 < 
‰om
) {

4246 
	`p›_n_ñems
(3);

4247 
	`push_°rög
("", 
STRING_CSTRING
);

4250 i‡(
to
 >
Àn
)

4251 
to
 = 
Àn
 - 1;

4252 i‡(
to
 =
Àn
 - 1) {

4253 
ªs
 = 
	`make_m°rög
(
•
[-2].
u
.
°rög
 + 
‰om
);

4254 
	`p›_n_ñems
(3);

4255 
	`push_m°rög
(
ªs
);

4258 
ªs
 = 
	`Æloˇã_m°rög
((
size_t
)(
to
 - 
‰om
 + 1));

4259 ()
	`°∫˝y
(
ªs
, 
•
[-2].
u
.
°rög
 + 
‰om
, (
size_t
)(
to
 - from + 1));

4260 
ªs
[
to
 - 
‰om
 + 1] = '\0';

4261 
	`p›_n_ñems
(3);

4262 
	`push_m°rög
(
ªs
);

4266 
	`îr‹
("BadárgumentÅo [ .. ]Ñange operand.\n");

4268 
	}
}

4272 
	$f_quîy_vîb
(
num_¨g
)

4274 i‡(
œ°_vîb
 == 0) {

4275 
	`push_numbî
(0);

4278 
	`push_°rög
(
œ°_vîb
, 
STRING_MSTRING
);

4279 
	}
}

4283 
	$f_quîy_åigvîb
(
num_¨g
)

4285 i‡(
åig_vîb
 == 0) {

4286 
	`push_numbî
(0);

4289 
	`push_°rög
(
åig_vîb
, 
STRING_MSTRING
);

4290 
	}
}

4294 
	$f_exec
(
num_¨g
)

4296 
i
;

4298 i‡((
•
-1)->
ty≥
 =
T_NUMBER
)

4299 
i
 = 
	`ª∂a˚_öãø˘ive
(0, 
•
->
u
.
ob
, 
cuºít_¥og
->
«me
);

4301 
i
 = 
	`ª∂a˚_öãø˘ive
((
•
-1)->
u
.
ob
, sp->u.ob,

4302 
cuºít_¥og
->
«me
);

4303 
	`p›_°ack
();

4304 
	`p›_°ack
();

4305 
	`push_numbî
(
i
);

4306 
	}
}

4310 
	$f_fûe_«me
(
num_¨g
)

4312 *
«me
,*
ªs
;

4315 
«me
 = 
•
->
u
.
ob
->name;

4316 
ªs
 = 
	`add_¶ash
(
«me
);

4317 
	`p›_°ack
();

4318 
	`push_m°rög
(
ªs
);

4319 
	}
}

4323 
	$f_u£rs
(
num_¨g
)

4325 
svÆue
 *
ªt
;

4327 i‡(
cuºít_obje˘
 !
ma°î_ob
)

4329 
	`push_obje˘
(
cuºít_obje˘
);

4330 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_VALID_USERS
, 1);

4331 i‡(
ªt
 && (ªt->
ty≥
 !
T_NUMBER
 ||Ñë->
u
.
numbî
 == 0))

4333 
	`push_numbî
(0);

4337 
	`push_ve˘‹
(
	`u£rs
(), 
FALSE
);

4338 
	}
}

4341 
	$f_£t_Æ¨m
(
num_¨g
)

4343 
svÆue
 *
¨g
 = 
•
 - 
num_¨g
 + 1;

4344 
dñay
, 
ªlﬂd
, 
ªt
;

4345 
˛osuª
 *
f
;

4346 
obje˘
 *
ob
;

4348 i‡(
num_¨g
 =3 && 
¨g
[2].
ty≥
 =
T_FUNCTION
) {

4350 } i‡(
num_¨g
 >3 && 
¨g
[2].
ty≥
 =
T_STRING
) {

4351 
˛osuª
 *
fun
;

4353 i‡(*(
¨g
[2].
u
.
°rög
) == '.') {

4354 
	`p›_n_ñems
(
num_¨g
);

4355 
	`push_numbî
(0);

4360 
fun
 = 
	`Æloc_obj˛osuª°r
(
FUN_LFUNO
, 
¨g
[2].
u
.
°rög
, 
cuºít_obje˘
, "f_set_alarm", 0);

4361 i‡(!
fun
) {

4362 
	`p›_n_ñems
(
num_¨g
);

4363 
	`push_numbî
(0);

4366 
	`‰ì_ve˘‹
(
fun
->
fu«rgs
);

4367 
fun
->
fu«rgs
 = 
	`Æloˇã_¨øy
(
num_¨g
 - 3);

4368 ()
	`mem˝y
(&
fun
->
fu«rgs
->
ôem
[0], &
¨g
[3], (
num_¨g
 - 3Ë* (
svÆue
));

4370 
•
 = &
¨g
[2];

4371 
	`‰ì_svÆue
(&
¨g
[2]);

4372 
¨g
[2].
ty≥
 = 
T_FUNCTION
;

4373 
¨g
[2].
u
.
func
 = 
fun
;

4375 
	`WARNOBSOLETE
(
cuºít_obje˘
, "stringás function in set_alarm");

4377 
	`îr‹
("BadárgumentsÅo set_alarm\n");

4379 
f
 = 
¨g
[2].
u
.
func
;

4380 
ob
 = 
f
->
funobj
;

4381 i‡(
f
->
fu¡y≥
 =
FUN_EFUN
 || !
ob
)

4382 
	`îr‹
("set_alarm can only be called witháÜocal function.");

4384 i‡(!(
ob
->
Êags
 & 
O_DESTRUCTED
)) {

4385 
dñay
 = (Ë(
¨g
[0].
u
.
ªÆ
 * 
TIME_RES
 + 0.5);

4386 
ªlﬂd
 = (Ë(
¨g
[1].
u
.
ªÆ
 * 
TIME_RES
 + 0.5);

4387 
ªt
 = 
	`√w_ˇŒ_out
(
f
, 
dñay
, 
ªlﬂd
);

4389 
ªt
 = 0;

4390 
	`p›_n_ñems
(3);

4391 
	`push_numbî
(
ªt
);

4392 
	}
}

4396 
	$f_£t_Æ¨mv
(
xxx
)

4398 
num_¨g
 = 4;

4399 
svÆue
 *
¨g
 = 
•
 - 
num_¨g
 + 1;

4400 
dñay
, 
ªlﬂd
, 
ªt
;

4401 
˛osuª
 *
f
;

4403 
	`WARNOBSOLETE
(
cuºít_obje˘
, "set_alarmv");

4405 i‡(
¨g
[2].
ty≥
 !
T_STRING
)

4406 
	`îr‹
("Wrongárgument 3Åo set_alarm.\n");

4407 i‡(
¨g
[3].
ty≥
 !
T_POINTER
)

4408 
	`îr‹
("Wrongárgument 4Åo set_alarm.\n");

4410 i‡(*(
¨g
[2].
u
.
°rög
) == '.')

4412 
	`p›_n_ñems
(
num_¨g
);

4413 
	`push_numbî
(0);

4418 
˛osuª
 *
fun
;

4421 
fun
 = 
	`Æloc_obj˛osuª°r
(
FUN_LFUNO
, 
¨g
[2].
u
.
°rög
, 
cuºít_obje˘
, "f_set_alarmv", 0);

4422 i‡(!
fun
) {

4423 
	`p›_n_ñems
(
num_¨g
);

4424 
	`push_numbî
(0);

4427 
	`‰ì_ve˘‹
(
fun
->
fu«rgs
);

4428 
fun
->
fu«rgs
 = 
¨g
[3].
u
.
vec
;

4429 
	`INCREF
(
fun
->
fu«rgs
->
ªf
);

4431 
	`‰ì_svÆue
(&
¨g
[2]);

4432 
¨g
[2].
ty≥
 = 
T_FUNCTION
;

4433 
¨g
[2].
u
.
func
 = 
fun
;

4436 
f
 = 
¨g
[2].
u
.
func
;

4438 i‡(
	`ÀgÆ_˛osuª
(
f
))

4440 
dñay
 = (Ë(
¨g
[0].
u
.
ªÆ
 * 
TIME_RES
 + 0.5);

4441 
ªlﬂd
 = (Ë(
¨g
[1].
u
.
ªÆ
 * 
TIME_RES
 + 0.5);

4442 
ªt
 = 
	`√w_ˇŒ_out
(
f
, 
dñay
, 
ªlﬂd
);

4444 
ªt
 = 0;

4445 
	`p›_n_ñems
(
num_¨g
);

4446 
	`push_numbî
(
ªt
);

4447 
	}
}

4451 
	$f_ªmove_Æ¨m
(
num_¨g
)

4453 
	`dñëe_ˇŒ
(
obje˘
 *, );

4455 
	`dñëe_ˇŒ
(
cuºít_obje˘
, 
•
->
u
.
numbî
);

4456 
	}
}

4460 
	$f_gë_Æl_Æ¨ms
(
num_¨g
)

4462 
ve˘‹
 *
ªt
;

4463 
ve˘‹
 *
	`gë_ˇŒs
(
obje˘
 *);

4464 
ªt
 = 
	`gë_ˇŒs
(
cuºít_obje˘
);

4465 i‡(
ªt
)

4467 
	`push_ve˘‹
(
ªt
, 
FALSE
);

4470 
	`push_numbî
(0);

4471 
	}
}

4475 
	$f_gë_Æ¨m
(
num_¨g
)

4477 
ve˘‹
 *
ªt
;

4478 
ve˘‹
 *
	`gë_ˇŒ
(
obje˘
 *, );

4479 
ªt
 = 
	`gë_ˇŒ
(
cuºít_obje˘
, 
•
->
u
.
numbî
);

4480 
	`p›_°ack
();

4481 i‡(
ªt
)

4483 
	`push_ve˘‹
(
ªt
, 
FALSE
);

4486 
	`push_numbî
(0);

4487 
	}
}

4490 #ifde‡
WORD_WRAP


4493 
	$f_£t_s¸ìn_width
(
num_¨g
)

4495 i‡(! 
cuºít_obje˘
->
öãø˘ive
)

4497 i‡(
•
->
u
.
numbî
 < 0 || sp->u.number == 1)

4498 
	`îr‹
("Nonsensical screen width\n");

4499 
cuºít_obje˘
->
öãø˘ive
->
s¸ìn_width
 = 
•
->
u
.
numbî
;

4500 i‡(
cuºít_obje˘
->
öãø˘ive
->
cuºít_cﬁumn
 >=

4501 
•
->
u
.
numbî
)

4502 
cuºít_obje˘
->
öãø˘ive
->
cuºít_cﬁumn
 = 
•
->
u
.
numbî
 - 1;

4505 
	}
}

4509 
	$f_quîy_s¸ìn_width
(
num_¨g
)

4511 
i
;

4513 
i
 = -1;

4514 i‡(
cuºít_obje˘
->
öãø˘ive
)

4515 
i
 = 
cuºít_obje˘
->
öãø˘ive
->
s¸ìn_width
;

4516 
	`push_numbî
(
i
);

4517 
	}
}

4521 
	$f_•rötf
(
num_¨g
)

4523 *
s
;

4531 
s
 = 
	`°rög_¥öt_f‹m©ãd
(1, (
•
-
num_¨g
+1)->
u
.
°rög
,

4532 
num_¨g
-1, 
•
-num_arg+2);

4533 
	`p›_n_ñems
(
num_¨g
);

4534 i‡(
s
 =
NULL
)

4535 
	`push_numbî
(0);

4537 
	`push_°rög
(
s
, 
STRING_MSTRING
);

4538 
	}
}

4542 
	$f_membî_¨øy
(
num_¨g
)

4544 
ve˘‹
 *
v
;

4545 
i
;

4547 i‡(
•
->
ty≥
 =
T_NUMBER
)

4549 
	`p›_n_ñems
(2);

4550 
	`push_numbî
(-1);

4553 
v
 = 
•
->
u
.
vec
;

4554 
	`check_f‹_de°r
(
•
);

4555 
i
=0; i < 
v
->
size
; i++) {

4556 i‡(
	`equÆ_svÆue
(&
v
->
ôem
[
i
], 
•
 - 1))

4559 i‡(
i
 =
v
->
size
)

4560 
i
 = -1;

4561 
	`p›_n_ñems
(2);

4562 
	`push_numbî
(
i
);

4563 
	}
}

4566 
	$f_move_obje˘
(
num_¨g
)

4568 
obje˘
 *
ob
;

4569 
svÆue
 *
ªt
;

4571 i‡(
•
->
ty≥
 =
T_OBJECT
)

4572 
ob
 = 
•
->
u
.ob;

4574 
ob
 = 
	`föd_obje˘
(
•
->
u
.
°rög
);

4575 
	`push_obje˘
(
cuºít_obje˘
);

4576 
	`push_obje˘
(
ob
);

4577 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_VALID_MOVE
, 2);

4578 i‡(
ªt
 && (ªt->
ty≥
 !
T_NUMBER
 ||Ñë->
u
.
numbî
 == 0))

4580 
	`p›_n_ñems
(
num_¨g
);

4581 
	`push_numbî
(0);

4584 
	`move_obje˘
(
ob
);

4585 
	}
}

4589 
	$f_upd©e_a˘i⁄s
(
num_¨g
)

4591 
	`upd©e_a˘i⁄s
(
cuºít_obje˘
);

4592 
	}
}

4596 
	$f_fun˘i⁄_exi°s
(
num_¨g
)

4598 *
°r
, *
ªs
;

4599 
size_t
 
Àn
;

4601 
°r
 = 
	`fun˘i⁄_exi°s
((
•
-1)->
u
.
°rög
, sp->u.
ob
);

4602 
	`p›_n_ñems
(2);

4603 i‡(
°r
) {

4604 
Àn
 = 
	`°æí
(
°r
);

4605 
ªs
 = 
	`°ºchr
(
°r
, '.');

4606 i‡(
ªs
 !
NULL
)

4607 
Àn
 = 
ªs
 - 
°r
;

4608 
ªs
 = 
	`Æloˇã_m°rög
(
Àn
 + 1);

4609 
ªs
[0] = '/';

4610 ()
	`mem˝y
(&
ªs
[1], 
°r
, 
Àn
);

4611 
ªs
[
Àn
 + 1] = '\0';

4612 
	`push_m°rög
(
ªs
);

4614 
	`push_numbî
(0);

4616 
	}
}

4619 
	$f_¢o›
(
num_¨g
)

4621 
obje˘
 *
ob
;

4627 i‡(!
comm™d_givî
)

4629 
	`p›_n_ñems
(
num_¨g
);

4630 
	`push_numbî
(0);

4634 
ob
 = 0;

4635 
num_¨g
) {

4637 i‡(
	`£t_¢o›
(
•
->
u
.
ob
, 0))

4638 
ob
 = 
•
->
u
.ob;

4641 i‡(
	`£t_¢o›
((
•
-1)->
u
.
ob
, sp->u.ob))

4642 
ob
 = 
•
->
u
.ob;

4645 
ob
 = 0;

4648 
	`p›_n_ñems
(
num_¨g
);

4649 
	`push_obje˘
(
ob
);

4651 
	}
}

4654 
	$f_add_a˘i⁄
(
num_¨g
)

4656 
svÆue
 *
¨g
 = 
•
 - 
num_¨g
 + 1;

4658 i‡(
num_¨g
 == 3) {

4659 i‡(
¨g
[2].
ty≥
 !
T_NUMBER
)

4660 
	`bad_¨g
(3, 
F_ADD_ACTION
, &
¨g
[2]);

4662 i‡(
¨g
[0].
ty≥
 =
T_FUNCTION
) {

4664 } i‡(
¨g
[0].
ty≥
 =
T_STRING
) {

4665 
˛osuª
 *
fun
;

4667 
	`WARNOBSOLETE
(
cuºít_obje˘
, "string function inádd_action");

4669 
fun
 = 
	`Æloc_obj˛osuª°r
(
FUN_LFUNO
, 
¨g
[0].
u
.
°rög
, 
cuºít_obje˘
, "f_add_action", 1);

4670 i‡(!
fun
) {

4671 ()
	`Ârötf
(
°dîr
, "add_action failed: %s(verb=%s) in %s\n",

4672 
¨g
[0].
u
.
°rög
,árg[1].u.°rög, 
cuºít_obje˘
->
«me
);

4673 
	`p›_n_ñems
(
num_¨g
);

4674 
	`push_numbî
(0);

4677 
	`‰ì_svÆue
(&
¨g
[0]);

4678 
¨g
[0].
ty≥
 = 
T_FUNCTION
;

4679 
¨g
[0].
u
.
func
 = 
fun
;

4681 
	`bad_¨g
(1, 
F_ADD_ACTION
, &
¨g
[0]);

4683 
	`add_a˘i⁄
(
¨g
[0].
u
.
func
,

4684 
num_¨g
 > 1 ? &
¨g
[1] : (
svÆue
 *)0,

4685 
num_¨g
 > 2 ? 
¨g
[2].
u
.
numbî
 : 0);

4686 
	`p›_n_ñems
(
num_¨g
 - 1);

4687 
	}
}

4691 
	$f_Æloˇã
(
num_¨g
)

4693 
ve˘‹
 *
v
;

4695 
v
 = 
	`Æloˇã_¨øy
(
•
->
u
.
numbî
);

4696 
	`p›_°ack
();

4697 
	`push_ve˘‹
(
v
, 
FALSE
);

4698 
	}
}

4701 
	$f_ed
(
num_¨g
)

4703 i‡(
num_¨g
 == 0) {

4704 
	`push_numbî
(0);

4705 } i‡(
num_¨g
 == 1) {

4706 
	`ed_°¨t
(
•
->
u
.
°rög
, 0);

4707 } i‡(
num_¨g
 =2 && 
•
->
ty≥
 =
T_FUNCTION
) {

4708 
˛osuª
 *
f
 = 
•
->
u
.
func
;

4709 
	`INCREF
(
f
->
ªf
);

4710 
	`ed_°¨t
((
•
-1)->
u
.
°rög
, 
f
);

4711 
	`p›_°ack
();

4712 } i‡(
num_¨g
 =2 && 
•
->
ty≥
 =
T_STRING
) {

4713 
˛osuª
 *
f
 = 
	`Æloc_obj˛osuª°r
(
FUN_LFUNO
, 
•
->
u
.
°rög
, 
cuºít_obje˘
, "f_ed", 1);

4714 
	`WARNOBSOLETE
(
cuºít_obje˘
, "string function inÉd");

4715 i‡(!
f
) {

4716 
	`p›_n_ñems
(
num_¨g
);

4717 
	`push_numbî
(0);

4720 
	`ed_°¨t
((
•
-1)->
u
.
°rög
, 
f
);

4721 
	`p›_°ack
();

4723 
	`îr‹
("BadárgÅoÉd()\n");

4724 
	}
}

4728 
	$f_¸y±
(
num_¨g
)

4730 
ß…
[2];

4731 *
ªs
;

4732 *
choi£
 =

4735 i‡(
•
->
ty≥
 =
T_STRING
 && 
	`°æí
(•->
u
.
°rög
) >= 2) {

4736 
ß…
[0] = 
•
->
u
.
°rög
[0];

4737 
ß…
[1] = 
•
->
u
.
°rög
[1];

4739 
ß…
[0] = 
choi£
[
	`øndom_numbî
(()
	`°æí
(choise), 0)];

4740 
ß…
[1] = 
choi£
[
	`øndom_numbî
(()
	`°æí
(choise), 0)];

4742 #i‡
	`deföed
(
sun
Ë|| deföed(
SOLARIS
)

4743 
ªs
 = 
	`make_m°rög
(
	`_¸y±
((
•
-1)->
u
.
°rög
, 
ß…
));

4745 
ªs
 = 
	`make_m°rög
(
	`¸y±
((
•
-1)->
u
.
°rög
, 
ß…
));

4747 
	`p›_n_ñems
(2);

4748 
	`push_m°rög
(
ªs
);

4749 
	}
}

4753 
	$f_de°ru˘
(
num_¨g
)

4755 
	`de°ru˘_obje˘
(
cuºít_obje˘
);

4756 
	`push_numbî
(0);

4757 
	}
}

4760 
	$f_øndom
(
num_¨g
)

4762 
£ed
;

4763 
svÆue
 *
¨g
 = 
•
 - 
num_¨g
 + 1;

4765 i‡(
num_¨g
 > 1)

4767 
£ed
 = 
¨g
[1].
u
.
numbî
;

4768 
	`p›_°ack
();

4769 
•
->
u
.
numbî
 = 
	`øndom_numbî
(
¨g
[0].u.numbî, 
£ed
);

4772 
•
->
u
.
numbî
 = 
	`øndom_numbî
(
¨g
[0].u.number, 0);

4773 
	}
}

4777 
	$f_whûe
(
num_¨g
)

4779 
	`Áèl
("F_WHILE shouldÇotáppear.\n");

4780 
	}
}

4784 
	$f_do
(
num_¨g
)

4786 
	`Áèl
("F_DO shouldÇotáppear.\n");

4787 
	}
}

4791 
	$f_f‹
(
num_¨g
)

4793 
	`Áèl
("F_FOR shouldÇotáppear.\n");

4794 
	}
}

4797 
	#ISEMPTY
(
ob
Ë(ob.
ty≥
 =
T_FUNCTION
 && ob.
u
.
func
->
fu¡y≥
 =
FUN_EMPTY
)

	)

4800 
	$∑µly
(
num_¨g
)

4802 
«rgs
, 
i
, 
j
;

4803 
˛osuª
 *
f
, *
ﬁdf
;

4804 
ve˘‹
 *
ôems
;

4805 
svÆue
 *
¨gs
 = 
•
 - 
num_¨g
 + 1;

4806 
√wsize
;

4808 i‡((
•
-
num_¨g
)->
ty≥
 !
T_FUNCTION
)

4809 
	`îr‹
("Bad functionárgumentÅoÖartialápplication '&'.\n");

4811 
ﬁdf
 = (
•
-
num_¨g
)->
u
.
func
;

4812 #ifde‡
FUNCDEBUG


4813 i‡(
ﬁdf
->
magic
 !
FUNMAGIC
 || oldf->
ªf
 == 0 || oldf->ref > 100)

4814 
	`Áèl
("Bad functionárgumentÅoÖapply\n");

4816 
f
 = 
	`Æloc_˛osuª
(
ﬁdf
->
fu¡y≥
);

4817 #ifde‡
DEBUG


4819 ()
	`Ârötf
(
°dîr
, "∑µly=%lx %s\n", 
f
, 
	`show_˛osuª
(
ﬁdf
));

4822 
f
->
funobj
 = 
ﬁdf
->funobj;

4823 
f
->
fu¬o
 = 
ﬁdf
->funno;

4824 
f
->
funöh
 = 
ﬁdf
->funinh;

4825 i‡(
f
->
funobj
)

4826 
	`add_ªf
(
f
->
funobj
, "f_papply");

4828 
«rgs
 = 
ﬁdf
->
fu«rgs
->
size
;

4830 
i
 = 
j
 = 0; i < 
«rgs
; i++) {

4831 i‡(
	`ISEMPTY
(
ﬁdf
->
fu«rgs
->
ôem
[
i
]))

4832 
j
++;

4834 
√wsize
 = 
«rgs
;

4835 i‡(
j
 < 
num_¨g
)

4836 
√wsize
 +
num_¨g
-
j
;

4838 
	`‰ì_ve˘‹
(
f
->
fu«rgs
);

4839 
f
->
fu«rgs
 = 
ôems
 = 
	`Æloˇã_¨øy
(
√wsize
);

4842 
j
 = 
i
 = 0; i < 
«rgs
; i++) {

4843 i‡(
	`ISEMPTY
(
ﬁdf
->
fu«rgs
->
ôem
[
i
]Ë&& 
j
 < 
num_¨g
) {

4844 
	`assign_svÆue_no_‰ì
(&
ôems
->
ôem
[
i
], &
¨gs
[
j
++]);

4846 
	`assign_svÆue_no_‰ì
(&
ôems
->
ôem
[
i
], &
ﬁdf
->
fu«rgs
->item[i]);

4850 ; 
j
 < 
num_¨g
; j++)

4851 
	`assign_svÆue
(&
ôems
->
ôem
[
i
++], &
¨gs
[
j
]);

4852 i‡(
i
 !
√wsize
)

4853 
	`Áèl
("papply\n");

4855 
	`p›_n_ñems
(
num_¨g
+1);

4856 
	`push_fun˘i⁄
(
f
, 
FALSE
);

4857 
	}
}

4861 
	$f_∑µly
(
xxx
)

4863 
num_¨g
;

4865 
num_¨g
 = 
	`EXTRACT_UCHAR
(
pc
);

4866 
pc
++;

4867 
	`∑µly
(
num_¨g
);

4868 
	}
}

4872 
	$f_∑µlyv
(
xxx
)

4874 
num_¨g
 = 2;

4875 
svÆue
 *
¨g
 = 
•
 - 
num_¨g
 + 1;

4876 
ve˘‹
 *
v
;

4877 
i
, 
size
;

4879 i‡(
¨g
[0].
ty≥
 !
T_FUNCTION
)

4880 
	`Áèl
("Non-function in f_papply_array\n");

4881 i‡(
¨g
[1].
ty≥
 !
T_POINTER
)

4882 
	`Áèl
("Non-array in f_papply_array\n");

4883 
v
 = 
¨g
[1].
u
.
vec
;

4884 
	`INCREF
(
v
->
ªf
);

4885 
	`p›_n_ñems
(
num_¨g
-1);

4886 
size
 = 
v
->size;

4887 
i
 = 0; i < 
size
; i++)

4888 
	`push_svÆue
(&
v
->
ôem
[
i
]);

4889 
	`‰ì_ve˘‹
(
v
);

4890 
	`∑µly
(
size
);

4891 
	}
}

4894 
	$gë˛osuª«me
(
˛osuª
 *
f
)

4896 i‡(
f
->
fu¡y≥
 =
FUN_EFUN
)

4897  
	`gë_f_«me
(
f
->
fu¬o
);

4898 i‡(
f
->
fu¡y≥
 =
FUN_COMPOSE
)

4900 i‡(
f
->
fu¡y≥
 =
FUN_EMPTY
)

4903 
obje˘
 *
ob
 = 
f
->
funobj
;

4905 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

4907 #ifde‡
USE_SWAP


4908 
	`ac˚ss_obje˘
(
ob
);

4909 
	`ac˚ss_¥ogøm
(
ob
->
¥og
);

4910 
	`ac˚ss_¥ogøm
(
ob
->
¥og
->
öhîô
[
f
->
funöh
].prog);

4912  
ob
->
¥og
->
öhîô
[
f
->
funöh
].¥og->
fun˘i⁄s
[f->
fu¬o
].
«me
;

4914 
	}
}

4916 
ˇŒ_efun
(, );

4919 
	$wrôe_˛osuª
(
˛osuª
 *
f
, *
buf
, c⁄° *
íd
)

4921 *
«me
;

4922 
i
;

4924 i‡(
f
->
fu¡y≥
 =
FUN_EMPTY
)

4926 i‡(
buf
 < 
íd
)

4927 *
buf
++ = '_';

4928 *
buf
 = '\0';

4929  
buf
;

4931 
«me
 = 
	`gë˛osuª«me
(
f
);

4932 i‡(
f
->
fu¡y≥
 =
FUN_COMPOSE
)

4934 
buf
 = 
	`wrôe_˛osuª
(
f
->
fu«rgs
->
ôem
[1].
u
.
func
, buf, 
íd
);

4935 i‡(
buf
 < 
íd
)

4936 *
buf
++ = ' ';

4937 i‡(
buf
 < 
íd
)

4938 *
buf
++ = '@';

4939 i‡(
buf
 < 
íd
)

4940 *
buf
++ = ' ';

4941 
buf
 = 
	`wrôe_˛osuª
(
f
->
fu«rgs
->
ôem
[0].
u
.
func
, buf, 
íd
);

4942 *
buf
 = '\0';

4943  
buf
;

4945 i‡(
f
->
fu«rgs
 && f->fu«rgs->
size
 && 
buf
 < 
íd
)

4946 *
buf
++ = '&';

4947 i‡(
f
->
funobj
)

4949 i‡(
buf
 + 3 < 
íd
)

4951 ()
	`•rötf
(
buf
, "\"/%.*s\"", ()(
íd
 - buf), 
f
->
funobj
->
«me
);

4952 
buf
 +
	`°æí
(buf);

4954 i‡(
buf
 < 
íd
)

4955 *
buf
++ = '-';

4956 i‡(
buf
 < 
íd
)

4957 *
buf
++ = '>';

4958 i‡(
buf
 < 
íd
)

4960 ()
	`•rötf
(
buf
, "%.*s", ()(
íd
 - buf), 
«me
);

4961 
buf
 +
	`°æí
(buf);

4964 i‡(
buf
 < 
íd
)

4966 ()
	`•rötf
(
buf
, "%.*s", ()(
íd
 - buf), 
«me
);

4967 
buf
 +
	`°æí
(buf);

4969 i‡(
f
->
fu«rgs
 && f->fu«rgs->
size
)

4971 i‡(
buf
 < 
íd
)

4972 *
buf
++ = '(';

4973 
i
 = 0; i < 
f
->
fu«rgs
->
size
; i++)

4975 i‡(
	`ISEMPTY
(
f
->
fu«rgs
->
ôem
[
i
]Ë&& 
buf
 < 
íd
)

4976 *
buf
++ = '_';

4977 i‡(
buf
 < 
íd
)

4978 *
buf
++ = '?';

4979 i‡(
i
 < 
f
->
fu«rgs
->
size
 - 1 && 
buf
 < 
íd
)

4980 *
buf
++ = ',';

4981 i‡(
buf
 >
íd
)

4984 i‡(
buf
 < 
íd
)

4985 *
buf
++ = ')';

4987 *
buf
 = '\0';

4988  
buf
;

4989 
	}
}

4992 
	$show_˛osuª
(
˛osuª
 *
f
)

4994 
buf
[1024];

4996 ()
	`wrôe_˛osuª
(
f
, 
buf
, buf + (buf) - 1);

4997  
buf
;

4998 
	}
}

5001 
	$ˇŒ_v¨
(
num_¨g
, 
˛osuª
 *
f
)

5003 
i
, 
«rg
;

5004 
efun
;

5005 
obje˘
 *
ob
;

5007 
svÆue
 *
ö•
 = 
•
 - 
num_¨g
;

5009 i‡(!
f
)

5010 
	`Áèl
("NULL closure in call_var\n");

5012 #ifde‡
FUNCDEBUG


5013 i‡(
f
->
magic
 !
FUNMAGIC
 || f->
ªf
 == 0 || f->ref > 100)

5014 
	`Áèl
("Bad closure in call_var\n");

5016 
efun
 = -1;

5017 
ob
 = 0;

5018 
f
->
fu¡y≥
)

5020 
FUN_LFUNO
:

5021 
FUN_LFUN
:

5022 
FUN_SFUN
:

5023 
ob
 = 
f
->
funobj
;

5025 
FUN_EFUN
:

5026 
efun
 = 
f
->
fu¬o
;

5028 
FUN_EMPTY
:

5029 
	`îr‹
("Calling EMPTY closure\n");

5031 
FUN_COMPOSE
:

5032  
	`ˇŒ_v¨
(
num_¨g
, 
f
->
fu«rgs
->
ôem
[0].
u
.
func
) &&

5033 
	`ˇŒ_v¨
(1, 
f
->
fu«rgs
->
ôem
[1].
u
.
func
);

5035 
	`Áèl
("badÅype in call_var\n");

5038 #ifde‡
DEBUG


5040 ()
	`Ârötf
(
°dîr
, "loˇ»ˇŒ o‡%lx %s\n", 
f
, 
	`show_˛osuª
(f));

5043 i‡(!
ob
 && 
efun
 == -1) {

5044 
	`îr‹
("ob=0 in call_var\n");

5047 i‡(
ob
 && (ob->
Êags
 & 
O_DESTRUCTED
)) {

5048 
	`îr‹
("CallÅo function in destructed object\n");

5050 
«rg
 = 
f
->
fu«rgs
->
size
;

5051 i‡(
«rg
) {

5052 
svÆue
 *
¨g
;

5053 
em±y¨gs
;

5056 
em±y¨gs
 = 
i
 = 0; i < 
«rg
; i++)

5057 i‡(
	`ISEMPTY
(
f
->
fu«rgs
->
ôem
[
i
]))

5058 
em±y¨gs
++;

5060 i‡(
em±y¨gs
 > 
num_¨g
) {

5061 ()
	`Ârötf
(
°dîr
, "bad callÉmpty=%d,Çum=%d, f=%s\n",

5062 
em±y¨gs
, 
num_¨g
, 
	`show_˛osuª
(
f
));

5063 
	`îr‹
("Too fewárguments supplied in function call\n");

5066 
	`¥obe_°ack
(
«rg
);

5070 
i
 = 0; i < 
num_¨g
; i++)

5071 
•
[-
i
+
«rg
] = sp[-i];

5072 
•
 -
num_¨g
;

5073 
¨g
 = (
•
 + 1Ë+ 
«rg
;

5076 
i
 = 0; i < 
«rg
; i++) {

5077 i‡(
	`ISEMPTY
(
f
->
fu«rgs
->
ôem
[
i
])) {

5078 *++
•
 = *
¨g
++;

5080 
	`push_svÆue
(&
f
->
fu«rgs
->
ôem
[
i
]);

5088 
i
 = 
em±y¨gs
; i < 
num_¨g
; i++)

5089 *++
•
 = *
¨g
++;

5091 
num_¨g
 +
«rg
 - 
em±y¨gs
;

5093 i‡(
ob
) {

5095 #ifde‡
USE_SWAP


5096 
	`ac˚ss_obje˘
(
ob
);

5098 i‡(
f
->
fu¬o
 == 65535)

5099 
	`Áèl
("bad function index\n");

5100 #ifde‡
USE_SWAP


5101 
	`ac˚ss_¥ogøm
(
ob
->
¥og
);

5102 
	`ac˚ss_¥ogøm
(
ob
->
¥og
->
öhîô
[
f
->
funöh
].prog);

5104 
	`ˇŒ_fun˘i⁄
(
ob
, 
f
->
funöh
, ()f->
fu¬o
, 
num_¨g
);

5107 
	`ˇŒ_efun
(
efun
, 
num_¨g
);

5110 i‡(
•
-1 !
ö•
)

5111 ()
	`¥ötf
("Bad s∞ö cÆl_v¨ %d\n", ()(
•
-1-
ö•
));

5113 
	}
}

5117 
	$f_ˇŒ_v¨
(
xxx
)

5119 
num_¨g
;

5120 
˛osuª
 *
f
;

5121 
r
;

5123 
num_¨g
 = 
	`EXTRACT_UCHAR
(
pc
);

5124 
pc
++;

5126 i‡(
•
->
ty≥
 !
T_FUNCTION
)

5127 
	`îr‹
("Bad functionárgument in function call.\n");

5128 
f
 = 
•
->
u
.
func
;

5129 
•
--;

5131 
r
 = 
	`ˇŒ_v¨
(
num_¨g
, 
f
);

5133 
	`‰ì_˛osuª
(
f
);

5134 i‡(!
r
)

5135 
	`îr‹
("Call of function failed\n");

5136 
	}
}

5138 #ifde‡
FUNCDEBUG


5139 
˛osuª
 *
	gÆlfuncs
;

5142 
˛osuª
 *

5143 
	$Æloc_˛osuª
(
·y≥
)

5145 
˛osuª
 *
f
;

5147 
f
 = (
˛osuª
 *)
	`xÆloc
((closure));

5148 
f
->
fu¡y≥
 = 
·y≥
;

5149 
f
->
funobj
 = 0;

5150 
f
->
fu«rgs
 = 
	`Æloˇã_¨øy
(0);

5151 
f
->
fu¬o
 = 65535;

5152 
f
->
ªf
 = 1;

5153 
num_˛osuªs
++;

5154 
tŸÆ_˛osuª_size
 +(
˛osuª
);

5155 #ifde‡
FUNCDEBUG


5156 
f
->
magic
 = 
FUNMAGIC
;

5157 
f
->
‰om
 = 
cuºít_obje˘
;

5158 
f
->
√xt
 = 
Ælfuncs
;

5159 
Ælfuncs
 = 
f
;

5161  
f
;

5162 
	}
}

5165 
	$ÀgÆ_˛osuª
(
˛osuª
 *
fun
)

5167 #ifde‡
FUNCDEBUG


5168 i‡(
fun
->
magic
 !
FUNMAGIC
 || fun->
ªf
 == 0 || fun->ref > 100)

5169 
	`Áèl
("Bad function inÜegal_closure\n");

5171 #ifde‡
DEBUG


5172 
fun
->
fu¡y≥
)

5174 
FUN_LFUN
:

5175 
FUN_SFUN
:

5176 
FUN_EFUN
:

5177 
FUN_LFUNO
:

5178 
FUN_COMPOSE
:

5181 
	`Áèl
("Bad functionÅype inÜegal_closure\n");

5185 i‡(
fun
->
funobj
 && (fun->funobj->
Êags
 & 
O_DESTRUCTED
))

5187 i‡(
fun
->
fu¡y≥
 =
FUN_COMPOSE
)

5188  
	`ÀgÆ_˛osuª
(
fun
->
fu«rgs
->
ôem
[0].
u
.
func
) &&

5189 
	`ÀgÆ_˛osuª
(
fun
->
fu«rgs
->
ôem
[1].
u
.
func
);

5191 
	}
}

5193 
	#FUNCCACHE
 8

	)

5195 
˛osuª
 *
	gfuncˇche
[
FUNCCACHE
];

5197 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


5199 
	$˛ór_˛osuª_ˇche
()

5201 
i
;

5203 
i
 = 0; i < 
FUNCCACHE
; i++)

5204 i‡(
funcˇche
[
i
]) {

5205 
	`‰ì_˛osuª
(
funcˇche
[
i
]);

5206 
funcˇche
[
i
] = 
NULL
;

5208 
	}
}

5211 
˛osuª
 *

5212 
	$Æloc_obj˛osuª
(
·y≥
, 
öh
, 
no
, 
obje˘
 *
ob
, *
ªf°r
, 
u£ˇche
)

5214 
˛osuª
 *
fun
;

5215 
√xt
 = 0;

5217 i‡(
u£ˇche
) {

5221 
i
;

5222 
i
 = 0; i < 
FUNCCACHE
; i++) {

5223 i‡(
funcˇche
[
i
] &&

5224 
·y≥
 =
funcˇche
[
i
]->
fu¡y≥
 &&

5225 
ob
 =
funcˇche
[
i
]->
funobj
 &&

5226 
no
 =
funcˇche
[
i
]->
fu¬o
 &&

5227 
öh
 =
funcˇche
[
i
]->
funöh
) {

5228 
fun
 = 
funcˇche
[
i
];

5229 
	`INCREF
(
fun
->
ªf
);

5230  
fun
;

5235 
fun
 = 
	`Æloc_˛osuª
(
·y≥
);

5237 
fun
->
funobj
 = 
ob
;

5238 i‡(
ob
)

5239 
	`add_ªf
(
fun
->
funobj
, 
ªf°r
);

5240 
fun
->
fu¬o
 = 
no
;

5241 
fun
->
funöh
 = 
öh
;

5244 i‡(
funcˇche
[
√xt
])

5245 
	`‰ì_˛osuª
(
funcˇche
[
√xt
]);

5246 
funcˇche
[
√xt
] = 
fun
;

5247 
	`INCREF
(
fun
->
ªf
);

5248 
√xt
 = (√xt+1Ë% 
FUNCCACHE
;

5250  
fun
;

5251 
	}
}

5253 
˛osuª
 *

5254 
	$Æloc_obj˛osuª°r
(
·y≥
, *
fun°r
, 
obje˘
 *
ob
, *
ªf°r
, 
u£ˇche
)

5256 
funöh
, 
fu¬o
;

5259 #ifde‡
USE_SWAP


5260 
	`ac˚ss_obje˘
(
ob
);

5262 i‡(!(
ob
->
Êags
 & 
O_DESTRUCTED
) &&

5263 
	`£¨ch_f‹_fun˘i⁄
(
fun°r
, 
ob
->
¥og
)) {

5265 i‡–(
cuºít_obje˘
 !
ob
 &&

5266 (
fun˘i⁄_ty≥_mod_found
 & (
TYPE_MOD_STATIC
 | 
TYPE_MOD_PRIVATE
)))

5267 || ((
fun˘i⁄_ty≥_mod_found
 & 
TYPE_MOD_PRIVATE
) &&

5269 
öh_off£t
 < 
fun˘i⁄_öhîô_found
 - ()
fun˘i⁄_¥og_found
->
num_öhîôed
 + 1))

5271 
fu¬o
 = 
fun˘i⁄_ödex_found
;

5272 
funöh
 = 
fun˘i⁄_öhîô_found
;

5276 i‡(
·y≥
 =
FUN_LFUNO
 && 
ob
 =
cuºít_obje˘
)

5277 
·y≥
 = 
FUN_LFUN
;

5278  
	`Æloc_obj˛osuª
(
·y≥
, 
funöh
, 
fu¬o
, 
ob
, 
ªf°r
, 
u£ˇche
);

5279 
	}
}

5283 
	$f_mkfun˘i⁄
(
xxx
)

5285 
num_¨g
 = 2;

5286 
˛osuª
 *
f
;

5287 
svÆue
 *
¨g
 = 
•
 - 
num_¨g
 + 1;

5288 
obje˘
 *
ob
;

5291 i‡(
¨g
[0].
ty≥
 !
T_STRING
 ||árg[1].ty≥ !
T_OBJECT
 || 
num_¨g
 < 2 ||árg[1].
u
.
ob
 == 0)

5292 
	`Áèl
("badárgumentÅo mkfunction\n");

5294 
ob
 = 
¨g
[1].
u
.ob;

5295 
f
 = 
	`Æloc_obj˛osuª°r
(
FUN_LFUNO
, 
¨g
[0].
u
.
°rög
, 
ob
, "f_mkfunction", 1);

5296 i‡(!
f
) {

5297 
	`p›_n_ñems
(
num_¨g
);

5298 
	`push_numbî
(0);

5301 i‡(
ob
 =
cuºít_obje˘
)

5302 
f
->
fu¡y≥
 = 
FUN_LFUN
;

5304 
	`p›_n_ñems
(
num_¨g
);

5305 
	`push_fun˘i⁄
(
f
, 
FALSE
);

5306 
	}
}

5310 
	$f_buûd_˛osuª
(
num_¨g
)

5312 
˛osuª
 *
f
;

5313 
·y≥
;

5314 
obje˘
 *
obj
;

5315 
fu¬o
;

5317 
·y≥
 = 
	`EXTRACT_UCHAR
(
pc
);

5318 
pc
++;

5320 i‡(
·y≥
 =
FUN_EMPTY
) {

5321 
	`¥obe_°ack
(1);

5322 *++
•
 = 
c⁄°em±y
;

5326 
·y≥
) {

5327 
FUN_LFUN
:

5328 
pc
++;

5329 ((*)&
fu¬o
)[0] = 
pc
[0];

5330 ((*)&
fu¬o
)[1] = 
pc
[1];

5331 
pc
 += 2;

5333 
f
 = 
	`Æloc_obj˛osuª°r
(
·y≥
, 
•
->
u
.
°rög
, 
cuºít_obje˘
, "f_build_closure", 1);

5334 
	`p›_°ack
();

5336 
FUN_SFUN
:

5337 i‡(
•
->
ty≥
 !
T_STRING
)

5338 
	`Áèl
("Notá string in f_build_sclosure\n");

5339 i‡(!
simul_efun_ob
)

5340 
	`îr‹
("No simul_efun object");

5341 
f
 = 
	`Æloc_obj˛osuª°r
(
·y≥
, 
•
->
u
.
°rög
, 
simul_efun_ob
, "f_build_closure", 1);

5342 
	`p›_°ack
();

5344 
FUN_EFUN
:

5345 ((*)&
fu¬o
)[0] = 
pc
[0];

5346 ((*)&
fu¬o
)[1] = 
pc
[1];

5347 
pc
 += 2;

5348 
f
 = 
	`Æloc_obj˛osuª
(
·y≥
, 0, 
fu¬o
, 0, "f_build_closure", 0);

5350 
FUN_LFUNO
:

5351 i‡(
•
->
ty≥
 !
T_STRING
)

5352 
	`Áèl
("Notá string in f_build_closure\n");

5353 i‡(
•
[-1].
ty≥
 =
T_OBJECT
) {

5354 
obj
 = 
•
[-1].
u
.
ob
;

5355 } i‡(
•
[-1].
ty≥
 =
T_STRING
) {

5356 
obj
 = 
	`föd_obje˘
(
•
[-1].
u
.
°rög
);

5357 i‡(
obj
 == 0)

5358 
	`îr‹
("Bad object in &\"ob\"->fun\n");

5360 
	`add_ªf
(
obj
, "build_closure string");

5362 
obj
 = 0;

5363 
	`îr‹
("Bad objectÅype in &ob->fun\n");

5366 
f
 = 
	`Æloc_obj˛osuª°r
(
·y≥
, 
•
->
u
.
°rög
, 
obj
, "f_build_closure", 0);

5367 
	`p›_°ack
();

5368 
	`p›_°ack
();

5370 
FUN_COMPOSE
:

5371 i‡((
•
-1)->
ty≥
 !
T_FUNCTION
)

5372 
	`îr‹
("Badárgument 1Åo '@'\n");

5373 i‡(
•
->
ty≥
 !
T_FUNCTION
)

5374 
	`îr‹
("Badárgument 2Åo '@'\n");

5375 
f
 = 
	`Æloc_˛osuª
(
·y≥
);

5376 
	`‰ì_ve˘‹
(
f
->
fu«rgs
);

5377 
f
->
fu«rgs
 = 
	`Æloˇã_¨øy
(2);

5378 
	`assign_svÆue_no_‰ì
(&
f
->
fu«rgs
->
ôem
[0], 
•
);

5379 
	`assign_svÆue_no_‰ì
(&
f
->
fu«rgs
->
ôem
[1], 
•
-1);

5380 
	`p›_°ack
();

5381 
	`p›_°ack
();

5384 
	`Áèl
("BadÅype in build_closure\n");

5385 
f
 = 0;

5389 i‡(
f
) {

5390 
	`push_fun˘i⁄
(
f
, 
FALSE
);

5392 
	`push_numbî
(0);

5394 
	}
}

5397 
	$‰ì_˛osuª
(
˛osuª
 *
f
)

5399 i‡(
f
->
fu¡y≥
 =
FUN_EMPTY
)

5401 i‡(!
f
->
ªf
 || --f->ref > 0)

5404 #ifde‡
FUNCDEBUG


5406 
˛osuª
 **
p
;

5407 
p
 = &
Ælfuncs
; *∞&& *∞!
f
;Ö = &(*p)->
√xt
)

5409 i‡(!*
p
)

5410 
	`Áèl
("ClosureÖointer NULL\n");

5411 *
p
 = (*p)->
√xt
;

5414 
	`‰ì_ve˘‹
(
f
->
fu«rgs
);

5415 i‡(
f
->
funobj
)

5416 
	`‰ì_obje˘
(
f
->
funobj
, "free_closure");

5417 
num_˛osuªs
--;

5418 
tŸÆ_˛osuª_size
 -(
˛osuª
);

5419 
	`‰ì
((*)
f
);

5420 
	}
}

5422 #ifde‡
FUNCDEBUG


5424 
	$dumpfuncs
()

5426 
˛osuª
 *
f
;

5428 ()
	`Ârötf
(
°dîr
, "\nFunction dump:\n");

5429 
f
 = 
Ælfuncs
; f; f = f->
√xt
) {

5430 i‡(
f
->
funobj
 && (f->funobj->
Êags
 & 
O_DESTRUCTED
))

5431 ()
	`Ârötf
(
°dîr
, "***DEST ");

5432 ()
	`Ârötf
(
°dîr
, "%lx:Ñef=%d %s", ()
f
, f->
ªf
, 
	`show_˛osuª
(f));

5433 i‡(
f
->
‰om
 !f->
funobj
)

5434 ()
	`Ârötf
(
°dîr
, " from %s", 
f
->
‰om
->
«me
);

5435 ()
	`Ârötf
(
°dîr
, "\n");

5437 
	}
}

5442 
	$ªad_sh‹t
(*
addr
)

5444 
ªt
;

5446 ((*)&
ªt
)[0] = ((*)
addr
)[0];

5447 ((*)&
ªt
)[1] = ((*)
addr
)[1];

5449  
ªt
;

5450 
	}
}

5451 
	$ªad_öt
(*
addr
)

5453 
ªt
;

5455 ((*)&
ªt
)[0] = ((*)
addr
)[0];

5456 ((*)&
ªt
)[1] = ((*)
addr
)[1];

5457 ((*)&
ªt
)[2] = ((*)
addr
)[2];

5458 ((*)&
ªt
)[3] = ((*)
addr
)[3];

5460  
ªt
;

5461 
	}
}

5464 
	$cmp_vÆues
(
vÆ
, 
cmp
, 
how
)

5466 i‡(
how
)

5467  
	`°rcmp
((*)
vÆ
, 
cuºít_¥og
->
rod©a
 + ()
cmp
);

5469  ()(
vÆ
 - 
cmp
);

5470 
	}
}

5472 
	sˇ£_íåy


5474 
	mvÆue
;

5475 
	moff£t
;

5480 
	$f_swôch
(
num_¨g
)

5482 
	#TABLE_OFF
 1

	)

5483 
	#TABLE_END_OFF
 3

	)

5484 
	#DEFAULT_OFF
 5

	)

5486 
	#STR_TABLE
 1

	)

5488 
	#E_VALUE
 0

	)

5489 
	#E_OFFSET
 4

	)

5490 
	#ENTRY_SIZE
 6

	)

5492 
	#RANGE_OFFSET
 (()-1)

	)

5494 
èb_hód
, 
èb_èû
, 
èb_mid
;

5495 
èb_°¨t
, 
èb_íd
;

5496 
£¨ch_vÆ
 = 0;

5497 
èb_ty≥
, 
is_°r
;

5499 
èb_ty≥
 = (*
pc
) & 0xff;

5500 
is_°r
 = 
èb_ty≥
 & 
STR_TABLE
;

5502 
èb_°¨t
 = 
	`ªad_sh‹t
(
pc
 + 
TABLE_OFF
);

5503 
èb_íd
 = 
	`ªad_sh‹t
(
pc
 + 
TABLE_END_OFF
);

5505 
èb_hód
 = 0;

5506 
èb_èû
 = (
èb_íd
 - 
èb_°¨t
Ë/ 
ENTRY_SIZE
 - 1;

5507 i‡(
is_°r
)

5511 i‡(
•
->
ty≥
 =
T_NUMBER
 && !•->
u
.
numbî
)

5513 
pc
 = 
cuºít_¥og
->
¥ogøm
 + 
	`ªad_sh‹t
(cuºít_¥og->¥ogøm + 
èb_°¨t
 + 
E_OFFSET
);

5514 
	`p›_°ack
();

5517 i‡(
•
->
ty≥
 !
T_STRING
)

5518 
	`bad_¨g
(1, 
F_SWITCH
, 
•
);

5519 
£¨ch_vÆ
 = (Ë
•
->
u
.
°rög
;

5520 
èb_hód
++;

5522 i‡(
•
->
ty≥
 =
T_NUMBER
)

5523 
£¨ch_vÆ
 = 
•
->
u
.
numbî
;

5525 
	`bad_¨g
(1, 
F_SWITCH
, 
•
);

5527 
èb_hód
 <
èb_èû
)

5529 
èb_mid
 = (
èb_hód
 + 
èb_èû
) / 2;

5531 i‡(
	`ªad_sh‹t
(
cuºít_¥og
->
¥ogøm
 + 
èb_°¨t
 +

5532 
èb_mid
 * 
ENTRY_SIZE
 + 
E_OFFSET
Ë=
RANGE_OFFSET
 ||

5533 (
èb_mid
 !
èb_hód
 &&

5534 
	`ªad_sh‹t
(
cuºít_¥og
->
¥ogøm
 + 
èb_°¨t
 +

5535 
èb_mid
 * 
ENTRY_SIZE
 + 
E_OFFSET
 - ENTRY_SIZEË=
RANGE_OFFSET
 &&

5536 (
èb_mid
--, 1)))

5539 
lo_vÆue
, 
hi_vÆue
;

5541 
lo_vÆue
 = 
	`ªad_öt
(
cuºít_¥og
->
¥ogøm
 + 
èb_°¨t
 +

5542 
èb_mid
 * 
ENTRY_SIZE
 + 
E_VALUE
);

5543 
hi_vÆue
 = 
	`ªad_öt
(
cuºít_¥og
->
¥ogøm
 + 
èb_°¨t
 +

5544 
èb_mid
 * 
ENTRY_SIZE
 + 
E_VALUE
 + ENTRY_SIZE);

5545 i‡(
	`cmp_vÆues
(
£¨ch_vÆ
, 
lo_vÆue
, 
is_°r
) < 0)

5546 
èb_èû
 = 
èb_mid
 - 1;

5547 i‡(
	`cmp_vÆues
(
£¨ch_vÆ
, 
hi_vÆue
, 
is_°r
) > 0)

5548 
èb_hód
 = 
èb_mid
 + 2;

5551 
pc
 = 
cuºít_¥og
->
¥ogøm
 +

5552 
	`ªad_sh‹t
(
cuºít_¥og
->
¥ogøm
 + 
èb_°¨t
 +

5553 
èb_mid
 * 
ENTRY_SIZE
 + 
E_OFFSET
 + ENTRY_SIZE);

5554 
	`p›_°ack
();

5561 
vÆue
;

5562 
cmp
;

5564 
vÆue
 = 
	`ªad_öt
(
cuºít_¥og
->
¥ogøm
 + 
èb_°¨t
 +

5565 
èb_mid
 * 
ENTRY_SIZE
 + 
E_VALUE
);

5566 i‡((
cmp
 = 
	`cmp_vÆues
(
£¨ch_vÆ
, 
vÆue
, 
is_°r
)) == 0)

5568 
pc
 = 
cuºít_¥og
->
¥ogøm
 +

5569 
	`ªad_sh‹t
(
cuºít_¥og
->
¥ogøm
 + 
èb_°¨t
 +

5570 
èb_mid
 * 
ENTRY_SIZE
 + 
E_OFFSET
);

5571 
	`p›_°ack
();

5574 i‡(
cmp
 < 0)

5575 
èb_èû
 = 
èb_mid
 - 1;

5577 
èb_hód
 = 
èb_mid
 + 1;

5581 
pc
 = 
cuºít_¥og
->
¥ogøm
 + 
	`ªad_sh‹t
’¯+ 
DEFAULT_OFF
);

5582 
	`p›_°ack
();

5584 
	}
}

5588 
	$f_bªak
(
xxx
)

5590 
	`îr‹
("Bad break code,Åhis shouldÇot happend.\n");

5591 
	}
}

5595 
	$f_subs¸ùt
(
xxx
)

5597 
	`Áèl
("F_SUBSCRIPT shouldÇotáppear.\n");

5598 
	}
}

5602 
	$f_°æí
(
xxx
)

5604 
i
;

5606 i‡(
•
->
ty≥
 =
T_NUMBER
)

5607 
i
 = 0;

5609 
i
 = 
	`°æí
(
•
->
u
.
°rög
);

5610 
	`p›_°ack
();

5611 
	`push_numbî
(
i
);

5612 
	}
}

5616 
	$f_mkm≠pög
(
num_¨g
)

5618 
m≠pög
 *
mm
 = 0;

5620 i‡((
•
-1)->
ty≥
 =
T_POINTER
 && sp->type == T_POINTER)

5621 
mm
 = 
	`make_m≠pög
((
•
-1)->
u
.
vec
, sp->u.vec);

5622 i‡((
•
-1)->
ty≥
 =
T_NUMBER
 && sp->ty≥ =
T_POINTER
)

5623 
mm
 = 
	`make_m≠pög
(
NULL
, 
•
->
u
.
vec
);

5624 i‡((
•
-1)->
ty≥
 =
T_POINTER
 && sp->ty≥ =
T_NUMBER
)

5625 
mm
 = 
	`make_m≠pög
((
•
-1)->
u
.
vec
, 
NULL
);

5626 i‡((
•
-1)->
ty≥
 =
T_NUMBER
 && sp->type == T_NUMBER)

5628 
	`îr‹
("Oneárgument must beáÖointer.\n");

5631 
	`p›_n_ñems
(2);

5632 
	`push_m≠pög
(
mm
, 
FALSE
);

5633 
	}
}

5637 
	$f_m_sizeof
(
num_¨g
)

5639 
i
;

5641 i‡(
•
->
ty≥
 =
T_MAPPING
)

5642 
i
 = 
	`ˇrd_m≠pög
(
•
->
u
.
m≠
);

5644 
i
 = 0;

5645 
	`p›_°ack
();

5646 
	`push_numbî
(
i
);

5647 
	}
}

5651 
	$f_m_ödexes
(
num_¨g
)

5653 
ve˘‹
 *
v
;

5655 i‡(
•
->
ty≥
 =
T_MAPPING
)

5657 
v
 = 
	`m≠_domaö
(
•
->
u
.
m≠
);

5658 
	`p›_°ack
();

5659 
	`push_ve˘‹
(
v
, 
FALSE
);

5663 
	`p›_°ack
();

5664 
	`push_numbî
(0);

5666 
	}
}

5670 
	$f_m_vÆues
(
num_¨g
)

5672 
ve˘‹
 *
v
;

5674 i‡(
•
->
ty≥
 =
T_MAPPING
)

5676 
v
 = 
	`m≠_codomaö
(
•
->
u
.
m≠
);

5677 
	`p›_°ack
();

5678 
	`push_ve˘‹
(
v
, 
FALSE
);

5682 
	`p›_°ack
();

5683 
	`push_numbî
(0);

5685 
	}
}

5689 
	$f_m_dñëe
(
num_¨g
)

5691 
m≠pög
 *
m
;

5693 i‡((
•
-1)->
ty≥
 =
T_MAPPING
)

5695 
m
 = 
	`ªmove_m≠pög
((
•
-1)->
u
.
m≠
, sp);

5696 
	`p›_n_ñems
(2);

5697 
	`push_m≠pög
(
m
, 
FALSE
);

5701 
	`p›_n_ñems
(2);

5702 
	`push_numbî
(0);

5704 
	}
}

5708 
	$f_sizeof
(
num_¨g
)

5710 
i
;

5712 i‡(
•
->
ty≥
 =
T_NUMBER
)

5713 
i
 = 0;

5715 
i
 = 
•
->
u
.
vec
->
size
;

5716 
	`p›_°ack
();

5717 
	`push_numbî
(
i
);

5718 
	}
}

5722 
	$f_lowî_ˇ£
(
num_¨g
)

5724 *
°r
;

5725 
i
;

5727 i‡(
•
->
ty≥
 =
T_NUMBER
)

5729 
°r
 = 
	`make_m°rög
(
•
->
u
.
°rög
);

5730 
i
 = 
	`°æí
(
°r
)-1; i>=0; i--)

5731 i‡(
	`ißÕha
(
°r
[
i
]))

5732 
°r
[
i
] |= 'a' - 'A';

5733 
	`p›_°ack
();

5734 
	`push_m°rög
(
°r
);

5735 
	}
}

5739 
	$f_uµî_ˇ£
(
num_¨g
)

5741 *
°r
;

5742 
i
;

5744 i‡(
•
->
ty≥
 =
T_NUMBER
)

5746 
°r
 = 
	`make_m°rög
(
•
->
u
.
°rög
);

5747 
i
 = 
	`°æí
(
°r
)-1; i>=0; i--)

5748 i‡(
	`ißÕha
(
°r
[
i
]))

5749 
°r
[
i
] &= ~('a' - 'A');

5750 
	`p›_°ack
();

5751 
	`push_m°rög
(
°r
);

5752 
	}
}

5754 
	#ISPRINT
(
c
Ë(
	`i•röt
(cË|| (cË>0xa0)

	)

5758 
	$f_ªadabÀ_°rög
(
num_¨g
)

5760 *
°r
;

5761 
i
, 
c
;

5763 i‡(
•
->
ty≥
 =
T_NUMBER
)

5765 
°r
 = 
	`make_m°rög
(
•
->
u
.
°rög
);

5766 
i
 = 
	`°æí
(
°r
)-1; i>=0; i--) {

5767 
c
 = 
°r
[
i
] & 0xff;

5768 i‡(
c
 < ' ' || !
	`ISPRINT
(c) )

5769 
°r
[
i
] = '.';

5771 
	`p›_°ack
();

5772 
	`push_m°rög
(
°r
);

5773 
	}
}

5777 
	$f_ˇpôÆize
(
num_¨g
)

5779 i‡(
•
->
ty≥
 =
T_NUMBER
)

5781 i‡(
	`i¶owî
(
•
->
u
.
°rög
[0])) {

5782 *
°r
;

5784 
°r
 = 
	`make_m°rög
(
•
->
u
.
°rög
);

5785 
°r
[0] += 'A' - 'a';

5786 
	`p›_°ack
();

5787 
	`push_m°rög
(
°r
);

5789 
	}
}

5793 
	$f_¥o˚ss_°rög
(
num_¨g
)

5795 *
	`¥o˚ss_°rög
 (*, );

5796 *
°r
;

5798 
°r
 = 
	`¥o˚ss_°rög
(
•
[-1].
u
.
°rög
, sp->u.
numbî
);

5799 
	`p›_°ack
();

5800 i‡(
°r
 !
•
->
u
.
°rög
)

5802 
	`p›_°ack
();

5803 
	`push_m°rög
(
	`make_m°rög
(
°r
));

5804 
	`‰ì
(
°r
);

5806 
	}
}

5810 
	$f_¥o˚ss_vÆue
(
num_¨g
)

5812 
svÆue
 *
	`¥o˚ss_vÆue
 (*, );

5813 
svÆue
 *
ªt
;

5815 
ªt
 = 
	`¥o˚ss_vÆue
(
•
[-1].
u
.
°rög
, sp->u.
numbî
);

5816 
	`p›_°ack
();

5817 
	`p›_°ack
();

5818 i‡(
ªt
)

5820 
	`push_svÆue
(
ªt
);

5823 
	`push_numbî
(0);

5824 
	}
}

5828 
	$f_comm™d
(
num_¨g
)

5830 
i
;

5832 
i
 = 
	`comm™d_f‹_obje˘
(
•
->
u
.
°rög
, 0);

5833 
	`p›_°ack
();

5834 
	`push_numbî
(
i
);

5835 
	}
}

5839 
	$f_gë_dú
(
num_¨g
)

5841 
ve˘‹
 *
v
 = 
	`gë_dú
(
•
->
u
.
°rög
);

5843 
	`p›_°ack
();

5844 i‡(
v
) {

5845 
	`push_ve˘‹
(
v
, 
FALSE
);

5847 
	`push_numbî
(0);

5848 
	}
}

5852 
	$f_rm
(
num_¨g
)

5854 
i
;

5856 
i
 = 
	`ªmove_fûe
(
•
->
u
.
°rög
);

5857 
	`p›_°ack
();

5858 
	`push_numbî
(
i
);

5859 
	}
}

5863 
	$f_mkdú
(
num_¨g
)

5865 *
∑th
;

5867 
∑th
 = 
	`check_vÆid_∑th
(
•
->
u
.
°rög
, 
cuºít_obje˘
, "mkdir", 1);

5869 i‡(
∑th
 =0 || 
	`mkdú
(path, 0774) == -1)

5870 
	`assign_svÆue
(
•
, &
c⁄°0
);

5872 
	`assign_svÆue
(
•
, &
c⁄°1
);

5873 
	}
}

5877 
	$f_rmdú
(
num_¨g
)

5879 *
∑th
;

5881 
∑th
 = 
	`check_vÆid_∑th
(
•
->
u
.
°rög
, 
cuºít_obje˘
, "rmdir", 1);

5883 i‡(
∑th
 =0 || 
	`rmdú
(path) == -1)

5884 
	`assign_svÆue
(
•
, &
c⁄°0
);

5886 
	`assign_svÆue
(
•
, &
c⁄°1
);

5887 
	}
}

5890 
	$f_öput_to
(
num_¨g
)

5892 
svÆue
 *
¨g
 = 
•
 - 
num_¨g
 + 1;

5893 
ve˘‹
 *
v
;

5894 
r
;

5895 
Êag
 = 1;

5897 i‡(
¨g
[0].
ty≥
 =
T_FUNCTION
) {

5898 i‡(
num_¨g
 > 2)

5899 
	`îr‹
("Bad # ofárgsÅo input_to()\n");

5900 } i‡(
¨g
[0].
ty≥
 =
T_STRING
) {

5901 
˛osuª
 *
fun
;

5902 
i
, 
size
;

5904 
fun
 = 
	`Æloc_obj˛osuª°r
(
FUN_LFUNO
, 
¨g
[0].
u
.
°rög
, 
cuºít_obje˘
, "f_input_to", 0);

5905 i‡(!
fun
) {

5906 
	`p›_n_ñems
(
num_¨g
);

5907 
	`push_numbî
(0);

5911 
size
 = 
num_¨g
 > 2 ?Çum_arg - 2 : 0;

5912 i‡(
size
 > 0) {

5913 
v
 = 
	`Æloˇã_¨øy
(
size
+1);

5914 
v
->
ôem
[0] = 
c⁄°em±y
;

5915 
i
 = 2; i < 
num_¨g
; i++)

5916 
	`assign_svÆue_no_‰ì
(&
v
->
ôem
[
i
 - 1], &
¨g
[i]);

5917 
	`‰ì_ve˘‹
(
fun
->
fu«rgs
);

5918 
fun
->
fu«rgs
 = 
v
;

5921 
	`‰ì_svÆue
(&
¨g
[0]);

5922 
¨g
[0].
ty≥
 = 
T_FUNCTION
;

5923 
¨g
[0].
u
.
func
 = 
fun
;

5925 
	`WARNOBSOLETE
(
cuºít_obje˘
, "stringás function in input_to");

5927 
	`îr‹
("BadárgÅo input_to()\n");

5929 i‡(
num_¨g
 =1 || (
¨g
[1].
ty≥
 =
T_NUMBER
 &&árg[1].
u
.
numbî
 == 0))

5930 
Êag
 = 0;

5931 
r
 = 
	`öput_to
(
¨g
[0].
u
.
func
, 
Êag
);

5932 
	`p›_n_ñems
(
num_¨g
);

5933 
	`push_numbî
(
r
);

5934 
	}
}

5938 
	$f_£t_livög_«me
(
num_¨g
)

5940 
	`£t_livög_«me
(
cuºít_obje˘
, 
•
->
u
.
°rög
);

5941 
	}
}

5944 
	$f_∑r£_comm™d
(
num_¨g
)

5946 
svÆue
 *
¨g
;

5947 
i
;

5949 
num_¨g
 = 
	`EXTRACT_UCHAR
(
pc
);

5950 
pc
++;

5951 
¨g
 = 
•
 - 
num_¨g
 + 1;

5952 i‡(
¨g
[0].
ty≥
 !
T_STRING
)

5953 
	`bad_¨g
(1, 
F_PARSE_COMMAND
, &
¨g
[0]);

5954 i‡(
¨g
[1].
ty≥
 !
T_OBJECT
 &&árg[1].ty≥ !
T_POINTER
)

5955 
	`bad_¨g
(2, 
F_PARSE_COMMAND
, &
¨g
[1]);

5956 i‡(
¨g
[2].
ty≥
 !
T_STRING
)

5957 
	`bad_¨g
(3, 
F_PARSE_COMMAND
, &
¨g
[2]);

5958 i‡(
¨g
[1].
ty≥
 =
T_POINTER
)

5959 
	`check_f‹_de°r
(&
¨g
[1]);

5961 
i
 = 
	`∑r£
(
¨g
[0].
u
.
°rög
, &arg[1],árg[2].u.string, &arg[3],

5962 
num_¨g
-3);

5963 
	`p›_n_ñems
(
num_¨g
);

5964 
	`push_numbî
(
i
);

5965 
	}
}

5968 
	#MIA
 0

	)

5969 
	#DOP
 1

	)

5970 
	#CEL
 2

	)

5971 
	#BIE
 3

	)

5972 
	#NAR
 4

	)

5973 
	#MIE
 5

	)

5977 
	#R_M_OS
 0

	)

5978 
	#R_M_NOS_ZYW
 1

	)

5979 
	#R_M_NOS_NZYW
 2

	)

5980 
	#R_M_NZYW
 2

	)

5982 
	#R_Z
 3

	)

5984 
	#R_N_OS
 4

	)

5985 
	#R_N_NOS
 5

	)

5988 
	$oblicz_¥zym
(*
adj1
, *
adj2
, 
¥zyp
, 
rodzaj
, 
liczba
)

5990 
ãm©_l
;

5991 
k⁄c
[5], *
ªt
;

5993 
ãm©_l
 = 
	`°æí
(
adj1
) - 1;

5994 i‡(
ãm©_l
 > 25)

5996 
adj1
[25] = '\0';

5997 
ãm©_l
 = 25;

6000 
ªt
 = (*)
	`xÆloc
(30);

6002 i‡(
ãm©_l
 <= 0)

6005 *
ªt
 = '\0';

6006 *
k⁄c
 = '\0';

6008 i‡(
adj1
[
ãm©_l
] == 'y')

6010 i‡(!
liczba
)

6012 
rodzaj
)

6014 
R_M_OS
:

6015 
R_M_NOS_ZYW
:

6016 i‡(
¥zyp
 =
BIE
)

6018 
	`°r˝y
(
k⁄c
, "ego");

6021 
R_M_NOS_NZYW
:

6022 
¥zyp
)

6024 
MIA
:

6025 
BIE
: 
	`°r˝y
(
k⁄c
, "y"); ;

6026 
DOP
: 
	`°r˝y
(
k⁄c
, "ego"); ;

6027 
CEL
: 
	`°r˝y
(
k⁄c
, "emu"); ;

6028 
NAR
:

6029 
MIE
: 
	`°r˝y
(
k⁄c
, "ym"); ;

6032 
R_Z
:

6033 
¥zyp
)

6035 
MIA
:

6036 
BIE
:

6037 
NAR
: 
	`°r˝y
(
k⁄c
, "a"); ;

6038 : 
	`°r˝y
(
k⁄c
, "ej"); ;

6042 
R_N_OS
:

6043 
R_N_NOS
:

6044 
¥zyp
)

6046 
MIA
:

6047 
BIE
: 
	`°r˝y
(
k⁄c
, "e"); ;

6048 
DOP
: 
	`°r˝y
(
k⁄c
, "ego"); ;

6049 
CEL
: 
	`°r˝y
(
k⁄c
, "emu"); ;

6050 : 
	`°r˝y
(
k⁄c
, "ym"); ;

6057 
rodzaj
)

6059 
R_M_OS
:

6060 
¥zyp
)

6062 
MIA
: 
	`°r˝y
(
ªt
, 
adj2
);

6063  
ªt
;

6064 
DOP
:

6065 
BIE
:

6066 
MIE
: 
	`°r˝y
(
k⁄c
, "ych"); ;

6067 
CEL
: 
	`°r˝y
(
k⁄c
, "ym"); ;

6068 
NAR
: 
	`°r˝y
(
k⁄c
, "ymi"); ;

6073 
¥zyp
)

6075 
MIA
:

6076 
BIE
: 
	`°r˝y
(
k⁄c
, "e"); ;

6077 
DOP
:

6078 
MIE
: 
	`°r˝y
(
k⁄c
, "ych"); ;

6079 
CEL
: 
	`°r˝y
(
k⁄c
, "ym"); ;

6080 
NAR
: 
	`°r˝y
(
k⁄c
, "ymi"); ;

6087 i‡(!
liczba
)

6089 
rodzaj
)

6091 
R_M_OS
:

6092 
R_M_NOS_ZYW
:

6093 
R_M_NOS_NZYW
:

6094 
¥zyp
)

6096 
MIA
: 
	`°r˝y
(
k⁄c
, "i"); ;

6097 
DOP
: 
	`°r˝y
(
k⁄c
, "iego"); ;

6098 
CEL
: 
	`°r˝y
(
k⁄c
, "iemu"); ;

6099 
BIE
: 
	`°r˝y
(
k⁄c
,

6100 (
rodzaj
 =
R_M_NOS_NZYW
 ? "i" : "iego"));

6102 
NAR
:

6103 
MIE
: 
	`°r˝y
(
k⁄c
, "im"); ;

6107 
R_Z
:

6108 
¥zyp
)

6110 
MIA
:

6111 
BIE
:

6112 
NAR
: 
adj1
[
ãm©_l
 - 1])

6117 'p': 
	`°r˝y
(
k⁄c
, "ia"); ;

6118 : 
	`°r˝y
(
k⁄c
, "a");

6121 : 
	`°r˝y
(
k⁄c
, "iej");

6125 
R_N_OS
:

6126 
R_N_NOS
:

6127 
¥zyp
)

6129 
MIA
:

6130 
BIE
: 
	`°r˝y
(
k⁄c
, "ie"); ;

6131 
DOP
: 
	`°r˝y
(
k⁄c
, "iego"); ;

6132 
CEL
: 
	`°r˝y
(
k⁄c
, "iemu"); ;

6133 
NAR
:

6134 
MIE
: 
	`°r˝y
(
k⁄c
, "im"); ;

6141 
rodzaj
)

6143 
R_M_OS
:

6144 
¥zyp
)

6146 
MIA
: 
	`°r˝y
(
ªt
, 
adj2
);

6147  
ªt
;

6148 
DOP
:

6149 
BIE
:

6150 
MIE
: 
	`°r˝y
(
k⁄c
, "ich"); ;

6151 
CEL
: 
	`°r˝y
(
k⁄c
, "im"); ;

6152 
NAR
: 
	`°r˝y
(
k⁄c
, "imi"); ;

6157 
¥zyp
)

6159 
MIA
:

6160 
BIE
: 
	`°r˝y
(
k⁄c
, "ie"); ;

6161 
DOP
:

6162 
MIE
: 
	`°r˝y
(
k⁄c
, "ich"); ;

6163 
CEL
: 
	`°r˝y
(
k⁄c
, "im"); ;

6164 
NAR
: 
	`°r˝y
(
k⁄c
, "imi"); ;

6170 
	`°∫˝y
(
ªt
, 
adj1
, 
ãm©_l
);Ñet[temat_l] = '\0';

6171 
	`°rˇt
(
ªt
, 
k⁄c
);

6173  
ªt
;

6174 
	}
}

6177 
	$f_oblicz_¥zym
(
num_¨g
)

6179 
svÆue
 *
¨g
;

6180 *
ªt
;

6182 
¨g
 = 
•
 - 
num_¨g
 + 1;

6184 i‡(
¨g
[0].
ty≥
 !
T_STRING
)

6185 
	`bad_¨g
(1, 
F_PARSE_COMMAND
, &
¨g
[0]);

6186 i‡(
¨g
[1].
ty≥
 !
T_STRING
)

6187 
	`bad_¨g
(2, 
F_PARSE_COMMAND
, &
¨g
[1]);

6188 i‡(
¨g
[2].
ty≥
 !
T_NUMBER
)

6189 
	`bad_¨g
(3, 
F_PARSE_COMMAND
, &
¨g
[2]);

6190 i‡(
¨g
[3].
ty≥
 !
T_NUMBER
)

6191 
	`bad_¨g
(4, 
F_PARSE_COMMAND
, &
¨g
[3]);

6192 i‡(
¨g
[4].
ty≥
 !
T_NUMBER
)

6193 
	`bad_¨g
(5, 
F_PARSE_COMMAND
, &
¨g
[4]);

6195 
ªt
 = 
	`oblicz_¥zym
(
¨g
[0].
u
.
°rög
,árg[1].u.°rög,árg[2].u.
numbî
,

6196 
¨g
[3].
u
.
numbî
,árg[4].u.number);

6198 
	`p›_n_ñems
(
num_¨g
);

6200 i‡(!
ªt
)

6201 
	`push_numbî
(0);

6203 
	`push_°rög
(
ªt
, 
STRING_MSTRING
);

6204 
	}
}

6207 
	$f_debug
(
num_¨g
)

6209 
svÆue
 *
¨g
, *
ªt
;

6210 
i
;

6212 
¨g
 = 
•
 - 
num_¨g
 + 1;

6213 i‡(
cuºít_obje˘
 !
ma°î_ob
)

6215 
	`push_obje˘
(
cuºít_obje˘
);

6216 
i
 = 0; i < 
num_¨g
; i++)

6217 
	`push_svÆue
(&
¨g
[
i
]);

6218 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_VALID_DEBUG
, 
num_¨g
 + 1);

6219 i‡(
ªt
 && (ªt->
ty≥
 !
T_NUMBER
 ||Ñë->
u
.
numbî
 == 0))

6221 
	`p›_n_ñems
(
num_¨g
);

6222 
	`push_numbî
(0);

6226 
¨g
 = 
•
 - 
num_¨g
 + 1;

6227 i‡(
¨g
[0].
ty≥
 !
T_STRING
)

6228 
	`bad_¨g
(1, 
F_DEBUG
, &
¨g
[0]);

6230 
ªt
 = 
	`debug_comm™d
(
¨g
[0].
u
.
°rög
,

6231 
num_¨g
-1, 
•
-num_arg+2);

6232 
	`p›_n_ñems
(
num_¨g
 - 1);

6233 
	`assign_svÆue
(
•
, 
ªt
);

6234 
	`‰ì_svÆue
(
ªt
);

6235 
	}
}

6239 
	$f_ssˇnf
(
xxx
)

6241 
i
;

6242 
num_¨g
;

6244 
num_¨g
 = 
	`EXTRACT_UCHAR
(
pc
);

6245 
pc
++;

6246 
i
 = 
	`öãr_ssˇnf
(
num_¨g
);

6247 
	`p›_n_ñems
(
num_¨g
);

6248 
	`push_numbî
(
i
);

6249 
	}
}

6253 
	$f_íabÀ_comm™ds
(
num_¨g
)

6255 
	`íabÀ_comm™ds
(1);

6256 
	`push_numbî
(1);

6257 
	}
}

6261 
	$f_dißbÀ_comm™ds
(
num_¨g
)

6263 
	`íabÀ_comm™ds
(0);

6264 
	`push_numbî
(0);

6265 
	}
}

6269 
	$f_¥e£¡
(
num_¨g
)

6271 
obje˘
 *
ob
;

6273 i‡((
•
-1)->
ty≥
 =
T_NUMBER
) {

6274 i‡((
•
-1)->
u
.
numbî
 != 0)

6275 
	`îr‹
("Badárgument 1ÅoÖresent()\n");

6276 
ob
 = 0;

6278 
ob
 = 
	`obje˘_¥e£¡
((
•
-1), sp);

6279 
	`p›_°ack
();

6280 
	`p›_°ack
();

6281 
	`push_obje˘
(
ob
);

6282 
	}
}

6286 
	$f_c⁄°0
(
num_¨g
)

6288 
	`push_numbî
(0);

6289 
	}
}

6293 
	$f_c⁄°1
(
num_¨g
)

6295 
	`push_numbî
(1);

6296 
	}
}

6300 
	$f_numbî
(
num_¨g
)

6302 
i
;

6304 ((*)&
i
)[0] = 
pc
[0];

6305 ((*)&
i
)[1] = 
pc
[1];

6306 ((*)&
i
)[2] = 
pc
[2];

6307 ((*)&
i
)[3] = 
pc
[3];

6308 
pc
 += 4;

6309 
	`push_numbî
(
i
);

6310 
	}
}

6314 
	$f_assign
(
num_¨g
)

6316 #ifde‡
DEBUG


6317 i‡(
•
[-1].
ty≥
 !
T_LVALUE
)

6318 
	`Áèl
("BadárgumentÅo F_ASSIGN\n");

6320 
	`assign_svÆue
((
•
-1)->
u
.
lvÆue
, sp);

6321 
•
--;

6322 *
•
 = *(sp+1);

6323 
	}
}

6327 
	$f_˘ime
(
num_¨g
)

6329 *
˝1
, *
˝2
;

6331 
˝1
 = 
	`time_°rög
(
•
->
u
.
numbî
);

6332 
˝2
 = 
	`°rchr
(
˝1
, '\n');

6333 i‡(
˝2
)

6334 *
˝2
 = '\0';

6335 
˝1
 = 
	`make_m°rög
(cp1);

6336 
	`p›_°ack
();

6337 
	`push_m°rög
(
˝1
);

6338 
	}
}

6342 
	$f_add_eq
(
num_¨g
)

6344 
svÆue
 *
¨gp
;

6345 *
√w_°r
;

6346 
i
;

6347 
Ê
;

6349 i‡(
•
[-1].
ty≥
 !
T_LVALUE
)

6350 
	`bad_¨g
(1, 
F_ADD_EQ
, 
•
-1);

6351 
¨gp
 = 
•
[-1].
u
.
lvÆue
;

6352 
¨gp
->
ty≥
)

6354 
T_STRING
:

6355 i‡(
•
->
ty≥
 =
T_STRING
)

6357 
l
 = 
	`°æí
(
¨gp
->
u
.
°rög
);

6358 
k
 = 
l
 + 
	`°æí
(
•
->
u
.
°rög
);

6359 i‡(
k
 > 
MAX_STRING_LENGTH
)

6360 
	`îr‹
("TooÜong string.\n");

6361 
√w_°r
 = 
	`Æloˇã_m°rög
(
k
);

6362 ()
	`°r˝y
(
√w_°r
, 
¨gp
->
u
.
°rög
);

6363 ()
	`°r˝y
(
√w_°r
+
l
, 
•
->
u
.
°rög
);

6364 
	`p›_n_ñems
(2);

6365 
	`push_m°rög
(
√w_°r
);

6367 i‡(
•
->
ty≥
 =
T_NUMBER
)

6369 
buff
[20];

6370 ()
	`•rötf
(
buff
, "%d", 
•
->
u
.
numbî
);

6371 
√w_°r
 = 
	`Æloˇã_m°rög
(
	`°æí
(
¨gp
->
u
.
°rög
Ë+ såÀn(
buff
));

6372 ()
	`°r˝y
(
√w_°r
, 
¨gp
->
u
.
°rög
);

6373 ()
	`°rˇt
(
√w_°r
, 
buff
);

6374 
	`p›_n_ñems
(2);

6375 
	`push_m°rög
(
√w_°r
);

6379 
	`bad_¨g
(2, 
F_ADD_EQ
, 
•
);

6382 
T_NUMBER
:

6383 i‡(
•
->
ty≥
 =
T_NUMBER
)

6385 
i
 = 
¨gp
->
u
.
numbî
 + 
•
->u.number;

6386 
	`p›_n_ñems
(2);

6387 
	`push_numbî
(
i
);

6391 
	`îr‹
("BadÅypeÇumberÅoÑhs +=.\n");

6394 
T_FLOAT
:

6395 i‡(
•
->
ty≥
 =
T_FLOAT
)

6397 
Ê
 = ()
¨gp
->
u
.
ªÆ
 + ()
•
->u.real;

6398 
	`p›_n_ñems
(2);

6399 
	`push_Êﬂt
(
Ê
);

6403 
	`îr‹
("BadÅypeÇumberÅoÑhs +=.\n");

6406 
T_MAPPING
:

6407 i‡(
•
->
ty≥
 !
T_MAPPING
) {

6408 
	`îr‹
("BadÅypeÅoÑhs +=.\n");

6411 
m≠pög
 *
m
;

6413 
	`check_f‹_de°r
(
¨gp
);

6414 
	`check_f‹_de°r
(
•
);

6415 
	`addto_m≠pög
(
¨gp
->
u
.
m≠
, 
•
->u.map);

6416 
m
 = 
¨gp
->
u
.
m≠
;

6417 
	`INCREF
(
m
->
ªf
);

6418 
	`p›_n_ñems
(2);

6419 
	`push_m≠pög
(
m
, 
FALSE
);

6422 
T_POINTER
:

6423 i‡(
•
->
ty≥
 !
T_POINTER
) {

6424 
	`îr‹
("BadÅypeÅoÑhs +=.\n");

6427 
ve˘‹
 *
v
;

6429 
	`check_f‹_de°r
(
¨gp
);

6430 
	`check_f‹_de°r
(
•
);

6431 
v
 = 
	`add_¨øy
(
¨gp
->
u
.
vec
,
•
->u.vec);

6432 
	`p›_n_ñems
(2);

6433 
	`push_ve˘‹
(
v
, 
FALSE
);

6437 
	`îr‹
("BadÅypeÅoÜhs += \n");

6439 
	`assign_svÆue
(
¨gp
, 
•
);

6440 
	}
}

6444 
	$f_sub_eq
(
num_¨g
)

6446 
svÆue
 *
¨gp
;

6448 i‡(
•
[-1].
ty≥
 !
T_LVALUE
)

6449 
	`bad_¨g
(1, 
F_SUB_EQ
, 
•
-1);

6450 
¨gp
 = 
•
[-1].
u
.
lvÆue
;

6451 
¨gp
->
ty≥
) {

6452 
T_NUMBER
:

6453 i‡(
•
->
ty≥
 !
T_NUMBER
)

6454 
	`îr‹
("BadÑightÅypeÅo -=\n");

6455 
¨gp
->
u
.
numbî
 -
•
->u.number;

6456 
•
--;

6458 
T_FLOAT
:

6459 i‡(
•
->
ty≥
 !
T_FLOAT
)

6460 
	`îr‹
("BadÑightÅypeÅo -=\n");

6461 
	`FLOATASGOP
(
¨gp
->
u
.
ªÆ
, -, 
•
->u.real);

6462 
•
--;

6464 
T_POINTER
:

6466 
ve˘‹
 *
v
;

6468 i‡(
•
->
ty≥
 !
T_POINTER
)

6469 
	`îr‹
("BadÑightÅypeÅo -=\n");

6471 
	`check_f‹_de°r
(
¨gp
);

6472 
	`check_f‹_de°r
(
•
);

6474 
v
 = 
	`subåa˘_¨øy
(
¨gp
->
u
.
vec
, 
•
->u.vec);

6476 
	`p›_°ack
();

6477 
	`p›_°ack
();

6479 i‡(
v
 == 0)

6481 
	`push_numbî
(0);

6485 
	`push_ve˘‹
(
v
, 
FALSE
);

6488 
	`assign_svÆue
(
¨gp
, 
•
);

6492 
	`îr‹
("BadÜeftÅypeÅo -=.\n");

6494 
	`assign_svÆue
(
•
, 
¨gp
);

6495 
	}
}

6499 
	$f_mu…_eq
(
num_¨g
)

6501 
svÆue
 *
¨gp
;

6502 
Ê
;

6503 
i
;

6505 i‡(
•
[-1].
ty≥
 !
T_LVALUE
)

6506 
	`bad_¨g
(1, 
F_MULT_EQ
, 
•
-1);

6507 
¨gp
 = 
•
[-1].
u
.
lvÆue
;

6508 i‡(
¨gp
->
ty≥
 =
T_FLOAT
 && 
•
->type == T_FLOAT)

6510 
Ê
 = ()
¨gp
->
u
.
ªÆ
 * ()
•
->u.real;

6511 
	`p›_n_ñems
(2);

6512 
	`push_Êﬂt
(
Ê
);

6513 
	`assign_svÆue
(
¨gp
, 
•
);

6516 i‡(
¨gp
->
ty≥
 !
T_NUMBER
)

6517 
	`îr‹
("BadÜeftÅypeÅo *=.\n");

6518 i‡(
•
->
ty≥
 !
T_NUMBER
)

6519 
	`îr‹
("BadÑightÅypeÅo *=\n");

6520 
i
 = 
¨gp
->
u
.
numbî
 * 
•
->u.number;

6521 
	`p›_n_ñems
(2);

6522 
	`push_numbî
(
i
);

6523 
	`assign_svÆue
(
¨gp
, 
•
);

6524 
	}
}

6528 
	$f_™d_eq
(
num_¨g
)

6530 
svÆue
 *
¨gp
;

6531 
i
;

6533 i‡(
•
[-1].
ty≥
 !
T_LVALUE
)

6534 
	`bad_¨g
(1, 
F_AND_EQ
, 
•
-1);

6535 
¨gp
 = 
•
[-1].
u
.
lvÆue
;

6536 
¨gp
->
ty≥
)

6538 
T_NUMBER
:

6539 i‡(
•
->
ty≥
 !
T_NUMBER
)

6540 
	`îr‹
("BadÑightÅypeÅo &=\n");

6541 
i
 = 
¨gp
->
u
.
numbî
 & 
•
->u.number;

6542 
	`p›_n_ñems
(2);

6543 
	`push_numbî
(
i
);

6544 
	`assign_svÆue
(
¨gp
, 
•
);

6546 
T_POINTER
:

6548 
ve˘‹
 *
v
;

6550 i‡(
•
->
ty≥
 !
T_POINTER
)

6551 
	`îr‹
("BadÑightÅypeÅo &=\n");

6553 
v
 = 
	`öãr£˘_¨øy
(
¨gp
->
u
.
vec
, 
•
->u.vec);

6555 
	`p›_°ack
();

6556 
	`p›_°ack
();

6558 i‡(
v
 == 0)

6560 
	`push_numbî
(0);

6564 
	`push_ve˘‹
(
v
, 
FALSE
);

6567 
	`assign_svÆue
(
¨gp
, 
•
);

6571 
	`îr‹
("BadÜeftÅypeÅo &=.\n");

6573 
	}
}

6577 
	$f_‹_eq
(
num_¨g
)

6579 
svÆue
 *
¨gp
;

6580 
i
;

6582 i‡(
•
[-1].
ty≥
 !
T_LVALUE
)

6583 
	`bad_¨g
(1, 
F_OR_EQ
, 
•
-1);

6584 
¨gp
 = 
•
[-1].
u
.
lvÆue
;

6585 i‡(
•
->
ty≥
 =
T_POINTER
 && 
¨gp
->type == T_POINTER)

6587 
ve˘‹
 *
v
;

6589 
v
 = 
	`uni⁄_¨øy
(
¨gp
->
u
.
vec
, 
•
->u.vec);

6591 
	`p›_°ack
();

6592 
	`p›_°ack
();

6594 i‡(
v
 =
NULL
)

6595 
	`push_numbî
(0);

6597 
	`push_ve˘‹
(
v
, 
FALSE
);

6598 
	`assign_svÆue
(
¨gp
,
•
);

6601 i‡(
¨gp
->
ty≥
 !
T_NUMBER
)

6602 
	`îr‹
("BadÜeftÅypeÅo |=.\n");

6603 i‡(
•
->
ty≥
 !
T_NUMBER
)

6604 
	`îr‹
("BadÑightÅypeÅo |=\n");

6605 
i
 = 
¨gp
->
u
.
numbî
 | 
•
->u.number;

6606 
	`p›_n_ñems
(2);

6607 
	`push_numbî
(
i
);

6608 
	`assign_svÆue
(
¨gp
, 
•
);

6609 
	}
}

6613 
	$f_x‹_eq
(
num_¨g
)

6615 
svÆue
 *
¨gp
;

6616 
i
;

6618 i‡(
•
[-1].
ty≥
 !
T_LVALUE
)

6619 
	`bad_¨g
(1, 
F_XOR_EQ
, 
•
-1);

6620 
¨gp
 = 
•
[-1].
u
.
lvÆue
;

6621 i‡(
¨gp
->
ty≥
 !
T_NUMBER
)

6622 
	`îr‹
("BadÜeftÅypeÅo ^=.\n");

6623 i‡(
•
->
ty≥
 !
T_NUMBER
)

6624 
	`îr‹
("BadÑightÅypeÅo ^=\n");

6625 
i
 = 
¨gp
->
u
.
numbî
 ^ 
•
->u.number;

6626 
	`p›_n_ñems
(2);

6627 
	`push_numbî
(
i
);

6628 
	`assign_svÆue
(
¨gp
, 
•
);

6629 
	}
}

6633 
	$f_lsh_eq
(
num_¨g
)

6635 
svÆue
 *
¨gp
;

6636 
i
;

6638 i‡(
•
[-1].
ty≥
 !
T_LVALUE
)

6639 
	`bad_¨g
(1, 
F_LSH_EQ
, 
•
-1);

6640 
¨gp
 = 
•
[-1].
u
.
lvÆue
;

6641 i‡(
¨gp
->
ty≥
 !
T_NUMBER
)

6642 
	`îr‹
("BadÜeftÅypeÅo <<=.\n");

6643 i‡(
•
->
ty≥
 !
T_NUMBER
)

6644 
	`îr‹
("BadÑightÅypeÅo <<=\n");

6645 
i
 = 
¨gp
->
u
.
numbî
 << 
•
->u.number;

6646 
	`p›_n_ñems
(2);

6647 
	`push_numbî
(
i
);

6648 
	`assign_svÆue
(
¨gp
, 
•
);

6649 
	}
}

6653 
	$f_rsh_eq
(
num_¨g
)

6655 
svÆue
 *
¨gp
;

6656 
i
;

6658 i‡(
•
[-1].
ty≥
 !
T_LVALUE
)

6659 
	`bad_¨g
(1, 
F_RSH_EQ
, 
•
-1);

6660 
¨gp
 = 
•
[-1].
u
.
lvÆue
;

6661 i‡(
¨gp
->
ty≥
 !
T_NUMBER
)

6662 
	`îr‹
("BadÜeftÅypeÅo >>=.\n");

6663 i‡(
•
->
ty≥
 !
T_NUMBER
)

6664 
	`îr‹
("BadÑightÅypeÅo >>=\n");

6665 
i
 = ()(()
¨gp
->
u
.
numbî
 >> 
•
->u.number);

6666 
	`p›_n_ñems
(2);

6667 
	`push_numbî
(
i
);

6668 
	`assign_svÆue
(
¨gp
, 
•
);

6669 
	}
}

6671 #ifde‡
F_COMBINE_FREE_LIST


6674 
	$f_comböe_‰ì_li°
(
num_¨g
)

6676 
	`push_numbî
(0);

6677 
	}
}

6682 
	$f_div_eq
(
num_¨g
)

6684 
svÆue
 *
¨gp
;

6685 
i
;

6686 
Ê
;

6688 i‡(
•
[-1].
ty≥
 !
T_LVALUE
)

6689 
	`bad_¨g
(1, 
F_DIV_EQ
, 
•
-1);

6690 
¨gp
 = 
•
[-1].
u
.
lvÆue
;

6691 i‡(
¨gp
->
ty≥
 =
T_FLOAT
 && 
•
->type == T_FLOAT)

6693 i‡(
•
->
u
.
ªÆ
 == 0.0)

6694 
	`îr‹
("Division by 0\n");

6695 
Ê
 = ()
¨gp
->
u
.
ªÆ
 / ()
•
->u.real;

6696 
	`p›_n_ñems
(2);

6697 
	`push_Êﬂt
(
Ê
);

6698 
	`assign_svÆue
(
¨gp
, 
•
);

6701 i‡(
¨gp
->
ty≥
 !
T_NUMBER
)

6702 
	`îr‹
("BadÜeftÅypeÅo /=.\n");

6703 i‡(
•
->
ty≥
 !
T_NUMBER
)

6704 
	`îr‹
("BadÑightÅypeÅo /=\n");

6705 i‡(
•
->
u
.
numbî
 == 0)

6706 
	`îr‹
("Division by 0\n");

6707 
i
 = 
¨gp
->
u
.
numbî
 / 
•
->u.number;

6708 
	`p›_n_ñems
(2);

6709 
	`push_numbî
(
i
);

6710 
	`assign_svÆue
(
¨gp
, 
•
);

6711 
	}
}

6715 
	$f_mod_eq
(
num_¨g
)

6717 
svÆue
 *
¨gp
;

6718 
i
;

6720 i‡(
•
[-1].
ty≥
 !
T_LVALUE
)

6721 
	`bad_¨g
(1, 
F_MOD_EQ
, 
•
-1);

6722 
¨gp
 = 
•
[-1].
u
.
lvÆue
;

6723 i‡(
¨gp
->
ty≥
 !
T_NUMBER
)

6724 
	`îr‹
("BadÜeftÅypeÅo %=.\n");

6725 i‡(
•
->
ty≥
 !
T_NUMBER
)

6726 
	`îr‹
("BadÑightÅypeÅo %=\n");

6727 i‡(
•
->
u
.
numbî
 == 0)

6728 
	`îr‹
("Division by 0\n");

6729 
i
 = 
¨gp
->
u
.
numbî
 % 
•
->u.number;

6730 
	`p›_n_ñems
(2);

6731 
	`push_numbî
(
i
);

6732 
	`assign_svÆue
(
¨gp
, 
•
);

6733 
	}
}

6737 
	$f_°rög
(
num_¨g
)

6739 
°rög_numbî
;

6741 ((*)&
°rög_numbî
)[0] = 
pc
[0];

6742 ((*)&
°rög_numbî
)[1] = 
pc
[1];

6743 
pc
 += 2;

6744 
	`push_°rög
(
cuºít_¥og
->
rod©a
 + 
°rög_numbî
,

6745 
STRING_SSTRING
);

6746 
	}
}

6749 
	$f_unique_¨øy
(
num_¨g
)

6751 
ve˘‹
 *
ªs
;

6753 i‡((
•
 - (
num_¨g
 - 1))->
ty≥
 =
T_NUMBER
)

6755 
	`p›_n_ñems
(
num_¨g
);

6756 
	`push_numbî
(0);

6759 i‡(
num_¨g
 < 3) {

6760 
	`check_f‹_de°r
(
•
-1);

6761 
ªs
 = 
	`make_unique
((
•
-1)->
u
.
vec
, sp->u.
°rög
, &
c⁄°0
);

6764 
	`check_f‹_de°r
(
•
-2);

6765 
ªs
 = 
	`make_unique
((
•
-2)->
u
.
vec
, (•-1)->u.
°rög
, sp);

6766 
	`p›_°ack
 ();

6768 
	`p›_n_ñems
(2);

6769 i‡(
ªs
) {

6770 
	`push_ve˘‹
(
ªs
, 
FALSE
);

6773 
	`push_numbî
 (0);

6774 
	}
}

6778 
	$f_ª«me
(
num_¨g
)

6780 
i
;

6782 
i
 = 
	`do_ª«me
((
•
-1)->
u
.
°rög
, sp->u.string);

6783 
	`p›_n_ñems
(2);

6784 
	`push_numbî
(
i
);

6785 
	}
}

6788 
	$f_m≠
(
num_¨g
)

6790 
ve˘‹
 *
ªs
;

6791 
svÆue
 *
¨g
;

6792 
m≠pög
 *
m
;

6793 
obje˘
 *
ob
;

6795 
¨g
 = 
•
 - 
num_¨g
 + 1;

6797 i‡(
num_¨g
 =2 && 
¨g
[1].
ty≥
 =
T_FUNCTION
) {

6799 } i‡(
num_¨g
 >3 && 
¨g
[1].
ty≥
 =
T_STRING
) {

6800 
˛osuª
 *
fun
;

6802 i‡(
¨g
[2].
ty≥
 =
T_OBJECT
)

6803 
ob
 = 
¨g
[2].
u
.ob;

6804 i‡(
¨g
[2].
ty≥
 =
T_STRING
)

6805 
ob
 = 
	`föd_obje˘
(
¨g
[2].
u
.
°rög
);

6807 
ob
 = 0;

6809 i‡(!
ob
)

6810 
	`bad_¨g
(3, 
F_MAP
, &
¨g
[2]);

6813 
fun
 = 
	`Æloc_obj˛osuª°r
(
FUN_LFUNO
, 
¨g
[1].
u
.
°rög
, 
ob
, "f_map", 0);

6814 i‡(!
fun
) {

6821 
	`îr‹
("Fun˘i⁄ u£d i¿m≠ couldÇŸ bêfound: %s\n", 
¨g
[1].
u
.
°rög
);

6823 ()
	`¥ötf
("Fun˘i⁄ u£d i¿m≠ couldÇŸ bêfound: %s\n", 
¨g
[1].
u
.
°rög
);

6824 
	`p›_n_ñems
(
num_¨g
);

6825 
	`push_numbî
(0);

6829 i‡(
num_¨g
 > 3) {

6830 
	`‰ì_ve˘‹
(
fun
->
fu«rgs
);

6831 
fun
->
fu«rgs
 = 
	`Æloˇã_¨øy
(2);

6832 
fun
->
fu«rgs
->
ôem
[0] = 
c⁄°em±y
;

6833 
	`assign_svÆue_no_‰ì
(&
fun
->
fu«rgs
->
ôem
[1], &
¨g
[3]);

6835 
	`‰ì_svÆue
(&
¨g
[1]);

6836 
¨g
[1].
ty≥
 = 
T_FUNCTION
;

6837 
¨g
[1].
u
.
func
 = 
fun
;

6839 
	`WARNOBSOLETE
(
cuºít_obje˘
, "stringás function in map");

6842 
	`îr‹
("BadárgumentsÅo map\n");

6844 i‡(
¨g
[0].
ty≥
 =
T_POINTER
) {

6845 
	`check_f‹_de°r
(&
¨g
[0]);

6846 
ªs
 = 
	`m≠_¨øy
(
¨g
[0].
u
.
vec
,árg[1].u.
func
);

6847 
	`p›_n_ñems
(
num_¨g
);

6848 i‡(
ªs
) {

6849 
	`push_ve˘‹
(
ªs
, 
FALSE
);

6851 
	`push_numbî
(0);

6852 } i‡(
¨g
[0].
ty≥
 =
T_MAPPING
) {

6853 
	`check_f‹_de°r
(&
¨g
[0]);

6854 
m
 = 
	`m≠_m≠
(
¨g
[0].
u
.
m≠
,árg[1].u.
func
);

6855 
	`p›_n_ñems
(
num_¨g
);

6856 i‡(
m
) {

6857 
	`push_m≠pög
(
m
, 
FALSE
);

6859 
	`push_numbî
(0);

6862 
	`p›_n_ñems
(
num_¨g
);

6863 
	`push_numbî
(0);

6865 
	}
}

6869 
	$f_sqπ
(
num_¨g
)

6871 
	`sqπ
();

6873 
•
->
u
.
ªÆ
 = 
	`chkÊﬂå™ge
(
	`sqπ
(()sp->u.real));

6874 
	}
}

6876 #ifde‡
USE_SWAP


6878 
	$ac˚ss_obje˘
(
obje˘
 *
ob
)

6880 
obje˘
 *
obj_li°
;

6881 
obje˘
 *
sw≠_ob
;

6882 i‡(
ob
->
Êags
 & 
O_SWAPPED
)

6883 
	`lﬂd_ob_‰om_sw≠
(
ob
);

6884 
ob
->
time_of_ªf
 = 
cuºít_time
;

6886 i‡(
ob
 !
obj_li°
 && !(ob->
Êags
 & 
O_DESTRUCTED
))

6888 
ob
->
¥ev_Æl
->
√xt_Æl
 = ob->next_all;

6889 
ob
->
√xt_Æl
->
¥ev_Æl
 = ob->prev_all;

6890 i‡(
ob
 =
sw≠_ob
)

6891 
sw≠_ob
 = 
ob
->
¥ev_Æl
;

6893 
ob
->
√xt_Æl
 = 
obj_li°
;

6894 
ob
->
¥ev_Æl
 = 
obj_li°
->prev_all;

6896 
obj_li°
->
¥ev_Æl
->
√xt_Æl
 = 
ob
;

6897 
obj_li°
->
¥ev_Æl
 = 
ob
;

6898 
obj_li°
 = 
ob
;

6900 
	}
}

6903 
	$ac˚ss_¥ogøm
(
¥ogøm
 *
¥og
)

6905 
¥ogøm
 *
¥og_li°
;

6906 
¥ogøm
 *
sw≠_¥og
;

6908 i‡(
¥og
->
¥ogøm
 == (*)0)

6909 
	`lﬂd_¥og_‰om_sw≠
(
¥og
);

6910 
¥og
->
time_of_ªf
 = 
cuºít_time
;

6911 i‡(
¥og
 !
¥og_li°
)

6913 
¥og
->
¥ev_Æl
->
√xt_Æl
 =Örog->next_all;

6914 
¥og
->
√xt_Æl
->
¥ev_Æl
 =Örog->prev_all;

6915 i‡(
¥og
 =
sw≠_¥og
)

6916 
sw≠_¥og
 = 
¥og
->
¥ev_Æl
;

6918 
¥og
->
√xt_Æl
 = 
¥og_li°
;

6919 
¥og
->
¥ev_Æl
 = 
¥og_li°
->prev_all;

6921 
¥og_li°
->
¥ev_Æl
->
√xt_Æl
 = 
¥og
;

6922 
¥og_li°
->
¥ev_Æl
 = 
¥og
;

6923 
¥og_li°
 = 
¥og
;

6925 
	}
}

6928 
	#EFUN_TABLE


	)

6929 
	~"efun_èbÀ.h
"

6930 #unde‡
EFUN_TABLE


6933 
	$evÆ_ö°ru˘i⁄
(*
p
)

6935 
num_¨g
;

6936 
i
;

6937 
ö°ru˘i⁄
;

6938 
ext_ö°r
;

6939 #ifde‡
DEBUG


6940 
svÆue
 *
ex≥˘ed_°ack
;

6942 
ˇtch_Àvñ
;

6944 #i‡
	`deföed
(
RUSAGE
Ë&& deföed(
PROFILE_OBJS
)

6946 #ifde‡
SOLARIS


6947 
tms
 
buf„r
;

6949 
rußge
 
rus
;

6951 
˝u
;

6953 #ifde‡
SOLARIS


6954 i‡(
	`times
(&
buf„r
) != -1)

6955 
˝u
 = (
buf„r
.
tms_utime
 + buf„r.
tms_°ime
);

6957 i‡(
	`gërußge
(
RUSAGE_SELF
, &
rus
) >= 0)

6959 
˝u
 = 
rus
.
ru_utime
.
tv_£c
 * 1000 +Ñus.ru_utime.
tv_u£c
 / 1000 +

6960 
rus
.
ru_°ime
.
tv_£c
 * 1000 +Ñus.ru_°ime.
tv_u£c
 / 1000;

6964 
˝u
 = (-1);

6966 i‡(
¥og˝ui
 >
MAX_CPU_STACK
)

6967 
	`Áèl
("CPU-Stack overflow.\n");

6969 
¥og˝u
[
¥og˝ui
].
¥og
 = 
cuºít_¥og
;

6970 
¥og˝u
[
¥og˝ui
++].
˝u
 = cpu;

6974 
pc
 = 
p
;

6975 
agaö
:

6976 
i
 = 
ö°ru˘i⁄
 = 
	`EXTRACT_UCHAR
(
pc
);

6978 i‡(
ö°ru˘i⁄
 =
F_EXT
 - 
EFUN_FIRST
)

6980 ((*)&
ext_ö°r
)[0] = 
pc
[1];

6981 ((*)&
ext_ö°r
)[1] = 
pc
[2];

6982 
ö°ru˘i⁄
 = 
ext_ö°r
;

6985 #ifde‡
TRACE_CODE


6986 
¥evious_ö°ru˘i⁄
[
œ°
] = 
ö°ru˘i⁄
 + 
EFUN_FIRST
;

6987 
¥evious_pc
[
œ°
] = 
pc
;

6988 
°ack_size
[
œ°
] = 
•
 - 
Â
 - 
c•
->
num_loˇl_v¨übÀs
;

6989 
cuπø˚dïth
[
œ°
] = 
åa˚dïth
;

6990 
œ°
 = (œ° + 1Ë% ( 
¥evious_ö°ru˘i⁄
 /  ());

6993 i‡(
i
 =
F_EXT
 - 
EFUN_FIRST
)

6994 
pc
 += 2;

6996 
pc
++;

6997 
evÆ_co°
++;

6998 i‡(!
u∆imôed
 && 
evÆ_co°
 > 
MAX_COST
)

7000 *
löe
;

7001 
löe
 = 
	`gë_§ccode_posôi⁄
(
pc
 - 
cuºít_¥og
->
¥ogøm
, current_prog);

7002 ()
	`¥ötf
("evÆ_co°Åoÿbig %d (%s)\n", 
evÆ_co°
, 
löe
);

7003 
evÆ_co°
 = 0;

7004 
	`îr‹
("TooÜongÉvaluation. Executionáborted.\n");

7012 #ifde‡
DEBUG


7013 
xnum_¨g
;

7015 i‡(
ö°rs
[
ö°ru˘i⁄
].
mö_¨g
 !ö°rs[ö°ru˘i⁄].
max_¨g
)

7017 
num_¨g
 = 
	`EXTRACT_UCHAR
(
pc
);

7018 #ifde‡
DEBUG


7019 
xnum_¨g
 = 
num_¨g
;

7021 
pc
++;

7025 #ifde‡
DEBUG


7026 
xnum_¨g
 = -1;

7028 
num_¨g
 = 
ö°rs
[
ö°ru˘i⁄
].
mö_¨g
;

7030 i‡(
num_¨g
 > 0)

7032 
ty≥1
 = (
•
-
num_¨g
+1)->
ty≥
, 
ty≥2
 = (sp-num_arg+2)->type;

7033 i‡(
ö°rs
[
ö°ru˘i⁄
].
ty≥
[0] != 0 &&

7034 (
ö°rs
[
ö°ru˘i⁄
].
ty≥
[0] & 
ty≥1
) == 0)

7036 
	`bad_¨g
(1, 
ö°ru˘i⁄
 + 
EFUN_FIRST
, 
•
-
num_¨g
+1);

7038 i‡(
num_¨g
 > 1)

7040 i‡(
ö°rs
[
ö°ru˘i⁄
].
ty≥
[1] != 0 &&

7041 (
ö°rs
[
ö°ru˘i⁄
].
ty≥
[1] & 
ty≥2
) == 0)

7043 
	`bad_¨g
(2, 
ö°ru˘i⁄
 + 
EFUN_FIRST
, 
•
-
num_¨g
+2);

7051 #ifde‡
DEBUG


7052 i‡(
xnum_¨g
 != -1) {

7053 
ex≥˘ed_°ack
 = 
•
 - 
num_¨g
 + 1;

7055 
ex≥˘ed_°ack
 = 0;

7059 
ö°ru˘i⁄
 +
EFUN_FIRST
;

7060 #ifde‡
OPCPROF


7061 i‡(
ö°ru˘i⁄
 >0 && in°ru˘i⁄ < 
MAXOPC
)

7062 
›cou¡
[
ö°ru˘i⁄
]++;

7068 #ifde‡
TRACE_CODE


7069 i‡(
	`TRACEP
(
TRACE_EXEC
)) {

7070 
	`do_åa˚
("Exe¯", 
	`gë_f_«me
(
ö°ru˘i⁄
), "\n");

7073 
ö°ru˘i⁄
)

7076 #ifde‡
DEBUG


7077 i‡(
ö°ru˘i⁄
 >
EFUN_FIRST
 && in°ru˘i⁄ <
EFUN_LAST
)

7079 
efun_èbÀ
[
ö°ru˘i⁄
 - 
EFUN_FIRST
](
num_¨g
);

7080 #ifde‡
DEBUG


7082 
	`Áèl
("Undeföed in°ru˘i⁄ %†(%d)\n", 
	`gë_f_«me
(
ö°ru˘i⁄
),

7083 
ö°ru˘i⁄
);

7089 
F_RETURN
:

7091 i‡(
c•
->
num_loˇl_v¨übÀs
) {

7092 
svÆue
 *
sv
;

7094 
sv
 = 
•
--;

7098 
i
 = 0; i < 
c•
->
num_loˇl_v¨übÀs
; i++)

7099 
	`p›_°ack
();

7100 *++
•
 = *
sv
;

7102 #ifde‡
DEBUG


7103 i‡(
•
 !
Â
)

7104 
	`Áèl
("Bad stackát F_RETURN\n");

7106 
	`p›_c⁄åﬁ_°ack
();

7107 
åa˚dïth
--;

7108 #ifde‡
TRACE_CODE


7109 i‡(
	`TRACEP
(
TRACE_RETURN
)) {

7110 
	`do_åa˚
("Return", "", "");

7111 i‡(
	`TRACETST
(
TRACE_ARGS
)) {

7112 
	`wrôe_sockë
(
	`°rög_¥öt_f‹m©ãd
(0, " wôh vÆue: %O", 1, 
•
),

7113 
comm™d_givî
);

7115 
	`wrôe_sockë
("\n", 
comm™d_givî
);

7119 #i‡
	`deföed
(
RUSAGE
Ë&& deföed(
PROFILE_OBJS
)

7121 #ifde‡
SOLARIS


7122 
tms
 
buf„r
;

7124 
rußge
 
rus
;

7126 
˝u
;

7127 
n
;

7129 #ifde‡
SOLARIS


7130 i‡(
	`times
(&
buf„r
) != -1)

7131 
˝u
 = (
buf„r
.
tms_utime
 + buf„r.
tms_°ime
);

7133 i‡(
	`gërußge
(
RUSAGE_SELF
, &
rus
) >= 0)

7135 
˝u
 = 
rus
.
ru_utime
.
tv_£c
 * 1000 +

7136 
rus
.
ru_utime
.
tv_u£c
 / 1000 +

7137 
rus
.
ru_°ime
.
tv_£c
 * 1000 +

7138 
rus
.
ru_°ime
.
tv_u£c
 / 1000;

7141 
˝u
 = (-1);

7143 i‡(--
¥og˝ui
<0)

7144 
	`Áèl
("CPU-Stack underflow.\n");

7146 i‡(
˝u
 >0 && 
¥og˝u
[
¥og˝ui
].cpu >=0)

7148 
˝u
 = cpu - 
¥og˝u
[
¥og˝ui
].cpu;

7149 
n
 = 
¥og˝ui
-1;Ç >= 0;Ç--)

7150 
¥og˝u
[
n
].
˝u
 += cpu;

7151 i‡(
¥og˝u
[
¥og˝ui
].
¥og
)

7152 
¥og˝u
[
¥og˝ui
].
¥og
->
˝u
 += cpu;

7156 i‡(
c•
[1].
exã∫_ˇŒ
)

7161 
F_CATCH
:

7166 
gdex˚±i⁄
 
ex˚±i⁄_‰ame
;

7167 
√w_pc_off£t
;

7168 #ifde‡
DEBUG


7169 
svÆue
 *
°ack
;

7170 
¨gs
, 
ös
;

7172 *
ﬁd_pc
;

7177 ((*)&
√w_pc_off£t
)[0] = 
pc
[0];

7178 ((*)&
√w_pc_off£t
)[1] = 
pc
[1];

7179 
pc
 += 2;

7185 
ﬁd_pc
 = 
pc
;

7186 
pc
 = 
cuºít_¥og
->
¥ogøm
 + 
√w_pc_off£t
;

7187 
	`push_p›_îr‹_c⁄ãxt
 (1);

7188 
ˇtch_Àvñ
++;

7189 
pc
 = 
ﬁd_pc
;

7195 #ifde‡
DEBUG


7196 
°ack
 = 
ex≥˘ed_°ack
;

7197 
ös
 = 
ö°ru˘i⁄
;

7198 
¨gs
 = 
num_¨g
;

7201 i‡(
	`£tjmp
(
ex˚±i⁄_‰ame
.
e_c⁄ãxt
))

7209 #ifde‡
DEBUG


7210 
num_¨g
 = 
¨gs
;

7211 
ö°ru˘i⁄
 = 
ös
;

7212 
ex≥˘ed_°ack
 = 0;

7214 
	`push_p›_îr‹_c⁄ãxt
 (-1);

7215 
ˇtch_Àvñ
--;

7216 
	`push_svÆue
(&
ˇtch_vÆue
);

7219 i‡(
evÆ_co°
 == 0) {

7220 
evÆ_co°
 = 
MAX_COST
;

7221 i‡(
ˇtch_Àvñ
 == 0)

7222 
evÆ_co°
 -
EXTRA_COST
;

7225 #ifde‡
DEBUG


7226 
num_¨g
 = 
¨gs
;

7227 
ö°ru˘i⁄
 = 
ös
;

7228 
ex≥˘ed_°ack
 = 
°ack
;

7230 
ex˚±i⁄_‰ame
.
e_ex˚±i⁄
 = 
ex˚±i⁄
;

7231 
ex˚±i⁄_‰ame
.
e_ˇtch
 = 1;

7232 
ex˚±i⁄
 = &
ex˚±i⁄_‰ame
;

7234 
	`evÆ_ö°ru˘i⁄
(
pc
);

7238 
	`assign_svÆue
(&
ˇtch_vÆue
, &
c⁄°1
);

7240 
F_END_CATCH
:

7241 
	`push_p›_îr‹_c⁄ãxt
(-1);

7242 
ˇtch_Àvñ
--;

7243 
	`push_svÆue
(&
c⁄°0
);

7247 #ifde‡
DEBUG


7248 i‡((
ex≥˘ed_°ack
 &&Éx≥˘ed_°ack !
•
) ||

7249 
•
 < 
Â
 + 
c•
->
num_loˇl_v¨übÀs
 - 1)

7251 
	`Áèl
("Bad stackáfterÉvaluation. Instruction %d,Çumárg %d\n",

7252 
ö°ru˘i⁄
, 
num_¨g
);

7255 
agaö
;

7256 
	}
}

7258 #ifde‡
GLOBAL_CACHE


7259 
	sfˇche1
 {

7260 
	mç
;

7261 *
	m‚
;

7262 
	mff_öh
;

7263 
	mff_ix
;

7269 
	$s_f_f
(*
«me
, 
¥ogøm
 *
¥og
)

7271 
¥obe
 = 0, 
i
;

7272 
¥ogøm
 *
˝rog
 = 
¥og
;

7273 
ty≥_mod
;

7274 #ifde‡
GLOBAL_CACHE


7275 
fˇche1
 
fc
[
GLOBAL_CACHE
];

7276 
globÆ_hash_vÆ
;

7277 
globˇche_hôs
;

7278 
globˇche_åõs
;

7281 i‡(!
«me
)

7284 #ifde‡
GLOBAL_CACHE


7290 
globˇche_åõs
++;

7292 
globÆ_hash_vÆ
 = ()((()
¥og
 / (*)) ^

7293 (()
¥og
 >> 16) ^

7294 (()
«me
 / (*)) ^

7295 (()
«me
 >> 16)Ë& (
GLOBAL_CACHE
 - 1);

7297 i‡(
fc
[
globÆ_hash_vÆ
].
ç
 =
¥og
->
id_numbî
 &&

7298 
fc
[
globÆ_hash_vÆ
].
‚
 =
«me
)

7300 
globˇche_hôs
++;

7301 #ifde‡
CACHE_STATS


7302 
globÆ_fú°_ßves
 +
¥og
->
num_öhîôed
 - 
fc
[
globÆ_hash_vÆ
].
ff_öh
;

7304 
fun˘i⁄_öhîô_found
 = 
fc
[
globÆ_hash_vÆ
].
ff_öh
;

7305 
fun˘i⁄_ödex_found
 = 
fc
[
globÆ_hash_vÆ
].
ff_ix
;

7306 i‡(
fun˘i⁄_öhîô_found
 != -1)

7308 
ty≥_mod1
 = 
¥og
->
öhîô
[
fun˘i⁄_öhîô_found
].
ty≥
;

7310 
fun˘i⁄_¥og_found
 = 
¥og
->
öhîô
[
fun˘i⁄_öhîô_found
].prog;

7311 #ifde‡
USE_SWAP


7312 
	`ac˚ss_¥ogøm
(
fun˘i⁄_¥og_found
);

7314 
fun˘i⁄_ty≥_mod_found
 = 
fun˘i⁄_¥og_found
->

7315 
fun˘i⁄s
[
fun˘i⁄_ödex_found
].
ty≥_Êags
 & 
TYPE_MOD_MASK
 ;

7318 i‡(
fun˘i⁄_ty≥_mod_found
 & 
TYPE_MOD_PRIVATE
)

7319 
ty≥_mod1
 &~
TYPE_MOD_PUBLIC
;

7320 i‡(
fun˘i⁄_ty≥_mod_found
 & 
TYPE_MOD_PUBLIC
)

7321 
ty≥_mod1
 &~
TYPE_MOD_PRIVATE
;

7322 
fun˘i⁄_ty≥_mod_found
 |
ty≥_mod1
;

7327 
fun˘i⁄_¥og_found
 = 0;

7332 
fc
[
globÆ_hash_vÆ
].
ç
 = 
¥og
->
id_numbî
;

7333 
fc
[
globÆ_hash_vÆ
].
‚
 = 
«me
;

7334 
fc
[
globÆ_hash_vÆ
].
ff_öh
 = -1;

7337 #ifde‡
CACHE_STATS


7338 
£¨ches_√eded
 +
¥og
->
num_öhîôed
;

7340 
i
 = 
¥og
->
num_öhîôed
 - 1;

7341 
˝rog
 = 
¥og
;

7346 #ifde‡
CACHE_STATS


7347 
£¨ches_d⁄e
++;

7349 i‡(
˝rog
->
num_fun˘i⁄s
)

7353 
¥obe
 = 
	`PTR_HASH
(
«me
, 
˝rog
->
num_fun˘i⁄s
);

7356 
«me
 !
˝rog
->
func_hash
[
¥obe
].name &&Örobe >= 0)

7357 
¥obe
 = 
˝rog
->
func_hash
[¥obe].
√xt_hashed_fun˘i⁄
;

7359 i‡(
¥obe
 >= 0)

7361 
¥obe
 = 
˝rog
->
func_hash
[¥obe].
func_ödex
;

7365 i‡(--
i
 < 0)

7368 
˝rog
 = 
¥og
->
öhîô
[
i
].prog;

7374 #ifde‡
CACHE_STATS


7375 
£¨ches_√eded
 -
i
;

7378 #ifde‡
GLOBAL_CACHE


7379 
fc
[
globÆ_hash_vÆ
].
ff_öh
 =

7381 
fun˘i⁄_öhîô_found
 = 
i
;

7383 
fun˘i⁄_¥og_found
 = 
¥og
->
öhîô
[
i
].prog;

7384 #ifde‡
USE_SWAP


7385 
	`ac˚ss_¥ogøm
(
fun˘i⁄_¥og_found
);

7387 #ifde‡
GLOBAL_CACHE


7388 
fc
[
globÆ_hash_vÆ
].
ff_ix
 =

7390 
fun˘i⁄_ödex_found
 = 
¥obe
;

7392 
fun˘i⁄_ty≥_mod_found
 =

7393 
¥og
->
öhîô
[
i
].¥og->
fun˘i⁄s
[
¥obe
].
ty≥_Êags
 &

7394 
TYPE_MOD_MASK
 ;

7397 
ty≥_mod
 = 
¥og
->
öhîô
[
i
].
ty≥
;

7399 i‡(
fun˘i⁄_ty≥_mod_found
 & 
TYPE_MOD_PRIVATE
)

7400 
ty≥_mod
 &~
TYPE_MOD_PUBLIC
;

7401 i‡(
fun˘i⁄_ty≥_mod_found
 & 
TYPE_MOD_PUBLIC
)

7402 
ty≥_mod
 &~
TYPE_MOD_PRIVATE
;

7403 
fun˘i⁄_ty≥_mod_found
 |
ty≥_mod
;

7405 
	}
}

7407 
INLINE
 

7408 
	$£¨ch_f‹_fun˘i⁄
(*
«me
, 
¥ogøm
 *
¥og
)

7410  
	`s_f_f
(
	`föd_s°rög
(
«me
), 
¥og
);

7411 
	}
}

7446 #ifde‡
DEBUG


7447 
	gdebug_≠∂y_fun
[30];

7450 
	gglobˇche_åõs
 = 0, 
	gglobˇche_hôs
 = 0, 
	gfunm≠_åõs
 = 0;

7455 
	$≠∂y_low
(*
fun
, 
obje˘
 *
ob
, 
num_¨g
, 
exã∫Æ
)

7457 
¥ogøm
 *
¥ogp
;

7458 *
sfun
;

7465 #ifde‡
DEBUG


7466 ()
	`°∫˝y
(
debug_≠∂y_fun
, 
fun
,  debug_apply_fun);

7467 
debug_≠∂y_fun
[ debug_apply_fun - 1] = '\0';

7469 i‡(*
fun
 == '.')

7470 
Áûuª
;

7476 
ob
->
shadowed
 && ob->shadowed !
cuºít_obje˘
)

7477 
ob
 = ob->
shadowed
;

7479 
sfun
 = 
	`föd_s°rög
(
fun
);

7481 
ªåy_f‹_shadow
:

7482 
¥ogp
 = 
ob
->
¥og
;

7484 #ifde‡
DEBUG


7485 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

7486 
	`Áèl
("apply() on destructed object\n");

7488 i‡(!(
ob
->
Êags
 & 
O_CREATED
))

7489 
	`¸óã_obje˘
(
ob
);

7490 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

7491 
Áûuª
;

7493 i‡(
	`s_f_f
(
sfun
, 
¥ogp
))

7496 i‡(((
ob
 !
cuºít_obje˘
 || 
exã∫Æ
) &&

7497 
fun˘i⁄_ty≥_mod_found
 & (
TYPE_MOD_STATIC
 | 
TYPE_MOD_PRIVATE
)) ||

7498 (
fun˘i⁄_ty≥_mod_found
 & 
TYPE_MOD_PRIVATE
 &&

7499 
fun˘i⁄_¥og_found
 !
ob
->
¥og
))

7503 
	`ˇŒ_fun˘i⁄
(
ob
, 
fun˘i⁄_öhîô_found
,

7504 ()
fun˘i⁄_ödex_found
, 
num_¨g
);

7513 i‡(
ob
->
shadowög
)

7519 
ob
 = ob->
shadowög
;

7520 
ªåy_f‹_shadow
;

7522 
Áûuª
:

7524 
	`p›_n_ñems
(
num_¨g
);

7526 
	}
}

7538 
svÆue
 *

7539 
	$ßµly
(*
fun
, 
obje˘
 *
ob
, 
num_¨g
, 
ext
)

7542 #ifde‡
DEBUG


7543 
svÆue
 *
ex≥˘ed_•
;

7545 
svÆue
 
ªt_vÆue
 = { 
T_NUMBER
 };

7547 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


7548 i‡(
fun
 =
NULL
) {

7549 
	`‰ì_svÆue
(&
ªt_vÆue
);

7550  
NULL
;

7554 #ifde‡
TRACE_CODE


7555 i‡(
	`TRACEP
(
TRACE_APPLY
))

7557 
buff
[1024];

7558 ()
	`•rötf
(
buff
,"%s->%s", 
ob
->
«me
, 
fun
);

7559 
	`do_åa˚
("Apply", "", "\n");

7563 #ifde‡
DEBUG


7564 
ex≥˘ed_•
 = 
•
 - 
num_¨g
;

7566 i‡(!
ob
 || (ob->
Êags
 & 
O_DESTRUCTED
)) {

7567 
	`p›_n_ñems
(
num_¨g
);

7571 i‡(
	`≠∂y_low
(
fun
, 
ob
, 
num_¨g
, 
ext
) == 0)

7573 
	`assign_svÆue
(&
ªt_vÆue
, 
•
);

7574 
	`p›_°ack
();

7575 #ifde‡
DEBUG


7576 i‡(
ex≥˘ed_•
 !
•
)

7577 
	`Áèl
("Corrupt stackÖointer.\n");

7579  &
ªt_vÆue
;

7580 
	}
}

7583 
svÆue
 *

7584 
	$≠∂y
(*
fun
, 
obje˘
 *
ob
, 
num_¨g
, 
ext
)

7586 
åa˚dïth
 = 0;

7587  
	`ßµly
(
fun
, 
ob
, 
num_¨g
, 
ext
);

7588 
	}
}

7596 
	$fun˘i⁄_exi°s
(*
fun
, 
obje˘
 *
ob
)

7598 #ifde‡
DEBUG


7599 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

7600 
	`Áèl
("function_exists() on destructed object\n");

7602 i‡(*
fun
 == '.')

7604 i‡–
	`£¨ch_f‹_fun˘i⁄
 (
fun
, 
ob
->
¥og
)

7605 && (!(
fun˘i⁄_ty≥_mod_found
 & (
TYPE_MOD_STATIC
|
TYPE_MOD_PRIVATE
))

7606 || 
cuºít_obje˘
 =
ob
) )

7607  
fun˘i⁄_¥og_found
->
«me
;

7610 
	}
}

7619 
	$ˇŒ_fun˘i⁄
(
obje˘
 *
ob
, 
öh_ödex
, 
fun
, 
num_¨g
)

7621 *
˝
;

7622 
fun˘i⁄
 *
fu≈
;

7623 
¥ogøm
 *
¥ogp
;

7625 i‡(
öh_ödex
 < 0 || inh_ödex >()
ob
->
¥og
->
num_öhîôed
 ||

7626 
fun
 >
ob
->
¥og
->
öhîô
[
öh_ödex
].¥og->
num_fun˘i⁄s
)

7629 
	`p›_n_ñems
(
num_¨g
);

7630 
	`push_numbî
(0);

7633 
¥ogp
 = 
ob
->
¥og
->
öhîô
[
öh_ödex
].prog;

7634 #ifde‡
USE_SWAP


7635 
	`ac˚ss_¥ogøm
(
¥ogp
);

7637 
fu≈
 = &
¥ogp
->
fun˘i⁄s
[
fun
];

7639 i‡(
fu≈
->
ty≥_Êags
 & 
NAME_PROTOTYPE
)

7642 
	`push_c⁄åﬁ_°ack
(
fu≈
);

7643 
c•
->
ext_ˇŒ
 = 1;

7644 
c•
->
num_loˇl_v¨übÀs
 = 
num_¨g
;

7645 
cuºít_¥og
 = 
¥ogp
;

7646 
öh_off£t
 = 
öh_ödex
;

7647 
¥evious_ob
 = 
cuºít_obje˘
;

7648 
cuºít_obje˘
 = 
ob
;

7649 #ifde‡
DEBUG


7650 i‡(
cuºít_obje˘
->
¥og
->
öhîô
[
öh_off£t
].¥og !
cuºít_¥og
)

7651 
	`Áèl
("Corrupt inherit offset!\n");

7653 
˝
 = 
	`£tup_√w_‰ame
(
fu≈
);

7654 
c•
->
exã∫_ˇŒ
 = 1;

7655 
	`evÆ_ö°ru˘i⁄
(
˝
);

7656 
	}
}

7663 
	$ö√r_gë_§ccode_posôi⁄
(
code
, *
löío
, 
löío_size
,

7664 *
öc_fûes
, *
«me
)

7666 
cur_code
, 
cur_löe
, 
cur_fûe
, 
i
;

7667 
l
;

7668 *
°
;

7669 
buff
[200];

7671 
i
 = 0;

7672 
cur_code
 = 
cur_fûe
 = 0;

7673 
cur_löe
 = 1;

7674 
code
--;

7676 
cur_code
 < 
code
 && 
i
 < 
löío_size
)

7677 
l
 = ()
löío
[
i
++]) {

7685 
cur_löe
 +
l
 & 0x7;

7694 
cur_löe
 -
l
 & 0x7;

7697 
cur_fûe
 = 
löío
[
i
++] & 0xFF;

7700 
cur_löe
 = ((
löío
[
i
] & 0xFF) << 8) + (lineno[i + 1] & 0xFF);

7701 
i
 += 2;

7704 
l
 = 0xF0;

7707 
cur_code
 +
l
;

7708 
cur_löe
++;

7712 
cur_löe
--;

7713 i‡(
cur_fûe
 == 0)

7714 
°
 = 
«me
;

7721 
°
 = 
öc_fûes
;

7722 
cur_fûe
 > 1) {

7723 
°
 +
	`°æí
(st) + 1;

7724 
cur_fûe
--;

7726 
°
 = 
	`°rchr
(st, ':');

7727 
°
++;

7730 ()
	`•rötf
(
buff
, "/%†Löe: %d", 
°
, 
cur_löe
);

7731  
buff
;

7732 
	}
}

7735 
	$gë_§ccode_posôi⁄
(
off£t
, 
¥ogøm
 *
¥ogp
)

7737 *
ªt
;

7739 i‡(
¥ogp
 == 0)

7742 #ifde‡
DEBUG


7743 i‡(
off£t
 > 
¥ogp
->
¥ogøm_size
)

7744 
	`Áèl
("IŒegÆ off£à%d i¿obje˘ %s\n", 
off£t
, 
¥ogp
->
«me
);

7746 #ifde‡
USE_SWAP


7747 
	`lﬂd_löío_‰om_sw≠
(
¥ogp
);

7750 
ªt
 = 
	`ö√r_gë_§ccode_posôi⁄
(
off£t
, 
¥ogp
->
löe_numbîs
,

7751 
¥ogp
->
sizeof_löe_numbîs
,

7752 
¥ogp
->
ö˛ude_fûes
,

7753 
¥ogp
->
«me
);

7754 #ifde‡
USE_SWAP


7755 i‡(
¥ogp
->
sw≠_löío_ödex
 > 0)

7756 
	`sw≠_löío
(
¥ogp
);

7759  
ªt
;

7760 
	}
}

7767 
	$dump_åa˚
(
how
)

7769 
c⁄åﬁ_°ack
 *
p
;

7770 *
ªt
 = 0;

7771 #i‡
	`deföed
(
DEBUG
Ë&& deföed(
TRACE_CODE
)

7772 
	`œ°_ö°ru˘i⁄s
 ();

7774 *
löe
;

7776 i‡(
cuºít_¥og
 == 0)

7778 i‡(
c•
 < &
c⁄åﬁ_°ack
[0])

7780 (Ë
	`¥ötf
("NoÅrace.\n");

7781 
	`debug_mesßge
("NoÅrace.\n");

7784 #i‡
	`deföed
(
DEBUG
Ë&& deföed(
TRACE_CODE
)

7785 i‡(
how
)

7786 (Ë
	`œ°_ö°ru˘i⁄s
();

7787 #ñi‡
	`deföed
(
löt
)

7788 i‡(
how
)

7791 
p
 = &
c⁄åﬁ_°ack
[0];Ö < 
c•
;Ö++)

7793 
	#FORM
 "%-15†ö /%s\¿ /%s\¿ %s\n"

	)

7794 
löe
 = 
	`gë_§ccode_posôi⁄
(()
p
[1].
pc
,Ö[1].
¥og
);

7795 
	`debug_mesßge
(
FORM
,

7796 
p
[0].
fu≈
 ?Ö[0].fu≈->
«me
 : "CATCH",

7797 
p
[1].
¥og
->
«me
,Ö[1].
ob
->name,

7798 
löe
);

7799 i‡(
p
->
fu≈
 && 
	`°rcmp
’->fu≈->
«me
, "heart_beat") == 0)

7800 
ªt
 = 
p
->
ob
?p->ob->
«me
:0;

7802 
löe
 = 
	`gë_§ccode_posôi⁄
(
pc
 - 
cuºít_¥og
->
¥ogøm
,

7803 
cuºít_¥og
);

7804 
	`debug_mesßge
(
FORM
,

7805 
p
[0].
fu≈
 ?Ö[0].fu≈->
«me
 : "CATCH",

7806 
cuºít_¥og
->
«me
, 
cuºít_obje˘
->name,

7807 
löe
);

7808  
ªt
;

7809 
	}
}

7812 
	$gë_§ccode_posôi⁄_if_™y
()

7814 *
ªt
 = "";

7816 i‡(
cuºít_¥og
)

7817 
ªt
 = (*)
	`gë_§ccode_posôi⁄
(
pc
 - 
cuºít_¥og
->
¥ogøm
, current_prog);

7819  
ªt
;

7820 
	}
}

7823 
	$föd_≥r˚¡
(*
°r
)

7827 
°r
 = 
	`°rchr
(str, '%');

7828 i‡(
°r
 == 0)

7830 i‡(
°r
[1] != '%')

7831  
°r
;

7832 
°r
++;

7834 
	}
}

7837 
	$öãr_ssˇnf
(
num_¨g
)

7839 *
fmt
;

7840 *
ö_°rög
;

7841 
numbî_of_m©ches
;

7842 *
˝
;

7843 
svÆue
 *
¨g
 = 
•
 - 
num_¨g
 + 1;

7848 i‡(
¨g
[0].
ty≥
 !
T_STRING
)

7849 
	`bad_¨g
(1, 
F_SSCANF
, &
¨g
[0]);

7850 
ö_°rög
 = 
¨g
[0].
u
.
°rög
;

7851 i‡(
ö_°rög
 == 0)

7856 i‡(
¨g
[1].
ty≥
 !
T_STRING
)

7857 
	`bad_¨g
(2, 
F_SSCANF
, &
¨g
[1]);

7858 
fmt
 = 
¨g
[1].
u
.
°rög
;

7862 
˝
 = 
	`föd_≥r˚¡
(
fmt
); fmà!˝; fmt++, 
ö_°rög
++)

7864 i‡(
ö_°rög
[0] ='\0' || 
fmt
[0] != in_string[0])

7871 
num_¨g
 -= 2;

7872 
¨g
 += 2;

7873 
numbî_of_m©ches
 = 0; 
num_¨g
 > 0;

7875 
numbî_of_m©ches
++, 
num_¨g
--, 
¨g
++)

7877 
i
, 
ty≥
;

7879 i‡(
fmt
[0] == '\0')

7886 i‡(
ö_°rög
[0])

7888 
	`‰ì_svÆue
(
¨g
->
u
.
lvÆue
);

7889 
¨g
->
u
.
lvÆue
->
ty≥
 = 
T_STRING
;

7890 
¨g
->
u
.
lvÆue
->u.
°rög
 = 
	`make_m°rög
(
ö_°rög
);

7891 
¨g
->
u
.
lvÆue
->
°rög_ty≥
 = 
STRING_MSTRING
;

7892 
numbî_of_m©ches
++;

7896 #ifde‡
DEBUG


7897 i‡(
fmt
[0] != '%')

7898 
	`Áèl
("Should beá %%Çow !\n");

7900 
ty≥
 = 
T_STRING
;

7901 i‡(
fmt
[1] == 'd')

7902 
ty≥
 = 
T_NUMBER
;

7903 i‡(
fmt
[1] == 'f')

7904 
ty≥
 = 
T_FLOAT
;

7905 i‡(
fmt
[1] != 's')

7906 
	`îr‹
("BadÅy≥ : '%%%c' i¿ssˇn‡fmà°rög.\n", 
fmt
[1]);

7907 
fmt
 += 2;

7912 i‡(
ty≥
 =
T_NUMBER
)

7914 *
tmp
 = 
ö_°rög
;

7915 
tmp_num
;

7917 
tmp_num
 = (Ë
	`°πﬁ
(
ö_°rög
, &in_string, 10);

7918 if(
tmp
 =
ö_°rög
)

7923 
	`‰ì_svÆue
(
¨g
->
u
.
lvÆue
);

7924 
¨g
->
u
.
lvÆue
->
ty≥
 = 
T_NUMBER
;

7925 
¨g
->
u
.
lvÆue
->u.
numbî
 = 
tmp_num
;

7926 
fmt
[0] && fmt[0] =
ö_°rög
[0])

7927 
fmt
++, 
ö_°rög
++;

7928 i‡(
fmt
[0] != '%')

7930 
numbî_of_m©ches
++;

7935 i‡(
ty≥
 =
T_FLOAT
)

7937 
	`°πod
(const *, **);

7938 *
tmp
 = 
ö_°rög
;

7939 
tmp_num
;

7941 
tmp_num
 = 
	`chkÊﬂå™ge
(
	`°πod
(
ö_°rög
, &in_string));

7942 if(
tmp
 =
ö_°rög
)

7947 
	`‰ì_svÆue
(
¨g
->
u
.
lvÆue
);

7948 
¨g
->
u
.
lvÆue
->
ty≥
 = 
T_FLOAT
;

7949 
¨g
->
u
.
lvÆue
->u.
ªÆ
 = 
tmp_num
;

7950 
fmt
[0] && fmt[0] =
ö_°rög
[0])

7951 
fmt
++, 
ö_°rög
++;

7952 i‡(
fmt
[0] != '%')

7954 
numbî_of_m©ches
++;

7962 
˝
 = 
	`föd_≥r˚¡
(
fmt
);

7963 i‡(
˝
 =
fmt
)

7964 
	`îr‹
("IllegalÅo have 2ádjacent %%s in fmt string in sscanf.\n");

7965 i‡(
˝
 == 0)

7966 
˝
 = 
fmt
 + 
	`°æí
(fmt);

7971 i‡(
˝
 =
fmt
)

7973 
	`‰ì_svÆue
(
¨g
->
u
.
lvÆue
);

7975 
¨g
->
u
.
lvÆue
->
ty≥
 = 
T_STRING
;

7976 
¨g
->
u
.
lvÆue
->u.
°rög
 = 
	`make_m°rög
(
ö_°rög
);

7977 
¨g
->
u
.
lvÆue
->
°rög_ty≥
 = 
STRING_MSTRING
;

7978 
numbî_of_m©ches
++;

7981 
i
 = 0; 
ö_°rög
[i]; i++)

7983 i‡(
	`°∫cmp
(
ö_°rög
+
i
, 
fmt
, (
size_t
)(
˝
 - fmt)) == 0)

7985 *
m©ch
;

7989 
m©ch
 = 
	`Æloˇã_m°rög
((
size_t
)
i
);

7990 (Ë
	`°∫˝y
(
m©ch
, 
ö_°rög
, (
size_t
)
i
);

7991 
ö_°rög
 +
i
 + 
˝
 - 
fmt
;

7992 
m©ch
[
i
] = '\0';

7993 
	`‰ì_svÆue
(
¨g
->
u
.
lvÆue
);

7994 
¨g
->
u
.
lvÆue
->
ty≥
 = 
T_STRING
;

7995 
¨g
->
u
.
lvÆue
->
°rög_ty≥
 = 
STRING_MSTRING
;

7996 
¨g
->
u
.
lvÆue
->u.
°rög
 = 
m©ch
;

7997 
fmt
 = 
˝
;

8001 i‡(
fmt
 =
˝
)

8009  
numbî_of_m©ches
;

8010 
	}
}

8013 #ifde‡
OPCPROF


8015 
	$›cdump
()

8017 
i
;

8019 
i
 = 0; i < 
MAXOPC
; i++)

8020 i‡(
›cou¡
[
i
])

8021 ()
	`Ârötf
(
°dîr
, "%-20†%12d: %12d\n", 
	`gë_f_«me
(
i
), i,

8022 
›cou¡
[
i
]);

8023 
	}
}

8030 
	$ª£t_machöe
(
fú°
)

8032 
c•
 = 
c⁄åﬁ_°ack
 - 1;

8033 i‡(
fú°
)

8034 
•
 = 
°¨t_of_°ack
 - 1;

8036 
	`p›_n_ñems
(
•
 - 
°¨t_of_°ack
 + 1);

8037 
	}
}

8039 #i‡
deföed
(
DEBUG
Ë&& deföed(
TRACE_CODE
)

8041 
	$gë_¨g
(
a
, 
b
)

8043 
buff
[10];

8044 *
‰om
, *
to
;

8046 
‰om
 = 
¥evious_pc
[
a
];

8047 
to
 = 
¥evious_pc
[
b
];

8048 i‡(
to
 - 
‰om
 < 2)

8050 i‡(
to
 - 
‰om
 == 2)

8052 ()
	`•rötf
(
buff
, "%d", 
‰om
[1]);

8053  
buff
;

8055 i‡(
to
 - 
‰om
 == 3)

8057 
¨g
;

8058 ((*)&
¨g
)[0] = 
‰om
[1];

8059 ((*)&
¨g
)[1] = 
‰om
[2];

8060 ()
	`•rötf
(
buff
, "%d", 
¨g
);

8061  
buff
;

8063 i‡(
to
 - 
‰om
 == 5)

8065 
¨g
;

8066 ((*Ë&
¨g
)[0] = 
‰om
[1];

8067 ((*Ë&
¨g
)[1] = 
‰om
[2];

8068 ((*Ë&
¨g
)[2] = 
‰om
[3];

8069 ((*Ë&
¨g
)[3] = 
‰om
[4];

8070 ()
	`•rötf
(
buff
, "%d", 
¨g
);

8071  
buff
;

8074 
	}
}

8077 
	$œ°_ö°ru˘i⁄s
()

8079 
i
;

8080 
i
 = 
œ°
;

8083 i‡(
¥evious_ö°ru˘i⁄
[
i
] != 0)

8084 ()
	`¥ötf
("%6lx: %3d%*s %8s %-25s (%d)\n",

8085 ()
¥evious_pc
[
i
],

8086 
¥evious_ö°ru˘i⁄
[
i
],

8087 
cuπø˚dïth
[
i
],"",

8088 
	`gë_¨g
(
i
, (i+1) %

8089 ( 
¥evious_ö°ru˘i⁄
 /  ())),

8090 
	`gë_f_«me
(
¥evious_ö°ru˘i⁄
[
i
]),

8091 
°ack_size
[
i
] + 1);

8092 
i
 = (ò+ 1Ë% ( 
¥evious_ö°ru˘i⁄
 /  ());

8093 } 
i
 !
œ°
);

8094  
œ°
;

8095 
	}
}

8099 #ifde‡
DEBUG


8102 
	$cou¡_öhîôs
(
¥ogøm
 *
¥ogp
, ¥ogøm *
£¨ch_¥og
)

8104 
i
;

8107 i‡(
¥ogp
->
exåa_ªf
 != 1)

8109 
i
 = 0; i < 
¥ogp
->
num_öhîôed
; i++)

8111 
¥ogp
->
öhîô
[
i
].
¥og
->
exåa_ªf
++;

8112 i‡(
¥ogp
->
öhîô
[
i
].
¥og
 =
£¨ch_¥og
)

8113 ()
	`¥ötf
("FoundÖrog, inhîôed by %s\n", 
¥ogp
->
«me
);

8114 
	`cou¡_öhîôs
(
¥ogp
->
öhîô
[
i
].
¥og
, 
£¨ch_¥og
);

8116 
	}
}

8119 
	$cou¡_ªf_ö_ve˘‹
(
svÆue
 *
svp
, 
num
)

8121 
svÆue
 *
p
;

8123 
p
 = 
svp
;Ö < sv∞+ 
num
;Ö++)

8125 
p
->
ty≥
)

8127 
T_OBJECT
:

8128 
p
->
u
.
ob
->
exåa_ªf
++;

8130 
T_POINTER
:

8131 
	`cou¡_ªf_ö_ve˘‹
(&
p
->
u
.
vec
->
ôem
[0],Ö->u.vec->
size
);

8132 
p
->
u
.
vec
->
exåa_ªf
++;

8136 
	}
}

8142 
	$˛ór_ve˘‹_ªfs
(
svÆue
 *
svp
, 
num
)

8144 
svÆue
 *
p
;

8146 
p
 = 
svp
;Ö < sv∞+ 
num
;Ö++)

8148 
p
->
ty≥
)

8150 
T_POINTER
:

8151 
	`˛ór_ve˘‹_ªfs
(&
p
->
u
.
vec
->
ôem
[0],Ö->u.vec->
size
);

8152 
p
->
u
.
vec
->
exåa_ªf
 = 0;

8156 
	}
}

8164 
	$check_a_lŸ_ªf_cou¡s
(
¥ogøm
 *
£¨ch_¥og
)

8166 
obje˘
 *
ma°î_ob
;

8167 
obje˘
 *
ob
;

8168 #ifde‡
USE_SWAP


8169 
obje˘
 *
sw≠_ob
;

8175 
ob
 = 
obj_li°
;

8178 
ob
->
exåa_ªf
 = 0;

8179 
ob
->
¥og
->
exåa_ªf
 = 0;

8180 #ifde‡
USE_SWAP


8181 i‡(
ob
->
Êags
 & 
O_SWAPPED
)

8182 
	`lﬂd_ob_‰om_sw≠
(
ob
);

8185 
	`˛ór_ve˘‹_ªfs
(
ob
->
v¨übÀs
, ob->
¥og
->
num_v¨übÀs
 +

8186 
ob
->
¥og
->
öhîô
[ob->¥og->
num_öhîôed
 - 1]

8187 .
v¨übÀ_ödex_off£t
);

8188 
ob
 = ob->
√xt_Æl
;

8189 } 
ob
 !
obj_li°
);

8190 #ifde‡
USE_SWAP


8191 
sw≠_ob
 = 
obj_li°
->
¥ev_Æl
;

8194 
	`˛ór_ve˘‹_ªfs
(
°¨t_of_°ack
, 
•
 - start_of_stack + 1);

8203 
ob
 = 
obj_li°
; ob; ob = ob->
√xt_Æl
)

8205 
ob
->
exåa_ªf
++;

8206 
	`cou¡_ªf_ö_ve˘‹
(
ob
->
v¨übÀs
, ob->
¥og
->
num_v¨übÀs
 +

8207 
ob
->
¥og
->
öhîô
[ob->¥og->
num_öhîôed
 - 1]

8208 .
v¨übÀ_ödex_off£t
);

8209 
ob
->
¥og
->
exåa_ªf
++;

8210 i‡(
ob
->
¥og
 =
£¨ch_¥og
)

8211 ()
	`¥ötf
("FoundÖrogøm f‹ obje˘ %s\n", 
ob
->
«me
);

8213 i‡(
ob
->
¥og
->
exåa_ªf
 == 1)

8214 
	`cou¡_öhîôs
(
ob
->
¥og
, 
£¨ch_¥og
);

8220 
	`cou¡_ªf_ö_ve˘‹
(
°¨t_of_°ack
, 
•
 - start_of_stack + 1);

8221 
	`upd©e_ªf_cou¡s_f‹_∂ayîs
();

8222 
	`cou¡_ªf_‰om_ˇŒ_outs
();

8223 i‡(
ma°î_ob
)

8224 
ma°î_ob
->
exåa_ªf
++;

8226 i‡(
£¨ch_¥og
)

8232 
ob
 = 
obj_li°
; ob; ob = ob->
√xt_Æl
)

8234 i‡(
ob
->
ªf
 !ob->
exåa_ªf
)

8235 
	`Áèl
("BadÑe‡cou¡ i¿obje˘ %s, %d - %d\n", 
ob
->
«me
,

8236 
ob
->
ªf
, ob->
exåa_ªf
);

8237 i‡(
ob
->
¥og
->
ªf
 !ob->¥og->
exåa_ªf
)

8239 
	`check_a_lŸ_ªf_cou¡s
(
ob
->
¥og
);

8240 
	`Áèl
("BadÑe‡cou¡ i¿¥og %s, %d - %d\n", 
ob
->
¥og
->
«me
,

8241 
ob
->
¥og
->
ªf
, ob->¥og->
exåa_ªf
);

8244 
	}
}

8248 #ifde‡
TRACE_CODE


8251 
	$do_åa˚
(*
msg
, *
‚ame
, *
po°
)

8253 
buf
[10000], *
p
;

8254 *
obj«me
;

8256 
obj«me
 = 
	`TRACETST
(
TRACE_OBJNAME
Ë? (
cuºít_obje˘
 && cuºít_obje˘->
«me
 ? current_object->name : "??") : "";

8257 ()
	`•rötf
(
buf
, "*** %d %*†%†%†%s", 
åa˚dïth
,Åø˚dïth, "", 
msg
, 
obj«me
, 
‚ame
);

8258 
p
 = 
buf
 + 
	`°æí
(buf);

8259 i‡(
	`TRACETST
(
TRACE_TOS
)) {

8260 ()
	`°r˝y
(
p
, 
	`°rög_¥öt_f‹m©ãd
(0, " *•=%O", 1, 
•
));

8261 
p
 +
	`°æí
(p);

8263 ()
	`°r˝y
(
p
, 
po°
);

8264 
	`wrôe_sockë
(
buf
, 
comm™d_givî
);

8265 
	}
}

8269 
	$ªsﬁve_èbÀ
(
¥ogøm
 *
¥og
, 
fk¡ab
 *
èb
)

8271 
i
;

8273 
i
 = 0; 
èb
[i].
«me
; i++)

8275 i‡(
	`£¨ch_f‹_fun˘i⁄
(
èb
[
i
].
«me
, 
¥og
))

8277 
èb
[
i
].
öhîô_ödex
 = 
fun˘i⁄_öhîô_found
;

8278 
èb
[
i
].
fun˘i⁄_ödex
 = 
fun˘i⁄_ödex_found
;

8282 
èb
[
i
].
öhîô_ödex
 = ()-1;

8283 
èb
[
i
].
fun˘i⁄_ödex
 = ()-1;

8286 
	}
}

8288 
	~"ma°î.t
"

8290 
svÆue
 *

8291 
	$≠∂y_ma°î_ob
(
fun
, 
num_¨g
)

8293 
obje˘
 *
ma°î_ob
;

8294 
svÆue
 
ªtvÆ
 = { 
T_NUMBER
 };

8296 i‡(
s_Êag
)

8297 
num_mˇŒ
++;

8298 i‡(!
ma°î_ob
 || (
ma°î_fk¡ab
[
fun
].
öhîô_ödex
 == ()-1 &&

8299 
ma°î_fk¡ab
[
fun
].
fun˘i⁄_ödex
 == ()-1))

8301 
	`p›_n_ñems
(
num_¨g
);

8304 
	`ˇŒ_fun˘i⁄
(
ma°î_ob
, 
ma°î_fk¡ab
[
fun
].
öhîô_ödex
,

8305 ()
ma°î_fk¡ab
[
fun
].
fun˘i⁄_ödex
, 
num_¨g
);

8307 
	`assign_svÆue
(&
ªtvÆ
, 
•
);

8308 
	`p›_°ack
();

8309  &
ªtvÆ
;

8310 
	}
}

8313 
	$ma°î_ob_lﬂded
()

8315 
obje˘
 *
ma°î_ob
;

8317 
	`ªsﬁve_èbÀ
(
ma°î_ob
->
¥og
, 
ma°î_fk¡ab
);

8318 
	`lﬂd_∑r£_öf‹m©i⁄
();

8319 
	}
}

8328 
	$ªmove_obje˘_‰om_°ack
(
obje˘
 *
ob
)

8330 
svÆue
 *
svp
;

8332 
svp
 = 
°¨t_of_°ack
; sv∞<
•
; svp++)

8334 i‡(
svp
->
ty≥
 !
T_OBJECT
)

8336 i‡(
svp
->
u
.
ob
 != ob)

8338 
	`‰ì_obje˘
(
svp
->
u
.
ob
, "remove_object_from_stack");

8339 
svp
->
ty≥
 = 
T_NUMBER
;

8340 
svp
->
u
.
numbî
 = 0;

8342 
	}
}

8344 
	$°ack_sw≠_obje˘s
(
obje˘
 *
ob1
, obje˘ *
ob2
)

8346 
c⁄åﬁ_°ack
 *
c•i
;

8348 i‡(
cuºít_obje˘
 =
ob1
)

8349 
cuºít_obje˘
 = 
ob2
;

8350 i‡(
cuºít_obje˘
 =
ob2
)

8351 
cuºít_obje˘
 = 
ob1
;

8353 i‡(
¥evious_ob
 =
ob1
)

8354 
¥evious_ob
 = 
ob2
;

8355 i‡(
¥evious_ob
 =
ob2
)

8356 
¥evious_ob
 = 
ob1
;

8358 
c•i
 = 
c•
; c•ò>
c⁄åﬁ_°ack
; cspi--)

8360 i‡(
c•i
->
ob
 =
ob1
)

8361 
c•i
->
ob
 = 
ob2
;

8362 i‡(
c•i
->
ob
 =
ob2
)

8363 
c•i
->
ob
 = 
ob1
;

8365 i‡(
c•i
->
¥ev_ob
 =
ob1
)

8366 
c•i
->
¥ev_ob
 = 
ob2
;

8367 i‡(
c•i
->
¥ev_ob
 =
ob2
)

8368 
c•i
->
¥ev_ob
 = 
ob1
;

8370 
	}
}

8372 #ifde‡
TRACE_CODE


8374 
	$°Ωªf
(*
p
, *
s
)

8376 *
p
)

8377 i‡(*
p
++ !*
s
++)

8380 
	}
}

8384 
	$ˇŒ_efun
(
ö°ru˘i⁄
, 
numa
)

8386 i‡(
ö°ru˘i⁄
 < 
EFUN_FIRST
 || in°ru˘i⁄ > 
EFUN_LAST
)

8387 
	`Áèl
("Undeföed in°ru˘i⁄ %†(%d)\n", 
	`gë_f_«me
(
ö°ru˘i⁄
),

8388 
ö°ru˘i⁄
);

8389 
ö°ru˘i⁄
 -
EFUN_FIRST
;

8390 i‡(
ö°rs
[
ö°ru˘i⁄
].
mö_¨g
 !ö°rs[ö°ru˘i⁄].
max_¨g
) {

8391 i‡(
ö°rs
[
ö°ru˘i⁄
].
mö_¨g
 != -1 &&

8392 
ö°rs
[
ö°ru˘i⁄
].
mö_¨g
 > 
numa
)

8393 
	`îr‹
("Too fewárgumentsÅoÉfun.\n");

8394 i‡(
ö°rs
[
ö°ru˘i⁄
].
max_¨g
 != -1 &&

8395 
ö°rs
[
ö°ru˘i⁄
].
max_¨g
 < 
numa
)

8396 
	`îr‹
("Too manyárgumentsÅoÉfun.\n");

8398 i‡(
numa
 !
ö°rs
[
ö°ru˘i⁄
].
mö_¨g
) {

8399 ()
	`Ârötf
(
°dîr
, "call_efun %dÇuma=%d min_arg=%d\n",

8400 
ö°ru˘i⁄
, 
numa
, 
ö°rs
[ö°ru˘i⁄].
mö_¨g
);

8401 
	`îr‹
("BadÇumber ofárgumentsÅoÉfun.\n");

8404 i‡(
numa
 > 0) {

8405 
ty≥1
 = (
•
-
numa
+1)->
ty≥
, 
ty≥2
 = (sp-numa+2)->type;

8406 i‡(
ö°rs
[
ö°ru˘i⁄
].
ty≥
[0] != 0 &&

8407 (
ö°rs
[
ö°ru˘i⁄
].
ty≥
[0] & 
ty≥1
) == 0) {

8408 
	`bad_¨g
(1, 
ö°ru˘i⁄
 + 
EFUN_FIRST
, 
•
-
numa
+1);

8410 i‡(
numa
 > 1) {

8411 i‡(
ö°rs
[
ö°ru˘i⁄
].
ty≥
[1] != 0 &&

8412 (
ö°rs
[
ö°ru˘i⁄
].
ty≥
[1] & 
ty≥2
) == 0)

8413 
	`bad_¨g
(2, 
ö°ru˘i⁄
 + 
EFUN_FIRST
, 
•
-
numa
+2);

8416 
efun_èbÀ
[
ö°ru˘i⁄
](
numa
);

8417 
	}
}

	@interpret.h

1 
	#push_svÆue
(
vÆ
) \

3 i‡(
•
 + 1 >&
°¨t_of_°ack
[
EVALUATOR_STACK_SIZE
]) \

4 
	`îr‹
("Stack overflow\n"); \

5 
•
++; \

6 
	`assign_svÆue_no_‰ì
(
•
, 
vÆ
); \

7 }

	)

9 
svÆue
 *
•
;

10 
svÆue
 
°¨t_of_°ack
[];

12 
	uu
 {

13 *
	m°rög
;

14 
	mnumbî
;

15 
	mªÆ
;

16 
obje˘
 *
	mob
;

17 
ve˘‹
 *
	mvec
;

18 
svÆue
 *
	mlvÆue
;

19 
m≠pög
 *
	mm≠
;

20 
˛osuª
 *
	mfunc
;

28 
	ssvÆue
 {

29 
	mty≥
;

30 
	m°rög_ty≥
;

31 
u
 
	mu
;

34 
	#T_INVALID
 0x0

	)

35 
	#T_LVALUE
 0x1

	)

36 
	#T_NUMBER
 0x2

	)

37 
	#T_STRING
 0x4

	)

38 
	#T_POINTER
 0x8

	)

39 
	#T_OBJECT
 0x10

	)

40 
	#T_MAPPING
 0x20

	)

41 
	#T_FLOAT
 0x40

	)

42 
	#T_FUNCTION
 0x80

	)

44 
	#STRING_MSTRING
 0

	)

45 
	#STRING_SSTRING
 1

	)

46 
	#STRING_CSTRING
 2

	)

48 
	sve˘‹
 {

49 
	msize
;

50 
	mªf
;

51 #ifde‡
DEBUG


52 
	mexåa_ªf
;

54 
svÆue
 
	môem
[1];

57 
	#ALLOC_VECTOR
(
√Àm
) \

58 (
ve˘‹
 *)
	`xÆloc
( (vector) + \

59 (
svÆue
Ë* (
√Àm
 - 1))

	)

61 
	g ode_def
;

66 
	s˛osuª
 {

67 #ifde‡
FUNCDEBUG


68 
	mmagic
;

69 
	#FUNMAGIC
 0xdódbìf

	)

70 
˛osuª
 *
	m√xt
;

71 
obje˘
 *
	m‰om
;

73 
	mªf
;

74 
	mfu¡y≥
;

75 
	#FUN_LFUN
 1

	)

76 
	#FUN_SFUN
 2

	)

77 
	#FUN_EFUN
 3

	)

78 
	#FUN_LFUNO
 4

	)

79 
	#FUN_COMPOSE
 5

	)

80 
	#FUN_EMPTY
 6

	)

81 
	mfu¬o
, 
	mfunöh
;

82 
obje˘
 *
	mfunobj
;

83 
ve˘‹
 *
	mfu«rgs
;

94 
	sc⁄åﬁ_°ack
 {

95 
obje˘
 *
	mob
;

96 
obje˘
 *
	m¥ev_ob
;

97 
¥ogøm
 *
	m¥og
;

98 
	mnum_loˇl_v¨übÀs
;

99 
	mpc
;

100 
	mpc_ßve
;

101 
svÆue
 *
	mÂ
;

102 
	mexã∫_ˇŒ
;

103 
fun˘i⁄
 *
	mfu≈
;

104 
	möh_off£t
;

105 
	mext_ˇŒ
;

116 
	sgdex˚±i⁄
 {

117 
gdex˚±i⁄
 *
	me_ex˚±i⁄
;

118 
	me_ˇtch
;

119 
jmp_buf
 
	me_c⁄ãxt
;

122 
gdex˚±i⁄
 *
ex˚±i⁄
;

123 
svÆue
 
c⁄°0
, 
c⁄°1
, 
c⁄°em±y
;

125 
v¨übÀ_ödex_found
;

126 
v¨übÀ_öhîô_found
;

127 
v¨übÀ_ty≥_mod_found
;

129 
fun˘i⁄_ödex_found
;

130 
¥ogøm
 *
fun˘i⁄_¥og_found
;

131 
fun˘i⁄_ty≥_mod_found
;

132 
fun˘i⁄_öhîô_found
;

133 
c⁄åﬁ_°ack
 *
c•
;

135 
	#INCREF
(
x
Ëi‡(xËx++

	)

136 
	#DECREF
(
x
Ëi‡(xËx--

	)

138 
push_p›_îr‹_c⁄ãxt
(
push
);

139 
INLINE
 
p›_°ack
();

140 
INLINE
 
£¨ch_f‹_fun˘i⁄
(*
«me
, 
¥ogøm
 *
¥og
);

141 #i‡
deföed
(
RUSAGE
Ë&& deföed(
PROFILE_OBJS
)

142 
˛ór_˝u_°ack
();

144 
‰ì_˛osuª
(
˛osuª
 *
f
);

145 
push_c⁄åﬁ_°ack
(
fun˘i⁄
 *
fu≈
);

146 
p›_c⁄åﬁ_°ack
();

147 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


148 
˛ór_˛osuª_ˇche
();

155 
	tboﬁ_t
;

157 #i‚de‡
FALSE


158 
	#FALSE
 0

	)

160 #i‚de‡
TRUE


161 
	#TRUE
 1

	)

	@lex.c

1 
	~<°dio.h
>

2 
	~<˘y≥.h
>

3 
	~<°rög.h
>

4 
	~<°dlib.h
>

5 
	~<m©h.h
>

6 
	~<Êﬂt.h
>

8 
	~"c⁄fig.h
"

9 
	~"ö°rs.h
"

10 
	~"löt.h
"

11 
	~"œng.h
"

12 
	~"°rög.h
"

13 
	~"öãΩªt.h
"

14 
	~"exec.h
"

15 
	~"Àx.h
"

16 
	~"m°rög.h
"

17 
	~"mud°©.h
"

19 
	~"efun_èbÀ.h
"

21 
	#ißlunum
(
c
Ë(
	`iß um
(cË|| (cË='_')

	)

22 
	#NELEM
(
a
Ë( (aË/ (◊)[0]))

	)

24 
	#WARNING
 0

	)

25 
	#ERROR
 1

	)

27 
Áèl
(*
fmt
, ...);

29 
	gcuºít_löe
;

30 
	gtŸÆ_löes
;

31 *
	gcuºít_fûe
;

32 
	g¥agma_°ri˘_ty≥s
;

33 #ifde‡
BINARIES


34 
	g¥agma_ßve_bö¨y
;

36 
	g¥agma_no_˛⁄e
;

37 
	g¥agma_no_öhîô
;

38 
	g¥agma_no_shadow
;

39 
	g¥agma_ªsidít
;

41 
sm¨t_log
 (*, , *);

42 
Õc_¥edef_s
 *
	gÕc_¥edefs
=
NULL
;

43 
numbî
 (), 
ªÆ
 (), 
idít
 (*), 
°rög
 (*);

44 
i¶oˇl
 (*);

45 
h™dÀ_deföe
 (*);

46 
‰ì_deföes
 (), 
add_deföe
 (*, , *);

47 
ex∑nd_deföe
 ();

48 
add_öput
 (*);

49 
myungëc
 ();

50 
lookup_ªsw‹d
 (*);

51 
c⁄d_gë_exp
 ();

52 
exgëc
 ();

53 
ªfûl
 ();

54 
cmygëc
 ();

55 
yyÀx1
 ();

56 
skù_commít
 ();

57 
skù_commít2
 ();

58 
INLINE
 
mygëc
 ();

60 
FILE
 *
	gyyö
;

61 
	gÀx_Áèl
;

62 **
	göc_li°
;

63 
	göc_li°_size
;

66 
	#EXPANDMAX
 25000

	)

67 
	g√x∑nds
;

69 *
loˇl_«mes
[];

70 
loˇl_blockdïth
[];

71 
cuºít_numbî_of_loˇls
, 
s_Êag
;

73 *
tmp°rög_c›y
(*);

75 #i‚de‡
tﬁowî


76 
tﬁowî
 ();

79 
yyîr‹
(*), 
îr‹
(*, ...);

80 
yyÀx
 ();

82 
	#MAXLINE
 1024

	)

83 
	gyyãxt
[
MAXLINE
];

84 
	g¶a°
, 
	gœ°ch¨
;

85 
	gnum_öcfûes
, 
	gcuºít_öcfûe
, 
	göcdïth
;

87 
	sde‚
 {

88 
de‚
 *
	m√xt
;

89 *
	m«me
;

90 
	mundef
;

91 *
	mexps
;

92 
	m«rgs
;

94 
de‚
 *
lookup_deföe
(*);

96 
	sif°©e
 {

97 
if°©e
 *
	m√xt
;

98 
	m°©e
;

99 } *
	gi·›
 = 0;

100 
	#EXPECT_ELSE
 1

	)

101 
	#EXPECT_ENDIF
 2

	)

103 
	söc°©e
 {

104 
öc°©e
 *
	m√xt
;

105 
FILE
 *
	myyö
;

106 
	möc‚um
;

107 
	mlöe
;

108 *
	mfûe
;

109 
	m¶a°
, 
	mœ°ch¨
;

110 
	m¥agma_°ri˘_ty≥s
;

111 } *
	gö˘›
 = 0;

113 
	#DEFMAX
 10000

	)

114 
	gdefbuf
[
DEFMAX
];

115 
	gnbuf
;

116 *
	gouç
;

119 
	mtokí
;

120 
	mlöe
;

121 
YYSTYPE
 
	mlvÆ
;

122 } 
	gkìp1
, 
	gkìp2
, 
	gkìp3
, 
	gkìp4
;

125 
	$mîge
(*
«me
, *
de°
)

127 *
‰om
;

129 ()
	`°r˝y
(
de°
, 
cuºít_fûe
);

130 i‡–(
‰om
 = 
	`°ºchr
(
de°
, '/')Ë!
NULL
)

131 *
‰om
 = 0;

135 *
de°
 = 0;

137 
‰om
 = 
«me
;

138 *
‰om
 == '/')

140 
‰om
++;

141 *
de°
 = 0;

144 *
‰om
)

146 if(
	`°∫cmp
(
‰om
, "../", 3) == 0)

148 *
tmp
;

150 if(*
de°
 == 0)

152 
tmp
 = 
	`°ºchr
(
de°
, '/');

153 if(
tmp
 =
NULL
)

154 *
de°
 = 0;

156 *
tmp
 = 0;

157 
‰om
 +=3;

159 if(
	`°∫cmp
(
‰om
, "./", 2) == 0) {

160 
‰om
 += 2;

164 *
q
;

166 if(*
de°
)

167 ()
	`°rˇt
(
de°
, "/");

168 
q
 = 
	`°rchr
(
‰om
, '/');

170 if(
q
) {

171 *
‰om
=='/')

172 
‰om
++;

173 ()
	`°∫ˇt
(
de°
, 
‰om
, (
size_t
)(
q
 - from));

174 
‰om
 = 
q
 + 1; *from== '/'; from++)

180 ()
	`°rˇt
(
de°
, 
‰om
);

185 
	}
}

187 
INLINE
 

188 
	$mygëc
()

190 
c
;

192 i‡(
nbuf
)

194 
nbuf
--;

195 
c
 = *
ouç
++;

199 
c
 = 
	`gëc
(
yyö
);

201 
œ°ch¨
 = 
¶a°
;

202 
¶a°
 = 
c
;

204  
c
;

205 
	}
}

207 
INLINE
 

208 
	$gobbÀ
(
c
)

210 
d
;

211 
d
 = 
	`mygëc
();

212 i‡(
c
 =
d
)

214 *--
ouç
 = 
d
;

215 
nbuf
++;

217 
	}
}

220 
	$Àxîr‹
(*
s
)

222 
	`yyîr‹
(
s
);

223 
Àx_Áèl
++;

224 
	}
}

227 
	$Àxw¨nög
(*
°r
)

229 ()
	`Ârötf
(
°dîr
, "%s: W¨nög: %†löê%d\n", 
cuºít_fûe
, 
°r
,

230 
cuºít_löe
);

231 ()
	`fÊush
(
°dîr
);

232 
	`sm¨t_log
(
cuºít_fûe
, 
cuºít_löe
, 
°r
);

233 
	}
}

236 
	$skù_to
(*
tokí
, *
©okí
)

238 
b
[20], *
p
;

239 
c
;

240 
√°
;

242 
√°
 = 0;;)

244 
c
 = 
	`mygëc
();

245 i‡(
c
 == '#')

249 
c
 = 
	`mygëc
();

250 } 
	`is•a˚
(
c
));

251 
p
 = 
b
; 
c
 !'\n' && c !
EOF
; )

253 i‡(
p
 < 
b
+ b-1)

254 *
p
++ = 
c
;

255 
c
 = 
	`mygëc
();

257 *
p
++ = 0;

258 
p
 = 
b
; *∞&& !
	`is•a˚
(*p);Ö++)

260 *
p
 = 0;

262 i‡(
	`°rcmp
(
b
, "if") == 0 || strcmp(b, "ifdef") == 0 ||

263 
	`°rcmp
(
b
, "ifndef") == 0) {

264 
√°
++;

266 i‡(
√°
 > 0)

268 i‡(
	`°rcmp
(
b
, "endif") == 0)

269 
√°
--;

273 i‡(
	`°rcmp
(
b
, 
tokí
) == 0)

275 i‡(
©okí
 && 
	`°rcmp
(
b
,átoken) == 0)

282 
c
 !'\n' && c !
EOF
)

284 
c
 = 
	`mygëc
();

287 i‡(
c
 =
EOF
)

289 
	`Àxîr‹
("UnexpectedÉnd of file while skipping");

293 
	`°‹e_löe_numbî_öfo
(
cuºít_öcfûe
, 
cuºít_löe
);

294 
cuºít_löe
++;

295 
tŸÆ_löes
++;

297 
	}
}

300 
	$h™dÀ_c⁄d
(
c
)

302 
if°©e
 *
p
;

305 i‡(
c
 || 
	`skù_to
("else", "endif"))

307 
p
 = (
if°©e
 *)
	`xÆloc
((ifstate));

308 
p
->
√xt
 = 
i·›
;

309 
i·›
 = 
p
;

310 
p
->
°©e
 = 
c
 ? 
EXPECT_ELSE
 : 
EXPECT_ENDIF
;

312 i‡(!
c
)

314 
	`°‹e_löe_numbî_öfo
(
cuºít_öcfûe
, 
cuºít_löe
);

315 
cuºít_löe
++;

316 
tŸÆ_löes
++;

318 
	}
}

322 
	$check_vÆid_compûe_∑th
(*
∑th
, *
fûe_«me
, *
ˇŒög_fun˘i⁄
)

325 
svÆue
 *
ªt
;

327 *
p
;

329 
p
 = 
	`°rchr
(
∑th
, '.');Ö;Ö = strchr(p + 1, '.'))

331 i‡(
p
[1] == '.')

332  
NULL
;

335 
	`push_°rög
(
∑th
, 
STRING_MSTRING
);

336 
	`push_°rög
(
fûe_«me
, 
STRING_MSTRING
);

337 
	`push_°rög
(
ˇŒög_fun˘i⁄
, 
STRING_MSTRING
);

338 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_VALID_COMPILE_PATH
, 3);

339 i‡(
ªt
)

340 
∑th
 = 
	`tmp°rög_c›y
(
ªt
->
u
.
°rög
);

342  
∑th
;

343 
	}
}

345 
FILE
 *

346 
	$öc_›í
(*
buf
, *
«me
)

348 
öc°©e
 *
öc
;

349 
îrbuf
[1024];

350 
FILE
 *
f
;

351 
i
;

352 *
√w_«me
;

354 
	`ªmembî_ö˛ude
(*);

355 *
cuºít_lﬂded_fûe
;

357 i‡(
öcdïth
 >
MAX_INCLUDE
) {

358 
	`Àxîr‹
("To deepÑecursion of includes.");

359  
NULL
;

361 
	`mîge
(
«me
, 
buf
);

362 
√w_«me
 = 
	`check_vÆid_compûe_∑th
(
buf
, 
cuºít_lﬂded_fûe
, "include");

363 i‡(!
√w_«me
) {

364 
	`Àxîr‹
("Invalid include.");

365  
NULL
;

367 i‡(
√w_«me
 && (
f
 = 
	`f›í
“ew_«me, "r")Ë!
NULL
)

369 #ifde‡
WARN_INCLUDES


370 
öc
 = 
ö˘›
 ; in¯; in¯öc->
√xt
)

371 i‡(
	`°rcmp
(
öc
->
fûe
, 
√w_«me
) == 0) {

372 ()
	`¢¥ötf
(
îrbuf
, ”ºbuf), "Fûê/%†Æªady in˛uded,", 
buf
);

373 
	`Àxw¨nög
(
îrbuf
);

376 i‡(
s_Êag
)

377 
num_fûîód
++;

378 
	`ªmembî_ö˛ude
(
√w_«me
);

379  
f
;

385 
i
 = 0; i < 
öc_li°_size
; i++)

387 ()
	`•rötf
(
buf
, 
öc_li°
[
i
], 
«me
);

388 
√w_«me
 = 
	`check_vÆid_compûe_∑th
(
buf
, 
cuºít_lﬂded_fûe
, "include");

389 i‡(!
√w_«me
) {

390 
	`Àxîr‹
("Invalid include.");

391  
NULL
;

393 i‡(
√w_«me
 && (
f
 = 
	`f›í
(new_name, "r")))

395 #ifde‡
WARN_INCLUDES


396 
öc
 = 
ö˘›
 ; in¯; in¯öc->
√xt
)

397 i‡(
	`°rcmp
(
öc
->
fûe
, 
√w_«me
) == 0) {

398 ()
	`¢¥ötf
(
îrbuf
, ”ºbuf), "Fûê/%†Æªady in˛uded,", 
buf
);

399 
	`Àxw¨nög
(
îrbuf
);

402 i‡(
s_Êag
)

403 
num_fûîód
++;

404 
	`ªmembî_ö˛ude
(
√w_«me
);

405  
f
;

408  
NULL
;

409 
	}
}

412 
	$h™dÀ_ö˛ude
(*
«me
)

414 *
p
;

415 
buf
[1024];

416 
FILE
 *
f
;

417 
öc°©e
 *
is
;

418 
dñim
;

421 i‡(
nbuf
) {

422 
	`Àxîr‹
("InternalÖreprocessorÉrror");

425 i‡(*
«me
 != '"' && *name != '<')

427 
de‚
 *
d
;

428 i‡((
d
 = 
	`lookup_deföe
(
«me
)Ë&& d->
«rgs
 == -1)

430 *
q
;

431 
q
 = 
d
->
exps
;

432 
	`is•a˚
(*
q
))

433 
q
++;

434 
	`h™dÀ_ö˛ude
(
q
);

438 
	`Àxîr‹
("MissingÜeading \" or < in #include");

442 
dñim
 = *
«me
++ == '"' ? '"' : '>';

443 
p
 = 
«me
; *∞&& *∞!
dñim
;Ö++)

445 i‡(!*
p
)

447 
	`Àxîr‹
("MissingÅrailing \" or > in #include");

450 i‡(
	`°æí
(
«me
Ë> (
buf
) - 100)

452 
	`Àxîr‹
("IncludeÇameÅooÜong.");

455 *
p
 = 0;

456 i‡((
f
 = 
	`öc_›í
(
buf
, 
«me
)Ë!
NULL
) {

457 
is
 = (
öc°©e
 *)
	`xÆloc
((incstate));

458 
is
->
yyö
 = yyin;

459 
is
->
löe
 = 
cuºít_löe
;

460 
is
->
fûe
 = 
cuºít_fûe
;

461 
is
->
öc‚um
 = 
cuºít_öcfûe
;

462 
is
->
¶a°
 = slast;

463 
is
->
œ°ch¨
 =Üastchar;

464 
is
->
√xt
 = 
ö˘›
;

465 
is
->
¥agma_°ri˘_ty≥s
 =Öragma_strict_types;

466 
¥agma_°ri˘_ty≥s
 = 0;

467 
ö˘›
 = 
is
;

468 
cuºít_löe
 = 1;

469 
cuºít_fûe
 = 
	`xÆloc
(
	`°æí
(
buf
)+1);

470 
cuºít_öcfûe
 = ++
num_öcfûes
;

471 ()
	`°r˝y
(
cuºít_fûe
, 
buf
);

472 
¶a°
 = 
œ°ch¨
 = '\n';

473 
yyö
 = 
f
;

474 
öcdïth
++;

479 ()
	`•rötf
(
buf
, "C™nŸ #ö˛udê%s\n", 
«me
);

480 
	`Àxîr‹
(
buf
);

482 
	}
}

485 
	$h™dÀ_ex˚±i⁄
(
a˘i⁄
, *
mesßge
)

487 
buf
[1024];

489 ()
	`°r˝y
(
buf
, "\"");

491 i‡(
	`°æí
(
mesßge
) < 2)

492 ()
	`°rˇt
(
buf
, "Unspecified condition");

494 ()
	`°rˇt
(
buf
, 
mesßge
);

495 ()
	`°rˇt
(
buf
, "\"");

497 
	`push_numbî
(
a˘i⁄
);

498 
	`push_°rög
(
buf
, 
STRING_MSTRING
);

499 
	`push_numbî
(
cuºít_löe
);

500 
	`push_°rög
(
cuºít_fûe
, 
STRING_MSTRING
);

501 ()
	`≠∂y_ma°î_ob
(
M_PARSE_EXCEPTION
, 4);

503 i‡(
a˘i⁄
 =
ERROR
)

504 
	`Àxîr‹
("Parseáborted on #error statement,");

505 
	}
}

508 
	$skù_commít
()

510 
c
;

514 (
c
 = 
	`mygëc
()) != '*')

516 i‡(
c
 =
EOF
)

518 
	`Àxîr‹
("End of file iná comment");

521 i‡(
c
 == '\n')

523 
√x∑nds
=0;

524 
	`°‹e_löe_numbî_öfo
(
cuºít_öcfûe
, 
cuºít_löe
);

525 
cuºít_löe
++;

530 i‡((
c
 = 
	`mygëc
()) == '/')

532 i‡(
c
 == '\n')

534 
√x∑nds
=0;

535 
	`°‹e_löe_numbî_öfo
(
cuºít_öcfûe
, 
cuºít_löe
);

536 
cuºít_löe
++;

538 } 
c
 == '*');

540 
	}
}

543 
	$skù_commít2
()

545 
c
;

547 (
c
 = 
	`mygëc
()Ë!'\n' && c !
EOF
)

549 i‡(
c
 =
EOF
) {

550 
	`Àxîr‹
("End of file iná // comment");

553 
√x∑nds
=0;

554 
	`°‹e_löe_numbî_öfo
(
cuºít_öcfûe
, 
cuºít_löe
);

555 
cuºít_löe
++;

556 
	}
}

558 
	#TRY
(
c
, 
t
Ëi‡(
	`gobbÀ
(c)Ë 
	)
t

561 
	$dñåaû
(*
≠
)

563 *
p
 = 
≠
;

564 i‡(!*
p
)

566 
	`Àxîr‹
("Illegal # command");

570 *
p
 && !
	`is•a˚
(*p))

571 
p
++;

572 *
p
 = 0;

574 
	}
}

576 
	#SAVEC
 \

577 i‡(
yyp
 < 
yyãxt
+
MAXLINE
-5)\

578 *
yyp
++ = 
c
;\

580 
	`Àxîr‹
("LineÅooÜong");\

582 }

	)

585 
	$h™dÀ_¥agma
(*
°r
)

587 i‡(
	`°rcmp
(
°r
, "strict_types") == 0)

588 
¥agma_°ri˘_ty≥s
 = 1;

589 i‡(
	`°rcmp
(
°r
, "save_binary") == 0)

590 #ifde‡
BINARIES


591 
¥agma_ßve_bö¨y
 = 1;

595 i‡(
	`°rcmp
(
°r
, "no_clone") == 0)

596 
¥agma_no_˛⁄e
 = 1;

597 i‡(
	`°rcmp
(
°r
, "no_inherit") == 0)

598 
¥agma_no_öhîô
 = 1;

599 i‡(
	`°rcmp
(
°r
, "no_shadow") == 0)

600 
¥agma_no_shadow
 = 1;

601 i‡(
	`°rcmp
(
°r
, "resident") == 0)

602 
¥agma_ªsidít
 = 1;

604 
	`h™dÀ_ex˚±i⁄
(
WARNING
, "UnknownÖragma");

605 
	}
}

607 
	skeyw‹d
 {

608 *
	mw‹d
;

609 
	mtokí
;

610 
	mmö_¨gs
;

611 
	mmax_¨gs
;

612 
	mªt_ty≥
;

613 
	m¨g_ty≥1
;

614 
	m¨g_ty≥2
;

615 
	m¨g_ödex
;

617 
	mDeÁu…
;

618 } 
	g¥edefs
[] =

619 
	~"efun_defs.c
"

621 
keyw‹d
 
ªsw‹ds
[] = {

622 { "bªak", 
F_BREAK
, },

623 { "ˇ£", 
F_CASE
, },

624 { "ˇtch", 
F_CATCH
, },

625 { "c⁄töue", 
F_CONTINUE
, },

626 { "deÁu…", 
F_DEFAULT
, },

627 { "do", 
F_DO
, },

628 { "ñ£", 
F_ELSE
, },

629 { "Êﬂt", 
F_FLOAT
, },

630 { "f‹", 
F_FOR
, },

631 { "fun˘i⁄", 
F_FUNCTION
, },

632 { "if", 
F_IF
, },

633 { "öhîô", 
F_INHERIT
, },

634 { "öt", 
F_INT
, },

635 { "m≠pög", 
F_MAPPING
, },

636 { "mixed", 
F_MIXED
, },

637 { "nomask", 
F_NO_MASK
, },

638 { "obje˘", 
F_OBJECT
, },

639 { "›î©‹", 
F_OPERATOR
, },

640 { "∑r£_comm™d", 
F_PARSE_COMMAND
, },

641 { "¥iv©e", 
F_PRIVATE
, },

642 { "public", 
F_PUBLIC
, },

643 { "ªtu∫", 
F_RETURN
, },

644 { "ssˇnf", 
F_SSCANF
, },

645 { "°©ic", 
F_STATIC
, },

646 { "°©us", 
F_STATUS
, },

647 { "°rög", 
F_STRING_DECL
, },

648 { "swôch", 
F_SWITCH
, },

649 { "v¨¨gs", 
F_VARARGS
, },

650 { "void", 
F_VOID
, },

651 { "whûe", 
F_WHILE
, },

654 
ö°r
 
	gö°rs
[
EFUN_LAST
 - 
EFUN_FIRST
 + 1];

657 
	$lookupw‹d
(*
s
, 
keyw‹d
 *
w‹ds
, 
h
)

659 
i
, 
l
, 
r
;

661 
l
 = 0;

664 
i
 = (
l
 + 
h
) / 2;

665 
r
 = 
	`°rcmp
(
s
, 
w‹ds
[
i
].
w‹d
);

666 i‡(
r
 == 0)

667  
w‹ds
[
i
].
tokí
;

668 i‡(
l
 =
i
)

670 i‡(
r
 < 0)

671 
h
 = 
i
;

673 
l
 = 
i
;

675 
	}
}

677 
INLINE
 

678 
	$lookup_ªsw‹d
(*
s
)

680  
	`lookupw‹d
(
s
, 
ªsw‹ds
, 
	`NELEM
(reswords));

681 
	}
}

684 
	$yyÀx1
()

686 *
yyp
;

687 
c
;

688 
c1
, 
c2
;

692 i‡(
Àx_Áèl
)

696 
c
 = 
	`mygëc
())

698 
EOF
:

699 i‡(
ö˘›
)

701 
öc°©e
 *
p
;

702 
p
 = 
ö˘›
;

703 ()
	`f˛o£
(
yyö
);

705 
	`‰ì
(
cuºít_fûe
);

706 
√x∑nds
=0;

707 
cuºít_fûe
 = 
p
->
fûe
;

708 
cuºít_löe
 = 
p
->
löe
 + 1;

709 
cuºít_öcfûe
 = 
p
->
öc‚um
;

710 
¥agma_°ri˘_ty≥s
 = 
p
->pragma_strict_types;

711 
yyö
 = 
p
->yyin;

712 
¶a°
 = 
p
->slast;

713 
œ°ch¨
 = 
p
->lastchar;

714 
ö˘›
 = 
p
->
√xt
;

715 
	`°‹e_löe_numbî_öfo
(
cuºít_öcfûe
, 
cuºít_löe
);

716 
öcdïth
--;

718 
	`‰ì
((*)
p
);

721 i‡(
i·›
) {

722 
if°©e
 *
p
 = 
i·›
;

723 
	`Àxîr‹
(
p
->
°©e
 =
EXPECT_ENDIF
 ? "Missing #endif" : "Missing #else");

724 
i·›
) {

725 
p
 = 
i·›
;

726 
i·›
 = 
p
->
√xt
;

727 
	`‰ì
((*)
p
);

733 
√x∑nds
=0;

734 
	`°‹e_löe_numbî_öfo
(
cuºít_öcfûe
, 
cuºít_löe
);

735 
cuºít_löe
++;

736 
tŸÆ_löes
++;

745 
	`TRY
('+', 
F_INC
);

746 
	`TRY
('=', 
F_ADD_EQ
);

747  
c
;

749 
	`TRY
('>', 
F_ARROW
);

750 
	`TRY
('-', 
F_DEC
);

751 
	`TRY
('=', 
F_SUB_EQ
);

752  
c
;

754 
	`TRY
('&', 
F_LAND
);

755 
	`TRY
('=', 
F_AND_EQ
);

756  
c
;

758 
	`TRY
('|', 
F_LOR
);

759 
	`TRY
('=', 
F_OR_EQ
);

760  
c
;

762 
	`TRY
('=', 
F_XOR_EQ
);

763  
c
;

765 i‡(
	`gobbÀ
('<')) {

766 
	`TRY
('=', 
F_LSH_EQ
);

767  
F_LSH
;

769 
	`TRY
('=', 
F_LE
);

770  
c
;

772 i‡(
	`gobbÀ
('>')) {

773 
	`TRY
('=', 
F_RSH_EQ
);

774  
F_RSH
;

776 
	`TRY
('=', 
F_GE
);

777  
c
;

779 
	`TRY
('=', 
F_MULT_EQ
);

780  
c
;

782 
	`TRY
('=', 
F_MOD_EQ
);

783  
F_MOD
;

785 i‡(
	`gobbÀ
('*')) {

786 
	`skù_commít
();

788 } i‡(
	`gobbÀ
('/')) {

789 
	`skù_commít2
();

792 
	`TRY
('=', 
F_DIV_EQ
);

793  
c
;

795 
	`TRY
('=', 
F_EQ
);

796  
c
;

808  
c
;

810 
	`TRY
('=', 
F_NE
);

811  
F_NOT
;

813 
	`TRY
(':', 
F_COLON_COLON
);

816 i‡(
	`gobbÀ
('.')) {

817 i‡(
	`gobbÀ
('.'))

818  
F_VARARG
;

820  
F_RANGE
;

822 
badÀx
;

824 i‡(
œ°ch¨
 == '\n')

826 *
s•
 = 0;

827 
quŸe
;

829 
yyp
 = 
yyãxt
;

832 
c
 = 
	`mygëc
();

833 } 
	`is•a˚
(
c
));

835 
quŸe
 = 0;;)

837 i‡(
c
 == '"')

838 
quŸe
 ^= 1;

841 !
quŸe
 && 
c
 == '/')

843 if(
	`gobbÀ
('*'))

845 
	`skù_commít
();

846 
c
=
	`mygëc
();

852 i‡(!
s•
 && 
	`is•a˚
(
c
))

853 
s•
 = 
yyp
;

854 i‡(
c
 ='\n' || c =
EOF
)

856 
SAVEC
;

857 
c
 = 
	`mygëc
();

859 i‡(
s•
)

861 *
s•
++ = 0;

862 
	`is•a˚
(*
s•
))

863 
s•
++;

867 
s•
 = 
yyp
;

869 *
yyp
 = 0;

870 i‡(
	`°rcmp
("deföe", 
yyãxt
) == 0)

872 
	`h™dÀ_deföe
(
s•
);

874 i‡(
	`°rcmp
("if", 
yyãxt
) == 0)

877 
√ga
=0;

878 i‡(*
s•
=='!'){ s•++; 
√ga
=1;}

879 i‡(
	`isdigô
(*
s•
)) {

880 *
p
;

881 
l
;

882 
l
 = 
	`°πﬁ
(
s•
, &
p
, 10);

883 
	`is•a˚
(*
p
))

884 
p
++;

885 i‡(*
p
)

886 
	`Àxîr‹
("ConditionÅoo complex in #if");

888 
	`h™dÀ_c⁄d
(
√ga
?!()
l
:()l);

889 } i‡(
	`ißlunum
(*
s•
)) {

890 *
p
 = 
s•
;

891 
	`ißlunum
(*
p
))

892 
p
++;

893 i‡(*
p
) {

894 *
p
++ = 0;

895 
	`is•a˚
(*
p
))

896 
p
++;

898 i‡(*
p
)

899 
	`Àxîr‹
("ConditionÅoo complex in #if");

901 
de‚
 *
d
;

902 
d
 = 
	`lookup_deföe
(
s•
);

903 i‡(
d
) {

904 
	`h™dÀ_c⁄d
(
√ga
?!
	`©oi
(
d
->
exps
):atoi(d->exps));

906 
	`h™dÀ_c⁄d
(
√ga
?1:0);

910 
	`Àxîr‹
("ConditionÅoo complex in #if");

912 
c⁄d
;

914 
	`myungëc
(0);

915 
	`add_öput
(
s•
);

916 
c⁄d
 = 
	`c⁄d_gë_exp
(0);

917 i‡(
	`mygëc
())

919 
	`Àxîr‹
("ConditionÅoo complex in #if");

920  
	`mygëc
() ) ;

923 
	`h™dÀ_c⁄d
(
c⁄d
);

926 i‡(
	`°rcmp
("ifdef", 
yyãxt
) == 0)

928 
	`dñåaû
(
s•
);

929 
	`h™dÀ_c⁄d
(
	`lookup_deföe
(
s•
) != 0);

931 i‡(
	`°rcmp
("i‚def", 
yyãxt
) == 0)

933 
	`dñåaû
(
s•
);

934 
	`h™dÀ_c⁄d
(
	`lookup_deföe
(
s•
) == 0);

936 i‡(
	`°rcmp
("ñ£", 
yyãxt
) == 0)

938 i‡(
i·›
 && i·›->
°©e
 =
EXPECT_ELSE
)

940 
if°©e
 *
p
 = 
i·›
;

943 
i·›
 = 
p
->
√xt
;

944 
	`‰ì
((*)
p
);

945 ()
	`skù_to
("endif", (*)0);

946 
	`°‹e_löe_numbî_öfo
(
cuºít_öcfûe
, 
cuºít_löe
);

947 
cuºít_löe
++;

948 
tŸÆ_löes
++;

952 
	`Àxîr‹
("Unexpected #else");

955 i‡(
	`°rcmp
("ídif", 
yyãxt
) == 0)

957 i‡(
i·›
 && (i·›->
°©e
 =
EXPECT_ENDIF
 ||

958 
i·›
->
°©e
 =
EXPECT_ELSE
))

960 
if°©e
 *
p
 = 
i·›
;

963 
i·›
 = 
p
->
√xt
;

964 
	`‰ì
((*)
p
);

968 
	`Àxîr‹
("Unexpected #endif");

971 i‡(
	`°rcmp
("undef", 
yyãxt
) == 0)

973 
de‚
 *
d
;

975 
	`dñåaû
(
s•
);

976 i‡–(
d
 = 
	`lookup_deföe
(
s•
)Ë!
NULL
 )

977 
d
->
undef
++;

979 i‡(
	`°rcmp
("echo", 
yyãxt
) == 0)

981 ()
	`Ârötf
(
°dîr
, "%s\n", 
s•
);

983 i‡(
	`°rcmp
("ö˛ude", 
yyãxt
) == 0)

986 
	`h™dÀ_ö˛ude
(
s•
);

988 i‡(
	`°rcmp
("¥agma", 
yyãxt
) == 0)

990 
	`dñåaû
(
s•
);

991 
	`h™dÀ_¥agma
(
s•
);

993 i‡(
	`°rcmp
("îr‹", 
yyãxt
) == 0)

995 
	`h™dÀ_ex˚±i⁄
(
ERROR
, 
s•
);

997 i‡(
	`°rcmp
("w¨nög", 
yyãxt
) == 0)

999 
	`h™dÀ_ex˚±i⁄
(
WARNING
, 
s•
);

1003 
	`Àxîr‹
("Unrecognised # directive");

1005 
	`myungëc
('\n');

1008 
badÀx
;

1010 
yylvÆ
.
numbî
 = 
	`mygëc
();

1011 i‡(
yylvÆ
.
numbî
 == '\\')

1013 
tmp
 = 
	`mygëc
();

1014 i‡(
tmp
 == 'n') {

1015 
yylvÆ
.
numbî
 = '\n';

1016 } i‡(
tmp
 == 't') {

1017 
yylvÆ
.
numbî
 = '\t';

1018 } i‡(
tmp
 == 'r') {

1019 
yylvÆ
.
numbî
 = '\r';

1020 } i‡(
tmp
 == 'b') {

1021 
yylvÆ
.
numbî
 = '\b';

1022 } i‡(
tmp
 == 'a') {

1023 
yylvÆ
.
numbî
 = '\a';

1024 } i‡(
tmp
 == 'v') {

1025 
yylvÆ
.
numbî
 = '\v';

1026 } i‡(
tmp
 == '\'' ||Åmp == '\\' ||Åmp == '"') {

1027 
yylvÆ
.
numbî
 = 
tmp
;

1029 
	`Àxw¨nög
("Bad characterÉscape sequence");

1030 
yylvÆ
.
numbî
 = 
tmp
;

1033 i‡(!
	`gobbÀ
('\''))

1034 
	`Àxîr‹
("Illegal character constant");

1035  
F_NUMBER
;

1037 
yyp
 = 
yyãxt
;

1038 *
yyp
++ = 
c
;

1040 
c
 = 
	`mygëc
();

1041 i‡(
c
 =
EOF
) {

1042 
	`Àxîr‹
("End of file in string");

1043  
	`°rög
("\"\"");

1044 } i‡(
c
 == '\n') {

1045 
	`Àxîr‹
("Newline in string");

1046  
	`°rög
("\"\"");

1048 
SAVEC
;

1049 i‡(
c
 == '"')

1051 i‡(
c
 == '\\') {

1052 
c
 = 
	`mygëc
();

1053 i‡–
c
 == '\n' ) {

1054 
yyp
--;

1055 
	`°‹e_löe_numbî_öfo
(
cuºít_öcfûe
, 
cuºít_löe
);

1056 
cuºít_löe
++;

1057 
tŸÆ_löes
++;

1059 i‡–
c
 =
EOF
 )

1062 
	`myungëc
(
c
);

1064 *
yyp
++ = 
c
;

1067 *
yyp
 = 0;

1068  
	`°rög
(
yyãxt
);

1071 
c
 = 
	`mygëc
();

1072 i‡–
c
 == 'X' || c == 'x' )

1074 
yyp
 = 
yyãxt
;

1077 
c
 = 
	`mygëc
();

1078 
SAVEC
;

1079 i‡(!
	`isxdigô
(
c
))

1082 
	`myungëc
(
c
);

1083  
	`numbî
–()
	`°πﬁ
(
yyãxt
,(**)
NULL
,0x10) );

1085 
	`myungëc
(
c
);

1086 
c
 = '0';

1090 
yyp
 = 
yyãxt
;

1091 *
yyp
++ = 
c
;

1093 
c
 = 
	`mygëc
();

1094 i‡(!
	`isdigô
(
c
))

1096 
SAVEC
;

1098 i‡(
c
 == '.')

1100 i‡(
	`isdigô
(
c1
 = 
	`mygëc
()))

1102 
	`©of
(const *);

1103 
SAVEC
;

1104 
c
 = 
c1
;

1105 
SAVEC
;

1106 
c
 = 
	`mygëc
(); 
	`isdigô
(c); c = mygetc())

1107 
SAVEC
;

1108 i‡(
c
 == 'e' || c == 'E')

1110 
c1
 = 
	`mygëc
();

1111 i‡(
c1
 == '-' || c1 == '+')

1113 
c2
 = 
	`mygëc
();

1114 i‡(
	`isdigô
(
c2
))

1116 
SAVEC
;

1117 
c
 = 
c1
;

1118 
SAVEC
;

1119 
c
 = 
c2
;

1120 
SAVEC
;

1121 
c
 = 
	`mygëc
(); 
	`isdigô
(c); c = mygetc())

1122 
SAVEC
;

1126 
	`myungëc
(
c2
);

1127 
	`myungëc
(
c1
);

1130 i‡(
	`isdigô
(
c1
))

1132 
SAVEC
;

1133 
c
 = 
c1
;

1134 
SAVEC
;

1135 
c
 = 
	`mygëc
(); 
	`isdigô
(c); c = mygetc())

1136 
SAVEC
;

1139 
	`myungëc
(
c1
);

1141 
	`myungëc
(
c
);

1142 *
yyp
 = 0;

1143  
	`ªÆ
(
	`©of
(
yyãxt
));

1145 
	`myungëc
(
c1
);

1147 
	`myungëc
(
c
);

1148 *
yyp
 = 0;

1149 i‡(*
yyãxt
 == '0')

1150  
	`numbî
–()
	`°πﬁ
(
yyãxt
,(**)
NULL
,0x8) );

1151  
	`numbî
(
	`©oi
(
yyãxt
));

1153 i‡(
	`ißÕha
(
c
) || c == '_') {

1154 
r
;

1156 
yyp
 = 
yyãxt
;

1157 *
yyp
++ = 
c
;

1159 
c
 = 
	`mygëc
();

1160 i‡(!
	`ißlunum
(
c
))

1162 
SAVEC
;

1164 *
yyp
 = 0;

1166 
	`myungëc
(
c
);

1167 i‡(!
	`ex∑nd_deföe
()) {

1168 
r
 = 
	`lookup_ªsw‹d
(
yyãxt
);

1169 i‡(
r
 >= 0) {

1170  
r
;

1172  
	`idít
(
yyãxt
);

1176 
badÀx
;

1179 
badÀx
:

1180 { 
buff
[100]; ()
	`•rötf
(buff, "IŒegÆ ch¨a˘î (hex %02xË'%c'", 
c
, c);

1181 
	`Àxîr‹
(
buff
);  ' '; }

1182 
	}
}

1185 
	$yyÀx
()

1187 
r
;

1189 i‡(
kìp1
.
tokí
 != -47)

1194 
r
 = 
kìp1
.
tokí
;

1195 
cuºít_löe
 = 
kìp1
.
löe
;

1196 
yylvÆ
 = 
kìp1
.
lvÆ
;

1197 
kìp1
 = 
kìp2
;

1198 
kìp2
 = 
kìp3
;

1199 
kìp3
.
tokí
 = -47;

1200  
r
;

1202 
yyãxt
[0] = 0;

1206 i‡((
r
 = 
	`yyÀx1
()Ë=
F_STRING
)

1208 
kìp4
.
lvÆ
 = 
yylvÆ
;

1209 
kìp4
.
löe
 = 
cuºít_löe
;

1210 
yyãxt
[0] = 0;

1211 
r
 = 
	`yyÀx1
();

1214 
kìp1
.
löe
 = 
cuºít_löe
;

1215 
kìp1
.
lvÆ
 = 
yylvÆ
;

1216 i‡(
r
 != '+')

1222 
kìp1
.
tokí
 = 
r
;

1223 
yylvÆ
 = 
kìp4
.
lvÆ
;

1224 
cuºít_löe
 = 
kìp4
.
löe
;

1225  
F_STRING
;

1227 
yyãxt
[0] = 0;

1228 
r
 = 
	`yyÀx1
();

1229 
kìp2
.
löe
 = 
cuºít_löe
;

1230 
kìp2
.
lvÆ
 = 
yylvÆ
;

1231 i‡(
r
 !
F_STRING
)

1237 
kìp1
.
tokí
 = '+';

1238 
kìp2
.
tokí
 = 
r
;

1239 
cuºít_löe
 = 
kìp4
.
löe
;

1240 
yylvÆ
 = 
kìp4
.
lvÆ
;

1241  
F_STRING
;

1243 
yyãxt
[0] = 0;

1244 
r
 = 
	`yyÀx1
();

1245 
kìp3
.
löe
 = 
cuºít_löe
;

1246 
kìp3
.
lvÆ
 = 
yylvÆ
;

1247 i‡(
r
 ='[' ||Ñ =
F_ARROW
) {

1252 
kìp1
.
tokí
 = '+';

1253 
kìp2
.
tokí
 = 
F_STRING
;

1254 
kìp3
.
tokí
 = 
r
;

1255 
cuºít_löe
 = 
kìp4
.
löe
;

1256 
yylvÆ
 = 
kìp4
.
lvÆ
;

1257  
F_STRING
;

1262 
kìp3
.
lvÆ
.
°rög
 = 
	`tm∑Œoc
(
	`°æí
(
kìp4
.lval.string) +

1263 
	`°æí
(
kìp2
.
lvÆ
.
°rög
) + 1);

1264 ()
	`°r˝y
(
kìp3
.
lvÆ
.
°rög
, 
kìp4
.lval.string);

1265 ()
	`°rˇt
(
kìp3
.
lvÆ
.
°rög
, 
kìp2
.lval.string);

1266 
kìp4
.
löe
 = 
kìp2
.line;

1267 
kìp4
.
lvÆ
.
°rög
 = 
kìp3
.lval.string;

1271  
r
;

1272 
	}
}

1274 
YYSTYPE
 
yylvÆ
;

1277 
	$i¶oˇl
(*
°r
)

1279 
i
;

1281 
i
 = 
cuºít_numbî_of_loˇls
 - 1; i >= 0; i--)

1283 i‡(
loˇl_blockdïth
[
i
] !-1 && 
	`°rcmp
(
loˇl_«mes
[i], 
°r
) == 0)

1284  
i
;

1287 
	}
}

1290 
	$idít
(*
°r
)

1292 
i
;

1294 
i
 = 
	`i¶oˇl
(
°r
);

1295 i‡(
i
 >= 0) {

1296 
yylvÆ
.
numbî
 = 
i
;

1297  
F_LOCAL_NAME
;

1299 
yylvÆ
.
°rög
 = 
	`tmp°rög_c›y
(
°r
);

1300  
F_IDENTIFIER
;

1301 
	}
}

1304 
	$°rög
(*
°r
)

1306 *
p
;

1308 i‡(!*
°r
) {

1309 
°r
 = "\"\"";

1311 
p
 = 
	`tm∑Œoc
(
	`°æí
(
°r
) + 1);

1312 
yylvÆ
.
°rög
 = 
p
;

1313 
°r
++; så[0] && så[1] ; så++, 
p
++) {

1314 i‡(
°r
[0] == '\\') {

1315 i‡(
°r
[1] == 'n') {

1316 *
p
 = '\n';

1317 } i‡(
°r
[1] == 't') {

1318 *
p
 = '\t';

1319 } i‡(
°r
[1] == 'r') {

1320 *
p
 = '\r';

1321 } i‡(
°r
[1] == 'b') {

1322 *
p
 = '\b';

1323 } i‡(
°r
[1] == 'a') {

1324 *
p
 = '\a';

1325 } i‡(
°r
[1] == 'v') {

1326 *
p
 = '\v';

1327 } i‡(
°r
[1] == '"' || str[1] == '\\' || str[1] == '\'') {

1328 *
p
 = 
°r
[1];

1330 
	`Àxw¨nög
("Bad stringÉscape sequence.");

1331 *
p
 = 
°r
[1];

1333 
°r
++;

1335 *
p
 = *
°r
;

1337 *
p
 = '\0';

1338  
F_STRING
;

1339 
	}
}

1342 
	$numbî
(
i
)

1344 
yylvÆ
.
numbî
 = 
i
;

1345  
F_NUMBER
;

1346 
	}
}

1349 
	$ªÆ
(
f
)

1351 i‡(
f
 !0.0 && (
	`Ábs
(fË< 
FLT_MIN
 || fabs(fË> 
FLT_MAX
)) {

1352 
	`Àxîr‹
("FloatingÖoint constantÉxceedsÜimit.");

1353 
f
 = 0.0;

1355 
yylvÆ
.
ªÆ
 = ()
f
;

1356  
F_FLOATC
;

1357 
	}
}

1360 
	$íd_√w_fûe
()

1362 
ö˘›
)

1364 
öc°©e
 *
p
;

1365 
p
 = 
ö˘›
;

1366 ()
	`f˛o£
(
yyö
);

1367 
	`‰ì
(
cuºít_fûe
);

1368 
cuºít_fûe
 = 
p
->
fûe
;

1369 
yyö
 = 
p
->yyin;

1370 
ö˘›
 = 
p
->
√xt
;

1371 
	`‰ì
((*)
p
);

1373 
i·›
)

1375 
if°©e
 *
p
;

1377 
p
 = 
i·›
;

1378 
i·›
 = 
p
->
√xt
;

1379 
	`‰ì
((*)
p
);

1381 
	`‰ì_deföes
();

1382 
	}
}

1386 
	$°¨t_√w_fûe
(
FILE
 *
f
)

1388 
Õc_¥edef_s
 *
tmpf
;

1390 
	`‰ì_deföes
();

1391 
	`add_deföe
("_FUNCTION", -1, "");

1392 
	`add_deföe
("LPC4", -1, "");

1393 
	`add_deföe
("CD_DRIVER", -1, "");

1394 #ifde‡
DEBUG


1395 
	`add_deföe
("DEBUG_DRIVER", -1, "");

1398 
tmpf
 = 
Õc_¥edefs
;Åmpf;Åmp‡tmpf->
√xt
)

1400 
«mebuf
[
NSIZE
];

1401 
mãxt
[
MLEN
];

1403 *
mãxt
='\0';

1404 ()
	`ssˇnf
(
tmpf
->
Êag
, "%[^=]=%[ -~=]", 
«mebuf
, 
mãxt
);

1405 i‡(
	`°æí
(
«mebuf
Ë>
NSIZE
)

1406 
	`Áèl
("NSIZEÉxceeded\n");

1407 i‡(
	`°æí
(
mãxt
Ë>
MLEN
)

1408 
	`Áèl
("MLENÉxceeded\n");

1409 
	`add_deföe
(
«mebuf
,-1,
mãxt
);

1411 
kìp1
.
tokí
 = 
kìp2
.tokí = 
kìp3
.token = -47;

1412 
yyö
 = 
f
;

1413 
¶a°
 = '\n';

1414 
œ°ch¨
 = '\n';

1415 
ö˘›
 = 0;

1416 
num_öcfûes
 = 0;

1417 
cuºít_öcfûe
 = 0;

1418 
cuºít_löe
 = 1;

1419 
Àx_Áèl
 = 0;

1420 
öcdïth
 = 0;

1421 
nbuf
 = 0;

1422 
ouç
 = 
defbuf
+
DEFMAX
;

1423 
¥agma_°ri˘_ty≥s
 = 0;

1424 #ifde‡
BINARIES


1425 
¥agma_ßve_bö¨y
 = (
	`lookup_deföe
("SAVE_BINARIES") != 0);

1427 
¥agma_no_öhîô
 = 
¥agma_no_˛⁄e
 = 
¥agma_no_shadow
 = 
¥agma_ªsidít
 = 0;

1428 
√x∑nds
 = 0;

1429 
	}
}

1446 
	$add_ö°r_«me
(*
«me
, 
n
)

1448 
ö°rs
[
n
 - 
EFUN_FIRST
].
«me
 =Çame;

1449 
	}
}

1451 
	#T_ANY
 
T_STRING
|
T_NUMBER
|
T_POINTER
|
T_OBJECT
|
T_MAPPING
|
T_FLOAT
|
T_FUNCTION


	)

1453 
	$add_ö°r_›«me
(*
«me
, 
n
, 
ªt
, 
¨g1
, 
¨g2
)

1455 
n
 -
EFUN_FIRST
;

1456 
ö°rs
[
n
].
«me
 =Çame;

1457 
ö°rs
[
n
].
mö_¨g
 = 2;

1458 
ö°rs
[
n
].
max_¨g
 = 2;

1459 
ö°rs
[
n
].
ty≥
[0] = 
¨g1
;

1460 
ö°rs
[
n
].
ty≥
[1] = 
¨g2
;

1461 
ö°rs
[
n
].
ªt_ty≥
 = 
ªt
;

1462 
	}
}

1465 
	$add_ö°r_›«me_¥efix
(*
«me
, 
n
, 
ªt
, 
¨g
)

1467 
n
 -
EFUN_FIRST
;

1468 
ö°rs
[
n
].
«me
 =Çame;

1469 
ö°rs
[
n
].
mö_¨g
 = 1;

1470 
ö°rs
[
n
].
max_¨g
 = 1;

1471 
ö°rs
[
n
].
ty≥
[0] = 
¨g
;

1472 
ö°rs
[
n
].
ty≥
[1] = 0;

1473 
ö°rs
[
n
].
ªt_ty≥
 = 
ªt
;

1474 
	}
}

1477 
	$öô_num_¨gs
()

1479 
i
, 
n
;

1481 
i
=0; i<
	`NELEM
(
¥edefs
); i++) {

1482 
n
 = 
¥edefs
[
i
].
tokí
 - 
EFUN_FIRST
;

1483 i‡(
n
 < 0 ||Ç > 
	`NELEM
(
ö°rs
))

1484 
	`Áèl
("Tokí %†ha†ûÀgÆ vÆuê%d.\n", 
¥edefs
[
i
].
w‹d
, 
n
);

1485 
ö°rs
[
n
].
mö_¨g
 = 
¥edefs
[
i
].
mö_¨gs
;

1486 
ö°rs
[
n
].
max_¨g
 = 
¥edefs
[
i
].
max_¨gs
;

1487 
ö°rs
[
n
].
«me
 = 
¥edefs
[
i
].
w‹d
;

1488 
ö°rs
[
n
].
ty≥
[0] = 
¥edefs
[
i
].
¨g_ty≥1
;

1489 
ö°rs
[
n
].
ty≥
[1] = 
¥edefs
[
i
].
¨g_ty≥2
;

1490 
ö°rs
[
n
].
DeÁu…
 = 
¥edefs
[
i
].Default;

1491 
ö°rs
[
n
].
ªt_ty≥
 = 
¥edefs
[
i
].ret_type;

1492 
ö°rs
[
n
].
¨g_ödex
 = 
¥edefs
[
i
].arg_index;

1494 
	`add_ö°r_›«me
("+", 
F_ADD
, 
TYPE_ANY
, 
T_ANY
, T_ANY);

1495 
	`add_ö°r_›«me
("-", 
F_SUBTRACT
, 
TYPE_ANY
, 
T_ANY
, T_ANY);

1496 
	`add_ö°r_›«me
("*", 
F_MULTIPLY
, 
TYPE_ANY
, 
T_ANY
, T_ANY);

1497 
	`add_ö°r_›«me
("/", 
F_DIVIDE
, 
TYPE_ANY
, 
T_ANY
, T_ANY);

1498 
	`add_ö°r_›«me
("%", 
F_MOD
, 
TYPE_ANY
, 
T_ANY
, T_ANY);

1499 
	`add_ö°r_›«me
("&", 
F_AND
, 
TYPE_ANY
, 
T_ANY
, T_ANY);

1500 
	`add_ö°r_›«me
("|", 
F_OR
, 
TYPE_ANY
, 
T_ANY
, T_ANY);

1501 
	`add_ö°r_›«me
("^", 
F_XOR
, 
TYPE_NUMBER
, 
T_NUMBER
, T_NUMBER);

1502 
	`add_ö°r_›«me
(">>", 
F_LSH
, 
TYPE_NUMBER
, 
T_NUMBER
, T_NUMBER);

1503 
	`add_ö°r_›«me
("<<", 
F_RSH
, 
TYPE_NUMBER
, 
T_NUMBER
, T_NUMBER);

1504 
	`add_ö°r_›«me
("<", 
F_LT
, 
TYPE_NUMBER
, 
T_ANY
, T_ANY);

1505 
	`add_ö°r_›«me
(">", 
F_GT
, 
TYPE_NUMBER
, 
T_ANY
, T_ANY);

1506 
	`add_ö°r_›«me
("<=", 
F_LE
, 
TYPE_NUMBER
, 
T_ANY
, T_ANY);

1507 
	`add_ö°r_›«me
(">=", 
F_GE
, 
TYPE_NUMBER
, 
T_ANY
, T_ANY);

1508 
	`add_ö°r_›«me
("==", 
F_EQ
, 
TYPE_NUMBER
, 
T_ANY
, T_ANY);

1509 
	`add_ö°r_›«me
("!=", 
F_NE
, 
TYPE_NUMBER
, 
T_ANY
, T_ANY);

1510 
	`add_ö°r_›«me
("ödex", 
F_INDEX
, 
TYPE_ANY
, 
T_ANY
, T_ANY);

1511 
	`add_ö°r_›«me_¥efix
("!", 
F_NOT
, 
TYPE_NUMBER
, 
T_ANY
);

1512 
	`add_ö°r_›«me_¥efix
("~", 
F_COMPL
, 
TYPE_NUMBER
, 
T_NUMBER
);

1514 
	`add_ö°r_«me
("+=", 
F_ADD_EQ
);

1515 
	`add_ö°r_«me
("push_ödexed_lvÆue", 
F_PUSH_INDEXED_LVALUE
);

1516 
	`add_ö°r_«me
("idítifõr", 
F_IDENTIFIER
);

1517 
	`add_ö°r_«me
("loˇl", 
F_LOCAL_NAME
);

1518 
	`add_ö°r_«me
("ödúe˘", 
F_INDIRECT
);

1519 
	`add_ö°r_«me
("numbî", 
F_NUMBER
);

1520 
	`add_ö°r_«me
("push_loˇl_v¨übÀ_lvÆue", 
F_PUSH_LOCAL_VARIABLE_LVALUE
);

1521 
	`add_ö°r_«me
("c⁄°1", 
F_CONST1
);

1522 
	`add_ö°r_«me
("subåa˘", 
F_SUBTRACT
);

1523 
	`add_ö°r_«me
("assign", 
F_ASSIGN
);

1524 
	`add_ö°r_«me
("p›", 
F_POP_VALUE
);

1525 
	`add_ö°r_«me
("c⁄°0", 
F_CONST0
);

1526 
	`add_ö°r_«me
("Êﬂtc", 
F_FLOATC
);

1527 
	`add_ö°r_«me
("do_öv¨ü¡s", 
F_DO_INVARIANTS
);

1528 
	`add_ö°r_«me
("jump_whí_zîo", 
F_JUMP_WHEN_ZERO
);

1529 
	`add_ö°r_«me
("jump_whí_n⁄_zîo", 
F_JUMP_WHEN_NON_ZERO
);

1530 
	`add_ö°r_«me
("||", 
F_LOR
);

1531 
	`add_ö°r_«me
("&&", 
F_LAND
);

1532 
	`add_ö°r_«me
("-=", 
F_SUB_EQ
);

1533 
	`add_ö°r_«me
("jump", 
F_JUMP
);

1534 
	`add_ö°r_«me
("ªtu∫", 
F_RETURN
);

1535 
	`add_ö°r_«me
("ssˇnf", 
F_SSCANF
);

1536 
	`add_ö°r_«me
("°rög", 
F_STRING
);

1537 
	`add_ö°r_«me
("ˇŒ_n⁄_vútuÆ", 
F_CALL_NON_VIRT
);

1538 
	`add_ö°r_«me
("ˇŒ_vútuÆ", 
F_CALL_VIRT
);

1539 
	`add_ö°r_«me
("ˇŒ_v¨", 
F_CALL_VAR
);

1540 
	`add_ö°r_«me
("ˇŒ_simul", 
F_CALL_SIMUL
);

1541 
	`add_ö°r_«me
("∑µly", 
F_PAPPLY
);

1542 
	`add_ö°r_«me
("buûd_˛osuª", 
F_BUILD_CLOSURE
);

1543 
	`add_ö°r_«me
("aggªg©e", 
F_AGGREGATE
);

1544 
	`add_ö°r_«me
("m_aggªg©e", 
F_M_AGGREGATE
);

1545 
	`add_ö°r_«me
("push_idítifõr_lvÆue", 
F_PUSH_IDENTIFIER_LVALUE
);

1546 
	`add_ö°r_«me
("!=", 
F_NE
);

1547 
	`add_ö°r_«me
("dup", 
F_DUP
);

1548 
	`add_ö°r_«me
("ˇtch", 
F_CATCH
);

1549 
	`add_ö°r_«me
("√g", 
F_NEGATE
);

1550 
	`add_ö°r_«me
("x++", 
F_POST_INC
);

1551 
	`add_ö°r_«me
("x--", 
F_POST_DEC
);

1552 
	`add_ö°r_«me
("swôch",
F_SWITCH
);

1553 
	`add_ö°r_«me
("bªak",
F_BREAK
);

1554 
	`add_ö°r_«me
("ønge",
F_RANGE
);

1555 
ö°rs
[
F_RANGE
-
EFUN_FIRST
].
ty≥
[0] = 
T_POINTER
|
T_STRING
;

1556 
	}
}

1557 #unde‡
T_ANY


1560 
	$gë_f_«me
(
n
)

1562 i‡(
ö°rs
[
n
-
EFUN_FIRST
].
«me
)

1563  
ö°rs
[
n
-
EFUN_FIRST
].
«me
;

1565 
buf
[30];

1566 ()
	`•rötf
(
buf
, "<OTHER %d>", 
n
);

1567  
buf
;

1569 
	}
}

1573 
INLINE
 
	$lookup_¥edef
(*
s
)

1575  
	`lookupw‹d
(
s
, 
¥edefs
, 
	`NELEM
(predefs));

1576 
	}
}

1578 
	#NARGS
 25

	)

1579 
	#MARKS
 '@'

	)

1581 
	#SKIPWHITE
 
	`is•a˚
(*
p
)Ëp++

	)

1582 
	#GETALPHA
(
p
, 
q
, 
m
) \

1583 
	`ißlunum
(*
p
)) {\

1584 *
q
 = *
p
++;\

1585 i‡(
q
 < (
m
))\

1586 
q
++;\

1588 
	`Àxîr‹
("NameÅooÜong");\

1592 *
q
++ = 0

	)

1595 
	$cmygëc
()

1597 
c
;

1601 
c
 = 
	`mygëc
();

1602 i‡(
c
 == '/')

1604 i‡(
	`gobbÀ
('*'))

1605 
	`skù_commít
();

1607  
c
;

1609  
c
;

1611 
	}
}

1614 
	$ªfûl
()

1616 *
p
;

1617 
c
;

1619 
p
 = 
yyãxt
;

1621 
c
 = 
	`cmygëc
();

1622 i‡(
p
 < 
yyãxt
+
MAXLINE
-5)

1623 *
p
++ = 
c
;

1626 
	`Àxîr‹
("LineÅooÜong");

1629 } 
c
 !'\n' && c !
EOF
);

1630 
p
[-1] = ' ';

1631 *
p
 = 0;

1632 
√x∑nds
=0;

1633 
	`°‹e_löe_numbî_öfo
(
cuºít_öcfûe
, 
cuºít_löe
);

1634 
cuºít_löe
++;

1635 
	}
}

1638 
	$h™dÀ_deföe
(*
yyt
)

1640 
«mebuf
[
NSIZE
];

1641 
¨gs
[
NARGS
][
NSIZE
];

1642 
mãxt
[
MLEN
];

1643 *
p
, *
q
;

1645 
p
 = 
yyt
;

1646 ()
	`°rˇt
(
p
, " ");

1647 
q
 = 
«mebuf
;

1648 
	`GETALPHA
(
p
, 
q
, 
«mebuf
+
NSIZE
-1);

1649 i‡(*
p
 == '(') {

1650 
¨g
;

1651 
öid
;

1652 *
ids
 = 0;

1653 
p
++;

1654 
SKIPWHITE
;

1655 i‡(*
p
 == ')') {

1656 
¨g
 = 0;

1658 
¨g
 = 0;árg < 
NARGS
; ) {

1659 
q
 = 
¨gs
[
¨g
];

1660 
	`GETALPHA
(
p
, 
q
, 
¨gs
[
¨g
]+
NSIZE
-1);

1661 
¨g
++;

1662 
SKIPWHITE
;

1663 i‡(*
p
 == ')')

1665 i‡(*
p
++ != ',') {

1666 
	`Àxîr‹
("Missing ',' in #defineÖarameterÜist");

1669 
SKIPWHITE
;

1671 i‡(
¨g
 =
NARGS
) {

1672 
	`Àxîr‹
("Too many macroárguments");

1676 
p
++;

1677 
öid
 = 0, 
q
 = 
mãxt
; *
p
; ) {

1678 i‡(
	`ißlunum
(*
p
)) {

1679 i‡(!
öid
) {

1680 
öid
++;

1681 
ids
 = 
p
;

1684 i‡(
öid
) {

1685 
size_t
 
l
, 
idÀn
 = 
p
 - 
ids
;

1686 
n
;

1688 
n
 = 0;Ç < 
¨g
;Ç++) {

1689 
l
 = 
	`°æí
(
¨gs
[
n
]);

1690 i‡(
l
 =
idÀn
 && 
	`°∫cmp
(
¨gs
[
n
], 
ids
,Ü) == 0) {

1691 
q
 -
idÀn
;

1692 *
q
++ = 
MARKS
;

1693 *
q
++ = 
n
+
MARKS
+1;

1697 
öid
 = 0;

1700 *
q
 = *
p
;

1701 i‡(*
p
++ =
MARKS
)

1702 *++
q
 = 
MARKS
;

1703 i‡(
q
 < 
mãxt
+
MLEN
-2)

1704 
q
++;

1706 
	`Àxîr‹
("MacroÅextÅooÜong");

1709 i‡(!*
p
 &&Ö[-2] == '\\') {

1710 
q
 -= 2;

1711 
	`ªfûl
();

1712 
p
 = 
yyãxt
;

1715 *--
q
 = 0;

1716 
	`add_deföe
(
«mebuf
, 
¨g
, 
mãxt
);

1718 
q
 = 
mãxt
; *
p
; ) {

1719 *
q
 = *
p
++;

1720 i‡(
q
 < 
mãxt
+
MLEN
-2)

1721 
q
++;

1723 
	`Àxîr‹
("MacroÅextÅooÜong");

1726 i‡(!*
p
 &&Ö[-2] == '\\') {

1727 
q
 -= 2;

1728 
	`ªfûl
();

1729 
p
 = 
yyãxt
;

1732 *--
q
 = 0;

1733 
	`add_deföe
(
«mebuf
, -1, 
mãxt
);

1736 
	}
}

1739 
	$myungëc
(
c
)

1741 *--
ouç
 = 
c
;

1742 
nbuf
++;

1743 
	}
}

1746 
	$add_öput
(*
p
)

1748 
size_t
 
l
 = 
	`°æí
(
p
);

1750 i‡(
nbuf
+
l
 >
DEFMAX
-10) {

1751 
	`Àxîr‹
("MacroÉxpansion buffer overflow");

1754 
ouç
 -
l
;

1755 
nbuf
 +
l
;

1756 ()
	`°∫˝y
(
ouç
, 
p
, 
l
);

1757 
	}
}

1759 
	#DEFHASH
 33

	)

1760 
de‚
 *
	gde‚s
[
DEFHASH
];

1761 
	#defhash
(
s
Ë
	`hash°r
(s, 10, 
DEFHASH
)

	)

1764 
	$add_deföe
(*
«me
, 
«rgs
, *
exps
)

1766 
de‚
 *
p
;

1767 
h
;

1769 i‡–(
p
 = 
	`lookup_deföe
(
«me
)Ë!
NULL
 ) {

1770 i‡(
«rgs
 !
p
->«rg†|| 
	`°rcmp
(
exps
,Ö->exps) != 0) {

1771 
buf
[200+
NSIZE
];

1772 ()
	`•rötf
(
buf
, "Redeföôi⁄ o‡#deföê%s", 
«me
);

1773 
	`Àxîr‹
(
buf
);

1777 
p
 = (
de‚
 *)
	`xÆloc
((defn));

1778 
p
->
«me
 = 
	`xÆloc
(
	`°æí
(name)+1);

1779 ()
	`°r˝y
(
p
->
«me
,Çame);

1780 
p
->
undef
 = 0;

1781 
p
->
«rgs
 =Çargs;

1782 
p
->
exps
 = 
	`xÆloc
(
	`°æí
(exps)+1);

1783 ()
	`°r˝y
(
p
->
exps
,Éxps);

1784 
h
 = 
	`defhash
(
«me
);

1785 
p
->
√xt
 = 
de‚s
[
h
];

1786 
de‚s
[
h
] = 
p
;

1788 
	}
}

1791 
	$‰ì_deföes
()

1793 
de‚
 *
p
, *
q
;

1794 
i
;

1796 
i
 = 0; i < 
DEFHASH
; i++) {

1797 
p
 = 
de‚s
[
i
];Ö;Ö = 
q
) {

1798 
q
 = 
p
->
√xt
;

1799 
	`‰ì
(
p
->
«me
);

1800 
	`‰ì
(
p
->
exps
);

1801 
	`‰ì
((*)
p
);

1803 
de‚s
[
i
] = 0;

1805 
√x∑nds
 = 0;

1806 
	}
}

1808 
de‚
 *

1809 
	$lookup_deföe
(*
s
)

1811 
de‚
 *
p
;

1812 
h
;

1814 
h
 = 
	`defhash
(
s
);

1815 
p
 = 
de‚s
[
h
];Ö;Ö =Ö->
√xt
)

1816 i‡(!
p
->
undef
 && 
	`°rcmp
(
s
,Ö->
«me
) == 0)

1817  
p
;

1819 
	}
}

1821 
	#SKIPW
 \

1823 
c
 = 
	`cmygëc
();\

1824 } 
	`is•a˚
(
c
));

	)

1829 
	$ex∑nd_deföe
()

1831 
de‚
 *
p
;

1832 
expbuf
[
DEFMAX
];

1833 *
¨gs
[
NARGS
];

1834 
buf
[
DEFMAX
];

1835 *
q
, *
e
, *
b
;

1837 i‡(
√x∑nds
++ > 
EXPANDMAX
) {

1838 
	`Àxîr‹
("Too many macroÉxpansions");

1841 
p
 = 
	`lookup_deföe
(
yyãxt
);

1842 i‡(!
p
) {

1845 i‡(
p
->
«rgs
 == -1) {

1846 
	`add_öput
(
p
->
exps
);

1848 
c
, 
∑r˙t
 = 0, 
dquŸe
 = 0, 
squŸe
 = 0;

1849 
n
;

1850 
SKIPW
;

1851 i‡(
c
 != '(') {

1852 
	`Àxîr‹
("Missing '(' in macro call");

1855 
SKIPW
;

1856 i‡(
c
 == ')')

1857 
n
 = 0;

1859 
q
 = 
expbuf
;

1860 
¨gs
[0] = 
q
;

1861 
n
 = 0;Ç < 
NARGS
; ) {

1862 
c
) {

1863 '"': i‡(!
squŸe
Ë
dquŸe
 ^= 1; ;

1864 '\'': i‡(!
dquŸe
Ë
squŸe
 ^= 1; ;

1865 '(': i‡(!
squŸe
 && !
dquŸe
Ë
∑r˙t
++; ;

1866 ')': i‡(!
squŸe
 && !
dquŸe
Ë
∑r˙t
--; ;

1867 '\\': i‡(
squŸe
 || 
dquŸe
Ë{ *
q
++ = 
c
; c = 
	`mygëc
();} ;

1868 '\n': i‡(
squŸe
 || 
dquŸe
Ë{ 
	`Àxîr‹
("Newline in string");  0; } ;

1870 i‡(
c
 =',' && !
∑r˙t
 && !
dquŸe
 && !
squŸe
) {

1871 *
q
++ = 0;

1872 
¨gs
[++
n
] = 
q
;

1873 } i‡(
∑r˙t
 < 0) {

1874 *
q
++ = 0;

1875 
n
++;

1878 i‡(
c
 =
EOF
) {

1879 
	`Àxîr‹
("UnexpectedÉnd of file");

1882 i‡(
q
 >
expbuf
 + 
DEFMAX
 - 5) {

1883 
	`Àxîr‹
("Macroárgument overflow");

1886 *
q
++ = 
c
;

1889 i‡(!
squŸe
 && ! 
dquŸe
)

1890 
c
 = 
	`cmygëc
();

1892 
c
 = 
	`mygëc
();

1894 i‡(
n
 =
NARGS
) {

1895 
	`Àxîr‹
("Maximum macroárgument countÉxceeded");

1899 i‡(
n
 !
p
->
«rgs
) {

1900 
	`Àxîr‹
("WrongÇumber of macroárguments");

1904 
b
 = 
buf
;

1905 
e
 = 
p
->
exps
;

1906 *
e
) {

1907 i‡(*
e
 =
MARKS
) {

1908 i‡(*++
e
 =
MARKS
)

1909 *
b
++ = *
e
++;

1911 
q
 = 
¨gs
[*
e
++ - 
MARKS
 - 1]; *q; ) {

1912 *
b
++ = *
q
++;

1913 i‡(
b
 >
buf
+
DEFMAX
) {

1914 
	`Àxîr‹
("MacroÉxpansion overflow");

1920 *
b
++ = *
e
++;

1921 i‡(
b
 >
buf
+
DEFMAX
) {

1922 
	`Àxîr‹
("MacroÉxpansion overflow");

1927 *
b
++ = 0;

1928 
	`add_öput
(
buf
);

1931 
	}
}

1936 
	#SKPW
 dÿ
c
 = 
	`mygëc
(); 
	`is•a˚
(c)); 
	`myungëc
(c)

	)

1939 
	$exgëc
()

1941 
c
,*
yyp
;

1943 
c
 = 
	`mygëc
();

1944 
	`ißÕha
(
c
) || c=='_')

1946 
yyp
 = 
yyãxt
;

1948 
SAVEC
;

1949 
c
 = 
	`mygëc
();

1950 } 
	`ißlunum
(
c
));

1951 
	`myungëc
(
c
);

1952 *
yyp
 = '\0';

1953 i‡(
	`°rcmp
(
yyãxt
, "defined") == 0)

1957 
c
 = 
	`mygëc
();

1958 
	`is•a˚
(
c
));

1960 i‡(
c
 != '(')

1962 
	`Àxîr‹
("Missing ( in defined");

1966 
c
 = 
	`mygëc
();

1967 
	`is•a˚
(
c
));

1969 
yyp
 = 
yyãxt
;

1970 
	`ißlunum
(
c
))

1972 
SAVEC
;

1973 
c
 = 
	`mygëc
();

1975 *
yyp
 = '\0';

1976 
	`is•a˚
(
c
))

1977 
c
 = 
	`mygëc
();

1978 i‡(
c
 != ')')

1980 
	`Àxîr‹
("Missing ) in defined");

1983 
SKPW
;

1984 i‡(
	`lookup_deföe
(
yyãxt
))

1985 
	`add_öput
(" 1 ");

1987 
	`add_öput
(" 0 ");

1991 i‡(!
	`ex∑nd_deföe
()Ë
	`add_öput
(" 0 ");

1993 
c
 = 
	`mygëc
();

1995  
c
;

1996 
	}
}

1998 
	#BNOT
 1

	)

1999 
	#LNOT
 2

	)

2000 
	#UMINUS
 3

	)

2001 
	#UPLUS
 4

	)

2003 
	#MULT
 1

	)

2004 
	#DIV
 2

	)

2005 
	#MOD
 3

	)

2006 
	#BPLUS
 4

	)

2007 
	#BMINUS
 5

	)

2008 
	#LSHIFT
 6

	)

2009 
	#RSHIFT
 7

	)

2010 
	#LESS
 8

	)

2011 
	#LEQ
 9

	)

2012 
	#GREAT
 10

	)

2013 
	#GEQ
 11

	)

2014 
	#EQ
 12

	)

2015 
	#NEQ
 13

	)

2016 
	#BAND
 14

	)

2017 
	#XOR
 15

	)

2018 
	#BOR
 16

	)

2019 
	#LAND
 17

	)

2020 
	#LOR
 18

	)

2021 
	#QMARK
 19

	)

2023 
	g_›èb
[]=

2027 
	g›èb2
[]=

2028 {
BNOT
,0,0,
LNOT
,'=',
NEQ
,7,0,0,
UMINUS
,0,
BMINUS
,10,
UPLUS
,0,
BPLUS
,10,

2029 0,0,
MULT
,11,0,0,
DIV
,11,0,0,
MOD
,11,

2030 0,'<',
LSHIFT
,9,'=',
LEQ
,8,0,
LESS
,8,0,'>',
RSHIFT
,9,'=',
GEQ
,8,0,
GREAT
,8,

2031 0,'=',
EQ
,7,0,0,0,'&',
LAND
,3,0,
BAND
,6,0,'|',
LOR
,2,0,
BOR
,4,

2032 0,0,
XOR
,5,0,0,
QMARK
,1};

2033 
	#›èb1
 (
_›èb
-' ')

	)

2036 
	$c⁄d_gë_exp
(
¥i‹ôy
)

2038 
c
;

2039 
vÆue
, 
vÆue2
, 
x
;

2042 
c
 = 
	`exgëc
();

2043 
	`is•a˚
(
c
));

2045 i‡(
c
 == '(')

2047 
vÆue
 = 
	`c⁄d_gë_exp
(0);

2049 
c
 = 
	`exgëc
();

2050 
	`is•a˚
(
c
));

2051 i‡(
c
 != ')')

2053 
	`Àxîr‹
("bracketÇotÖaired in #if");

2054 i‡(!
c
)

2055 
	`myungëc
('\0');

2058 i‡(
	`i•un˘
(
c
))

2060 
x
 = 
›èb1
[
c
];

2061 i‡(!
x
)

2063 
	`Àxîr‹
("illegal character in #if");

2066 
vÆue
 = 
	`c⁄d_gë_exp
(12);

2067  
›èb2
[
x
-1] )

2069 
BNOT
 : 
vÆue
 = ~value; ;

2070 
LNOT
 : 
vÆue
 = !value; ;

2071 
UMINUS
: 
vÆue
 = -value; ;

2072 
UPLUS
 : 
vÆue
 = value; ;

2074 
	`Àxîr‹
("illegal unary operator in #if");

2080 
ba£
;

2082 i‡(!
	`isdigô
(
c
))

2084 i‡(!
c
)

2086 
	`Àxîr‹
("missingÉxpression in #if");

2087 
	`myungëc
('\0');

2090 
	`Àxîr‹
("illegal character in #if");

2093 
vÆue
 = 0;

2094 i‡(
c
!='0')

2095 
ba£
 = 10;

2098 
c
 = 
	`mygëc
();

2099 i‡–
c
 == 'x' || c == 'X' )

2101 
ba£
 = 16;

2102 
c
 = 
	`mygëc
();

2105 
ba£
=8;

2109 i‡–
	`isdigô
(
c
) )

2110 
x
 = -'0';

2111 i‡(
	`isuµî
(
c
))

2112 
x
 = -'A' + 10;

2113 i‡(
	`i¶owî
(
c
))

2114 
x
 = -'a' + 10;

2117 
x
 +
c
;

2118 i‡(
x
 > 
ba£
)

2120 
vÆue
 = vÆue*
ba£
 + 
x
;

2121 
c
 = 
	`mygëc
();

2123 
	`myungëc
(
c
);

2128 
c
 = 
	`exgëc
();

2129 
	`is•a˚
(
c
));

2131 i‡(!
	`i•un˘
(
c
))

2133 
x
 = 
›èb1
[
c
];

2134 i‡(!
x
)

2136 
vÆue2
 = 
	`mygëc
();

2137 ;;
x
 += 3)

2139 i‡(!
›èb2
[
x
])

2141 
	`myungëc
(
vÆue2
);

2142 i‡(!
›èb2
[
x
 + 1])

2144 
	`Àxîr‹
("illegal operator use in #if");

2149 i‡(
vÆue2
 =
›èb2
[
x
])

2152 i‡(
¥i‹ôy
 >
›èb2
[
x
 + 2])

2154 i‡(
›èb2
[
x
])

2155 
	`myungëc
(
vÆue2
);

2158 
vÆue2
 = 
	`c⁄d_gë_exp
(
›èb2
[
x
 + 2]);

2159  
›èb2
[
x
 + 1] )

2161 
MULT
 : 
vÆue
 *
vÆue2
; ;

2162 
DIV
 : 
vÆue
 /
vÆue2
; ;

2163 
MOD
 : 
vÆue
 %
vÆue2
; ;

2164 
BPLUS
 : 
vÆue
 +
vÆue2
; ;

2165 
BMINUS
 : 
vÆue
 -
vÆue2
; ;

2166 
LSHIFT
 : 
vÆue
 <<
vÆue2
; ;

2167 
RSHIFT
 : 
vÆue
 = ()vÆuê>> 
vÆue2
; ;

2168 
LESS
 : 
vÆue
 = vÆuê< 
vÆue2
; ;

2169 
LEQ
 : 
vÆue
 = vÆuê<
vÆue2
; ;

2170 
GREAT
 : 
vÆue
 = vÆuê> 
vÆue2
; ;

2171 
GEQ
 : 
vÆue
 = vÆuê>
vÆue2
; ;

2172 
EQ
 : 
vÆue
 = vÆuê=
vÆue2
; ;

2173 
NEQ
 : 
vÆue
 = vÆuê!
vÆue2
; ;

2174 
BAND
 : 
vÆue
 &
vÆue2
; ;

2175 
XOR
 : 
vÆue
 ^
vÆue2
; ;

2176 
BOR
 : 
vÆue
 |
vÆue2
; ;

2177 
LAND
 : 
vÆue
 = vÆuê&& 
vÆue2
; ;

2178 
LOR
 : 
vÆue
 = vÆuê|| 
vÆue2
; ;

2179 
QMARK
 :

2181 
c
 = 
	`exgëc
();

2182 
	`is•a˚
(
c
));

2183 i‡(
c
 != ':')

2185 
	`Àxîr‹
("'?' without ':' in #if");

2186 
	`myungëc
(
c
);

2189 i‡(
vÆue
)

2191 ()
	`c⁄d_gë_exp
(1);

2192 
vÆue
 = 
vÆue2
;

2194 
vÆue
 = 
	`c⁄d_gë_exp
(1);

2198 
	`myungëc
(
c
);

2199  
vÆue
;

2200 
	}
}

2202 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


2204 
	$‰ì_öc_li°
()

2206 
i
;

2208 
i
 = 0; i < 
öc_li°_size
; i++)

2209 
	`‰ì_s°rög
(
öc_li°
[
i
]);

2210 
	`‰ì
(
öc_li°
);

2211 
	}
}

2215 
	$£t_öc_li°
(
svÆue
 *
sv
)

2217 
i
;

2218 
ve˘‹
 *
v
;

2219 *
p
;

2221 i‡(
sv
 == 0)

2223 ()
	`Ârötf
(
°dîr
, "There must beá function 'define_include_dirs' in master.c.\n");

2224 ()
	`Ârötf
(
°dîr
, "This function shouldÑeturnánárray ofáll directoriesÅo be searched\n");

2225 ()
	`Ârötf
(
°dîr
, "for include files.\n");

2226 
	`exô
(1);

2228 i‡(
sv
->
ty≥
 !
T_POINTER
)

2230 ()
	`Ârötf
(
°dîr
, "'define_include_dirs' in master.c didÇotÑeturnánárray.\n");

2231 
	`exô
(1);

2233 
v
 = 
sv
->
u
.
vec
;

2234 
öc_li°
 = (**Ë
	`xÆloc
(
v
->
size
 *  (*));

2235 
öc_li°_size
 = 
v
->
size
;

2236 
i
 = 0; i < 
v
->
size
; i++)

2238 i‡(
v
->
ôem
[
i
].
ty≥
 !
T_STRING
)

2240 ()
	`Ârötf
(
°dîr
, "Illegal valueÑeturned from 'define_include_dirs' in master.c\n");

2241 
	`exô
(1);

2243 
p
 = 
v
->
ôem
[
i
].
u
.
°rög
;

2244 i‡(*
p
 == '/')

2245 
p
++;

2249 i‡(!
	`ÀgÆ_∑th
(
p
))

2251 ()
	`Ârötf
(
°dîr
, "'define_include_dirs' must giveÖaths withoutány '..'\n");

2252 
	`exô
(1);

2254 
öc_li°
[
i
] = 
	`make_s°rög
(
p
);

2256 
	}
}

	@lex.h

1 
	#MLEN
 8192

	)

2 
	#NSIZE
 256

	)

4 
	sÕc_¥edef_s
 {

5 *
	mÊag
;

6 
Õc_¥edef_s
 *
	m√xt
;

9 
Õc_¥edef_s
 *
Õc_¥edefs
;

10 
°¨t_√w_fûe
(
FILE
 *
f
);

11 
íd_√w_fûe
();

12 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


13 
‰ì_öc_li°
();

	@lint.h

1 #i‚de‡
_löt_h_


2 
	#_löt_h_


	)

4 
	~<sys/ty≥s.h
>

5 
	~<£tjmp.h
>

6 
	~<°dlib.h
>

7 
	~<uni°d.h
>

9 
	~"ma°î.h
"

11 #i‡
deföed
(
löux
Ë&& (deföed(
mÆloc
Ë|| deföed(
ˇŒoc
))

13 #unde‡
mÆloc


14 #unde‡
ˇŒoc


17 #ifde‡
MALLOC_dmÆloc


18 
	~<dmÆloc.h
>

19 
	#xÆloc
 
mÆloc


	)

25 
	#DEBUG_CHK_REF
 1

	)

26 
	#DEBUG_RESET
 2

	)

27 
	#DEBUG_CLEAN_UP
 4

	)

28 
	#DEBUG_SWAP
 8

	)

29 
	#DEBUG_OUTPUT
 16

	)

30 
	#DEBUG_CONNECT
 32

	)

31 
	#DEBUG_TELNET
 64

	)

32 
	#DEBUG_RESTORE
 128

	)

33 
	#DEBUG_OB_REF
 256

	)

34 
	#DEBUG_PROG_REF
 512

	)

35 
	#DEBUG_LOAD
 1024

	)

36 
	#DEBUG_DESTRUCT
 2048

	)

37 
	#DEBUG_LIVING
 4096

	)

38 
	#DEBUG_COMMAND
 8192

	)

39 
	#DEBUG_ADD_ACTION
 16384

	)

40 
	#DEBUG_SENTENCE
 32768

	)

41 
	#DEBUG_BREAK_POINT
 65536

	)

43 
	g¥ogøm
;

44 
	gfun˘i⁄
;

45 
	gsvÆue
;

46 
	gsockaddr
;

47 
	gªloc
;

48 
	gobje˘
;

49 
	gm≠pög
;

50 
	gve˘‹
;

51 
	g˛osuª
;

53 #i‡
deföed
(
__GNUC__
Ë&& !deföed(
löt
Ë&& !deföed(
PROFILE
)

54 
	#INLINE
 
ölöe


	)

56 
	#INLINE


	)

59 #ifde‡
SOLARIS


60 
	#sig«l
 
sig£t


	)

61 
	#HAS_PREAD


	)

65 #ifde‡
BUFSIZ


66 
	#PROT_STDIO
(
x
Ë
	)
x

68 
	#PROT_STDIO
(
x
Ë()

	)

71 #i‡
deföed
(
__Æpha
)

72 
mkdú
 (*, );

74 
p˛o£
 
PROT_STDIO
((
FILE
 *));

75 #i‡!
deföed
(
_SEQUENT_
Ë&& !deföed(
__O≥nBSD__
Ë&& !deföed(
__NëBSD__
) && \

76 !
deföed
(
__FªeBSD__
Ë&& !
	$deföed
(
__bsdi__
)

77 
	`©oi
 (*);

79 #i‡!
	`deföed
(
sgi
Ë&& !deföed(
__Æpha
Ë&& !deföed(
__O≥nBSD__
) && \

80 !
	`deföed
(
__NëBSD__
Ë&& !deföed(
__FªeBSD__
Ë&& !
	$deföed
(
__bsdi__
)

81 
	`§™dom
 ();

83 
	`gëho°«me
 (*, );

84 
	`ab‹t
 ();

85 #i‡!
	`deföed
(
sgi
Ë&& !deföed(
_SEQUENT_
Ë&& !deföed(
__O≥nBSD__
) && \

86 !
	`deföed
(
__NëBSD__
Ë&& !deföed(
__FªeBSD__
Ë&& !
	$deföed
(
__bsdi__
)

88 #ifde‡
u…rix


89 
	`_Êsbuf
(,
FILE
 *);

91 
	`_Êsbuf
();

93 
	`waô
 (*);

94 
	`pùe
 (*);

95 
	`dup2
 (, );

96 
	`Æ¨m
 ();

97 
	`˛o£
 ();

98 
	`_fûbuf
();

99 #i‡!
	`deföed
(
__O≥nBSD__
Ë&& !deföed(
__NëBSD__
Ë&& !deföed(
__FªeBSD__
)

100 *
	`¸y±
 (*, *);

103 #ifde‡
DRAND48


104 
	`dønd48
 ();

105 
	`§™d48
 ();

107 #ifde‡
RANDOM


108 
	`øndom
 ();

111 #i‡!
	`deföed
(
_SEQUENT_
Ë&& !deföed(
__O≥nBSD__
Ë&& !deföed(
__NëBSD__
) && \

112 !
	`deföed
(
__FªeBSD__
Ë&& !
	$deföed
(
__bsdi__
)

113 
	`°πﬁ
 (*, **, );

117 #i‡
	`deföed
(
sun
Ë|| deföed(
SOLARIS
)

118 *
	`_¸y±
 (*, *);

121 #i‚de‡
USE_SWAP


122 
	#ac˚ss_¥ogøm
(
¥og
Ë0

	)

123 
	#ac˚ss_obje˘
(
ob
Ë0

	)

125 
	`ac˚ss_¥ogøm
(
¥ogøm
 *);

126 
	`ac˚ss_obje˘
(
obje˘
 *);

128 
	`wrôe_fûe
 (*, *);

129 
	`fûe_size
 (*);

130 
	`fûe_time
 (*);

131 
	`ªmove_Æl_∂ayîs
 ();

132 
	`backíd
 ();

133 #i‚de‡
MALLOC_dmÆloc


134 *
	`xÆloc
 ();

136 *
	`tm∑Œoc
 (
size_t
);

137 
	`√w_ˇŒ_out
 (
˛osuª
 *, , );

138 
	`add_a˘i⁄
 (
˛osuª
 *, 
svÆue
 *, );

140 
	`íabÀ_comm™ds
 ();

141 
	`ªgi°î_¥ogøm
(
¥ogøm
*);

142 
	`èû
 (*);

143 
obje˘
 *
	`gë_öãø˘ive_obje˘
 ();

144 
	`íãr_obje˘_hash
 (
obje˘
 *);

145 
	`ªmove_obje˘_hash
 (
obje˘
 *);

146 
obje˘
 *
	`lookup_obje˘_hash
 (*);

147 
	`add_ŸabÀ_°©us
 (*);

148 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


149 
	`˛ór_ŸabÀ
();

151 
	`‰ì_ve˘‹
 (
ve˘‹
 *);

152 *
	`quîy_lﬂd_av
 ();

153 
	`upd©e_compûe_av
 ();

154 
ve˘‹
 *
	`m≠_¨øy
 (ve˘‹ *
¨r
, 
˛osuª
 *);

155 
ve˘‹
 *
	`make_unique
 (ve˘‹ *
¨r
,*
func
, 
svÆue
 *
skùnum
);

157 
ve˘‹
 *
	`fûãr_¨r
 (ve˘‹ *
¨r
, 
˛osuª
 *);

158 
	`m©ch_°rög
 (*, *);

159 
obje˘
 *
	`gë_em±y_obje˘
 ();

160 
	`assign_svÆue
 (
svÆue
 *, svalue *);

161 
	`assign_svÆue_no_‰ì
 (
svÆue
 *
to
, svÆuê*
‰om
);

162 
	`add_°rög_°©us
 (*);

163 
	`nŸify_no_comm™d
 ();

164 
	`˛ór_nŸify
 ();

165 
	`throw_îr‹
 ();

166 
	`ˇŒ_v¨
(, 
˛osuª
 *);

167 *
	`show_˛osuª
(
˛osuª
 *
f
);

168 *
	`gë˛osuª«me
(
˛osuª
 *);

169 
˛osuª
 *
	`Æloc_˛osuª
();

170 
	`ÀgÆ_˛osuª
(
˛osuª
 *);

171 
	`£t_livög_«me
 (
obje˘
 *,*);

172 
	`ªmove_livög_«me
 (
obje˘
 *);

173 
obje˘
 *
	`föd_livög_obje˘
 (*);

174 
	`lookup_¥edef
 (*);

175 
	`yyîr‹
 (*);

176 
	`hash°r
 (*, , );

177 *
	`dump_åa˚
 ();

178 
	`lﬂd_∑r£_öf‹m©i⁄
 ();

179 
	`‰ì_∑r£_öf‹m©i⁄
 ();

180 
	`∑r£_comm™d
 (*, 
obje˘
 *);

181 
svÆue
 *
	`≠∂y
 (*, 
obje˘
 *, , );

182 
INLINE
 
	`push_°rög
 (*, );

183 
INLINE
 
	`push_m°rög
 (*);

184 
	`push_numbî
 ();

185 
	`push_obje˘
 (
obje˘
 *);

186 
obje˘
 *
	`˛⁄e_obje˘
 (*);

187 
	`öô_num_¨gs
 ();

188 
	`ª°‹e_obje˘
 (
obje˘
 *, *);

189 
	`m_ª°‹e_obje˘
 (
obje˘
 *, 
m≠pög
 *);

190 
m≠pög
 *
	`m_ßve_obje˘
(
obje˘
 *);

191 
ve˘‹
 *
	`¶i˚_¨øy
 (vector *,,);

192 
	`quîy_idÀ
 (
obje˘
 *);

193 *
	`im∂ode_°rög
 (
ve˘‹
 *, *);

194 
obje˘
 *
	`quîy_¢o›
 (object *);

195 
ve˘‹
 *
	`Æl_övít‹y
 (
obje˘
 *);

196 
ve˘‹
 *
	`dìp_övít‹y
 (
obje˘
 *, );

197 
obje˘
 *
	`ívú⁄mít
 (
svÆue
 *);

198 
ve˘‹
 *
	`add_¨øy
 (vector *, vector *);

199 *
	`gë_f_«me
 ();

200 
	`°¨tshutdowngame
 ();

201 
	`£t_nŸify_Áû_mesßge
 (*, );

202 
ve˘‹
 *
	`u£rs
 ();

203 
	`de°ru˘_obje˘
 (
obje˘
 *);

204 
	`£t_¢o›
 (
obje˘
 *, object *);

205 
	`ed_°¨t
 (*, 
˛osuª
 *);

206 
	`comm™d_f‹_obje˘
 (*, 
obje˘
 *);

207 
	`ªmove_fûe
 (*);

208 
	`öput_to
 (
˛osuª
 *, );

209 
	`∑r£
 (*, 
svÆue
 *, *, svalue *, );

210 
obje˘
 *
	`obje˘_¥e£¡
 (
svÆue
 *, svalue *);

211 
	`ˇŒ_fun˘i⁄
 (
obje˘
 *, , , );

212 
	`°‹e_löe_numbî_öfo
 (, );

213 
	`föd_°©us
 (
¥ogøm
 *, *, );

214 
	`‰ì_¥og
 (
¥ogøm
 *);

215 *
	`°©_livög_obje˘s
 ();

216 #ifde‡
OPCPROF


217 
	`›cdump
 ();

219 
	`¶ow_shut_down
 ();

220 
ve˘‹
 *
	`Æloˇã_¨øy
 ();

221 
	`ª£t_machöe
 ();

222 
	`˛ór_°©e
 ();

223 
	`¥ñﬂd_obje˘s
 ();

224 
	`øndom_numbî
 (, );

225 
	`ª∂a˚_öãø˘ive
 (
obje˘
 *
ob
, obje˘ *
obf
, *);

226 
	`gë_cuºít_time
 ();

227 *
	`time_°rög
 ();

228 *
	`¥o˚ss_°rög
 (*, );

229 #ifde‡
DEBUG


230 
	`upd©e_ªf_cou¡s_f‹_∂ayîs
 ();

231 
	`cou¡_ªf_‰om_ˇŒ_outs
 ();

232 
	`check_a_lŸ_ªf_cou¡s
 (
¥ogøm
 *);

234 *
	`ªad_fûe
 (*
fûe
, , );

235 *
	`ªad_byãs
 (*
fûe
, , 
size_t
);

236 
	`wrôe_byãs
 (*
fûe
, , *
°r
);

237 *
	`check_vÆid_∑th
 (*, 
obje˘
 *, *, );

238 *
	`gë_§ccode_posôi⁄_if_™y
 ();

239 
	`log⁄
 (
obje˘
 *
ob
);

240 
svÆue
 *
	`≠∂y_ma°î_ob
 (, 
num_¨g
);

241 
ve˘‹
 *
	`ex∂ode_°rög
 (*
°r
, *
dñ
);

242 *
	`°rög_c›y
 (*);

243 
	`ªmove_obje˘_‰om_°ack
 (
obje˘
 *
ob
);

244 #i‡!
	`deföed
(
sgi
Ë&& !deföed(
_SEQUENT_
Ë&& !deföed(
löux
Ë&& !deföed(
__O≥nBSD__
)

245 
	`gë≥î«me
 (, 
sockaddr
 *, *);

246 
	`shutdown
 (, );

248 
	`compûe_fûe
 ();

249 #ifde‡
USE_SWAP


250 
	`u∆ök_sw≠_fûe
();

251 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


252 
	`˛o£_sw≠_fûe
();

255 *
	`fun˘i⁄_exi°s
 (*, 
obje˘
 *);

256 
	`£t_öc_li°
 (
svÆue
 *
sv
);

257 
	`ÀgÆ_∑th
 (*
∑th
);

258 
ve˘‹
 *
	`gë_dú
 (*
∑th
);

259 #i‡!
	`deföed
(
u…rix
Ë&& !deföed(
M_UNIX
Ë&& !deföed(
sgi
Ë&& !deföed(
NeXT
) \

260 && !
	`deföed
(
_SEQUENT_
Ë&& !deföed(
löux
Ë&& !
	$deföed
(
__O≥nBSD__
)

261 
	`ª«me
 (const *, const *);

263 
	`gë_simul_efun
 ();

264 
obje˘
 *
simul_efun_ob
;

265 
ve˘‹
 *
	`m©ch_ªgexp
 (ve˘‹ *
v
, *
∑âîn
);

267 *
	`gë_§ccode_posôi⁄
(, 
¥ogøm
 *);

268 #ifde‡
BINARIES


269 
	`ßve_bö¨y
(
¥ogøm
 *);

270 
	`lﬂd_bö¨y
(
FILE
 *, *);

275 #i‡!
	`deföed
(
__O≥nBSD__
Ë&& !deföed(
__NëBSD__
Ë&& !deföed(
__FªeBSD__
) \

276 && !
	`deföed
(
__bsdi__
Ë&& !deföed(
löux
Ë&& !
	$deföed
(
MALLOC_dmÆloc
)

277 *
	`mÆloc
(
size_t
);

278 
	`‰ì
(*);

279 *
	`ªÆloc
(*, 
size_t
);

	@main.c

1 
	~"c⁄fig.h
"

2 
	~<sys/ty≥s.h
>

3 
	~<sys/°©.h
>

4 
	~<f˙é.h
>

5 
	~<î∫o.h
>

6 
	~<mem‹y.h
>

7 
	~<°dio.h
>

8 
	~<°dlib.h
>

9 
	~<°rög.h
>

10 
	~<m©h.h
>

11 
	~<sig«l.h
>

12 #i‡
deföed
(
sun
Ë|| deföed(
__osf__
)

13 
	~<Æloˇ.h
>

15 
	~<°d¨g.h
>

17 
	~"löt.h
"

18 
	~"öãΩªt.h
"

19 
	~"obje˘.h
"

20 
	~"Àx.h
"

21 
	~"exec.h
"

22 
	~"mud°©.h
"

23 
	~"comm1.h
"

24 
	~"simuœã.h
"

25 
	~"sw≠.h
"

27 #ifde‡
DRAND48


28 
	~"dønd48.h
"

31 
cuºít_löe
;

33 
	gd_Êag
 = 0;

34 
	gt_Êag
 = 0;

35 
	ge_Êag
 = 0;

36 
	gs_Êag
 = 0;

37 
	gno_ù_dem⁄
 = 0;

38 
	gu∆imôed
 = 0;

39 
	gcomp_Êag
 = 0;

40 
	gw¨nobsﬁëeÊag
 = 0;

41 
	gdrivî_mtime
;

43 
öô_sig«ls
();

44 
¸óã_obje˘
(
obje˘
 *
ob
);

45 
öô_ˇŒ_out
();

47 #ifde‡
YYDEBUG


48 
yydebug
;

51 
	gp‹t_numbî
 = 
PORTNO
;

52 #ifde‡
CATCH_UDP_PORT


53 
	gudp_p‹t
 = 
CATCH_UDP_PORT
;

55 #ifde‡
SERVICE_PORT


56 
	g£rvi˚_p‹t
 = 
SERVICE_PORT
;

58 *
	gª£rved_¨ó
;

59 
svÆue
 
	gc⁄°0
, 
	gc⁄°1
, 
	gc⁄°em±y
;

60 
˛osuª
 
	gfun˚m±y
;

62 
	gc⁄°s
[5];

64 
obje˘
 *
vbfc_obje˘
;

66 
obje˘
 *
ma°î_ob
, *
auto_ob
;

69 
	$maö
(
¨gc
, **
¨gv
)

71 
game_is_beög_shut_down
;

72 
cuºít_time
;

73 
i
, 
√w_mudlib
 = 0;

74 *
p
;

75 
svÆue
 *
ªt
;

76 
svÆue
 
ˇtch_vÆue
;

77 
	`öô_cfuns
();

78 
gdex˚±i⁄
 
ex˚±i⁄_‰ame
;

80 *
d∑th
;

81 
°©
 
c_°
;

83 #ifde‡
MALLOC_debugmÆloc


84 
	`mÆloc_£tup_hook
();

85 
	`mÆloc_£tup_hook
();

88 #ifde‡
MALLOC_gc


89 
	`gc_öô
();

90 
	`gc_öô
();

93 #ifde‡
MALLOC_sysmÆloc


94 
	`sysmÆloc_öô
();

95 
	`sysmÆloc_öô
();

98 #ifde‡
_SEQUENT_


99 
	`£tdèbÀsize
(1024);

102 #i‚de‡
SOLARIS


103 ()
	`£éöebuf
(
°dout
);

106 
c⁄°0
.
ty≥
 = 
T_NUMBER
; c⁄°0.
u
.
numbî
 = 0;

107 
c⁄°1
.
ty≥
 = 
T_NUMBER
; c⁄°1.
u
.
numbî
 = 1;

108 
c⁄°em±y
.
ty≥
 = 
T_FUNCTION
; c⁄°em±y.
u
.
func
 = &
fun˚m±y
;

109 
fun˚m±y
.
fu¡y≥
 = 
FUN_EMPTY
;

110 
ˇtch_vÆue
 = 
c⁄°0
;

115 #ifde‡
__INSIGHT__


116 
i
 = 0;

118 
p
 = (*)&
i
;

119 *
p
 = -10;

120 i‡(
	`EXTRACT_UCHAR
(
p
) != 0x100 - 10)

122 ()
	`Ârötf
(
°dîr
, "Bad definition of EXTRACT_UCHAR() in config.h.\n");

123 
	`exô
(1);

125 
	`£t_cuºít_time
();

126 #ifde‡
DRAND48


127 
	`§™d48
(()
cuºít_time
);

129 #ifde‡
RANDOM


130 
	`§™dom
(
cuºít_time
);

132 ()
	`Ârötf
(
°dîr
, "NoÑandom generator specified!\n");

136 #i‡
RESERVED_SIZE
 > 0

137 
ª£rved_¨ó
 = 
	`mÆloc
(
RESERVED_SIZE
);

139 
i
=0; i <  
c⁄°s
 /  consts[0]; i++)

140 
c⁄°s
[
i
] = 
	`exp
(- i / 900.0);

141 
	`öô_num_¨gs
();

142 
	`ª£t_machöe
(1);

143 
	`öô_cfuns
();

148 
	`öô_sig«ls
();

150 #ifde‡
BINARIES


157 
d∑th
 = (*Ë
	`xÆloc
(
	`°æí
(
¨gv
[0]) + 1);

158 ()
	`°r˝y
(
d∑th
, 
¨gv
[0]);

159 i‡(
	`°©
(
d∑th
, &
c_°
) != -1)

160 
drivî_mtime
 = ()
c_°
.
°_mtime
;

163 ()
	`Ârötf
(
°dîr
,"Can't find myself %s, ignoring old binaries.\n",

164 
d∑th
);

165 
drivî_mtime
 = 
cuºít_time
;

167 
	`‰ì
(
d∑th
);

176 
i
 = 1; i < 
¨gc
; i++)

178 i‡(
	`©oi
(
¨gv
[
i
]))

179 
p‹t_numbî
 = 
	`©oi
(
¨gv
[
i
]);

180 i‡(
¨gv
[
i
][0] != '-')

182 
¨gv
[
i
][1])

185 i‡(
¨gv
[
i
][2]) {

187 
Õc_¥edef_s
 *
tmp
;

189 
tmp
 = (
Õc_¥edef_s
 *)

190 
	`xÆloc
((
Õc_¥edef_s
));

191 i‡(!
tmp
)

192 
	`Áèl
("xalloc failed\n");

193 
tmp
->
Êag
 = 
	`°rög_c›y
(
¨gv
[
i
]+2);

194 
tmp
->
√xt
 = 
Õc_¥edefs
;

195 
Õc_¥edefs
 = 
tmp
;

198 ()
	`Ârötf
(
°dîr
, "IŒegÆ fœg sy¡ax: %s\n", 
¨gv
[
i
]);

199 
	`exô
(1);

202 
no_ù_dem⁄
++; ;

204 i‡(
	`chdú
(
¨gv
[
i
]+2) == -1)

206 ()
	`Ârötf
(
°dîr
, "Bad mudlib dúe˘‹y: %s\n", 
¨gv
[
i
]+2);

207 
	`exô
(1);

209 
√w_mudlib
 = 1;

214 i‡(!
√w_mudlib
 && 
	`chdú
(
MUD_LIB
) == -1) {

215 ()
	`Ârötf
(
°dîr
, "Bad mudlib dúe˘‹y: %s\n", 
MUD_LIB
);

216 
	`exô
(1);

219 #ifde‡
USE_SWAP


221 
	`öô_sw≠
();

224 i‡(
	`£tjmp
(
ex˚±i⁄_‰ame
.
e_c⁄ãxt
))

226 
	`˛ór_°©e
();

227 
	`add_mesßge
("Anomaly inÅhe fabric of world space.\n");

231 
ex˚±i⁄_‰ame
.
e_ex˚±i⁄
 = 
NULL
;

232 
ex˚±i⁄_‰ame
.
e_ˇtch
 = 0;

233 
ex˚±i⁄
 = &
ex˚±i⁄_‰ame
;

234 
auto_ob
 = 0;

235 i‡((
auto_ob
 = 
	`lﬂd_obje˘
("£cuª/auto", 1, 0, 0)Ë!
NULL
)

237 
	`add_ªf
(
auto_ob
, "main");

238 
auto_ob
->
¥og
->
Êags
 |
PRAGMA_RESIDENT
;

241 
	`gë_simul_efun
();

242 
ma°î_ob
 = 
	`lﬂd_obje˘
("secure/master", 1, 0, 0);

243 i‡(
ma°î_ob
)

245 
	`ma°î_ob_lﬂded
();

250 
	`add_ªf
(
ma°î_ob
, "main");

251 
ma°î_ob
->
¥og
->
Êags
 |
PRAGMA_RESIDENT
;

252 
	`ma°î_ob_lﬂded
();

253 
	`¸óã_obje˘
(
ma°î_ob
);

254 
	`˛ór_°©e
();

257 
ex˚±i⁄
 = 
NULL
;

258 i‡(
auto_ob
 == 0)

260 ()
	`Ârötf
(
°dîr
, "The file secure/auto must beÜoadable.\n");

261 
	`exô
(1);

263 i‡(
ma°î_ob
 == 0)

265 ()
	`Ârötf
(
°dîr
, "The file secure/master must beÜoadable.\n");

266 
	`exô
(1);

268 
	`£t_öc_li°
(
	`≠∂y_ma°î_ob
(
M_DEFINE_INCLUDE_DIRS
, 0));

270 
svÆue
* 
ªt1
;

272 
ªt1
 = 
	`≠∂y_ma°î_ob
(
M_PREDEF_DEFINES
, 0);

273 i‡(
ªt1
 &&Ñë1->
ty≥
 =
T_POINTER
)

275 
ii
;

276 
Õc_¥edef_s
 *
tmp
;

278 
ii
 = 0; iò< 
ªt1
->
u
.
vec
->
size
; ii++)

279 i‡(
ªt1
->
u
.
vec
->
ôem
[
ii
].
ty≥
 =
T_STRING
)

281 
tmp
 = (
Õc_¥edef_s
 *)

282 
	`xÆloc
((
Õc_¥edef_s
));

283 
tmp
->
Êag
 = 
	`°rög_c›y
(
ªt1
->
u
.
vec
->
ôem
[
ii
].u.
°rög
);

284 
tmp
->
√xt
 = 
Õc_¥edefs
;

285 
Õc_¥edefs
 = 
tmp
;

289 
i
 = 1; i < 
¨gc
; i++)

291 i‡(
	`©oi
(
¨gv
[
i
]))

293 i‡(
¨gv
[
i
][0] != '-')

295 ()
	`Ârötf
(
°dîr
, "Badárgumíà%s\n", 
¨gv
[
i
]);

296 
	`exô
(1);

303 
¨gv
[
i
][1])

306 
	`push_°rög
(
¨gv
[
i
]+2, 
STRING_MSTRING
);

307 ()
	`≠∂y_ma°î_ob
(
M_FLAG
, 1);

308 i‡(
game_is_beög_shut_down
)

310 ()
	`Ârötf
(
°dîr
, "Shutdown by master object.\n");

311 
	`exô
(0);

315 
e_Êag
++; ;

317 
w¨nobsﬁëeÊag
++; ;

325 
d_Êag
 = 
	`©oi
(
¨gv
[
i
] + 2);

328 
comp_Êag
++; ;

330 
u∆imôed
++;

333 
t_Êag
++; ;

335 
s_Êag
++;

336 
	`mud°©us_£t
(1, -1, -1);

339 #ifde‡
CATCH_UDP_PORT


340 
udp_p‹t
 = 
	`©oi
 (&
¨gv
[
i
][2]);

344 #ifde‡
SERVICE_PORT


345 
£rvi˚_p‹t
 = 
	`©oi
 (&
¨gv
[
i
][2]);

349 #ifde‡
YYDEBUG


350 
yydebug
 = 1;

354 ()
	`Ârötf
(
°dîr
, "Unknow¿Êag: %s\n", 
¨gv
[
i
]);

355 
	`exô
(1);

363 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_GET_MUD_NAME
, 0);

365 i‡(
ªt
 &&Ñë->
ty≥
 =
T_STRING
)

367 
Õc_¥edef_s
 *
tmp
;

369 
tmp
 = (
Õc_¥edef_s
 *)

370 
	`xÆloc
((
Õc_¥edef_s
));

371 i‡(!
tmp
)

372 
	`Áèl
("xalloc failed\n");

373 
tmp
->
Êag
 = 
	`°rög_c›y
(
ªt
->
u
.
°rög
);

374 
tmp
->
√xt
 = 
Õc_¥edefs
;

375 
Õc_¥edefs
 = 
tmp
;

378 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_GET_VBFC_OBJECT
, 0);

379 i‡(
ªt
 &&Ñë->
ty≥
 =
T_OBJECT
)

381 
vbfc_obje˘
 = 
ªt
->
u
.
ob
;

382 
	`INCREF
(
vbfc_obje˘
->
ªf
);

385 
vbfc_obje˘
 = 0;

387 i‡(
game_is_beög_shut_down
)

388 
	`exô
(1);

390 i‡(!
t_Êag
)

391 
	`öô_ˇŒ_out
();

393 
	`¥ñﬂd_obje˘s
(
e_Êag
);

394 ()
	`≠∂y_ma°î_ob
(
M_FINAL_BOOT
, 0);

396 
	`backíd
();

399 
	}
}

401 *
	$°rög_c›y
(
°r
)

402 *
°r
;

404 *
p
;

406 
p
 = 
	`xÆloc
(
	`°æí
(
°r
)+1);

407 ()
	`°r˝y
(
p
, 
°r
);

408  
p
;

409 
	}
}

413 
	$debug_mesßge
(*
fmt
, ...)

415 
va_li°
 
¨gp
;

416 *
f
;

418 
FILE
 *
Â
 = 
NULL
;

419 
deb
[100];

420 
«me
[100];

422 i‡(
Â
 =
NULL
) {

423 #ifde‡
_SEQUENT_


424 ()
	`°r˝y
(
deb
, "log/debug.log");

426 ()
	`gëho°«me
(
«me
,Çame);

427 i‡((
f
 = 
	`°rchr
(
«me
, '.')Ë!
NULL
)

428 *
f
 = '\0';

429 ()
	`•rötf
(
deb
,"%s.debug.log",
«me
);

431 
Â
 = 
	`f›í
(
deb
, "w");

432 i‡(
Â
 =
NULL
) {

433 
	`≥º‹
(
deb
);

434 
	`ab‹t
();

438 
	`va_°¨t
(
¨gp
, 
fmt
);

439 ()
	`vÂrötf
(
Â
, 
fmt
, 
¨gp
);

441 
	`va_íd
(
¨gp
);

442 ()
	`fÊush
(
Â
);

443 
	}
}

446 
	$debug_mesßge_svÆue
(
svÆue
 *
v
)

448 i‡(
v
 == 0)

450 
	`debug_mesßge
("<NULL>");

453 
v
->
ty≥
)

455 
T_NUMBER
:

456 
	`debug_mesßge
("%d", 
v
->
u
.
numbî
);

458 
T_STRING
:

459 
	`debug_mesßge
("\"%s\"", 
v
->
u
.
°rög
);

461 
T_OBJECT
:

462 
	`debug_mesßge
("OBJ(%s)", 
v
->
u
.
ob
->
«me
);

464 
T_LVALUE
:

465 
	`debug_mesßge
("PointerÅo ");

466 
	`debug_mesßge_svÆue
(
v
->
u
.
lvÆue
);

469 
	`debug_mesßge
("<INVALID>\n");

472 
	}
}

474 
	g¶ow_shut_down_to_do
 = 0;

476 #i‚de‡
MALLOC_dmÆloc


477 #ifde‡
mÆloc


478 #unde‡
mÆloc


484 
	$xÆloc
(
size
)

486 *
p
;

487 
goög_to_exô
;

489 i‡(
goög_to_exô
)

490 
	`exô
(3);

491 i‡(
size
 == 0)

492 
size
 = 1;

493 #ifde‡
MALLOCSIZE


495 
	#MSMAX
 1000

	)

496 
msize
[
MSMAX
];

497 
mbig
;

498 
m˙t
;

500 i‡(
size
 > 
MSMAX
Ë
mbig
++;

501 
msize
[
size
]++;

502 i‡(++
m˙t
 % 50000 == 0) {

503 
i
;

504 ()
	`Ârötf
(
°dîr
, "MÆlo¯°©†(%d):\n", 
m˙t
);

505 
i
 = 0; i<
MSMAX
; i++)

506 i‡(
msize
[
i
])

507 ()
	`Ârötf
(
°dîr
, "%4d %5d\n", 
i
, 
msize
[i]);

508 ()
	`Ârötf
(
°dîr
, ">%d %d\n", 
i
, 
mbig
);

512 
p
 = (*)
	`mÆloc
(
size
);

515 
i
;

516 
i
 = 0; i < 
size
; i++)

517 
p
[
i
] = 0x55;

520 i‡(
p
 == 0)

522 i‡(
ª£rved_¨ó
)

524 
	`‰ì
(
ª£rved_¨ó
);

525 
ª£rved_¨ó
 = 0;

526 
p
 = "Temporary out of MEMORY. FreeingÑeserve.\n";

527 ()
	`wrôe
(1, 
p
, 
	`°æí
(p));

528 
¶ow_shut_down_to_do
 = 6;

529  
	`xÆloc
(
size
);

531 
goög_to_exô
 = 1;

532 
p
 = "Totally out of MEMORY.\n";

533 ()
	`wrôe
(1, 
p
, 
	`°æí
(p));

534 ()
	`dump_åa˚
(0);

535 
	`exô
(2);

537  
p
;

538 
	}
}

	@main.h

1 
debug_mesßge
(*
fmt
, ...);

	@make_func.y

2 
	~<°dio.h
>

3 
	~<˘y≥.h
>

4 
	~<°rög.h
>

5 
	~<f˙é.h
>

6 
	~<uni°d.h
>

7 
	~<°dlib.h
>

8 
	~"c⁄fig.h
"

10 
	#FUNC_SPEC
 "func_•ec.i"

	)

11 
	#FUNC_TOKENS
 "efun_tokís.y"

	)

12 
	#PRE_LANG
 "¥ñ™g.y"

	)

13 
	#POST_LANG
 "po°œng.y"

	)

14 
	#THE_LANG
 "œng.y"

	)

15 
	#NELEMS
(
¨r
Ë(áº / áº[0])

	)

17 
	#MAX_FUNC
 2048

	)

18 
	gnum_buff
;

20 *
	gkey
[
MAX_FUNC
], *
	gbuf
[MAX_FUNC], 
	ghas_tokí
[MAX_FUNC];

22 
	gmö_¨g
 = -1, 
	glimô_max
 = 0;

28 
	g¨g_ty≥s
[200], 
	gœ°_cuºít_ty≥
;

33 
	gcuº_¨g_ty≥s
[
MAX_LOCAL
], 
	gcuº_¨g_ty≥_size
;

35 
yyîr‹
 (*);

36 
Áèl
(*
°r
);

37 
yyÀx
 ();

38 
yyÀx1
 ();

39 
yy∑r£
 ();

40 
ungëc
 (
c
, 
FILE
 *
f
);

41 *
ëy≥
 ();

42 *
ëy≥1
 ();

43 *
˘y≥
 ();

44 
›î
 ();

45 #i‚de‡
touµî


46 
touµî
 ();

50 
	$Áèl
(
°r
)

51 *
°r
;

53 ()
	`Ârötf
(
°dîr
, "%s", 
°r
);

54 
	`exô
(1);

55 
	}
}

59 
numbî
;

60 *
°rög
;

63 %
tokí
 
ID


65 %
tokí
 
VOID
 
INT
 
STRING
 
OBJECT
 
MIXED
 
UNKNOWN
 
MAPPING
 
FLOAT
 
FUNCTION


67 %
tokí
 
DEFAULT


69 %
ty≥
 <
numbî
>Åy≥ 
VOID
 
INT
 
STRING
 
OBJECT
 
MIXED
 
UNKNOWN
 
MAPPING
 
FLOAT
 
FUNCTION
 
¨g_li°
 
basic
 
ty≥l


71 %
ty≥
 <
numbî
> 
¨g_ty≥
 
ty≥l2


73 %
ty≥
 <
°rög
> 
ID
 
›ti⁄Æ_ID
 
›ti⁄Æ_deÁu…


75 %% /* 
	$yy∑r£
 */ 
	`yyÀx
()

77 
funcs
: | func†
func
 ;

79 
›ti⁄Æ_ID
: 
ID
 | { 
$$
 = ""; } ;

81 
›ti⁄Æ_deÁu…
: 
DEFAULT
 ':' 
ID
 { 
$$
 = 
$3
; } | { $$="0"; } ;

83 
func
: 
ty≥
 
ID
 
›ti⁄Æ_ID
 '(' 
¨g_li°
 
›ti⁄Æ_deÁu…
 ')' ';'

85 
buff
[500];

86 
f_«me
[500];

87 
i
;

88 i‡(
mö_¨g
 == -1)

89 
mö_¨g
 = 
$5
;

90 i‡(
$3
[0] == '\0') {

91 
Àn
;

92 i‡(
	`°æí
(
$2
Ë+ 1 + 2 >  
f_«me
)

93 
	`Áèl
("AÜocal buffer wasÅoo small!(1)\n");

94 ()
	`•rötf
(
f_«me
, "F_%s", 
$2
);

95 
Àn
 = 
	`°æí
(
f_«me
);

96 
i
=0; i < 
Àn
; i++) {

97 i‡(
	`i¶owî
(
f_«me
[
i
]))

98 
f_«me
[
i
] = 
	`touµî
(f_name[i]);

100 
has_tokí
[
num_buff
]=1;

102 i‡(
	`°æí
(
$3
Ë+ 1 >  
f_«me
)

103 
	`Áèl
("AÜocal buffer wasÅoo small(2)!\n");

104 ()
	`°r˝y
(
f_«me
, 
$3
);

105 
has_tokí
[
num_buff
]=0;

107 
i
=0; i < 
œ°_cuºít_ty≥
; i++) {

108 
j
;

109 
j
 = 0; j+
i
<
œ°_cuºít_ty≥
 && j < 
cuº_¨g_ty≥_size
; j++)

111 i‡(
cuº_¨g_ty≥s
[
j
] !
¨g_ty≥s
[
i
+j])

114 i‡(
j
 =
cuº_¨g_ty≥_size
)

117 i‡(
i
 =
œ°_cuºít_ty≥
) {

118 
j
;

119 
j
=0; j < 
cuº_¨g_ty≥_size
; j++) {

120 
¨g_ty≥s
[
œ°_cuºít_ty≥
++] = 
cuº_¨g_ty≥s
[
j
];

121 i‡(
œ°_cuºít_ty≥
 =
	`NELEMS
(
¨g_ty≥s
))

122 
	`yyîr‹
("Array 'arg_types' isÅoo small");

125 ()
	`•rötf
(
buff
, "{\"%s\",%s,%d,%d,%s,%s,%s,%d,%s},\n",

126 
$2
, 
f_«me
, 
mö_¨g
, 
limô_max
 ? -1 : 
$5
, 
	`˘y≥
(
$1
),

127 
	`ëy≥
(0),Éty≥(1), 
i
, 
$6
);

128 i‡(
	`°æí
(
buff
) >  buff)

129 
	`Áèl
("Local buffer overwritten !\n");

130 
key
[
num_buff
] = (*Ë
	`mÆloc
(
	`°æí
(
$2
) + 1);

131 ()
	`°r˝y
(
key
[
num_buff
], 
$2
);

132 
buf
[
num_buff
] = (*Ë
	`mÆloc
(
	`°æí
(
buff
) + 1);

133 ()
	`°r˝y
(
buf
[
num_buff
], 
buff
);

134 
num_buff
++;

135 
mö_¨g
 = -1;

136 
limô_max
 = 0;

137 
cuº_¨g_ty≥_size
 = 0;

140 
ty≥
: 
basic
 | basi¯'*' { 
$$
 = 
$1
 | 0x10000; };

142 
basic
: 
VOID
 | 
INT
 | 
STRING
 | 
MIXED
 | 
UNKNOWN
 | 
OBJECT
 | 
MAPPING
 | 
FLOAT
 | 
FUNCTION
 ;

144 
¨g_li°
: { 
$$
 = 0; }

145 | 
ty≥l2
 { 
$$
 = 1; i‡(
$1
Ë
mö_¨g
 = 0; }

146 | 
¨g_li°
 ',' 
ty≥l2
 { 
$$
 = 
$1
 + 1; i‡(
$3
Ë
mö_¨g
 = $$ - 1; } ;

148 
ty≥l2
: 
ty≥l


150 
$$
 = 
$1
;

151 
cuº_¨g_ty≥s
[
cuº_¨g_ty≥_size
++] = 0;

152 i‡(
cuº_¨g_ty≥_size
 =
	`NELEMS
(
cuº_¨g_ty≥s
))

153 
	`yyîr‹
("Too manyárguments");

156 
¨g_ty≥
: 
ty≥


158 i‡(
$1
 !
VOID
) {

159 
cuº_¨g_ty≥s
[
cuº_¨g_ty≥_size
++] = 
$1
;

160 i‡(
cuº_¨g_ty≥_size
 =
	`NELEMS
(
cuº_¨g_ty≥s
))

161 
	`yyîr‹
("Too manyárguments");

163 
$$
 = 
$1
;

166 
ty≥l
: 
¨g_ty≥
 { 
$$
 = (
$1
 =
VOID
 && 
mö_¨g
 == -1); }

167 | 
ty≥l
 '|' 
¨g_ty≥
 { 
$$
 = (
mö_¨g
 =-1 && (
$1
 || 
$3
 =
VOID
));}

168 | '.' '.' '.' { 
$$
 = 
mö_¨g
 =-1 ; 
limô_max
 = 1; } ;

170 
	}
%%

172 
	sty≥
 {

173 *
	m«me
;

174 
	mnum
;

175 } 
	gty≥s
[] = {

176 { "void", 
VOID
 },

177 { "öt", 
INT
 },

178 { "°rög", 
STRING
 },

179 { "obje˘", 
OBJECT
 },

180 { "mixed", 
MIXED
 },

181 { "unknown", 
UNKNOWN
 },

182 { "m≠pög", 
MAPPING
 },

183 { "fun˘i⁄", 
FUNCTION
 },

184 { "Êﬂt", 
FLOAT
},

187 
FILE
 *
	gf
;

188 
	gcuºít_löe
 = 1;

192 
	$maö
(
¨gc
, **
¨gv
)

194 
buf„r
[
BUFSIZ
 + 1];

195 
fdr
, 
fdw
;

196 
size_t
 
i
;

198 i‡((
f
 = 
	`f›í
(
FUNC_SPEC
, "r")Ë=
NULL
)

200 
	`≥º‹
(
FUNC_SPEC
);

201 
	`exô
(1);

203 ()
	`yy∑r£
();

206 
i
 = 0; i < 
num_buff
; i++)

208 
j
;

209 
j
 = 0; j < 
i
; j++)

210 i‡(
	`°rcmp
(
key
[
i
], key[
j
]) < 0)

212 *
tmp
;

213 
tmpi
;

214 
tmp
 = 
key
[
i
]; key[i] = key[
j
]; key[j] =Åmp;

215 
tmp
 = 
buf
[
i
]; buf[i] = buf[
j
]; buf[j] =Åmp;

216 
tmpi
 = 
has_tokí
[
i
];

217 
has_tokí
[
i
] = has_tokí[
j
]; has_tokí[j] = 
tmpi
;

222 ()
	`¥ötf
("{\n");

223 
i
 = 0; i < 
num_buff
; i++)

224 ()
	`¥ötf
("%s", 
buf
[
i
]);

225 ()
	`¥ötf
("\n};\nintÉfun_arg_types[] = {\n");

226 
i
 = 0; i < 
œ°_cuºít_ty≥
; i++)

228 i‡(
¨g_ty≥s
[
i
] == 0)

229 ()
	`¥ötf
("0,\n");

231 ()
	`¥ötf
("%s,", 
	`˘y≥
(
¨g_ty≥s
[
i
]));

233 ()
	`¥ötf
("};\n");

234 ()
	`p˛o£
(
f
);

242 i‡((
fdr
 = 
	`›í
(
PRE_LANG
, 
O_RDONLY
)) < 0)

244 
	`≥º‹
(
PRE_LANG
);

245 
	`exô
(1);

247 ()
	`u∆ök
(
THE_LANG
);

248 i‡((
fdw
 = 
	`›í
(
THE_LANG
, 
O_CREAT
 | 
O_WRONLY
, 0444)) < 0)

250 
	`≥º‹
(
THE_LANG
);

251 
	`exô
(1);

253  (
i
 = 
	`ªad
(
fdr
, 
buf„r
, 
BUFSIZ
)) > 0)

254 ()
	`wrôe
(
fdw
, 
buf„r
, 
i
);

255 ()
	`˛o£
(
fdr
);

256 
i
 = 0; i < 
num_buff
; i++)

258 i‡(
has_tokí
[
i
])

260 *
°r
;

261 
°r
 = 
key
[
i
]; *str; str++)

262 i‡(
	`i¶owî
(*
°r
)Ë*°∏
	`touµî
(*str);

263 ()
	`•rötf
(
buf„r
, "%%tokí F_%s\n", 
key
[
i
]);

264 ()
	`wrôe
(
fdw
, 
buf„r
, 
	`°æí
(buffer));

267 i‡((
fdr
 = 
	`›í
(
POST_LANG
, 
O_RDONLY
)) < 0)

269 
	`≥º‹
(
POST_LANG
);

270 
	`exô
(1);

272  (
i
 = 
	`ªad
(
fdr
, 
buf„r
, 
BUFSIZ
)) > 0)

273 ()
	`wrôe
(
fdw
, 
buf„r
, 
i
);

274 ()
	`˛o£
(
fdr
);

275 ()
	`˛o£
(
fdw
);

277 
	}
}

280 
	$yyîr‹
(*
°r
)

282 ()
	`Ârötf
(
°dîr
, "%s:%d: %s\n", 
FUNC_SPEC
, 
cuºít_löe
, 
°r
);

283 
	`exô
(1);

284 
	}
}

287 
	$›î
()

289 
buff
[100];

290 
Àn
, 
c
;

292 
c
 = 
	`gëc
(
f
);

293 
Àn
=0; 
c
 !
EOF
 && c !'('; c = 
	`gëc
(
f
))

295 
buff
[
Àn
++] = 
c
;

296 i‡(
Àn
 + 1 > 
buff
)

297 
	`Áèl
("Local buffer in oper()Åoo small!\n");

298 i‡(
Àn
 = 
buff
 - 1)

300 
	`yyîr‹
("TooÜong indentifier");

304 ()
	`ungëc
(
c
, 
f
);

305 
buff
[
Àn
] = '\0';

306 
yylvÆ
.
°rög
 = (*Ë
	`mÆloc
(
	`°æí
(
buff
)+1);

307 ()
	`°r˝y
(
yylvÆ
.
°rög
, 
buff
);

308  
ID
;

309 
	}
}

312 
	$idít
(
c
)

314 
buff
[100];

315 
Àn
, 
i
;

317 
Àn
=0; 
	`iß um
(
c
Ë|| c ='_'; c = 
	`gëc
(
f
))

319 
buff
[
Àn
++] = 
c
;

320 i‡(
Àn
 + 1 > 
buff
)

321 
	`Áèl
("Local buffer in ident()Åoo small!\n");

322 i‡(
Àn
 = 
buff
 - 1)

324 
	`yyîr‹
("TooÜong indentifier");

328 ()
	`ungëc
(
c
, 
f
);

329 
buff
[
Àn
] = '\0';

330 
i
 = 0; i < 
	`NELEMS
(
ty≥s
); i++)

332 i‡(
	`°rcmp
(
buff
, 
ty≥s
[
i
].
«me
) == 0)

334 
yylvÆ
.
numbî
 = 
ty≥s
[
i
].
num
;

335  
ty≥s
[
i
].
num
;

338 i‡(
	`°rcmp
(
buff
, "default") == 0)

339  
DEFAULT
;

340 
yylvÆ
.
°rög
 = (*Ë
	`mÆloc
(
	`°æí
(
buff
)+1);

341 ()
	`°r˝y
(
yylvÆ
.
°rög
, 
buff
);

342  
ID
;

343 
	}
}

346 
	$yyÀx1
()

348 
c
;

351 
c
 = 
	`gëc
(
f
)) {

357 #i‡
	`deföed
(
sun
Ë&& !deföed(
SOLARIS
Ë&& !deföed(
__USE_FIXED_PROTOTYPES__
)

359 
	`fsˇnf
 (
FILE
 *, *, ...);

361 
löe
;

362 
fûe
[2048];

364 i‡–
	`fsˇnf
(
f
,"%d \"%s\"",&
löe
,
fûe
 ) == 2 )

365 
cuºít_löe
 = 
löe
;

366 
c
 !'\n' && c !
EOF
)

367 
c
 = 
	`gëc
(
f
);

368 
cuºít_löe
++;

372 
cuºít_löe
++;

374 
EOF
:

377  
	`›î
();

379 i‡(
	`ißÕha
(
c
))

380  
	`idít
(
c
);

381  
c
;

384 
	}
}

387 
	$yyÀx
()

389  
	`yyÀx1
();

390 
	}
}

392 *
	$ëy≥1
(
n
)

394 i‡(
n
 & 0x10000)

396 
n
) {

397 
INT
:

399 
OBJECT
:

401 
STRING
:

403 
MAPPING
:

405 
FUNCTION
:

407 
FLOAT
:

409 
MIXED
:

412 
	`yyîr‹
("IllegalÅype forárgument");

415 
	}
}

418 
	$ëy≥
(
n
)

420 
i
;

421 
loˇl_size
 = 100;

422 *
buff
 = (*Ë
	`mÆloc
(
loˇl_size
);

424 
i
=0; i < 
cuº_¨g_ty≥_size
; i++) {

425 i‡(
n
 == 0)

427 i‡(
cuº_¨g_ty≥s
[
i
] == 0)

428 
n
--;

430 i‡(
i
 =
cuº_¨g_ty≥_size
)

432 
buff
[0] = '\0';

433 ; 
cuº_¨g_ty≥s
[
i
] != 0; i++) {

434 *
p
;

435 i‡(
cuº_¨g_ty≥s
[
i
] =
VOID
)

437 i‡(
buff
[0] != '\0')

438 ()
	`°rˇt
(
buff
, "|");

439 
p
 = 
	`ëy≥1
(
cuº_¨g_ty≥s
[
i
]);

444 i‡(
	`°æí
(
p
Ë+ såÀn(
buff
Ë+ 2 > 
loˇl_size
) {

445 ()
	`Ârötf
(
°dîr
, "Buffer overflow!\n");

446 
	`exô
(1);

448 ()
	`°rˇt
(
buff
, 
	`ëy≥1
(
cuº_¨g_ty≥s
[
i
]));

450  
buff
;

451 
	}
}

453 *
	$˘y≥
(
n
)

455 
buff
[100];

456 *
p
 = "";

458 i‡(
n
 & 0x10000)

459 ()
	`°r˝y
(
buff
, "TYPE_MOD_POINTER|");

461 
buff
[0] = '\0';

462 
n
 &= ~0x10000;

463 
n
) {

464 
VOID
: 
p
 = "TYPE_VOID"; ;

465 
STRING
: 
p
 = "TYPE_STRING"; ;

466 
INT
: 
p
 = "TYPE_NUMBER"; ;

467 
OBJECT
: 
p
 = "TYPE_OBJECT"; ;

468 
MIXED
: 
p
 = "TYPE_ANY"; ;

469 
MAPPING
: 
p
 = "TYPE_MAPPING"; ;

470 
FLOAT
: 
p
 = "TYPE_FLOAT";;

471 
FUNCTION
: 
p
 = "TYPE_FUNCTION";;

472 
UNKNOWN
: 
p
 = "TYPE_UNKNOWN"; ;

473 : 
	`yyîr‹
("BadÅype!"); ;

475 ()
	`°rˇt
(
buff
, 
p
);

476 i‡(
	`°æí
(
buff
) + 1 >  buff)

477 
	`Áèl
("Local buffer overwritten in ctype()\n");

478  
buff
;

479 
	}
}

	@make_table.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<˘y≥.h
>

4 
	~<°rög.h
>

7 
	$maö
(
¨gc
, *
¨gv
[])

9 
	`lowî
(*);

10 
buf„r
[
BUFSIZ
], *
p
;

11 
FILE
 *
ö
, *
out
;

12 
fú°
=0x7fffffff, 
œ°
=0, 
n
;

14 i‡(
¨gc
 != 3) {

15 ()
	`Ârötf
(
°dîr
, "Usage: make_table input.h output.h\n");

16 
	`exô
(1);

19 i‡((
ö
 = 
	`f›í
(
¨gv
[1], "r")Ë=
NULL
) {

20 
	`≥º‹
("fopen");

21 
	`exô
(1);

24 i‡((
out
 = 
	`f›í
(
¨gv
[2], "w")Ë=
NULL
) {

25 
	`≥º‹
("fopen");

26 
	`exô
(1);

29 ()
	`Ârötf
(
out
, "/*\n");

30 ()
	`Ârötf
(
out
, " * This file isáutomatically generated; doÇotÉdit.\n");

31 ()
	`Ârötf
(
out
, " */\n\n");

32 ()
	`Ârötf
(
out
, "#ifdef EFUN_TABLE\n");

33 ()
	`Ârötf
(
out
, "static void (*efun_table[])(int) = {\n");

34 
	`fgës
(
buf„r
, (buf„r), 
ö
)) {

35 i‡(
buf„r
[0] != '#')

37 
p
 = 
	`°πok
(
buf„r
+1, " \t\n");

38 i‡(
	`°rcmp
(
p
, "define"))

40 i‡((
p
 = 
	`°πok
(
NULL
, " \t\n")) == NULL)

42 i‡(
	`°rcmp
(
p
, "YYEMPTY") == 0)

44 
	`lowî
(
p
);

45 ()
	`Ârötf
(
out
, "\t%s,\n", 
p
);

46 i‡((
p
 = 
	`°πok
(
NULL
, " \t\n")) == NULL)

48 
n
 = 
	`©oi
(
p
);

49 i‡(
n
 < 
fú°
)

50 
fú°
 = 
n
;

51 i‡(
n
 > 
œ°
)

52 
œ°
 = 
n
;

54 ()
	`Ârötf
(
out
, "};\n");

55 ()
	`Ârötf
(
out
, "#else /* EFUN_TABLE */\n");

56 ()
	`Ârötf
(
out
, "#deföêEFUN_FIRST %4d\n", 
fú°
);

57 ()
	`Ârötf
(
out
, "#deföêEFUN_LAST %4d\n", 
œ°
);

58 ()
	`Ârötf
(
out
, "#endif /* EFUN_TABLE */\n");

59 ()
	`f˛o£
(
out
);

60 ()
	`f˛o£
(
ö
);

62 
	}
}

65 
	$lowî
(*
°rög
)

67 *
°rög
) {

68 i‡(
	`isuµî
(*
°rög
))

69 *
°rög
 = 
	`tﬁowî
(*string);

70 
°rög
++;

72 
	}
}

	@mapping.c

1 
	~<v¨¨gs.h
>

2 
	~<°dio.h
>

3 
	~<°rög.h
>

4 
	~<˘y≥.h
>

5 
	~<sys/time.h
>

6 
	~<sys/ty≥s.h
>

7 
	~<sys/°©.h
>

9 
	~<mem‹y.h
>

10 
	~<°dio.h
>

12 
	~"c⁄fig.h
"

13 
	~"löt.h
"

14 
	~"exec.h
"

15 
	~"öãΩªt.h
"

16 
	~"obje˘.h
"

17 
	~"ö°rs.h
"

18 
	~"comm.h
"

19 
	~"m≠pög.h
"

20 
	~"hash.h
"

21 
	~"simuœã.h
"

22 
	~"m°rög.h
"

24 
	~"ölöe_eqs.h
"

25 
	~"ölöe_svÆue.h
"

27 
îr‹
(*
fmt
, ...);

28 
ªhash_m≠
(
m≠pög
 *);

31 
	#FILL_FACTOR
 250

	)

32 
	#FSIZE
(
s
Ë(((s)*
FILL_FACTOR
)/100)

	)

33 
	gnum_m≠pögs
 = 0, 
	gtŸÆ_m≠pög_size
 = 0;

37 
	$ab‹tm≠
(*
s
)

39 ()
	`Ârötf
(
°dîr
, "M≠pög %s\n", 
s
);

40 
	`îr‹
("MappingsÇot implemented");

41 
	}
}

45 
	$‰ì_≠aús
(
≠aú
 *
p
)

47 
≠aú
 *
√xt
;

48 
∑ús
 = 0;

50 ;
p
;∞
√xt
) {

51 
	`‰ì_svÆue
(&
p
->
¨g
);

52 
	`‰ì_svÆue
(&
p
->
vÆ
);

53 
√xt
 = 
p
->next;

54 
	`‰ì
((*)
p
);

55 
tŸÆ_m≠pög_size
 -(
≠aú
);

56 
∑ús
++;

58  
∑ús
;

59 
	}
}

62 
	$‰ì_m≠pög
(
m≠pög
 *
m
)

64 
i
;

66 i‡(!
m
->
ªf
 || --m->ref > 0)

68 
i
 = 0; i < 
m
->
size
; i++)

69 
m
->
ˇrd
 -
	`‰ì_≠aús
(m->
∑ús
[
i
]);

70 
num_m≠pögs
--;

71 
tŸÆ_m≠pög_size
 -((
≠aú
 *Ë* 
m
->
size
 +

72 (
m≠pög
));

73 
	`‰ì
((*)
m
->
∑ús
);

74 
	`‰ì
((*)
m
);

75 
	}
}

77 
m≠pög
 *

78 
	$Æloˇã_m≠
(
msize
)

80 
m≠pög
 *
m
;

81 
u
;

82 
size
;

84 
size
 = 1, 
u
 = (
msize
*100)/
FILL_FACTOR
; u && sizê< 
MAX_MAPPING_SIZE
; size <<= 1, u >>= 1)

87 
num_m≠pögs
++;

88 
m
 = (
m≠pög
 *Ë
	`xÆloc
((mapping));

89 
m
->
∑ús
 = (
≠aú
 **Ë
	`xÆloc
((≠aú *Ë* 
size
);

90 ()
	`mem£t
(
m
->
∑ús
, 0, (
≠aú
 *Ë* 
size
);

91 
tŸÆ_m≠pög_size
 +(
m≠pög
Ë+ (
≠aú
 *Ë* 
size
;

92 
m
->
ªf
 = 1;

93 
m
->
ˇrd
 = 0;

94 
m
->
size
 = size;

95 
m
->
mˇrd
 = 
	`FSIZE
(m->
size
);

97  
m
;

98 
	}
}

101 
	$ˇrd_m≠pög
(
m≠pög
 *
m
)

103  
m
->
ˇrd
;

104 
	}
}

106 
INLINE
 
≠aú
 *

107 
	$√w∑ú
(
≠aú
 *
n
, 
svÆue
 *
k
, svÆuê*
v
, 
h
)

109 
≠aú
 *
p
 = (≠aú *)
	`xÆloc
((apair));

111 
p
->
√xt
 = 
n
;

112 
p
->
hashvÆ
 = 
h
;

113 
	`assign_svÆue_no_‰ì
(&
p
->
¨g
, 
k
);

114 
	`assign_svÆue_no_‰ì
(&
p
->
vÆ
, 
v
);

115 
tŸÆ_m≠pög_size
 +(
≠aú
);

116  
p
;

117 
	}
}

119 
INLINE
 

120 
	$hashsvÆue
(
svÆue
 *
v
)

122 
v
->
ty≥
) {

123 
T_NUMBER
:

124  ()
v
->
u
.
numbî
;

125 
T_POINTER
:

126  ()(()
v
->
u
.
vec
 >> 4);

127 
T_MAPPING
:

128  ()(()
v
->
u
.
m≠
 >> 4);

129 
T_STRING
:

130  
	`hash°r16
(
v
->
u
.
°rög
, 20);

131 
T_OBJECT
:

132  ()(()
v
->
u
.
ob
 >> 4);

133 
T_FLOAT
:

134  ()
v
->
u
.
numbî
;

138 
	}
}

140 
svÆue
 *

141 
	$gë_m≠_lvÆue
(
m≠pög
 *
m
, 
svÆue
 *
k
, 
c
)

143 
h
, 
h16
;

144 
≠aú
 *
p
;

146 
h16
 = 
	`hashsvÆue
(
k
);

147 
h
 = 
h16
 & (
m
->
size
-1);

149 
p
 = 
m
->
∑ús
[
h
];Ö;Ö =Ö->
√xt
) {

150 i‡(
p
->
hashvÆ
 =
h16
 && 
	`equÆ_svÆue
(
k
, &p->
¨g
))

153 i‡(!
p
) {

154 i‡(
c
) {

155 
m
->
∑ús
[
h
] = 
p
 = 
	`√w∑ú
(m->∑ús[h], 
k
, &
c⁄°0
, 
h16
);

156 i‡(++
m
->
ˇrd
 > m->
mˇrd
) {

158 
	`ªhash_m≠
(
m
);

162  &
c⁄°0
;

165  &
p
->
vÆ
;

166 
	}
}

168 
ve˘‹
 *

169 
	$m≠_domaö
(
m
)

170 
m≠pög
 *
m
;

172 
ve˘‹
 *
d
;

173 
˙t
, 
i
, 
k
;

174 
≠aú
 *
p
;

176 
˙t
 = 
m
->
ˇrd
;

177 
d
 = 
	`Æloˇã_¨øy
(
˙t
);

178 
k
 = 0, 
i
 = 0; i < 
m
->
size
; i++)

179 
p
 = 
m
->
∑ús
[
i
];Ö;Ö =Ö->
√xt
)

180 
	`assign_svÆue_no_‰ì
 (&
d
->
ôem
[
k
++], &
p
->
¨g
);

181  
d
;

182 
	}
}

184 
ve˘‹
 *

185 
	$m≠_codomaö
(
m≠pög
 *
m
)

187 
ve˘‹
 *
d
;

188 
˙t
, 
i
, 
k
;

189 
≠aú
 *
p
;

191 
˙t
 = 
m
->
ˇrd
;

192 
d
 = 
	`Æloˇã_¨øy
(
˙t
);

193 
k
 = 0, 
i
 = 0; i < 
m
->
size
; i++)

194 
p
 = 
m
->
∑ús
[
i
];Ö;Ö =Ö->
√xt
)

195 
	`assign_svÆue_no_‰ì
(&
d
->
ôem
[
k
++], &
p
->
vÆ
);

196  
d
;

197 
	}
}

199 
m≠pög
 *

200 
	$make_m≠pög
(
ve˘‹
 *
öd
, ve˘‹ *
vÆ
)

202 
m≠pög
 *
m
;

203 
svÆue
 
tmp
;

204 
i
, 
max
;

206 
tmp
.
ty≥
 = 
T_NUMBER
;

207 #ifde‡
PURIFY


208 
tmp
.
°rög_ty≥
 = -1;

211 i‡(
öd
 !
NULL
 && 
vÆ
 != NULL) {

212 
max
 = 
öd
->
size
 < 
vÆ
->size ? ind->size : val->size;

213 
m
 = 
	`Æloˇã_m≠
(
max
);

214 
i
 = 0 ; i < 
max
 ; i++)

216 
	`assign_svÆue
(
	`gë_m≠_lvÆue
(
m
, &
öd
->
ôem
[
i
], 1),

217 &
vÆ
->
ôem
[
i
]);

219 } i‡(
öd
 !
NULL
 && 
vÆ
 == NULL) {

220 
m
 = 
	`Æloˇã_m≠
(
öd
->
size
);

221 
i
 = 0 ; i < 
öd
->
size
 ; i++)

223 
tmp
.
u
.
numbî
 = 
i
;

224 
	`assign_svÆue
(
	`gë_m≠_lvÆue
(
m
, &
öd
->
ôem
[
i
], 1), &
tmp
);

226 } i‡(
öd
 =
NULL
 && 
vÆ
 != NULL) {

227 
m
 = 
	`Æloˇã_m≠
(
vÆ
->
size
);

228 
i
 = 0 ; i < 
vÆ
->
size
 ; i++)

230 
tmp
.
u
.
numbî
 = 
i
;

231 
	`assign_svÆue_no_‰ì
(
	`gë_m≠_lvÆue
(
m
, &
tmp
, 1), &
vÆ
->
ôem
[
i
]);

234 
m
 = 
	`Æloˇã_m≠
(0);

237  
m
;

238 
	}
}

240 
m≠pög
 *

241 
	$add_m≠pög
(
m≠pög
 *
m1
, m≠pög *
m2
)

243 
m≠pög
 *
ªtm
;

244 
≠aú
 *
p
;

245 
i
;

247 
ªtm
 = 
	`Æloˇã_m≠
(
m1
->
ˇrd
 + 
m2
->card);

249 
i
 = 0 ; i < 
m1
->
size
 ; i++)

251 
p
 = 
m1
->
∑ús
[
i
];Ö ;Ö =Ö->
√xt
)

252 
	`assign_svÆue
(
	`gë_m≠_lvÆue
(
ªtm
, &
p
->
¨g
, 1), &p->
vÆ
);

254 
i
 = 0 ; i < 
m2
->
size
 ; i++)

256 
p
 = 
m2
->
∑ús
[
i
];Ö ;Ö =Ö->
√xt
)

257 
	`assign_svÆue
(
	`gë_m≠_lvÆue
(
ªtm
, &
p
->
¨g
, 1), &p->
vÆ
);

259  
ªtm
;

260 
	}
}

263 
	$addto_m≠pög
(
m≠pög
 *
m1
, m≠pög *
m2
)

265 
≠aú
 *
p
;

266 
i
;

268 
i
 = 0 ; i < 
m2
->
size
 ; i++)

270 
p
 = 
m2
->
∑ús
[
i
];Ö ;Ö =Ö->
√xt
)

271 
	`assign_svÆue
(
	`gë_m≠_lvÆue
(
m1
, &
p
->
¨g
, 1), &p->
vÆ
);

273 
	}
}

275 
m≠pög
 *

276 
	$ªmove_m≠pög
(
m≠pög
 *
m
, 
svÆue
 *
vÆ
)

278 
m≠pög
 *
ªtm
;

279 
≠aú
 *
p
;

280 
i
, 
h
;

282 
ªtm
 = 
	`Æloˇã_m≠
(
m
->
size
);

283 
h
 = 
	`hashsvÆue
(
vÆ
Ë& (
m
->
size
-1);

285 
i
 = 0 ; i < 
m
->
size
 ; i++)

287 
p
 = 
m
->
∑ús
[
i
] ;Ö ;Ö =Ö->
√xt
)

289 i‡(
h
 =
i
)

291 i‡(!
	`equÆ_svÆue
(
vÆ
, &
p
->
¨g
))

292 
	`assign_svÆue
(
	`gë_m≠_lvÆue
(
ªtm
, &
p
->
¨g
, 1), &p->
vÆ
);

295 
	`assign_svÆue
(
	`gë_m≠_lvÆue
(
ªtm
, &
p
->
¨g
, 1), &p->
vÆ
);

298  
ªtm
;

299 
	}
}

302 
	$ªhash_m≠
(
m≠pög
 *
m≠
)

304 
≠aú
 **
∑ús
, *
√xt
, *
±r
;

305 
i
, 
hvÆ
;

306 
nsize
;

308 
nsize
 = 
m≠
->
size
 * 2;

309 i‡(
nsize
 > 
MAX_MAPPING_SIZE
) {

310 
	`îr‹
("Warning,ÅooÜarge mapping.\n");

314 
∑ús
 = (
≠aú
 **)
	`xÆloc
((≠aú *Ë* 
nsize
);

315 ()
	`mem£t
(
∑ús
, 0, (
≠aú
 *Ë* 
nsize
);

317 
i
 = 0 ; i < 
m≠
->
size
 ; i++) {

318 
±r
 = 
m≠
->
∑ús
[
i
];Öå;Öå = 
√xt
) {

319 
hvÆ
 = 
±r
->
hashvÆ
 & (
nsize
-1);

320 
√xt
 = 
±r
->next;

321 
±r
->
√xt
 = 
∑ús
[
hvÆ
];

322 
∑ús
[
hvÆ
] = 
±r
;

326 
	`‰ì
((*)
m≠
->
∑ús
);

327 
m≠
->
∑ús
 =Öairs;

328 
tŸÆ_m≠pög_size
 +(
≠aú
 *Ë* (
nsize
 - 
m≠
->
size
);

329 
m≠
->
size
 = 
nsize
;

330 
m≠
->
mˇrd
 = 
	`FSIZE
(m≠->
size
);

331 
	}
}

334 
m≠pög
 *

335 
	$c›y_m≠pög
(
m≠pög
 *
m
)

337 
m≠pög
 *
cm
;

338 
≠aú
 *
∑ú
;

339 
i
;

341 
num_m≠pögs
++;

342 
cm
 = (
m≠pög
 *Ë
	`xÆloc
((mapping));

343 
cm
->
∑ús
 = (
≠aú
 **Ë
	`xÆloc
((≠aú *Ë* 
m
->
size
);

344 ()
	`mem£t
(
cm
->
∑ús
, 0, (
≠aú
 *Ë* 
m
->
size
);

345 
tŸÆ_m≠pög_size
 +(
m≠pög
Ë+ (
≠aú
 *Ë* 
m
->
size
;

346 
cm
->
ªf
 = 1;

347 
cm
->
size
 = 
m
->size;

348 
cm
->
ˇrd
 = 
m
->card;

349 
cm
->
mˇrd
 = 
m
->mcard;

350 
i
 = 0; i < 
m
->
size
; i++)

351 
∑ú
 = 
m
->
∑ús
[
i
];Öaú;Öaú =Öaú->
√xt
)

352 
cm
->
∑ús
[
i
] = 
	`√w∑ú
(cm->∑ús[i], &
∑ú
->
¨g
, &∑ú->
vÆ
,Öaú->
hashvÆ
);

353  
cm
;

354 
	}
}

360 
m≠pög
 *

361 
	$m≠_m≠
(
m≠pög
 *
m≠
, 
˛osuª
 *
fun
)

363 
m≠pög
 *
r
;

364 
≠aú
 *
p
;

365 
i
;

367 
r
 = 
	`c›y_m≠pög
(
m≠
);

368 
	`push_m≠pög
(
r
, 0);

369 
i
 = 0 ; i < 
r
->
size
 ; i++) {

370 
p
 = 
r
->
∑ús
[
i
];Ö;Ö =Ö->
√xt
) {

371 
	`push_svÆue
(&
p
->
vÆ
);

372 ()
	`ˇŒ_v¨
(1, 
fun
);

373 
	`assign_svÆue
(&
p
->
vÆ
, 
•
);

374 
	`p›_°ack
();

377 
•
--;

378  
r
;

379 
	}
}

388 
m≠pög
 *

389 
	$fûãr_m≠
(
m≠pög
 *
m≠
, 
˛osuª
 *
fun
)

391 
m≠pög
 *
r
;

392 
≠aú
 **
p
;

393 
i
;

395 
r
 = 
	`c›y_m≠pög
(
m≠
);

396 
i
 = 0; i < 
r
->
size
; i++) {

397 
p
 = &
r
->
∑ús
[
i
]; *p;) {

398 
	`push_svÆue
(&(*
p
)->
vÆ
);

399 ()
	`ˇŒ_v¨
(1, 
fun
);

400 i‡(
•
->
ty≥
 =
T_NUMBER
 && sp->
u
.
numbî
 == 0) {

402 
≠aú
 *
≠
 = *
p
;

403 *
p
 = (*p)->
√xt
;

404 
	`‰ì_svÆue
(&
≠
->
¨g
);

405 
	`‰ì_svÆue
(&
≠
->
vÆ
);

406 
	`‰ì
(
≠
);

407 
tŸÆ_m≠pög_size
 -(
≠aú
);

408 
r
->
ˇrd
--;

410 
p
 = &(*p)->
√xt
;

412 
	`p›_°ack
();

415  
r
;

416 
	}
}

	@mapping.h

3 
	s≠aú
 {

4 
≠aú
 *
	m√xt
;

5 
svÆue
 
	m¨g
, 
	mvÆ
;

6 
	mhashvÆ
;

9 
	sm≠pög
 {

10 
	msize
;

11 
	mªf
;

12 
	mˇrd
;

13 
	mmˇrd
;

14 
≠aú
 **
	m∑ús
;

17 
‰ì_m≠pög
 (
m≠pög
 *);

18 
m≠pög
 *
Æloˇã_m≠
 ();

19 
ˇrd_m≠pög
 (
m≠pög
 *);

20 
svÆue
 * 
gë_m≠_lvÆue
 (
m≠pög
 *, svalue *, );

21 
ve˘‹
 * 
m≠_domaö
 (
m≠pög
 *);

22 
ve˘‹
 * 
m≠_codomaö
 (
m≠pög
 *);

23 
m≠pög
 * 
make_m≠pög
 (
ve˘‹
 *, vector *);

24 
m≠pög
 * 
add_m≠pög
 (mapping *, mapping *);

25 
addto_m≠pög
 (
m≠pög
 *, mapping *);

26 
m≠pög
 * 
ªmove_m≠pög
 (m≠pög *, 
svÆue
 *);

27 
m≠pög
 * 
m≠_m≠
(m≠pög *, 
˛osuª
 *);

28 
m≠pög
 * 
fûãr_m≠
(m≠pög *, 
˛osuª
 *);

29 
‰ì_≠aús
(
≠aú
 *
p
);

	@mstring.c

33 
	~<°dio.h
>

34 
	~<°rög.h
>

35 
	~<limôs.h
>

36 
	~<m©h.h
>

37 
	~<sys/ty≥s.h
>

39 
	~"c⁄fig.h
"

40 
	~"löt.h
"

41 
	~"m°rög.h
"

42 
	~"hash.h
"

43 #ifde‡
DEBUG


44 
	~"simuœã.h
"

47 #ifde‡
MALLOC_smÆloc


48 
mÆloc_size_mask
();

50 
	#mÆloc_size_mask
(Ë(~0)

	)

53 
	gnum_di°ö˘_°rögs_sh¨ed
;

54 
	gbyãs_di°ö˘_°rögs_sh¨ed
;

55 
	govîhód_byãs_sh¨ed
;

57 
	gnum_di°ö˘_°rögs_mÆlo˚d
;

58 
	gbyãs_di°ö˘_°rögs_mÆlo˚d
;

59 
	govîhód_byãs_mÆlo˚d
;

61 
	g£¨ch_Àn
;

62 
	gnum_°r_£¨ches
;

63 
	gÆlocd_byãs_mÆlo˚d
;

64 
	gÆlocd_°rögs_mÆlo˚d
;

65 
	gÆlocd_byãs_sh¨ed
;

66 
	gÆlocd_°rögs_sh¨ed
;

68 *
	gs°rög_èbÀ
[
HTABLE_SIZE
];

71 
	$Æloˇã_m°rög
(
size_t
 
Àn
)

73 *
˝
;

75 
˝
 = (*)
	`xÆloc
(
m°rög_hódî
 + 
Àn
 + 1) + mstring_header;

76 #ifde‡
DEBUG


77 
	`m°rög_magic
(
˝
Ë
MSTRING_MAGIC
;

79 
	`m°rög_cou¡
(
˝
) = 1;

80 
	`m°rög_Àn
(
˝
Ë(
u_sh‹t
)
Àn
;

81 
Ælocd_°rögs_mÆlo˚d
++;

82 
Ælocd_byãs_mÆlo˚d
 +
m°rög_hódî
 + 
Àn
 + 1;

83 
num_di°ö˘_°rögs_mÆlo˚d
++;

84 
byãs_di°ö˘_°rögs_mÆlo˚d
 +
Àn
 + 1;

85 
ovîhód_byãs_mÆlo˚d
 +
m°rög_hódî
;

86  
˝
;

87 
	}
}

90 
	$make_m°rög
(*
˝
)

92 
size_t
 
Àn
;

93 *
xp
;

95 
Àn
 = 
	`°æí
(
˝
);

96 
xp
 = 
	`Æloˇã_m°rög
(
Àn
);

97 ()
	`mem˝y
(
xp
, 
˝
, 
Àn
 + 1);

98  
xp
;

99 
	}
}

102 
	$ª„ªn˚_m°rög
(*
˝
)

104 #ifde‡
DEBUG


105 i‡(
	`m°rög_magic
(
˝
Ë!
MSTRING_MAGIC
)

106 
	`Áèl
("Bad m-magic: %x %x\n", 
	`m°rög_magic
(
˝
), 
MSTRING_MAGIC
);

109 i‡(
	`m°rög_cou¡
(
˝
) != 0)

110 
	`m°rög_cou¡
(
˝
)++;

112 
Ælocd_°rögs_mÆlo˚d
++;

113 
Ælocd_byãs_mÆlo˚d
 +
m°rög_hódî
 + 
	`m°rög_Àn
(
˝
) + 1;

115  
˝
;

116 
	}
}

119 
	$‰ì_m°rög
(*
˝
)

121 #ifde‡
DEBUG


122 i‡(
	`m°rög_magic
(
˝
Ë!
MSTRING_MAGIC
)

123 
	`Áèl
("Bad m-magic: %x %x\n", 
	`m°rög_magic
(
˝
), 
MSTRING_MAGIC
);

126 i‡(
	`m°rög_cou¡
(
˝
) != 0) {

127 
Ælocd_°rögs_mÆlo˚d
--;

128 
Ælocd_byãs_mÆlo˚d
 -
m°rög_hódî
 + 
	`m°rög_Àn
(
˝
) + 1;

129 i‡(--
	`m°rög_cou¡
(
˝
) == 0)

131 #ifde‡
DEBUG


132 
	`m°rög_magic
(
˝
) = 0;

134 
num_di°ö˘_°rögs_mÆlo˚d
--;

135 
byãs_di°ö˘_°rögs_mÆlo˚d
 -
	`m°rög_Àn
(
˝
) + 1;

136 
ovîhód_byãs_mÆlo˚d
 -
m°rög_hódî
;

137 
	`‰ì
(
˝
 - 
m°rög_hódî
);

140 
	}
}

143 
	$ª„ªn˚_s°rög
(*
˝
)

145 #ifde‡
DEBUG


146 i‡(
	`s°rög_magic
(
˝
Ë!
SSTRING_MAGIC
)

147 
	`Áèl
("Bad s-magic: %x %x\n", 
	`s°rög_magic
(
˝
), 
SSTRING_MAGIC
);

150 i‡(
	`s°rög_cou¡
(
˝
) != 0)

151 
	`s°rög_cou¡
(
˝
)++;

153 
Ælocd_°rögs_sh¨ed
++;

154 
Ælocd_byãs_sh¨ed
 +
s°rög_hódî
 + 
	`s°rög_Àn
(
˝
) + 1;

156  
˝
;

157 
	}
}

160 
	$föd_s°rög
(*
˝
)

162 
u_sh‹t
 
hash
;

163 *
xp
;

165 
hash
 = 
	`HASH_SSTRING
(
˝
);

166 
xp
 = 
s°rög_èbÀ
[
hash
];

167 
num_°r_£¨ches
++;

168 
xp
 !
NULL
)

170 
£¨ch_Àn
++;

171 #ifde‡
DEBUG


172 i‡(
	`s°rög_magic
(
xp
Ë!
SSTRING_MAGIC
)

173 
	`Áèl
("Bad s-magic: %x %x\n", 
	`s°rög_magic
(
xp
), 
SSTRING_MAGIC
);

175 i‡(
xp
 =
˝
 || (*x∞=*˝ && 
	`°rcmp
(xp, cp) == 0))

177 i‡(
	`s°rög_¥ev
(
xp
Ë!
NULL
) {

178 
	`s°rög_√xt
(
	`s°rög_¥ev
(
xp
)) = sstring_next(xp);

179 i‡(
	`s°rög_√xt
(
xp
Ë!
NULL
)

180 
	`s°rög_¥ev
(
	`s°rög_√xt
(
xp
)) = sstring_prev(xp);

181 
	`s°rög_¥ev
(
xp
Ë
NULL
;

182 
	`s°rög_√xt
(
xp
Ë
s°rög_èbÀ
[
hash
];

183 
	`s°rög_¥ev
(
s°rög_èbÀ
[
hash
]Ë
xp
;

184 
s°rög_èbÀ
[
hash
] = 
xp
;

186  
xp
;

188 
xp
 = 
	`s°rög_√xt
(xp);

191  
NULL
;

192 
	}
}

195 
	$make_s°rög
(*
˝
)

197 
size_t
 
Àn
;

198 
u_sh‹t
 
hash
;

199 *
xp
;

201 
hash
 = 
	`HASH_SSTRING
(
˝
);

202 
xp
 = 
s°rög_èbÀ
[
hash
];

203 
num_°r_£¨ches
++;

204 
xp
 !
NULL
)

206 
£¨ch_Àn
++;

207 #ifde‡
DEBUG


208 i‡(
	`s°rög_magic
(
xp
Ë!
SSTRING_MAGIC
)

209 
	`Áèl
("Bad s-magic: %x %x\n", 
	`s°rög_magic
(
xp
), 
SSTRING_MAGIC
);

211 i‡(
xp
 =
˝
 || (*x∞=*˝ && 
	`°rcmp
(xp, cp) == 0))

213 i‡(
	`s°rög_¥ev
(
xp
Ë!
NULL
) {

214 
	`s°rög_√xt
(
	`s°rög_¥ev
(
xp
)) = sstring_next(xp);

215 i‡(
	`s°rög_√xt
(
xp
Ë!
NULL
)

216 
	`s°rög_¥ev
(
	`s°rög_√xt
(
xp
)) = sstring_prev(xp);

217 
	`s°rög_¥ev
(
xp
Ë
NULL
;

218 
	`s°rög_√xt
(
xp
Ë
s°rög_èbÀ
[
hash
];

219 
	`s°rög_¥ev
(
s°rög_èbÀ
[
hash
]Ë
xp
;

220 
s°rög_èbÀ
[
hash
] = 
xp
;

222  
	`ª„ªn˚_s°rög
(
xp
);

224 
xp
 = 
	`s°rög_√xt
(xp);

226 
Àn
 = 
	`°æí
(
˝
);

227 
xp
 = (*)
	`xÆloc
(
s°rög_hódî
 + 
Àn
 + 1) + sstring_header;

228 #ifde‡
DEBUG


229 
	`s°rög_magic
(
xp
Ë
SSTRING_MAGIC
;

231 
	`s°rög_¥ev
(
xp
Ë
NULL
;

232 
	`s°rög_√xt
(
xp
Ë
s°rög_èbÀ
[
hash
];

233 i‡(
	`s°rög_√xt
(
xp
Ë!
NULL
)

234 
	`s°rög_¥ev
(
	`s°rög_√xt
(
xp
)) = xp;

235 
	`s°rög_hash
(
xp
Ë
hash
;

236 
	`s°rög_cou¡
(
xp
) = 1;

237 
	`s°rög_Àn
(
xp
Ë(
u_sh‹t
)
Àn
;

238 ()
	`mem˝y
(
xp
, 
˝
, 
Àn
 + 1);

239 
s°rög_èbÀ
[
hash
] = 
xp
;

240 
num_di°ö˘_°rögs_sh¨ed
++;

241 
byãs_di°ö˘_°rögs_sh¨ed
 +
Àn
 + 1;

242 
ovîhód_byãs_sh¨ed
 +
s°rög_hódî
;

243 
Ælocd_°rögs_sh¨ed
++;

244 
Ælocd_byãs_sh¨ed
 +
s°rög_hódî
 + 
	`s°rög_Àn
(
xp
) + 1;

246  
xp
;

247 
	}
}

250 
	$‰ì_s°rög
(*
˝
)

252 #ifde‡
DEBUG


253 i‡(
	`s°rög_magic
(
˝
Ë!
SSTRING_MAGIC
)

254 
	`Áèl
("Bad s-magic: %x %x\n", 
	`s°rög_magic
(
˝
), 
SSTRING_MAGIC
);

257 i‡(
	`s°rög_cou¡
(
˝
) != 0) {

258 
Ælocd_°rögs_sh¨ed
--;

259 
Ælocd_byãs_sh¨ed
 -
s°rög_hódî
 + 
	`s°rög_Àn
(
˝
) + 1;

261 i‡(--
	`s°rög_cou¡
(
˝
) == 0)

263 i‡(
	`s°rög_¥ev
(
˝
Ë!
NULL
)

264 
	`s°rög_√xt
(
	`s°rög_¥ev
(
˝
)) = sstring_next(cp);

266 
s°rög_èbÀ
[
	`s°rög_hash
(
˝
)] = 
	`s°rög_√xt
(cp);

267 i‡(
	`s°rög_√xt
(
˝
Ë!
NULL
)

268 
	`s°rög_¥ev
(
	`s°rög_√xt
(
˝
)) = sstring_prev(cp);

269 #ifde‡
DEBUG


270 
	`s°rög_magic
(
˝
) = 0;

272 
num_di°ö˘_°rögs_sh¨ed
--;

273 
byãs_di°ö˘_°rögs_sh¨ed
 -
	`s°rög_Àn
(
˝
) + 1;

274 
ovîhód_byãs_sh¨ed
 -
s°rög_hódî
;

275 
	`‰ì
(
˝
 - 
s°rög_hódî
);

278 
	}
}

281 
	$add_°rög_°©us
(*
deböf
)

283 
i
, 
n
;

284 *
˝
;

285 
mö
 = 
INT_MAX
;

286 
max
 = 
INT_MIN
;

287 
sum1
 = 0;

288 
sum2
 = 0;

289 
món
, 
°ddev
;

294 
i
 = 0; i < 
HTABLE_SIZE
; i++)

296 
n
 = 0;

297 
˝
 = 
s°rög_èbÀ
[
i
]; c∞!
NULL
; c∞
	`s°rög_√xt
(cp))

298 
n
++;

299 i‡(
mö
 > 
n
)

300 
mö
 = 
n
;

301 i‡(
max
 < 
n
)

302 
max
 = 
n
;

303 
sum1
 +
n
;

304 
sum2
 +
n
 *Ç;

307 i‡(
sum1
 == 0)

309 
mö
 = 0;

310 
max
 = 0;

316 
món
 = ()
sum1
 / 
HTABLE_SIZE
;

321 
°ddev
 = 
	`sqπ
((()
sum2
 -

322 ((()
sum1
 * ()sum1Ë/ 
HTABLE_SIZE
)) / HTABLE_SIZE);

324 ()
	`°rˇt
(
deböf
, "\nShared string hashÅable:\n");

325 ()
	`°rˇt
(
deböf
, "-------------------------\t Strings Bytes\n");

327 ()
	`•rötf
(
deböf
 + 
	`°æí
(debinf), "Totalásked for\t\t\t%8d %8ld\n",

328 
Ælocd_°rögs_sh¨ed
, 
Ælocd_byãs_sh¨ed
);

329 ()
	`•rötf
(
deböf
 + 
	`°æí
(debinf), "Actually used\t\t\t%8d %8ld\n",

330 
num_di°ö˘_°rögs_sh¨ed
,

331 
byãs_di°ö˘_°rögs_sh¨ed
 + 
ovîhód_byãs_sh¨ed
);

333 ()
	`•rötf
(
deböf
 + 
	`°æí
(debinf),

335 (
byãs_di°ö˘_°rögs_sh¨ed
 + 
ovîhód_byãs_sh¨ed
)*100.0 /

336 ()
Ælocd_byãs_sh¨ed
);

338 ()
	`•rötf
(
deböf
 + 
	`°æí
(debinf),

340 
num_°r_£¨ches
,

341 ()
£¨ch_Àn
 / ()
num_°r_£¨ches
);

343 ()
	`•rötf
(
deböf
 + 
	`°æí
(debinf),

344 "Hash sizê : %5d\n", 
HTABLE_SIZE
);

345 ()
	`•rötf
(
deböf
 + 
	`°æí
(debinf),

347 
mö
, 
món
);

348 ()
	`•rötf
(
deböf
 + 
	`°æí
(debinf),

350 
max
, 
°ddev
);

352 ()
	`°rˇt
(
deböf
, "\nMalloced stringÅable:\n");

353 ()
	`°rˇt
(
deböf
, "----------------------\t\t Strings Bytes\n");

355 ()
	`•rötf
(
deböf
 + 
	`°æí
(debinf), "Totalásked for\t\t\t%8d %8ld\n",

356 
Ælocd_°rögs_mÆlo˚d
, 
Ælocd_byãs_mÆlo˚d
);

357 ()
	`•rötf
(
deböf
 + 
	`°æí
(debinf), "Actually used\t\t\t%8d %8ld\n",

358 
num_di°ö˘_°rögs_mÆlo˚d
,

359 
byãs_di°ö˘_°rögs_mÆlo˚d
 + 
ovîhód_byãs_mÆlo˚d
);

361 ()
	`•rötf
(
deböf
 + 
	`°æí
(debinf),

363 (
byãs_di°ö˘_°rögs_mÆlo˚d
 + 
ovîhód_byãs_mÆlo˚d
)*100.0 /

364 ()
Ælocd_byãs_mÆlo˚d
);

365 
	}
}

367 #ifde‡
DEBUG


369 
	$dump_s°rögs
()

371 *
°r
;

372 
Àn
;

373 
FILE
 *
Â
;

374 
i
;

376 i‡((
Â
 = 
	`f›í
("SSTRING_DUMP", "w")Ë=
NULL
)

378 
i
 = 0; i < 
HTABLE_SIZE
; i++) {

379 
°r
 = 
s°rög_èbÀ
[
i
];

380 
°r
) {

381 i‡(
	`s°rög_magic
(
°r
Ë!
SSTRING_MAGIC
)

382 
	`Áèl
("Bad s-magic: %x %x\n", 
	`s°rög_magic
(
°r
), 
SSTRING_MAGIC
);

383 
Àn
 = 
	`s°rög_Àn
(
°r
);

384 ()
	`fwrôe
(&
Àn
, ÷í), 1, 
Â
);

385 ()
	`fwrôe
(
°r
, (), 
	`°æí
(°rË+ 1, 
Â
);

386 
°r
 = 
	`s°rög_√xt
(str);

389 ()
	`f˛o£
(
Â
);

390 
	}
}

393 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


395 
	$ªmove_°rög_hash
()

397 
i
;

399 
i
 = 0 ; i < 
HTABLE_SIZE
 ; i++)

400 
s°rög_èbÀ
[
i
] = 
NULL
;

401 
	}
}

	@mstring.h

33 
	sm°rög_hdr
 {

34 #ifde‡
DEBUG


35 
u_l⁄g
 
	mmagic
;

36 #ifde‡
__Æpha


37 
u_öt
 
	m∑d
;

40 
u_sh‹t
 
	mÀngth
;

41 
u_sh‹t
 
	mcou¡
;

44 
	#m°rög_hódî
 \

45  (
m°rög_hdr
)

	)

47 #ifde‡
DEBUG


49 
	#MSTRING_MAGIC
 0x12311943

	)

51 
	#m°rög_magic
(
˝
) \

52 (((
m°rög_hdr
 *)((*)(
˝
Ë- 
m°rög_hódî
))->
magic
)

	)

56 
	#m°rög_Àn
(
˝
) \

57 (((
m°rög_hdr
 *)((*)(
˝
Ë- 
m°rög_hódî
))->
Àngth
)

	)

59 
	#m°rög_cou¡
(
˝
) \

60 (((
m°rög_hdr
 *)((*)(
˝
Ë- 
m°rög_hódî
))->
cou¡
)

	)

62 *
Æloˇã_m°rög
(
size_t
);

63 *
make_m°rög
(*);

64 *
ª„ªn˚_m°rög
(*);

65 
‰ì_m°rög
(*);

67 
	ss°rög_hdr
 {

68 #ifde‡
DEBUG


69 
u_l⁄g
 
	mmagic
;

71 *
	m¥ev
;

72 *
	m√xt
;

73 #i‡
deföed
(
DEBUG
)

74 
u_sh‹t
 
	m∑d
;

76 
u_sh‹t
 
	mÀngth
;

77 
u_sh‹t
 
	mcou¡
;

78 
u_sh‹t
 
	mhash
;

81 
	#s°rög_hódî
 \

82  (
s°rög_hdr
)

	)

84 #ifde‡
DEBUG


86 
	#SSTRING_MAGIC
 0x04301963

	)

88 
	#s°rög_magic
(
˝
) \

89 (((
s°rög_hdr
 *)((*)(
˝
Ë- 
s°rög_hódî
))->
magic
)

	)

93 
	#s°rög_¥ev
(
˝
) \

94 (((
s°rög_hdr
 *)((*)(
˝
Ë- 
s°rög_hódî
))->
¥ev
)

	)

96 
	#s°rög_√xt
(
˝
) \

97 (((
s°rög_hdr
 *)((*)(
˝
Ë- 
s°rög_hódî
))->
√xt
)

	)

99 
	#s°rög_Àn
(
˝
) \

100 (((
s°rög_hdr
 *)((*)(
˝
Ë- 
s°rög_hódî
))->
Àngth
)

	)

102 
	#s°rög_cou¡
(
˝
) \

103 (((
s°rög_hdr
 *)((*)(
˝
Ë- 
s°rög_hódî
))->
cou¡
)

	)

105 
	#s°rög_hash
(
˝
) \

106 (((
s°rög_hdr
 *)((*)(
˝
Ë- 
s°rög_hódî
))->
hash
)

	)

108 *
ª„ªn˚_s°rög
(*);

109 *
make_s°rög
(*);

110 
‰ì_s°rög
(*);

111 *
föd_s°rög
(*);

113 
	#HASH_SSTRING
(
˝
Ë(
	`hash°r16
((˝), 64Ë% 
HTABLE_SIZE
)

	)

115 #ifde‡
DEBUG


116 
dump_s°rögs
();

118 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


119 
ªmove_°rög_hash
();

	@mudstat.c

6 
	~<sys/ty≥s.h
>

7 
	~<sys/time.h
>

8 
	~<sys/times.h
>

9 
	~<°dio.h
>

10 
	~<°rög.h
>

12 
	~"c⁄fig.h
"

13 
	~"löt.h
"

15 #ifde‡
sun


16 
time_t
 
time
 (time_t *);

20 
	#MUDSTAT


	)

21 
	~"mud°©.h
"

23 #ifde‡
RUSAGE


24 #ifde‡
SOLARIS


25 
	~<sys/times.h
>

26 
	~<limôs.h
>

28 
	~<sys/ªsour˚.h
>

29 
gërußge
 (, 
rußge
 *);

30 #ifde‡
sun


31 
gë∑gesize
 ();

33 #i‚de‡
RUSAGE_SELF


34 
	#RUSAGE_SELF
 0

	)

39 
	gnum_move
,

40 
	gnum_mˇŒ
,

41 
	gnum_fûîód
,

42 
	gnum_fûewrôe
,

43 
	gnum_compûe
;

45 
	gmch_t1
;

46 
tms
 
	gtms1
;

47 
	gnum_¥
 = 0,

48 
	gms_evÆ_lim
,

49 
	gms_time_lim
,

50 
	gms_a˘ive
 = 0;

52 
m¨k_mûlôime
();

54 
s_Êag
;

60 
	$mud°©us_£t
(
a˘ive
, 
evÆ_lim
, 
time_lim
)

62 
tiÊ
 = 
time_lim
 / 100.0;

63 
FILE
 *
m°©
;

65 
ms_a˘ive
 = 
a˘ive
;

67 i‡(
a˘ive
)

69 
s_Êag
 = 1;

70 i‡((
m°©
 = 
	`f›í
(
MUDSTAT_FILE
, "a")Ë!
NULL
)

72 ()
	`Ârötf
(
m°©
,"\n%-30s (%5.2f) %8d\n",

73 "------ ON, Limôs:", 
tiÊ
, 
evÆ_lim
);

74 ()
	`f˛o£
(
m°©
);

79 i‡(
s_Êag
 && ((
m°©
 = 
	`f›í
(
MUDSTAT_FILE
,"a")Ë!
NULL
))

81 ()
	`Ârötf
(
m°©
,"\n%-30s\n", "------ OFF");

82 ()
	`f˛o£
(
m°©
);

84 
s_Êag
 = 0;

86 
ms_evÆ_lim
 = ((
evÆ_lim
 >0Ë?ÉvÆ_lim : 
MUDSTAT_LOGEVAL
);

87 
ms_time_lim
 = ((
time_lim
 >0Ë?Åime_lim : 
MUDSTAT_LOGTIME
);

88 
	}
}

94 
	$m¨k_mûlôime
()

96 #ifde‡
RUSAGE


97 #ifde‡
SOLARIS


98 
tms
 
buf„r
;

100 i‡(
	`times
(&
buf„r
) != -1)

101 
mch_t1
 = 
buf„r
.
tms_utime
 + buf„r.
tms_°ime
;

103 
rußge
 
rus
;

104 i‡(
	`gërußge
(
RUSAGE_SELF
, &
rus
) >= 0)

108 
mch_t1
 = 
rus
.
ru_utime
.
tv_£c
 * 1000 +Ñus.ru_utime.
tv_u£c
 / 1000 +

109 
rus
.
ru_°ime
.
tv_£c
 * 1000 +Ñus.ru_°ime.
tv_u£c
 / 1000;

114 ()
	`times
(&
tms1
);

115 
	}
}

121 
	$gë_mûlôime
()

123 
mtime
;

124 
tms
 
tms2
;

126 ()
	`times
(&
tms2
);

127 
mtime
 = (
tms2
.
tms_utime
 - 
tms1
.tms_utime +

128 
tms2
.
tms_°ime
 - 
tms1
.tms_stime) / 60.0;

130  ()(
mtime
 * 100.0);

131 
	}
}

133 #ifde‡
RUSAGE


138 
	$gë_¥o˚s°ime
()

140 #ifde‡
SOLARIS


141 
tms
 
buf„r
;

142 
mch_t2
;

144 i‡(
	`times
(&
buf„r
) != -1)

145 
mch_t2
 = 
buf„r
.
tms_utime
 + buf„r.
tms_°ime
;

147 
rußge
 
rus
;

148 
mch_t2
;

150 i‡(
	`gërußge
(
RUSAGE_SELF
, &
rus
) >= 0)

154 
mch_t2
 = 
rus
.
ru_utime
.
tv_£c
 * 1000 +Ñus.ru_utime.
tv_u£c
 / 1000 +

155 
rus
.
ru_°ime
.
tv_£c
 * 1000 +Ñus.ru_°ime.
tv_u£c
 / 1000;

159  ()(
mch_t2
 - 
mch_t1
);

160 
	}
}

162 
	$gë_¥o˚s°ime
(Ë{  0; 
	}
}

166 
	$ª£t_mud°©us
()

168 
	`m¨k_mûlôime
();

169 
num_move
 = 0;

170 
num_mˇŒ
 = 0;

171 
num_fûîód
 = 0;

172 
num_fûewrôe
 = 0;

173 
num_compûe
 = 0;

174 
	}
}

177 
	$¥öt_mud°©us
(*
a˘ivôy
, 
evÆ
, 
timem
, 
tùroc
)

179 
FILE
 *
m°©
;

180 
tiÊ
, 
tiÊ2
;

182 i‡(!
ms_a˘ive
)

185 i‡(
timem
 < 
ms_time_lim
 && 
evÆ
 < 
ms_evÆ_lim
)

188 
tiÊ
 = 
timem
 / 100.0;

189 
tiÊ2
 = 
tùroc
 / 1000.0;

191 i‡((
m°©
 = 
	`f›í
(
MUDSTAT_FILE
,"a")Ë!
NULL
)

193 i‡(!
num_¥
)

194 ()
	`Ârötf
(
m°©
,"\n%-30s (%11s) %8s %3s %3s %3s %3s %3s\n",

197 
num_¥
 = (num_pr + 1) % 10;

198 i‡(
	`°æí
(
a˘ivôy
) < 30U)

199 ()
	`Ârötf
(
m°©
,"%-30s (%5.2f:%5.2f) %8d %3d %3d %3d %3d %3d\n",

200 
a˘ivôy
, 
tiÊ
, 
tiÊ2
, 
evÆ
, 
num_compûe
, 
num_mˇŒ
,

201 
num_fûîód
, 
num_fûewrôe
, 
num_move
);

203 ()
	`Ârötf
(
m°©
,"%s\n%-30s (%5.2f:%5.2f) %8d %3d %3d %3d %3d %3d\n",

204 
a˘ivôy
, "", 
tiÊ
, 
tiÊ2
, 
evÆ
, 
num_compûe
, 
num_mˇŒ
,

205 
num_fûîód
, 
num_fûewrôe
, 
num_move
);

207 ()
	`f˛o£
(
m°©
);

209 
	}
}

	@mudstat.h

5 
num_move
,

6 
num_mˇŒ
,

7 
num_fûîód
,

8 
num_fûewrôe
,

9 
num_compûe
;

11 
	#MUDSTAT_FILE
 "MUD°©i°ics"

	)

12 
	#MUDSTAT_LOGTIME
 50

	)

13 
	#MUDSTAT_LOGEVAL
 25000

	)

18 
ª£t_mud°©us
();

19 
mud°©us_£t
(
a˘ive
, 
evÆ_lim
, 
time_lim
);

20 
¥öt_mud°©us
(*, , , );

21 
gë_mûlôime
();

22 
gë_¥o˚s°ime
();

	@ndesc.c

32 
	~<°dio.h
>

33 
	~<°dlib.h
>

34 
	~<°rög.h
>

35 
	~<uni°d.h
>

36 
	~<sys/ty≥s.h
>

37 
	~<sys/time.h
>

38 
	~"c⁄fig.h
"

39 
	~"löt.h
"

40 
	~"ndesc.h
"

46 
ndesc_t
 *
	gnd_hód
;

47 
ndesc_t
 *
	gnd_èû
;

48 
	gnd_max_fd
;

49 
fd_£t
 
	gnd_rfds
;

50 
fd_£t
 
	gnd_wfds
;

51 
fd_£t
 
	gnd_xfds
;

52 
ndesc_t
 *
	gnd_ndesc
[
FD_SETSIZE
];

53 
	gnd_do_gc
;

61 
	$nd_öôfd
(
fd
)

63 
	`FD_CLR
(
fd
, &
nd_rfds
);

64 
	`FD_CLR
(
fd
, &
nd_wfds
);

65 
	`FD_CLR
(
fd
, &
nd_xfds
);

67 
nd_ndesc
[
fd
] = 
NULL
;

68 
	}
}

74 
	$nd_öô
()

76 
nd_hód
 = 
NULL
;

77 
nd_èû
 = 
NULL
;

79 
nd_max_fd
 = -1;

81 
	`FD_ZERO
(&
nd_rfds
);

82 
	`FD_ZERO
(&
nd_wfds
);

83 
	`FD_ZERO
(&
nd_xfds
);

85 
	`mem£t
(
nd_ndesc
, 0,  (nd_ndesc));

87 
nd_do_gc
 = 0;

88 
	}
}

95 
	$nd_≠≥nd
(
ndesc_t
 *
nd
)

97 
nd
->
nd_√xt
 = 
NULL
;

98 i‡((
nd
->
nd_¥ev
 = 
nd_èû
Ë!
NULL
)

99 
nd
->
nd_¥ev
->
nd_√xt
 =Çd;

101 
nd_hód
 = 
nd
;

102 
nd_èû
 = 
nd
;

103 
	}
}

110 
	$nd_ªmove
(
ndesc_t
 *
nd
)

112 i‡(
nd
->
nd_√xt
 !
NULL
)

113 
nd
->
nd_√xt
->
nd_¥ev
 =Çd->nd_prev;

115 
nd_èû
 = 
nd
->
nd_¥ev
;

117 i‡(
nd
->
nd_¥ev
 !
NULL
)

118 
nd
->
nd_¥ev
->
nd_√xt
 =Çd->nd_next;

120 
nd_hód
 = 
nd
->
nd_√xt
;

121 
	}
}

128 
	$nd_fd
(
ndesc_t
 *
nd
)

130  
nd
->
nd_fd
;

131 
	}
}

138 
	$nd_vp
(
ndesc_t
 *
nd
)

140  
nd
->
nd_vp
;

141 
	}
}

146 
ndesc_t
 *

147 
	$nd_©èch
(
fd
, *
rfunc
, *
wfunc
, *
xfunc
, *
cfunc
,

148 *
sfunc
, *
vp
)

150 
ndesc_t
 *
nd
;

152 
nd
 = 
	`xÆloc
( (
ndesc_t
));

153 
nd
->
nd_fd
 = 
fd
;

154 
nd
->
nd_mask
 = 0;

155 
nd
->
nd_rfunc
 = 
rfunc
;

156 
nd
->
nd_wfunc
 = 
wfunc
;

157 
nd
->
nd_xfunc
 = 
xfunc
;

158 
nd
->
nd_cfunc
 = 
cfunc
;

159 
nd
->
nd_sfunc
 = 
sfunc
;

160 
nd
->
nd_vp
 = 
vp
;

162 
	`nd_≠≥nd
(
nd
);

164 i‡(
nd_max_fd
 < 
fd
)

165 
nd_max_fd
 = 
fd
;

167 
nd_ndesc
[
fd
] = 
nd
;

169  
nd
;

170 
	}
}

176 
	$nd_dëach
(
ndesc_t
 *
nd
)

178 
	`nd_ªmove
(
nd
);

180 
	`nd_öôfd
(
nd
->
nd_fd
);

182 
	`‰ì
(
nd
);

184 
nd_do_gc
++;

185 
	}
}

194 
	$nd_gc
()

196 
fd
;

198 
nd_do_gc
 = 0;

200 i‡(
nd_max_fd
 == -1)

205 
nd_ndesc
[
nd_max_fd
] =
NULL
)

206 i‡(--
nd_max_fd
 == -1)

209 
fd
 = 
	`dup
(
nd_max_fd
);

210 i‡(
fd
 == -1)

213 i‡(
fd
 < 
nd_max_fd
)

215 i‡(
	`FD_ISSET
(
nd_max_fd
, &
nd_rfds
))

216 
	`FD_SET
(
fd
, &
nd_rfds
);

217 i‡(
	`FD_ISSET
(
nd_max_fd
, &
nd_wfds
))

218 
	`FD_SET
(
fd
, &
nd_wfds
);

219 i‡(
	`FD_ISSET
(
nd_max_fd
, &
nd_xfds
))

220 
	`FD_SET
(
fd
, &
nd_xfds
);

222 
nd_ndesc
[
fd
] =Çd_ndesc[
nd_max_fd
];

223 
nd_ndesc
[
fd
]->
nd_fd
 = fd;

225 
	`nd_öôfd
(
nd_max_fd
);

227 
	`˛o£
(
nd_max_fd
);

231 
	`˛o£
(
fd
);

235 
	}
}

242 
	$nd_íabÀ
(
ndesc_t
 *
nd
, 
mask
)

244 
fd
;

246 
nd
->
nd_mask
 |
mask
 & 
ND_MASK
;

248 
fd
 = 
nd
->
nd_fd
;

250 i‡(
mask
 & 
ND_R
)

251 
	`FD_SET
(
fd
, &
nd_rfds
);

252 i‡(
mask
 & 
ND_W
)

253 
	`FD_SET
(
fd
, &
nd_wfds
);

254 i‡(
mask
 & 
ND_X
)

255 
	`FD_SET
(
fd
, &
nd_xfds
);

256 
	}
}

263 
	$nd_dißbÀ
(
ndesc_t
 *
nd
, 
mask
)

265 
fd
;

267 
nd
->
nd_mask
 &~
mask
;

269 
fd
 = 
nd
->
nd_fd
;

271 i‡(
mask
 & 
ND_R
)

272 
	`FD_CLR
(
fd
, &
nd_rfds
);

273 i‡(
mask
 & 
ND_W
)

274 
	`FD_CLR
(
fd
, &
nd_wfds
);

275 i‡(
mask
 & 
ND_X
)

276 
	`FD_CLR
(
fd
, &
nd_xfds
);

277 
	}
}

287 
	$nd_£À˘
(
timevÆ
 *
tvp
)

289 
nfds
, 
fd
, 
£ç
;

290 
fd_£t
 
rfds
, 
wfds
, 
xfds
;

291 
ndesc_t
 *
nd
, *
√xt
;

293 
rfds
 = 
nd_rfds
;

294 
wfds
 = 
nd_wfds
;

295 
xfds
 = 
nd_xfds
;

297 
nfds
 = 
	`£À˘
(
nd_max_fd
 + 1, &
rfds
, &
wfds
, &
xfds
, 
tvp
);

298 i‡(
nfds
 == -1)

301 
nd
 = 
nd_hód
;Çd !
NULL
;Çd = 
√xt
)

303 i‡(
nfds
 == 0)

306 
√xt
 = 
nd
->
nd_√xt
;

308 i‡(
nd
->
nd_mask
 == 0)

311 
fd
 = 
nd
->
nd_fd
;

313 
£ç
 = 0;

315 i‡(
	`FD_ISSET
(
fd
, &
xfds
))

317 (*
nd
->
nd_xfunc
)“d,Çd->
nd_vp
);

318 
£ç
 = 1;

321 i‡(
	`FD_ISSET
(
fd
, &
wfds
))

323 (*
nd
->
nd_wfunc
)“d,Çd->
nd_vp
);

324 
£ç
 = 1;

327 i‡(
	`FD_ISSET
(
fd
, &
rfds
))

329 (*
nd
->
nd_rfunc
)“d,Çd->
nd_vp
);

330 
£ç
 = 1;

333 
nfds
 -
£ç
;

335 i‡(
nd
->
nd_mask
 & 
ND_C
)

336 (*
nd
->
nd_cfunc
)“d,Çd->
nd_vp
);

339 i‡(
nd_do_gc
)

340 
	`nd_gc
();

341 
	}
}

347 
	$nd_shutdown
()

349 
timevÆ
 
tv
;

350 
ndesc_t
 *
nd
, *
√xt
;

352 
tv
.
tv_£c
 =Åv.
tv_u£c
 = 0;

353 
	`nd_£À˘
(&
tv
);

355 
nd
 = 
nd_hód
;Çd !
NULL
;Çd = 
√xt
)

357 
√xt
 = 
nd
->
nd_√xt
;

359 i‡(
nd
->
nd_sfunc
 !
NULL
)

360 (*
nd
->
nd_sfunc
)“d,Çd->
nd_vp
);

362 
	}
}

	@ndesc.h

32 
	sndesc
 {

33 
	mnd_fd
;

34 
	mnd_mask
;

35 (*
	mnd_rfunc
)(
	mndesc
 *, *);

36 (*
	mnd_wfunc
)(
	mndesc
 *, *);

37 (*
	mnd_xfunc
)(
	mndesc
 *, *);

38 (*
	mnd_cfunc
)(
	mndesc
 *, *);

39 (*
	mnd_sfunc
)(
	mndesc
 *, *);

40 * 
	mnd_vp
;

41 
ndesc
 * 
	mnd_√xt
;

42 
ndesc
 * 
	mnd_¥ev
;

43 } 
	tndesc_t
;

45 
	#ND_R
 0x01

	)

46 
	#ND_W
 0x02

	)

47 
	#ND_X
 0x04

	)

48 
	#ND_C
 0x08

	)

49 
	#ND_MASK
 0x0f

	)

51 
	gtimevÆ
;

53 
nd_öô
();

54 
nd_fd
(
ndesc_t
 *);

55 *
nd_vp
(
ndesc_t
 *);

56 
ndesc_t
 *
nd_©èch
(, *, *, *, *, *, *);

57 
nd_dëach
(
ndesc_t
 *);

58 
nd_íabÀ
(
ndesc_t
 *, );

59 
nd_dißbÀ
(
ndesc_t
 *, );

60 
nd_£À˘
(
timevÆ
 *);

61 
nd_shutdown
();

	@net.c

32 
	~<î∫o.h
>

33 
	~<f˙é.h
>

34 
	~<°dio.h
>

35 
	~<°dlib.h
>

36 
	~<uni°d.h
>

37 
	~<sys/ty≥s.h
>

38 
	~<sys/sockë.h
>

39 #ifde‡
SOLARIS


40 
	~<sys/sockio.h
>

42 
	~<sys/io˘l.h
>

43 
	~<√töë/ö.h
>

44 #i‡!
deföed
(
FNDELAY
Ë&& deföed(
O_NDELAY
)

45 
	#FNDELAY
 
O_NDELAY


	)

47 
	~"c⁄fig.h
"

48 
	~"simuœã.h
"

49 
	~"löt.h
"

50 
	~"nqueue.h
"

52 #i‚de‡
IPTOS_LOWDELAY


53 
	#IPTOS_LOWDELAY
 0x10

	)

60 
	$íabÀ_nbio
(
fd
)

62 #i‡
	`deföed
(
M_UNIX
Ë|| deföed(
NeXT
Ë|| deföed(
_AIX
)

64 
nb
 = 1;

66 i‡(
	`io˘l
(
fd
, 
FIONBIO
, &
nb
) == -1)

68 
	`Áèl
("enable_nbio: ioctl(FIONBIO)Érrno = %d.\n",

69 
î∫o
);

74 i‡(
	`f˙é
(
fd
, 
F_SETOWN
, 
	`gëpid
()) == -1)

75 
	`Áèl
("enable_nbio: fcntl(F_SETOWN)Érrno = %d.\n",

76 
î∫o
);

78 i‡(
	`f˙é
(
fd
, 
F_SETFL
, 
FNDELAY
) == -1)

79 
	`Áèl
("enable_nbio: fcntl(F_SETFL, FNDELAY)Érrno = %d.\n",

80 
î∫o
);

83 
	}
}

89 
	$íabÀ_ªu£addr
(
s
)

91 
ªu£
 = 1;

93 i‡(
	`£tsock›t
(
s
, 
SOL_SOCKET
, 
SO_REUSEADDR
, (*)&
ªu£
,  (reuse)) == -1)

94 
	`Áèl
("íabÀ_ªu£addr: sësock›t(Ëî∫ÿ%d.\n", 
î∫o
);

95 
	}
}

101 
	$íabÀ_oobölöe
(
s
)

103 
oobölöe
 = 1;

105 i‡(
	`£tsock›t
(
s
, 
SOL_SOCKET
, 
SO_OOBINLINE
, (*)&
oobölöe
,  (oobinline)) == -1)

106 
	`Áèl
("íabÀ_oobölöe: sësock›t(Ëî∫ÿ%d.\n", 
î∫o
);

107 
	}
}

113 
	$íabÀ_lowdñay
(
s
)

115 #i‡
	`deföed
(
IPPROTO_IP
Ë&& deföed(
IP_TOS
)

116 
tos
 = 
IPTOS_LOWDELAY
;

118 i‡(
	`£tsock›t
(
s
, 
IPPROTO_IP
, 
IP_TOS
, (*)&
tos
,  (tos)) == -1)

119 
	`Áèl
("íabÀ_lowdñay: sësock›t(Ëî∫ÿ%d.\n", 
î∫o
);

121 
	}
}

127 
	$©_m¨k
(
fd
)

129 
©m¨k
 = 0;

131 i‡(
	`io˘l
(
fd
, 
SIOCATMARK
, &
©m¨k
) != -1)

133 i‡(
©m¨k
)

138 
	}
}

144 
	$£t_rcvsize
(
s
, 
size
)

146 #ifde‡
SO_RCVBUF


147 ()
	`£tsock›t
(
s
, 
SOL_SOCKET
, 
SO_RCVBUF
, (*)&
size
, (size));

149 
	}
}

155 
	$£t_¢dsize
(
s
, 
size
)

157 #ifde‡
SO_SNDBUF


158 ()
	`£tsock›t
(
s
, 
SOL_SOCKET
, 
SO_SNDBUF
, (*)&
size
, (size));

160 
	}
}

	@net.h

32 
íabÀ_nbio
();

33 
íabÀ_ªu£addr
();

34 
íabÀ_oobölöe
();

35 
íabÀ_lowdñay
();

36 
©_m¨k
();

37 
£t_¢dsize
(, );

38 
£t_rcvsize
(, );

	@nqueue.c

32 
	~<°dio.h
>

33 
	~<°dlib.h
>

34 
	~<uni°d.h
>

35 
	~<sys/ty≥s.h
>

36 
	~<sys/sockë.h
>

37 
	~"c⁄fig.h
"

38 
	~"löt.h
"

39 
	~"nqueue.h
"

50 
	$nq_öô
(
nqueue_t
 *
nq
)

52 
nq
->
nq_Àn
 = 0;

53 
nq
->
nq_Ωå
 = 0;

54 
nq
->
nq_w±r
 = 0;

55 
	}
}

60 
nqueue_t
 *

61 
	$nq_Æloc
(
u_sh‹t
 
size
)

63 
nqueue_t
 *
nq
;

65 
nq
 = 
	`xÆloc
( (
nqueue_t
Ë+ 
size
);

66 
nq
->
nq_size
 = 
size
;

67 
	`nq_öô
(
nq
);

69  
nq
;

70 
	}
}

76 
	$nq_‰ì
(
nqueue_t
 *
nq
)

78 
	`‰ì
(
nq
);

79 
	}
}

84 
u_sh‹t


85 
	$nq_size
(
nqueue_t
 *
nq
)

87  
nq
->
nq_size
;

88 
	}
}

93 
u_sh‹t


94 
	$nq_Àn
(
nqueue_t
 *
nq
)

96  
nq
->
nq_Àn
;

97 
	}
}

103 
u_sh‹t


104 
	$nq_avaû
(
nqueue_t
 *
nq
)

106  
nq
->
nq_size
 -Çq->
nq_Àn
;

107 
	}
}

112 
u_ch¨
 *

113 
	$nq_Ωå
(
nqueue_t
 *
nq
)

115  (
u_ch¨
 *)(
nq
 + 1Ë+Çq->
nq_Ωå
;

116 
	}
}

121 
u_ch¨
 *

122 
	$nq_w±r
(
nqueue_t
 *
nq
)

124  (
u_ch¨
 *)(
nq
 + 1Ë+Çq->
nq_w±r
;

125 
	}
}

132 
	$nq_em±y
(
nqueue_t
 *
nq
)

134  
nq
->
nq_Àn
 == 0;

135 
	}
}

142 
	$nq_fuŒ
(
nqueue_t
 *
nq
)

144  
nq
->
nq_Àn
 =nq->
nq_size
;

145 
	}
}

152 
u_ch¨


153 
	$nq_gëc
(
nqueue_t
 *
nq
)

155 
u_ch¨
 
c
;

157 
c
 = *
	`nq_Ωå
(
nq
);

158 
nq
->
nq_Àn
--,Çq->
nq_Ωå
++;

159 i‡(
nq
->
nq_Ωå
 =nq->
nq_size
)

160 
nq
->
nq_Ωå
 = 0;

162  
c
;

163 
	}
}

171 
	$nq_ungëc
(
nqueue_t
 *
nq
, 
u_ch¨
 
c
)

173 
nq
->
nq_Àn
++;

174 i‡(
nq
->
nq_Ωå
-- == 0)

175 
nq
->
nq_Ωå
 =Çq->
nq_size
 - 1;

176 *
	`nq_Ωå
(
nq
Ë
c
;

177 
	}
}

185 
	$nq_putc
(
nqueue_t
 *
nq
, 
u_ch¨
 
c
)

187 *
	`nq_w±r
(
nq
Ë
c
;

188 
nq
->
nq_Àn
++,Çq->
nq_w±r
++;

189 i‡(
nq
->
nq_w±r
 =nq->
nq_size
)

190 
nq
->
nq_w±r
 = 0;

191 
	}
}

199 
	$nq_puts
(
nqueue_t
 *
nq
, 
u_ch¨
 *
˝
)

201 
Àn
, 
size
;

203 
Àn
 = 
	`°æí
(
˝
);

205 
Àn
 > 0)

207 i‡(
nq
->
nq_Ωå
 >Çq->
nq_w±r
)

208 
size
 = 
nq
->
nq_Ωå
 -Çq->
nq_w±r
;

210 
size
 = 
nq
->
nq_size
 -Çq->
nq_w±r
;

212 i‡(
size
 > 
Àn
)

213 
size
 = 
Àn
;

215 
	`mem˝y
(
	`nq_w±r
(
nq
), 
˝
, 
size
);

217 
nq
->
nq_Àn
 +
size
,Çq->
nq_w±r
 += size;

218 i‡(
nq
->
nq_w±r
 =nq->
nq_size
)

219 
nq
->
nq_w±r
 = 0;

221 
˝
 +
size
, 
Àn
 -= size;

223 
	}
}

231 
	$nq_u≈utc
(
nqueue_t
 *
nq
)

233 
nq
->
nq_Àn
--;

234 i‡(
nq
->
nq_w±r
-- == 0)

235 
nq
->
nq_w±r
 =Çq->
nq_size
 - 1;

236 
	}
}

244 
	$nq_ªcv
(
nqueue_t
 *
nq
, 
fd
, 
u_öt
 *
uù
)

246 
Àn
, 
cc
;

248 i‡(
nq
->
nq_Ωå
 >Çq->
nq_w±r
)

249 
Àn
 = 
nq
->
nq_Ωå
 -Çq->
nq_w±r
;

251 
Àn
 = 
nq
->
nq_size
 -Çq->
nq_w±r
;

253 
cc
 = 
	`ªcv
(
fd
, 
	`nq_w±r
(
nq
), 
Àn
, 0);

255 i‡(
cc
 > 0)

257 
nq
->
nq_Àn
 +
cc
,Çq->
nq_w±r
 += cc;

258 i‡(
nq
->
nq_w±r
 =nq->
nq_size
)

259 
nq
->
nq_w±r
 = 0;

261 i‡(
uù
 !
NULL
)

262 *
uù
 +
cc
;

265  
cc
;

266 
	}
}

272 
	$nq_£nd
(
nqueue_t
 *
nq
, 
fd
, 
u_öt
 *
uù
)

274 
Àn
, 
cc
 = 0;

276 
nq
->
nq_Àn
 > 0)

278 
Àn
 = 
nq
->
nq_size
 -Çq->
nq_Ωå
;

280 i‡(
Àn
 > 
nq
->
nq_Àn
)

281 
Àn
 = 
nq
->
nq_Àn
;

283 
cc
 = 
	`£nd
(
fd
, 
	`nq_Ωå
(
nq
), 
Àn
, 0);

285 i‡(
cc
 > 0)

287 
nq
->
nq_Àn
 -
cc
,Çq->
nq_Ωå
 += cc;

288 i‡(
nq
->
nq_Ωå
 =nq->
nq_size
)

289 
nq
->
nq_Ωå
 = 0;

291 i‡(
uù
 !
NULL
)

292 *
uù
 +
cc
;

295 i‡(
cc
 !
Àn
)

299  
cc
;

300 
	}
}

	@nqueue.h

33 
u_sh‹t
 
	mnq_size
;

34 
u_sh‹t
 
	mnq_Àn
;

35 
u_sh‹t
 
	mnq_Ωå
;

36 
u_sh‹t
 
	mnq_w±r
;

37 } 
	tnqueue_t
;

39 
nq_öô
(
nqueue_t
 *);

40 
nqueue_t
 *
nq_Æloc
(
u_sh‹t
);

41 
nq_‰ì
(
nqueue_t
 *);

42 
u_sh‹t
 
nq_size
(
nqueue_t
 *);

43 
u_sh‹t
 
nq_Àn
(
nqueue_t
 *);

44 
u_sh‹t
 
nq_avaû
(
nqueue_t
 *);

45 
u_ch¨
 *
nq_Ωå
(
nqueue_t
 *);

46 
u_ch¨
 *
nq_w±r
(
nqueue_t
 *);

47 
nq_em±y
(
nqueue_t
 *);

48 
nq_fuŒ
(
nqueue_t
 *);

49 
u_ch¨
 
nq_gëc
(
nqueue_t
 *);

50 
nq_ungëc
(
nqueue_t
 *, 
u_ch¨
);

51 
nq_putc
(
nqueue_t
 *, 
u_ch¨
);

52 
nq_puts
(
nqueue_t
 *, 
u_ch¨
 *);

53 
nq_u≈utc
(
nqueue_t
 *);

54 
nq_ªcv
(
nqueue_t
 *, , 
u_öt
 *);

55 
nq_£nd
(
nqueue_t
 *, , 
u_öt
 *);

	@object.c

1 
	~<sys/ty≥s.h
>

2 
	~<sys/°©.h
>

3 
	~<°dio.h
>

4 
	~<°dlib.h
>

5 
	~<˘y≥.h
>

6 
	~<°rög.h
>

7 #ifde‡
__STDC__


8 
	~<mem‹y.h
>

10 #i‡
deföed
(
sun
Ë|| deföed(
__osf__
)

11 
	~<Æloˇ.h
>

14 
	~"c⁄fig.h
"

15 
	~"löt.h
"

16 
	~"m°rög.h
"

17 
	~"öãΩªt.h
"

18 
	~"obje˘.h
"

19 
	~"comm.h
"

20 
	~"su≥r_¢o›.h
"

21 
	~"£¡.h
"

22 
	~"exec.h
"

23 
	~"m≠pög.h
"

24 
	~"mud°©.h
"

25 
	~"hash.h
"

26 
	~"sw≠.h
"

27 
	~"maö.h
"

28 
	~"simuœã.h
"

29 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


30 
	~"ˇŒ_out.h
"

33 
	~"ölöe_svÆue.h
"

35 
d_Êag
, 
s_Êag
;

36 
tŸÆ_num_¥og_blocks
, 
tŸÆ_¥og_block_size
;

37 *
add_¶ash
(*);

38 
	gtŸ_Æloc_de°_obje˘
 = 0;

39 
	gtŸ_ªmoved_obje˘
 = 0;

41 
	#Æign
(
x
Ë–((xË+ ((*)-1ËË& ~((*)-1Ë)

	)

43 
obje˘
 *
	g¥evious_ob
;

45 
	gtŸ_Æloc_obje˘
, 
	gtŸ_Æloc_obje˘_size
;

47 
	sßvebuf
 {

48 
	mmax_size
;

49 
	msize
;

50 *
	mbuf
;

55 
	$add_°rbuf
(
ßvebuf
 *
sbuf
, *
°r
)

57 
size_t
 
Àn
;

59 
Àn
 = 
	`°æí
(
°r
);

60 i‡(
sbuf
->
size
 + 
Àn
 + 1 > sbuf->
max_size
)

62 *
nbuf
;

63 
size_t
 
nsize
;

65 
nbuf
 = 
	`xÆloc
(
nsize
 = 
Àn
 + 
sbuf
->
size
 + 80);

66 ()
	`°r˝y
(
nbuf
, 
sbuf
->
buf
);

67 
sbuf
->
max_size
 = 
nsize
;

68 
	`‰ì
(
sbuf
->
buf
);

69 
sbuf
->
buf
 = 
nbuf
;

71 ()
	`°r˝y
(&(
sbuf
->
buf
[sbuf->
size
]), 
°r
);

72 
sbuf
->
size
 +
Àn
;

73 
	}
}

76 
	#F¥ötf
(
s
Ëi‡(
Ârötf
 s =
EOF
Ë
Áûed
=1

	)

78 
ßve_⁄e
 (
ßvebuf
 *,
svÆue
 *);

81 
	$ßve_°rög
(
ßvebuf
 *
f
, *
s
)

83 
buf
[2];

85 
buf
[1] = '\0';

87 
	`add_°rbuf
(
f
, "\"");

88 *
s
)

90 *
s
)

93 
	`add_°rbuf
(
f
, "\\\"");

96 
	`add_°rbuf
(
f
, "\\\\");

99 
	`add_°rbuf
(
f
, "\\n");

103 
buf
[0] = *
s
;

104 
	`add_°rbuf
(
f
, 
buf
);

107 
s
++;

109 
	`add_°rbuf
(
f
, "\"");

111 
	}
}

117 
	$ßve_¨øy
(
ßvebuf
 *
f
, 
ve˘‹
 *
v
)

119 
i
;

121 
	`add_°rbuf
(
f
, "({");

122 
i
 = 0; i < 
v
->
size
; i++)

124 
	`ßve_⁄e
(
f
, &
v
->
ôem
[
i
]);

125 
	`add_°rbuf
(
f
,",");

127 
	`add_°rbuf
(
f
,"})");

128 
	}
}

131 
	$ßve_m≠pög
(
ßvebuf
 *
f
, 
m≠pög
 *
m
)

133 
i
;

134 
≠aú
 *
p
;

136 
	`add_°rbuf
(
f
, "([");

137 
i
 = 0; i < 
m
->
size
; i++)

139 
p
 = 
m
->
∑ús
[
i
];Ö;Ö =Ö->
√xt
)

141 
	`ßve_⁄e
(
f
, &
p
->
¨g
);

142 
	`add_°rbuf
(
f
,":");

143 
	`ßve_⁄e
(
f
, &
p
->
vÆ
);

144 
	`add_°rbuf
(
f
,",");

147 
	`add_°rbuf
(
f
,"])");

148 
	}
}

151 
	$ßve_⁄e
(
ßvebuf
 *
f
, 
svÆue
 *
v
)

153 
buf
[20];

155 
v
->
ty≥
) {

156 
T_FLOAT
:

157 ()
	`•rötf
(
buf
,"#%.8e#", 
v
->
u
.
ªÆ
);

158 
	`add_°rbuf
(
f
, 
buf
);

160 
T_NUMBER
:

161 ()
	`•rötf
(
buf
, "%d", 
v
->
u
.
numbî
);

162 
	`add_°rbuf
(
f
, 
buf
);

164 
T_STRING
:

165 
	`ßve_°rög
(
f
, 
v
->
u
.
°rög
);

167 
T_POINTER
:

168 
	`ßve_¨øy
(
f
, 
v
->
u
.
vec
);

170 
T_MAPPING
:

171 
	`ßve_m≠pög
(
f
, 
v
->
u
.
m≠
);

173 
T_OBJECT
:

174 ()
	`•rötf
(
buf
, "$%d@", 
v
->
u
.
ob
->
¸óãd
);

175 
	`add_°rbuf
(
f
, 
buf
);

176 
	`add_°rbuf
(
f
, 
v
->
u
.
ob
->
«me
);

177 
	`add_°rbuf
(
f
, "$");

180 
T_FUNCTION
:

181 
	`add_°rbuf
(
f
, "&FUNCTION&");

185 
	`add_°rbuf
(
f
, "0");

188 
	}
}

195 
	$ßve_obje˘
(
obje˘
 *
ob
, *
fûe
)

197 *
«me
, *
tmp_«me
;

198 
size_t
 
Àn
;

199 
i
, 
j
;

200 
FILE
 *
f
;

201 
Áûed
 = 0;

202 
ßvebuf
 
sbuf
;

205 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

208 
fûe
 = 
	`check_vÆid_∑th
(fûe, 
ob
, "save_object", 1);

209 i‡(
fûe
 == 0)

210 
	`îr‹
("Illegal use of save_object()\n");

212 
Àn
 = 
	`°æí
(
fûe
);

213 
«me
 = 
	`Æloˇ
(
Àn
 + 2 + 1);

214 ()
	`°r˝y
(
«me
, 
fûe
);

215 ()
	`°rˇt
(
«me
, ".o");

220 
tmp_«me
 = 
	`Æloˇ
(
Àn
 + 2 + 4 + 1);

221 ()
	`•rötf
(
tmp_«me
, "%s.tmp", 
«me
);

222 
f
 = 
	`f›í
(
tmp_«me
, "w");

223 i‡(
s_Êag
)

224 
num_fûewrôe
++;

225 i‡(
f
 == 0) {

226 
	`îr‹
("CouldÇŸ o≥¿%†f‹á save.\n", 
tmp_«me
);

228 
Áûed
 = 0;

230 
sbuf
.
size
 = 0;

231 
sbuf
.
max_size
 = 80;

232 
sbuf
.
buf
 = 
	`xÆloc
(80);

233 
j
 = 0; j < ()
ob
->
¥og
->
num_öhîôed
; j++)

235 
¥ogøm
 *
¥og
 = 
ob
->¥og->
öhîô
[
j
].prog;

236 i‡(
ob
->
¥og
->
öhîô
[
j
].
ty≥
 & 
TYPE_MOD_SECOND
 ||

237 
¥og
->
num_v¨übÀs
 == 0)

239 #ifde‡
USE_SWAP


240 
	`ac˚ss_¥ogøm
(
¥og
);

242 
i
 = 0; i < ()
¥og
->
num_v¨übÀs
; i++) {

243 
svÆue
 *
v
 =

244 &
ob
->
v¨übÀs
[
i
 + ob->
¥og
->
öhîô
[
j
].
v¨übÀ_ödex_off£t
];

246 i‡(
ob
->
¥og
->
öhîô
[
j
].¥og->
v¨übÀ_«mes
[
i
].
ty≥
 & 
TYPE_MOD_STATIC
)

248 i‡(
v
->
ty≥
 =
T_NUMBER
 || v->ty≥ =
T_STRING
 || v->ty≥ =
T_POINTER


249 || 
v
->
ty≥
 =
T_MAPPING
 || v->ty≥ =
T_OBJECT
 || v->ty≥ =
T_FLOAT
) {

250 
sbuf
.
size
 = 0;

251 
sbuf
.
buf
[0] = 0;

252 
	`ßve_⁄e
(&
sbuf
, 
v
);

253 
	`F¥ötf
((
f
, "%†%s\n", 
ob
->
¥og
->
öhîô
[
j
].¥og->
v¨übÀ_«mes
[
i
].
«me
, 
sbuf
.
buf
));

258 
	`‰ì
(
sbuf
.
buf
);

259 i‡(
	`f˛o£
(
f
Ë=
EOF
)

260 
Áûed
 = 1;

261 i‡(
Áûed
)

263 ()
	`u∆ök
(
tmp_«me
);

264 
	`îr‹
("FailedÅo saveÅo file. Disk could be full.\n");

266 i‡(
	`ª«me
(
tmp_«me
, 
«me
) == -1)

268 ()
	`u∆ök
(
tmp_«me
);

269 
	`≥º‹
(
«me
);

270 ()
	`¥ötf
("FaûedÅÿlök %†tÿ%s\n", 
tmp_«me
, 
«me
);

271 
	`îr‹
("FailedÅo save object !\n");

273 
	}
}

278 
m≠pög
 *

279 
	$m_ßve_obje˘
(
obje˘
 *
ob
)

281 
i
, 
j
;

282 
m≠pög
 *
ªt
;

283 
svÆue
 
s
 = 
c⁄°0
;

285 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

286  
	`Æloˇã_m≠
(0);

288 
ªt
 = 
	`Æloˇã_m≠
(
ob
->
¥og
->
num_v¨übÀs
 +

289 
ob
->
¥og
->
öhîô
[ob->¥og->
num_öhîôed
 - 1].

290 
v¨übÀ_ödex_off£t
);

292 
j
 = 0; j < ()
ob
->
¥og
->
num_öhîôed
; j++)

294 
¥ogøm
 *
¥og
 = 
ob
->¥og->
öhîô
[
j
].prog;

295 i‡(
ob
->
¥og
->
öhîô
[
j
].
ty≥
 & 
TYPE_MOD_SECOND
 ||

296 
¥og
->
num_v¨übÀs
 == 0)

298 #ifde‡
USE_SWAP


299 
	`ac˚ss_¥ogøm
(
¥og
);

301 
i
 = 0; i < ()
¥og
->
num_v¨übÀs
; i++)

303 
svÆue
 *
v
 =

304 &
ob
->
v¨übÀs
[
i
 + ob->
¥og
->
öhîô
[
j
].

305 
v¨übÀ_ödex_off£t
];

307 i‡(
¥og
->
v¨übÀ_«mes
[
i
].
ty≥
 & 
TYPE_MOD_STATIC
)

309 
	`‰ì_svÆue
(&
s
);

310 
s
.
ty≥
 = 
T_STRING
;

311 
s
.
°rög_ty≥
 = 
STRING_MSTRING
;

312 
s
.
u
.
°rög
 = 
	`make_m°rög
(
¥og
->
v¨übÀ_«mes
[
i
].
«me
);

313 
	`assign_svÆue
(
	`gë_m≠_lvÆue
(
ªt
, &
s
, 1), 
v
);

317 
	`‰ì_svÆue
(&
s
);

318  
ªt
;

319 
	}
}

322 
	$ßve_m≠
(
obje˘
 *
ob
, 
m≠pög
 *
m≠
, *
fûe
)

324 *
«me
, *
tmp_«me
;

325 
≠aú
 *
i
;

326 
size_t
 
Àn
;

327 
j
;

328 
FILE
 *
f
;

329 
ßvebuf
 
sbuf
;

330 
Áûed
 = 0;

334 
fûe
 = 
	`check_vÆid_∑th
(fûe, 
ob
, "save_map", 1);

335 i‡(
fûe
 == 0)

336 
	`îr‹
("Illegal use of save_map()\n");

338 
j
 = 0; j < 
m≠
->
size
; j++)

340 
i
 = 
m≠
->
∑ús
[
j
]; i; i = i->
√xt
) {

341 i‡(
i
->
¨g
.
ty≥
 !
T_STRING
)

342 
	`îr‹
("Non-string index in mapping\n");

343 i‡(
	`°Ωbrk
(
i
->
¨g
.
u
.
°rög
, " \n\r\t\f\v\b"Ë!
NULL
)

344 
	`îr‹
("Mapping index cannot have whitespace\n");

348 
Àn
 = 
	`°æí
(
fûe
);

349 
«me
 = 
	`Æloˇ
(
Àn
 + 2 + 1);

350 ()
	`°r˝y
(
«me
, 
fûe
);

351 ()
	`°rˇt
(
«me
, ".o");

356 
tmp_«me
 = 
	`Æloˇ
(
Àn
 + 2 + 4 + 1);

357 ()
	`•rötf
(
tmp_«me
, "%s.tmp", 
«me
);

358 
f
 = 
	`f›í
(
tmp_«me
, "w");

359 i‡(
s_Êag
)

360 
num_fûewrôe
++;

361 i‡(
f
 == 0) {

362 
	`îr‹
("CouldÇŸ o≥¿%†f‹á save.\n", 
tmp_«me
);

364 
Áûed
 = 0;

366 
sbuf
.
size
 = 0;

367 
sbuf
.
max_size
 = 80;

368 
sbuf
.
buf
 = 
	`xÆloc
(80);

369 
j
 = 0; j < 
m≠
->
size
; j++)

371 
i
 = 
m≠
->
∑ús
[
j
]; i; i = i->
√xt
) {

372 
svÆue
 *
v
 =

373 &
i
->
vÆ
;

375 i‡(
i
->
¨g
.
ty≥
 !
T_STRING
)

377 i‡(
v
->
ty≥
 =
T_NUMBER
 || v->ty≥ =
T_STRING
 || v->ty≥ =
T_POINTER


378 || 
v
->
ty≥
 =
T_MAPPING
 || v->ty≥ =
T_OBJECT
 || v->ty≥ =
T_FLOAT
) {

379 
sbuf
.
size
 = 0;

380 
sbuf
.
buf
[0] = 0;

381 
	`ßve_⁄e
(&
sbuf
, 
v
);

382 
	`F¥ötf
((
f
, "%†%s\n", 
i
->
¨g
.
u
.
°rög
, 
sbuf
.
buf
));

387 
	`‰ì
(
sbuf
.
buf
);

388 i‡(
	`f˛o£
(
f
Ë=
EOF
)

389 
Áûed
 = 1;

390 i‡(
Áûed
)

392 ()
	`u∆ök
(
tmp_«me
);

393 
	`îr‹
("FailedÅo saveÅo file. Disk could be full.\n");

395 i‡(
	`ª«me
(
tmp_«me
, 
«me
) == -1)

397 ()
	`u∆ök
(
tmp_«me
);

398 
	`≥º‹
(
«me
);

399 ()
	`¥ötf
("FaûedÅÿlök %†tÿ%s\n", 
tmp_«me
, 
«me
);

400 
	`îr‹
("FailedÅo save mapping !\n");

402 
	}
}

405 
	$vÆto°r
(
svÆue
 *
svÆ
)

407 
ßvebuf
 
sbuf
;

409 
sbuf
.
buf
 = 
	`xÆloc
(80);

410 
sbuf
.
size
 = 0;

411 
sbuf
.
max_size
 = 80;

412 
sbuf
.
buf
[0] = 0;

413 
	`ßve_⁄e
(&
sbuf
, 
svÆ
);

415  
sbuf
.
buf
;

416 
	}
}

417 
	#BIG
 1000

	)

419 
ª°‹e_⁄e
 (
svÆue
 *, **);

421 
ve˘‹
 *

422 
	$ª°‹e_¨øy
(**
°r
)

424 
svÆue
 *
tmp
;

425 
nmax
 = 
BIG
;

426 
i
, 
k
;

428 
tmp
 = (
svÆue
 *)
	`Æloˇ
(
nmax
 * (svalue));

429 
k
 = 0; k < 
nmax
; k++)

430 
tmp
[
k
] = 
c⁄°0
;

431 
i
 = 0;

434 i‡(**
°r
 == '}')

436 i‡(*++*
°r
 == ')')

438 
ve˘‹
 *
v
;

440 ++*
°r
;

441 
v
 = 
	`Æloˇã_¨øy
(
i
);

442 ()
	`mem˝y
((*)&
v
->
ôem
[0], (*)
tmp
, (
svÆue
Ë* 
i
);

443  
v
;

450 i‡(
i
 >
nmax
)

452 
svÆue
 *
¡mp
;

454 
¡mp
 = (
svÆue
 *)
	`Æloˇ
(
nmax
 * 2 * (svalue));

455 ()
	`mem˝y
((*)
¡mp
, (*)
tmp
, (
svÆue
Ë* 
nmax
);

456 
tmp
 = 
¡mp
;

457 
nmax
 *= 2;

458 
k
 = 
i
; k < 
nmax
; k++)

459 
tmp
[
k
] = 
c⁄°0
;

461 i‡(!
	`ª°‹e_⁄e
(&
tmp
[
i
++], 
°r
))

463 i‡(*(*
°r
)++ != ',')

467 
i
--; i >= 0; i--)

468 
	`‰ì_svÆue
(&(
tmp
[
i
]));

470 
	}
}

472 
m≠pög
 *

473 
	$ª°‹e_m≠pög
(**
°r
)

475 
m≠pög
 *
m
;

477 
m
 = 
	`Æloˇã_m≠
(0);

480 i‡(**
°r
 == ']')

482 i‡(*++*
°r
 == ')')

484 ++*
°r
;

485  
m
;

492 
svÆue
 
¨g
, *
vÆ
;

493 
¨g
 = 
c⁄°0
;

494 i‡(!
	`ª°‹e_⁄e
(&
¨g
, 
°r
))

496 i‡(*(*
°r
)++ != ':')

498 
	`‰ì_svÆue
(&
¨g
);

501 
vÆ
 = 
	`gë_m≠_lvÆue
(
m
, &
¨g
, 1);

502 
	`‰ì_svÆue
(&
¨g
);

504 i‡(!
	`ª°‹e_⁄e
(
vÆ
, 
°r
) ||

505 *(*
°r
)++ != ',')

509 
	`‰ì_m≠pög
(
m
);

511 
	}
}

515 
	$ª°‹e_⁄e
(
svÆue
 *
v
, **
m•
)

517 *
q
, *
p
, *
s
;

519 
s
 = *
m•
;

520 *
s
) {

522 *++
s
)

526 
m≠pög
 *
m≠
;

527 
s
++;

528 
m≠
 = 
	`ª°‹e_m≠pög
(&
s
);

529 i‡(!
m≠
) {

532 
	`‰ì_svÆue
(
v
);

533 
v
->
ty≥
 = 
T_MAPPING
;

534 
v
->
u
.
m≠
 = map;

540 
ve˘‹
 *
vec
;

541 
s
++;

542 
vec
 = 
	`ª°‹e_¨øy
(&
s
);

543 i‡(!
vec
) {

546 
	`‰ì_svÆue
(
v
);

547 
v
->
ty≥
 = 
T_POINTER
;

548 
v
->
u
.
vec
 = vec;

557 
p
 = 
s
+1, 
q
 = s; *p && *p != '"';Ö++)

559 i‡(*
p
 == '\\') {

560 *++
p
) {

562 *
q
++ = '\n';

565 *
q
++ = *
p
;

570 i‡(*
p
 == '\r')

571 *
q
++ = '\n';

573 *
q
++ = *
p
;

576 *
q
 = 0;

577 i‡(*
p
 != '"')

579 
	`‰ì_svÆue
(
v
);

580 
v
->
ty≥
 = 
T_STRING
;

581 
v
->
°rög_ty≥
 = 
STRING_MSTRING
;

582 
v
->
u
.
°rög
 = 
	`make_m°rög
(
s
);

583 
s
 = 
p
+1;

587 
˘
;

588 
obje˘
 *
ob
;

589 
«me
[1024];

590 *
b
 = 
	`°rchr
(
s
 + 1,'$');

592 *
«me
 = '\0';

593 i‡(
b
 =
NULL
)

595 i‡(
	`ssˇnf
(
s
,"$%d@%[^$ \n\t]$",&
˘
,
«me
) != 2)

597 
ob
 = 
	`föd_obje˘2
(
«me
);

598 
	`‰ì_svÆue
(
v
);

599 i‡(
ob
 && ob->
¸óãd
 =
˘
)

601 
v
->
ty≥
 = 
T_OBJECT
;

602 
v
->
u
.
ob
 = ob;

603 
	`add_ªf
(
ob
,"restore_one");

607 
v
->
ty≥
 = 
T_NUMBER
;

608 
v
->
u
.
numbî
 = 0;

610 
s
 = 
b
 + 1;

615 
f
;

616 *
b
 = 
	`°rchr
(
s
 + 1, '#');

617 i‡(
b
 =
NULL
)

619 i‡(
	`ssˇnf
(
s
,"#%f#",&
f
) != 1)

621 
	`‰ì_svÆue
(
v
);

622 
v
->
ty≥
 = 
T_FLOAT
;

623 
v
->
u
.
ªÆ
 = 
f
;

624 
s
 = 
b
 + 1;

628 i‡(!
	`isdigô
(*
s
) && *s != '-')

630 
	`‰ì_svÆue
(
v
);

631 
v
->
ty≥
 = 
T_NUMBER
;

632 
v
->
u
.
numbî
 = 
	`©oi
(
s
);

633 
	`isdigô
(*
s
) || *s == '-')

634 
s
++;

637 *
m•
 = 
s
;

639 
	}
}

642 
	$ª°‹e_obje˘
(
obje˘
 *
ob
, *
fûe
)

644 *
«me
, 
v¨
[100], *
buff
, *
•a˚
;

645 
size_t
 
Àn
;

646 
FILE
 *
f
;

647 
obje˘
 *
ßve
 = 
cuºít_obje˘
;

648 
°©
 
°
;

649 
p
;

651 i‡(
cuºít_obje˘
 !
ob
)

652 
	`Áèl
("BadárgumentÅoÑestore_object()\n");

653 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

656 
fûe
 = 
	`check_vÆid_∑th
(fûe, 
ob
, "restore_object", 0);

657 i‡(
fûe
 == 0)

658 
	`îr‹
("Illegal use ofÑestore_object()\n");

660 
Àn
 = 
	`°æí
(
fûe
);

661 
«me
 = 
	`Æloˇ
(
Àn
 + 3);

662 ()
	`°r˝y
(
«me
, 
fûe
);

663 i‡(
«me
[
Àn
-2] == '.' &&Çame[len-1] == 'c')

664 
«me
[
Àn
-1] = 'o';

666 ()
	`°rˇt
(
«me
, ".o");

667 
f
 = 
	`f›í
(
«me
, "r");

668 i‡(
s_Êag
)

669 
num_fûîód
++;

670 i‡(!
f
 || 
	`f°©
(
	`fûío
(f), &
°
) == -1) {

671 i‡(
f
)

672 ()
	`f˛o£
(
f
);

675 i‡(
°
.
°_size
 == 0) {

676 ()
	`f˛o£
(
f
);

679 
buff
 = 
	`xÆloc
((
size_t
)
°
.
°_size
 + 1);

680 
cuºít_obje˘
 = 
ob
;

683 
svÆue
 *
v
;

685 i‡(
	`fgës
(
buff
, ()
°
.
°_size
 + 1, 
f
) == 0)

688 
•a˚
 = 
	`°rchr
(
buff
, ' ');

689 i‡(
•a˚
 =0 || s∑˚ - 
buff
 > (
v¨
)) {

690 ()
	`f˛o£
(
f
);

691 
	`‰ì
(
buff
);

692 
	`îr‹
("IŒegÆ f‹m© whíÑe°‹ög %s.\n", 
fûe
);

694 ()
	`°∫˝y
(
v¨
, 
buff
, (
size_t
)(
•a˚
 - buff));

695 
v¨
[
•a˚
 - 
buff
] = '\0';

696 
p
 = 
	`föd_°©us
(
ob
->
¥og
, 
v¨
, 
TYPE_MOD_STATIC
);

697 i‡(
p
 == -1)

699 
v
 = &
ob
->
v¨übÀs
[
p
];

700 
•a˚
++;

701 i‡(!
	`ª°‹e_⁄e
(
v
, &
•a˚
)) {

702 ()
	`f˛o£
(
f
);

703 
	`‰ì
(
buff
);

704 
	`îr‹
("IŒegÆ f‹m© whíÑe°‹ög %†‰om %s.\n", 
v¨
, 
fûe
);

707 
cuºít_obje˘
 = 
ßve
;

708 i‡(
d_Êag
 & 
DEBUG_RESTORE
)

709 
	`debug_mesßge
("Obje˘ %†ª°‹ed from %s.\n", 
ob
->
«me
, 
fûe
);

710 
	`‰ì
(
buff
);

711 ()
	`f˛o£
(
f
);

713 
	}
}

715 
	$m_ª°‹e_obje˘
(
obje˘
 *
ob
, 
m≠pög
 *
m≠
)

717 
p
;

718 
i
;

719 
≠aú
 *
j
;

721 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

724 
i
 = 0; i < 
m≠
->
size
; i++)

726 
j
 = 
m≠
->
∑ús
[
i
]; j ; j = j->
√xt
)

728 i‡(
j
->
¨g
.
ty≥
 !
T_STRING
)

731 i‡((
p
 = 
	`föd_°©us
(
ob
->
¥og
, 
j
->
¨g
.
u
.
°rög
, 
TYPE_MOD_STATIC
))

735 
	`assign_svÆue
(&
ob
->
v¨übÀs
[
p
], &
j
->
vÆ
);

740 
	}
}

743 
	$ª°‹e_m≠
(
obje˘
 *
ob
, 
m≠pög
 *
m≠
, *
fûe
)

745 *
«me
, *
buff
, *
•a˚
;

746 
size_t
 
Àn
;

747 
FILE
 *
f
;

748 
obje˘
 *
ßve
 = 
cuºít_obje˘
;

749 
°©
 
°
;

751 i‡(
cuºít_obje˘
 !
ob
)

752 
	`Áèl
("BadárgumentÅoÑestore_map()\n");

753 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

756 
fûe
 = 
	`check_vÆid_∑th
(fûe, 
ob
, "restore_map", 0);

757 i‡(
fûe
 == 0)

758 
	`îr‹
("Illegal use ofÑestore_map()\n");

760 
Àn
 = 
	`°æí
(
fûe
);

761 
«me
 = 
	`Æloˇ
(
Àn
 + 2 + 1);

762 ()
	`°r˝y
(
«me
, 
fûe
);

763 i‡(
«me
[
Àn
-2] == '.' &&Çame[len-1] == 'c')

764 
«me
[
Àn
-1] = 'o';

766 ()
	`°rˇt
(
«me
, ".o");

767 
f
 = 
	`f›í
(
«me
, "r");

768 i‡(
s_Êag
)

769 
num_fûîód
++;

770 i‡(!
f
 || 
	`f°©
(
	`fûío
(f), &
°
) == -1) {

771 i‡(
f
)

772 ()
	`f˛o£
(
f
);

775 i‡(
°
.
°_size
 == 0) {

776 ()
	`f˛o£
(
f
);

779 
buff
 = 
	`xÆloc
((
size_t
)
°
.
°_size
 + 1);

782 
svÆue
 
v
;

784 
v
.
ty≥
 = 
T_STRING
;

785 
v
.
°rög_ty≥
 = 
STRING_MSTRING
;

787 i‡(
	`fgës
(
buff
, ()
°
.
°_size
 + 1, 
f
) == 0)

790 
•a˚
 = 
	`°rchr
(
buff
, ' ');

791 i‡(
•a˚
 == 0) {

792 ()
	`f˛o£
(
f
);

793 
	`‰ì
(
buff
);

794 
	`îr‹
("IŒegÆ f‹m© whíÑe°‹ög %s.\n", 
fûe
);

796 *
•a˚
++ = '\0';

797 
v
.
u
.
°rög
 = 
	`make_m°rög
(
buff
);

799 i‡(!
	`ª°‹e_⁄e
(
	`gë_m≠_lvÆue
(
m≠
,&
v
,1), &
•a˚
)) {

800 ()
	`f˛o£
(
f
);

801 
	`‰ì
(
buff
);

802 
	`îr‹
("IŒegÆ f‹m© whíÑe°‹ög %s.\n", 
fûe
);

804 
	`‰ì_svÆue
(&
v
);

806 
cuºít_obje˘
 = 
ßve
;

807 
	`‰ì
(
buff
);

808 ()
	`f˛o£
(
f
);

809 
	}
}

812 
	$‰ì_obje˘
(
obje˘
 *
ob
, *
‰om
)

814 i‡(
d_Êag
 & 
DEBUG_OB_REF
)

815 ()
	`¥ötf
("SubåÑe‡tÿob %s: %d (%s)\n", 
ob
->
«me
,

816 
ob
->
ªf
, 
‰om
);

817 i‡(!
ob
->
ªf
 || --ob->ref > 0)

819 i‡(!(
ob
->
Êags
 & 
O_DESTRUCTED
))

822 
	`Áèl
("FATAL: Object 0x%lx %sÑef count 0, butÇot destructed (from %s).\n",

823 
ob
, ob->
«me
, 
‰om
);

825 i‡(
ob
->
öãø˘ive
)

826 
	`Áèl
("TriedÅo freeán interactive object.\n");

831 i‡(
ob
->
«me
) {

832 i‡(
	`lookup_obje˘_hash
(
ob
->
«me
) == ob)

833 
	`Áèl
("Fªeög obje˘ %†buà«mê°û»öÇamêèbÀ\n", 
ob
->
«me
);

834 
	`‰ì
(
ob
->
«me
);

835 
ob
->
«me
 = 0;

837 
tŸ_Æloc_obje˘
--;

838 
tŸ_Æloc_de°_obje˘
--;

839 
tŸ_ªmoved_obje˘
++;

840 
	`‰ì
((*)
ob
);

841 
tŸ_Æloc_obje˘_size
 - (
obje˘
);

842 
	}
}

845 
	$add_ªf
(
obje˘
 *
ob
, *
‰om
)

847 
	`INCREF
(
ob
->
ªf
);

848 i‡(
d_Êag
 & 
DEBUG_OB_REF
)

849 ()
	`¥ötf
("AddÑe„ªn˚Åÿobje˘ %s: %d (%s)\n", 
ob
->
«me
,

850 
ob
->
ªf
, 
‰om
);

851 
	}
}

859 
obje˘
 *

860 
	$gë_em±y_obje˘
()

862 
obje˘
 
NULL_obje˘
;

863 
obje˘
 *
ob
;

864 
size
 =  (
obje˘
);

866 
tŸ_Æloc_obje˘
++;

867 
tŸ_Æloc_obje˘_size
 +
size
;

868 
ob
 = (
obje˘
 *)
	`xÆloc
((object));

874 *
ob
 = 
NULL_obje˘
;

875 
ob
->
ªf
 = 1;

876  
ob
;

877 
	}
}

879 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


881 
	$f‹˚_ªmove_obje˘
(
obje˘
 *
ob
)

883 
obje˘
 *
sw≠_ob
;

885 
	`ªmove_obje˘_‰om_°ack
(
ob
);

886 i‡(
ob
 =
sw≠_ob
)

887 
sw≠_ob
 = 
ob
->
¥ev_Æl
;

888 i‡(
ob
 =
obj_li°
)

889 
obj_li°
 = 
ob
->
√xt_Æl
;

890 
ob
->
¥ev_Æl
->
√xt_Æl
 = ob->next_all;

891 
ob
->
√xt_Æl
->
¥ev_Æl
 = ob->prev_all;

892 i‡(
ob
->
√xt_Æl
 == ob)

893 
obj_li°
 = 
sw≠_ob
 = 0;

894 
	`dñëe_Æl_ˇŒs
(
ob
);

895 
	`ªmove_obje˘_hash
(
ob
);

896 
ob
->
√xt_Æl
 = 
obj_li°_de°ru˘
;

897 
ob
->
¥ev_Æl
 = 
NULL
;

898 
obj_li°_de°ru˘
 = 
ob
;

899 
ob
->
Êags
 |
O_DESTRUCTED
;

900 
tŸ_Æloc_de°_obje˘
++;

901 
	}
}

904 
	$ªmove_Æl_obje˘s
()

906 
obje˘
 *
ma°î_ob
, *
vbfc_obje˘
, *
auto_ob
, *
simul_efun_ob
;

907 
gdex˚±i⁄
 
ex˚±i⁄_‰ame
;

908 
obje˘
 *
ob
;

909 
n
;

911 
ex˚±i⁄_‰ame
.
e_ex˚±i⁄
 = 
NULL
;

912 
ex˚±i⁄_‰ame
.
e_ˇtch
 = 0;

915 
ob
 = 
obj_li°
;

916 
n
 = 0;

917 
ob
 =
ma°î_ob
 ||

918 
ob
 =
vbfc_obje˘
 ||

919 
ob
 =
auto_ob
 ||

920 
ob
 =
simul_efun_ob
) {

921 
ob
 = ob->
√xt_Æl
;

922 i‡(
n
++ > 3)

925 i‡(
n
 > 3 || 
ob
 == 0)

927 i‡(
	`£tjmp
(
ex˚±i⁄_‰ame
.
e_c⁄ãxt
))

928 
	`˛ór_°©e
();

930 
ex˚±i⁄
 = &
ex˚±i⁄_‰ame
;

931 #ifde‡
USE_SWAP


932 
	`ac˚ss_obje˘
(
ob
);

933 
	`ac˚ss_¥ogøm
(
ob
->
¥og
);

935 
ob
->
¥og
->
Êags
 &~
PRAGMA_RESIDENT
;

936 
	`de°ru˘_obje˘
(
ob
);

937 
ex˚±i⁄
 = 
NULL
;

944 
	`˛ór_˛osuª_ˇche
();

948 #ifde‡
USE_SWAP


949 
	`ac˚ss_obje˘
(
vbfc_obje˘
);

950 
	`ac˚ss_¥ogøm
(
vbfc_obje˘
->
¥og
);

952 
	`f‹˚_ªmove_obje˘
(
vbfc_obje˘
);

953 
	`‰ì_obje˘
(
vbfc_obje˘
, "remove_all_objects");

954 
vbfc_obje˘
 = 
NULL
;

958 #ifde‡
USE_SWAP


959 
	`ac˚ss_obje˘
(
ma°î_ob
);

960 
	`ac˚ss_¥ogøm
(
ma°î_ob
->
¥og
);

962 
	`f‹˚_ªmove_obje˘
(
ma°î_ob
);

963 
	`‰ì_obje˘
(
ma°î_ob
, "remove_all_objects");

964 
ma°î_ob
 = 
NULL
;

968 #ifde‡
USE_SWAP


969 
	`ac˚ss_obje˘
(
simul_efun_ob
);

970 
	`ac˚ss_¥ogøm
(
simul_efun_ob
->
¥og
);

972 
	`f‹˚_ªmove_obje˘
(
simul_efun_ob
);

973 
	`‰ì_obje˘
(
simul_efun_ob
, "remove_all_objects");

974 
simul_efun_ob
 = 
NULL
;

978 #ifde‡
USE_SWAP


979 
	`ac˚ss_obje˘
(
auto_ob
);

980 
	`ac˚ss_¥ogøm
(
auto_ob
->
¥og
);

982 
	`f‹˚_ªmove_obje˘
(
auto_ob
);

983 
	`‰ì_obje˘
(
auto_ob
, "remove_all_objects");

984 
auto_ob
 = 
NULL
;

985 
	}
}

993 
	$check_ob_ªf
(
obje˘
 *
ob
, *
‰om
)

995 
obje˘
 *
o
;

996 
i
;

998 
o
 = 
obj_li°
, 
i
=0; o; o = o->
√xt_Æl
) {

999 i‡(
o
->
öhîô
 =
ob
)

1000 
i
++;

1002 i‡(
i
+1 > 
ob
->
ªf
) {

1003 
	`Áèl
("FATALÅoo manyÑeferencesÅo inherited object %s (%d) from %s.\n",

1004 
ob
->
«me
, ob->
ªf
, 
‰om
);

1005 i‡(
cuºít_obje˘
)

1006 ()
	`Ârötf
(
°dîr
, "cuºít_obje˘: %s\n", 
cuºít_obje˘
->
«me
);

1007 
o
 = 
obj_li°
; o; o = o->
√xt_Æl
) {

1008 i‡(
o
->
öhîô
 !
ob
)

1010 ()
	`Ârötf
(
°dîr
, " %s\n", 
ob
->
«me
);

1013 
	}
}

1016 
obje˘
 *
	ghashed_livög
[
LIVING_HASH_SIZE
];

1018 
	gnum_livög_«mes
, 
	gnum_£¨ches
 = 1, 
	g£¨ch_Àngth
 = 1;

1020 #i‡
deföed
(
u…rix
Ë&& !deföed(
__GNUC__
)

1021 
	#LivHash
(
s
Ë(
	`hash°r
((s), 100, 
LIVING_HASH_SIZE
))

	)

1023 #i‡
BITNUM
(
LIVING_HASH_SIZE
) == 1

1025 
	#LivHash
(
s
Ë(
	`hash°r16
((s), 100Ë& ((
LIVING_HASH_SIZE
)-1))

	)

1027 
	#LivHash
(
s
Ë(
	`hash°r
((s), 100, 
LIVING_HASH_SIZE
))

	)

1031 
obje˘
 *

1032 
	$föd_livög_obje˘
(*
°r
)

1034 
obje˘
 **
obp
, *
tmp
;

1035 
obje˘
 **
hl
;

1037 
num_£¨ches
++;

1038 
hl
 = &
hashed_livög
[
	`LivHash
(
°r
)];

1039 
obp
 = 
hl
; *obp; ob∞&(*obp)->
√xt_hashed_livög
) {

1040 
£¨ch_Àngth
++;

1041 i‡(!((*
obp
)->
Êags
 & 
O_ENABLE_COMMANDS
))

1043 i‡(
	`°rcmp
((*
obp
)->
livög_«me
, 
°r
) == 0)

1046 i‡(*
obp
 == 0)

1049 i‡(
obp
 =
hl
)

1050  *
obp
;

1051 
tmp
 = *
obp
;

1052 *
obp
 = 
tmp
->
√xt_hashed_livög
;

1053 
tmp
->
√xt_hashed_livög
 = *
hl
;

1054 *
hl
 = 
tmp
;

1055  
tmp
;

1056 
	}
}

1058 
ve˘‹
 *

1059 
	$föd_livög_obje˘s
(*
°r
)

1061 
obje˘
 **
obp
;

1062 
obje˘
 **
hl
;

1063 
ve˘‹
 *
ªt
;

1064 
cou¡
;

1066 
num_£¨ches
++;

1067 
hl
 = &
hashed_livög
[
	`LivHash
(
°r
)];

1068 
cou¡
 = 0, 
obp
 = 
hl
; *obp; ob∞&(*obp)->
√xt_hashed_livög
) {

1069 
£¨ch_Àngth
++;

1070 i‡(!((*
obp
)->
Êags
 & 
O_ENABLE_COMMANDS
))

1072 i‡(
	`°rcmp
((*
obp
)->
livög_«me
, 
°r
) == 0)

1073 
cou¡
++;

1076 
ªt
 = 
	`Æloˇã_¨øy
(
cou¡
);

1078 
cou¡
 = 0, 
obp
 = 
hl
; *obp; ob∞&(*obp)->
√xt_hashed_livög
)

1080 
£¨ch_Àngth
++;

1081 i‡(!((*
obp
)->
Êags
 & 
O_ENABLE_COMMANDS
))

1083 i‡(
	`°rcmp
((*
obp
)->
livög_«me
, 
°r
) == 0)

1085 
ªt
->
ôem
[
cou¡
].
ty≥
 = 
T_OBJECT
;

1086 
ªt
->
ôem
[
cou¡
++].
u
.
ob
 = *
obp
;

1087 
	`add_ªf
(*
obp
, "find_living_objects");

1091  
ªt
;

1092 
	}
}

1095 
	$£t_livög_«me
(
obje˘
 *
ob
, *
°r
)

1097 
obje˘
 **
hl
;

1099 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

1101 i‡(
ob
->
livög_«me
) {

1102 
	`ªmove_livög_«me
(
ob
);

1103 #ifde‡
SUPER_SNOOP


1104 i‡(
ob
->
öãø˘ive
 && ob->öãø˘ive->
¢o›_fd
 >= 0) {

1105 (Ë
	`˛o£
(
ob
->
öãø˘ive
->
¢o›_fd
);

1106 
ob
->
öãø˘ive
->
¢o›_fd
 = -1;

1110 i‡(!*
°r
)

1112 
num_livög_«mes
++;

1113 
hl
 = &
hashed_livög
[
	`LivHash
(
°r
)];

1114 
ob
->
√xt_hashed_livög
 = *
hl
;

1115 *
hl
 = 
ob
;

1116 
ob
->
livög_«me
 = 
	`make_s°rög
(
°r
);

1117 #ifde‡
SUPER_SNOOP


1118 
	`check_su≥r¢o›
(
ob
);

1121 
	}
}

1124 
	$ªmove_livög_«me
(
obje˘
 *
ob
)

1126 
obje˘
 **
hl
;

1128 
num_livög_«mes
--;

1129 i‡(!
ob
->
livög_«me
)

1130 
	`Áèl
("remove_living_name:ÇoÜivingÇame set.\n");

1131 
hl
 = &
hashed_livög
[
	`LivHash
(
ob
->
livög_«me
)];

1132 *
hl
) {

1133 i‡(*
hl
 =
ob
)

1135 
hl
 = &(*hl)->
√xt_hashed_livög
;

1137 i‡(*
hl
 == 0)

1138 
	`Áèl
("remove_living_name: ObjectÇamed %sÇo in hashÜist.\n",

1139 
ob
->
livög_«me
);

1140 *
hl
 = 
ob
->
√xt_hashed_livög
;

1141 
	`‰ì_s°rög
(
ob
->
livög_«me
);

1142 
ob
->
√xt_hashed_livög
 = 0;

1143 
ob
->
livög_«me
 = 0;

1144 
	}
}

1147 
	$°©_livög_obje˘s
()

1149 
tmp
[400];

1151 ()
	`•rötf
(
tmp
,"HashÅable ofÜiving objects:\n-----------------------------\n%dÜivingÇamed objects,áverage searchÜength: %4.2f\n",

1152 
num_livög_«mes
, ()
£¨ch_Àngth
 / 
num_£¨ches
);

1153  
tmp
;

1154 
	}
}

1157 
	$ª„ªn˚_¥og
 (
¥ogøm
 *
¥ogp
, *
‰om
)

1159 
	`INCREF
(
¥ogp
->
ªf
);

1160 i‡(
d_Êag
 & 
DEBUG_PROG_REF
)

1161 ()
	`¥ötf
("reference_prog: %sÑef %d (%s)\n",

1162 
¥ogp
->
«me
,Örogp->
ªf
, 
‰om
);

1163 
	}
}

1165 
¥ogøm
 *
	g¥og_li°
;

1168 
	$ªgi°î_¥ogøm
(
¥ogøm
 *
¥og
)

1170 #ifde‡
USE_SWAP


1171 
¥ogøm
 *
sw≠_¥og
;

1174 i‡(
¥og_li°
)

1176 
¥og
->
√xt_Æl
 = 
¥og_li°
;

1177 
¥og
->
¥ev_Æl
 = 
¥og_li°
->prev_all;

1178 
¥og_li°
->
¥ev_Æl
->
√xt_Æl
 = 
¥og
;

1179 
¥og_li°
->
¥ev_Æl
 = 
¥og
;

1180 
¥og_li°
 = 
¥og
;

1183 #ifde‡
USE_SWAP


1184 
sw≠_¥og
 =

1186 
¥og_li°
 = 
¥og
->
√xt_Æl
 =Örog->
¥ev_Æl
 =Örog;

1188 #ifde‡
USE_SWAP


1189 i‡(
cuºít_¥og
)

1190 
	`ac˚ss_¥ogøm
(
cuºít_¥og
);

1192 
	}
}

1202 
	$‰ì_¥og
(
¥ogøm
 *
¥ogp
)

1204 
tŸÆ_¥ogøm_size
;

1205 #ifde‡
USE_SWAP


1206 
¥ogøm
 *
sw≠_¥og
;

1208 
i
;

1210 i‡(
d_Êag
 & 
DEBUG_PROG_REF
)

1211 ()
	`¥ötf
("‰ì_¥og: %s\n", 
¥ogp
->
«me
);

1212 i‡(!
¥ogp
->
ªf
 || --progp->ref > 0)

1214 i‡(
¥ogp
->
ªf
 < 0)

1215 
	`Áèl
("NegativeÑef count forÖrogÑef.\n");

1217 #ifde‡
USE_SWAP


1218 i‡(
¥ogp
 =
sw≠_¥og
)

1219 
sw≠_¥og
 = 
¥ogp
->
¥ev_Æl
;

1221 i‡(
¥ogp
 =
¥og_li°
)

1222 
¥og_li°
 = 
¥ogp
->
√xt_Æl
;

1224 
¥ogp
->
¥ev_Æl
->
√xt_Æl
 =Örogp->next_all;

1225 
¥ogp
->
√xt_Æl
->
¥ev_Æl
 =Örogp->prev_all;

1226 i‡(
¥ogp
->
√xt_Æl
 ==Örogp)

1228 #ifde‡
USE_SWAP


1229 
sw≠_¥og
 = 0;

1231 
¥og_li°
 = 0;

1234 #ifde‡
USE_SWAP


1235 
	`ªmove_¥og_‰om_sw≠
(
¥ogp
);

1238 
tŸÆ_¥ogøm_size
 -
¥ogp
->
exec_size
;

1240 
tŸÆ_¥og_block_size
 -
¥ogp
->
tŸÆ_size
;

1241 
tŸÆ_num_¥og_blocks
--;

1244 
i
=0; i < ()
¥ogp
->
num_fun˘i⁄s
; i++)

1245 i‡(
¥ogp
->
fun˘i⁄s
[
i
].
«me
)

1246 
	`‰ì_s°rög
(
¥ogp
->
fun˘i⁄s
[
i
].
«me
);

1249 
i
=0; i < ()
¥ogp
->
num_v¨übÀs
; i++)

1250 
	`‰ì_s°rög
(
¥ogp
->
v¨übÀ_«mes
[
i
].
«me
);

1253 
i
=0; i < ()
¥ogp
->
num_öhîôed
 - 1; i++)

1255 
	`‰ì_¥og
(
¥ogp
->
öhîô
[
i
].
¥og
);

1256 
	`‰ì_s°rög
(
¥ogp
->
öhîô
[
i
].
«me
);

1258 
	`‰ì_s°rög
(
¥ogp
->
öhîô
[
i
].
«me
);

1259 
	`‰ì
(
¥ogp
->
«me
);

1260 
	`‰ì
((*)
¥ogp
->
¥ogøm
);

1261 i‡(
¥ogp
->
löe_numbîs
 != 0)

1262 
	`‰ì
((*)
¥ogp
->
löe_numbîs
);

1263 
	`‰ì
((*)
¥ogp
);

1264 
	}
}

1267 
	$¸óã_obje˘
(
obje˘
 *
ob
)

1269 
cuºít_time
;

1270 
i
;

1272 i‡(!(
ob
->
Êags
 & 
O_CREATED
))

1274 
ob
->
Êags
 |
O_CREATED
;

1275 
ob
->
¸óãd
 = 
cuºít_time
;

1276 
i
 = 0; i < ()
ob
->
¥og
->
num_öhîôed
; i++)

1277 i‡(!(
ob
->
¥og
->
öhîô
[
i
].
ty≥
 & 
TYPE_MOD_SECOND
))

1279 i‡(
ob
->
¥og
->
öhîô
[
i
].¥og->
˘‹_ödex
 !=

1282 
	`ˇŒ_fun˘i⁄
(
ob
, 
i
,

1283 ()
ob
->
¥og
->
öhîô
[
i
].¥og->
˘‹_ödex
, 0);

1284 
	`p›_°ack
();

1287 i‡(
	`£¨ch_f‹_fun˘i⁄
("¸óã", 
ob
->
¥og
))

1289 
	`ˇŒ_fun˘i⁄
(
ob
, 
fun˘i⁄_öhîô_found
,

1290 ()
fun˘i⁄_ödex_found
, 0);

1291 
	`p›_°ack
();

1294 
	}
}

1296 
	$ª¸óã_obje˘
(
obje˘
 *
ob
, obje˘ *
ﬁd_ob
)

1298 
cuºít_time
;

1299 
i
;

1300 i‡(!(
ob
->
Êags
 & 
O_CREATED
))

1302 
ob
->
Êags
 |
O_CREATED
;

1303 i‡(!
ob
->
¸óãd
)

1304 
ob
->
¸óãd
 = 
cuºít_time
;

1305 
i
 = 0; i < ()
ob
->
¥og
->
num_öhîôed
; i++)

1306 i‡(!(
ob
->
¥og
->
öhîô
[
i
].
ty≥
 & 
TYPE_MOD_SECOND
))

1308 i‡(
ob
->
¥og
->
öhîô
[
i
].¥og->
˘‹_ödex
 !=

1311 
	`ˇŒ_fun˘i⁄
(
ob
, 
i
,

1312 ()
ob
->
¥og
->
öhîô
[
i
].¥og->
˘‹_ödex
, 0);

1313 
	`p›_°ack
();

1317 i‡(
	`£¨ch_f‹_fun˘i⁄
("ª¸óã", 
ob
->
¥og
))

1319 
	`push_obje˘
(
ﬁd_ob
);

1320 
	`ˇŒ_fun˘i⁄
(
ob
, 
fun˘i⁄_öhîô_found
,

1321 ()
fun˘i⁄_ödex_found
, 1);

1322 
	`p›_°ack
();

1324 
	}
}

1330 
ve˘‹
 *

1331 
	$öhîô_li°
(
obje˘
 *
ob
)

1333 
ve˘‹
 *
ªt
;

1334 
öh
;

1336 
ªt
 = 
	`Æloˇã_¨øy
(
ob
->
¥og
->
num_öhîôed
);

1338 
öh
 = 0; inh < ()
ob
->
¥og
->
num_öhîôed
; inh++ )

1340 
ªt
->
ôem
[
öh
].
ty≥
 = 
T_STRING
;

1341 
ªt
->
ôem
[
öh
].
°rög_ty≥
 = 
STRING_MSTRING
;

1342 
ªt
->
ôem
[
öh
].
u
.
°rög
 = 
	`add_¶ash
(
ob
->
¥og
->
öhîô
[öh].¥og->
«me
);

1344  
ªt
;

1345 
	}
}

1348 
	$ch™ge_ªf
(
obje˘
 *
to
, obje˘ *
‰om
, *
msg
)

1350 i‡(
‰om
)

1351 
	`add_ªf
(
‰om
, 
msg
);

1352 i‡(
to
)

1353 
	`‰ì_obje˘
(
to
, 
msg
);

1354 
	}
}

1357 
	$w¨nobsﬁëe
(
obje˘
 *
ob
, *
msg
)

1359 
w¨nobsﬁëeÊag
;

1361 
ob
->
Êags
 |
O_OBSOLETE_WARNING
;

1362 i‡(!
w¨nobsﬁëeÊag
)

1364 ()
	`Ârötf
(
°dîr
, "OBSOLETE: %s: %s\n", 
ob
->
«me
, 
msg
);

1365 
	}
}

	@object.h

11 
	~"c⁄fig.h
"

13 #ifde‡
DO_CLEANUP


14 
	#O_WILL_CLEAN_UP
 0x01

	)

16 
	#O_CREATED
 0x02

	)

17 
	#O_ENABLE_COMMANDS
 0x04

	)

18 
	#O_CLONE
 0x08

	)

19 
	#O_DESTRUCTED
 0x10

	)

20 
	#O_SWAPPED
 0x20

	)

21 
	#O_ONCE_INTERACTIVE
 0x40

	)

22 
	#O_OBSOLETE_WARNING
 0x80

	)

24 
	gˇŒ
;

26 
	sobje˘
 {

27 
	mÊags
;

28 
	mdebug_Êags
;

29 
	m¸óãd
;

30 
	mtime_of_ªf
;

31 
	mªf
;

32 #ifde‡
DEBUG


33 
	mexåa_ªf
;

35 
	msw≠_num
;

36 
¥ogøm
 *
	m¥og
;

37 *
	m«me
;

38 
ˇŒ
 *
	mˇŒ_outs
;

39 
obje˘
 *
	m√xt_ˇŒ_out
;

40 
obje˘
 *
	m√xt_Æl
, *
	m¥ev_Æl
, *
	m√xt_öv
, *
	m√xt_hash
;

41 
obje˘
 *
	mc⁄èös
;

42 
obje˘
 *
	msu≥r
;

43 
obje˘
 *
	mshadowög
;

44 
obje˘
 *
	mshadowed
;

45 
öãø˘ive
 *
	möãø˘ive
;

46 
£¡í˚
 *
	m£¡
;

47 
obje˘
 *
	m√xt_hashed_livög
;

48 *
	mlivög_«me
;

49 
svÆue
 *
	mv¨übÀs
;

52 
	#WARNOBSOLETE
(
ob
, 
msg
Ëi‡(((ob)->
Êags
 & 
O_OBSOLETE_WARNING
) == 0) \

53 
	`w¨nobsﬁëe
(
ob
, 
msg
)

	)

55 
w¨nobsﬁëe
(
obje˘
 *
ob
, *
msg
);

57 
obje˘
 *
lﬂd_obje˘
 (*, , object *, );

58 
obje˘
 *
föd_obje˘
 (*);

59 
obje˘
 *
gë_em±y_obje˘
();

60 
obje˘
 *
föd_obje˘
 (*);

61 
obje˘
 *
föd_obje˘2
 (*);

63 
obje˘
 *
cuºít_obje˘
;

64 
obje˘
 *
comm™d_givî
;

65 
obje˘
 *
obj_li°
;

66 
obje˘
 *
obj_li°_de°ru˘
;

68 
	gvÆue
;

69 
ªmove_de°ru˘ed_obje˘s
();

70 
ßve_obje˘
 (
obje˘
 *, *);

71 
move_obje˘
 (
obje˘
 *);

72 
add_ªf
 (
obje˘
 *, *);

73 
ch™ge_ªf
 (
obje˘
 *, object *, *);

74 
‰ì_obje˘
 (
obje˘
 *, *);

75 
ª„ªn˚_¥og
 (
¥ogøm
 *, *);

76 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


77 
ªmove_Æl_obje˘s
();

80 
	gm≠pög
;

81 
ª°‹e_obje˘
 (
obje˘
 *, *);

82 
ßve_m≠
(
obje˘
 *, 
m≠pög
 *, *);

83 
ª°‹e_⁄e
(
svÆue
 *, **);

84 
ª°‹e_m≠
(
obje˘
 *, 
m≠pög
 *, *);

85 
¸óã_obje˘
(
obje˘
 *);

86 
ª¸óã_obje˘
(
obje˘
 *, object *);

	@otable.c

1 
	~<°dio.h
>

2 
	~<°rög.h
>

4 
	~"c⁄fig.h
"

5 
	~"löt.h
"

6 
	~"öãΩªt.h
"

7 
	~"obje˘.h
"

8 
	~"hash.h
"

9 
	~"simuœã.h
"

28 
	gobje˘
 *(
	gobj_èbÀ
[
OTABLE_SIZE
]);

35 #i‡
deföed
(
u…rix
Ë&& !deföed(
__GNUC__
)

36 
	#ObjHash
(
s
Ë(
	`hash°r
((s), 100, 
OTABLE_SIZE
))

	)

38 #i‡
BITNUM
(
OTABLE_SIZE
) == 1

40 
	#ObjHash
(
s
Ë(
	`hash°r16
((s), 100Ë& ((
OTABLE_SIZE
)-1))

	)

42 
	#ObjHash
(
s
Ë(
	`hash°r
((s), 100, 
OTABLE_SIZE
))

	)

50 
	gobj_£¨ches
 = 0, 
	gobj_¥obes
 = 0, 
	gobjs_found
 = 0;

52 
obje˘
 *

53 
	$föd_obj_n
(*
s
)

55 
obje˘
 * 
cuº
, *
¥ev
;

57 
h
 = 
	`ObjHash
(
s
);

59 
cuº
 = 
obj_èbÀ
[
h
];

60 
¥ev
 = 0;

62 
obj_£¨ches
++;

64 
cuº
)

66 
obj_¥obes
++;

67 i‡(
	`°rcmp
(
cuº
->
«me
, 
s
) == 0) {

68 i‡(
¥ev
)

70 
¥ev
->
√xt_hash
 = 
cuº
->next_hash;

71 
cuº
->
√xt_hash
 = 
obj_èbÀ
[
h
];

72 
obj_èbÀ
[
h
] = 
cuº
;

74 
objs_found
++;

75 (
cuº
);

77 
¥ev
 = 
cuº
;

78 
cuº
 = cuº->
√xt_hash
;

82 
	}
}

88 
	gobjs_ö_èbÀ
 = 0;

91 
	$íãr_obje˘_hash
(
obje˘
 *
ob
)

93 
obje˘
 * 
s
;

94 
h
 = 
	`ObjHash
(
ob
->
«me
);

96 
s
 = 
	`föd_obj_n
(
ob
->
«me
);

97 i‡(
s
) {

98 i‡(
s
 !
ob
)

99 
	`Áèl
("Duplicate object \"%s\" in object hashÅable\n",

100 
ob
->
«me
);

102 
	`Áèl
("Entering object \"%s\"Åwice in objectÅable\n",

103 
ob
->
«me
);

105 i‡(
ob
->
√xt_hash
)

106 
	`Áèl
("Object \"%s\"Çot found in objectÅable butÇextÜinkÇotÇull\n",

107 
ob
->
«me
);

108 
ob
->
√xt_hash
 = 
obj_èbÀ
[
h
];

109 
obj_èbÀ
[
h
] = 
ob
;

110 
objs_ö_èbÀ
++;

112 
	}
}

120 
	$ªmove_obje˘_hash
(
obje˘
 *
ob
)

122 
obje˘
 * 
s
;

123 
h
 = 
	`ObjHash
(
ob
->
«me
);

125 
s
 = 
	`föd_obj_n
(
ob
->
«me
);

127 i‡(
s
 !
ob
)

128 
	`Áèl
("Remove object \"%s\": foundá different object!\n",

129 
ob
->
«me
);

131 
obj_èbÀ
[
h
] = 
ob
->
√xt_hash
;

132 
ob
->
√xt_hash
 = 0;

133 
objs_ö_èbÀ
--;

135 
	}
}

143 
	gu£r_obj_lookups
 = 0, 
	gu£r_obj_found
 = 0;

145 
obje˘
 *

146 
	$lookup_obje˘_hash
(*
s
)

148 
obje˘
 * 
ob
 = 
	`föd_obj_n
(
s
);

149 
u£r_obj_lookups
++;

150 i‡(
ob
Ë
u£r_obj_found
++;

151 (
ob
);

152 
	}
}

159 
	$add_ŸabÀ_°©us
(*
deböf
)

161 ()
	`°rˇt
(
deböf
, "\nObjectÇame hashÅable status:\n");

162 ()
	`°rˇt
(
deböf
, "------------------------------\n");

163 ()
	`•rötf
(
deböf
 + 
	`°æí
(debinf), "Average hash chainÜength %.2f\n",

164 ()
objs_ö_èbÀ
 / 
OTABLE_SIZE
);

165 ()
	`•rötf
(
deböf
 + 
	`°æí
(debinf), "Searches/average searchÜength %d (%.2f)\n",

166 
obj_£¨ches
, ()
obj_¥obes
 / obj_searches);

167 ()
	`•rötf
(
deböf
 + 
	`°æí
(debinf), "ExternalÜookups succeeded (succeed) %d (%d)\n",

168 
u£r_obj_lookups
, 
u£r_obj_found
);

169 
	}
}

171 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


173 
	$˛ór_ŸabÀ
()

175 
i
;

177 
i
 = 0; i < 
OTABLE_SIZE
; i++)

178 
obj_èbÀ
[
i
] = 
NULL
;

179 
	}
}

	@parse.c

15 
	~<°dio.h
>

16 
	~<°dlib.h
>

17 
	~<°rög.h
>

18 
	~<˘y≥.h
>

19 
	~<time.h
>

20 #i‡
deföed
(
sun
Ë|| deföed(
__osf__
)

21 
	~<Æloˇ.h
>

24 
	~"c⁄fig.h
"

25 
	~"löt.h
"

26 
	~"m°rög.h
"

27 
	~"öãΩªt.h
"

28 
	~"obje˘.h
"

29 
	~"exec.h
"

30 
	~"simuœã.h
"

31 
	~"m≠pög.h
"

33 
	~"ölöe_svÆue.h
"

35 
d_Êag
;

36 
obje˘
 *
¥evious_ob
;

37 
obje˘
 *
	gvbfc_obje˘
;

38 
	g¥zyp
;

40 #i‚de‡
tﬁowî


41 
tﬁowî
 ();

46 
	#EQ
(
x
,
y
Ë(
	`°rcmp
(x,y)==0)

	)

50 
	#QGET_ID
 "∑r£_comm™d_id_li°"

	)

51 
	#QGET_RODZAJ
 "∑r£_comm™d_rodzaj_id_li°"

	)

52 
	#M_QGET_ID
 
M_PARSE_COMMAND_ID_LIST


	)

53 
	#M_QGET_RODZ
 
M_PARSE_COMMAND_RODZ_LIST


	)

56 
	#QGET_PLURID
 "∑r£_comm™d_∂uøl_id_li°"

	)

57 
	#QGET_PRODZAJ
 "∑r£_comm™d_∂uøl_rodzaj_id_li°"

	)

58 
	#M_QGET_PLURID
 
M_PARSE_COMMAND_PLURAL_ID_LIST


	)

59 
	#M_QGET_PRODZ
 
M_PARSE_COMMAND_PRODZ_LIST


	)

62 
	#QGET_ADJID1
 "∑r£_comm™d_adje˘iv1_id_li°"

	)

63 
	#QGET_ADJID2
 "∑r£_comm™d_adje˘iv2_id_li°"

	)

65 
	#QGET_ZAIMKA
 "∑r£_comm™d_obõkty_zaimka"

	)

66 
	#QGET_RODZAJ_NAZWY
 "quîy_rodzaj_«zwy"

	)

67 
	#QSET_RODZAJ
 "∑r£_comm™d_£t_rodzaj"

	)

68 
	#QGET_BIT_ZAIMKOW
 "∑r£_comm™d_bô_zaimkow"

	)

76 
ve˘‹
 *
	ggId_li°
 = 0;

77 
ve˘‹
 *
	ggPluid_li°
 = 0;

78 
ve˘‹
 *
	ggRodz_li°
 = 0;

79 
ve˘‹
 *
	ggProdz_li°
 = 0;

80 
ve˘‹
 *
	ggAdj1id_li°
 = 0;

81 
ve˘‹
 *
	ggAdj2id_li°
 = 0;

83 
ve˘‹
 *
	ggId_li°_d
 = 0;

84 
ve˘‹
 *
	ggRodz_li°_d
 = 0;

85 
ve˘‹
 *
	ggPluid_li°_d
 = 0;

86 
ve˘‹
 *
	ggProdz_li°_d
 = 0;

92 
	$lﬂd_∑r£_öf‹m©i⁄
()

94 
svÆue
 *
pvÆ
;

96 
	`‰ì_∑r£_öf‹m©i⁄
();

100 
pvÆ
 = 
	`≠∂y_ma°î_ob
(
M_QGET_ID
, 0);

101 i‡(
pvÆ
 &&ÖvÆ->
ty≥
 =
T_POINTER
)

103 
gId_li°_d
 = 
pvÆ
->
u
.
vec
;

104 
	`INCREF
(
pvÆ
->
u
.
vec
->
ªf
);

107 
gId_li°_d
 = 0;

109 
pvÆ
 = 
	`≠∂y_ma°î_ob
(
M_QGET_RODZ
, 0);

110 i‡(
pvÆ
 &&ÖvÆ->
ty≥
 =
T_POINTER
)

112 
gRodz_li°_d
 = 
pvÆ
->
u
.
vec
;

113 
	`INCREF
(
pvÆ
->
u
.
vec
->
ªf
);

116 
gRodz_li°_d
 = 0;

118 
pvÆ
 = 
	`≠∂y_ma°î_ob
(
M_QGET_PLURID
,0);

119 i‡(
pvÆ
 &&ÖvÆ->
ty≥
 =
T_POINTER
)

121 
gPluid_li°_d
 = 
pvÆ
->
u
.
vec
;

122 
	`INCREF
(
pvÆ
->
u
.
vec
->
ªf
);

125 
gPluid_li°_d
 = 0;

127 
pvÆ
 = 
	`≠∂y_ma°î_ob
(
M_QGET_PRODZ
,0);

128 i‡(
pvÆ
 &&ÖvÆ->
ty≥
 =
T_POINTER
)

130 
gProdz_li°_d
 = 
pvÆ
->
u
.
vec
;

131 
	`INCREF
(
pvÆ
->
u
.
vec
->
ªf
);

134 
gProdz_li°_d
 = 0;

135 
	}
}

148 
	$lﬂd_Õc_öfo
(
ix
, 
obje˘
 *
ob
)

150 
ve˘‹
 *
tmp
, *
sög
;

151 
svÆue
 
svÆ
, *
ªt
;

152 
û
, 
make_∂uøl
 = 0;

153 *
°r
;

154 *
	`∑r£_to_∂uøl
(*);

156 i‡(!
ob
)

164 i‡(
gPluid_li°
 &&

165 
gPluid_li°
->
size
 > 
ix
 &&

166 (
gPluid_li°
->
ôem
[
ix
].
ty≥
 !
T_NUMBER
 ||

167 
gPluid_li°
->
ôem
[
ix
].
u
.
numbî
 == 0)

170 
	`push_numbî
(
¥zyp
);

171 
ªt
 = 
	`≠∂y
(
QGET_PLURID
, 
ob
, 1, 1);

172 i‡(
ªt
 &&Ñë->
ty≥
 =
T_POINTER
)

173 
	`assign_svÆue_no_‰ì
(&
gPluid_li°
->
ôem
[
ix
], 
ªt
);

176 
make_∂uøl
 = 1;

177 
gPluid_li°
->
ôem
[
ix
].
u
.
numbî
 = 1;

181 i‡(
gId_li°
 &&

182 
gId_li°
->
size
 > 
ix
 &&

183 (
gId_li°
->
ôem
[
ix
].
ty≥
 !
T_NUMBER
 ||

184 
gId_li°
->
ôem
[
ix
].
u
.
numbî
 == 0))

186 
	`push_numbî
(
¥zyp
);

187 
ªt
 = 
	`≠∂y
(
QGET_ID
, 
ob
, 1, 1);

188 i‡(
ªt
 &&Ñë->
ty≥
 =
T_POINTER
)

190 
	`assign_svÆue_no_‰ì
(&
gId_li°
->
ôem
[
ix
], 
ªt
);

191 i‡(
make_∂uøl
)

193 
tmp
 = 
	`Æloˇã_¨øy
(
ªt
->
u
.
vec
->
size
);

194 
sög
 = 
ªt
->
u
.
vec
;

196 
svÆ
.
ty≥
 = 
T_STRING
;

197 
svÆ
.
°rög_ty≥
 = 
STRING_MSTRING
;

198 
û
 = 0; i»< 
tmp
->
size
; il++)

200 i‡(
sög
->
ôem
[
û
].
ty≥
 =
T_STRING
)

202 
°r
 = 
	`∑r£_to_∂uøl
(
sög
->
ôem
[
û
].
u
.
°rög
);

203 
svÆ
.
u
.
°rög
 = 
°r
;

204 
	`assign_svÆue_no_‰ì
(&
tmp
->
ôem
[
û
],&
svÆ
);

205 
	`‰ì_m°rög
(
svÆ
.
u
.
°rög
);

208 
svÆ
.
ty≥
 = 
T_POINTER
;

209 
svÆ
.
u
.
vec
 = 
tmp
;

210 
	`assign_svÆue_no_‰ì
(&
gPluid_li°
->
ôem
[
ix
], &
svÆ
);

211 
	`‰ì_svÆue
(&
svÆ
);

216 
gId_li°
->
ôem
[
ix
].
u
.
numbî
 = 1;

220 i‡(
gRodz_li°
 &&

221 
gRodz_li°
->
size
 > 
ix
 &&

222 (
gRodz_li°
->
ôem
[
ix
].
ty≥
 !
T_NUMBER
 ||

223 
gRodz_li°
->
ôem
[
ix
].
u
.
numbî
 == 0))

225 
	`push_numbî
(
¥zyp
);

226 
ªt
 = 
	`≠∂y
(
QGET_RODZAJ
, 
ob
, 1, 1);

227 i‡(
ªt
 &&Ñë->
ty≥
 =
T_POINTER
)

228 
	`assign_svÆue_no_‰ì
(&
gRodz_li°
->
ôem
[
ix
], 
ªt
);

230 
gRodz_li°
->
ôem
[
ix
].
u
.
numbî
 = 1;

233 i‡(
gProdz_li°
 &&

234 
gProdz_li°
->
size
 > 
ix
 &&

235 (
gProdz_li°
->
ôem
[
ix
].
ty≥
 !
T_NUMBER
 ||

236 
gProdz_li°
->
ôem
[
ix
].
u
.
numbî
 == 0))

238 
	`push_numbî
(
¥zyp
);

239 
ªt
 = 
	`≠∂y
(
QGET_PRODZAJ
, 
ob
, 1, 1);

240 i‡(
ªt
 &&Ñë->
ty≥
 =
T_POINTER
)

241 
	`assign_svÆue_no_‰ì
(&
gProdz_li°
->
ôem
[
ix
], 
ªt
);

243 
gProdz_li°
->
ôem
[
ix
].
u
.
numbî
 = 1;

246 i‡(
gAdj1id_li°
 &&

247 
gAdj1id_li°
->
size
 > 
ix
 &&

248 (
gAdj1id_li°
->
ôem
[
ix
].
ty≥
 !
T_NUMBER
 ||

249 
gAdj1id_li°
->
ôem
[
ix
].
u
.
numbî
 == 0))

251 
ªt
 = 
	`≠∂y
(
QGET_ADJID1
, 
ob
, 0, 1);

252 i‡(
ªt
 &&Ñë->
ty≥
 =
T_POINTER
)

253 
	`assign_svÆue_no_‰ì
(&
gAdj1id_li°
->
ôem
[
ix
], 
ªt
);

255 
gAdj1id_li°
->
ôem
[
ix
].
u
.
numbî
 = 1;

258 i‡(
gAdj2id_li°
 &&

259 
gAdj2id_li°
->
size
 > 
ix
 &&

260 (
gAdj2id_li°
->
ôem
[
ix
].
ty≥
 !
T_NUMBER
 ||

261 
gAdj2id_li°
->
ôem
[
ix
].
u
.
numbî
 == 0))

263 
ªt
 = 
	`≠∂y
(
QGET_ADJID2
, 
ob
, 0, 1);

264 i‡(
ªt
 &&Ñë->
ty≥
 =
T_POINTER
)

265 
	`assign_svÆue_no_‰ì
(&
gAdj2id_li°
->
ôem
[
ix
], 
ªt
);

267 
gAdj2id_li°
->
ôem
[
ix
].
u
.
numbî
 = 1;

269 
	}
}

272 
	$‰ì_∑r£_öf‹m©i⁄
()

274 i‡(
gId_li°_d
)

275 
	`‰ì_ve˘‹
(
gId_li°_d
);

276 i‡(
gPluid_li°_d
)

277 
	`‰ì_ve˘‹
(
gPluid_li°_d
);

278 i‡(
gRodz_li°_d
)

279 
	`‰ì_ve˘‹
(
gRodz_li°_d
);

280 i‡(
gProdz_li°_d
)

281 
	`‰ì_ve˘‹
(
gProdz_li°_d
);

282 
	}
}

304 
	$∑r£
 (*
cmd
, 
svÆue
 *
ob_‹_¨øy
, *
∑âîn
,

305 
svÆue
 *
°ack_¨gs
, 
num_¨g
)

314 
ve˘‹
 *
obvec
, *
∑tvec
, *
wvec
;

315 
ve˘‹
 *
ﬁd_id
, *
ﬁd_∂id
, *
ﬁd_adj1id
, *
ﬁd_adj2id
,

316 *
ﬁd_rodz
, *
ﬁd_¥odz
;

317 
pix
, 
cix
, 
six
, 
Áû
, 
fw‹d
, 
ocix
, 
Âix
;

318 
svÆue
 *
pvÆ
;

319 
	`check_f‹_de°r
(
svÆue
 *);

320 
svÆue
 *
	`sub_∑r£
(
ve˘‹
 *, vector *, *, vector *, *, *);

321 
svÆue
 *
	`¶i˚_w‹ds
(
ve˘‹
 *, , ), 
tmp
;

322 
	`°ack_put
(
svÆue
 *, svalue *, , );

323 
ve˘‹
 *
	`dìp_övít‹y
(
obje˘
 *, );

328 i‡(*
cmd
 ='\0' || *
∑âîn
 == '\0')

331 
wvec
 = 
	`ex∂ode_°rög
(
cmd
," ");

332 
∑tvec
 = 
	`ex∂ode_°rög
(
∑âîn
," ");

337 i‡(!
wvec
)

338 
wvec
 = 
	`Æloˇã_¨øy
(0);

339 i‡(!
∑tvec
)

340 
∑tvec
 = 
	`Æloˇã_¨øy
(0);

342 
	`INCREF
(
wvec
->
ªf
);

343 
	`INCREF
(
∑tvec
->
ªf
);

345 i‡(
ob_‹_¨øy
->
ty≥
 =
T_POINTER
)

346 
obvec
 = 
ob_‹_¨øy
->
u
.
vec
;

347 i‡(
ob_‹_¨øy
->
ty≥
 =
T_OBJECT
)

348 
obvec
 = 
	`dìp_övít‹y
(
ob_‹_¨øy
->
u
.
ob
, 1);

351 
obvec
 = 0;

352 
	`îr‹
("Bad secondárgumentÅoÖarse_command()\n");

355 
tmp
.
ty≥
 = 
T_POINTER
;

356 
tmp
.
u
.
vec
 = 
obvec
;

357 
	`check_f‹_de°r
(&
tmp
);

359 
	`INCREF
(
obvec
->
ªf
);

363 
ﬁd_id
 = 
gId_li°
;

364 
ﬁd_∂id
 = 
gPluid_li°
;

365 
ﬁd_rodz
 = 
gRodz_li°
;

366 
ﬁd_¥odz
 = 
gProdz_li°
;

367 
ﬁd_adj1id
 = 
gAdj1id_li°
;

368 
ﬁd_adj2id
 = 
gAdj2id_li°
;

370 
gId_li°
 = 
	`Æloˇã_¨øy
(
obvec
->
size
);

371 
gPluid_li°
 = 
	`Æloˇã_¨øy
(
obvec
->
size
);

372 
gRodz_li°
 = 
	`Æloˇã_¨øy
(
obvec
->
size
);

373 
gProdz_li°
 = 
	`Æloˇã_¨øy
(
obvec
->
size
);

374 
gAdj1id_li°
 = 
	`Æloˇã_¨øy
(
obvec
->
size
);

375 
gAdj2id_li°
 = 
	`Æloˇã_¨øy
(
obvec
->
size
);

379 
pix
 = 0;

380 #i‚de‡
OLD_EXPLODE


381 
pix
 < 
∑tvec
->
size
 && !*’©vec->
ôem
[pix].
u
.
°rög
))

382 
pix
++;

385 
six
 = 0;

386 
cix
 = 0;

387 
Áû
 = 0;

388 ; 
pix
 < 
∑tvec
->
size
;Öix++)

390 
pvÆ
 = 0;

391 
Áû
 = 0;

393 i‡(
	`EQ
(
∑tvec
->
ôem
[
pix
].
u
.
°rög
, "%s"))

398 i‡(
pix
 =(
∑tvec
->
size
-1))

400 
pvÆ
 = 
	`¶i˚_w‹ds
(
wvec
, 
cix
, wvec->
size
 - 1);

401 
cix
 = 
wvec
->
size
;

402 
	`°ack_put
(
pvÆ
, 
°ack_¨gs
, 
six
++, 
num_¨g
);

411 
ocix
 = 
fw‹d
 = 
cix
;

412 
Âix
 = ++
pix
;

415 
Áû
 = 0;

422 
pvÆ
 = 
	`sub_∑r£
(
obvec
, 
∑tvec
, &
pix
, 
wvec
, &
cix
, &
Áû
);

423 i‡(
Áû
)

425 
cix
 = ++
ocix
;

426 
pix
 = 
Âix
;

428 } (
Áû
Ë&& (
cix
 < 
wvec
->
size
));

437 i‡(!
Áû
)

440 i‡(
pvÆ
)

442 
	`°ack_put
(
pvÆ
, 
°ack_¨gs
, 
six
 + 1, 
num_¨g
);

443 
pvÆ
 = 
	`¶i˚_w‹ds
(
wvec
, 
fw‹d
, 
ocix
 - 1);

444 
	`°ack_put
(
pvÆ
, 
°ack_¨gs
, 
six
, 
num_¨g
);

445 
six
 += 2;

450 
pvÆ
 = 
	`¶i˚_w‹ds
(
wvec
, 
fw‹d
, 
ocix
 - 1);

451 
	`°ack_put
(
pvÆ
, 
°ack_¨gs
, 
six
++, 
num_¨g
);

453 
pvÆ
 = 0;

458 i‡(!
	`EQ
(
∑tvec
->
ôem
[
pix
].
u
.
°rög
,"/"))

464 
pvÆ
 = 
	`sub_∑r£
(
obvec
, 
∑tvec
, &
pix
, 
wvec
, &
cix
, &
Áû
);

465 i‡(!
Áû
 && 
pvÆ
)

466 
	`°ack_put
(
pvÆ
, 
°ack_¨gs
, 
six
++, 
num_¨g
);

471 i‡(
Áû
)

477 i‡(
cix
 < 
wvec
->
size
)

478 
Áû
 = 1;

482 i‡(
gId_li°
)

484 
	`‰ì_ve˘‹
(
gId_li°
);

486 i‡(
gPluid_li°
)

488 
	`‰ì_ve˘‹
(
gPluid_li°
);

490 i‡(
gRodz_li°
)

492 
	`‰ì_ve˘‹
(
gRodz_li°
);

494 i‡(
gProdz_li°
)

496 
	`‰ì_ve˘‹
(
gProdz_li°
);

498 i‡(
gAdj1id_li°
)

500 
	`‰ì_ve˘‹
(
gAdj1id_li°
);

502 i‡(
gAdj2id_li°
)

504 
	`‰ì_ve˘‹
(
gAdj2id_li°
);

507 
gId_li°
 = 
ﬁd_id
;

508 
gPluid_li°
 = 
ﬁd_∂id
;

509 
gRodz_li°
 = 
ﬁd_rodz
;

510 
gProdz_li°
 = 
ﬁd_¥odz
;

511 
gAdj1id_li°
 = 
ﬁd_adj1id
;

512 
gAdj2id_li°
 = 
ﬁd_adj2id
;

514 
	`DECREF
(
wvec
->
ªf
);

515 
	`DECREF
(
∑tvec
->
ªf
);

516 
	`DECREF
(
obvec
->
ªf
);

517 
	`‰ì_ve˘‹
(
wvec
);

518 
	`‰ì_ve˘‹
(
∑tvec
);

523 i‡(
ob_‹_¨øy
->
ty≥
 =
T_OBJECT
)

525 
	`‰ì_ve˘‹
(
obvec
);

528  !
Áû
;

529 
	}
}

540 
	$°ack_put
(
svÆue
 *
pvÆ
, svÆuê*
m•
, 
pos
, 
max
)

542 i‡(
pos
 >
max
)

545 i‡((
pvÆ
Ë&& (
m•
[
pos
].
ty≥
 =
T_LVALUE
))

546 
	`assign_svÆue
(
m•
[
pos
].
u
.
lvÆue
, 
pvÆ
);

547 
	}
}

557 
svÆue
 *

558 
	$¶i˚_w‹ds
(
ve˘‹
 *
wvec
, 
‰om
, 
to
)

560 
ve˘‹
 *
¶i˚
;

561 *
tx
;

562 
svÆue
 
°mp
 = { 
T_NUMBER
 };

564 
tx
 = 0;

566 i‡(
‰om
 <
to
)

568 
¶i˚
 = 
	`¶i˚_¨øy
(
wvec
, 
‰om
, 
to
);

570 i‡(
¶i˚
->
size
)

571 
tx
 = 
	`im∂ode_°rög
(
¶i˚
, " ");

572 
	`‰ì_ve˘‹
(
¶i˚
);

575 
	`‰ì_svÆue
(&
°mp
);

577 i‡(
tx
)

579 
°mp
.
ty≥
 = 
T_STRING
;

580 
°mp
.
°rög_ty≥
 = 
STRING_SSTRING
;

581 
°mp
.
u
.
°rög
 = 
	`make_s°rög
(
tx
);

582 
	`‰ì
(
tx
);

586 
°mp
.
ty≥
 = 
T_STRING
;

587 
°mp
.
°rög_ty≥
 = 
STRING_CSTRING
;

588 
°mp
.
u
.
°rög
 = "";

590  &
°mp
;

591 
	}
}

600 
svÆue
 *

601 
	$sub_∑r£
(
ve˘‹
 *
obvec
, ve˘‹ *
∑tvec
, *
pix_ö
,

602 
ve˘‹
 *
wvec
, *
cix_ö
, *
Áû
)

604 
cix
, 
pix
, 
subÁû
;

605 
svÆue
 *
pvÆ
;

606 
svÆue
 *
	`⁄e_∑r£
(
ve˘‹
 *, *, vector *,

609 
cix
 = *
cix_ö
; 
pix
 = *
pix_ö
; 
subÁû
 = 0;

611 
pvÆ
 = 
	`⁄e_∑r£
(
obvec
, 
∑tvec
->
ôem
[
pix
].
u
.
°rög
,

612 
wvec
, &
cix
, &
subÁû
);

614 
subÁû
)

616 
pix
++;

617 
cix
 = *
cix_ö
;

622 (
pix
 < 
∑tvec
->
size
Ë&& (
	`EQ
’©vec->
ôem
[pix].
u
.
°rög
, "/")))

624 
subÁû
 = 0;

625 
pix
++;

628 i‡(!
subÁû
 && (
pix
 < 
∑tvec
->
size
))

630 
pvÆ
 = 
	`⁄e_∑r£
(
obvec
, 
∑tvec
->
ôem
[
pix
].
u
.
°rög
, 
wvec
, &
cix
,

631 &
subÁû
);

633 i‡(
subÁû
 == 2)

635 
subÁû
 = 0;

636 
pix
 =Öix - 1;

640 *
Áû
 = 1; *
pix_ö
 = 
pix
 - 1;

647 i‡((
pix
 + 1 < 
∑tvec
->
size
Ë&& (
	`EQ
’©vec->
ôem
[pix + 1].
u
.
°rög
, "/")))

649 (
pix
 + 1 <
∑tvec
->
size
) &&

650 (
	`EQ
(
∑tvec
->
ôem
[
pix
 + 1].
u
.
°rög
, "/")))

652 
pix
 += 2;

654 i‡(
pix
>=
∑tvec
->
size
)

655 
pix
 = 
∑tvec
->
size
-1;

658 *
cix_ö
 = 
cix
;

659 *
pix_ö
 = 
pix
;

660 *
Áû
 = 0;

661  
pvÆ
;

662 
	}
}

677 
svÆue
 *

678 
	$⁄e_∑r£
(
ve˘‹
 *
obvec
, *
∑t
, ve˘‹ *
wvec
, *
cix_ö
,

679 *
Áû
)

681 
ch
;

682 
svÆue
 *
pvÆ
;

683 
svÆue
 
°mp
 = { 
T_NUMBER
 };

684 *
°r1
, *
°r2
;

685 
svÆue
 *
	`ôem_∑r£
(
ve˘‹
 *, vector *, *, *);

686 
svÆue
 *
	`livög_∑r£
(
ve˘‹
 *, vector *, *, *);

687 
svÆue
 *
	`sögÀ_∑r£
(
ve˘‹
 *, vector *, *, *);

688 
svÆue
 *
	`numbî_∑r£
(
ve˘‹
 *, *, *);

693 i‡(*
cix_ö
 >
wvec
->
size
)

695 i‡(
∑t
[0] == '[')

696 *
Áû
 = 0;

698 *
Áû
 = 1;

702 
pvÆ
 = 0;

704 i‡(
∑t
[0] == '%')

706 
ch
 = 
∑t
[1];

707 i‡((
	`°æí
(
∑t
) > 2) && (pat[2] == ':'))

709 
	`ssˇnf
(
∑t
, "%%%*c:%i%*s", &
¥zyp
);

712 
¥zyp
 = 0;

716 
ch
 = 
∑t
[0];

717 i‡((
	`°æí
(
∑t
) > 1) && (pat[1] == ':'))

719 
	`ssˇnf
(
∑t
, "%*c:%i%*s", &
¥zyp
);

722 
¥zyp
 = 0;

726 
ch
)

729 
pvÆ
 = 
	`ôem_∑r£
(
obvec
, 
wvec
, 
cix_ö
, 
Áû
);

733 
pvÆ
 = 
	`livög_∑r£
(
obvec
, 
wvec
, 
cix_ö
, 
Áû
);

737 *
Áû
 = 0;

741 
	`‰ì_svÆue
(&
°mp
);

742 
°mp
.
ty≥
 = 
T_STRING
;

743 
°mp
.
°rög_ty≥
 = 
STRING_SSTRING
;

744 
°mp
.
u
.
°rög
 = 
	`make_s°rög
(
wvec
->
ôem
[*
cix_ö
].u.string);

745 
pvÆ
 = &
°mp
;

746 (*
cix_ö
)++;

747 *
Áû
 = 0;

751 
pvÆ
 = 
	`sögÀ_∑r£
(
obvec
, 
wvec
, 
cix_ö
, 
Áû
);

755 
pvÆ
 = 
	`numbî_∑r£
(
wvec
, 
cix_ö
, 
Áû
);

759 
°r1
 = &
∑t
[1]; 
°r2
 = 
wvec
->
ôem
[*
cix_ö
].
u
.
°rög
;

760 i‡((
	`°∫cmp
(
°r1
, 
°r2
, 
	`°æí
(str1) - 1) == 0) &&

761 (
	`°æí
(
°r1
Ë=°æí(
°r2
) + 1))

763 *
Áû
 = 0;

764 (*
cix_ö
)++;

767 *
Áû
 = 1;

771 
°r1
 = &
∑t
[1]; 
°r2
 = 
wvec
->
ôem
[*
cix_ö
].
u
.
°rög
;

772 i‡((
	`°∫cmp
(
°r1
, 
°r2
, 
	`°æí
(str1) - 1) == 0) &&

773 (
	`°æí
(
°r1
Ë=°æí(
°r2
) + 1))

775 (*
cix_ö
)++;

776 *
Áû
 = 0;

780 *
Áû
 = 2;

785 *
Áû
 = 0;

787  
pvÆ
;

788 
	}
}

794 *
	gje
[] = { "den", "dnego", "dnemu", "dnym", "dna", "dnej",

796 *
	gdw
[] = { "a", "aj", "och", "om", "oma", "ie", "anascie",

798 *
	gå
[] = { "zy", "zech", "zej", "zem", "zema", "zynascie",

801 *
	gcz
[] = { "tery", "terech", "terem", "terema", "terej",

804 *
	gpi
[] = { "ec", "eciu", "ecioma", "etnascie", "etnastu",

806 *
	gsz
[] = { "esc", "esciu", "escioma", "esnascie", "esnastu",

809 *
	gsi
[] = { "edem", "edmiu", "edmioma", "edemnascie",

812 *
	gos
[] = { "iem", "miu", "mioma", "iemnascie", "iemnastu",

815 *
	gdz
[] = { "iewiec", "iewieciu", "iewiecioma", "iesiec",

820 *
	g‹d1
[] = { "pierwsz", "drug", "trzec", "czwart", "piat",

823 *
	g‹d11
[] = { "dziesiat", "jedenast", "dwunast", "trzynast",

827 *
	g‹d20
[] = { "dwudziest", "trzydziest", "czterdziest",

845 
svÆue
 *

846 
	$numbî_∑r£
(
ve˘‹
 *
wvec
, *
cix_ö
, *
Áû
)

848 
cix
, 
°r_Àn
, 
membî
, 
x
, 
szf
 = 0, 
liczba
 = 0, 
succ
;

849 
buf
[5], 
°r
[
	`°æí
(
wvec
->
ôem
[*
cix_ö
].
u
.
°rög
)],

850 
tmp
[
	`°æí
(
wvec
->
ôem
[*
cix_ö
].
u
.
°rög
)];

851 
svÆue
 
°mp
;

853 
	`membî_¨øy
(*, **);

856 
cix
 = *
cix_ö
; *
Áû
 = 0;

858 
	`°r˝y
(
°r
, 
wvec
->
ôem
[
cix
].
u
.
°rög
);

860 i‡(
	`ssˇnf
(
°r
, "%d", &
liczba
))

862 i‡(
liczba
 >= 0)

864 (*
cix_ö
)++;

865 
°mp
.
ty≥
 = 
T_NUMBER
;

866 
°mp
.
u
.
numbî
 = 
liczba
;

867  &
°mp
;

869 *
Áû
 = 1;

876 i‡(
	`°æí
(
°r
) < 3)

878 *
Áû
 = 1;

882 
succ
 = 0;

883 
¥zyp
)

885 0: 
succ
 = (
	`EQ
(
°r
, "wszystko") || EQ(str, "wszyscy")); ;

886 1: 
succ
 = (
	`EQ
(
°r
, "wszystkich") || EQ(str, "wszystkiego")); ;

887 2: 
succ
 = (
	`EQ
(
°r
, "wszystkim") || EQ(str, "wszystkiemu")); ;

888 3: 
succ
 = (
	`EQ
(
°r
, "wszystko") || EQ(str, "wszystkich") ||

889 
	`EQ
(
°r
, "wszystkie")); ;

890 4: 
succ
 = (
	`EQ
(
°r
, "wszystkim") || EQ(str, "wszystkimi")); ;

891 5: 
succ
 = (
	`EQ
(
°r
, "wszystkim") || EQ(str, "wszystkich")); ;

892 : *
Áû
 = 1;  0;

895 i‡(
succ
)

897 (*
cix_ö
)++;

898 
°mp
.
ty≥
 = 
T_NUMBER
;

899 
°mp
.
u
.
numbî
 = 0;

900  &
°mp
;

905 
	`°∫˝y
(
buf
, 
°r
, 2); buf[2] = '\0';

906 
	`°r˝y
(
tmp
, (
°r
+2));

908 i‡(
	`EQ
(
buf
, "je"))

910 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
je
)) != -1)

912 i‡(
membî
 < 7Ë
liczba
 = 1;

913 
liczba
 = 11;

916 i‡(
	`EQ
(
buf
, "dw"))

918 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
dw
)) != -1)

920 i‡(
membî
 < 6Ë
liczba
 = 2;

921 i‡(
membî
 < 9Ë
liczba
 = 12;

922 
liczba
 = 20;

925 i‡(
	`EQ
(
buf
, "tr"))

927 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
å
)) != -1)

929 i‡(
membî
 < 5Ë
liczba
 = 3;

930 i‡(
membî
 < 8Ë
liczba
 = 13;

931 
liczba
 = 30;

934 i‡(
	`EQ
(
buf
, "cz"))

936 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
cz
)) != -1)

938 i‡(
membî
 < 5Ë
liczba
 = 4;

939 i‡(
membî
 < 8Ë
liczba
 = 14;

940 
liczba
 = 40;

943 i‡(
	`EQ
(
buf
, "pi"))

945 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
pi
)) != -1)

947 i‡(
membî
 < 3Ë
liczba
 = 5;

948 i‡(
membî
 < 6Ë
liczba
 = 15;

949 
liczba
 = 50;

952 i‡(
	`EQ
(
buf
, "sz"))

954 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
sz
)) != -1)

956 i‡(
membî
 < 3Ë
liczba
 = 6;

957 i‡(
membî
 < 6Ë
liczba
 = 16;

958 
liczba
 = 60;

961 i‡(
	`EQ
(
buf
, "si"))

963 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
si
)) != -1)

965 i‡(
membî
 < 3Ë
liczba
 = 7;

966 i‡(
membî
 < 6Ë
liczba
 = 17;

967 
liczba
 = 70;

970 i‡(
	`EQ
(
buf
, "os"))

972 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
os
)) != -1)

974 i‡(
membî
 < 3Ë
liczba
 = 8;

975 i‡(
membî
 < 6Ë
liczba
 = 18;

976 
liczba
 = 80;

979 i‡(
	`EQ
(
buf
, "dz"))

981 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
dz
)) != -1)

983 i‡(
membî
 < 3Ë
liczba
 = 9;

984 i‡(
membî
 < 6Ë
liczba
 = 10;

985 i‡(
membî
 < 9Ë
liczba
 = 19;

986 
liczba
 = 90;

989 
liczba
 = 0;

991 i‡(
liczba
 &&Üiczba < 20)

993 (*
cix_ö
)++;

994 
°mp
.
ty≥
 = 
T_NUMBER
;

995 
°mp
.
u
.
numbî
 = 
liczba
;

996  &
°mp
;

998 i‡((
liczba
 >20Ë&& (
cix
 + 1 < 
wvec
->
size
))

1000 
cix
++;

1001 
	`°∫˝y
(
buf
, 
wvec
->
ôem
[
cix
].
u
.
°rög
, 2); buf[2] = '\0';

1002 
	`°r˝y
(
tmp
, (
wvec
->
ôem
[
cix
].
u
.
°rög
 + 2));

1004 i‡(
	`EQ
(
buf
, "je"))

1006 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
je
)) != -1)

1008 i‡(
membî
 < 7) member = 1;

1009 
membî
 = 0;

1012 i‡(
	`EQ
(
buf
, "dw"))

1014 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
dw
)) != -1)

1016 i‡(
membî
 < 6) member = 2;

1017 
membî
 = 0;

1020 i‡(
	`EQ
(
buf
, "tr"))

1022 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
å
)) != -1)

1024 i‡(
membî
 < 5) member = 3;

1025 
membî
 = 0;

1028 i‡(
	`EQ
(
buf
, "cz"))

1030 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
cz
)) != -1)

1032 i‡(
membî
 < 5) member = 4;

1033 
membî
 = 0;

1036 i‡(
	`EQ
(
buf
, "pi"))

1038 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
pi
)) != -1)

1040 i‡(
membî
 < 3) member = 5;

1041 
membî
 = 0;

1044 i‡(
	`EQ
(
buf
, "sz"))

1046 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
sz
)) != -1)

1048 i‡(
membî
 < 3) member = 6;

1049 
membî
 = 0;

1052 i‡(
	`EQ
(
buf
, "si"))

1054 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
si
)) != -1)

1056 i‡(
membî
 < 3) member = 7;

1057 
membî
 = 0;

1060 i‡(
	`EQ
(
buf
, "os"))

1062 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
os
)) != -1)

1064 i‡(
membî
 < 3) member = 8;

1065 
membî
 = 0;

1068 i‡(
	`EQ
(
buf
, "dz"))

1070 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
dz
)) != -1)

1072 i‡(
membî
 < 3) member = 9;

1073 
membî
 = 0;

1076 
membî
 = 0;

1078 i‡(
membî
)

1080 
liczba
 +
membî
;

1081 (*
cix_ö
)++;

1085 i‡(
liczba
)

1087 (*
cix_ö
)++;

1088 
°mp
.
ty≥
 = 
T_NUMBER
;

1089 
°mp
.
u
.
numbî
 = 
liczba
;

1090  &
°mp
;

1099 
°r_Àn
 = 
	`°æí
(
°r
);

1101 
°r
[
°r_Àn
 - 1])

1103 'o': 
x
 = 1; 
szf
 = 3; 
	`°r˝y
(
buf
, "ego"); ;

1104 'u': 
x
 = 2; 
szf
 = 3; 
	`°r˝y
(
buf
, "emu"); ;

1105 'j': 
x
 = 3; 
szf
 = 2; 
	`°r˝y
(
buf
, "ej"); ;

1106 'e': 
x
 = 4; 
szf
 = 1; 
	`°r˝y
(
buf
, "e"); ;

1107 'a': 
x
 = 5; 
szf
 = 1; 
	`°r˝y
(
buf
, "a"); ;

1108 'm': 
x
 = 6; ;

1110 'y': 
x
 = 7; ;

1111 : *
Áû
 = 1;  0;

1114 i‡(
x
 == 7)

1116 
	`°∫˝y
(
tmp
, 
°r
, (
°r_Àn
 - 1));

1117 
tmp
[
°r_Àn
 - 1] = '\0';

1119 i‡(
x
 != 6)

1121 
	`°∫˝y
(
tmp
, (
°r
 + 
°r_Àn
 - 
szf
), szf);Åmp[szf] = '\0';

1122 i‡(!
	`EQ
(
buf
, 
tmp
))

1124 *
Áû
 = 1;

1128 i‡(
°r
[
°r_Àn
 - (
szf
 + 1)] != 'i')

1130 
	`°∫˝y
(
tmp
, 
°r
, 
°r_Àn
 - (
szf
));

1131 
tmp
[
°r_Àn
 - 
szf
] = '\0';

1135 
	`°∫˝y
(
tmp
, 
°r
, 
°r_Àn
 - (
szf
 + 1));

1136 
tmp
[
°r_Àn
 - (
szf
 + 1)] = '\0';

1141 
°r
[
°r_Àn
 - 2])

1144 'i': 
	`°∫˝y
(
tmp
, 
°r
, 
°r_Àn
 - 2);

1145 
tmp
[
°r_Àn
 - 2] = '\0'; ;

1146 : *
Áû
 = 1;  0;

1150 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
‹d1
)) != -1)

1151 
liczba
 = (
membî
 + 1);

1152 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
‹d11
)) != -1)

1153 
liczba
 = (
membî
 + 10);

1154 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
‹d20
)) != -1)

1156 
liczba
 = ((
membî
 + 2) * 10);

1157 i‡(
cix
 + 1 < 
wvec
->
size
)

1159 
cix
++;

1160 
	`°r˝y
(
°r
, 
wvec
->
ôem
[
cix
].
u
.
°rög
);

1162 
°r_Àn
 = 
	`°æí
(
°r
);

1164 i‡(
x
 == 7)

1166 
	`°∫˝y
(
tmp
, 
°r
, (
°r_Àn
 - 1));

1167 
tmp
[
°r_Àn
 - 1] = '\0';

1169 i‡(
x
 != 6)

1171 
	`°∫˝y
(
tmp
, (
°r
 + 
°r_Àn
 - 
szf
), szf);Åmp[szf] = '\0';

1172 i‡(!
	`EQ
(
buf
, 
tmp
))

1174 *
Áû
 = 1;

1178 i‡(
°r
[
°r_Àn
 - (
szf
 + 1)] != 'i')

1180 
	`°∫˝y
(
tmp
, 
°r
, 
°r_Àn
 - (
szf
));

1181 
tmp
[
°r_Àn
 - 
szf
] = '\0';

1185 
	`°∫˝y
(
tmp
, 
°r
, 
°r_Àn
 - (
szf
 + 1));

1186 
tmp
[
°r_Àn
 - (
szf
 + 1)] = '\0';

1191 
°r
[
°r_Àn
 - 2])

1194 'i': 
	`°∫˝y
(
tmp
, 
°r
, 
°r_Àn
 - 2);

1195 
tmp
[
°r_Àn
 - 2] = '\0'; ;

1196 : *
Áû
 = 1;  0;

1200 i‡((
membî
 = 
	`membî_¨øy
(
tmp
, 
‹d1
)) != -1)

1202 (*
cix_ö
)++;

1203 
liczba
 +(
membî
 + 1);

1207 *
Áû
 = 1;

1213 i‡(
liczba
)

1215 (*
cix_ö
)++;

1216 
°mp
.
ty≥
 = 
T_NUMBER
;

1217 
°mp
.
u
.
numbî
 = -
liczba
;

1218  &
°mp
;

1221 *
Áû
 = 1;

1226 
ãn
 = 0;Åen < 10;Åen++)

1227 
⁄es
 = 0; ones < 10; ones++)

1229 ()
	`•rötf
(
buf
,"%s%s", 
num10
[
ãn
],

1230 (
ãn
 > 1Ë? 
num1
[
⁄es
] :Çum1[ten * 10 + ones]);

1231 i‡(
	`EQ
(
buf
, 
wvec
->
ôem
[
cix
].
u
.
°rög
))

1233 (*
cix_ö
)++;

1234 
°mp
.
ty≥
 = 
T_NUMBER
;

1235 
°mp
.
u
.
numbî
 = 
ãn
 * 10 + 
⁄es
;

1236  &
°mp
;

1240 
ãn
 = 0;Åen < 10;Åen++)

1241 
⁄es
 = 0; ones < 10; ones++)

1243 ()
	`•rötf
(
buf
,"%s%s", (
⁄es
Ë? 
‹d10
[
ãn
] : 
s‹d10
[ten],

1244 (
ãn
 > 1Ë? 
‹d1
[
⁄es
] : ord1[ten * 10 + ones]);

1245 i‡(
	`EQ
(
buf
, 
wvec
->
ôem
[
cix
].
u
.
°rög
))

1247 (*
cix_ö
)++;

1248 
°mp
.
ty≥
 = 
T_NUMBER
;

1249 
°mp
.
u
.
numbî
 = -(
ãn
 * 10 + 
⁄es
);

1250  &
°mp
;

1254 
	}
}

1257 
	$zamõn_¥zy∑dek
(
num
)

1259 i‡((
¥zyp
 != 3) && (przyp != 0))

1262 i‡(
num
 < 2)

1265 i‡((
num
 % 10 > 1) && (num % 10 < 5) && ((num / 10) % 10 != 1))

1268 
¥zyp
 = 1;

1275 
	}
}

1301 
	#R_MESKI
 0

	)

1302 
	#R_ZENSKI
 1

	)

1303 
	#R_NIJAKI
 2

	)

1304 
	#R_MESKOOS
 3

	)

1305 
	#R_NIEMESKOOS
 4

	)

1307 
ve˘‹
 *

1308 
	$zaimek_∑r£
(
ve˘‹
 *
wvec
, *
cix_ö
, *
Áû
)

1310 
ve˘‹
 *
ªt
;

1311 
svÆue
 *
≠l
;

1312 
°r
[
	`°æí
(
wvec
->
ôem
[*
cix_ö
].
u
.
°rög
)];

1313 
f
 = 0, 
rodzaj
 = -1;

1315 
	`°r˝y
(
°r
, 
wvec
->
ôem
[*
cix_ö
].
u
.
°rög
);

1316 
¥zyp
)

1319 i‡(
	`EQ
(
°r
, "niego") || EQ(str, "go"))

1320 
f
 = 1;

1321 i‡(
	`EQ
(
°r
, "niej") || EQ(str, "jej"))

1322 
rodzaj
 = 
R_ZENSKI
;

1323 i‡(
	`EQ
(
°r
, "nich") || EQ(str, "ich"))

1324 
f
 = 2;

1327 i‡(
	`EQ
(
°r
, "mu"))

1328 
f
 = 1;

1329 i‡(
	`EQ
(
°r
, "jej"))

1330 
rodzaj
 = 
R_ZENSKI
;

1331 i‡(
	`EQ
(
°r
, "im"))

1332 
f
 = 2;

1335 i‡(
	`EQ
(
°r
, "niego") || EQ(str, "go"))

1336 
rodzaj
 = 
R_MESKI
;

1337 i‡(
	`EQ
(
°r
, "nia") || EQ(str, "ja"))

1338 
rodzaj
 = 
R_ZENSKI
;

1339 i‡(
	`EQ
(
°r
, "nie") || EQ(str, "je"))

1340 
f
 = 3;

1341 i‡(
	`EQ
(
°r
, "nich") || EQ(str, "ich"))

1342 
rodzaj
 = 
R_MESKOOS
;

1345 i‡(
	`EQ
(
°r
, "nim"))

1346 
f
 = 1;

1347 i‡(
	`EQ
(
°r
, "nia"))

1348 
rodzaj
 = 
R_ZENSKI
;

1349 i‡(
	`EQ
(
°r
, "nimi"))

1350 
f
 = 2;

1353 i‡(
	`EQ
(
°r
, "nim"))

1354 
f
 = 1;

1355 i‡(
	`EQ
(
°r
, "niej"))

1356 
rodzaj
 = 
R_ZENSKI
;

1357 i‡(
	`EQ
(
°r
, "nich"))

1358 
f
 = 2;

1361 i‡(!
f
 && 
rodzaj
 == -1)

1362  
NULL
;

1364 i‡(
f
)

1366 
≠l
 = 
	`≠∂y
(
QGET_BIT_ZAIMKOW
, 
comm™d_givî
, 0, 1);

1367 i‡(!
≠l
 || (≠l->
ty≥
 !
T_NUMBER
))

1368  
NULL
;

1369 
rodzaj
 = 
≠l
->
u
.
numbî
;

1370 
	`‰ì_svÆue
(
≠l
);

1371 
f
)

1374 i‡(
rodzaj
 & 1)

1375 
rodzaj
 = 
R_MESKI
;

1377 
rodzaj
 = 
R_NIJAKI
;

1380 i‡(
rodzaj
 & 2)

1381 
rodzaj
 = 
R_NIEMESKOOS
;

1383 
rodzaj
 = 
R_MESKOOS
;

1386 i‡(
rodzaj
 & 4)

1387 
rodzaj
 = 
R_NIJAKI
;

1389 
rodzaj
 = 
R_NIEMESKOOS
;

1393 
	`push_numbî
(
rodzaj
);

1394 
≠l
 = 
	`≠∂y
(
QGET_ZAIMKA
, 
comm™d_givî
, 1, 1);

1395 i‡(
≠l
->
ty≥
 =
T_POINTER
 &&á∂->
u
.
vec
->
size
)

1397 
ªt
 = 
	`¶i˚_¨øy
(
≠l
->
u
.
vec
, 0, (≠l->u.vec->
size
 - 1));

1398 (*
cix_ö
)++;

1399 
	`‰ì_svÆue
(
≠l
);

1400  
ªt
;

1403 
	`‰ì_svÆue
(
≠l
);

1404  
NULL
;

1405 
	}
}

1425 
svÆue
 *

1426 
	$ôem_∑r£
(
ve˘‹
 *
obvec
, ve˘‹ *
wvec
, *
cix_ö
, *
Áû
)

1428 
ve˘‹
 *
tmp
, *
ªt
;

1429 
svÆue
 *
pvÆ
;

1430 
svÆue
 
°mp
 = { 
T_NUMBER
 };

1431 
cix
, 
tix
, 
obix
, 
∂ur_Êag
, 
max_cix
, 
m©ch_Æl
, 
rodzaj
;

1432 
Æl
, 
Àn
, 
max_Àn
, *
tmp_öt
;

1433 
	`m©ch_obje˘
(, 
ve˘‹
 *, *, *,

1436 i‡–(
pvÆ
 = 
	`numbî_∑r£
(
wvec
, 
cix_ö
, 
Áû
)Ë!
NULL
 )

1438 
	`zamõn_¥zy∑dek
(
pvÆ
->
u
.
numbî
);

1441 i‡((
pvÆ
Ë&& (pvÆ->
u
.
numbî
 > 1))

1443 
∂ur_Êag
 = 1;

1444 
m©ch_Æl
 = 0;

1446 i‡((
pvÆ
Ë&& (pvÆ->
u
.
numbî
 == 0))

1448 
∂ur_Êag
 = 1;

1449 
m©ch_Æl
 = 1;

1453 
∂ur_Êag
 = 0;

1454 
m©ch_Æl
 = 0;

1456 i‡(!
pvÆ
 && (
tmp
 = 
	`zaimek_∑r£
(
wvec
, 
cix_ö
, 
Áû
)Ë!
NULL
)

1458 i‡(!
tmp
->
size
)

1460 
	`‰ì_ve˘‹
(
tmp
);

1461 *
Áû
 = 1;

1464 
tmp_öt
 = (*)
	`xÆloc
((Ë* 
tmp
->
size
);

1466 
obix
 = 0, 
cix
 = 0; obix < 
tmp
->
size
; obix++)

1468 
tix
 = -1;

1469 ++
tix
 < 
obvec
->
size
)

1470 i‡((
tmp
->
ôem
[
obix
].
ty≥
 =
T_OBJECT
) &&

1471 !(
tmp
->
ôem
[
obix
].
u
.
ob
->
Êags
 & 
O_DESTRUCTED
) &&

1472 (
obvec
->
ôem
[
tix
].
u
.
ob
 =
tmp
->ôem[
obix
].u.ob))

1474 
tmp_öt
[
cix
++] = 
obix
;

1479 i‡(!
cix
)

1481 
	`‰ì_ve˘‹
(
tmp
);

1482 
	`‰ì
(
tmp_öt
);

1483 *
Áû
 = 1;

1487 
ªt
 = 
	`Æloˇã_¨øy
(
cix
 + 1);

1488 
tix
 = 0;Åix < 
cix
;Åix++)

1490 
	`assign_svÆue_no_‰ì
(&
ªt
->
ôem
[
tix
 + 1],

1491 &
tmp
->
ôem
[
tmp_öt
[
tix
]]);

1494 
	`‰ì_ve˘‹
(
tmp
);

1495 
	`‰ì
(
tmp_öt
);

1497 
ªt
->
ôem
[0].
ty≥
 = 
T_NUMBER
;

1498 
ªt
->
ôem
[0].
u
.
numbî
 = (
cix
 > 1 ? 0 : 1);

1499 *
Áû
 = 0;

1500 
	`‰ì_svÆue
(&
°mp
);

1501 
°mp
.
ty≥
 = 
T_POINTER
;

1502 
°mp
.
u
.
vec
 = 
ªt
;

1504  &
°mp
;

1508 
tmp
 = 
	`Æloˇã_¨øy
(
obvec
->
size
 + 1);

1509 i‡(
pvÆ
)

1510 
	`assign_svÆue_no_‰ì
(&
tmp
->
ôem
[0], 
pvÆ
);

1511 
max_cix
 = *
cix_ö
;

1512 
max_Àn
 = 0;

1513 
tix
 = 1;

1515 i‡(!
m©ch_Æl
 || 
cix
 !
wvec
->
size
)

1517 
obix
 = 0; obix < 
obvec
->
size
; obix++)

1519 *
Áû
 = 0; 
cix
 = *
cix_ö
;

1520 i‡(
obvec
->
ôem
[
obix
].
ty≥
 !
T_OBJECT
)

1523 
	`lﬂd_Õc_öfo
(
obix
, 
obvec
->
ôem
[obix].
u
.
ob
);

1525 i‡((
Àn
 = 
	`m©ch_obje˘
(
obix
, 
wvec
, &
cix
, &
∂ur_Êag
, &
rodzaj
,

1526 
max_Àn
)))

1528 i‡(
Àn
 > 
max_Àn
)

1530 
max_Àn
 = 
Àn
;

1531 
tix
 = 1;

1533 
	`assign_svÆue_no_‰ì
(&
tmp
->
ôem
[
tix
++], &
obvec
->ôem[
obix
]);

1534 
max_cix
 = (max_cix < 
cix
) ? cix : max_cix;

1539 i‡(
m©ch_Æl
 && 
tix
 < 2)

1541 
obix
 = 0; obix < 
obvec
->
size
; obix++)

1543 i‡(
obvec
->
ôem
[
obix
].
ty≥
 !
T_OBJECT
)

1545 
	`assign_svÆue_no_‰ì
(&
tmp
->
ôem
[
tix
++], &
obvec
->ôem[
obix
]);

1547 *
Áû
 = 0;

1548 
Æl
 = 1;

1551 
Æl
 = 0;

1553 i‡(
tix
 < 2)

1555 *
Áû
 = 1;

1556 
	`‰ì_ve˘‹
(
tmp
);

1557 i‡(
pvÆ
)

1558 (*
cix_ö
)--;

1564 i‡(!
Æl
 && (*
cix_ö
 < 
wvec
->
size
))

1565 *
cix_ö
 = 
max_cix
 + 1;

1566 
ªt
 = 
	`¶i˚_¨øy
(
tmp
, 0, 
tix
 - 1);

1567 i‡(!
pvÆ
)

1569 
ªt
->
ôem
[0].
ty≥
 = 
T_NUMBER
;

1570 
ªt
->
ôem
[0].
u
.
numbî
 = 
∂ur_Êag
 ? 0 : 1;

1572 
	`‰ì_ve˘‹
(
tmp
);

1577 i‡(!
m©ch_Æl
)

1579 
	`push_numbî
(
rodzaj
);

1580 
	`push_numbî
(
∂ur_Êag
);

1581 
	`≠∂y
(
QSET_RODZAJ
, 
comm™d_givî
, 2, 1);

1585 
	`push_numbî
(-1);

1586 
	`push_numbî
(0);

1587 
	`≠∂y
(
QSET_RODZAJ
, 
comm™d_givî
, 2, 1);

1592 
	`‰ì_svÆue
(&
°mp
);

1593 
°mp
.
ty≥
 = 
T_POINTER
;

1594 
°mp
.
u
.
vec
 = 
ªt
;

1595  &
°mp
;

1596 
	}
}

1619 
svÆue
 *

1620 
	$livög_∑r£
(
ve˘‹
 *
obvec
, ve˘‹ *
wvec
, *
cix_ö
, *
Áû
)

1622 
ve˘‹
 *
live
;

1623 
svÆue
 *
pvÆ
;

1624 
obix
, 
tix
;

1626 
live
 = 
	`Æloˇã_¨øy
(
obvec
->
size
);

1627 
tix
 = 0;

1628 *
Áû
 = 0;

1630 
obix
 = 0; obix < 
obvec
->
size
; obix++)

1631 i‡(
obvec
->
ôem
[
obix
].
ty≥
 =
T_OBJECT
 &&

1632 
obvec
->
ôem
[
obix
].
u
.
ob
->
Êags
 & 
O_ENABLE_COMMANDS
)

1633 
	`assign_svÆue_no_‰ì
(&
live
->
ôem
[
tix
++], &
obvec
->ôem[
obix
]);

1635 i‡(
tix
)

1637 
pvÆ
 = 
	`ôem_∑r£
(
live
, 
wvec
, 
cix_ö
, 
Áû
);

1638 i‡(
pvÆ
)

1640 
	`‰ì_ve˘‹
(
live
);

1641  
pvÆ
;

1644 
	`‰ì_ve˘‹
(
live
);

1648 
ob
 = 
	`föd_livög_obje˘
(
wvec
->
ôem
[*
cix_ö
].
u
.
°rög
);

1649 i‡(
ob
)

1651 
	`‰ì_svÆue
(&
°mp
);

1652 
°mp
.
ty≥
 = 
T_OBJECT
;

1653 
°mp
.
u
.
ob
 = ob;

1654 
	`add_ªf
(
ob
, "living_parse");

1655 (*
cix_ö
)++;

1656  &
°mp
;

1659 *
Áû
 = 1;

1661 
	}
}

1673 
svÆue
 *

1674 
	$sögÀ_∑r£
(
ve˘‹
 *
obvec
, ve˘‹ *
wvec
, *
cix_ö
, *
Áû
)

1676 
cix
, 
obix
, 
∂ur_Êag
, 
rodzaj
;

1677 
	`m©ch_obje˘
(, 
ve˘‹
 *, *, *,

1680 
obix
 = 0; obix < 
obvec
->
size
; obix++)

1682 i‡(
obvec
->
ôem
[
obix
].
ty≥
 !
T_OBJECT
)

1684 *
Áû
 = 0;

1685 
cix
 = *
cix_ö
;

1686 
	`lﬂd_Õc_öfo
(
obix
, 
obvec
->
ôem
[obix].
u
.
ob
);

1687 
∂ur_Êag
 = 0;

1688 i‡(
	`m©ch_obje˘
(
obix
, 
wvec
, &
cix
, &
∂ur_Êag
, &
rodzaj
, 0))

1690 *
cix_ö
 = 
cix
 + 1;

1691  &
obvec
->
ôem
[
obix
];

1694 *
Áû
 = 1;

1696 
	}
}

1710 
	$m©ch_obje˘
(
obix
, 
ve˘‹
 *
wvec
, *
cix_ö
, *
∂ur
,

1711 *
rodzaj
, 
max_Àn
)

1713 
ve˘‹
 *
ids
, *
rodz
, *
adj1
, *
adj2
;

1714 
û
, 
pos
, 
˝lur
, 
ﬁd_cix
, 
Àn
;

1715 
max_Àn_cix
, 
max_Àn_∂ur
, 
max_Àn_rodzaj
;

1716 *
°r
;

1717 
	`föd_°rög
(*, 
ve˘‹
 *, *);

1718 
	`check_adje˘iv
(
ve˘‹
 *, vector *, ,

1719 
ve˘‹
 *, , , *, );

1721 
max_Àn_∂ur
 = 
max_Àn_rodzaj
 = 
max_Àn_cix
 = -1;

1723 
˝lur
 = (*
∂ur
 * 2); cplur < 4; cplur++)

1725 
˝lur
)

1728 i‡(!
gId_li°_d
)

1730 
ids
 = 
gId_li°_d
;

1731 
rodz
 = 
gRodz_li°_d
;

1735 i‡(!
gId_li°
 ||

1736 
gId_li°
->
size
 <
obix
 ||

1737 
gId_li°
->
ôem
[
obix
].
ty≥
 !
T_POINTER
)

1739 
ids
 = 
gId_li°
->
ôem
[
obix
].
u
.
vec
;

1740 
rodz
 = 
gRodz_li°
->
ôem
[
obix
].
u
.
vec
;

1744 i‡(!
gPluid_li°_d
)

1746 
ids
 = 
gPluid_li°_d
;

1747 
rodz
 = 
gProdz_li°_d
;

1751 i‡(!
gPluid_li°
 ||

1752 
gPluid_li°
->
size
 <
obix
 ||

1753 
gPluid_li°
->
ôem
[
obix
].
ty≥
 !
T_POINTER
)

1755 
ids
 = 
gPluid_li°
->
ôem
[
obix
].
u
.
vec
;

1756 
rodz
 = 
gProdz_li°
->
ôem
[
obix
].
u
.
vec
;

1763 
adj1
 = 
gAdj1id_li°
->
ôem
[
obix
].
u
.
vec
;

1764 
adj2
 = 
gAdj2id_li°
->
ôem
[
obix
].
u
.
vec
;

1766 i‡(
rodz
->
size
 !
ids
->size)

1769 
ﬁd_cix
 = *
cix_ö
;

1771 
û
 = 0; i»< 
ids
->
size
; il++)

1773 i‡(
ids
->
ôem
[
û
].
ty≥
 !
T_STRING
)

1776 
°r
 = 
ids
->
ôem
[
û
].
u
.
°rög
;

1778 i‡((
pos
 = 
	`föd_°rög
(
°r
, 
wvec
, 
cix_ö
)) >= 0)

1780 
Àn
 = (*
cix_ö
 - 
pos
) + 1;

1782 i‡(
Àn
 < 
max_Àn
)

1784 *
cix_ö
 = 
ﬁd_cix
;

1788 *
rodzaj
 = 
rodz
->
ôem
[
û
].
u
.
numbî
;

1789 i‡(*
rodzaj
 < 0)

1790 *
rodzaj
 = (-(*rodzaj));

1791 i‡(*
rodzaj
)

1792 (*
rodzaj
)--;

1794 i‡((
pos
 =
ﬁd_cix
Ë|| 
	`check_adje˘iv
(
adj1
, 
adj2
, 
obix
,

1795 
wvec
, 
ﬁd_cix
, 
pos
-1, 
rodzaj
, (
˝lur
 > 1)))

1797 i‡(
˝lur
 > 1)

1798 *
∂ur
 = 1;

1800 
max_Àn_cix
 = *
cix_ö
;

1801 
max_Àn_∂ur
 = *
∂ur
;

1802 
max_Àn
 = 
Àn
;

1803 
max_Àn_rodzaj
 = *
rodzaj
;

1806 *
cix_ö
 = 
ﬁd_cix
;

1809 i‡(
max_Àn_cix
 >= 0)

1811 *
cix_ö
 = 
max_Àn_cix
;

1812 *
∂ur
 = 
max_Àn_∂ur
;

1813 *
rodzaj
 = 
max_Àn_rodzaj
;

1815  
max_Àn
;

1820 
	}
}

1833 
	$föd_°rög
(*
°r
, 
ve˘‹
 *
wvec
, *
cix_ö
)

1835 
Âos
;

1836 *
p1
;

1837 
ve˘‹
 *
•lô
;

1839 #i‚de‡
OLD_EXPLODE


1840 *
cix_ö
 < 
wvec
->
size
 && !*(wvec->
ôem
[*cix_ö].
u
.
°rög
))

1841 (*
cix_ö
)++;

1844 ; *
cix_ö
 < 
wvec
->
size
; (*cix_in)++)

1846 
p1
 = 
wvec
->
ôem
[*
cix_ö
].
u
.
°rög
;

1847 i‡(
p1
[0] !
°r
[0])

1850 i‡(
	`°rcmp
(
p1
, 
°r
) == 0)

1851  *
cix_ö
;

1853 i‡(
	`°rchr
(
°r
,' 'Ë=
NULL
)

1858 i‡(*
cix_ö
 =(
wvec
->
size
 -1))

1861 
•lô
 = 
	`ex∂ode_°rög
(
°r
," ");

1867 i‡(!
•lô
 || (•lô->
size
 > (
wvec
->sizê- *
cix_ö
)))

1869 i‡(
•lô
)

1870 
	`‰ì_ve˘‹
(
•lô
);

1874 
Âos
 = *
cix_ö
;

1875 ; (*
cix_ö
-
Âos
Ë< 
•lô
->
size
; (*cix_in)++)

1877 i‡(
	`°rcmp
(
•lô
->
ôem
[*
cix_ö
-
Âos
].
u
.
°rög
,

1878 
wvec
->
ôem
[*
cix_ö
].
u
.
°rög
))

1881 i‡((*
cix_ö
 - 
Âos
Ë=
•lô
->
size
) {

1882 
	`‰ì_ve˘‹
(
•lô
);

1883 (*
cix_ö
)--;

1884  
Âos
;

1886 
	`‰ì_ve˘‹
(
•lô
);

1888 *
cix_ö
 = 
Âos
;

1892 
	}
}

1894 
ve˘‹
 *

1895 
	$make_adje˘iv_li°
(
ve˘‹
 *
adj1
, ve˘‹ *
adj2
, *
rodzaj
,

1896 
∂ur
)

1898 
ve˘‹
 *
π∫
;

1899 *
¥zym
;

1900 
ix
;

1901 *
	`oblicz_¥zym
(*, *, , , );

1903 i‡(!
adj1
->
size
 ||ádj1->sizê!
adj2
->size)

1906 
π∫
 = 
	`Æloˇã_¨øy
(
adj1
->
size
);

1908 
ix
 = -1;

1909 ++
ix
 < 
adj1
->
size
)

1911 
¥zym
 = 
	`oblicz_¥zym
(
adj1
->
ôem
[
ix
].
u
.
°rög
,

1912 
adj2
->
ôem
[
ix
].
u
.
°rög
, 
¥zyp
, *
rodzaj
, 
∂ur
);

1913 i‡(
¥zym
)

1915 
π∫
->
ôem
[
ix
].
ty≥
 = 
T_STRING
;

1916 
π∫
->
ôem
[
ix
].
°rög_ty≥
 = 
STRING_MSTRING
;

1917 
π∫
->
ôem
[
ix
].
u
.
°rög
 = 
	`make_m°rög
(
¥zym
);

1919 
	`‰ì
(
¥zym
);

1923 
π∫
->
ôem
[
ix
].
ty≥
 = 
T_NUMBER
;

1924 
π∫
->
ôem
[
ix
].
u
.
numbî
 = 0;

1928  
π∫
;

1929 
	}
}

1942 
	$check_adje˘iv
(
ve˘‹
 *
adj1
, ve˘‹ *
adj2
, 
obix
,

1943 
ve˘‹
 *
wvec
, 
‰om
, 
to
, *
rodzaj
, 
∂ur
)

1945 
û
, 
back
, 
Áû
;

1946 *
ad°r
;

1947 
size_t
 
sum
;

1948 
ve˘‹
 *
ids
;

1949 
	`membî_°rög
(*, 
ve˘‹
 *);

1951 
ids
 = 
	`make_adje˘iv_li°
(
adj1
, 
adj2
, 
rodzaj
, 
∂ur
);

1953 i‡(!
ids
 || !ids->
size
)

1955 i‡(
ids
)

1956 
	`‰ì_ve˘‹
(
ids
);

1960 
sum
 = 0;

1961 
Áû
 = 0;

1962 
û
 = 
‰om
; il<
to
; il++)

1964 
sum
 +
	`°æí
(
wvec
->
ôem
[
û
].
u
.
°rög
) + 1;

1965 i‡(
	`membî_°rög
(
wvec
->
ôem
[
û
].
u
.
°rög
, 
ids
) < 0)

1967 
Áû
 = 1;

1973 i‡(!
Áû
)

1975 
	`‰ì_ve˘‹
(
ids
);

1979 i‡(
‰om
 =
to
)

1981 
	`‰ì_ve˘‹
(
ids
);

1985 
ad°r
 = 
	`Æloˇ
(
sum
);

2003 
û
 = 
‰om
; i»<
to
;)

2006 
back
 = 
to
; back >
û
; back--)

2011 ()
	`°r˝y
(
ad°r
, "");

2012 
sum
 = 
û
; sum <
back
; sum++)

2014 i‡(
sum
 > 
û
)

2015 ()
	`°rˇt
(
ad°r
, " ");

2016 ()
	`°rˇt
(
ad°r
, 
wvec
->
ôem
[
sum
].
u
.
°rög
);

2018 i‡(
	`membî_°rög
(
ad°r
, 
ids
) < 0)

2022 
û
 = 
back
 + 1;

2023 
back
 = 0;

2027 i‡(
back
)

2029 
	`‰ì_ve˘‹
(
ids
);

2034 
	`‰ì_ve˘‹
(
ids
);

2036 
	}
}

2047 
	$membî_°rög
(*
°r
, 
ve˘‹
 *
svec
)

2049 
û
;

2051 i‡(!
svec
)

2054 
û
 = 0; i»< 
svec
->
size
; il++)

2056 i‡(
svec
->
ôem
[
û
].
ty≥
 !
T_STRING
)

2059 i‡(
	`°rcmp
(
svec
->
ôem
[
û
].
u
.
°rög
, 
°r
) == 0)

2060  
û
;

2063 
	}
}

2066 
	$membî_¨øy
(*
°r
, *
¨r
[])

2068 
x
 = -1;

2071 
¨r
[++
x
][0] != '\0')

2072 i‡(
	`EQ
(
°r
, 
¨r
[
x
]))

2073  
x
;

2075 
	}
}

2078 #i‚de‡
PARSE_FOREIGN


2087 
	$∑r£_to_∂uøl
(*
°r
)

2089 
ve˘‹
 *
w‹ds
;

2090 
svÆue
 
°mp
;

2091 *
•l
;

2092 
û
, 
ch™ged
;

2093 *
	`∑r£_⁄e_∂uøl
(*);

2095 i‡(!(
	`°rchr
(
°r
,' ')))

2096  
	`make_m°rög
(
	`∑r£_⁄e_∂uøl
(
°r
));

2098 
w‹ds
 = 
	`ex∂ode_°rög
(
°r
, " ");

2099 #ifde‡
OLD_EXPLODE


2100 
û
 = 1;

2102 
û
 = 0 ; i»< 
w‹ds
->
size
 ; il++)

2103 i‡(*(
w‹ds
->
ôem
[
û
].
u
.
°rög
))

2105 
û
++;

2108 
ch™ged
 = 0; 
û
 < 
w‹ds
->
size
; il++)

2110 i‡((
	`EQ
(
w‹ds
->
ôem
[
û
].
u
.
°rög
,"of")) ||

2111 (
û
 + 1 =
w‹ds
->
size
))

2113 
•l
 = 
	`∑r£_⁄e_∂uøl
(
w‹ds
->
ôem
[
û
 - 1].
u
.
°rög
);

2114 i‡(
•l
 !
w‹ds
->
ôem
[
û
 - 1].
u
.
°rög
)

2116 
°mp
.
ty≥
 = 
T_STRING
;

2117 
°mp
.
°rög_ty≥
 = 
STRING_MSTRING
;

2118 
°mp
.
u
.
°rög
 = 
	`make_m°rög
(
•l
);

2119 
	`assign_svÆue
(&
w‹ds
->
ôem
[
û
 - 1], &
°mp
);

2120 
ch™ged
 = 1;

2121 
	`‰ì_svÆue
(&
°mp
);

2125 i‡(!
ch™ged
)

2127 
	`‰ì_ve˘‹
(
w‹ds
);

2128  
	`make_m°rög
(
°r
);

2130 
•l
 = 
	`im∂ode_°rög
(
w‹ds
, " ");

2131 
°r
 = 
	`make_m°rög
(
•l
);

2132 
	`‰ì
(
•l
);

2133 
	`‰ì_ve˘‹
(
w‹ds
);

2134  
°r
;

2135 
	}
}

2146 
	$∑r£_⁄e_∂uøl
(*
°r
)

2148 
ch
, 
ch2
, 
ch3
;

2149 
¶
;

2150 
pbuf
[100];

2152 
¶
 = 
	`°æí
(
°r
) - 1;

2153 i‡((
¶
 < 2) || (sl > 90))

2154  
°r
;

2156 
ch
 = 
°r
[
¶
];

2157 
ch2
 = 
°r
[
¶
 - 1];

2158 
ch3
 = 
°r
[
¶
 - 2];

2159 ()
	`°r˝y
(
pbuf
, 
°r
);Öbuf[
¶
] = 0;

2161 
ch
)

2164 i‡(
ch2
 == 's' || ch2 == 'c')

2165  
	`°rˇt
(
pbuf
, "hes");

2168  
	`°rˇt
(
pbuf
, "ves");

2170  
	`°rˇt
(
pbuf
, "ses");

2172 i‡(
	`EQ
(
°r
,"ox"))

2175  
	`°rˇt
(
pbuf
, "xes");

2177 i‡((
ch2
 != 'a' && ch2 != 'e' && ch2 != 'i' && ch2 != 'o' &&

2178 
ch2
 !'u'Ë|| (ch2 ='u' && 
ch3
 == 'q'))

2179  
	`°rˇt
(
pbuf
, "ies");

2182 i‡(
ch2
 == 'f')

2184 
pbuf
[
¶
 - 1] = 0;

2185  
	`°rˇt
(
pbuf
, "ves");

2189 i‡(
	`EQ
(
°r
,"corpse"))  "corpses";

2190 i‡(
	`EQ
(
°r
,"tooth"))  "teeth";

2191 i‡(
	`EQ
(
°r
,"foot"))  "feet";

2192 i‡(
	`EQ
(
°r
,"man"))  "men";

2193 i‡(
	`EQ
(
°r
,"woman"))  "women";

2194 i‡(
	`EQ
(
°r
,"child"))  "children";

2195 i‡(
	`EQ
(
°r
,"goose"))  "geese";

2196 i‡(
	`EQ
(
°r
,"mouse"))  "mice";

2197 i‡(
	`EQ
(
°r
,"deer"))  "deer";

2198 i‡(
	`EQ
(
°r
,"moose"))  "moose";

2199 i‡(
	`EQ
(
°r
,"sheep"))  "sheep";

2201 
pbuf
[
¶
] = 
ch
;

2202  
	`°rˇt
(
pbuf
, "s");

2203 
	}
}

2233 
	$¥o˚ss_°rög
(*
°r
, 
Ÿhî_ob
)

2235 
ve˘‹
 *
vec
;

2236 
obje˘
 *
ﬁd_cur
 = 
cuºít_obje˘
;

2237 
¥_°¨t
, 
û
, 
ch™ged
;

2238 *
p2
, *
p3
, *
buf
;

2239 *
	`¥o˚ss_∑π
(*, );

2241 i‡(
°r
 =
NULL
 || 
	`°rchr
(str,'@') == NULL)

2242  
°r
;

2248 i‡(!
cuºít_obje˘
)

2250 
cuºít_obje˘
 = 
comm™d_givî
;

2253 
vec
 = 
	`ex∂ode_°rög
(
°r
, "@@");

2257 #ifde‡
OLD_EXPLODE


2258 
¥_°¨t
 = ((
°r
[0] == '@') && (str[1] == '@')) ? 0 : 1;

2260 
¥_°¨t
 = 1;

2267 
ch™ged
 = 0, 
û
 = 
¥_°¨t
; i»< 
vec
->
size
; il += 2)

2269 
p2
 = 
	`¥o˚ss_∑π
(
vec
->
ôem
[
û
].
u
.
°rög
, 
Ÿhî_ob
);

2271 i‡(
p2
 =
vec
->
ôem
[
û
].
u
.
°rög
)

2276 
p3
 = 
	`xÆloc
(5 + 
	`°æí
(
p2
));

2277 ()
	`°r˝y
(
p3
, "@@");

2278 ()
	`°rˇt
(
p3
, 
p2
);

2279 ()
	`°rˇt
(
p3
, "@@");

2280 
p2
 = 
p3
;

2283 
ch™ged
 = 1;

2285 
	`‰ì_svÆue
(&
vec
->
ôem
[
û
]);

2286 
vec
->
ôem
[
û
].
ty≥
 = 
T_STRING
;

2287 
vec
->
ôem
[
û
].
°rög_ty≥
 = 
STRING_MSTRING
;

2288 
vec
->
ôem
[
û
].
u
.
°rög
 = 
	`make_m°rög
(
p2
);

2289 
	`‰ì
(
p2
);

2292 i‡(
ch™ged
)

2293 
buf
 = 
	`im∂ode_°rög
(
vec
, "");

2295 
buf
 = 
°r
;

2297 
	`‰ì_ve˘‹
(
vec
);

2299 
cuºít_obje˘
 = 
ﬁd_cur
;

2301  
buf
;

2302 
	}
}

2312 
	$¥o˚ss_∑π
(*
°r
, 
Ÿhî_ob
)

2314 
svÆue
 *
ªt
;

2315 
svÆue
 *
	`¥o˚ss_vÆue
(*, );

2317 i‡(!(*
°r
) || (str[0] < 'A') || (str[0] > 'z'))

2318  
°r
;

2320 
ªt
 = 
	`¥o˚ss_vÆue
(
°r
, 
Ÿhî_ob
);

2322 i‡((
ªt
Ë&& (ªt->
ty≥
 =
T_STRING
))

2323  
	`°rög_c›y
(
ªt
->
u
.
°rög
);

2325  
°r
;

2326 
	}
}

2335 
svÆue
 *

2336 
	$¥o˚ss_vÆue
(*
°r
, 
Ÿhî_ob
)

2338 
svÆue
 *
ªt
;

2339 *
func
, *
obj
, *
¨g
, *
«rg
;

2340 
num¨gs
;

2341 
obje˘
 *
ob
;

2343 i‡(!(*
°r
) || (str[0] < 'A') || (str[0] > 'z'))

2344  &
c⁄°0
;

2346 
func
 = (*Ë
	`Æloˇ
(
	`°æí
(
°r
) + 1);

2347 ()
	`°r˝y
(
func
, 
°r
);

2349 
¨g
 = 
	`°rchr
(
func
,'|'); if (arg) { *arg=0;árg++; }

2350 
obj
 = 
	`°rchr
(
func
,':'); if (obj) { *obj=0; obj++; }

2354 i‡(!
obj
)

2355 
ob
 = 
cuºít_obje˘
;

2357 
ob
 = 
	`föd_obje˘2
(
obj
);

2359 i‡(!
ob
)

2361  &
c⁄°0
;

2366 
num¨gs
 = 0; 
¨g
;árg = 
«rg
)

2368 
«rg
 = 
	`°rchr
(
¨g
,'|');

2369 i‡(
«rg
)

2370 *
«rg
 = 0;

2371 
	`push_°rög
(
¨g
, 
STRING_MSTRING
);

2372 
num¨gs
++;

2373 i‡(
«rg
)

2375 *
«rg
 = '|';

2376 
«rg
++;

2380 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

2381 
	`îr‹
("object used byÖrocess_string/process_value destructed\n");

2383 i‡(
Ÿhî_ob
)

2385 *
pc
;

2387 i‡(!
vbfc_obje˘
)

2388 
	`îr‹
("No vbfc object.\n");

2389 
	`push_c⁄åﬁ_°ack
(0);

2390 
cuºít_¥og
 = 
vbfc_obje˘
->
¥og
;

2391 
pc
 = 
vbfc_obje˘
->
¥og
->
¥ogøm
;

2392 
öh_off£t
 = 
cuºít_¥og
->
num_öhîôed
;

2393 
¥evious_ob
 = 
cuºít_obje˘
;

2394 
cuºít_obje˘
 = 
vbfc_obje˘
;

2395 
c•
->
ext_ˇŒ
 = 1;

2402 
ªt
 = 
	`≠∂y
(
func
, 
ob
, 
num¨gs
, 1);

2404 i‡(
Ÿhî_ob
)

2405 
	`p›_c⁄åﬁ_°ack
();

2407 i‡(!
ªt
)

2408  &
c⁄°0
;

2410  
ªt
;

2411 
	}
}

2426 
	$bªak_°rög
(*
°r
, 
width
, 
svÆue
 *
ödít
)

2428 *
f°r
, *
i°r
;

2429 
ve˘‹
 *
löes
;

2431 
û
, 
l
, 
nch¨
, 
•a˚
, 
ödÀn
;

2433 
f°r
 = 
	`°rög_c›y
(
°r
);

2435 i‡(!
ödít
)

2436 
i°r
 = 0;

2437 i‡(
ödít
->
ty≥
 =
T_NUMBER
 && indít->
u
.
numbî
 < 1000)

2439 
l
 = 
ödít
->
u
.
numbî
;

2440 
i°r
 = 
	`xÆloc
((
size_t
)
l
 + 1);

2441 
û
 = 0; i»< 
l
; il++)

2442 
i°r
[
û
] = ' ';

2443 
i°r
[
û
] = 0;

2445 i‡(
ödít
->
ty≥
 =
T_STRING
)

2446 
i°r
 = 
	`°rög_c›y
(
ödít
->
u
.
°rög
);

2448  
f°r
;

2450 i‡(
width
 < 1)

2451 
width
 = 1;

2453 i‡(
i°r
)

2455 
ödÀn
 = 
	`°æí
(
i°r
);

2456 i‡(
width
 <
ödÀn
)

2457 
width
 = 
ödÀn
 + 1;

2460 
ödÀn
 = 0;

2465 
•a˚
 = -1;

2466 
nch¨
 = 0;

2467 
l
 = 
	`°æí
(
f°r
);

2468 
û
 = 0; i»< 
l
; il++)

2470 i‡(
f°r
[
û
] == ' ')

2471 
•a˚
 = 
û
;

2473 i‡((
û
 - 
nch¨
Ë>(
width
 - 
ödÀn
Ë&& 
•a˚
 >= 0)

2475 
f°r
[
•a˚
] = '\n';

2476 
nch¨
 = 
•a˚
;

2477 
•a˚
 = -1;

2484 i‡(!
ödÀn
)

2486 i‡(
i°r
)

2487 
	`‰ì
(
i°r
);

2488  
f°r
;

2494 
löes
 = 
	`ex∂ode_°rög
(
f°r
, "\n");

2495 
•a˚
 = 
f°r
[
	`°æí
(fstr) - 1] == '\n';

2497 
	`‰ì
(
f°r
);

2502 
nch¨
 = 0, 
û
 = 0; i»< 
löes
->
size
; il++)

2504 
nch¨
 +
ödÀn
 + 
	`°æí
(
löes
->
ôem
[
û
].
u
.
°rög
) + 1;

2507 
f°r
 = 
	`xÆloc
((
size_t
)
nch¨
 + 1);

2508 
f°r
[0] = 0;

2510 
û
 = 0; i»< 
löes
->
size
 - 1; il++)

2512 ()
	`°rˇt
(
f°r
, 
i°r
);

2513 ()
	`°rˇt
(
f°r
, 
löes
->
ôem
[
û
].
u
.
°rög
);

2514 ()
	`°rˇt
(
f°r
, "\n");

2516 i‡(
löes
->
size
 > 0) {

2517 ()
	`°rˇt
(
f°r
, 
i°r
);

2518 ()
	`°rˇt
(
f°r
, 
löes
->
ôem
[
û
].
u
.
°rög
);

2520 i‡(
•a˚
)

2521 ()
	`°rˇt
(
f°r
, "\n");

2522 
	`‰ì
(
i°r
);

2523 
	`‰ì_ve˘‹
(
löes
);

2525  
f°r
;

2527 
	}
}

	@patchlevel.h

1 
	#PATCH_LEVEL
 6

	)

	@port.c

1 
	~<°dio.h
>

2 
	~<sys/ty≥s.h
>

3 
	~<sys/time.h
>

4 
	~<°dlib.h
>

5 
	~<time.h
>

6 
	~<sys/time.h
>

7 #ifde‡
RANDOM


8 
	~<m©h.h
>

11 
	~"c⁄fig.h
"

12 
	~"löt.h
"

14 #ifde‡
DRAND48


15 
	~"dønd48.h
"

18 #ifde‡
sun


19 
time_t
 
time
 (time_t *);

22 
øndom_Êﬂt
();

24 
cuºít_time
;

25 
Æ¨m_time
;

33 #ifde‡
RANDOM


34 
	g√w°©e
[] = {

52 
	$øndom_numbî
(
n
, 
£ed
)

54 #ifde‡
RANDOM


55 
∫d
;

56 *
ﬁd°©e
;

58 #ifde‡
DRAND48


59 
√w£ed
[3];

65 i‡(
n
 < 1)

66 
n
 = 1;

68 #ifde‡
RANDOM


69 i‡(
£ed
 == 0)

70  ()(
	`øndom
(Ë% 
n
);

77 
	`öô°©e
(
£ed
, (*)
√w°©e
, 128);

78 
ﬁd°©e
 = (*)
	`£t°©e
((*)
√w°©e
);

79 
∫d
 = 
	`øndom
(Ë% 
n
;

80 
	`£t°©e
(
ﬁd°©e
);

81  ()
∫d
;

84 #ifde‡
DRAND48


85 i‡(
£ed
 == 0)

86  ()(
	`dønd48
(Ë* 
n
);

89 
√w£ed
[0] = 
£ed
 & 0xffff;

90 
√w£ed
[2] = (()
£ed
 >> 16) & 0xffff;

91 
√w£ed
[1] =Çewseed[0] ^Çewseed[2];

92  ()(
	`î™d48
(
√w£ed
Ë* 
n
);

95 i‡(
£ed
 == 0)

96  
cuºít_time
 % 
n
;

98  
£ed
 % 
n
;

101 
	}
}

104 
	$øndom_Êﬂt
()

106 #ifde‡
RANDOM


107  
	`ldexp
(()
	`øndom
(), -32);

109  
	`dønd48
();

111 
	}
}

124 
	$£t_cuºít_time
()

126 
Æ¨m_ba£_time
, 
Æ¨m_œ°_time
;

127 
timevÆ
 
tv
;

129 ()
	`gëtimeofday
(&
tv
, 
NULL
);

131 i‡(
Æ¨m_ba£_time
 == 0)

132 
Æ¨m_ba£_time
 = 
tv
.
tv_£c
;

134 
Æ¨m_time
 = (
tv
.
tv_£c
 - 
Æ¨m_ba£_time
Ë* 
TIME_RES
 +

135 
tv
.
tv_u£c
 * 
TIME_RES
 / 1000000;

136 i‡(
Æ¨m_time
 < 
Æ¨m_œ°_time
) {

137 
Æ¨m_ba£_time
 -(
Æ¨m_œ°_time
 - 
Æ¨m_time
Ë/ 
TIME_RES
;

138 
Æ¨m_time
 +
Æ¨m_œ°_time
 -áœrm_timê+ 
TIME_RES
;

140 
Æ¨m_œ°_time
 = 
Æ¨m_time
;

141 
cuºít_time
 = 
tv
.
tv_£c
;

142 
	}
}

145 
	$time_°rög
(
t
)

147  
	`˘ime
((
time_t
 *)&
t
);

148 
	}
}

	@postlang.y

10 %
tokí
 
F_CASE
 
F_DEFAULT


14 
numbî
;

15 
ªÆ
;

16 
addªss
;

17 *
°rög
;

18 
ty≥
;

19 °ru˘ { 
key
; 
block
; } 
ˇ£_œbñ
;

20 
fun˘i⁄
 *
fu≈
;

23 %
ty≥
 <
numbî
> 
›t_öt
 
assign
 
F_NUMBER
 
c⁄°™t
 
F_LOCAL_NAME
 
ex¥_li°
 
fun›


24 %
ty≥
 <
numbî
> 
€x¥_li°
 
€x¥_li°1


25 %
ty≥
 <
numbî
> 
c⁄°1
 
c⁄°2
 
c⁄°3
 
c⁄°4
 
c⁄°5
 
c⁄°6
 
c⁄°7
 
c⁄°8
 
c⁄°9


26 %
ty≥
 <
numbî
> 
lvÆue_li°
 
fun_¨gs
 
¨gumít
Åy≥ 
basic_ty≥
 
›ti⁄Æ_°¨
 
ex¥_li°2


27 %
ty≥
 <
numbî
> 
ty≥_modifõr
 
ty≥_modifõr_li°
 
›t_basic_ty≥
 
block_‹_£mi


28 %
ty≥
 <
numbî
> 
¨gumít_li°
 
m_ex¥_li°
 
m_ex¥_li°2


29 %
ty≥
 <
numbî
> 
√w_loˇl_«me2


30 %
ty≥
 <
°rög
> 
idítifõr
 
fun_idítifõr
 
›t_öhîô_«me


31 %
ty≥
 <
°rög
> 
F_IDENTIFIER
 
F_STRING
 
°rög_c⁄1
 
°rög_c⁄°™t
 
fun˘i⁄_«me


32 %
ty≥
 <
ªÆ
> 
F_FLOATC


33 %
ty≥
 <
ˇ£_œbñ
> case_label

37 %
ty≥
 <ty≥> 
fun˘i⁄_ˇŒ
 
lvÆue
 
lvÆuec
 
°rög
 
ˇ°
 
ex¥01
 
comma_ex¥
 
rvÆue
 
funidít
 
fu√x¥
 
›t_ex¥01


38 %
ty≥
 <ty≥> 
ex¥2
 
ex¥211
 
ex¥1
 
ex¥212
 
ex¥213
 
ex¥24
 
ex¥22
 
ex¥23
 
ex¥25


39 %
ty≥
 <ty≥> 
ex¥27
 
ex¥28
 
ex¥3
 
ex¥31
 
ex¥4
 
numbî
 
ex¥0
 
ªÆ
 
ﬂrgs


43 
°‹e_ªloc_d©a
 (, , *
«me
, , );

44 
ös_f_byã
 ();

45 
compûe_fûe
 ();

46 
	gfú°_deÁu…_¨g
, 
	gcuºít_¨g
;

47 
	gis_˘‹
, 
	gis_dt‹
;

48 
	gblock_dïth
;

49 
	gªtu∫_œbñ
;

50 
	#CTOR_FUNC
 ((*)1)

	)

51 
	#DTOR_FUNC
 ((*)2)

	)

53 %% /* 
	$yy∑r£
 */ 
	`yyÀx
()

55 
Æl
: { 
öv¨ü¡_œ°_addªss
 = 0; 
block_dïth
 = 0; } 
¥ogøm
 ;

57 
¥ogøm
:Örogøm 
def
 
possibÀ_£mi_cﬁ⁄


60 
possibÀ_£mi_cﬁ⁄
:

61 | ';' { 
	`yyîr‹
("Extra ';'. Ignored."); };

63 
öhîô™˚
: 
ty≥_modifõr_li°
 
F_INHERIT
 
°rög_c⁄°™t
 
›t_öhîô_«me
 ';'

65 
obje˘
 *
ob
;

67 i‡(
mem_block
[
A_VARIABLES
].
cuºít_size
 ||

68 
mem_block
[
A_FUNCTIONS
].
cuºít_size
)

69 
	`yyîr‹
("Inheritáfter other definitions\n");

71 
ob
 = 
	`föd_obje˘2
(
$3
);

72 i‡(
ob
 == 0) {

73 i‡(
öhîô_fûe
)

74 
	`‰ì
(
öhîô_fûe
);

75 
öhîô_fûe
 = 
	`°rög_c›y
(
$3
);

77 
YYACCEPT
;

79 i‡(
ob
->
¥og
->
Êags
 & 
PRAGMA_NO_INHERIT
)

81 
	`yyîr‹
("Inheriting bad object.\n");

83 i‡(!
	`check_öhîôs
(
ob
->
¥og
))

85 i‡(
öhîô_fûe
)

86 
	`‰ì
(
öhîô_fûe
);

87 
öhîô_fûe
 = 
	`°rög_c›y
(
$3
);

89 
YYACCEPT
;

91 
	`c›y_öhîôs
(
ob
->
¥og
, 
$1
, 
$4
);

94 
›t_öhîô_«me
:

96 *
n
 = 
	`°ºchr
(
$
<
°rög
>0, '/');

97 i‡(
n
)

99 
$$
 = 
	`tmp°rög_c›y
(
n
 + 1);

102 
$$
 = 
	`tmp°rög_c›y
(
$
<
°rög
>0);

104 | 
F_IDENTIFIER


106 
$$
 = 
$1
;

109 
öv¨ü¡
: '<' '>' ':'

111 i‡(
öv¨ü¡_œ°_addªss
)

113 i‡(
öv¨ü¡_œ°_addªss
 + 2 ==

114 
mem_block
[
A_PROGRAM
].
cuºít_size
)

115 
mem_block
[
A_PROGRAM
].
cuºít_size
 -= 3;

117 
	`upd_sh‹t
(
öv¨ü¡_œ°_addªss
,

118 
mem_block
[
A_PROGRAM
].
cuºít_size
);

121 
öv¨ü¡_fú°_addªss
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

123 
ex¥0


125 
	`ös_f_byã
(
F_FAIL_INVARIANT
);

126 
	`ös_f_byã
(
F_JUMP
);

127 
öv¨ü¡_œ°_addªss
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

128 
	`ös_sh‹t
(0);

131 
¥e_c⁄dôi⁄
: 
F_LSH
 ':'

133 i‡(
¥e_c⁄d_œ°_addªss
) {

134 i‡(
¥e_c⁄d_œ°_addªss
 + 2 ==

135 
mem_block
[
A_PROGRAM
].
cuºít_size
)

136 
mem_block
[
A_PROGRAM
].
cuºít_size
 -= 3;

138 
	`upd_sh‹t
(
¥e_c⁄d_œ°_addªss
,

139 
mem_block
[
A_PROGRAM
].
cuºít_size
);

142 
¥e_c⁄d_fú°_addªss
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

144 i‡(
is_˘‹
)

146 
	`yyîr‹
("Constructors mayÇot haveÖreconditions");

149 
ex¥0


151 
	`ös_f_byã
(
F_FAIL_PRECOND
);

152 
	`ös_f_byã
(
F_JUMP
);

153 
¥e_c⁄d_œ°_addªss
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

154 
	`ös_sh‹t
(0);

157 
po°_c⁄dôi⁄
: 
F_RSH
 ':'

159 i‡(
po°_c⁄d_œ°_addªss
) {

160 i‡(
po°_c⁄d_œ°_addªss
 + 2 ==

161 
mem_block
[
A_PROGRAM
].
cuºít_size
)

162 
mem_block
[
A_PROGRAM
].
cuºít_size
 -= 3;

164 
	`upd_sh‹t
(
po°_c⁄d_œ°_addªss
,

165 
mem_block
[
A_PROGRAM
].
cuºít_size
);

168 
po°_c⁄d_fú°_addªss
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

170 i‡(
is_dt‹
)

172 
	`yyîr‹
("Destructors mayÇot haveÖostconditions");

175 
ex¥0


177 
	`ös_f_byã
(
F_FAIL_POSTCOND
);

178 
	`ös_f_byã
(
F_JUMP
);

179 
po°_c⁄d_œ°_addªss
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

180 
	`ös_sh‹t
(0);

183 
›t_öt
 : { 
$$
 = 1; }

184 | 
c⁄°™t


186 
as£πi⁄
 : '@' 
›t_öt
 ':'

188 
	`ös_f_byã
(
F_ASSERTION
);

189 
	`ös_sh‹t
(
$2
);

190 
	`push_addªss
();

191 
	`ös_sh‹t
(0);

193 
ex¥0


195 
	`ös_f_byã
(
F_FAIL_ASSERTION
);

196 
	`upd_sh‹t
(
	`p›_addªss
(), 
mem_block
[
A_PROGRAM
].
cuºít_size
);

199 
numbî
: 
F_NUMBER


201 i‡–
$1
 == 0 ) {

202 
	`ös_f_byã
(
F_CONST0
); 
$$
 = 
TYPE_ANY
;

203 } i‡–
$1
 == 1 ) {

204 
	`ös_f_byã
(
F_CONST1
); 
$$
 = 
TYPE_NUMBER
;

206 
	`ös_f_byã
(
F_NUMBER
); 
	`ös_l⁄g
(
$1
); 
$$
 = 
TYPE_NUMBER
;

210 
›ti⁄Æ_°¨
: { 
$$
 = 0; } | '*' { $$ = 
TYPE_MOD_POINTER
; } ;

212 
block_‹_£mi
: 
block
 { 
$$
 = 0; }

213 | ';' { 
$$
 = ';'; }

214 | '=' 
°rög_c⁄1
 ';' { 
$
<
°rög
>$ = $<string>2; };

215 | '=' 
F_NUMBER
 ';'

217 i‡(
$2
 != 0)

219 
	`yyîr‹
("SyntaxÉrror");

221 
$$
 = 1;

223 
›t_¥e_po°_c⁄d
 :

224 | 
¥e_po°_c⁄d
 ;

225 
¥e_po°_c⁄d
 : 
¥e_c⁄dôi⁄
 ';'

226 | 
po°_c⁄dôi⁄
 ';'

227 | 
¥e_po°_c⁄d
 
¥e_c⁄dôi⁄
 ';'

228 | 
¥e_po°_c⁄d
 
po°_c⁄dôi⁄
 ';' ;

230 
def
: 
ty≥
 
›ti⁄Æ_°¨
 
fun_idítifõr


233 
	`˛ór_öô_¨g_°ack
();

234 
dîef_ödex
 = 0;

235 
	`push_addªss
();

236 
åue_v¨¨gs
 = 0;

237 
¥e_c⁄d_fú°_addªss
 = 
¥e_c⁄d_œ°_addªss
 =

238 
po°_c⁄d_fú°_addªss
 = 
po°_c⁄d_œ°_addªss
 = 0;

239 
fú°_deÁu…_¨g
 = 
cuºít_¨g
 = 0;

240 
is_˘‹
 = 
is_dt‹
 = 0;

242 
ªtu∫_œbñ
 = 
	`make_œbñ
();

243 i‡(
$3
 =
CTOR_FUNC
)

245 
$3
 = 
	`tmp°rög_c›y
(".CTOR");

246 
is_˘‹
 = 1;

248 i‡(
$3
 =
DTOR_FUNC
)

250 
$3
 = 
	`tmp°rög_c›y
(".DTOR");

251 
is_dt‹
 = 1;

254 i‡(
is_˘‹
 | 
is_dt‹
)

256 i‡(
$1
 | 
$2
)

258 
	`yyîr‹
("Constructorsánd destructors don't haveáÅype");

259 
$1
 = 
$2
 = 0;

261 i‡(
¥agma_°ri˘_ty≥s
)

263 
$1
 = 
exa˘_ty≥s
 = 
TYPE_VOID
;

266 
exa˘_ty≥s
 = 0;

268 i‡(
$1
 & 
TYPE_MASK
)

270 
exa˘_ty≥s
 = 
$1
 | 
$2
;

274 i‡(
¥agma_°ri˘_ty≥s
)

275 
	`yyîr‹
("\"#pragma strict_types\"ÑequiresÅype of function");

276 
exa˘_ty≥s
 = 0;

279 
fun_¨gs


285 i‡(
$5
 && 
is_˘‹
 | 
is_dt‹
)

287 
	`yyîr‹
("Constructorsánd destructors don'tÅakeárguments");

290 
	`ös_f_byã
(
F_JUMP
);

291 
	`push_addªss
();

292 
	`ös_sh‹t
(0);

294 
›t_¥e_po°_c⁄d


296 
i
;

297 
j
;

298 
i
 = 
	`p›_addªss
();

299 
	`push_addªss
();

300 
	`dump_öô_¨g_èbÀ
(
$5
);

301 
j
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

302 
	`upd_sh‹t
(
i
, 
mem_block
[
A_PROGRAM
].
cuºít_size
);

303 ((*)
mem_block
[
A_PROGRAM
].
block
)[
i
] = ((*)&
j
)[0];

304 ((*)
mem_block
[
A_PROGRAM
].
block
)[
i
 + 1] = ((*)&
j
)[1];

305 
	`deföe_√w_fun˘i⁄
(
$3
, 
$5
, 0, 0,

306 
NAME_PROTOTYPE
 | 
$1
 | 
$2
 | 
åue_v¨¨gs
,

307 
fú°_deÁu…_¨g
);

308 i‡(
¥e_c⁄d_œ°_addªss
)

310 
	`ös_f_byã
(
F_DO_PRECOND
);

311 
	`ös_sh‹t
(
¥e_c⁄d_fú°_addªss
);

312 
	`upd_sh‹t
(
¥e_c⁄d_œ°_addªss
,

313 
mem_block
[
A_PROGRAM
].
cuºít_size
);

317 
block_‹_£mi


321 i‡(
$9
 == ';')

323 ()
	`p›_addªss
();

324 
mem_block
[
A_PROGRAM
].
cuºít_size
 =

325 
	`p›_addªss
();

327 i‡(
$9
 == 0)

329 
	`deföe_√w_fun˘i⁄
(
$3
, 
$5
, 
cuºít_numbî_of_loˇls
 - $5,

330 
	`p›_addªss
(), 
$1
 | 
$2
 | 
åue_v¨¨gs
,

331 
fú°_deÁu…_¨g
);

332 
	`ös_f_byã
(
F_CONST0
);

333 
	`£t_œbñ
(
ªtu∫_œbñ
, 
mem_block
[
A_PROGRAM
].
cuºít_size
);

334 i‡(
po°_c⁄d_œ°_addªss
)

336 
	`ös_f_byã
(
F_DO_POSTCOND
);

337 
	`ös_sh‹t
(
po°_c⁄d_fú°_addªss
);

338 
	`upd_sh‹t
(
po°_c⁄d_œ°_addªss
,

339 
mem_block
[
A_PROGRAM
].
cuºít_size
);

342 i‡(!
is_dt‹
)

343 
	`ös_f_byã
(
F_DO_INVARIANTS
);

345 
	`ös_f_byã
(
F_RETURN
);

346 ()
	`p›_addªss
();

348 i‡(
$9
 == 1)

350 i‡(
is_˘‹
 | 
is_dt‹
)

351 
	`yyîr‹
("Constructorsánd destructors can't beábstract");

352 
	`deföe_√w_fun˘i⁄
(
$3
, 
$5
, 0, 0,

353 
NAME_ABSTRACT
 | 
$1
 | 
$2
 | 
åue_v¨¨gs
,

354 
fú°_deÁu…_¨g
);

355 
	`yyîr‹
("Abstract functionsáren't implemented yet");

359 (* 
	`gë_C_fun_addªss
(*, *))(
svÆue
 *);

360 (*
funˇ
)(
svÆue
 *);

362 
	`deföe_√w_fun˘i⁄
(
$3
, 
$5
, 
cuºít_numbî_of_loˇls
 - $5,

363 
	`p›_addªss
(), 
$1
 | 
$2
 | 
åue_v¨¨gs
,

364 
fú°_deÁu…_¨g
);

365 
	`ös_f_byã
(
F_CALL_C
);

366 
funˇ
 = 
	`gë_C_fun_addªss
(
cuºít_fûe
, 
$
<
°rög
>9);

367 i‡(!
funˇ
)

369 
buf
[256];

371 ()
	`¢¥ötf
(
buf
, (buf), "Undefined interface %s() = \"%s\".\n",

372 
$3
, 
$
<
°rög
>9);

373 
	`yyîr‹
(
buf
);

375 #
ifdef
 
__Æpha


376 
	`ös_l⁄g
(()(()
funˇ
 & 0xffffffff));

377 
	`ös_l⁄g
(()(()
funˇ
 >> 32));

379 
	`ös_l⁄g
(()()
funˇ
);

380 #
ídif


381 i‡(!
is_dt‹
)

382 
	`ös_f_byã
(
F_DO_INVARIANTS
);

383 
	`ös_f_byã
(
F_RETURN
);

384 ()
	`p›_addªss
();

386 
	`‰ì_Æl_loˇl_«mes
();

387 
is_˘‹
 = 
is_dt‹
 = 0;

389 | 
ty≥
 
«me_li°
 ';' { i‡(
$1
 =0Ë
	`yyîr‹
("MissingÅype"); }

390 | 
öhîô™˚
 ;

391 | 
öv¨ü¡
 ';'

393 
√w_¨g_«me
: 
ty≥
 
›ti⁄Æ_°¨
 
F_IDENTIFIER


395 i‡(
exa˘_ty≥s
 && 
$1
 == 0) {

396 
	`yyîr‹
("MissingÅype forárgument");

397 ()
	`add_loˇl_«me
(
$3
, 
TYPE_ANY
);

399 ()
	`add_loˇl_«me
(
$3
, 
$1
 | 
$2
);

401 i‡(
fú°_deÁu…_¨g
 !
cuºít_¨g
)

402 
	`yyîr‹
("non defaultárgument definedáfter default one");

404 
fú°_deÁu…_¨g
++;

405 
	`push_öô_¨g_addªss
(
mem_block
[
A_PROGRAM
].
cuºít_size
);

407 | 
ty≥
 
F_LOCAL_NAME


408 {
	`yyîr‹
("IllegalÅoÑedeclareÜocalÇame"); } ;

409 | 
ty≥
 
›ti⁄Æ_°¨
 
F_IDENTIFIER


411 
v¨_num
;

412 i‡(
exa˘_ty≥s
 && 
$1
 == 0) {

413 
	`yyîr‹
("MissingÅype forárgument");

414 
v¨_num
 = 
	`add_loˇl_«me
(
$3
, 
TYPE_ANY
);

416 
v¨_num
 = 
	`add_loˇl_«me
(
$3
, 
$1
 | 
$2
);

418 
	`push_öô_¨g_addªss
(
mem_block
[
A_PROGRAM
].
cuºít_size
);

419 
	`ös_f_byã
(
F_PUSH_LOCAL_VARIABLE_LVALUE
);

420 
	`ös_byã
(
v¨_num
);

422 '=' 
ex¥0


424 i‡(!
	`com∑tibÀ_ty≥s
(((
$1
 ? $1 : 
TYPE_ANY
Ë| 
$2
Ë& 
TYPE_MASK
, 
$6
)){

425 
buff
[100];

427 ()
	`¢¥ötf
(
buff
, (buff), "Type mismatch %s when initializing %s",

428 
	`gë_two_ty≥s
(
$1
 | 
$2
, 
$6
), 
$3
);

429 
	`yyîr‹
(
buff
);

431 
	`ös_f_byã
(
F_ASSIGN
);

432 
	`ös_f_byã
(
F_POP_VALUE
);

434 | 
ty≥
 
F_LOCAL_NAME
 '=' 
ex¥0


435 {
	`yyîr‹
("IllegalÅoÑedeclareÜocalÇame"); } ;

437 
fun_¨gs
: '(' ')' { 
$$
 = 0; }

438 | '(' 
¨gumít
 ')' { 
$$
 = 
$2
; }

439 | '(' 
F_VOID
 ')' { 
$$
 = 0; }

441 
¨gumít
: 
¨gumít_li°
 ;

442 | 
¨gumít_li°
 ',' 
F_VARARG


444 
åue_v¨¨gs
 = 
TYPE_MOD_TRUE_VARARGS
;

445 
$$
 = 
$1
 + 1;

446 
	`push_öô_¨g_addªss
(
mem_block
[
A_PROGRAM
].
cuºít_size
);

447 
	`ös_f_byã
(
F_PUSH_LOCAL_VARIABLE_LVALUE
);

448 
	`ös_byã
(
	`add_loˇl_«me
(
	`tmp°rög_c›y
("¨gv"), 
TYPE_ANY
 | 
TYPE_MOD_POINTER
));

449 
	`ös_f_byã
(
F_AGGREGATE
);

450 
	`ös_sh‹t
(0);

451 
	`ös_f_byã
(
F_ASSIGN
);

452 
	`ös_f_byã
(
F_POP_VALUE
);

453 
cuºít_¨g
++;

456 
¨gumít_li°
: 
√w_¨g_«me
 { 
$$
 = 1; 
cuºít_¨g
++; }

457 | 
¨gumít_li°
 ',' 
√w_¨g_«me
 { 
$$
 = 
$1
 + 1; 
cuºít_¨g
++; } ;

459 
ty≥_modifõr
: 
F_NO_MASK
 { 
$$
 = 
TYPE_MOD_NO_MASK
; }

460 | 
F_STATIC
 { 
$$
 = 
TYPE_MOD_STATIC
; }

461 | 
F_PRIVATE
 { 
$$
 = 
TYPE_MOD_PRIVATE
; }

462 | 
F_PUBLIC
 { 
$$
 = 
TYPE_MOD_PUBLIC
; }

463 | 
F_VARARGS
 { 
$$
 = 
TYPE_MOD_VARARGS
; } ;

465 
ty≥_modifõr_li°
: { 
$$
 = 0; }

466 | 
ty≥_modifõr
 
ty≥_modifõr_li°
 { 
$$
 = 
$1
 | 
$2
; } ;

468 
ty≥
: 
ty≥_modifõr_li°
 
›t_basic_ty≥
 { 
$$
 = 
$1
 | 
$2
; 
cuºít_ty≥
 = $$; } ;

470 
ˇ°
: '(' 
basic_ty≥
 
›ti⁄Æ_°¨
 ')'

472 
$$
 = 
$2
 | 
$3
;

475 
›t_basic_ty≥
: 
basic_ty≥
 | { 
$$
 = 
TYPE_UNKNOWN
; } ;

477 
basic_ty≥
: 
F_STATUS
 { 
$$
 = 
TYPE_NUMBER
; 
cuºít_ty≥
 = $$; }

478 | 
F_INT
 { 
$$
 = 
TYPE_NUMBER
; 
cuºít_ty≥
 = $$; }

479 | 
F_STRING_DECL
 { 
$$
 = 
TYPE_STRING
; 
cuºít_ty≥
 = $$; }

480 | 
F_OBJECT
 { 
$$
 = 
TYPE_OBJECT
; 
cuºít_ty≥
 = $$; }

481 | 
F_VOID
 {
$$
 = 
TYPE_VOID
; 
cuºít_ty≥
 = $$; }

482 | 
F_MIXED
 { 
$$
 = 
TYPE_ANY
; 
cuºít_ty≥
 = $$; }

483 | 
F_MAPPING
 { 
$$
 = 
TYPE_MAPPING
; 
cuºít_ty≥
 = $$; }

484 | 
F_FLOAT
 { 
$$
 = 
TYPE_FLOAT
; 
cuºít_ty≥
 = $$; }

485 | 
F_FUNCTION
 { 
$$
 = 
TYPE_FUNCTION
; 
cuºít_ty≥
 = $$; };

487 
«me_li°
: 
√w_«me


488 | 
√w_«me
 ',' 
«me_li°
;

490 
√w_«me
: 
›ti⁄Æ_°¨
 
F_IDENTIFIER


492 
	`deföe_v¨übÀ
(
$2
, 
cuºít_ty≥
 | 
$1
);

494 | 
›ti⁄Æ_°¨
 
F_IDENTIFIER


496 
	`deföe_v¨übÀ
(
$2
, 
cuºít_ty≥
 | 
$1
);

497 
	`å™s„r_öô_c⁄åﬁ
();

498 
	`ös_f_byã
(
F_PUSH_IDENTIFIER_LVALUE
);

499 
	`ös_byã
(
v¨übÀ_öhîô_found
);

500 
	`ös_byã
(
v¨übÀ_ödex_found
);

502 '=' 
ex¥0


504 i‡(
¥agma_°ri˘_ty≥s
 &&

505 !
	`com∑tibÀ_ty≥s
((
cuºít_ty≥
 | 
$1
Ë& 
TYPE_MASK
, 
$5
)){

506 
buff
[100];

508 ()
	`¢¥ötf
(
buff
, (buff), "Type mismatch %s when initializing %s",

509 
	`gë_two_ty≥s
(
cuºít_ty≥
 | 
$1
, 
$5
), 
$2
);

510 
	`yyîr‹
(
buff
);

512 
	`ös_f_byã
(
F_ASSIGN
);

513 
	`ös_f_byã
(
F_POP_VALUE
);

514 
	`add_√w_öô_jump
();

517 
block
: '{'

519 
block_dïth
++;

521 
loˇl_de˛¨©i⁄s
 
°©emíts
 '}'

523 
i
;

524 
block_dïth
--;

525 
i
 = 
cuºít_numbî_of_loˇls
 - 1; i >= 0 &&

526 (
loˇl_blockdïth
[
i
] == -1 ||

527 
loˇl_blockdïth
[
i
] > 
block_dïth
); i-- )

528 
loˇl_blockdïth
[
i
] = -1;

531 
loˇl_de˛¨©i⁄s
:

532 | 
loˇl_de˛¨©i⁄s
 
basic_ty≥
 
loˇl_«me_li°
 ';' ;

535 
√w_loˇl_«me2
: 
›ti⁄Æ_°¨
 
F_IDENTIFIER


537 
$$
 = 
	`add_loˇl_«me
(
$2
, 
cuºít_ty≥
 | 
$1
);

539 | 
›ti⁄Æ_°¨
 
F_LOCAL_NAME


541 i‡(
loˇl_blockdïth
[
$2
] < 
block_dïth
)

543 i‡(!
loˇl_blockdïth
[
$2
])

545 
tbuf
[0x100];

547 ()
	`¢¥ötf
(
tbuf
, (tbuf),

549 
loˇl_«mes
[
$2
]);

550 
	`yyîr‹
(
tbuf
);

553 
$$
 = 
	`add_loˇl_«me
(
	`tmp°rög_c›y
(
loˇl_«mes
[
$2
]),

554 
cuºít_ty≥
 | 
$1
);

558 
buff
[100];

560 ()
	`¢¥ötf
(
buff
, (buff), "redefinition of variable '%s'",

561 
loˇl_«mes
[
$2
]);

562 
	`yyîr‹
(
buff
);

563 
$$
 = 
$2
;

568 
√w_loˇl_«me
: 
√w_loˇl_«me2


570 | 
√w_loˇl_«me2


572 
	`ös_f_byã
(
F_PUSH_LOCAL_VARIABLE_LVALUE
);

573 
	`ös_byã
(
$1
);

575 '=' 
ex¥0


577 i‡(
exa˘_ty≥s
 &&

578 !
	`com∑tibÀ_ty≥s
(
ty≥_of_loˇls
[
$1
] & 
TYPE_MASK
, 
$4
))

580 
buff
[100];

582 ()
	`¢¥ötf
(
buff
, (buff),

584 
	`gë_two_ty≥s
(
ty≥_of_loˇls
[
$1
], 
$4
),

585 
loˇl_«mes
[
$1
]);

586 
	`yyîr‹
(
buff
);

588 
	`ös_f_byã
(
F_ASSIGN
);

589 
	`ös_f_byã
(
F_POP_VALUE
);

593 
loˇl_«me_li°
: 
√w_loˇl_«me


594 | 
√w_loˇl_«me
 ',' 
loˇl_«me_li°
 ;

596 
°©emíts
:

597 | 
°©emít
 
°©emíts


598 | 
îr‹
 ';' ;

600 
°©emít
: 
comma_ex¥
 ';'

602 
	`ös_f_byã
(
F_POP_VALUE
);

603 #
ifdef
 
DEBUG


604 i‡(
d_Êag
 & 
DEBUG_BREAK_POINT
)

605 
	`ös_f_byã
(
F_BREAK_POINT
);

606 #
ídif


610 | 
c⁄d
 | | do | | | |  |  ';'

611 | 
block
 | 
as£πi⁄
 ';'

613 | 
F_BREAK
 ';'

615 i‡(
cuºít_bªak_addªss
 == 0)

616 
	`yyîr‹
("break statement outsideÜoop");

617 
	`ös_f_byã
(
F_JUMP
);

618 
	`add_jump
();

619 
	`ös_œbñ
(
cuºít_bªak_addªss
);

621 | 
F_CONTINUE
 ';'

623 i‡(
cuºít_c⁄töue_addªss
 == 0)

624 
	`yyîr‹
("continue statement outsideÜoop");

625 
	`ös_f_byã
(
F_JUMP
);

626 
	`add_jump
();

627 
	`ös_œbñ
(
cuºít_c⁄töue_addªss
);

631 : { 
	`push_ex∂icô
(
cuºít_c⁄töue_addªss
);

632 
	`push_ex∂icô
(
cuºít_bªak_addªss
);

633 
cuºít_c⁄töue_addªss
 = 
	`make_œbñ
();

634 
cuºít_bªak_addªss
 = 
	`make_œbñ
();

635 
	`£t_œbñ
(
cuºít_c⁄töue_addªss
, 
mem_block
[
A_PROGRAM
].
cuºít_size
);

636 } 
F_WHILE
 '(' 
comma_ex¥
 ')'

638 
	`ös_f_byã
(
F_JUMP_WHEN_ZERO
);

639 
	`add_jump
();

640 
	`ös_œbñ
(
cuºít_bªak_addªss
);

642 
°©emít


644 
	`ös_f_byã
(
F_JUMP
);

645 
	`add_jump
();

646 
	`ös_œbñ
(
cuºít_c⁄töue_addªss
);

647 
	`£t_œbñ
(
cuºít_bªak_addªss
, 
mem_block
[
A_PROGRAM
].
cuºít_size
);

648 
cuºít_bªak_addªss
 = 
	`p›_addªss
();

649 
cuºít_c⁄töue_addªss
 = 
	`p›_addªss
();

653 
	`push_ex∂icô
(
cuºít_c⁄töue_addªss
);

654 
	`push_ex∂icô
(
cuºít_bªak_addªss
);

655 
cuºít_c⁄töue_addªss
 = 
	`make_œbñ
();

656 
cuºít_bªak_addªss
 = 
	`make_œbñ
();

657 
	`push_addªss
();

659 
F_DO
 
°©emít


661 
	`£t_œbñ
(
cuºít_c⁄töue_addªss
, 
mem_block
[
A_PROGRAM
].
cuºít_size
);

663 
F_WHILE
 '(' 
comma_ex¥
 ')' ';'

665 
	`ös_f_byã
(
F_JUMP_WHEN_NON_ZERO
);

666 
	`add_jump
();

667 
	`ös_sh‹t
(
	`p›_addªss
());

668 
	`£t_œbñ
(
cuºít_bªak_addªss
, 
mem_block
[
A_PROGRAM
].
cuºít_size
);

669 
cuºít_bªak_addªss
 = 
	`p›_addªss
();

670 
cuºít_c⁄töue_addªss
 = 
	`p›_addªss
();

673 : 
F_FOR
 '(' { 
	`push_ex∂icô
(
cuºít_c⁄töue_addªss
);

674 
	`push_ex∂icô
(
cuºít_bªak_addªss
); }

675 
f‹_ex¥
 ';' {

676 
	`push_addªss
();

678 
f‹_gu¨d
 ';' {

679 
	`push_addªss
();

680 
	`ös_sh‹t
(0);

681 
cuºít_c⁄töue_addªss
 = 
	`make_œbñ
();

682 
cuºít_bªak_addªss
 = 
	`make_œbñ
();

683 
	`ös_f_byã
(
F_JUMP
);

684 
	`add_jump
();

685 
	`ös_œbñ
(
cuºít_bªak_addªss
);

686 
	`£t_œbñ
(
cuºít_c⁄töue_addªss
, 
mem_block
[
A_PROGRAM
].
cuºít_size
);

688 
f‹_ex¥
 ')' {

689 
	`upd_sh‹t
(
	`p›_addªss
(), 
mem_block
[
A_PROGRAM
].
cuºít_size
 + 3);

690 
	`ös_f_byã
(
F_JUMP
);

691 
	`add_jump
();

692 
	`ös_sh‹t
(
	`p›_addªss
());

694 
°©emít


696 
	`ös_f_byã
(
F_JUMP
);

697 
	`add_jump
();

698 
	`ös_œbñ
(
cuºít_c⁄töue_addªss
);

699 
	`£t_œbñ
(
cuºít_bªak_addªss
, 
mem_block
[
A_PROGRAM
].
cuºít_size
);

700 
cuºít_bªak_addªss
 = 
	`p›_addªss
();

701 
cuºít_c⁄töue_addªss
 = 
	`p›_addªss
();

704 
f‹_gu¨d
:

706 
	`ös_f_byã
(
F_JUMP
);

707 
	`add_jump
();

709 | 
comma_ex¥


711 
	`ös_f_byã
(
F_JUMP_WHEN_NON_ZERO
);

712 
	`add_jump
();

716 
f‹_ex¥
:

717 | 
comma_ex¥
 { 
	`ös_f_byã
(
F_POP_VALUE
); } ;

719 : 
F_SWITCH
 '(' 
comma_ex¥
 ')'

722 
	`push_ex∂icô
(
cuºít_ˇ£_numbî_hóp
);

723 
	`push_ex∂icô
(
cuºít_ˇ£_°rög_hóp
);

724 
	`push_ex∂icô
(
zîo_ˇ£_œbñ
);

725 
	`push_ex∂icô
(
cuºít_bªak_addªss
);

726 
	`push_ex∂icô
(
cuºít_ˇ£_addªss
);

728 
	`ös_f_byã
(
F_SWITCH
);

729 
cuºít_ˇ£_addªss
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

730 
	`ös_byã
(()0xff);

731 
cuºít_ˇ£_numbî_hóp
 = 
mem_block
[
A_CASE_NUMBERS
].
cuºít_size
;

732 
cuºít_ˇ£_°rög_hóp
 = 
mem_block
[
A_CASE_STRINGS
].
cuºít_size
;

733 
zîo_ˇ£_œbñ
 = 
NO_STRING_CASE_LABELS
;

734 
	`ös_sh‹t
(0);

735 
	`ös_sh‹t
(0);

736 
	`ös_sh‹t
(0);

738 
cuºít_bªak_addªss
 = 
	`make_œbñ
();

740 
°©emít


742 
block_ödex
;

743 
cuºít_ˇ£_hóp
;

744 
deÁu…_addr
;

750 i‡(!(
deÁu…_addr
 = 
	`ªad_sh‹t
(
cuºít_ˇ£_addªss
 + 5)))

752 
	`upd_sh‹t
(
cuºít_ˇ£_addªss
 + 5,

753 
mem_block
[
A_PROGRAM
].
cuºít_size
);

754 
deÁu…_addr
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

757 
	`ös_f_byã
(
F_JUMP
);

758 
	`add_jump
();

759 
	`ös_œbñ
(
cuºít_bªak_addªss
);

762 
	`upd_sh‹t
(
cuºít_ˇ£_addªss
 + 1,

763 
mem_block
[
A_PROGRAM
].
cuºít_size
);

766 i‡(
zîo_ˇ£_œbñ
 & (
NO_STRING_CASE_LABELS
|
SOME_NUMERIC_CASE_LABELS
))

768 
block_ödex
 = 
A_CASE_NUMBERS
;

769 
cuºít_ˇ£_hóp
 = 
cuºít_ˇ£_numbî_hóp
;

770 
mem_block
[
A_PROGRAM
].
block
[
cuºít_ˇ£_addªss
] = 0;

774 
block_ödex
 = 
A_CASE_STRINGS
;

775 
cuºít_ˇ£_hóp
 = 
cuºít_ˇ£_°rög_hóp
;

776 
mem_block
[
A_PROGRAM
].
block
[
cuºít_ˇ£_addªss
] = 1;

777 i‡(
zîo_ˇ£_œbñ
 & 0xffff)

779 
	`ös_l⁄g
(0);

780 
	`ös_sh‹t
(
zîo_ˇ£_œbñ
);

784 
	`ös_l⁄g
(0);

785 
	`ös_sh‹t
(
deÁu…_addr
);

791 
ˇ£_hóp_íåy
 *
ít
, *
íd
;

793 
ít
 = (
ˇ£_hóp_íåy
 *)

794 (
mem_block
[
block_ödex
].
block
 + 
cuºít_ˇ£_hóp
);

795 
íd
 = (
ˇ£_hóp_íåy
 *)

796 (
mem_block
[
block_ödex
].
block
 +

797 
mem_block
[
block_ödex
].
cuºít_size
);

798 ; 
ít
 < 
íd
;Ént++)

800 
	`ös_l⁄g
(
ít
->
key
);

801 
	`ös_sh‹t
(
ít
->
addr
);

806 
	`upd_sh‹t
(
cuºít_ˇ£_addªss
 + 3,

807 
mem_block
[
A_PROGRAM
].
cuºít_size
);

808 
	`£t_œbñ
(
cuºít_bªak_addªss
,

809 
mem_block
[
A_PROGRAM
].
cuºít_size
);

812 
mem_block
[
A_CASE_NUMBERS
].
cuºít_size
 = 
cuºít_ˇ£_numbî_hóp
;

813 
mem_block
[
A_CASE_STRINGS
].
cuºít_size
 = 
cuºít_ˇ£_°rög_hóp
;

814 
cuºít_ˇ£_addªss
 = 
	`p›_addªss
();

815 
cuºít_bªak_addªss
 = 
	`p›_addªss
();

816 
zîo_ˇ£_œbñ
 = 
	`p›_addªss
();

817 
cuºít_ˇ£_°rög_hóp
 = 
	`p›_addªss
();

818 
cuºít_ˇ£_numbî_hóp
 = 
	`p›_addªss
();

822 : 
F_CASE
 
ˇ£_œbñ
 ':'

825 
ˇ£_hóp_íåy
 
ãmp
;

827 i‡–!
cuºít_ˇ£_addªss
 )

829 
	`yyîr‹
("Case outside switch");

832 
ãmp
.
key
 = 
$2
.key;

833 
ãmp
.
addr
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

834 
ãmp
.
löe
 = 
cuºít_löe
;

835 
	`add_to_ˇ£_hóp
(
$2
.
block
,&
ãmp
, 
NULL
);

838 | 
F_CASE
 
ˇ£_œbñ
 
F_RANGE
 case_label ':'

841 
ˇ£_hóp_íåy
 
ãmp1
, 
ãmp2
;

843 i‡–!
cuºít_ˇ£_addªss
)

845 
	`yyîr‹
("Case outside switch");

849 i‡(
$2
.
block
 !
$4
.block)

850 
	`yyîr‹
("IncompatibleÅypes in caseÜabelÑange bounds");

853 
ãmp1
.
key
 = 
$2
.key;

854 
ãmp1
.
addr
 = -1;

855 
ãmp1
.
löe
 = 
cuºít_löe
;

856 
ãmp2
.
key
 = 
$4
.key;

857 
ãmp2
.
addr
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

858 
ãmp2
.
löe
 = 
cuºít_löe
;

859 
	`add_to_ˇ£_hóp
(
$2
.
block
, &
ãmp1
, &
ãmp2
);

864 
ˇ£_œbñ
: 
c⁄°™t


866 i‡–!(
zîo_ˇ£_œbñ
 & 
NO_STRING_CASE_LABELS
) )

867 
	`yyîr‹
("Mixed caseÜabelÜistÇotállowed");

868 i‡–(
$$
.
key
 = 
$1
) != 0 )

869 
zîo_ˇ£_œbñ
 |
SOME_NUMERIC_CASE_LABELS
;

871 
zîo_ˇ£_œbñ
 |
mem_block
[
A_PROGRAM
].
cuºít_size
;

872 
$$
.
block
 = 
A_CASE_NUMBERS
;

874 | 
°rög_c⁄°™t


876 i‡–
zîo_ˇ£_œbñ
 & 
SOME_NUMERIC_CASE_LABELS
 )

877 
	`yyîr‹
("Mixed caseÜabelÜistÇotállowed");

878 
zîo_ˇ£_œbñ
 &~
NO_STRING_CASE_LABELS
;

879 
$$
.
key
 = ()
	`°‹e_¥og_°rög
(
$1
);

880 
$$
.
block
 = 
A_CASE_STRINGS
;

884 
c⁄°™t
: 
c⁄°1


885 | 
c⁄°™t
 '|' 
c⁄°1
 { 
$$
 = 
$1
 | 
$3
; } ;

887 
c⁄°1
: 
c⁄°2


888 | 
c⁄°1
 '^' 
c⁄°2
 { 
$$
 = 
$1
 ^ 
$3
; } ;

890 
c⁄°2
: 
c⁄°3


891 | 
c⁄°2
 '&' 
c⁄°3
 { 
$$
 = 
$1
 & 
$3
; } ;

893 
c⁄°3
: 
c⁄°4


894 | 
c⁄°3
 
F_EQ
 
c⁄°4
 { 
$$
 = 
$1
 =
$3
; }

895 | 
c⁄°3
 
F_NE
 
c⁄°4
 { 
$$
 = 
$1
 !
$3
; } ;

897 
c⁄°4
: 
c⁄°5


898 | 
c⁄°4
 '>' 
c⁄°5
 { 
$$
 = 
$1
 > 
$3
; }

899 | 
c⁄°4
 
F_GE
 
c⁄°5
 { 
$$
 = 
$1
 >
$3
; }

900 | 
c⁄°4
 '<' 
c⁄°5
 { 
$$
 = 
$1
 < 
$3
; }

901 | 
c⁄°4
 
F_LE
 
c⁄°5
 { 
$$
 = 
$1
 <
$3
; } ;

903 
c⁄°5
: 
c⁄°6


904 | 
c⁄°5
 
F_LSH
 
c⁄°6
 { 
$$
 = 
$1
 << 
$3
; }

905 | 
c⁄°5
 
F_RSH
 
c⁄°6
 { 
$$
 = ()
$1
 >> 
$3
; } ;

907 
c⁄°6
: 
c⁄°7


908 | 
c⁄°6
 '+' 
c⁄°7
 { 
$$
 = 
$1
 + 
$3
; }

909 | 
c⁄°6
 '-' 
c⁄°7
 { 
$$
 = 
$1
 - 
$3
; } ;

911 
c⁄°7
: 
c⁄°8


912 | 
c⁄°7
 '*' 
c⁄°8
 { 
$$
 = 
$1
 * 
$3
; }

913 | 
c⁄°7
 
F_MOD
 
c⁄°8
 { 
$$
 = 
$1
 % 
$3
; }

914 | 
c⁄°7
 '/' 
c⁄°8
 { 
$$
 = 
$1
 / 
$3
; } ;

916 
c⁄°8
: 
c⁄°9


917 | '(' 
c⁄°™t
 ')' { 
$$
 = 
$2
; } ;

919 
c⁄°9
: 
F_NUMBER


920 | '-' 
F_NUMBER
 { 
$$
 = -
$2
; }

921 | 
F_NOT
 
F_NUMBER
 { 
$$
 = !
$2
; }

922 | '~' 
F_NUMBER
 { 
$$
 = ~
$2
; } ;

924 : 
F_DEFAULT
 ':'

926 i‡–!
cuºít_ˇ£_addªss
)

928 
	`yyîr‹
("Default outside switch");

931 i‡–
	`ªad_sh‹t
(
cuºít_ˇ£_addªss
 + 5 ) )

932 
	`yyîr‹
("Duplicate default");

933 
	`upd_sh‹t
(
cuºít_ˇ£_addªss
 + 5,

934 
mem_block
[
A_PROGRAM
].
cuºít_size
);

938 
comma_ex¥
: 
ex¥0
 { 
$$
 = 
$1
; }

939 | 
comma_ex¥
 { 
	`ös_f_byã
(
F_POP_VALUE
); }

940 ',' 
ex¥0


941 { 
$$
 = 
$4
; } ;

943 
ex¥0
: 
ex¥01


944 | 
lvÆue
 
assign
 
ex¥0


946 
dîef_ödex
--;

947 i‡(!(
$1
 & 
TYPE_LVALUE
))

948 
	`yyîr‹
("Illegal LHS");

949 
$1
 &~
TYPE_LVALUE
;

950 i‡(
exa˘_ty≥s
 && !
	`com∑tibÀ_ty≥s
(
$1
, 
$3
) &&

951 !(
$1
 =
TYPE_STRING
 && 
$3
 =
TYPE_NUMBER
 && 
$2
 =
F_ADD_EQ
))

953 
	`ty≥_îr‹
("Badássignmít. Rhs", 
$3
);

955 
	`ös_f_byã
(()
$2
);

956 
$$
 = 
$3
;

958 | 
îr‹
 
assign
 
ex¥01
 { 
	`yyîr‹
("IŒegÆ LHS"); 
$$
 = 
TYPE_ANY
; };

960 
›t_ex¥01
: { 
$$
 = 
TYPE_NONE
;}

961 | 
ex¥01


963 
ex¥01
: 
ex¥1
 { 
$$
 = 
$1
; }

964 | 
ex¥1
 '?'

966 
	`push_addªss
();

967 
	`ös_f_byã
(
F_JUMP_WHEN_ZERO
);

968 
	`add_jump
();

969 
	`push_addªss
();

970 
	`ös_sh‹t
(0);

972 
›t_ex¥01


974 
i
;

975 
i
 = 
	`p›_addªss
();

976 i‡(
$4
 !
TYPE_NONE
)

978 ()
	`p›_addªss
();

979 
	`ös_f_byã
(
F_JUMP
);

980 
	`add_jump
();

981 
	`push_addªss
();

982 
	`ös_sh‹t
(0);

983 
	`upd_sh‹t
(
i
, 
mem_block
[
A_PROGRAM
].
cuºít_size
);

987 
mem_block
[
A_PROGRAM
].
cuºít_size
 = 
	`p›_addªss
();

988 
	`ös_f_byã
(
F_SKIP_NZ
);

989 
	`push_addªss
();

990 
	`ös_sh‹t
(0);

991 
$4
 = 
$1
;

994 ':' 
ex¥01


996 
	`upd_sh‹t
(
	`p›_addªss
(), 
mem_block
[
A_PROGRAM
].
cuºít_size
);

997 i‡(
exa˘_ty≥s
 && !
	`com∑tibÀ_ty≥s
(
$4
, 
$7
)) {

998 
	`ty≥_îr‹
("Dif„ª¡Åy≥†ö ?:Éx¥", 
$4
);

999 
	`ty≥_îr‹
("ánd ", 
$7
);

1001 i‡(
$4
 =
TYPE_ANY
Ë
$$
 = 
$7
;

1002 i‡(
$7
 =
TYPE_ANY
Ë
$$
 = 
$4
;

1003 i‡(
	`TYPE
(
$4
, 
TYPE_MOD_POINTER
|
TYPE_ANY
)Ë
$$
 = 
$7
;

1004 i‡(
	`TYPE
(
$7
, 
TYPE_MOD_POINTER
|
TYPE_ANY
)Ë
$$
 = 
$4
;

1005 
$$
 = 
$4
;

1008 
assign
: '=' { 
$$
 = 
F_ASSIGN
; }

1009 | 
F_AND_EQ
 { 
$$
 = F_AND_EQ; }

1010 | 
F_OR_EQ
 { 
$$
 = F_OR_EQ; }

1011 | 
F_XOR_EQ
 { 
$$
 = F_XOR_EQ; }

1012 | 
F_LSH_EQ
 { 
$$
 = F_LSH_EQ; }

1013 | 
F_RSH_EQ
 { 
$$
 = F_RSH_EQ; }

1014 | 
F_ADD_EQ
 { 
$$
 = F_ADD_EQ; }

1015 | 
F_SUB_EQ
 { 
$$
 = F_SUB_EQ; }

1016 | 
F_MULT_EQ
 { 
$$
 = F_MULT_EQ; }

1017 | 
F_MOD_EQ
 { 
$$
 = F_MOD_EQ; }

1018 | 
F_DIV_EQ
 { 
$$
 = F_DIV_EQ; };

1020 : 
F_RETURN


1022 i‡(
exa˘_ty≥s
 && !
	`TYPE
”xa˘_ty≥s, 
TYPE_VOID
))

1023 
	`ty≥_îr‹
("MustÑeturná value forá function declared",

1024 
exa˘_ty≥s
);

1025 
	`ös_f_byã
(
F_CONST0
);

1026 
	`ös_f_byã
(
F_JUMP
);

1027 
	`add_jump
();

1028 
	`ös_œbñ
(
ªtu∫_œbñ
);

1030 | 
F_RETURN
 
comma_ex¥


1032 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$2
,Éxa˘_ty≥†& 
TYPE_MASK
))

1033 
	`ty≥_îr‹
("Rëu∫Åy≥ÇŸ m©chög", 
exa˘_ty≥s
);

1034 
	`ös_f_byã
(
F_JUMP
);

1035 
	`add_jump
();

1036 
	`ös_œbñ
(
ªtu∫_œbñ
);

1039 
ex¥_li°
: { 
$$
 = 0; }

1040 | 
ex¥_li°2
 { 
$$
 = 
$1
; }

1041 | 
ex¥_li°2
 ',' { 
$$
 = 
$1
; } ;

1043 
ex¥_li°2
: 
ex¥0
 { 
$$
 = 1; 
	`add_¨g_ty≥
(
$1
); }

1044 | 
ex¥_li°2
 ',' 
ex¥0
 { 
$$
 = 
$1
 + 1; 
	`add_¨g_ty≥
(
$3
); } ;

1046 
m_ex¥_li°
: { 
$$
 = 0; }

1047 | 
m_ex¥_li°2
 { 
$$
 = 
$1
; }

1048 | 
m_ex¥_li°2
 ',' { 
$$
 = 
$1
; } ;

1050 
m_ex¥_li°2
: 
ex¥0
 ':' 
ex¥1
 { 
$$
 = 2; 
	`add_¨g_ty≥
(
$1
);ádd_¨g_ty≥(
$3
); }

1051 | 
m_ex¥_li°2
 ',' 
ex¥0
 ':' 
ex¥1
 { 
$$
 = 
$1
 + 2; 
	`add_¨g_ty≥
(
$3
);ádd_¨g_ty≥(
$5
); }

1053 
ex¥1
: 
ex¥2
 { 
$$
 = 
$1
; }

1054 | 
ex¥2
 
F_LOR


1056 
	`ös_f_byã
(
F_DUP
);

1057 
	`ös_f_byã
(
F_JUMP_WHEN_NON_ZERO
);

1058 
	`add_jump
();

1059 
	`push_addªss
();

1060 
	`ös_sh‹t
(0);

1061 
	`ös_f_byã
(
F_POP_VALUE
);

1063 
ex¥1


1065 
	`upd_sh‹t
(
	`p›_addªss
(), 
mem_block
[
A_PROGRAM
].
cuºít_size
);

1066 i‡(
$1
 =
$4
)

1067 
$$
 = 
$1
;

1069 
$$
 = 
TYPE_ANY
;

1072 
ex¥2
: 
ex¥211
 { 
$$
 = 
$1
; }

1073 | 
ex¥211
 
F_LAND


1075 
	`ös_f_byã
(
F_DUP
);

1076 
	`ös_f_byã
(
F_JUMP_WHEN_ZERO
);

1077 
	`add_jump
();

1078 
	`push_addªss
();

1079 
	`ös_sh‹t
(0);

1080 
	`ös_f_byã
(
F_POP_VALUE
);

1082 
ex¥2


1084 
	`upd_sh‹t
(
	`p›_addªss
(), 
mem_block
[
A_PROGRAM
].
cuºít_size
);

1085 i‡(
$1
 =
$4
)

1086 
$$
 = 
$1
;

1088 
$$
 = 
TYPE_ANY
;

1091 
ex¥211
: 
ex¥212


1092 | 
ex¥211
 '|' 
ex¥212


1094 
t1
 = 
$1
 & 
TYPE_MASK
, 
t3
 = 
$3
 & TYPE_MASK;

1095 i‡((
$1
 & 
TYPE_MOD_POINTER
 && 
$3
 & TYPE_MOD_POINTER) &&

1096 (
t1
 =
t3
))

1097 
$$
 = 
$1
;

1098 i‡(((
t1
 =
TYPE_ANY
Ë&& 
$3
 & 
TYPE_MOD_POINTER
) ||

1099 (
$1
 & 
TYPE_MOD_POINTER
 && (
t3
 =
TYPE_ANY
)))

1100 
$$
 = 
TYPE_MOD_POINTER
 | 
TYPE_ANY
;

1101 i‡((
t1
 =
TYPE_ANY
Ë&& (
t3
 == TYPE_ANY))

1102 
$$
 = 
TYPE_ANY
;

1105 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$1
,
TYPE_NUMBER
))

1106 
	`ty≥_îr‹
("Badárgumíà1Åÿ|", 
$1
);

1107 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$3
,
TYPE_NUMBER
))

1108 
	`ty≥_îr‹
("Badárgumíà2Åÿ|", 
$3
);

1109 
$$
 = 
TYPE_NUMBER
;

1111 
	`ös_f_byã
(
F_OR
);

1114 
ex¥212
: 
ex¥213


1115 | 
ex¥212
 '^' 
ex¥213


1117 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$1
,
TYPE_NUMBER
))

1118 
	`ty≥_îr‹
("Badárgumíà1Åÿ^", 
$1
);

1119 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$3
,
TYPE_NUMBER
))

1120 
	`ty≥_îr‹
("Badárgumíà2Åÿ^", 
$3
);

1121 
$$
 = 
TYPE_NUMBER
;

1122 
	`ös_f_byã
(
F_XOR
);

1125 
ex¥213
: 
ex¥22


1126 | 
ex¥213
 '&' 
ex¥22


1128 
t1
 = 
$1
 & 
TYPE_MASK
, 
t3
 = 
$3
 & TYPE_MASK;

1129 i‡((
$1
 & 
TYPE_MOD_POINTER
 && 
$3
 & TYPE_MOD_POINTER) &&

1130 (
t1
 =
t3
))

1131 
$$
 = 
$1
;

1132 i‡(((
t1
 =
TYPE_ANY
Ë&& 
$3
 & 
TYPE_MOD_POINTER
) ||

1133 (
$1
 & 
TYPE_MOD_POINTER
 && (
t3
 =
TYPE_ANY
)))

1134 
$$
 = 
TYPE_MOD_POINTER
 | 
TYPE_ANY
;

1135 i‡((
t1
 =
TYPE_ANY
Ë&& (
t3
 == TYPE_ANY))

1136 
$$
 = 
TYPE_ANY
;

1139 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$1
,
TYPE_NUMBER
))

1140 
	`ty≥_îr‹
("Badárgumíà1Åÿ&", 
$1
);

1141 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$3
,
TYPE_NUMBER
))

1142 
	`ty≥_îr‹
("Badárgumíà2Åÿ&", 
$3
);

1143 
$$
 = 
TYPE_NUMBER
;

1145 
	`ös_f_byã
(
F_AND
);

1148 
ex¥22
: 
ex¥23


1149 | 
ex¥24
 
F_EQ
Éxpr24

1151 
t1
 = 
$1
 & 
TYPE_MASK
, 
t2
 = 
$3
 & TYPE_MASK;

1152 i‡(
exa˘_ty≥s
 && 
t1
 !
t2
 &&Å1 !
TYPE_ANY
 &&Å2 != TYPE_ANY) {

1153 
	`ty≥_îr‹
("=Æway†Ál£ beˇu£ o‡dif„ª¡Åy≥s", 
$1
);

1154 
	`ty≥_îr‹
(" com∑ªdÅo", 
$3
);

1156 
	`ös_f_byã
(
F_EQ
);

1157 
$$
 = 
TYPE_NUMBER
;

1159 | 
ex¥24
 
F_NE
Éxpr24

1161 
t1
 = 
$1
 & 
TYPE_MASK
, 
t2
 = 
$3
 & TYPE_MASK;

1162 i‡(
exa˘_ty≥s
 && 
t1
 !
t2
 &&Å1 !
TYPE_ANY
 &&Å2 != TYPE_ANY) {

1163 
	`ty≥_îr‹
("!Æway†åuêbeˇu£ o‡dif„ª¡Åy≥s", 
$1
);

1164 
	`ty≥_îr‹
(" com∑ªdÅo", 
$3
);

1166 
	`ös_f_byã
(
F_NE
);

1167 
$$
 = 
TYPE_NUMBER
;

1170 
ex¥23
: 
ex¥24


1171 | 
ex¥24
 '>'Éxpr24

1172 { 
$$
 = 
TYPE_NUMBER
; 
	`ös_f_byã
(
F_GT
); };

1173 | 
ex¥24
 
F_GE
Éxpr24

1174 { 
$$
 = 
TYPE_NUMBER
; 
	`ös_f_byã
(
F_GE
); };

1175 | 
ex¥24
 '<'Éxpr24

1176 { 
$$
 = 
TYPE_NUMBER
; 
	`ös_f_byã
(
F_LT
); };

1177 | 
ex¥24
 
F_LE
Éxpr24

1178 { 
$$
 = 
TYPE_NUMBER
; 
	`ös_f_byã
(
F_LE
); };

1180 
ex¥24
: 
ex¥25


1181 | 
ex¥24
 
F_LSH
 
ex¥25


1183 
	`ös_f_byã
(
F_LSH
);

1184 
$$
 = 
TYPE_NUMBER
;

1185 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$1
, 
TYPE_NUMBER
))

1186 
	`ty≥_îr‹
("Badárgumíànumbî 1Åÿ'<<'", 
$1
);

1187 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$3
, 
TYPE_NUMBER
))

1188 
	`ty≥_îr‹
("Badárgumíànumbî 2Åÿ'<<'", 
$3
);

1190 | 
ex¥24
 
F_RSH
 
ex¥25


1192 
	`ös_f_byã
(
F_RSH
);

1193 
$$
 = 
TYPE_NUMBER
;

1194 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$1
, 
TYPE_NUMBER
))

1195 
	`ty≥_îr‹
("Badárgumíànumbî 1Åÿ'>>'", 
$1
);

1196 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$3
, 
TYPE_NUMBER
))

1197 
	`ty≥_îr‹
("Badárgumíànumbî 2Åÿ'>>'", 
$3
);

1200 
ex¥25
: 
ex¥27


1201 | 
ex¥25
 '+' 
ex¥27


1202 { 
	`ös_f_byã
(
F_ADD
); 
$$
 = 
TYPE_ANY
; }

1203 | 
ex¥25
 '-' 
ex¥27


1205 
bad_¨g
 = 0;

1207 i‡(
exa˘_ty≥s
) {

1208 i‡(!(
	`TYPE
(
$1
, 
TYPE_NUMBER
Ë|| TYPE($1, 
TYPE_FLOAT
)) &&

1209 !(
$1
 & 
TYPE_MOD_POINTER
) ) {

1210 
	`ty≥_îr‹
("Badárgumíànumbî 1Åÿ'-'", 
$1
);

1211 
bad_¨g
++;

1213 i‡(!
	`TYPE
(
$3
, 
$1
Ë&& !($3 & 
TYPE_MOD_POINTER
) ) {

1214 
	`ty≥_îr‹
("Badárgumíànumbî 2Åÿ'-'", 
$3
);

1215 
bad_¨g
++;

1218 
$$
 = 
TYPE_ANY
;

1219 i‡((
$1
 & 
TYPE_MOD_POINTER
Ë|| (
$3
 & TYPE_MOD_POINTER))

1220 
$$
 = 
TYPE_MOD_POINTER
 | 
TYPE_ANY
;

1221 i‡(!(
$1
 & 
TYPE_MOD_POINTER
Ë|| !(
$3
 & TYPE_MOD_POINTER)) {

1222 i‡(
exa˘_ty≥s
 && 
$$
 !
TYPE_ANY
 && !
bad_¨g
)

1223 
	`yyîr‹
("ArgumentsÅo '-' don't match");

1224 
$$
 = (
$1
 & 
TYPE_MOD_POINTER
)?
$3
:$1;

1226 
	`ös_f_byã
(
F_SUBTRACT
);

1230 
ex¥27
: 
ex¥28


1231 | 
ex¥27
 '*' 
ex¥3


1233 i‡(
exa˘_ty≥s
 && !(
	`TYPE
(
$1
, 
TYPE_NUMBER
Ë|| TYPE($1, 
TYPE_FLOAT
)))

1234 
	`ty≥_îr‹
("Badárgumíànumbî 1Åÿ'*'", 
$1
);

1235 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$1
, 
$3
))

1237 
	`ty≥_îr‹
("Badárgumíànumbî 2Åÿ'*'", 
$3
);

1239 
	`ös_f_byã
(
F_MULTIPLY
);

1240 
$$
 = 
$1
;

1242 | 
ex¥27
 
F_MOD
 
ex¥3


1244 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$1
, 
TYPE_NUMBER
))

1245 
	`ty≥_îr‹
("Badárgumíànumbî 1Åÿ'%'", 
$1
);

1246 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$3
, 
TYPE_NUMBER
))

1247 
	`ty≥_îr‹
("Badárgumíànumbî 2Åÿ'%'", 
$3
);

1248 
	`ös_f_byã
(
F_MOD
);

1249 
$$
 = 
TYPE_NUMBER
;

1251 | 
ex¥27
 '/' 
ex¥3


1253 i‡(
exa˘_ty≥s
 && !(
	`TYPE
(
$1
, 
TYPE_NUMBER
Ë|| TYPE($1, 
TYPE_FLOAT
)))

1254 
	`ty≥_îr‹
("Badárgumíànumbî 1Åÿ'/'", 
$1
);

1255 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$3
, 
$1
))

1256 
	`ty≥_îr‹
("Badárgumíànumbî 2Åÿ'/'", 
$3
);

1257 
	`ös_f_byã
(
F_DIVIDE
);

1258 
$$
 = 
$1
;

1260 | 
ex¥27
 '@' 
ex¥3


1262 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$1
, 
TYPE_FUNCTION
))

1263 
	`ty≥_îr‹
("Badárgumíànumbî 1Åÿ'@'", 
$1
);

1264 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$3
, 
TYPE_FUNCTION
))

1265 
	`ty≥_îr‹
("Badárgumíànumbî 2Åÿ'@'", 
$3
);

1266 
	`ös_f_byã
(
F_BUILD_CLOSURE
);

1267 
	`ös_byã
(
FUN_COMPOSE
);

1268 
$$
 = 
TYPE_FUNCTION
;

1272 
ex¥28
: 
ex¥3


1273 | 
ˇ°
 
ex¥3


1275 
$$
 = 
$1
;

1276 i‡(
exa˘_ty≥s
 && 
$2
 !
TYPE_ANY
 && $2 !
TYPE_UNKNOWN
 &&

1277 
$1
 !
TYPE_VOID
)

1278 
	`ty≥_îr‹
("Ca°†¨ê⁄lyÜegÆ f‹Åy≥ mixed, o∏whí unknown", 
$2
);

1281 
ex¥3
: 
ex¥31


1282 | 
F_INC
 
lvÆue


1284 
dîef_ödex
--;

1285 
	`ös_f_byã
(
F_INC
);

1286 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$2
, 
TYPE_NUMBER
))

1287 
	`ty≥_îr‹
("Badárgumíàtÿ++", 
$2
);

1288 
$$
 = 
TYPE_NUMBER
;

1290 | 
F_DEC
 
lvÆue


1292 
dîef_ödex
--;

1293 
	`ös_f_byã
(
F_DEC
);

1294 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$2
, 
TYPE_NUMBER
))

1295 
	`ty≥_îr‹
("Badárgumíàtÿ--", 
$2
);

1296 
$$
 = 
TYPE_NUMBER
;

1298 | 
F_NOT
 
ex¥3


1300 
	`ös_f_byã
(
F_NOT
);

1301 
$$
 = 
TYPE_NUMBER
;

1303 | '~' 
ex¥3


1305 
	`ös_f_byã
(
F_COMPL
);

1306 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$2
, 
TYPE_NUMBER
))

1307 
	`ty≥_îr‹
("Badárgumíàtÿ~", 
$2
);

1308 
$$
 = 
TYPE_NUMBER
;

1310 | '-' 
ex¥3


1312 
	`ös_f_byã
(
F_NEGATE
);

1313 i‡(
exa˘_ty≥s
 && !(
	`TYPE
(
$2
, 
TYPE_NUMBER
Ë|| TYPE($2, 
TYPE_FLOAT
)))

1314 
	`ty≥_îr‹
("Badárgumíàtÿu«ry '-'", 
$2
);

1315 
$$
 = 
$2
;

1317 | '&' 
fu√x¥
 '(' 
€x¥_li°
 ')'

1319 i‡(
$4
) {

1320 
	`p›_¨g_°ack
(
$4
);

1321 
	`ös_f_byã
(
F_PAPPLY
);

1322 
	`ös_byã
(
$4
);

1324 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$2
, 
TYPE_FUNCTION
))

1325 
	`ty≥_îr‹
("Badárgumíàtÿu«ry '&'", 
$2
);

1326 
$$
 = 
TYPE_FUNCTION
;

1328 | '&' 
F_ARROW
 
F_IDENTIFIER


1332 
	`ös_f_byã
(
F_BUILD_CLOSURE
);

1333 
	`ös_byã
(
FUN_EFUN
);

1334 
	`ös_sh‹t
(
F_CALL_OTHER
);

1336 
	`ös_f_byã
(
F_BUILD_CLOSURE
);

1337 
	`ös_byã
(
FUN_EMPTY
);

1339 
	`ös_f_byã
(
F_STRING
);

1340 
	`ös_sh‹t
(
	`°‹e_¥og_°rög
(
$3
));

1342 } '(' 
€x¥_li°
 ')'

1344 
	`p›_¨g_°ack
(
$6
);

1345 
	`ös_f_byã
(
F_PAPPLY
);

1346 
	`ös_byã
(2 + 
$6
);

1348 
$$
 = 
TYPE_FUNCTION
;

1352 
fu√x¥
:

1353 
funidít
 { 
$$
 = 
$1
; }

1354 | 
°rög_‹_id
 
F_ARROW
 
F_IDENTIFIER


1356 
	`ös_f_byã
(
F_STRING
);

1357 
	`ös_sh‹t
(
	`°‹e_¥og_°rög
(
$3
));

1358 
	`ös_f_byã
(
F_BUILD_CLOSURE
);

1359 
	`ös_byã
(
FUN_LFUNO
);

1360 
$$
 = 
TYPE_FUNCTION
;

1365 
°rög_‹_id
:

1366 
°rög


1368 
$
<
ty≥
>$ = 
$1
;

1370 | 
idítifõr


1372 
i
 = 
	`vîify_de˛¨ed
(
$1
);

1374 i‡(
i
 == -1) {

1375 
buff
[100];

1377 ()
	`¢¥ötf
(
buff
, (buff), "V¨übÀ %†nŸ de˛¨ed!", 
$1
);

1378 
	`yyîr‹
(
buff
);

1380 
	`ös_f_byã
(
F_IDENTIFIER
);

1381 
	`ös_byã
(
v¨übÀ_öhîô_found
);

1382 
	`ös_byã
(
v¨übÀ_ödex_found
);

1385 | 
F_LOCAL_NAME


1387 
	`ös_f_byã
(
F_LOCAL_NAME
);

1388 
	`ös_byã
(
$1
);

1390 | '(' 
comma_ex¥
 ')'

1393 
€x¥_li°
: { 
$$
 = 0; }

1394 | 
ex¥0
 { 
	`add_¨g_ty≥
(
$1
); 
$$
 = 1; }

1395 | 
€x¥_li°1
 { 
$$
 = 
$1
; };

1397 
€x¥_li°1
: 
€x¥0
 ',' oex¥0 { 
$$
 = 2; }

1398 | 
€x¥0
 ',' 
€x¥_li°1
 { 
$$
 = 
$3
 + 1; } ;

1400 
€x¥0
: 
ex¥0
 { 
	`add_¨g_ty≥
(
$1
); }

1402 
	`ös_f_byã
(
F_BUILD_CLOSURE
);

1403 
	`ös_byã
(
FUN_EMPTY
);

1404 
	`add_¨g_ty≥
(
TYPE_ANY
);

1408 
funidít
: 
F_IDENTIFIER


1410 
i
 = 
	`vîify_de˛¨ed
(
$1
);

1412 i‡(
i
 == -1) {

1413 i‡(
	`h™dÀ_fun˘i⁄_id
(
$1
)) {

1414 
$$
 = 
TYPE_FUNCTION
;

1416 
buff
[100];

1418 ()
	`¢¥ötf
(
buff
, (buff), "V¨übÀ %†nŸ de˛¨ed!", 
$1
);

1419 
	`yyîr‹
(
buff
);

1420 
$$
 = 
TYPE_ANY
;

1423 
	`ös_f_byã
(
F_IDENTIFIER
);

1424 
	`ös_byã
(
v¨übÀ_öhîô_found
);

1425 
	`ös_byã
(
v¨übÀ_ödex_found
);

1426 
$$
 = 
i
 & 
TYPE_MASK
;

1429 | 
F_LOCAL_NAME


1431 
	`ös_f_byã
(
F_LOCAL_NAME
);

1432 
	`ös_byã
(
$1
);

1433 
$$
 = 
ty≥_of_loˇls
[
$1
];

1435 | 
fun›î©‹


1437 
$$
 = 
TYPE_FUNCTION
;

1441 
fun›î©‹
:

1442 
F_OPERATOR
 '(' 
fun›
 ')'

1444 
	`ös_f_byã
(
F_BUILD_CLOSURE
);

1445 
	`ös_byã
(
FUN_EFUN
);

1446 
	`ös_sh‹t
(
$3
);

1450 
fun›
: '+' { 
$$
 = 
F_ADD
; } |

1451 '-' { 
$$
 = 
F_SUBTRACT
; } |

1452 '*' { 
$$
 = 
F_MULTIPLY
; } |

1453 '/' { 
$$
 = 
F_DIVIDE
; } |

1454 
F_MOD
 { 
$$
 = F_MOD; } |

1455 '>' { 
$$
 = 
F_GT
; } |

1456 '<' { 
$$
 = 
F_LT
; } |

1457 
F_GE
 { 
$$
 = F_GE; } |

1458 
F_LE
 { 
$$
 = F_LE; } |

1459 
F_EQ
 { 
$$
 = F_EQ; } |

1460 
F_NE
 { 
$$
 = F_NE; } |

1461 '&' { 
$$
 = 
F_AND
; } |

1462 '^' { 
$$
 = 
F_XOR
; } |

1463 '|' { 
$$
 = 
F_OR
; } |

1464 
F_LSH
 { 
$$
 = F_LSH; } |

1465 
F_RSH
 { 
$$
 = F_RSH; } |

1466 '[' ']' { 
$$
 = 
F_INDEX
; } |

1467 
F_NOT
 { 
$$
 = F_NOT; } |

1468 '~' { 
$$
 = 
F_COMPL
; }

1473 
ex¥31
: 
ex¥4


1474 | 
lvÆue
 
F_INC


1476 
dîef_ödex
--;

1477 
	`ös_f_byã
(
F_POST_INC
);

1478 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$1
, 
TYPE_NUMBER
))

1479 
	`ty≥_îr‹
("Badárgumíàtÿ++", 
$1
);

1480 
$$
 = 
TYPE_NUMBER
;

1482 | 
lvÆue
 
F_DEC


1484 
dîef_ödex
--;

1485 
	`ös_f_byã
(
F_POST_DEC
);

1486 i‡(
exa˘_ty≥s
 && !
	`TYPE
(
$1
, 
TYPE_NUMBER
))

1487 
	`ty≥_îr‹
("Badárgumíàtÿ--", 
$1
);

1488 
$$
 = 
TYPE_NUMBER
;

1491 
rvÆue
: 
lvÆue


1493 
i
, 
œ°l
;

1497 i‡(
dîef_ödex
 <= 0)

1498 
	`Áèl
("deref_index\n");

1499 
œ°l
 = 
dîef_°ack
[--
dîef_ödex
];

1500 i‡(
œ°l
 != -1) {

1501 
mem_block
[
A_PROGRAM
].
block
[
œ°l
]) {

1502 
F_PUSH_IDENTIFIER_LVALUE
-
EFUN_FIRST
:

1503 
i
 = 
F_IDENTIFIER
-
EFUN_FIRST
; ;

1504 
F_PUSH_LOCAL_VARIABLE_LVALUE
-
EFUN_FIRST
:

1505 
i
 = 
F_LOCAL_NAME
-
EFUN_FIRST
; ;

1506 
F_PUSH_INDEXED_LVALUE
-
EFUN_FIRST
:

1507 
i
 = 
F_INDEX
-
EFUN_FIRST
; ;

1508 :
i
 = -1; ;

1510 i‡(
i
 =-1Ë
	`Áèl
("Should beáÖushátÅhisÖoint!\n");

1511 
mem_block
[
A_PROGRAM
].
block
[
œ°l
] = 
i
;

1513 
$$
 = 
$1
 & ~
TYPE_LVALUE
;

1516 
ex¥4
: 
fun˘i⁄_ˇŒ


1517 | 
rvÆue


1518 | 
fun›î©‹


1520 
$$
 = 
TYPE_FUNCTION
;

1522 | 
ex¥4
 '[' 
comma_ex¥
 
F_RANGE
 comma_expr ']'

1524 
	`ös_f_byã
(
F_RANGE
);

1525 i‡(
exa˘_ty≥s
 && !(
$1
 & 
TYPE_MAPPING
))

1527 i‡((
$1
 & 
TYPE_MOD_POINTER
Ë=0 && !
	`TYPE
($1, 
TYPE_STRING
))

1528 
	`ty≥_îr‹
("BadÅy≥Åÿödexed vÆue", 
$1
);

1529 i‡(!
	`TYPE
(
$3
, 
TYPE_NUMBER
))

1530 
	`ty≥_îr‹
("BadÅy≥ o‡ödex", 
$3
);

1531 i‡(!
	`TYPE
(
$5
, 
TYPE_NUMBER
))

1532 
	`ty≥_îr‹
("BadÅy≥ o‡ödex", 
$5
);

1534 i‡(
$1
 =
TYPE_ANY
)

1535 
$$
 = 
TYPE_ANY
;

1536 i‡(
	`TYPE
(
$1
, 
TYPE_STRING
))

1537 
$$
 = 
TYPE_STRING
;

1538 i‡(
$1
 & 
TYPE_MOD_POINTER
)

1539 
$$
 = 
$1
;

1540 i‡(
exa˘_ty≥s
)

1541 
	`ty≥_îr‹
("BadÅy≥ o‡¨gumíàu£d f‹Ñ™ge", 
$1
);

1543 | 
ex¥4
 '[' 
F_RANGE
 { 
	`ös_f_byã
(
F_CONST0
); } 
comma_ex¥
 ']'

1545 
	`ös_f_byã
(
F_RANGE
);

1546 i‡(
exa˘_ty≥s
 && !(
$1
 & 
TYPE_MAPPING
))

1548 i‡((
$1
 & 
TYPE_MOD_POINTER
Ë=0 && !
	`TYPE
($1, 
TYPE_STRING
))

1549 
	`ty≥_îr‹
("BadÅy≥Åÿödexed vÆue", 
$1
);

1550 i‡(!
	`TYPE
(
$5
, 
TYPE_NUMBER
))

1551 
	`ty≥_îr‹
("BadÅy≥ o‡ödex", 
$5
);

1553 i‡(
$1
 =
TYPE_ANY
)

1554 
$$
 = 
TYPE_ANY
;

1555 i‡(
	`TYPE
(
$1
, 
TYPE_STRING
))

1556 
$$
 = 
TYPE_STRING
;

1557 i‡(
$1
 & 
TYPE_MOD_POINTER
)

1558 
$$
 = 
$1
;

1559 i‡(
exa˘_ty≥s
)

1560 
	`ty≥_îr‹
("BadÅy≥ o‡¨gumíàu£d f‹Ñ™ge", 
$1
);

1562 | 
ex¥4
 '[' 
comma_ex¥
 
F_RANGE
 ']'

1564 
	`ös_f_byã
(
F_NUMBER
);

1565 
	`ös_l⁄g
(~()0 >> 1);

1567 
	`ös_f_byã
(
F_RANGE
);

1568 i‡(
exa˘_ty≥s
 && !(
$1
 & 
TYPE_MAPPING
))

1570 i‡((
$1
 & 
TYPE_MOD_POINTER
Ë=0 && !
	`TYPE
($1, 
TYPE_STRING
))

1571 
	`ty≥_îr‹
("BadÅy≥Åÿödexed vÆue", 
$1
);

1572 i‡(!
	`TYPE
(
$3
, 
TYPE_NUMBER
))

1573 
	`ty≥_îr‹
("BadÅy≥ o‡ödex", 
$3
);

1575 i‡(
$1
 =
TYPE_ANY
)

1576 
$$
 = 
TYPE_ANY
;

1577 i‡(
	`TYPE
(
$1
, 
TYPE_STRING
))

1578 
$$
 = 
TYPE_STRING
;

1579 i‡(
$1
 & 
TYPE_MOD_POINTER
)

1580 
$$
 = 
$1
;

1581 i‡(
exa˘_ty≥s
)

1582 
	`ty≥_îr‹
("BadÅy≥ o‡¨gumíàu£d f‹Ñ™ge", 
$1
);

1584 | 
°rög
 | 
numbî


1585 | 
ªÆ


1586 | '(' 
comma_ex¥
 ')' { 
$$
 = 
$2
; }

1587 | 
ˇtch
 { 
$$
 = 
TYPE_ANY
; }

1588 | 
ssˇnf
 { 
$$
 = 
TYPE_NUMBER
; }

1589 | 
∑r£_comm™d
 { 
$$
 = 
TYPE_NUMBER
; }

1590 | '(' '{' 
ex¥_li°
 '}' ')'

1592 
	`p›_¨g_°ack
(
$3
);

1593 
	`ös_f_byã
(
F_AGGREGATE
);

1594 
	`ös_sh‹t
(
$3
);

1595 
$$
 = 
TYPE_MOD_POINTER
 | 
TYPE_ANY
;

1597 | '(' '[' 
m_ex¥_li°
 ']' ')'

1599 
	`p›_¨g_°ack
(
$3
);

1600 
	`ös_f_byã
(
F_M_AGGREGATE
);

1601 
	`ös_sh‹t
(
$3
);

1602 
$$
 = 
TYPE_MAPPING
;

1605 
ˇtch
: 
F_CATCH
 { 
	`ös_f_byã
(F_CATCH); 
	`push_addªss
(); 
	`ös_sh‹t
(0);}

1606 '(' 
comma_ex¥
 ')'

1608 
	`ös_f_byã
(
F_POP_VALUE
);

1609 
	`ös_f_byã
(
F_END_CATCH
);

1610 
	`upd_sh‹t
(
	`p›_addªss
(),

1611 
mem_block
[
A_PROGRAM
].
cuºít_size
);

1614 
ssˇnf
: 
F_SSCANF
 '(' 
ex¥0
 ','Éx¥0 
lvÆue_li°
 ')'

1616 
	`ös_f_byã
(
F_SSCANF
); 
	`ös_byã
(
$6
 + 2);

1619 
∑r£_comm™d
: 
F_PARSE_COMMAND
 '(' 
ex¥0
 ','Éx¥0 ','Éx¥0 
lvÆue_li°
 ')'

1621 
	`ös_f_byã
(
F_PARSE_COMMAND
); 
	`ös_byã
(
$8
 + 3);

1624 
lvÆue_li°
: { 
$$
 = 0; }

1625 | ',' 
lvÆuec
 
lvÆue_li°
 { 
$$
 = 1 + 
$3
; } ;

1626 
lvÆuec
: 
lvÆue
 { i‡(!(
$1
 & 
TYPE_LVALUE
)Ë
	`yyîr‹
("IŒegÆÜvÆue"); 
$$
 = $1 & TYPE_LVALUE; 
dîef_ödex
--; }

1628 
idítifõr
: 
F_IDENTIFIER


1629 | 
F_COLON_COLON
 
idítifõr


1631 
$$
 = 
	`tm∑Œoc
(
	`°æí
(
$2
) + 3);

1632 ()
	`•rötf
(
$$
, "::%s", 
$2
);

1634 | 
F_IDENTIFIER
 
F_COLON_COLON
 
idítifõr


1636 
$$
 = 
	`tm∑Œoc
(
	`°æí
(
$1
Ë+ såÀn(
$3
) + 3);

1637 ()
	`•rötf
(
$$
, "%s::%s", 
$1
, 
$3
);

1639 
fun_idítifõr
: 
F_IDENTIFIER


1640 | 
F_LSH
 { 
$$
 = 
DTOR_FUNC
;}

1641 | 
F_RSH
 { 
$$
 = 
CTOR_FUNC
;}

1643 
lvÆue
: 
idítifõr


1645 
i
 = 
	`vîify_de˛¨ed
(
$1
);

1647 i‡(
i
 == -1) {

1648 
dîef_°ack
[
dîef_ödex
++] = -1;

1649 i‡(
dîef_ödex
 >
DEREFSIZE
)

1650 
	`Áèl
("deref_index overflow\n");

1651 i‡(
	`h™dÀ_fun˘i⁄_id
(
$1
)) {

1652 
$$
 = 
TYPE_FUNCTION
;

1654 
buff
[100];

1656 ()
	`¢¥ötf
(
buff
, (buff), "V¨übÀ %†nŸ de˛¨ed!", 
$1
);

1657 
	`yyîr‹
(
buff
);

1658 
$$
 = 
TYPE_ANY
;

1661 
dîef_°ack
[
dîef_ödex
++] = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

1662 i‡(
dîef_ödex
 >
DEREFSIZE
)

1663 
	`Áèl
("deref_index overflow\n");

1664 
	`ös_f_byã
(
F_PUSH_IDENTIFIER_LVALUE
);

1665 
	`ös_byã
(
v¨übÀ_öhîô_found
);

1666 
	`ös_byã
(
v¨übÀ_ödex_found
);

1667 
$$
 = (
i
 & 
TYPE_MASK
Ë| 
TYPE_LVALUE
;

1670 | 
F_LOCAL_NAME


1672 
dîef_°ack
[
dîef_ödex
++] = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

1673 i‡(
dîef_ödex
 >
DEREFSIZE
)

1674 
	`Áèl
("deref_index overflow\n");

1675 
	`ös_f_byã
(
F_PUSH_LOCAL_VARIABLE_LVALUE
);

1676 
	`ös_byã
(
$1
);

1677 
$$
 = 
ty≥_of_loˇls
[
$1
] | 
TYPE_LVALUE
;

1679 | 
ex¥4
 '[' 
comma_ex¥
 ']'

1681 
dîef_°ack
[
dîef_ödex
++] = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

1682 i‡(
dîef_ödex
 >
DEREFSIZE
)

1683 
	`Áèl
("deref_index overflow\n");

1684 
	`ös_f_byã
(
F_PUSH_INDEXED_LVALUE
);

1685 i‡(
exa˘_ty≥s
 && !(
$1
 & 
TYPE_MAPPING
)) {

1686 i‡((
$1
 & 
TYPE_MOD_POINTER
Ë=0 && !
	`TYPE
($1, 
TYPE_STRING
))

1687 
	`ty≥_îr‹
("BadÅy≥Åÿödexed vÆue", 
$1
);

1688 i‡(!
	`TYPE
(
$3
, 
TYPE_NUMBER
))

1689 
	`ty≥_îr‹
("BadÅy≥ o‡ödex", 
$3
);

1691 i‡(
$1
 =
TYPE_ANY
)

1692 
$$
 = 
TYPE_ANY
;

1693 i‡(
	`TYPE
(
$1
, 
TYPE_STRING
))

1694 
$$
 = 
TYPE_NUMBER
;

1695 i‡(
$1
 =
TYPE_MAPPING
)

1696 
$$
 = 
TYPE_ANY
;

1698 
$$
 = 
$1
 & 
TYPE_MASK
 & ~
TYPE_MOD_POINTER
;

1699 
$$
 |
TYPE_LVALUE
;

1702 
ªÆ
: 
F_FLOATC


1704 
	`ös_f_byã
(
F_FLOATC
);

1705 
	`ös_l⁄g
(*((*)&
$
<
ªÆ
>1));

1706 
$$
 = 
TYPE_FLOAT
;

1709 
°rög
: 
F_STRING


1711 
	`ös_f_byã
(
F_STRING
);

1712 
	`ös_sh‹t
(
	`°‹e_¥og_°rög
(
$1
));

1713 
$$
 = 
TYPE_STRING
;

1716 
°rög_c⁄°™t
: 
°rög_c⁄1


1718 
$$
 = 
$1
;

1721 
°rög_c⁄1
: 
F_STRING


1722 | 
°rög_c⁄1
 '+' 
F_STRING


1724 
$$
 = 
	`tm∑Œoc
–
	`°æí
(
$1
Ë+ såÀn(
$3
) + 1 );

1725 ()
	`°r˝y
(
$$
, 
$1
);

1726 ()
	`°rˇt
(
$$
, 
$3
);

1728 | '(' 
°rög_c⁄1
 ')'

1730 
$$
 = 
$2
;

1733 
fun˘i⁄_ˇŒ
:

1734 
F_LOCAL_NAME
 '(' 
ex¥_li°
 ')'

1736 
t
;

1737 
	`ös_f_byã
(
F_LOCAL_NAME
);

1738 
	`ös_byã
(
$1
);

1739 
t
 = 
ty≥_of_loˇls
[
$1
];

1740 i‡(
t
 !
TYPE_FUNCTION
 &&Å !
TYPE_ANY
)

1741 
	`ty≥_îr‹
("CÆ»o‡n⁄-fun˘i⁄", 
t
);

1742 
	`ös_f_byã
(
F_CALL_VAR
);

1743 
	`ös_byã
(
$3
);

1744 
	`p›_¨g_°ack
(
$3
);

1745 #
MUSTCASTFUN


1746 
$$
 = 
TYPE_UNKNOWN
;

1748 
$$
 = 
TYPE_ANY
;

1749 #
ídif


1766 | 
fun˘i⁄_«me
 '(' 
ex¥_li°
 ')'

1771 
öhîôed_ovîride
 = 
	`°rchr
(
$1
, ':'Ë!
NULL
;

1772 
efun_ovîride
 = 
öhîôed_ovîride
 && 
	`°∫cmp
(
$1
,"efun::", 6) == 0;

1773 
is_sfun
 = 0;

1774 
f
;

1776 
$$
 = 
TYPE_ANY
;

1777 i‡(
öhîôed_ovîride
 && !
efun_ovîride
)

1779 
fun˘i⁄
 *
fu≈
;

1786 i‡(
	`deföed_fun˘i⁄
(
$1
))

1789 
fu≈
 = &
fun˘i⁄_¥og_found
->
fun˘i⁄s
[
fun˘i⁄_ödex_found
];

1790 
$$
 = 
fu≈
->
ty≥_Êags
 & 
TYPE_MASK
;

1791 
	`ös_f_byã
(
F_CALL_NON_VIRT
);

1792 
	`ös_byã
 (
fun˘i⁄_öhîô_found
);

1793 
	`ös_sh‹t
 (
fun˘i⁄_ödex_found
);

1794 
	`ös_byã
(
$3
);

1798 
buff
[100];

1800 ()
	`¢¥ötf
(
buff
, (buff), "Fun˘i⁄ %†undeföed", 
$1
);

1801 
	`yyîr‹
(
buff
);

1807 i‡(!
efun_ovîride
 &&

1808 (
	`deföed_fun˘i⁄
 (
$1
Ë|| ((
is_sfun
 = 1Ë&& 
	`is_simul_efun
 ($1))) )

1810 
fun˘i⁄
 *
fu≈
;

1811 *
¨g_ödi˚s
;

1812 *
¨g_ty≥s
;

1814 i‡(
fun˘i⁄_¥og_found
)

1816 
fu≈
 = &(
fun˘i⁄_¥og_found
->

1817 
fun˘i⁄s
[
fun˘i⁄_ödex_found
]);

1818 
¨g_ödi˚s
 = 
fun˘i⁄_¥og_found
->
ty≥_°¨t
;

1819 
¨g_ty≥s
 = 
fun˘i⁄_¥og_found
->
¨gumít_ty≥s
;

1823 
fu≈
 = 
	`FUNCTION
(
fun˘i⁄_ödex_found
);

1827 
¨g_ödi˚s
 = (*Ë
mem_block
[
A_ARGUMENT_INDEX
].
block
;

1828 
¨g_ty≥s
 = (*Ë
mem_block
[
A_ARGUMENT_TYPES
].
block
;

1836 i‡(
exa˘_ty≥s
 && 
fun˘i⁄_¥og_found
 &&

1837 
fun˘i⁄_ty≥_mod_found
 & 
TYPE_MOD_PRIVATE
)

1839 
buff
[100];

1841 ()
	`¢¥ötf
(
buff
, (buff), "Function %s marked 'private'",

1842 
fu≈
->
«me
);

1843 
	`yyîr‹
 (
buff
);

1845 
$$
 = 
fu≈
->
ty≥_Êags
 & 
TYPE_MASK
;

1847 i‡(
is_sfun
)

1849 
	`ös_f_byã
(
F_CALL_SIMUL
);

1850 
	`°‹e_ªloc_d©a
(
R_CALL
, 
mem_block
[
A_PROGRAM
].
cuºít_size
,

1851 
$1
,0,0);

1853 i‡(
fu≈
->
ty≥_Êags
 & 
TYPE_MOD_NO_MASK
)

1855 
	`ös_f_byã
(
F_CALL_NON_VIRT
);

1859 
	`ös_f_byã
 (
F_CALL_VIRT
);

1860 i‡(
fun˘i⁄_¥og_found
)

1861 
	`°‹e_ªloc_d©a
(
R_CALL
,

1862 
mem_block
[
A_PROGRAM
].
cuºít_size
,

1863 
$1
,0,0);

1865 
	`ös_byã
 (
fun˘i⁄_öhîô_found
);

1866 
	`ös_sh‹t
 (
fun˘i⁄_ödex_found
);

1869 
	`ös_byã
 (
$3
);

1874 i‡((
fu≈
->
ty≥_Êags
 & 
NAME_STRICT_TYPES
Ë&& 
exa˘_ty≥s
 &&

1875 
fu≈
->
num_¨g
 !
$3
 &&

1878 !((
fu≈
->
ty≥_Êags
 & 
TYPE_MOD_VARARGS
) &&

1879 
$3
 < 
fu≈
->
num_¨g
) &&

1882 !((
fu≈
->
ty≥_Êags
 & 
TYPE_MOD_TRUE_VARARGS
) &&

1883 
$3
 + 1 >
fu≈
->
num_¨g
) &&

1886 !(
$3
 < 
fu≈
->
num_¨g
 && fu≈->
fú°_deÁu…
 <= $3))

1888 
buff
[100];

1890 ()
	`¢¥ötf
(
buff
, (buff), "Wr⁄gÇumbî o‡¨gumít†tÿ%s", 
$1
);

1891 
	`yyîr‹
(
buff
);

1897 i‡(
fu≈
->
ty≥_Êags
 & 
NAME_STRICT_TYPES
 &&

1898 
exa˘_ty≥s
 && 
¨g_ödi˚s
 &&

1899 
¨g_ödi˚s
[
fun˘i⁄_ödex_found
] !
INDEX_START_NONE
)

1901 
i
, 
fú°
;

1902 
num_check
 = 
fu≈
->
num_¨g
;

1904 i‡(
fu≈
->
ty≥_Êags
 & 
TYPE_MOD_TRUE_VARARGS
)

1905 
num_check
--;

1907 
fú°
 = 
¨g_ödi˚s
[
fun˘i⁄_ödex_found
];

1908 
i
=0; i < 
num_check
 && i < 
$3
; i++)

1910 
tmp
 = 
	`gë_¨gumít_ty≥
(
i
, 
$3
);

1911 i‡(!
	`TYPE
(
tmp
, 
¨g_ty≥s
[
fú°
 + 
i
]))

1913 
buff
[100];

1915 ()
	`¢¥ötf
(
buff
, (buff),

1916 "BadÅy≥ f‹árgumíà%d %s", 
i
+1,

1917 
	`gë_two_ty≥s
(
¨g_ty≥s
[
fú°
+
i
], 
tmp
));

1918 
	`yyîr‹
(
buff
);

1924 i‡(
efun_ovîride
 || (
f
 = 
	`lookup_¥edef
(
$1
)) != -1)

1926 
mö
, 
max
, 
def
, *
¨gp
;

1927 
efun_¨g_ty≥s
[];

1929 i‡(
efun_ovîride
)

1930 
f
 = 
	`lookup_¥edef
(
$1
+6);

1932 i‡(
f
 == -1)

1934 
buff
[100];

1936 ()
	`¢¥ötf
(
buff
, (buff), "Unknow¿efun: %s", 
$1
+6);

1937 
	`yyîr‹
(
buff
);

1941 
mö
 = 
ö°rs
[
f
-
EFUN_FIRST
].
mö_¨g
;

1942 
max
 = 
ö°rs
[
f
-
EFUN_FIRST
].
max_¨g
;

1943 
def
 = 
ö°rs
[
f
-
EFUN_FIRST
].
DeÁu…
;

1944 
$$
 = 
ö°rs
[
f
-
EFUN_FIRST
].
ªt_ty≥
;

1945 
¨gp
 = &
efun_¨g_ty≥s
[
ö°rs
[
f
-
EFUN_FIRST
].
¨g_ödex
];

1946 i‡(
def
 && 
$3
 =
mö
-1)

1948 
	`ös_f_byã
(()
def
);

1949 
max
--;

1950 
mö
--;

1952 i‡(
$3
 < 
mö
)

1954 
bff
[100];

1956 ()
	`¢¥ötf
(
bff
, (bff), "Too fewárgumentsÅo %s",

1957 
ö°rs
[
f
-
EFUN_FIRST
].
«me
);

1958 
	`yyîr‹
(
bff
);

1960 i‡(
$3
 > 
max
 && max != -1)

1962 
bff
[100];

1964 ()
	`¢¥ötf
(
bff
, (bff), "Too manyárgumentsÅo %s",

1965 
ö°rs
[
f
 - 
EFUN_FIRST
].
«me
);

1966 
	`yyîr‹
(
bff
);

1968 i‡(
max
 !-1 && 
exa˘_ty≥s
)

1973 
i
, 
¨gn
;

1974 
buff
[100];

1975 
¨gn
=0;árg¿< 
$3
;árgn++)

1977 
tmp
 = 
	`gë_¨gumít_ty≥
(
¨gn
, 
$3
);

1978 
i
=0; !
	`TYPE
(
¨gp
[i], 
tmp
) &&árgp[i] != 0; i++)

1980 i‡(
¨gp
[
i
] == 0)

1982 ()
	`¢¥ötf
(
buff
, (buff),

1984 
¨gn
+1, 
ö°rs
[
f
-
EFUN_FIRST
].
«me
);

1985 
	`yyîr‹
(
buff
);

1987 
¨gp
[
i
] != 0)

1988 
i
++;

1989 
¨gp
 +
i
 + 1;

1992 
	`ös_f_byã
(()
f
);

1997 i‡(
max
 !
mö
)

1998 
	`ös_byã
(
$3
);

2003 
i
;

2004 
i
 = 
	`vîify_de˛¨ed
(
$1
);

2005 i‡(
i
 !-1 && (ò& 
TYPE_MASK
Ë=
TYPE_FUNCTION
) {

2006 
	`ös_f_byã
(
F_IDENTIFIER
);

2007 
	`ös_byã
(
v¨übÀ_öhîô_found
);

2008 
	`ös_byã
(
v¨übÀ_ödex_found
);

2009 
	`ös_f_byã
(
F_CALL_VAR
);

2010 
	`ös_byã
(
$3
);

2011 #
MUSTCASTFUN


2012 
$$
 = 
TYPE_UNKNOWN
;

2014 
$$
 = 
TYPE_ANY
;

2015 #
ídif


2018 i‡(
exa˘_ty≥s
) {

2019 
buff
[200];

2021 ()
	`¢¥ötf
(
buff
, (buff), "Undeföed fun˘i⁄: %s", 
$1
);

2022 
	`yyîr‹
 (
buff
);

2027 
	`ös_f_byã
(
F_CALL_VIRT
);

2028 
	`°‹e_ªloc_d©a
(
R_CALL
, 
mem_block
[
A_PROGRAM
].
cuºít_size
,

2029 
$1
,0,0);

2030 
	`ös_byã
(()0xFF);

2031 
	`ös_sh‹t
 (-1);

2032 
	`ös_byã
(
$3
);

2033 
$$
 = 
TYPE_ANY
;

2036 
	`p›_¨g_°ack
(
$3
);

2041 | 
ex¥4
 
F_ARROW
 
F_IDENTIFIER


2043 
	`ös_f_byã
(
F_STRING
);

2044 
	`ös_sh‹t
(
	`°‹e_¥og_°rög
(
$3
));

2046 
ﬂrgs


2048 
$$
 = 
$5
;

2051 
ﬂrgs
: '(' 
ex¥_li°
 ')'

2053 
	`ös_f_byã
(
F_CALL_OTHER
);

2054 
	`ös_byã
(
$2
 + 2);

2055 
	`p›_¨g_°ack
(
$2
);

2056 
$$
 = 
TYPE_ANY
;

2060 
	`ös_f_byã
(
F_BUILD_CLOSURE
);

2061 
	`ös_byã
(
FUN_LFUNO
);

2062 
$$
 = 
TYPE_FUNCTION
;

2066 
fun˘i⁄_«me
: 
idítifõr


2068 
c⁄d
: 
c⁄dSèπ


2069 
°©emít


2071 
i
;

2072 
i
 = 
	`p›_addªss
();

2073 
	`ös_f_byã
(
F_JUMP
);

2074 
	`add_jump
();

2075 
	`push_addªss
();

2076 
	`ös_sh‹t
(0);

2077 
	`upd_sh‹t
(
i
, 
mem_block
[
A_PROGRAM
].
cuºít_size
);

2079 
›ti⁄Æ_ñ£_∑π


2080 { 
	`upd_sh‹t
(
	`p›_addªss
(), 
mem_block
[
A_PROGRAM
].
cuºít_size
); } ;

2082 
c⁄dSèπ
: 
F_IF
 '(' 
comma_ex¥
 ')'

2084 
	`ös_f_byã
(
F_JUMP_WHEN_ZERO
);

2085 
	`add_jump
();

2086 
	`push_addªss
();

2087 
	`ös_sh‹t
(0);

2090 
›ti⁄Æ_ñ£_∑π
:

2091 | 
F_ELSE
 
°©emít
 ;

2092 
	}
%%

2094 
	glök_îr‹s
;

2096 
	$ös_f_byã
(
b
)

2098 i‡(
b
 - 
EFUN_FIRST
 < 256)

2099 
	`ös_byã
(()(
b
 - 
EFUN_FIRST
));

2102 
	`ös_byã
(()(
F_EXT
 - 
EFUN_FIRST
));

2103 
	`ös_sh‹t
(()(
b
 - 
EFUN_FIRST
));

2105 
	}
}

2108 
	$yyîr‹
(*
°r
)

2110 
num_∑r£_îr‹
;

2112 i‡(
num_∑r£_îr‹
 > 5)

2114 ()
	`Ârötf
(
°dîr
, "%s: %†löê%d\n", 
cuºít_fûe
, 
°r
,

2115 
cuºít_löe
);

2116 ()
	`fÊush
(
°dîr
);

2117 
	`sm¨t_log
(
cuºít_fûe
, 
cuºít_löe
, 
°r
);

2118 
num_∑r£_îr‹
++;

2119 
	}
}

2122 
	$check_de˛¨ed
(*
°r
)

2124 
v¨übÀ
 *
vp
;

2126 
off£t
;

2127 
öh
;

2128 *
su≥r_«me
 = 0;

2129 *
sub_«me
;

2130 *
ªÆ_«me
;

2131 *
£¨ch
;

2133 
v¨übÀ_ödex_found
 = 
v¨übÀ_öhîô_found
 = 255;

2134 
ªÆ_«me
 = 
	`°ºchr
(
°r
, ':') + 1;

2135 
sub_«me
 = 
	`°rchr
(
°r
, ':') + 2;

2137 if(!(
ªÆ_«me
 = (
	`föd_s°rög
(‘ól_«mê=(*)1Ë? 
°r
 :Ñeal_name))))

2139 i‡(
sub_«me
 == (*)2)

2140 
off£t
 = 0; off£à< 
mem_block
[
A_VARIABLES
].
cuºít_size
;

2141 
off£t
 + (
v¨übÀ
))

2143 
vp
 = (
v¨übÀ
 *)&
mem_block
[
A_VARIABLES
].
block
[
off£t
];

2145 i‡(
ªÆ_«me
 =
vp
->
«me
)

2147 
v¨übÀ_ty≥_mod_found
 = 
vp
->
ty≥
;

2148 
v¨übÀ_ödex_found
 = 
off£t
 /  (
v¨übÀ
);

2149 
v¨übÀ_öhîô_found
 = 255;

2150  
v¨übÀ_ödex_found
;

2154 i‡(
sub_«me
 - 
°r
 > 2)

2156 
su≥r_«me
 = 
	`xÆloc
((
size_t
)(
sub_«me
 - 
°r
 - 1));

2157 ()
	`mem˝y
(
su≥r_«me
, 
°r
, (
size_t
)(
sub_«me
 - str - 2));

2158 
su≥r_«me
[
sub_«me
 - 
°r
 - 2] = 0;

2159 i‡(
	`°rcmp
(
su≥r_«me
, "this") == 0)

2160  
	`check_de˛¨ed
(
sub_«me
);

2163 
°r
 = 
sub_«me
;

2168 
öh
 = 
mem_block
[
A_INHERITS
].
cuºít_size
 /  (
öhîô
) - 1;

2169 
öh
 >0; inh -((
öhîô
 *)
mem_block
[
A_INHERITS
].
block
)[öh].
¥og
->

2170 
num_öhîôed
)

2172 i‡(
su≥r_«me
 &&

2173 
	`°rcmp
(
su≥r_«me
, ((
öhîô
 *)
mem_block
[
A_INHERITS
].
block
)[
öh
].
«me
) == 0)

2174 
£¨ch
 = 
sub_«me
;

2176 
£¨ch
 = 
°r
;

2177 i‡(
	`föd_°©us
 (((
öhîô
 *)
mem_block
[
A_INHERITS
].
block
)[
öh
].
¥og
,

2178 
£¨ch
, 
TYPE_MOD_PRIVATE
) != -1)

2181 
ty≥
 = ((
öhîô
 *)
mem_block
[
A_INHERITS
].
block
)[
öh
].type;

2183 i‡(
v¨übÀ_ty≥_mod_found
 & 
TYPE_MOD_PRIVATE
)

2184 
ty≥
 &~
TYPE_MOD_PUBLIC
;

2185 i‡(
v¨übÀ_ty≥_mod_found
 & 
TYPE_MOD_PUBLIC
)

2186 
ty≥
 &~
TYPE_MOD_PRIVATE
;

2187 
v¨übÀ_ty≥_mod_found
 |
ty≥
 & 
TYPE_MOD_MASK
;

2189 
v¨übÀ_öhîô_found
 +
öh
 -

2190 (((
öhîô
 *)
mem_block
[
A_INHERITS
].
block
)[
öh
].
¥og
->

2191 
num_öhîôed
 - 1);

2196 
	}
}

2199 
	$h™dÀ_fun˘i⁄_id
(*
°r
)

2201 
i
;

2203 i‡(
	`deföed_fun˘i⁄
(
°r
)) {

2204 
	`ös_f_byã
(
F_STRING
);

2205 
	`ös_sh‹t
(
	`°‹e_¥og_°rög
(
°r
));

2206 
	`ös_f_byã
(
F_BUILD_CLOSURE
);

2207 
	`ös_byã
(
FUN_LFUN
);

2208 
	`ös_byã
(
fun˘i⁄_öhîô_found
);

2209 
	`ös_sh‹t
(
fun˘i⁄_ödex_found
);

2211 } i‡(
	`is_simul_efun
(
°r
)) {

2212 
	`ös_f_byã
(
F_STRING
);

2213 
	`ös_sh‹t
(
	`°‹e_¥og_°rög
(
°r
));

2214 
	`ös_f_byã
(
F_BUILD_CLOSURE
);

2215 
	`ös_byã
(
FUN_SFUN
);

2217 } i‡((
i
 = 
	`lookup_¥edef
(
°r
)) != -1) {

2218 
	`ös_f_byã
(
F_BUILD_CLOSURE
);

2219 
	`ös_byã
(
FUN_EFUN
);

2220 
	`ös_sh‹t
(
i
);

2225 
	}
}

2228 
	$vîify_de˛¨ed
(*
°r
)

2230 
r
;

2232 
r
 = 
	`check_de˛¨ed
(
°r
);

2233 i‡(
r
 == -1)

2237 i‡(
v¨übÀ_öhîô_found
 == 255)

2238  ((
v¨übÀ
 *)
mem_block
[
A_VARIABLES
].
block
)[
v¨übÀ_ödex_found
].

2239 
ty≥
;

2241  ((
öhîô
 *)
mem_block
[
A_INHERITS
].
block
)[
v¨übÀ_öhîô_found
].

2242 
¥og
->
v¨übÀ_«mes
[
v¨übÀ_ödex_found
].
ty≥
;

2243 
	}
}

2246 
	$‰ì_Æl_loˇl_«mes
()

2248 
cuºít_numbî_of_loˇls
 = 0;

2249 
	}
}

2252 
	$add_loˇl_«me
(*
°r
, 
ty≥
)

2254 i‡(
cuºít_numbî_of_loˇls
 =
MAX_LOCAL
)

2255 
	`yyîr‹
("Too manyÜocal variables");

2257 
ty≥_of_loˇls
[
cuºít_numbî_of_loˇls
] = 
ty≥
;

2258 
loˇl_blockdïth
[
cuºít_numbî_of_loˇls
] = 
block_dïth
;

2259 
loˇl_«mes
[
cuºít_numbî_of_loˇls
++] = 
°r
;

2261  
cuºít_numbî_of_loˇls
 - 1;

2262 
	}
}

2266 
	$föd_öhîô
(
¥ogøm
 *
¥og1
, ¥ogøm *
¥og2
)

2268 
i
;

2270 
i
 = 0; i < ()
¥og1
->
num_öhîôed
; i++)

2271 i‡(
¥og1
->
öhîô
[
i
].
¥og
 =
¥og2
)

2272  
i
;

2274 
	}
}

2277 
	$c›y_öhîôs
(
¥ogøm
 *
‰om
, 
ty≥
, *
«me
)

2279 
i
;

2280 
öhîô
 
öh
;

2281 
j
[256], 
k
 = 0;

2282 
buf
[256];

2284 i‡(!
has_öhîôed
)

2286 
	`‰ì_s°rög
(((
öhîô
 *)
mem_block
[
A_INHERITS
].
block
)->
«me
);

2287 
mem_block
[
A_INHERITS
].
cuºít_size
 = 0;

2288 
has_öhîôed
 = 1;

2290 #ifde‡
USE_SWAP


2291 
	`ac˚ss_¥ogøm
(
‰om
);

2293 
i
 = 0; i < ()
‰om
->
num_v¨übÀs
; i++)

2294 i‡((
ty≥
 | 
‰om
->
v¨übÀ_«mes
[
i
].ty≥Ë& 
TYPE_MOD_NO_MASK
 &&

2295 
	`check_de˛¨ed
(
‰om
->
v¨übÀ_«mes
[
i
].
«me
) != -1 &&

2296 (
v¨übÀ_öhîô_found
 =255 || ((
öhîô
 *)

2297 (
mem_block
[
A_INHERITS
].
block
))[
v¨übÀ_öhîô_found
].
¥og
 !
‰om
))

2299 ()
	`¢¥ötf
(
buf
, (buf),

2301 
‰om
->
v¨übÀ_«mes
[
i
].
«me
,

2302 
‰om
->
«me
);

2303 
	`yyîr‹
(
buf
);

2306 
i
 = 0; i < (Ë
‰om
->
num_fun˘i⁄s
; i++)

2307 i‡((
ty≥
 | 
‰om
->
fun˘i⁄s
[
i
].
ty≥_Êags
Ë& 
TYPE_MOD_NO_MASK
 &&

2308 
	`deföed_fun˘i⁄
(
‰om
->
fun˘i⁄s
[
i
].
«me
) &&

2309 
fun˘i⁄_¥og_found
 !
‰om
)

2311 ()
	`¢¥ötf
(
buf
, (buf),

2313 
‰om
->
fun˘i⁄s
[
i
].
«me
,

2314 
‰om
->
«me
);

2315 
	`yyîr‹
(
buf
);

2318 
i
 = 
‰om
->
num_öhîôed
 - 2; i >= 0;

2319 
i
 -
‰om
->
öhîô
[i].
¥og
->
num_öhîôed
)

2320 
j
[
k
++] = 
i
;

2322 
k
) {

2324 
√w_ty≥
 = 
ty≥
;

2325 
ﬁd_ty≥
;

2327 
i
 = 
j
[--
k
];

2328 
ﬁd_ty≥
 = 
‰om
->
öhîô
[
i
].
ty≥
;

2330 i‡(
ﬁd_ty≥
 & 
TYPE_MOD_PRIVATE
)

2331 
√w_ty≥
 &~
TYPE_MOD_PUBLIC
;

2332 i‡(
ﬁd_ty≥
 & 
TYPE_MOD_PUBLIC
)

2333 
√w_ty≥
 &~
TYPE_MOD_PRIVATE
;

2335 
	`c›y_öhîôs
(
‰om
->
öhîô
[
i
].
¥og
,

2336 
ﬁd_ty≥
 | 
√w_ty≥
,

2337 
‰om
->
öhîô
[
i
].
«me
);

2340 
öh
 = 
‰om
->
öhîô
[‰om->
num_öhîôed
 - 1];

2343 
öh
.
«me
 = 
	`make_s°rög
(name);

2344 
öh
.
ty≥
 =Åype;

2345 
	`add_to_mem_block
 (
A_INHERITS
, (*)&
öh
,  inh);

2346 
	}
}

2349 
	$check_öhîôs
(
¥ogøm
 *
‰om
)

2351 
i
, 
upd©e
 = 0;

2352 
obje˘
 *
ob
;

2353 
size_t
 
Àn
 = 
	`°æí
(
‰om
->
«me
) - 1;

2354 *
ob_«me
 = 
	`Æloˇ
(
Àn
);

2356 ()
	`°∫˝y
(
ob_«me
, 
‰om
->
«me
, 
Àn
 - 1);

2357 
ob_«me
[
Àn
 - 1] = 0;

2358 
ob
 = 
	`föd_obje˘2
(
ob_«me
);

2360 i‡(!
ob
 || ob->
¥og
 !
‰om
)

2363 
i
 = 
‰om
->
num_öhîôed
 - 2; i >= 0;

2364 
i
 -
‰om
->
öhîô
[i].
¥og
->
num_öhîôed
)

2365 i‡(!
	`check_öhîôs
(
‰om
->
öhîô
[
i
].
¥og
))

2366 
upd©e
 = 1;

2368 i‡(
upd©e
)

2370 i‡(
ob
) {

2371 
ob
->
¥og
->
Êags
 &~
PRAGMA_RESIDENT
;

2372 
	`de°ru˘_obje˘
(
ob
);

2377 
	}
}

2380 
	$hash_func
 (
size
, 
fun˘i⁄
 *
‰om
, 
fun˘i⁄_hash
 *
to
)

2382 
fú°_hﬁe
;

2383 
fú°_cﬁlisi⁄
;

2384 
œ°_cﬁlisi⁄
, 
√xt_cﬁlisi⁄
;

2385 
i
, 
¥obe
;

2386 *
back
;

2388 i‡(
size
 <= 0)

2391 
back
 = (*Ë
	`Æloˇ
((Ë* 
size
);

2393 
fú°_hﬁe
 = 0;

2394 
fú°_cﬁlisi⁄
 = -1;

2395 
i
 = 0; i < 
size
; i++)

2397 
to
[
i
].
√xt_hashed_fun˘i⁄
 = i+1;

2398 
back
[
i
] = i-1;

2399 
to
[
i
].
«me
 = 0;

2401 
to
[
size
-1].
√xt_hashed_fun˘i⁄
 = -1;

2403 
i
 = 0, 
œ°_cﬁlisi⁄
 = -1; i < 
size
; i++)

2405 
¥obe
 = 
	`PTR_HASH
(
‰om
[
i
].
«me
, 
size
);

2406 i‡(!
to
[
¥obe
].
«me
)

2408 i‡(
back
[
¥obe
] == -1)

2409 
fú°_hﬁe
 = 
to
[
¥obe
].
√xt_hashed_fun˘i⁄
;

2411 
to
[
back
[
¥obe
]].
√xt_hashed_fun˘i⁄
 =

2412 
to
[
¥obe
].
√xt_hashed_fun˘i⁄
;

2413 i‡(
to
[
¥obe
].
√xt_hashed_fun˘i⁄
 != -1)

2414 
back
[
to
[
¥obe
].
√xt_hashed_fun˘i⁄
] = back[probe];

2415 
to
[
¥obe
].
«me
 = 
‰om
[
i
].name;

2416 
to
[
¥obe
].
func_ödex
 = 
i
;

2417 
‰om
[
i
].
hash_idx
 = 
¥obe
;

2418 
to
[
¥obe
].
√xt_hashed_fun˘i⁄
 = -1;

2422 i‡(
fú°_cﬁlisi⁄
 == -1)

2423 
œ°_cﬁlisi⁄
 = 
fú°_cﬁlisi⁄
 = 
i
;

2426 
‰om
[
œ°_cﬁlisi⁄
].
hash_idx
 = 
i
;

2427 
œ°_cﬁlisi⁄
 = 
i
;

2429 
‰om
[
i
].
hash_idx
 = -1;

2433  ; 
fú°_cﬁlisi⁄
 != -1;

2434 
fú°_cﬁlisi⁄
 = 
√xt_cﬁlisi⁄
)

2436 
i
 = 
fú°_hﬁe
;

2437 
fú°_hﬁe
 = 
to
[
i
].
√xt_hashed_fun˘i⁄
;

2438 
to
[
i
].
«me
 = 
‰om
[
fú°_cﬁlisi⁄
].name;

2439 
to
[
i
].
func_ödex
 = 
fú°_cﬁlisi⁄
;

2440 
to
[
i
].
√xt_hashed_fun˘i⁄
 = -1;

2441 
√xt_cﬁlisi⁄
 = 
‰om
[
fú°_cﬁlisi⁄
].
hash_idx
;

2442 
‰om
[
fú°_cﬁlisi⁄
].
hash_idx
 = 
i
;

2443 
¥obe
 = 
	`PTR_HASH
 (
to
[
i
].
«me
, 
size
);

2444 
to
[
¥obe
].
√xt_hashed_fun˘i⁄
 != -1;

2445 
¥obe
 = 
to
[¥obe].
√xt_hashed_fun˘i⁄
)

2447 
to
[
¥obe
].
√xt_hashed_fun˘i⁄
 = 
i
;

2450 
	}
}

2455 
	g¥ev_löe
, 
	g¥ev_fûe
, 
	g¥ev_code
;

2456 
	gœ°_löe
, 
	gœ°_fûe
, 
	gœ°_code
;

2459 
	$öô_löío_öfo
()

2461 
¥ev_löe
 = 
¥ev_fûe
 = 
¥ev_code
 = 0;

2462 
œ°_löe
 = 
œ°_fûe
 = 
œ°_code
 = 0;

2463 
	}
}

2466 
	$íd_löío_öfo
()

2468 
code
;

2469 
tmp
;

2471 
code
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

2472 
code
 - 
œ°_code
 >= 0xF0) {

2473 
tmp
 = 0x00;

2474 
	`add_to_mem_block
(
A_LINENUMBERS
, &
tmp
, 1);

2476 i‡(
code
 > (
œ°_code
 += 0xF0)) {

2477 
tmp
 = ()0xF9;

2478 
	`add_to_mem_block
(
A_LINENUMBERS
, &
tmp
, 1);

2481 i‡(
code
 > 
œ°_code
) {

2482 
tmp
 = 
code
 - 
œ°_code
;

2483 
	`add_to_mem_block
(
A_LINENUMBERS
, &
tmp
, 1);

2485 
	}
}

2488 
	$°‹e_löe_numbî_öfo
(
fûe
, 
löe
)

2490 
code
;

2491 
tmp
;

2493 i‡(
fûe
 =
¥ev_fûe
 && 
löe
 =
¥ev_löe
)

2496 
code
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

2498 i‡(
code
 =
¥ev_code
) {

2499 
¥ev_löe
 = 
löe
;

2500 
¥ev_fûe
 = 
fûe
;

2504 i‡(
¥ev_löe
 =
œ°_löe
 && 
¥ev_fûe
 =
œ°_fûe
) {

2505 
¥ev_code
 = 
code
;

2506 
¥ev_löe
 = 
löe
;

2507 
¥ev_fûe
 = 
fûe
;

2511 
¥ev_code
 - 
œ°_code
 >= 0xF0) {

2512 
tmp
 = 0x00;

2513 
	`add_to_mem_block
(
A_LINENUMBERS
, &
tmp
, 1);

2514 
œ°_löe
++;

2516 i‡(
¥ev_code
 > (
œ°_code
 += 0xF0)) {

2517 
tmp
 = ()0xF9;

2518 
	`add_to_mem_block
(
A_LINENUMBERS
, &
tmp
, 1);

2519 
œ°_löe
--;

2523 i‡(
¥ev_code
 > 
œ°_code
) {

2524 
tmp
 = 
¥ev_code
 - 
œ°_code
;

2525 
	`add_to_mem_block
(
A_LINENUMBERS
, &
tmp
, 1);

2526 
œ°_löe
++;

2529 
œ°_code
 = 
¥ev_code
;

2530 
¥ev_code
 = 
code
;

2532 i‡(
œ°_fûe
 !
¥ev_fûe
) {

2534 
tmp
 = ()0xF8;

2535 
	`add_to_mem_block
(
A_LINENUMBERS
, &
tmp
, 1);

2536 
tmp
 = 
¥ev_fûe
;

2537 
	`add_to_mem_block
(
A_LINENUMBERS
, &
tmp
, 1);

2538 
tmp
 = (()
¥ev_löe
 >> 8) & 0xFF;

2539 
	`add_to_mem_block
(
A_LINENUMBERS
, &
tmp
, 1);

2540 
tmp
 = 
¥ev_löe
 & 0xFF;

2541 
	`add_to_mem_block
(
A_LINENUMBERS
, &
tmp
, 1);

2542 
œ°_fûe
 = 
¥ev_fûe
;

2543 
œ°_löe
 = 
¥ev_löe
;

2545 i‡(
œ°_löe
 !
¥ev_löe
) {

2546 i‡(
œ°_löe
 < 
¥ev_löe
 &&Örev_line -Üast_line <= 0x7) {

2547 
tmp
 = ()(0xF0 | (
¥ev_löe
 - 
œ°_löe
));

2548 
	`add_to_mem_block
(
A_LINENUMBERS
, &
tmp
, 1);

2550 i‡(
œ°_löe
 > 
¥ev_löe
 &&Üast_line -Örev_line <= 0x07) {

2551 
tmp
 = ()(0xF8 | (
œ°_löe
 - 
¥ev_löe
));

2552 
	`add_to_mem_block
(
A_LINENUMBERS
, &
tmp
, 1);

2555 
tmp
 = ()0xF0;

2556 
	`add_to_mem_block
(
A_LINENUMBERS
, &
tmp
, 1);

2557 
tmp
 = (()
¥ev_löe
 >> 8) & 0xFF;

2558 
	`add_to_mem_block
(
A_LINENUMBERS
, &
tmp
, 1);

2559 
tmp
 = 
¥ev_löe
 & 0xFF;

2560 
	`add_to_mem_block
(
A_LINENUMBERS
, &
tmp
, 1);

2562 
œ°_löe
 = 
¥ev_löe
;

2564 
	}
}

2567 
	$°‹e_ªloc_d©a
(
ty≥
, 
addªss
, *
«me
,

2568 
vÆue
, 
modifõr
)

2570 
ªloc
 
ªl
;

2571 
ªl
.
ty≥
 =Åype;

2572 
ªl
.
modifõr
 = modifier;

2573 
ªl
.
addªss
 =áddress;

2574 
ªl
.
«me
 = 
	`°rög_c›y
(name);

2575 
ªl
.
vÆue
 = value;

2577 
	`add_to_mem_block
(
A_RELOC
, (*)&
ªl
, (
ªloc
));

2578 
	}
}

2580 
	$gë_ty≥_«me
(
ty≥
)

2582 
buff
[100];

2583 *
ty≥_«me
[] = { "unknown", "int", "string",

2586 
poöãr
 = 0;

2588 
buff
[0] = 0;

2589 i‡(
ty≥
 & 
TYPE_MOD_STATIC
)

2590 ()
	`°rˇt
(
buff
, "static ");

2591 i‡(
ty≥
 & 
TYPE_MOD_NO_MASK
)

2592 ()
	`°rˇt
(
buff
, "nomask ");

2593 i‡(
ty≥
 & 
TYPE_MOD_PRIVATE
)

2594 ()
	`°rˇt
(
buff
, "private ");

2595 i‡(
ty≥
 & 
TYPE_MOD_PUBLIC
)

2596 ()
	`°rˇt
(
buff
, "public ");

2597 i‡(
ty≥
 & 
TYPE_MOD_VARARGS
)

2598 ()
	`°rˇt
(
buff
, "varargs ");

2599 
ty≥
 &
TYPE_MASK
;

2600 i‡(
ty≥
 & 
TYPE_MOD_POINTER
) {

2601 
poöãr
 = 1;

2602 
ty≥
 &~
TYPE_MOD_POINTER
;

2604 i‡(
ty≥
 > 
ty≥_«me
 / Åype_name[0])

2605 
	`Áèl
("BadÅype\n");

2606 ()
	`°rˇt
(
buff
, 
ty≥_«me
[
ty≥
]);

2607 ()
	`°rˇt
(
buff
," ");

2608 i‡(
poöãr
)

2609 ()
	`°rˇt
(
buff
, "* ");

2610  
buff
;

2611 
	}
}

2614 
	$ty≥_îr‹
(*
°r
, 
ty≥
)

2616 
buff
[100];

2617 *
p
;

2618 
p
 = 
	`gë_ty≥_«me
(
ty≥
);

2619 i‡(
	`°æí
(
°r
Ë+ såÀn(
p
Ë+ 5 > 
buff
)

2621 
	`yyîr‹
(
°r
);

2625 ()
	`°r˝y
(
buff
, 
°r
);

2626 ()
	`°rˇt
(
buff
, ": \"");

2627 ()
	`°rˇt
(
buff
, 
p
);

2628 ()
	`°rˇt
(
buff
, "\"");

2629 
	`yyîr‹
(
buff
);

2631 
	}
}

2634 
	$ªmove_undeföed_¥ŸŸy≥s
 (
num_fun˘i⁄s
, 
fun˘i⁄
 *
fun˘i⁄s
)

2636 
i
;

2637 
i
 = 0; i < 
num_fun˘i⁄s
;i++)

2639 i‡(
fun˘i⁄s
[
i
].
ty≥_Êags
 & 
NAME_PROTOTYPE
)

2641 
buff
[500];

2643 ()
	`¢¥ötf
(
buff
, (buff),

2645 
fun˘i⁄s
[
i
].
«me
);

2646 
	`yyîr‹
(
buff
);

2649  
num_fun˘i⁄s
;

2650 
	}
}

2656 
	$compûe_fûe
()

2658 
	`yy∑r£
 ();

2660 
	`¥ﬁog
();

2661 ()
	`yy∑r£
();

2662 
	`ïûog
();

2663 
	}
}

2666 
	$gë_two_ty≥s
(
ty≥1
, 
ty≥2
)

2668 
buff
[100];

2670 ()
	`°r˝y
(
buff
, "( ");

2671 ()
	`°rˇt
(
buff
, 
	`gë_ty≥_«me
(
ty≥1
));

2672 ()
	`°rˇt
(
buff
, "vs ");

2673 ()
	`°rˇt
(
buff
, 
	`gë_ty≥_«me
(
ty≥2
));

2674 ()
	`°rˇt
(
buff
, ")");

2675  
buff
;

2676 
	}
}

2685 
	$ªmembî_ö˛ude
(*
buf
)

2687 
°©
 
sbuf
;

2688 
numbî
[128];

2690 i‡(
	`°©
(
buf
, &
sbuf
)==-1)

2691 
	`Áèl
("LIBÇotábleÅo stat open file\n");

2692 ()
	`•rötf
(
numbî
,"%ld:", ()
sbuf
.
°_mtime
);

2693 
	`add_to_mem_block
(
A_INCLUDES
, 
numbî
, ()
	`°æí
(number));

2694 
	`add_to_mem_block
(
A_INCLUDES
, 
buf
, ()
	`°æí
(buf) + 1);

2695 
	}
}

2702 
	gcuºít_id_numbî
 = 1;

2703 
	#H_OFFSET
(
¨g
Ë(((*)&(((
¥ogøm
 *)0)->arg)) -\

2704 ((*)((
¥ogøm
 *)0)))

	)

2706 
£˘i⁄_desc
 
	g£c_hdr
[] =

2708 {
A_HEADER
, -1, -1, (
¥ogøm
)},

2709 {
A_INHERITS
, 
H_OFFSET
(
öhîô
), H_OFFSET(
num_öhîôed
),

2710 (
öhîô
)},

2711 {
A_FUNC_HASH
, 
H_OFFSET
(
func_hash
), -1, (
fun˘i⁄_hash
)},

2714 
£˘i⁄_desc
 
	g£c_exe
[] =

2716 {
A_PROGRAM
, 
H_OFFSET
(
¥ogøm
), H_OFFSET(
¥ogøm_size
), 1},

2717 {
A_RODATA
, 
H_OFFSET
(
rod©a
), H_OFFSET(
rod©a_size
), 1},

2718 {
A_FUNCTIONS
, 
H_OFFSET
(
fun˘i⁄s
), H_OFFSET(
num_fun˘i⁄s
),

2719 (
fun˘i⁄
)},

2720 {
A_VARIABLES
, 
H_OFFSET
(
v¨übÀ_«mes
), H_OFFSET(
num_v¨übÀs
),

2721 (
v¨übÀ
)},

2722 {
A_CFUN
, 
H_OFFSET
(
cfuns
), -1, (
cfun_desc
)},

2725 
£˘i⁄_desc
 
	g£c_dbg
[] =

2727 {
A_LINENUMBERS
, 
H_OFFSET
(
löe_numbîs
),

2728 
H_OFFSET
(
sizeof_löe_numbîs
), 1},

2729 {
A_INCLUDES
, 
H_OFFSET
(
ö˛ude_fûes
),

2730 
H_OFFSET
(
sizeof_ö˛ude_fûes
), 1},

2734 
£gmít_desc
 
	g£gm_desc
[] =

2737 { -1, -1, 
H_OFFSET
(
tŸÆ_size
),
£c_hdr
, },

2740 { 
H_OFFSET
(
¥ogøm
), H_OFFSET(
sw≠_num
), H_OFFSET(
exec_size
),
£c_exe
, },

2743 { 
H_OFFSET
(
löe_numbîs
), H_OFFSET(
sw≠_löío_ödex
),

2744 
H_OFFSET
(
debug_size
),
£c_dbg
, },

2745 { -1, -1, -1, (
£˘i⁄_desc
 *)0 },

2749 
	$lﬂd_£gmíts
(
£gmít_desc
 *
£g
, 
mem_block
 *
mem_block1
)

2751 *
hdr
 = 0;

2752 
size
;

2753 *
block
;

2754 
£˘i⁄_desc
 *
£˘
;

2756  ; 
£g
->
£˘i⁄s
 !
NULL
; seg++)

2758 
size
 = 0;

2759 
£˘
 = 
£g
->
£˘i⁄s
; se˘->
£˘i⁄
 != -1; sect++)

2760 
size
 +
	`Æign
(
mem_block1
[
£˘
->
£˘i⁄
].
cuºít_size
);

2762 i‡(
size
)

2763 
block
 = 
	`xÆloc
((
size_t
)
size
);

2765 
block
 = 
	`xÆloc
(1);

2766 #ifde‡
PURIFY


2767 ()
	`mem£t
(
block
, '\0', 
size
 ? size : 1);

2770 i‡(!
hdr
)

2771 
hdr
 = 
block
;

2773 i‡(
£g
->
±r_off£t
 != -1)

2774 *(**)(
hdr
 + 
£g
->
±r_off£t
Ë
block
;

2776 
£˘
 = 
£g
->
£˘i⁄s
; se˘->
£˘i⁄
 != -1; sect++)

2778 ()
	`mem˝y
(
block
, 
mem_block1
[
£˘
->
£˘i⁄
].block,

2779 (
size_t
)
mem_block1
[
£˘
->
£˘i⁄
].
cuºít_size
);

2781 i‡(
£˘
->
±r_off£t
 != -1)

2782 *(**)(
hdr
 + 
£˘
->
±r_off£t
Ë
block
;

2783 i‡(
£˘
->
num_off£t
 != -1)

2784 *(*)(
hdr
 + 
£˘
->
num_off£t
) =

2785 
mem_block1
[
£˘
->
£˘i⁄
].
cuºít_size
 /

2786 
£˘
->
ít_size
;

2788 
block
 +
	`Æign
(
mem_block1
[
£˘
->
£˘i⁄
].
cuºít_size
);

2790 i‡(
£g
->
size_off£t
 != -1)

2791 *(*)(
hdr
 + 
£g
->
size_off£t
Ë
size
;

2793  
hdr
;

2794 
	}
}

2797 
	$¥o˚ss_ªloc
(
ªloc
 *ªloc, 
num_ªlocs
, 
num_öhîôed
)

2799 
i
;

2800 *
«me
;

2801 
fix
;

2802 
psize
;

2804 
psize
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

2805 
lök_îr‹s
 = 0;

2807 
i
 = 0; i < 
num_ªlocs
; i++, 
ªloc
++)

2809 i‡(
ªloc
->
addªss
 >
psize
)

2810 
	`Áèl
("CorruptÑelocationáddress.\n");

2812 
«me
 = 
ªloc
->name;

2813 
ªloc
->
ty≥
)

2815 
ˇŒ_efun
;

2816 
R_CALL
:

2817 
ˇŒ_efun
 = 0;

2818 i‡(!
	`deföed_fun˘i⁄
(
«me
) ||

2819 ((
fun˘i⁄_ty≥_mod_found
 & 
TYPE_MOD_PRIVATE
) &&

2820 
fun˘i⁄_öhîô_found
 !
num_öhîôed
))

2822 i‡(
	`is_simul_efun
(
«me
))

2824 
ˇŒ_efun
 = 
F_CALL_SIMUL
;

2825 
fun˘i⁄_ödex_found
 = 
	`°‹e_¥og_°rög
(
«me
);

2826 
fun˘i⁄_öhîô_found
 = 0;

2830 
lök_îr‹s
++;

2831 ()
	`Ârötf
(
°dîr
,"%s Function %s doesn'tÉxist.\n",

2832 
	`ö√r_gë_§ccode_posôi⁄
(

2833 
ªloc
->
addªss
,

2834 
mem_block
[
A_LINENUMBERS
].
block
,

2835 
mem_block
[
A_LINENUMBERS
].
cuºít_size
,

2836 
mem_block
[
A_INCLUDES
].
block
,

2837 
cuºít_fûe
), 
«me
);

2838 ()
	`fÊush
(
°dîr
);

2842 i‡(
	`°rchr
(
«me
,':'Ë|| 
fun˘i⁄_ty≥_mod_found
 & 
TYPE_MOD_NO_MASK
)

2843 
ˇŒ_efun
 = 
F_CALL_NON_VIRT
;

2845 
ˇŒ_efun
 = 
F_CALL_VIRT
;

2847 
fix
 = 
fun˘i⁄_ödex_found
;

2848 
mem_block
[
A_PROGRAM
].
block
[
ªloc
->
addªss
 - 1] =

2849 
ˇŒ_efun
 - 
EFUN_FIRST
;

2850 
mem_block
[
A_PROGRAM
].
block
[
ªloc
->
addªss
] =

2851 
fun˘i⁄_öhîô_found
;

2852 
mem_block
[
A_PROGRAM
].
block
[
ªloc
->
addªss
 + 1] =

2853 ((*)&
fix
)[0];

2854 
mem_block
[
A_PROGRAM
].
block
[
ªloc
->
addªss
 + 2] =

2855 ((*)&
fix
)[1];

2859 
	`Áèl
("UnsupportedÑeloc data.\n");

2862 
	}
}

2865 
	$lök_C_fun˘i⁄s
(*
«me
)

2867 
i
, 
j
;

2868 
cfun_desc
 
cfun
;

2869 
num_öhîôed
;

2870 
num_öhîôed
 =

2871 
mem_block
[
A_INHERITS
].
cuºít_size
 /

2872 (
öhîô
);

2874 
i
 = 0; 
öãrÁ˚
[i]; i++)

2875 i‡(
	`°rcmp
(
öãrÁ˚
[
i
]->
¥ogøm
, 
«me
) == 0)

2876 
j
 = 0; 
öãrÁ˚
[
i
]->
v¨s
[j]; j++)

2878 i‡(
	`check_de˛¨ed
(
öãrÁ˚
[
i
]->
v¨s
[
j
]->
«me
)

2881 
buf
[100];

2883 ()
	`¢¥ötf
(
buf
, (buf),

2885 
öãrÁ˚
[
i
]->
v¨s
[
j
]->
«me
);

2886 
cuºít_löe
 = -1;

2887 
	`yyîr‹
(
buf
);

2890 i‡(
v¨übÀ_öhîô_found
 == 255)

2891 
v¨übÀ_öhîô_found
 = 
num_öhîôed
;

2892 
cfun
.
idx
 = 
v¨übÀ_ödex_found
;

2893 
cfun
.
öh
 = 
v¨übÀ_öhîô_found
 - 
num_öhîôed
;

2894 
	`add_to_mem_block
(
A_CFUN
, (*)&
cfun
, (cfun));

2896 
	}
}

2903 
	$›timize_jumps
()

2905 
jumps
, *
ù
, 
i
, 
off£t1
, 
off£t2
, 
›code
;

2910 
jumps
 = 
	`mem_block_size
(
A_JUMPS
,  ());

2915 
ù
 = (*)
mem_block
[
A_JUMPS
].
block
;

2920 
i
 = 0; i < 
jumps
; i++)

2925 
off£t2
 = ()
	`ªad_sh‹t
(*
ù
);

2935 
off£t1
 = 
off£t2
;

2940 
›code
 = ()
	`ªad_byã
(
off£t2
++);

2941 i‡(
›code
 =
F_EXT
 - 
EFUN_FIRST
)

2943 
›code
 = ()
	`ªad_sh‹t
(
off£t2
);

2944 
off£t2
 += 2;

2951 i‡(
›code
 !
F_JUMP
 - 
EFUN_FIRST
)

2957 
off£t2
 = ()
	`ªad_sh‹t
(offset2);

2964 i‡(
off£t2
 =
off£t1
)

2970 
	`upd_sh‹t
(*
ù
, 
off£t2
);

2973 
ù
++;

2975 
	}
}

2978 
	$ïûog
()

2980 
i
, 
ix
;

2981 
¥agma_ªsidít
;

2982 
cuºít_time
;

2983 
fun˘i⁄s_À·
;

2984 
tŸÆ_¥ogøm_size
;

2985 
has_öv¨ü¡
 = -1;

2986 
öhîô
 
öhîô_£lf
;

2987 
has_dt‹
, 
has_˘‹
;

2989 #ifde‡
DEBUG


2990 i‡(
num_∑r£_îr‹
 =0 && 
ty≥_of_¨gumíts
.
cuºít_size
 != 0)

2991 
	`Áèl
("FailedÅo deallocateárgumentÅype stack\n");

2993 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


2994 i‡(
ty≥_of_¨gumíts
.
block
 !
NULL
)

2996 
ty≥_of_¨gumíts
.
max_size
 = 0;

2997 
ty≥_of_¨gumíts
.
cuºít_size
 = 0;

2998 
	`‰ì
(
ty≥_of_¨gumíts
.
block
);

2999 
ty≥_of_¨gumíts
.
block
 = 
NULL
;

3006 i‡(
	`deföed_fun˘i⁄
(".CTOR"Ë&& !
fun˘i⁄_¥og_found
)

3008 
has_˘‹
 = 
fun˘i⁄_ödex_found
;

3011 
has_˘‹
 = -1;

3013 i‡(
	`deföed_fun˘i⁄
(".DTOR"Ë&& !
fun˘i⁄_¥og_found
)

3015 
has_dt‹
 = 
fun˘i⁄_ödex_found
;

3018 
has_dt‹
 = -1;

3020 i‡(
fú°_œ°_öôülizî_íd
 !
œ°_öôülizî_íd
)

3022 i‡(
has_˘‹
 != -1)

3024 
fun˘i⁄
 *
fu≈1
;

3026 
fu≈1
 = &((
fun˘i⁄
 *)

3027 
mem_block
[
A_FUNCTIONS
].
block
)[
has_˘‹
];

3028 
	`upd_sh‹t
(
œ°_öôülizî_íd
, 
fu≈1
->
off£t
);

3029 
fu≈1
->
off£t
 = 0;

3033 
has_˘‹
 = 
mem_block
[
A_FUNCTIONS
].
cuºít_size
 /

3034 (
fun˘i⁄
);

3035 
	`deföe_√w_fun˘i⁄
(".CTOR", 0, 0, 0,

3036 
TYPE_MOD_PRIVATE
 | 
TYPE_VOID
, 0);

3041 
mem_block
[
A_PROGRAM
].
block
[
œ°_öôülizî_íd
 - 1] =

3042 
F_DO_INVARIANTS
 - 
EFUN_FIRST
;

3043 
mem_block
[
A_PROGRAM
].
block
[
œ°_öôülizî_íd
] =

3044 
F_CONST1
 - 
EFUN_FIRST
;

3045 
mem_block
[
A_PROGRAM
].
block
[
œ°_öôülizî_íd
 + 1] =

3046 
F_RETURN
 - 
EFUN_FIRST
;

3050 i‡(
öv¨ü¡_œ°_addªss
)

3052 
has_öv¨ü¡
 = 
mem_block
[
A_FUNCTIONS
].
cuºít_size
 /

3053 (
fun˘i⁄
);

3054 
	`deföe_√w_fun˘i⁄
(".INV", 0, 0, 
öv¨ü¡_fú°_addªss
,

3055 
TYPE_MOD_PRIVATE
 | 
TYPE_VOID
, 0);

3056 
mem_block
[
A_PROGRAM
].
block
[
öv¨ü¡_œ°_addªss
 - 1] =

3057 
F_CONST1
 - 
EFUN_FIRST
;

3058 
mem_block
[
A_PROGRAM
].
block
[
öv¨ü¡_œ°_addªss
] =

3059 
F_RETURN
 - 
EFUN_FIRST
;

3062 
has_öv¨ü¡
 = -1;

3064 
fun˘i⁄s_À·
 = 
	`ªmove_undeföed_¥ŸŸy≥s
 (

3065 ()(
mem_block
[
A_FUNCTIONS
].
cuºít_size
 /  (
fun˘i⁄
)),

3066 (
fun˘i⁄
 *)
mem_block
[
A_FUNCTIONS
].
block
);

3069 
mem_block
[
A_FUNCTIONS
].
cuºít_size
 =

3070 
fun˘i⁄s_À·
 *  (
fun˘i⁄
);

3073 i‡(!(
num_∑r£_îr‹
 || 
öhîô_fûe
))

3075 
	`›timize_jumps
();

3077 
	`lök_C_fun˘i⁄s
(
cuºít_fûe
);

3079 
lök_îr‹s
 = 0;

3080 
	`¥o˚ss_ªloc
((
ªloc
 *)
mem_block
[
A_RELOC
].
block
,

3081 ()(
mem_block
[
A_RELOC
].
cuºít_size
 / (
ªloc
)),

3082 ()(
mem_block
[
A_INHERITS
].
cuºít_size
 / (
öhîô
)));

3083 
num_∑r£_îr‹
 +
lök_îr‹s
;

3086 
c
;

3088 
c
 = 0;

3089 
c
 < 
mem_block
[
A_RELOC
].
cuºít_size
 / (
ªloc
);

3090 
c
++)

3091 
	`‰ì
(((
ªloc
 *)
mem_block
[
A_RELOC
].
block
)[
c
].
«me
);

3094 
öhîô_£lf
.
ty≥
 = 0;

3095 
öhîô_£lf
.
«me
 = 
	`make_s°rög
("this");

3096 
öhîô_£lf
.
¥og
 = 0;

3097 
öhîô_£lf
.
v¨übÀ_ödex_off£t
 = 0;

3098 
	`add_to_mem_block
(
A_INHERITS
, (*Ë&
öhîô_£lf
, (
öhîô
));

3100 
	`add_to_mem_block
(
A_HEADER
, (*)&
NULL_¥ogøm
, (NULL_program));

3102 
num_func
 =

3103 
mem_block
[
A_FUNCTIONS
].
cuºít_size
 / (
fun˘i⁄
);

3105 
mem_block
[
A_FUNC_HASH
].
cuºít_size
 = 
num_func
 *

3106 (
fun˘i⁄_hash
);

3107 i‡(
num_func
)

3109 
mem_block
[
A_FUNC_HASH
].
block
 =

3110 
	`ªÆloc
(
mem_block
[
A_FUNC_HASH
].
block
, 
num_func
 *

3111 (
fun˘i⁄_hash
));

3112 
mem_block
[
A_FUNC_HASH
].
max_size
 =

3113 
mem_block
[
A_FUNC_HASH
].
cuºít_size
;

3115 
	`hash_func
(
num_func
, (
fun˘i⁄
 *)
mem_block
[
A_FUNCTIONS
].
block
,

3116 (
fun˘i⁄_hash
 *)
mem_block
[
A_FUNC_HASH
].
block
);

3118 
	`íd_löío_öfo
();

3120 
¥og
 = (
¥ogøm
 *)
	`lﬂd_£gmíts
(
£gm_desc
, 
mem_block
);

3122 
¥og
->
ªf
 = 1;

3123 
¥og
->
sw≠_num
 = 0;

3124 
¥og
->
öv¨ü¡
 = 
has_öv¨ü¡
;

3125 
¥og
->
˘‹_ödex
 = 
has_˘‹
;

3126 
¥og
->
dt‹_ödex
 = 
has_dt‹
;

3127 
¥og
->
mod_time
 = 
cuºít_time
;

3128 
¥og
->
«me
 = 
	`°rög_c›y
(
cuºít_fûe
);

3129 
¥og
->
id_numbî
 = 
cuºít_id_numbî
++;

3130 #i‡
	`deföed
(
RUSAGE
Ë&& deföed(
PROFILE_OBJS
)

3131 
¥og
->
˝u
 = 0;

3133 
¥og
->
sw≠_löío_ödex
 = 0;

3134 
¥og
->
Êags
 = (
¥agma_no_öhîô
 ? 
PRAGMA_NO_INHERIT
 : 0) |

3135 (
¥agma_no_˛⁄e
 ? 
PRAGMA_NO_CLONE
 : 0) |

3136 (
¥agma_no_shadow
 ? 
PRAGMA_NO_SHADOW
 : 0) |

3137 (
¥agma_ªsidít
 ? 
PRAGMA_RESIDENT
 : 0);

3139 
¥og
->
öhîô
[¥og->
num_öhîôed
 - 1].prog =Örog;

3141 
i
 = 
ix
 = 0; i < ()
¥og
->
num_öhîôed
; i++)

3143 
öh
 = 
	`föd_öhîô
(
¥og
,Örog->
öhîô
[
i
].prog);

3144 i‡(
öh
 =
i
)

3146 
¥og
->
öhîô
[
i
].
v¨übÀ_ödex_off£t
 = 
ix
;

3147 
ix
 +
¥og
->
öhîô
[
i
].¥og->
num_v¨übÀs
;

3148 
¥og
->
öhîô
[
i
].
ty≥
 &~
TYPE_MOD_SECOND
;

3152 
¥og
->
öhîô
[
i
].
v¨übÀ_ödex_off£t
 =

3153 
¥og
->
öhîô
[
öh
].
v¨übÀ_ödex_off£t
;

3154 
¥og
->
öhîô
[
i
].
ty≥
 |
TYPE_MOD_SECOND
;

3164 
¥og
->
sizeof_¨gumít_ty≥s
=0;

3167 
¥og
->
¨gumít_ty≥s
 = 0;

3169 
¥og
->
ty≥_°¨t
 = 0;

3172 
i
 = 0; i < ()
¥og
->
num_öhîôed
 - 1; i++)

3174 
	`ª„ªn˚_¥og
 (
¥og
->
öhîô
[
i
].prog, "inheritance");

3177 
¥og
->
lﬂd_time
 = 
cuºít_time
;

3179 
	`ªgi°î_¥ogøm
(
¥og
);

3186 
tŸÆ_¥ogøm_size
 +
¥og
->
exec_size
;

3187 
tŸÆ_¥og_block_size
 +
¥og
->
tŸÆ_size
;

3188 
tŸÆ_num_¥og_blocks
 += 1;

3190 
i
=0; i < 
A_NUM
; i++)

3191 
	`‰ì
((*)
mem_block
[
i
].
block
);

3193 i‡(
num_∑r£_îr‹
 || 
öhîô_fûe
)

3195 
	`‰ì_¥og
(
¥og
);

3196 
¥og
 = 
NULL
;

3198 
	}
}

3204 
	$¥ﬁog
()

3206 
i
;

3208 i‡(
ty≥_of_¨gumíts
.
block
 == 0) {

3209 
ty≥_of_¨gumíts
.
max_size
 = 100;

3210 
ty≥_of_¨gumíts
.
block
 = 
	`xÆloc
((
size_t
Èy≥_of_¨gumíts.
max_size
);

3212 
ty≥_of_¨gumíts
.
cuºít_size
 = 0;

3213 
¥og
 = 0;

3214 
comp_°ackp
 = 0;

3215 
cuºít_c⁄töue_addªss
 = 0;

3216 
cuºít_bªak_addªss
 = 0;

3217 
cuºít_ˇ£_addªss
 = 0;

3218 
num_∑r£_îr‹
 = 0;

3219 
	`‰ì_Æl_loˇl_«mes
();

3223 
i
=0; i < 
NUMAREAS
; i++) {

3224 
mem_block
[
i
].
block
 = 
	`xÆloc
(
START_BLOCK_SIZE
);

3225 
mem_block
[
i
].
cuºít_size
 = 0;

3226 
mem_block
[
i
].
max_size
 = 
START_BLOCK_SIZE
;

3228 
	`öô_löío_öfo
();

3229 
	`add_√w_öô_jump
();

3230 
fú°_œ°_öôülizî_íd
 = 
œ°_öôülizî_íd
;

3231 
has_öhîôed
 = 1;

3232 i‡(
auto_ob
 && 
	`°rcmp
(
cuºít_fûe
,áuto_ob->
¥og
->
«me
))

3234 
	`c›y_öhîôs
(
auto_ob
->
¥og
, 0, "auto");

3235 
has_öhîôed
 = 0;

3237 
	}
}

3243 
	$add_√w_öô_jump
()

3248 
	`ös_f_byã
(
F_JUMP
);

3249 
œ°_öôülizî_íd
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

3250 
	`ös_sh‹t
(0);

3251 
	}
}

3254 
	$£¨ch_f‹_ext_fun˘i⁄
(*
«me
, 
¥ogøm
 *
¥og1
)

3256 *
ix
;

3257 
i
, 
ªs
;

3259 
ix
 = 
	`°rchr
(
«me
, ':');

3260 i‡(
ix
 =
NULL
)

3263  
	`£¨ch_f‹_fun˘i⁄
(
«me
, 
¥og1
);

3266 i‡(
ix
 - 
«me
 =4 && 
	`°∫cmp
(name, "this", 4) == 0)

3267  
	`£¨ch_f‹_ext_fun˘i⁄
(
ix
 + 2, 
¥og1
);

3269 
i
 = 
¥og1
->
num_öhîôed
 - 2; i >= 0; i--)

3271 i‡(
ix
 =
«me
 || (
	`°æí
(
¥og1
->
öhîô
[
i
].name) == ix -Çame &&

3272 
	`°∫cmp
(
¥og1
->
öhîô
[
i
].
«me
,Çame, (
size_t
)(
ix
 -Çame)) == 0))

3274 
ªs
 = 
	`£¨ch_f‹_ext_fun˘i⁄
(
ix
 + 2, 
¥og1
->
öhîô
[
i
].
¥og
);

3275 i‡(
ªs
)

3277 
ty≥_mod
;

3280 
fun˘i⁄_öhîô_found
 +
i
 -

3281 (
¥og1
->
öhîô
[
i
].
¥og
->
num_öhîôed
 - 1);

3282 
ty≥_mod
 = 
¥og1
->
öhîô
[
fun˘i⁄_öhîô_found
].
ty≥
;

3285 i‡(
fun˘i⁄_ty≥_mod_found
 & 
TYPE_MOD_PRIVATE
)

3286 
ty≥_mod
 &~
TYPE_MOD_PUBLIC
;

3287 i‡(
fun˘i⁄_ty≥_mod_found
 & 
TYPE_MOD_PUBLIC
)

3288 
ty≥_mod
 &~
TYPE_MOD_PRIVATE
;

3289 
fun˘i⁄_ty≥_mod_found
 |
ty≥_mod
;

3291  
ªs
;

3296 
i
 -
¥og1
->
öhîô
[i].
¥og
->
num_öhîôed
 - 1;

3303 
	}
}

	@prelang.y

14 
	~<°rög.h
>

15 
	~<°dio.h
>

16 
	~<°dlib.h
>

17 #i‡
deföed
(
_SEQUENT_
)

18 
	~<mÆloc.h
>

20 
	~<mem‹y.h
>

21 
	~<sys/ty≥s.h
>

22 
	~<sys/°©.h
>

23 #i‡
deföed
(
sun
Ë|| deföed(
__osf__
)

24 
	~<Æloˇ.h
>

27 
	~"c⁄fig.h
"

28 
	~"löt.h
"

29 
	~"öãrÁ˚.h
"

30 
	~"obje˘.h
"

31 
	~"ö°rs.h
"

32 
	~"ö¸Æloc.h
"

33 
	~"m°rög.h
"

34 
	~"simuœã.h
"

36 
	~"efun_èbÀ.h
"

38 #i‡
deföed
(
sun
Ë&& !deföed(
SOLARIS
)

39 
bc›y
(*, *, );

45 #ifde‡
MALLOC_dmÆloc


46 
	~<dmÆloc.h
>

48 #ifde‡
mÆloc


49 #unde‡
mÆloc


51 
	#mÆloc
 
xÆloc


	)

54 
	#YYMAXDEPTH
 600

	)

56 
	#BREAK_ON_STACK
 0x40000

	)

57 
	#BREAK_FROM_CASE
 0x80000

	)

60 
	sˇ£_hóp_íåy
 { 
	mkey
; 
	maddr
; 
	mlöe
; };

61 
	#CASE_HEAP_ENTRY_ALIGN
(
off£t
Ëoff£à&-(
ˇ£_hóp_íåy
)

	)

63 
mem_block
 
	gmem_block
[
NUMAREAS
];

64 
	g¥e_c⁄d_fú°_addªss
, 
	g¥e_c⁄d_œ°_addªss
;

65 
	gpo°_c⁄d_fú°_addªss
, 
	gpo°_c⁄d_œ°_addªss
;

66 
	göv¨ü¡_fú°_addªss
, 
	göv¨ü¡_œ°_addªss
;

68 
	ghas_öhîôed
;

74 
	#BASIC_TYPE
(
e
,
t
Ë(”Ë=
TYPE_ANY
 ||\

75 (
e
Ë=(
t
) ||\

76 (
t
Ë=
TYPE_ANY
)

	)

78 
	#TYPE
(
e
,
t
Ë(
	`BASIC_TYPE
(”Ë& 
TYPE_MASK
, (t) & TYPE_MASK) ||\

79 (((
e
Ë& 
TYPE_MOD_POINTER
Ë&& ((
t
) & TYPE_MOD_POINTER) &&\

80 
	`BASIC_TYPE
((
e
Ë& (
TYPE_MASK
 & ~
TYPE_MOD_POINTER
),\

81 (
t
Ë& (
TYPE_MASK
 & ~
TYPE_MOD_POINTER
))))

	)

83 
	#FUNCTION
(
n
Ë((
fun˘i⁄
 *)
mem_block
[
A_FUNCTIONS
].
block
 + (n))

	)

84 
	#VARIABLE
(
n
Ë((
v¨übÀ
 *)
mem_block
[
A_VARIABLES
].
block
 + (n))

	)

85 
	#INHERIT
(
n
Ë((
öhîô
 *)
mem_block
[
A_INHERITS
].
block
 + (n))

	)

87 
	#Æign
(
x
Ë–((xË+ (()-1ËË& ~(()-1Ë)

	)

93 
	gexa˘_ty≥s
;

94 
¥agma_°ri˘_ty≥s
;

95 
¥agma_ßve_bö¨y
;

96 
¥agma_no_öhîô
;

97 
¥agma_no_shadow
;

98 
¥agma_no_˛⁄e
;

99 
obje˘
 *
auto_ob
;

101 
	gåue_v¨¨gs
;

103 
tŸÆ_num_¥og_blocks
, 
tŸÆ_¥og_block_size
;

105 
num_∑r£_îr‹
;

106 
d_Êag
;

108 
	gcuºít_bªak_addªss
;

109 
	gcuºít_c⁄töue_addªss
;

110 
	gcuºít_ˇ£_addªss
;

111 
	gcuºít_ˇ£_numbî_hóp
;

112 
	gcuºít_ˇ£_°rög_hóp
;

113 
	#SOME_NUMERIC_CASE_LABELS
 0x40000

	)

114 
	#NO_STRING_CASE_LABELS
 0x80000

	)

115 
	gzîo_ˇ£_œbñ
;

116 
	gcuºít_ty≥
;

118 *
gë_ty≥_«me
();

135 
	gœ°_öôülizî_íd
;

136 
	gfú°_œ°_öôülizî_íd
;

138 
ïûog
 ();

139 
check_de˛¨ed
 (*
°r
);

140 
¥ﬁog
 ();

141 
push_addªss
 ();

142 
p›_addªss
 ();

143 
make_œbñ
 ();

144 
å™s„r_öô_c⁄åﬁ
 ();

145 *
gë_two_ty≥s
 (, );

146 
vîify_de˛¨ed
 (*);

147 
h™dÀ_fun˘i⁄_id
 (*);

148 
c›y_öhîôs
 (
¥ogøm
 *, , *);

149 
check_öhîôs
(
¥ogøm
 *);

150 
£¨ch_f‹_ext_fun˘i⁄
(*, 
¥ogøm
 *);

152 
¥ogøm
 
	gNULL_¥ogøm
;

154 
öô_löío_öfo
();

155 
íd_löío_öfo
();

156 
push_öô_¨g_addªss
 ();

157 
˛ór_öô_¨g_°ack
 ();

158 
‰ì_Æl_loˇl_«mes
 ();

159 
add_loˇl_«me
 (*, );

160 
sm¨t_log
 (*, , *);

161 
yyÀx
 ();

162 
ty≥_îr‹
 (*, );

163 *
tmp°rög_c›y
(*);

164 *
ö√r_gë_§ccode_posôi⁄
(
off£t
, *
löe_numbîs
, 
löío_size
,

165 *
ö˛ude_fûes
, *
«me
);

166 
£¨ch_f‹_fun˘i⁄
(*
«me
, 
¥ogøm
 *
¥og
);

168 
INLINE
 
mem_block_size
(, );

170 
cuºít_löe
;

176 *
cuºít_fûe
, *
öhîô_fûe
;

181 
	gty≥_of_loˇls
[
MAX_LOCAL
];

182 
	gloˇl_blockdïth
[
MAX_LOCAL
];

183 *
	gloˇl_«mes
[
MAX_LOCAL
];

184 
	gcuºít_numbî_of_loˇls
 = 0;

193 
mem_block
 
	gty≥_of_¨gumíts
;

195 
¥ogøm
 *
	g¥og
;

201 
	$com∑tibÀ_ty≥s
(
t1
, 
t2
)

203 i‡(
t1
 =
TYPE_UNKNOWN
 || 
t2
 == TYPE_UNKNOWN)

205 i‡(
t1
 =
t2
)

207 i‡((
t1
|
TYPE_MOD_NO_MASK
|
TYPE_MOD_STATIC
|
TYPE_MOD_PRIVATE
|
TYPE_MOD_PUBLIC
)

208 =(
t2
|
TYPE_MOD_NO_MASK
|
TYPE_MOD_STATIC
|
TYPE_MOD_PRIVATE
|
TYPE_MOD_PUBLIC
))

210 i‡(
t1
 =
TYPE_ANY
 || 
t2
 == TYPE_ANY)

212 i‡((
t1
 & 
TYPE_MOD_POINTER
Ë&& (
t2
 & TYPE_MOD_POINTER)) {

213 i‡((
t1
 & 
TYPE_MASK
Ë=(
TYPE_ANY
|
TYPE_MOD_POINTER
) ||

214 (
t2
 & 
TYPE_MASK
Ë=(
TYPE_ANY
|
TYPE_MOD_POINTER
))

217 i‡(
t1
 =
TYPE_MAPPING
)

220 
	}
}

225 
INLINE


227 
	$add_¨g_ty≥
(
ty≥
)

229 
mem_block
 *
mbp
 = &
ty≥_of_¨gumíts
;

230 
mbp
->
cuºít_size
 +  
ty≥
 > mbp->
max_size
) {

231 
mbp
->
max_size
 <<= 1;

232 
mbp
->
block
 = 
	`ªÆloc
(mbp->block, (
size_t
)mbp->
max_size
);

234 ()
	`mem˝y
(
mbp
->
block
 + mbp->
cuºít_size
, &
ty≥
, Åype);

235 
mbp
->
cuºít_size
 + 
ty≥
;

236 
	}
}

241 
INLINE


243 
	$p›_¨g_°ack
(
n
)

245 
ty≥_of_¨gumíts
.
cuºít_size
 - (Ë* 
n
;

246 
	}
}

253 
INLINE


255 
	$gë_¨gumít_ty≥
(
¨g
, 
n
)

259 (
ty≥_of_¨gumíts
.
block
 +Åy≥_of_¨gumíts.
cuºít_size
))[
¨g
 - 
n
];

260 
	}
}

262 
INLINE


264 
	$add_to_mem_block
(
n
, *
d©a
, 
size
)

266 
mem_block
 *
mbp
 = &mem_block[
n
];

267 
mbp
->
cuºít_size
 + 
size
 > mbp->
max_size
) {

268 
mbp
->
max_size
 <<= 1;

269 
mbp
->
block
 = 
	`ªÆloc
(mbp->block, (
size_t
)mbp->
max_size
);

271 ()
	`mem˝y
(
mbp
->
block
 + mbp->
cuºít_size
, 
d©a
, (
size_t
)
size
);

272 
mbp
->
cuºít_size
 +
size
;

273 
	}
}

275 
INLINE
 

276 
	$mem_block_size
(
n
, 
size
)

277 
n
;

278 
size
;

280  
mem_block
[
n
].
cuºít_size
 / 
size
;

281 
	}
}

283 
INLINE
 

284 
	$ös_byã
(
b
)

286 
	`add_to_mem_block
(
A_PROGRAM
, &
b
, 1);

287 
	}
}

289 
INLINE
 

290 
	$ªad_byã
(
off£t
)

292  
mem_block
[
A_PROGRAM
].
block
[
off£t
];

293 
	}
}

300 
INLINE
 

301 
	$ös_sh‹t
(
l
)

303 
	`add_to_mem_block
(
A_PROGRAM
, (*)&
l
 + 0, 1);

304 
	`add_to_mem_block
(
A_PROGRAM
, (*)&
l
 + 1, 1);

305 
	}
}

307 
INLINE
 

308 
	$upd_sh‹t
(
off£t
, 
l
)

310 
mem_block
[
A_PROGRAM
].
block
[
off£t
 + 0] = ((*)&
l
)[0];

311 
mem_block
[
A_PROGRAM
].
block
[
off£t
 + 1] = ((*)&
l
)[1];

312 
	}
}

314 
INLINE
 

315 
	$ªad_sh‹t
(
off£t
)

317 
l
;

319 ((*)&
l
)[0] = 
mem_block
[
A_PROGRAM
].
block
[
off£t
 + 0];

320 ((*)&
l
)[1] = 
mem_block
[
A_PROGRAM
].
block
[
off£t
 + 1];

321  
l
;

322 
	}
}

328 
INLINE
 

329 
	$ös_l⁄g
(
l
)

331 
	`add_to_mem_block
(
A_PROGRAM
, (*)&
l
+0, 1);

332 
	`add_to_mem_block
(
A_PROGRAM
, (*)&
l
+1, 1);

333 
	`add_to_mem_block
(
A_PROGRAM
, (*)&
l
+2, 1);

334 
	`add_to_mem_block
(
A_PROGRAM
, (*)&
l
+3, 1);

335 
	}
}

341 
	$deföed_fun˘i⁄
(*
s
)

343 
off£t
;

344 
öh
;

345 
fun˘i⁄
 *
fu≈
;

346 *
su≥r_«me
 = 0;

347 *
sub_«me
;

348 *
ªÆ_«me
;

349 *
£¨ch
;

351 
ªÆ_«me
 = 
	`°ºchr
(
s
, ':') + 1;

352 
sub_«me
 = 
	`°rchr
(
s
, ':') + 2;

354 
ªÆ_«me
 = (
	`föd_s°rög
(‘ól_«mê=(*)1Ë? 
s
 :Ñeal_name));

355 if(!
ªÆ_«me
)

357 i‡(
sub_«me
 == (*)2)

358 
off£t
 = 0; off£à< 
mem_block
[
A_FUNCTIONS
].
cuºít_size
;

359 
off£t
 + (
fun˘i⁄
))

361 
fu≈
 = (
fun˘i⁄
 *)&
mem_block
[
A_FUNCTIONS
].
block
[
off£t
];

363 i‡(
ªÆ_«me
 =
fu≈
->
«me
)

365 
fun˘i⁄_ödex_found
 = 
off£t
 /  (
fun˘i⁄
);

366 
fun˘i⁄_¥og_found
 = 0;

367 
fun˘i⁄_ty≥_mod_found
 = 
fu≈
->
ty≥_Êags
 & 
TYPE_MOD_MASK
;

368 
fun˘i⁄_öhîô_found
 =

369 
mem_block
[
A_INHERITS
].
cuºít_size
 /

370 (
öhîô
);

375 i‡(
sub_«me
 - 
s
 > 2)

377 
su≥r_«me
 = 
	`xÆloc
((
size_t
)(
sub_«me
 - 
s
 - 1));

378 ()
	`mem˝y
(
su≥r_«me
, 
s
, (
size_t
)(
sub_«me
 - s - 2));

379 
su≥r_«me
[
sub_«me
 - 
s
 - 2] = 0;

380 i‡(
	`°rcmp
(
su≥r_«me
, "this") == 0)

381  
	`deföed_fun˘i⁄
(
sub_«me
);

384 
s
 = 
sub_«me
;

389 
öh
 = 
mem_block
[
A_INHERITS
].
cuºít_size
 /  (
öhîô
) - 1;

390 
öh
 >0; inh -((
öhîô
 *)
mem_block
[
A_INHERITS
].
block
)[öh].
¥og
->

391 
num_öhîôed
)

393 i‡(
su≥r_«me
 &&

394 
	`°rcmp
(
su≥r_«me
, ((
öhîô
 *)
mem_block
[
A_INHERITS
].
block
)[
öh
].
«me
) == 0)

395 
£¨ch
 = 
sub_«me
;

397 
£¨ch
 = 
s
;

398 i‡(
	`£¨ch_f‹_ext_fun˘i⁄
 (
£¨ch
,

399 ((
öhîô
 *)
mem_block
[
A_INHERITS
].
block
)[
öh
].
¥og
))

402 
ty≥
 = ((
öhîô
 *)
mem_block
[
A_INHERITS
].
block
)[
öh
].type;

404 i‡(
fun˘i⁄_ty≥_mod_found
 & 
TYPE_MOD_PRIVATE
)

405 
ty≥
 &~
TYPE_MOD_PUBLIC
;

406 i‡(
fun˘i⁄_ty≥_mod_found
 & 
TYPE_MOD_PUBLIC
)

407 
ty≥
 &~
TYPE_MOD_PRIVATE
;

408 
fun˘i⁄_ty≥_mod_found
 |
ty≥
 & 
TYPE_MOD_MASK
;

410 
fun˘i⁄_öhîô_found
 +
öh
 -

411 (((
öhîô
 *)
mem_block
[
A_INHERITS
].
block
)[
öh
].
¥og
->

412 
num_öhîôed
 - 1);

418 
	}
}

424 
	gcomp_°ackp
;

425 
	gcomp_°ack
[
COMPILER_STACK_SIZE
];

427 
INLINE
 

428 
	$push_addªss
()

430 i‡(
comp_°ackp
 >
COMPILER_STACK_SIZE
) {

431 
	`yyîr‹
("Compiler stack overflow");

432 
comp_°ackp
++;

435 
comp_°ack
[
comp_°ackp
++] = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

436 
	}
}

438 
INLINE
 

439 
	$push_ex∂icô
(
addªss
)

441 i‡(
comp_°ackp
 >
COMPILER_STACK_SIZE
) {

442 
	`yyîr‹
("Compiler stack overflow");

443 
comp_°ackp
++;

446 
comp_°ack
[
comp_°ackp
++] = 
addªss
;

447 
	}
}

449 
INLINE
 

450 
	$p›_addªss
()

452 i‡(
comp_°ackp
 == 0)

453 
	`Áèl
("Compiler stack underflow.\n");

454 i‡(
comp_°ackp
 > 
COMPILER_STACK_SIZE
) {

455 --
comp_°ackp
;

458  
comp_°ack
[--
comp_°ackp
];

459 
	}
}

461 
INLINE
 

462 
	$add_jump
()

464 
off£t
;

466 
off£t
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

467 
	`add_to_mem_block
(
A_JUMPS
, (*)&
off£t
,  (offset));

468 
	}
}

471 
	$deföe_√w_fun˘i⁄
(*
«me
, 
num_¨g
, 
num_loˇl
,

472 
off£t
, 
ty≥_Êags
, 
fú°_deÁu…
)

474 
fun˘i⁄
 
fun
;

475 
fun˘i⁄
 *
fu≈
;

476 
¨gumít_°¨t_ödex
;

478 i‡(
	`deföed_fun˘i⁄
 (
«me
))

487 i‡(
fun˘i⁄_¥og_found
)

489 
fu≈
 = &
fun˘i⁄_¥og_found
->
fun˘i⁄s
[
fun˘i⁄_ödex_found
];

492 
fu≈
 = 
	`FUNCTION
(
fun˘i⁄_ödex_found
);

497 i‡(!(
fu≈
->
ty≥_Êags
 & 
NAME_PROTOTYPE
) &&

498 !
fun˘i⁄_¥og_found
)

500 
buff
[500];

502 ()
	`¢¥ötf
(
buff
, (buff), "Rede˛¨©i⁄ o‡fun˘i⁄ %s", 
«me
);

503 
	`yyîr‹
 (
buff
);

511 i‡((
fu≈
->
ty≥_Êags
 & 
TYPE_MOD_NO_MASK
) &&

512 !(
fu≈
->
ty≥_Êags
 & 
NAME_PROTOTYPE
))

514 
buff
[500];

516 ()
	`¢¥ötf
(
buff
, (buff), "IŒegÆÅÿªdeföênomask fun˘i⁄ %s", 
«me
);

517 
	`yyîr‹
 (
buff
);

523 i‡(
exa˘_ty≥s
 &&

524 ((
fu≈
->
ty≥_Êags
 & 
TYPE_MASK
Ë!
TYPE_UNKNOWN
))

526 i‡(
fu≈
->
num_¨g
 !=Çum_arg &&

527 !(
fu≈
->
ty≥_Êags
 & 
TYPE_MOD_VARARGS
))

529 
	`yyîr‹
("IncorrectÇumber ofárguments");

545 
i
;

548 
i
=0; i < 
num_¨g
; i++)

557 i‡((
ty≥_Êags
 & 
NAME_PROTOTYPE
Ë&& !
fun˘i⁄_¥og_found
)

563 i‡(
fun˘i⁄_¥og_found
) {

564 
fu≈
 = &
fun
;

565 #ifde‡
PURIFY


566 ()
	`mem£t
(
fu≈
, '\0', (
fun
));

571 
fu≈
 = &
fun
;

572 #ifde‡
PURIFY


573 ()
	`mem£t
(
fu≈
, '\0', (
fun
));

577 #ifde‡
PROFILE_FUNS


578 
fu≈
->
num_ˇŒs
 = 0;

579 
fu≈
->
time_•ít
 = 0;

580 #ifde‡
SOLARIS


581 
fu≈
->
ticks_ˇŒ
 = 0;

583 
fu≈
->
°ime_ˇŒ
 = 0;

584 
fu≈
->
utime_ˇŒ
 = 0;

587 
fu≈
->
off£t
 = offset;

588 
fu≈
->
ty≥_Êags
 =Åype_flags;

589 
fu≈
->
num_¨g
 =Çum_arg;

590 
fu≈
->
num_loˇl
 =Çum_local;

591 
fu≈
->
fú°_deÁu…
 = first_default;

592 
fu≈
->
hash_idx
 = -1;

593 i‡(
exa˘_ty≥s
)

594 
fu≈
->
ty≥_Êags
 |
NAME_STRICT_TYPES
;

596 i‡(!
exa˘_ty≥s
 || 
num_¨g
 == 0)

597 
¨gumít_°¨t_ödex
 = 
INDEX_START_NONE
;

600 
i
;

604 
¨gumít_°¨t_ödex
 =

605 
mem_block
[
A_ARGUMENT_TYPES
].
cuºít_size
 /

607 
i
=0; i < 
num_¨g
; i++)

608 
	`add_to_mem_block
(
A_ARGUMENT_TYPES
, (*)&
ty≥_of_loˇls
[
i
],

609  
ty≥_of_loˇls
[
i
]);

611 i‡(
fu≈
 =&
fun
)

613 
fu≈
->
«me
 = 
	`make_s°rög
(name);

614 
	`add_to_mem_block
 (
A_FUNCTIONS
, (*)&
fun
,  fun);

615 
	`add_to_mem_block
(
A_ARGUMENT_INDEX
, (*)&
¨gumít_°¨t_ödex
,

616  
¨gumít_°¨t_ödex
);

620 ()
	`mem˝y
(&
mem_block
[
A_ARGUMENT_INDEX
].

621 
block
[
fun˘i⁄_ödex_found
 * (
¨gumít_°¨t_ödex
)],

622 (*)&
¨gumít_°¨t_ödex
, (argument_start_index));

625 
	}
}

627 
INLINE
 

628 
	$is_simul_efun
 (*
«me
)

631 i‡(
simul_efun_ob
 !0 && 
	`£¨ch_f‹_fun˘i⁄
 (
«me
, simul_efun_ob->
¥og
) &&

632 !(
fun˘i⁄_ty≥_mod_found
 & (
TYPE_MOD_PRIVATE
 | 
TYPE_MOD_STATIC
)))

635 
	}
}

638 
	$deföe_v¨übÀ
(*
«me
, 
ty≥
)

640 
v¨übÀ
 
dummy
;

641 
n
;

643 
n
 = 
	`check_de˛¨ed
(
«me
);

644 i‡(
n
 !-1 && (¿& 
TYPE_MOD_NO_MASK
))

646 *
p
 = (*)
	`Æloˇ
(80 + 
	`°æí
(
«me
));

647 ()
	`•rötf
(
p
, "IŒegÆÅÿªdeföê'nomask' v¨übÀ \"%s\"", 
«me
);

648 
	`yyîr‹
(
p
);

651 #ifde‡
PURIFY


652 ()
	`mem£t
(&
dummy
, '\0', (dummy));

654 
dummy
.
«me
 = 
	`make_s°rög
(name);

655 
dummy
.
ty≥
 =Åype;

656 
v¨übÀ_ödex_found
 = 
	`mem_block_size
(
A_VARIABLES
,(
v¨übÀ
));

657 
v¨übÀ_öhîô_found
 = 255;

658 
	`add_to_mem_block
(
A_VARIABLES
, (*)&
dummy
,  dummy);

659 
	}
}

662 
	$°‹e_¥og_°rög
(*
°r
)

664 
addr
;

665 
i
;

667 
i
 = 
mem_block
[
A_STRTAB
].
cuºít_size
 - ();

668 
i
 >= 0; i -= ())

670 *
°r2
;

671 
off£t
;

672 ((*)&
off£t
)[0] = 
mem_block
[
A_STRTAB
].
block
[
i
];

673 ((*)&
off£t
)[1] = 
mem_block
[
A_STRTAB
].
block
[
i
 + 1];

674 
°r2
 = 
mem_block
[
A_RODATA
].
block
 + 
off£t
;

675 i‡(
	`°rcmp
(
°r
, 
°r2
) == 0)

676  
off£t
;

678 i‡(
mem_block
[
A_RODATA
].
cuºít_size
 >= 0x10000)

680 
	`yyîr‹
("TooÜargeÑodata segment!\n");

681 
mem_block
[
A_RODATA
].
cuºít_size
 = 0;

683 
addr
 = 
mem_block
[
A_RODATA
].
cuºít_size
;

685 
	`add_to_mem_block
(
A_STRTAB
, (*)&
addr
, (addr));

686 
	`add_to_mem_block
(
A_RODATA
, 
°r
, ()
	`°æí
(str) + 1);

687  
addr
;

688 
	}
}

690 
	sœbñ


692 
	maddªss
;

693 
	mlök
;

697 
	$make_œbñ
()

699 
œbñ
 
lbl
 = { ()-1, ()-1};

700 
ªt
;

702 
ªt
 = 
mem_block
[
A_LABELS
].
cuºít_size
 / (
œbñ
);

703 
	`add_to_mem_block
(
A_LABELS
, (*)&
lbl
, (lbl));

704  
ªt
;

705 
	}
}

708 
	$ös_œbñ
(
lbl
)

710 
œbñ
 *
l
;

711 
hîe
;

713 
hîe
 = 
mem_block
[
A_PROGRAM
].
cuºít_size
;

714 
l
 = &((
œbñ
 *)
mem_block
[
A_LABELS
].
block
)[
lbl
];

715 i‡(
l
->
addªss
 != ()-1)

716 
	`ös_sh‹t
(
l
->
addªss
);

719 
	`ös_sh‹t
(
l
->
lök
);

720 
l
->
lök
 = 
hîe
;

722 
	}
}

725 
	$£t_œbñ
(
lbl
, 
addr
)

727 
œbñ
 *
l
;

728 
lök1
, 
√xt
;

731 
l
 = ((
œbñ
 *)
mem_block
[
A_LABELS
].
block
Ë+ 
lbl
;

732 
l
->
addªss
 = 
addr
;

733 
lök1
 = 
l
->
lök
;Üök1 !()-1;Üök1 = 
√xt
)

735 
√xt
 = 
	`ªad_sh‹t
(
lök1
);

736 
	`upd_sh‹t
(
lök1
, 
addr
);

738 
l
->
lök
 = ()-1;

739 
	}
}

742 
INLINE
 
	$cmp_ˇ£_keys
(
ˇ£_hóp_íåy
 *
íåy1
,

743 
ˇ£_hóp_íåy
 *
íåy2
, 
is_°r
)

745 i‡(
is_°r
)

746  
	`°rcmp
(
mem_block
[
A_RODATA
].
block
 + ()
íåy1
->
key
,

747 
mem_block
[
A_RODATA
].
block
 + ()
íåy2
->
key
);

749  
íåy1
->
key
 - 
íåy2
->key;

750 
	}
}

753 
	$add_to_ˇ£_hóp
(
block_ödex
, 
ˇ£_hóp_íåy
 *
íåy
,

754 
ˇ£_hóp_íåy
 *
íåy2
)

756 
cuºít_hóp
;

757 
ˇ£_hóp_íåy
 *
hóp_t›
, *
hóp_íåy
;

758 
is_°r
;

759 
‰om
, 
to
, 
size
;

762 i‡(
block_ödex
 =
A_CASE_NUMBERS
 )

764 
cuºít_hóp
 = 
cuºít_ˇ£_numbî_hóp
;

765 
is_°r
 = 0;

769 
cuºít_hóp
 = 
cuºít_ˇ£_°rög_hóp
;

770 
is_°r
 = 1;

773 i‡(
íåy2
 && 
	`cmp_ˇ£_keys
(
íåy
,É¡ry2, 
is_°r
) > 0)

776 
hóp_t›
 = (
ˇ£_hóp_íåy
 *)

777 (
mem_block
[
block_ödex
].
block
 +

778 
mem_block
[
block_ödex
].
cuºít_size
);

780 
hóp_íåy
 = (
ˇ£_hóp_íåy
 *)

781 (
mem_block
[
block_ödex
].
block
 +

782 
cuºít_hóp
);

784 ; 
hóp_íåy
 < 
hóp_t›
; heap_entry++)

786 i‡(
	`cmp_ˇ£_keys
(
hóp_íåy
, 
íåy
, 
is_°r
) > 0)

788 i‡(
hóp_íåy
->
addr
 == -1)

790 i‡(
	`cmp_ˇ£_keys
(++
hóp_íåy
, 
íåy
, 
is_°r
) >= 0)

793 
buff
[100];

795 ()
	`•rötf
(
buff
, "Duplicate caseÜabel (line %d)",

796 
hóp_íåy
->
löe
);

797 
	`yyîr‹
(
buff
);

803 i‡(
hóp_íåy
 < 
hóp_t›
 &&

804 (!
	`cmp_ˇ£_keys
(
hóp_íåy
, 
íåy
, 
is_°r
) ||

805 (
íåy2
 && (
	`cmp_ˇ£_keys
”¡ry2, 
hóp_íåy
, 
is_°r
) >= 0))))

808 
buff
[100];

810 ()
	`•rötf
(
buff
, "Duplicate caseÜabel (line %d)",

811 
hóp_íåy
->
löe
);

812 
	`yyîr‹
(
buff
);

816 
to
 = ((*)(
hóp_íåy
 + 1 + (
íåy2
 !
NULL
))) -

817 
mem_block
[
block_ödex
].
block
;

818 
‰om
 = ((*)
hóp_íåy
Ë- 
mem_block
[
block_ödex
].
block
;

819 
size
 = (
hóp_t›
 - 
hóp_íåy
Ë* (*
íåy
);

821 
	`add_to_mem_block
(
block_ödex
, (*)
íåy
, (*entry));

822 i‡(
íåy2
)

823 
	`add_to_mem_block
(
block_ödex
, (*)
íåy2
, (*entry2));

825 i‡(
hóp_íåy
 !
hóp_t›
)

827 #i‡
	`deföed
(
sun
Ë&& !deföed(
SOLARIS
)

828 ()
	`bc›y
(
mem_block
[
block_ödex
].
block
 + 
‰om
,

829 
mem_block
[
block_ödex
].
block
 + 
to
, 
size
);

831 ()
	`memmove
(
mem_block
[
block_ödex
].
block
 + 
to
,

832 
mem_block
[
block_ödex
].
block
 + 
‰om
, (
size_t
)
size
);

834 ()
	`mem˝y
(
mem_block
[
block_ödex
].
block
 + 
‰om
, 
íåy
, (*entry));

835 i‡(
íåy2
)

836 ()
	`mem˝y
(
mem_block
[
block_ödex
].
block
 + 
‰om
 + (*
íåy
),

837 
íåy2
, (*
íåy
));

839 
	}
}

846 
	$å™s„r_öô_c⁄åﬁ
()

848 i‡(
mem_block
[
A_PROGRAM
].
cuºít_size
 - 2 =
œ°_öôülizî_íd
)

849 
mem_block
[
A_PROGRAM
].
cuºít_size
 -= 3;

856 
	`upd_sh‹t
(
œ°_öôülizî_íd
,

857 
mem_block
[
A_PROGRAM
].
cuºít_size
);

859 
	}
}

861 
	#DEREFSIZE
 256

	)

862 
	gdîef_°ack
[
DEREFSIZE
];

863 
	gdîef_ödex
;

865 
add_√w_öô_jump
();

866 
	göô_¨g_°ack
[256];

867 
	göô_¨g_°ack_ödex
;

869 
INLINE


870 
	$˛ór_öô_¨g_°ack
()

872 
öô_¨g_°ack_ödex
 = 0;

873 
	}
}

875 
INLINE


876 
	$push_öô_¨g_addªss
(
addªss
)

878 
öô_¨g_°ack
[
öô_¨g_°ack_ödex
++] = 
addªss
;

879 
	}
}

881 
ös_f_byã
();

885 
	$dump_öô_¨g_èbÀ
(
¨g
)

887 
i
;

888 #i‡
	`deföed
(
DEBUG
Ë|| deföed(
löt
)

889 i‡(
num_∑r£_îr‹
 =0 && 
öô_¨g_°ack_ödex
 !
¨g
)

890 
	`Áèl
("Not correctÇumber of initáddresses!\n");

892 
i
 = 0; i < 
öô_¨g_°ack_ödex
; i++)

893 
	`ös_sh‹t
(
öô_¨g_°ack
[
i
]);

894 
	}
}

902 %
tokí
 
F_EXT
 
F_JUMP
 
F_JUMP_WHEN_ZERO
 
F_JUMP_WHEN_NON_ZERO
 
F_SKIP_NZ


903 %
tokí
 
F_POP_VALUE
 
F_DUP


904 %
tokí
 
F_STORE


905 %
tokí
 
F_CALL_NON_VIRT
 
F_CALL_VIRT


906 %
tokí
 
F_PUSH_IDENTIFIER_LVALUE
 
F_PUSH_LOCAL_VARIABLE_LVALUE


907 %
tokí
 
F_PUSH_INDEXED_LVALUE
 
F_INDIRECT
 
F_INDEX


908 %
tokí
 
F_CONST0
 
F_CONST1


909 %
tokí
 
F_FAIL_PRECOND
 
F_FAIL_POSTCOND
 
F_FAIL_INVARIANT
 
F_FAIL_ASSERTION


910 %
tokí
 
F_ASSERTION
 
F_DO_POSTCOND
 
F_DO_PRECOND
 
F_DO_INVARIANTS


911 %
tokí
 
F_CALL_VAR
 
F_BUILD_CLOSURE
 
F_PAPPLY


916 %
tokí
 
F_IF
 
F_IDENTIFIER
 
F_LAND
 
F_LOR
 
F_STATUS


917 %
tokí
 
F_RETURN
 
F_STRING
 
F_FLOATC


918 %
tokí
 
F_INC
 
F_DEC


919 %
tokí
 
F_POST_INC
 
F_POST_DEC
 
F_COMMA


920 %
tokí
 
F_NUMBER
 
F_ASSIGN
 
F_INT
 
F_ADD
 
F_SUBTRACT
 
F_MULTIPLY


921 %
tokí
 
F_DIVIDE
 
F_LT
 
F_GT
 
F_EQ
 
F_GE
 
F_LE


922 %
tokí
 
F_NE


923 %
tokí
 
F_ADD_EQ
 
F_SUB_EQ
 
F_DIV_EQ
 
F_MULT_EQ


924 %
tokí
 
F_NEGATE


925 %
tokí
 
F_SUBSCRIPT
 
F_WHILE
 
F_BREAK


926 %
tokí
 
F_DO
 
F_FOR
 
F_SWITCH


927 %
tokí
 
F_SSCANF
 
F_PARSE_COMMAND
 
F_STRING_DECL
 
F_LOCAL_NAME


928 %
right
 
F_ELSE


929 %
tokí
 
F_DESCRIBE


930 %
tokí
 
F_CONTINUE


931 %
tokí
 
F_MOD
 
F_MOD_EQ
 
F_INHERIT
 
F_COLON_COLON


932 %
tokí
 
F_STATIC


933 %
tokí
 
F_ARROW
 
F_AGGREGATE
 
F_M_AGGREGATE


934 %
tokí
 
F_COMPL
 
F_AND
 
F_AND_EQ
 
F_OR
 
F_OR_EQ
 
F_XOR
 
F_XOR_EQ


935 %
tokí
 
F_LSH
 
F_LSH_EQ
 
F_RSH
 
F_RSH_EQ


936 %
tokí
 
F_CATCH
 
F_END_CATCH
 
F_CALL_C
 
F_CALL_SIMUL


937 %
tokí
 
F_OBJECT
 
F_VOID
 
F_MIXED
 
F_PRIVATE
 
F_NO_MASK
 
F_NOT
 
F_MAPPING
 
F_FLOAT


938 %
tokí
 
F_PUBLIC
 
F_FUNCTION
 
F_OPERATOR


939 %
tokí
 
F_VARARGS
 
F_RANGE
 
F_VARARG


	@regexp.c

58 
	~<°dio.h
>

59 
	~<°rög.h
>

60 
	~<˘y≥.h
>

61 
	~"c⁄fig.h
"

62 
	~"ªgexp.h
"

63 
	~"löt.h
"

102 
	#END
 0

	)

103 
	#BOL
 1

	)

104 
	#EOL
 2

	)

105 
	#ANY
 3

	)

106 
	#ANYOF
 4

	)

107 
	#ANYBUT
 5

	)

109 
	#BRANCH
 6

	)

111 
	#BACK
 7

	)

112 
	#EXACTLY
 8

	)

113 
	#NOTHING
 9

	)

114 
	#STAR
 10

	)

116 
	#WORDSTART
 11

	)

117 
	#WORDEND
 12

	)

118 
	#OPEN
 20

	)

121 
	#CLOSE
 30

	)

155 
	#OP
(
p
Ë(*’))

	)

156 
	#NEXT
(
p
Ë(((*(’)+1)&0377)<<8Ë+ (*(’)+2)&0377))

	)

157 
	#OPERAND
(
p
Ë(’Ë+ 3)

	)

163 
	#SPECIAL
 0x100

	)

164 
	#LBRAC
 ('('|
SPECIAL
)

	)

165 
	#RBRAC
 (')'|
SPECIAL
)

	)

166 
	#ASTERIX
 ('*'|
SPECIAL
)

	)

167 
	#OR_OP
 ('|'|
SPECIAL
)

	)

168 
	#DOLLAR
 ('$'|
SPECIAL
)

	)

169 
	#DOT
 ('.'|
SPECIAL
)

	)

170 
	#CARET
 ('^'|
SPECIAL
)

	)

171 
	#LSQBRAC
 ('['|
SPECIAL
)

	)

172 
	#RSQBRAC
 (']'|
SPECIAL
)

	)

173 
	#LSHBRAC
 ('<'|
SPECIAL
)

	)

174 
	#RSHBRAC
 ('>'|
SPECIAL
)

	)

175 
	#FAIL
(
m
Ë{ 
	`ªgîr‹
(m); (
NULL
); }

	)

176 
	#ISMULT
(
c
Ë((cË=
ASTERIX
)

	)

177 
	#META
 "^$.[()|*\\"

	)

178 #i‚de‡
CHARBITS


179 
	#CHARBITS
 0xff

	)

180 
	#UCHARAT
(
p
Ë(()*(*)’))

	)

182 
	#UCHARAT
(
p
Ë(()*’)&
CHARBITS
)

	)

184 
	#ISWORDPART
(
c
Ë–
	`iß um
(cË|| (cË='_' )

	)

189 
	#HASWIDTH
 01

	)

190 
	#SIMPLE
 02

	)

191 
	#SPSTART
 04

	)

192 
	#WORST
 0

	)

197 *
	gªg∑r£
;

198 
	gªg≈¨
;

199 
	gªgdummy
;

200 *
	gªgcode
;

201 
	gªgsize
;

206 #i‚de‡
STATIC


207 
	#STATIC
 

	)

209 
STATIC
 *
ªg
(, *);

210 
STATIC
 *
ªgbønch
(*);

211 
STATIC
 *
ªgpõ˚
(*);

212 
STATIC
 *
ªg©om
(*);

213 
STATIC
 *
ªgnode
();

214 
STATIC
 *
ªg√xt
(*);

215 
STATIC
 
INLINE
 
ªgc
();

216 
STATIC
 
ªgö£π
(, *);

217 
STATIC
 
ªgèû
(*, *);

218 
STATIC
 
ªg›èû
(*, *);

219 #ifde‡
STRCSPN


220 
STATIC
 
°rc•n
(*, *);

238 
ªgexp
 *

239 
	$ªgcomp
(*
exp
, 
excom∑t
)

244 
ªgexp
 *
r
;

245 *
sˇn
;

246 *
l⁄ge°
;

247 
Àn
;

248 
Êags
;

249 *
exp2
,*
de°
,
c
;

251 i‡(
exp
 =(*)
NULL
)

252 
	`FAIL
("NULLárgument");

254 
exp2
=(*)
	`xÆloc
–(
	`°æí
(
exp
)+1) * (([8])/([8])) );

255  
sˇn
=
exp
,
de°
=
exp2
; (
c
= *scan++); ) {

256 
c
) {

259 *
de°
++ = 
excom∑t
 ? 
c
 : c | 
SPECIAL
;

268 *
de°
++ = 
c
 | 
SPECIAL
;

271  
c
 = *
sˇn
++ ) {

274 *
de°
++ = 
excom∑t
 ? 
c
 | 
SPECIAL
 : c;

278 *
de°
++ = 
c
 | 
SPECIAL
;

282 
	`FAIL
("sorry, unimplemented operator");

283 'b': *
de°
++ = '\b'; ;

284 't': *
de°
++ = '\t'; ;

285 'r': *
de°
++ = '\r'; ;

287 *
de°
++ = 
c
;

291 *
de°
++ = 
c
;

294 *
de°
=0;

296 
ªg∑r£
 = 
exp2
;

297 
ªg≈¨
 = 1;

298 
ªgsize
 = 0L;

299 
ªgcode
 = &
ªgdummy
;

300 
	`ªgc
(()
MAGIC
);

301 i‡(
	`ªg
(0, &
Êags
Ë=(*)
NULL
)

302  ((
ªgexp
 *)
NULL
);

305 i‡(
ªgsize
 >= 32767L)

306 
	`FAIL
("regexpÅoo big");

309 
r
 = (
ªgexp
 *Ë
	`xÆloc
(‘egexpË+ (Ë
ªgsize
);

310 i‡(
r
 =(
ªgexp
 *Ë
NULL
)

311 
	`FAIL
("out of space");

314 
ªg∑r£
 = 
exp2
;

315 
ªg≈¨
 = 1;

316 
ªgcode
 = 
r
->
¥ogøm
;

317 
	`ªgc
(()
MAGIC
);

318 i‡(
	`ªg
(0, &
Êags
Ë=
NULL
)

319  ((
ªgexp
 *Ë
NULL
);

322 
r
->
ªg°¨t
 = '\0';

323 
r
->
ªg™ch
 = 0;

324 
r
->
ªgmu°
 = 
NULL
;

325 
r
->
ªgmÀn
 = 0;

326 
sˇn
 = 
r
->
¥ogøm
 + 1;

327 i‡(
	`OP
(
	`ªg√xt
(
sˇn
)Ë=
END
) {

328 
sˇn
 = 
	`OPERAND
(scan);

331 i‡(
	`OP
(
sˇn
Ë=
EXACTLY
)

332 
r
->
ªg°¨t
 = *
	`OPERAND
(
sˇn
);

333 i‡(
	`OP
(
sˇn
Ë=
BOL
)

334 
r
->
ªg™ch
++;

344 i‡(
Êags
 & 
SPSTART
) {

345 
l⁄ge°
 = 
NULL
;

346 
Àn
 = 0;

347 ; 
sˇn
 !
NULL
; sˇ¿
	`ªg√xt
(scan))

348 i‡(
	`OP
(
sˇn
Ë=
EXACTLY
 && 
	`°æí
(
	`OPERAND
(sˇn)Ë>
Àn
) {

349 
l⁄ge°
 = 
	`OPERAND
(
sˇn
);

350 
Àn
 = 
	`°æí
(
	`OPERAND
(
sˇn
));

352 
r
->
ªgmu°
 = 
l⁄ge°
;

353 
r
->
ªgmÀn
 = 
Àn
;

356 
	`‰ì
((*)
exp2
);

357  (
r
);

358 
	}
}

370 
	$ªg
(
∑ªn
, *
Êagp
)

372 *
ªt
;

373 *
br
;

374 *
ídî
;

375 
∑∫o
 = 0;

376 
Êags
;

378 *
Êagp
 = 
HASWIDTH
;

381 i‡(
∑ªn
) {

382 i‡(
ªg≈¨
 >
NSUBEXP
)

383 
	`FAIL
("too many ()");

384 
∑∫o
 = 
ªg≈¨
;

385 
ªg≈¨
++;

386 
ªt
 = 
	`ªgnode
(
OPEN
 + 
∑∫o
);

388 
ªt
 = (*)
NULL
;

391 
br
 = 
	`ªgbønch
(&
Êags
);

392 i‡(
br
 =(*)
NULL
)

393  ((*)
NULL
);

394 i‡(
ªt
 !(*)
NULL
)

395 
	`ªgèû
(
ªt
, 
br
);

397 
ªt
 = 
br
;

398 i‡(!(
Êags
 & 
HASWIDTH
))

399 *
Êagp
 &~
HASWIDTH
;

400 *
Êagp
 |
Êags
 & 
SPSTART
;

401 *
ªg∑r£
 =
OR_OP
) {

402 
ªg∑r£
++;

403 
br
 = 
	`ªgbønch
(&
Êags
);

404 i‡(
br
 =(*)
NULL
)

405  ((*)
NULL
);

406 
	`ªgèû
(
ªt
, 
br
);

407 i‡(!(
Êags
 & 
HASWIDTH
))

408 *
Êagp
 &~
HASWIDTH
;

409 *
Êagp
 |
Êags
 & 
SPSTART
;

413 
ídî
 = 
	`ªgnode
(
∑ªn
 ? 
CLOSE
 + 
∑∫o
 : 
END
);

414 
	`ªgèû
(
ªt
, 
ídî
);

417 
br
 = 
ªt
; b∏!(*)
NULL
; b∏
	`ªg√xt
(br))

418 
	`ªg›èû
(
br
, 
ídî
);

421 i‡(
∑ªn
 && *
ªg∑r£
++ !
RBRAC
) {

422 
	`FAIL
("unmatched ()");

423 } i‡(!
∑ªn
 && *
ªg∑r£
 != '\0') {

424 i‡(*
ªg∑r£
 =
RBRAC
) {

425 
	`FAIL
("unmatched ()");

427 
	`FAIL
("junk onÉnd");

430  (
ªt
);

431 
	}
}

439 
	$ªgbønch
(*
Êagp
)

441 *
ªt
;

442 *
chaö
;

443 *
œã°
;

444 
Êags
;

446 *
Êagp
 = 
WORST
;

448 
ªt
 = 
	`ªgnode
(
BRANCH
);

449 
chaö
 = (*)
NULL
;

450 *
ªg∑r£
 !'\0' && *ªg∑r£ !
OR_OP
 && *ªg∑r£ !
RBRAC
) {

451 
œã°
 = 
	`ªgpõ˚
(&
Êags
);

452 i‡(
œã°
 =(*)
NULL
)

453  ((*)
NULL
);

454 *
Êagp
 |
Êags
 & 
HASWIDTH
;

455 i‡(
chaö
 =(*)
NULL
)

456 *
Êagp
 |
Êags
 & 
SPSTART
;

458 
	`ªgèû
(
chaö
, 
œã°
);

459 
chaö
 = 
œã°
;

461 i‡(
chaö
 =(*)
NULL
)

462 ()
	`ªgnode
(
NOTHING
);

464  (
ªt
);

465 
	}
}

476 
	$ªgpõ˚
(*
Êagp
)

478 *
ªt
;

479 
›
;

481 
Êags
;

483 
ªt
 = 
	`ªg©om
(&
Êags
);

484 i‡(
ªt
 =(*)
NULL
)

485  ((*)
NULL
);

487 
›
 = *
ªg∑r£
;

488 i‡(!
	`ISMULT
(
›
)) {

489 *
Êagp
 = 
Êags
;

490  (
ªt
);

492 i‡(!(
Êags
 & 
HASWIDTH
))

493 
	`FAIL
("* operand could beÉmpty");

494 *
Êagp
 = (
WORST
 | 
SPSTART
);

496 i‡(
›
 =
ASTERIX
 && (
Êags
 & 
SIMPLE
))

497 
	`ªgö£π
(
STAR
, 
ªt
);

498 i‡(
›
 =
ASTERIX
) {

500 
	`ªgö£π
(
BRANCH
, 
ªt
);

501 
	`ªg›èû
(
ªt
, 
	`ªgnode
(
BACK
));

502 
	`ªg›èû
(
ªt
,Ñet);

503 
	`ªgèû
(
ªt
, 
	`ªgnode
(
BRANCH
));

504 
	`ªgèû
(
ªt
, 
	`ªgnode
(
NOTHING
));

506 
ªg∑r£
++;

507 i‡(
	`ISMULT
(*
ªg∑r£
))

508 
	`FAIL
("nested *");

510  (
ªt
);

511 
	}
}

521 
	$ªg©om
(*
Êagp
)

523 *
ªt
;

524 
Êags
;

526 *
Êagp
 = 
WORST
;

528 *
ªg∑r£
++) {

529 
CARET
:

530 
ªt
 = 
	`ªgnode
(
BOL
);

532 
DOLLAR
:

533 
ªt
 = 
	`ªgnode
(
EOL
);

535 
DOT
:

536 
ªt
 = 
	`ªgnode
(
ANY
);

537 *
Êagp
 |
HASWIDTH
 | 
SIMPLE
;

539 
LSHBRAC
:

540 
ªt
 = 
	`ªgnode
(
WORDSTART
);

542 
RSHBRAC
:

543 
ªt
 = 
	`ªgnode
(
WORDEND
);

545 
LSQBRAC
:{

546 
˛ass
;

547 
˛as£nd
;

549 i‡(*
ªg∑r£
 =
CARET
) {

550 
ªt
 = 
	`ªgnode
(
ANYBUT
);

551 
ªg∑r£
++;

553 
ªt
 = 
	`ªgnode
(
ANYOF
);

554 i‡(*
ªg∑r£
 =
RSQBRAC
 || *regparse == '-')

555 
	`ªgc
(*
ªg∑r£
++);

556 *
ªg∑r£
 !'\0' && *ªg∑r£ !
RSQBRAC
) {

557 i‡(*
ªg∑r£
 == '-') {

558 
ªg∑r£
++;

559 i‡(*
ªg∑r£
 =
RSQBRAC
 || *regparse == '\0')

560 
	`ªgc
('-');

562 
˛ass
 = (
CHARBITS
 & *(
ªg∑r£
 - 2)) + 1;

563 
˛as£nd
 = (
CHARBITS
 & *(
ªg∑r£
));

564 i‡(
˛ass
 > 
˛as£nd
 + 1)

565 
	`FAIL
("invalid []Ñange");

566 ; 
˛ass
 <
˛as£nd
; class++)

567 
	`ªgc
(
˛ass
);

568 
ªg∑r£
++;

571 
	`ªgc
(*
ªg∑r£
++);

573 
	`ªgc
('\0');

574 i‡(*
ªg∑r£
 !
RSQBRAC
)

575 
	`FAIL
("unmatched []");

576 
ªg∑r£
++;

577 *
Êagp
 |
HASWIDTH
 | 
SIMPLE
;

580 
LBRAC
:

581 
ªt
 = 
	`ªg
(1, &
Êags
);

582 i‡(
ªt
 =(*)
NULL
)

583  ((*)
NULL
);

584 *
Êagp
 |
Êags
 & (
HASWIDTH
 | 
SPSTART
);

587 
OR_OP
:

588 
RBRAC
:

589 
	`FAIL
("internal urp");

590 
ASTERIX
:

591 
	`FAIL
("* followsÇothing");

593 
Àn
;

594 
ídî
;

596 
ªg∑r£
--;

597 
Àn
=0; 
ªg∑r£
[len] &&

598 !(
ªg∑r£
[
Àn
]&
SPECIAL
Ë&&Ñeg∑r£[Àn] !
RSQBRAC
;Üen++) ;

599 i‡(
Àn
 <= 0)

601 
	`FAIL
("internal disaster");

603 
ídî
 = *(
ªg∑r£
 + 
Àn
);

604 i‡(
Àn
 > 1 && 
	`ISMULT
(
ídî
))

605 
Àn
--;

606 *
Êagp
 |
HASWIDTH
;

607 i‡(
Àn
 == 1)

608 *
Êagp
 |
SIMPLE
;

609 
ªt
 = 
	`ªgnode
(
EXACTLY
);

610 
Àn
 > 0) {

611 
	`ªgc
(*
ªg∑r£
++);

612 
Àn
--;

614 
	`ªgc
('\0');

619  (
ªt
);

620 
	}
}

626 
	$ªgnode
(
›
)

628 *
ªt
;

629 *
±r
;

631 
ªt
 = 
ªgcode
;

632 i‡(
ªt
 =&
ªgdummy
) {

633 
ªgsize
 += 3;

634  (
ªt
);

636 
±r
 = 
ªt
;

637 *
±r
++ = 
›
;

638 *
±r
++ = '\0';

639 *
±r
++ = '\0';

640 
ªgcode
 = 
±r
;

642  (
ªt
);

643 
	}
}

648 
INLINE
 

649 
	$ªgc
(
b
)

651 i‡(
ªgcode
 !&
ªgdummy
)

652 *
ªgcode
++ = 
b
;

654 
ªgsize
++;

655 
	}
}

663 
	$ªgö£π
(
›
, *
›nd
)

665 *
§c
;

666 *
d°
;

667 *
∂a˚
;

669 i‡(
ªgcode
 =&
ªgdummy
) {

670 
ªgsize
 += 3;

673 
§c
 = 
ªgcode
;

674 
ªgcode
 += 3;

675 
d°
 = 
ªgcode
;

676 
§c
 > 
›nd
)

677 *--
d°
 = *--
§c
;

679 
∂a˚
 = 
›nd
;

680 *
∂a˚
++ = 
›
;

681 *
∂a˚
++ = '\0';

682 *
∂a˚
++ = '\0';

683 
	}
}

688 
	$ªgèû
(*
p
, *
vÆ
)

690 *
sˇn
;

691 *
ãmp
;

692 
off£t
;

694 i‡(
p
 =&
ªgdummy
)

698 
sˇn
 = 
p
;

700 
ãmp
 = 
	`ªg√xt
(
sˇn
);

701 i‡(
ãmp
 =(*)
NULL
)

703 
sˇn
 = 
ãmp
;

706 i‡(
	`OP
(
sˇn
Ë=
BACK
)

707 
off£t
 = 
sˇn
 - 
vÆ
;

709 
off£t
 = 
vÆ
 - 
sˇn
;

710 *(
sˇn
 + 1Ë(()
off£t
 >> 8) & 0377;

711 *(
sˇn
 + 2Ë
off£t
 & 0377;

712 
	}
}

718 
	$ªg›èû
(*
p
, *
vÆ
)

721 i‡(
p
 =(*)
NULL
 ||Ö =&
ªgdummy
 || 
	`OP
’Ë!
BRANCH
)

723 
	`ªgèû
(
	`OPERAND
(
p
), 
vÆ
);

724 
	}
}

733 *
	gªgöput
;

734 *
	gªgbﬁ
;

735 **
	gªg°¨ç
;

736 **
	gªgídp
;

741 
STATIC
 
ªgåy
(
ªgexp
 *, *);

742 
STATIC
 
ªgm©ch
(*);

743 
STATIC
 
ªgª≥©
(*);

745 #ifde‡
DEBUG


746 
	gªg«º©e
 = 0;

747 
STATIC
 *
ªg¥›
(*);

754 
	$ªgexec
(
ªgexp
 *
¥og
, *
°rög
)

756 *
s
;

759 i‡(
¥og
 =(
ªgexp
 *)
NULL
 || 
°rög
 == (*)NULL) {

760 
	`ªgîr‹
("NULLÖarameter");

764 i‡(
	`UCHARAT
(
¥og
->
¥ogøm
Ë!
MAGIC
) {

765 
	`ªgîr‹
("corruptedÖrogram");

769 i‡(
¥og
->
ªgmu°
 !(*)
NULL
) {

770 
s
 = 
°rög
;

771 (
s
 = 
	`°rchr
(s, 
¥og
->
ªgmu°
[0])Ë!(*)
NULL
) {

772 i‡(
	`°∫cmp
(
s
, 
¥og
->
ªgmu°
, (
size_t
Ìrog->
ªgmÀn
) == 0)

774 
s
++;

776 i‡(
s
 =(*)
NULL
)

780 
ªgbﬁ
 = 
°rög
;

783 i‡(
¥og
->
ªg™ch
)

784  (
	`ªgåy
(
¥og
, 
°rög
));

787 
s
 = 
°rög
;

788 i‡(
¥og
->
ªg°¨t
 != '\0')

790 (
s
 = 
	`°rchr
(s, 
¥og
->
ªg°¨t
)Ë!(*)
NULL
) {

791 i‡(
	`ªgåy
(
¥og
, 
s
))

793 
s
++;

798 i‡(
	`ªgåy
(
¥og
, 
s
))

800 } *
s
++ != '\0');

804 
	}
}

810 
	$ªgåy
(
ªgexp
 *
¥og
, *
°rög
)

812 
i
;

813 **
•
;

814 **
ï
;

816 
ªgöput
 = 
°rög
;

817 
ªg°¨ç
 = 
¥og
->
°¨ç
;

818 
ªgídp
 = 
¥og
->
ídp
;

820 
•
 = 
¥og
->
°¨ç
;

821 
ï
 = 
¥og
->
ídp
;

822 
i
 = 
NSUBEXP
; i > 0; i--) {

823 *
•
++ = (*)
NULL
;

824 *
ï
++ = (*)
NULL
;

826 i‡(
	`ªgm©ch
(
¥og
->
¥ogøm
 + 1)) {

827 
¥og
->
°¨ç
[0] = 
°rög
;

828 
¥og
->
ídp
[0] = 
ªgöput
;

832 
	}
}

846 
	$ªgm©ch
(*
¥og
)

848 *
sˇn
;

849 *
nxt
;

851 
sˇn
 = 
¥og
;

852 #ifde‡
DEBUG


853 i‡(
sˇn
 !(*)
NULL
 && 
ªg«º©e
)

854 ()
	`Ârötf
(
°dîr
, "%s(\n", 
	`ªg¥›
(
sˇn
));

856 
sˇn
 !(*)
NULL
) {

857 #ifde‡
DEBUG


858 i‡(
ªg«º©e
)

859 ()
	`Ârötf
(
°dîr
, "%s...\n", 
	`ªg¥›
(
sˇn
));

861 
nxt
 = 
	`ªg√xt
(
sˇn
);

863 
	`OP
(
sˇn
)) {

864 
BOL
:

865 i‡(
ªgöput
 !
ªgbﬁ
)

868 
EOL
:

869 i‡(*
ªgöput
 != '\0')

872 
ANY
:

873 i‡(*
ªgöput
 == '\0')

875 
ªgöput
++;

877 
WORDSTART
:

878 i‡(
ªgöput
 =
ªgbﬁ
)

880 i‡(*
ªgöput
 == '\0' ||

881 
	`ISWORDPART
–*(
ªgöput
-1) ) || !ISWORDPART( *reginput ) )

884 
WORDEND
:

885 i‡(*
ªgöput
 == '\0')

887 i‡–
ªgöput
 =
ªgbﬁ
 ||

888 !
	`ISWORDPART
–*(
ªgöput
-1) ) || ISWORDPART( *reginput ) )

891 
EXACTLY
:{

892 
size_t
 
Àn
;

893 *
›nd
;

895 
›nd
 = 
	`OPERAND
(
sˇn
);

897 i‡(*
›nd
 !*
ªgöput
)

899 
Àn
 = 
	`°æí
(
›nd
);

900 i‡(
Àn
 > 1 && 
	`°∫cmp
(
›nd
, 
ªgöput
,Üen) != 0)

902 
ªgöput
 +
Àn
;

905 
ANYOF
:

906 i‡(*
ªgöput
 == '\0' ||

907 
	`°rchr
(
	`OPERAND
(
sˇn
), *
ªgöput
Ë=(*)
NULL
)

909 
ªgöput
++;

911 
ANYBUT
:

912 i‡(*
ªgöput
 == '\0' ||

913 
	`°rchr
(
	`OPERAND
(
sˇn
), *
ªgöput
Ë!(*)
NULL
)

915 
ªgöput
++;

917 
NOTHING
:

919 
BACK
:

921 
OPEN
 + 1:

922 
OPEN
 + 2:

923 
OPEN
 + 3:

924 
OPEN
 + 4:

925 
OPEN
 + 5:

926 
OPEN
 + 6:

927 
OPEN
 + 7:

928 
OPEN
 + 8:

929 
OPEN
 + 9:{

930 
no
;

931 *
ßve
;

933 
no
 = 
	`OP
(
sˇn
Ë- 
OPEN
;

934 
ßve
 = 
ªgöput
;

936 i‡(
	`ªgm©ch
(
nxt
)) {

941 i‡(
ªg°¨ç
[
no
] =(*)
NULL
)

942 
ªg°¨ç
[
no
] = 
ßve
;

947 
CLOSE
 + 1:

948 
CLOSE
 + 2:

949 
CLOSE
 + 3:

950 
CLOSE
 + 4:

951 
CLOSE
 + 5:

952 
CLOSE
 + 6:

953 
CLOSE
 + 7:

954 
CLOSE
 + 8:

955 
CLOSE
 + 9:{

956 
no
;

957 *
ßve
;

959 
no
 = 
	`OP
(
sˇn
Ë- 
CLOSE
;

960 
ßve
 = 
ªgöput
;

962 i‡(
	`ªgm©ch
(
nxt
)) {

967 i‡(
ªgídp
[
no
] =(*)
NULL
)

968 
ªgídp
[
no
] = 
ßve
;

973 
BRANCH
:{

974 *
ßve
;

976 i‡(
	`OP
(
nxt
Ë!
BRANCH
)

977 
nxt
 = 
	`OPERAND
(
sˇn
);

980 
ßve
 = 
ªgöput
;

981 i‡(
	`ªgm©ch
(
	`OPERAND
(
sˇn
)))

983 
ªgöput
 = 
ßve
;

984 
sˇn
 = 
	`ªg√xt
(scan);

985 } 
sˇn
 !(*)
NULL
 && 
	`OP
(sˇnË=
BRANCH
);

991 
STAR
:{

992 
√xtch
;

993 
no
;

994 *
ßve
;

995 
möimum
;

1001 
√xtch
 = '\0';

1002 i‡(
	`OP
(
nxt
Ë=
EXACTLY
)

1003 
√xtch
 = *
	`OPERAND
(
nxt
);

1004 
möimum
 = (
	`OP
(
sˇn
Ë=
STAR
) ? 0 : 1;

1005 
ßve
 = 
ªgöput
;

1006 
no
 = 
	`ªgª≥©
(
	`OPERAND
(
sˇn
));

1007 
no
 >
möimum
) {

1009 i‡(
√xtch
 ='\0' || *
ªgöput
 ==Çextch)

1010 i‡(
	`ªgm©ch
(
nxt
))

1013 
no
--;

1014 
ªgöput
 = 
ßve
 + 
no
;

1018 
END
:

1021 
	`ªgîr‹
("memory corruption");

1025 
sˇn
 = 
nxt
;

1032 
	`ªgîr‹
("corruptedÖointers");

1034 
	}
}

1040 
	$ªgª≥©
(*
p
)

1042 
cou¡
 = 0;

1043 *
sˇn
;

1044 *
›nd
;

1046 
sˇn
 = 
ªgöput
;

1047 
›nd
 = 
	`OPERAND
(
p
);

1048 
	`OP
(
p
)) {

1049 
ANY
:

1050 
cou¡
 = 
	`°æí
(
sˇn
);

1051 
sˇn
 +
cou¡
;

1053 
EXACTLY
:

1054 *
›nd
 =*
sˇn
) {

1055 
cou¡
++;

1056 
sˇn
++;

1059 
ANYOF
:

1060 *
sˇn
 !'\0' && 
	`°rchr
(
›nd
, *sˇnË!(*)
NULL
) {

1061 
cou¡
++;

1062 
sˇn
++;

1065 
ANYBUT
:

1066 *
sˇn
 !'\0' && 
	`°rchr
(
›nd
, *sˇnË=(*)
NULL
) {

1067 
cou¡
++;

1068 
sˇn
++;

1072 
	`ªgîr‹
("internal foulup");

1073 
cou¡
 = 0;

1076 
ªgöput
 = 
sˇn
;

1078  (
cou¡
);

1079 
	}
}

1086 
	$ªg√xt
(*
p
)

1088 
off£t
;

1090 i‡(
p
 =&
ªgdummy
)

1091  ((*)
NULL
);

1093 
off£t
 = 
	`NEXT
(
p
);

1094 i‡(
off£t
 == 0)

1095  ((*)
NULL
);

1097 i‡(
	`OP
(
p
Ë=
BACK
)

1098  (
p
 - 
off£t
);

1100  (
p
 + 
off£t
);

1101 
	}
}

1103 #ifde‡
DEBUG


1105 
STATIC
 *
ªg¥›
(*);

1111 *
	$ªg¥›
(*
›
)

1113 *
p
;

1114 
buf
[50];

1116 ()
	`°r˝y
(
buf
, ":");

1118 
	`OP
(
›
)) {

1119 
BOL
:

1120 
p
 = "BOL";

1122 
EOL
:

1123 
p
 = "EOL";

1125 
ANY
:

1126 
p
 = "ANY";

1128 
ANYOF
:

1129 
p
 = "ANYOF";

1131 
ANYBUT
:

1132 
p
 = "ANYBUT";

1134 
BRANCH
:

1135 
p
 = "BRANCH";

1137 
EXACTLY
:

1138 
p
 = "EXACTLY";

1140 
NOTHING
:

1141 
p
 = "NOTHING";

1143 
BACK
:

1144 
p
 = "BACK";

1146 
END
:

1147 
p
 = "END";

1149 
OPEN
 + 1:

1150 
OPEN
 + 2:

1151 
OPEN
 + 3:

1152 
OPEN
 + 4:

1153 
OPEN
 + 5:

1154 
OPEN
 + 6:

1155 
OPEN
 + 7:

1156 
OPEN
 + 8:

1157 
OPEN
 + 9:

1158 ()
	`•rötf
(
buf
 + 
	`°æí
(buf), "OPEN%d", 
	`OP
(
›
Ë- 
OPEN
);

1159 
p
 = (*)
NULL
;

1161 
CLOSE
 + 1:

1162 
CLOSE
 + 2:

1163 
CLOSE
 + 3:

1164 
CLOSE
 + 4:

1165 
CLOSE
 + 5:

1166 
CLOSE
 + 6:

1167 
CLOSE
 + 7:

1168 
CLOSE
 + 8:

1169 
CLOSE
 + 9:

1170 ()
	`•rötf
(
buf
 + 
	`°æí
(buf), "CLOSE%d", 
	`OP
(
›
Ë- 
CLOSE
);

1171 
p
 = (*)
NULL
;

1173 
STAR
:

1174 
p
 = "STAR";

1177 
	`ªgîr‹
("corrupted opcode");

1178 
p
 = (*)
NULL
;

1181 i‡(
p
 !(*)
NULL
)

1182 ()
	`°rˇt
(
buf
, 
p
);

1183  (
buf
);

1184 
	}
}

1193 #ifde‡
STRCSPN


1200 
	$°rc•n
(*
s1
, *
s2
)

1202 *
sˇn1
;

1203 *
sˇn2
;

1204 
cou¡
;

1206 
cou¡
 = 0;

1207 
sˇn1
 = 
s1
; *scan1 != '\0'; scan1++) {

1208 
sˇn2
 = 
s2
; *scan2 != '\0';)

1209 i‡(*
sˇn1
 =*
sˇn2
++)

1210  (
cou¡
);

1211 
cou¡
++;

1213  (
cou¡
);

1214 
	}
}

1222 
	$ªgsub
(
ªgexp
 *
¥og
, *
sour˚
, *
de°
, 
n
)

1224 *
§c
;

1225 *
d°
;

1226 
c
;

1227 
no
;

1228 
size_t
 
Àn
;

1230 i‡(
¥og
 =(
ªgexp
 *)
NULL
 ||

1231 
sour˚
 =(*)
NULL
 || 
de°
 == (*)NULL) {

1232 
	`ªgîr‹
("NULLÖarmÅoÑegsub");

1233  
NULL
;

1235 i‡(
	`UCHARAT
(
¥og
->
¥ogøm
Ë!
MAGIC
) {

1236 
	`ªgîr‹
("damagedÑegexp fedÅoÑegsub");

1237  
NULL
;

1239 
§c
 = 
sour˚
;

1240 
d°
 = 
de°
;

1241 (
c
 = *
§c
++) != '\0') {

1242 i‡(
c
 == '&')

1243 
no
 = 0;

1244 i‡(
c
 ='\\' && '0' <*
§c
 && *src <= '9')

1245 
no
 = *
§c
++ - '0';

1247 
no
 = -1;

1249 i‡(
no
 < 0) {

1250 i‡(
c
 ='\\' && (*
§c
 == '\\' || *src == '&'))

1251 
c
 = *
§c
++;

1252 i‡(--
n
 < 0) {

1253 
	`ªgîr‹
("lineÅooÜong");

1254  
NULL
;

1256 *
d°
++ = 
c
;

1257 } i‡(
¥og
->
°¨ç
[
no
] !(*)
NULL
 &&

1258 
¥og
->
ídp
[
no
] !(*)
NULL
) {

1259 
Àn
 = 
¥og
->
ídp
[
no
] -Örog->
°¨ç
[no];

1260 i‡–(
n
-=
Àn
) < 0 ) {

1261 
	`ªgîr‹
("lineÅooÜong");

1262  
NULL
;

1264 ()
	`°∫˝y
(
d°
, 
¥og
->
°¨ç
[
no
], 
Àn
);

1265 
d°
 +
Àn
;

1266 i‡(
Àn
 !0 && *(
d°
 - 1) == '\0') {

1267 
	`ªgîr‹
("damaged match string");

1268  
NULL
;

1272 i‡(--
n
 < 0) {

1273 
	`ªgîr‹
("lineÅooÜong");

1274  
NULL
;

1276 *
d°
 = '\0';

1277  
d°
;

1278 
	}
}

1283 
	$ªgîr‹
(*
s
)

1285 ()
	`Ârötf
(
°dîr
, "ªgexp(3): %s", 
s
);

1286 
	`exô
(1);

1287 
	}
}

	@regexp.h

9 
	#NSUBEXP
 10

	)

10 
	sªgexp
 {

11 *
	m°¨ç
[
NSUBEXP
];

12 *
	mídp
[
NSUBEXP
];

13 
	mªg°¨t
;

14 
	mªg™ch
;

15 *
	mªgmu°
;

16 
	mªgmÀn
;

17 
	m¥ogøm
[1];

18 } 
	tªgexp
;

25 
	#MAGIC
 0234

	)

27 
ªgexp
 *
ªgcomp
(*, );

28 
ªgexec
(
ªgexp
 *, *);

29 *
ªgsub
(
ªgexp
 *, *, *, );

30 
ªgîr‹
(*);

	@regress/secure/auto.c

1 #¥agm®
no_˛⁄e


2 #¥agm®
no_öhîô


3 #¥agm®
°ri˘_ty≥s


5 
nomask
 
v¨¨gs
 
dump_¨øy
(
mixed
 
a
, 
°rög
 
èb
);

6 
nomask
 
v¨¨gs
 
dump_m≠pög
(
m≠pög
 
m
, 
°rög
 
èb
);

7 
dump_ñem
(
mixed
 
ßk
, 
°rög
 
èb
);

9 
nomask
 

10 
	$wrôe
(
°rög
 
°r
)

12 "/£cuª/ma°î"->
	`wrôe_c⁄sﬁe
(
°r
);

13 
	}
}

15 
°rög


16 
	$ty≥_«me
(
mixed
 
ëwas
)

18 i‡(
	`öç
(
ëwas
))

20 i‡(
	`Êﬂç
(
ëwas
))

22 i‡(
	`°rögp
(
ëwas
))

24 i‡(
	`obje˘p
(
ëwas
))

26 i‡(
	`poöãΩ
(
ëwas
))

28 i‡(
	`m≠pögp
(
ëwas
))

30 #ifde‡
_FUNCTION


31 i‡(
	`fun˘i⁄p
(
ëwas
))

35 
	}
}

42 
nomask
 
v¨¨gs
 

43 
	$dump_¨øy
(
mixed
 
a
, 
°rög
 
èb
)

45 
n
,

46 
m
;

47 
mixed
 
ix
, 
vÆ
;

49 i‡(!
èb
)

50 
èb
 = "";

51 i‡(!
	`poöãΩ
(
a
Ë&& !
	`m≠pögp
(a))

53 
	`dump_ñem
(
a
, 
èb
);

56 i‡(
	`poöãΩ
(
a
))

58 
	`wrôe
("(Array)\n");

59 
m
 = (
a
);

60 
n
 = 0;

61 
n
 < 
m
)

63 
	`wrôe
(
èb
 + "[" + 
n
 + "] =");

64 
	`dump_ñem
(
a
[
n
], 
èb
);

65 
n
 += 1;

69 
	`dump_m≠pög
(
a
, 
èb
);

70 
	}
}

77 
nomask
 
v¨¨gs
 

78 
	$dump_m≠pög
(
m≠pög
 
m
, 
°rög
 
èb
)

80 
mixed
 *
d
;

81 
i
, 
s
;

82 
°rög
 
dvÆ
, 
vÆ
;

84 i‡(!
èb
)

85 
èb
 = "";

87 
d
 = 
	`m_ödexes
(
m
);

88 
s
 = (
d
);

89 
	`wrôe
("(Mapping) ([\n");

90 
i
 = 0; i < 
s
; i++) {

91 i‡(
	`öç
(
d
[
i
]))

92 
dvÆ
 = "(öt)" + 
d
[
i
];

94 i‡(
	`Êﬂç
(
d
[
i
]))

95 
dvÆ
 = "(Êﬂt)" + 
	`·ﬂ
(
d
[
i
]);

97 i‡(
	`°rögp
(
d
[
i
]))

98 
dvÆ
 = "\"" + 
d
[
i
] + "\"";

100 i‡(
	`obje˘p
(
d
[
i
]))

101 
dvÆ
 = 
	`fûe_«me
(
d
[
i
]);

103 i‡(
	`poöãΩ
(
d
[
i
]))

104 
dvÆ
 = "◊ºay:" + (
d
[
i
]) + ")";

106 i‡(
	`m≠pögp
(
d
[
i
]))

107 
dvÆ
 = "(m≠pög:" + 
	`m_sizeof
(
d
[
i
]) + ")";

108 #ifde‡
_FUNCTION


109 i‡(
	`fun˘i⁄p
(
d
[
i
]))

110 
dvÆ
 = 
	`•rötf
("%O", 
d
[
i
]);

112 i‡(
	`fun˘i⁄p
(
m
[
d
[
i
]]))

113 
vÆ
 = 
	`•rötf
("%O", 
m
[
d
[
i
]]);

116 i‡(
	`öç
(
m
[
d
[
i
]]))

117 
vÆ
 = "(öt)" + 
m
[
d
[
i
]];

119 i‡(
	`Êﬂç
(
m
[
d
[
i
]]))

120 
vÆ
 = "(Êﬂt)" + 
	`·ﬂ
(
m
[
d
[
i
]]);

122 i‡(
	`°rögp
(
m
[
d
[
i
]]))

123 
vÆ
 = "\"" + 
m
[
d
[
i
]] + "\"";

125 i‡(
	`obje˘p
(
m
[
d
[
i
]]))

126 
vÆ
 = 
	`fûe_«me
(
m
[
d
[
i
]]);

128 i‡(
	`poöãΩ
(
m
[
d
[
i
]]))

129 
vÆ
 = "◊ºay:" + (
m
[
d
[
i
]]) + ")";

131 i‡(
	`m≠pögp
(
m
[
d
[
i
]]))

132 
vÆ
 = "(m≠pög:" + 
	`m_sizeof
(
m
[
d
[
i
]]) + ")";

134 
	`wrôe
(
èb
 + 
dvÆ
 + ":" + 
vÆ
 + "\n");

136 i‡(
	`poöãΩ
(
d
[
i
]))

137 
	`dump_¨øy
(
d
[
i
]);

139 i‡(
	`poöãΩ
(
m
[
d
[
i
]]))

140 
	`dump_¨øy
(
m
[
d
[
i
]]);

142 i‡(
	`m≠pögp
(
d
[
i
]))

143 
	`dump_m≠pög
(
d
[
i
], 
èb
 + " ");

145 i‡(
	`m≠pögp
(
m
[
d
[
i
]]))

146 
	`dump_m≠pög
(
m
[
d
[
i
]], 
èb
 + " ");

148 
	`wrôe
("])\n");

149 
	}
}

151 
nomask
 

152 
	$dump_ñem
(
mixed
 
ßk
, 
°rög
 
èb
)

154 i‡(
	`poöãΩ
(
ßk
))

156 
	`dump_¨øy
(
ßk
, 
èb
 + " ");

158 i‡(
	`m≠pögp
(
ßk
))

160 
	`dump_m≠pög
(
ßk
, 
èb
 + " ");

164 
	`wrôe
("(" + 
	`ty≥_«me
(
ßk
) + ") ");

165 i‡(
	`obje˘p
(
ßk
))

166 
	`wrôe
(
	`fûe_«me
(
ßk
));

167 i‡(
	`Êﬂç
(
ßk
))

168 
	`wrôe
(
	`·ﬂ
(
ßk
));

170 
	`wrôe
(
	`•rötf
("%O",
ßk
));

172 
	`wrôe
("\n");

173 
	}
}

181 
mixed


182 
	$≠∂yv
(
fun˘i⁄
 
f
, 
mixed
 *
v
)

184 
fun˘i⁄
 
g
 = 
	`∑µlyv
(
f
, 
v
);

185  
	`g
();

186 
	}
}

198 
	$f‹_óch
(
mixed
 
ñemíts
, 
fun˘i⁄
 
func
)

200 
i
;

201 
sz
;

202 
mixed
 
¨r
;

204 
¨r
 = 
ñemíts
;

205 i‡(
	`m≠pögp
(
ñemíts
))

206 
¨r
 = 
	`m_vÆues
(
ñemíts
);

207 
sz
 = (
¨r
);

208 
i
 = 0; i < 
sz
; i++)

209 
	`func
(
¨r
[
i
]);

210 
	}
}

218 
mixed


219 
	$c⁄°™t
(
mixed
 
x
, mixed 
y
)

221  
x
;

222 
	}
}

230 
mixed


231 
	$idítôy
(
mixed
 
x
)

233  
x
;

234 
	}
}

244 
	$nŸ
(
mixed
 
x
)

246  !
x
;

247 
	}
}

250 
	$mkcom∑ª_utû
(
fun˘i⁄
 
f
, 
mixed
 
x
, mixed 
y
)

252 i‡(
	`f
(
x
,
y
))

254 i‡(
	`f
(
y
,
x
))

257 
	}
}

266 
fun˘i⁄


267 
	$mkcom∑ª
(
fun˘i⁄
 
f
)

269  &
	`mkcom∑ª_utû
(
f
);

270 
	}
}

	@regress/secure/master.c

1 #¥agm®
°ri˘_ty≥s


2 #¥agm®
no_˛⁄e


3 #¥agm®
no_öhîô


5 
public
 
nomask
 

6 
	$wrôe_c⁄sﬁe
(
°rög
 
°r
)

8 
	`wrôe_sockë
(
°r
);

9 
	}
}

11 
obje˘


12 
	$gë_vbfc_obje˘
()

14  "/£cuª/vbfc_obje˘"->
	`ob_poöãr
();

15 
	}
}

17 
public
 
nomask
 
°rög
 *

18 
	$deföe_ö˛ude_dús
()

21 
	}
}

24 
	$Êag
(
°rög
 
°r
)

26 
	`wrôe
("Unknow¿Êag " + 
°r
 + "\n");

27 
	}
}

29 
°rög


30 
	$fix_«me
(
°rög
 
fûe
)

32 
°rög
 
«me
;

34 i‡(
	`ssˇnf
(
fûe
, "%s.c", 
«me
) != 1)

35  "/ã°s/ " +
fûe
;

36  "/ã°s/" + 
«me
;

37 
	}
}

39 
°rög
 *

40 
	$°¨t_boŸ
(
em±y
)

42 
°rög
 *
ã°s
;

44 
ã°s
 = 
	`gë_dú
("/tests/test-*.c");

45 
ã°s
 = 
	`m≠
—e°s, 
fix_«me
);

46 
	`s‹t_¨øy
(
ã°s
);

47  
ã°s
;

48 
	}
}

51 
	$¥ñﬂd_boŸ
(
°rög
 
fûe
)

53 
°rög
 
îr
;

54 
obje˘
 
ob
;

56 i‡(
	`fûe_size
(
fûe
 + ".c") == -1)

59 
	`wrôe
("Lﬂdög " + 
fûe
 + ".c -> ");

60 i‡(
îr
 = 
	`ˇtch
(
	`ˇŒ_Ÿhî
(
fûe
, "???")))

61 
	`wrôe
(
îr
);

63 
	`wrôe
("Ok.\n");

64 i‡(
ob
 = 
	`föd_obje˘
(
fûe
))

65 
	`debug
("de°roy", 
ob
);

66 
	}
}

69 
	$föÆ_boŸ
()

71 
	`debug
("shutdown");

72 
	}
}

	@regress/secure/simul_efun.c

1 #¥agm®
no_˛⁄e


2 #¥agm®
no_öhîô


3 #¥agm®
°ri˘_ty≥s


5 
nomask
 
mixed


6 
s‹t
(
mixed
 
¨r
, 
fun˘i⁄
 
lfunc
) = "sort";

8 
v¨¨gs
 
nomask
 
mixed


9 
	$s‹t_¨øy
(
mixed
 
¨r
, mixed 
lfunc
, 
obje˘
 
obj
)

11 i‡(
	`°rögp
(
lfunc
)) {

12 i‡(!
obj
)

13 
obj
 = 
	`¥evious_obje˘
();

14 
lfunc
 = 
	`mkfun˘i⁄
÷func, 
obj
);

16  
	`s‹t
(
¨r
, 
lfunc
);

17 
	}
}

	@regress/secure/vbfc_object.c

1 #¥agm®
no_˛⁄e


2 #¥agm®
no_öhîô


3 #¥agm®
°ri˘_ty≥s


5 
nomask
 

6 
	$¸óã
()

8 
	`£t_auth
(
	`this_obje˘
(), ({ -1, 0 }) );

9 
	}
}

11 
nomask
 
obje˘


12 
	$ob_poöãr
()

14  
	`this_obje˘
();

15 
	}
}

	@regress/tests/base.c

1 #¥agm®
°ri˘_ty≥s


4 
	$¸óã
()

6 
	}
}

	@regress/tests/functions.c

1 #¥agm®
°ri˘_ty≥s


3 
°rög


4 
	$func
(
mixed
 
a
)

7 
	}
}

10 
	$¸óã
()

12 
fun˘i⁄
 
g1
, 
g2
, 
g3
, 
g4
, 
g5
, 
g6
, 
g7
;

13 
obje˘
 
ob
;

15 
ob
 = 
	`this_obje˘
();

17 
g1
 = &
ob
->
	`func
();

18 
g2
 = &
ob
->
	`func
(&func());

19 
g3
 = 
	`mkfun˘i⁄
("func",
ob
);

20 
g4
 = &
	`func
();

21 
g5
 = &
	`func
(&func());

22 
g6
 = &
	`fûe_«me
(
	`this_obje˘
());

23 
g7
 = &
	`sö
(10.0);

25 
	`¥evious_obje˘
()->
	`£t_funcs
(
g1
, 
g2
, 
g3
, 
g4
, 
g5
, 
g6
, 
g7
);

26 
	}
}

29 
	$ªmove_obje˘
()

31 
	`de°ru˘
();

32 
	}
}

	@regress/tests/test-001.c

1 #¥agm®
°ri˘_ty≥s


3 
public
 

4 
	$¸ashme
(
num
, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
i
)

6 i‡(
num
 == 1)

7  
	`this_obje˘
()->
	`¸ashme
(1, 1, 1, 1, 1, 1, 1, 1, 1, 1);

9 
	}
}

12 
	$¸óã
()

14 
	`¸ashme
(1, 1, 1, 1, 1, 1, 1, 1, 1, 1);

15 
	}
}

	@regress/tests/test-002.c

1 #¥agm®
°ri˘_ty≥s


3 
public
 

4 
	$¸ashme
(
num
, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
i
)

6 i‡(
num
 == 1)

7  
	`¸ashme
(1, 1, 1, 1, 1, 1, 1, 1, 1, 1);

9 
	}
}

12 
	$¸óã
()

14 
	`¸ashme
(1, 1, 1, 1, 1, 1, 1, 1, 1, 1);

15 
	}
}

	@regress/tests/test-003.c

2 
	$¸óã
()

4 
obje˘
 
ob
;

6 
	`∑r£_comm™d
("ã°", ({ ({ 
	`this_obje˘
(Ë}Ë}), "%o", 
ob
);

7 
	}
}

9 
°rög


10 
	$id
()

13 
	}
}

	@regress/tests/test-004.c

1 #¥agm®
°ri˘_ty≥s


4 
	$¸óã
()

6 
obje˘
 
ob
;

7 
obje˘
 *
l
;

9 
	`ˇŒ_Ÿhî
("/tests/xyzzy", "???");

10 
ob
 = 
	`föd_obje˘
("/tests/xyzzy");

11 
l
 = 
	`föd_livög
("test", 1);

12 
l
 = 0;

13 
	`debug
("de°ru˘", 
ob
);

14 
	}
}

	@regress/tests/test-005.c

1 #¥agm®
°ri˘_ty≥s


4 
	$¸óã
()

6 #ifde‡
DEBUG_DRIVER


7 
	`bªak_poöt
();

9 
	}
}

	@regress/tests/test-006.c

1 #¥agm®
°ri˘_ty≥s


4 
	$¸óã
()

6 
	`throw
(0);

7 
	}
}

	@regress/tests/test-007.c

1 #¥agm®
°ri˘_ty≥s


4 
	$¸óã
()

6 
	`£t_livög_«me
("test");

7 
	`íabÀ_comm™ds
();

8 
	`add_a˘i⁄
(
time
, "time");

9 
	`comm™ds
();

10 
	}
}

	@regress/tests/test-008.c

1 #¥agm®
°ri˘_ty≥s


4 
	$¸óã
()

6 i‡((
	`•rötf
("%-4s", "x") + "x") != "x x")

7 
	`throw
("sprintf botch");

8 
	}
}

	@regress/tests/test-009.c

1 #¥agm®
°ri˘_ty≥s


4 
	$¸óã
()

6 
	`•rötf
("%O", ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

7 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

8 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

9 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

10 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

11 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

12 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

13 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

14 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

15 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

16 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

17 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

18 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

19 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

20 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

21 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

22 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

23 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

24 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

25 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

26 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

27 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

28 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

29 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

30 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

31 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

32 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

33 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

34 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

35 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

36 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

37 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

38 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

39 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

40 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

41 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

42 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

43 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

44 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

45 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

46 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

47 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

48 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

49 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

50 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

51 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

52 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

53 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

54 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

55 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

56 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

57 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

58 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

59 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

60 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

61 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

62 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

63 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

64 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

65 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

66 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

67 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

68 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

69 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
(),

70 ({ "a", "b", 1, 2, 
	`this_obje˘
(), 
	`¥evious_obje˘
()

75 
	}
}

	@regress/tests/test-010.c

1 #¥agm®
°ri˘_ty≥s


4 
	$¸óã
()

6 
mixed
 *
a
, *
b
;

8 
a
 = 
	`Æloˇã
(1);

9 
b
 = 
	`Æloˇã
(1);

11 
a
[0] =á;

12 
b
[0] = b;

14 i‡(
a
 =
b
)

15 
	`throw
("Badárray handling");

16 
	}
}

	@regress/tests/test-011.c

1 #¥agm®
°ri˘_ty≥s


4 
	$nŸhög
()

6 
	}
}

9 
	$¸óã
()

11 
i
;

13 
i
 = 0; i < 1024 ; i++)

14 i‡(
	`£t_Æ¨m
(120.0, 0.0, 
nŸhög
) == 0)

16 i‡(
i
 == 1024)

17 
	`throw
("Driver compiled withoutÖer-objectálarmÜimit");

18 
	}
}

	@regress/tests/test-012.c

1 #¥agm®
°ri˘_ty≥s


4 
	$¸óã
()

6 *
i
;

7 *
i
 = 3;

8 
	}
}

	@regress/tests/test-013.c

1 #¥agm®
°ri˘_ty≥s


4 
	$¸óã
()

6 
i
, 
j
, 
k
;

8 
i
 = 0; i < 100000; i++)

9 
j
 = 0; j < 100000; j++)

10 
k
 = 0; k < 100000; k++)

12 
	}
}

	@regress/tests/test-014.c

1 #¥agm®
°ri˘_ty≥s


3 
öhîô
 ("/tests/" + "base");

6 
	$¸óã
()

8 
	}
}

	@regress/tests/test-015.c

1 #¥agm®
°ri˘_ty≥s


4 
	$¸óã
()

6 i‡(
	`mö
(1, 2) != 1)

7 
	`throw
("min() doesÇot work!\n");

8 i‡(
	`mö
("a", "b") != "a")

9 
	`throw
("min() doesÇot work!\n");

10 i‡(
	`mö
(1.0, 2.0) > 1.1)

11 
	`throw
("min() doesÇot work!\n");

12 i‡(
	`max
(1, 2) != 2)

13 
	`throw
("max() doesÇot work!\n");

14 i‡(
	`max
("a", "b") != "b")

15 
	`throw
("max() doesÇot work!\n");

16 i‡(
	`max
(1.0, 2.0) < 1.9)

17 
	`throw
("max() doesÇot work!\n");

18 
	}
}

	@regress/tests/test-016.c

1 #¥agm®
°ri˘_ty≥s


4 
	$¸óã
()

6 
fun˘i⁄
 
fu≈
;

8 
fu≈
 = 
this_obje˘
;

9 i‡(!
	`fun˘i⁄p
(
fu≈
))

10 
	`throw
("Bad functionp()\n");

11 
	}
}

	@regress/tests/test-017.c

1 #¥agm®
°ri˘_ty≥s


3 
fun˘i⁄
 
	gg1
, 
	gg2
, 
	gg3
, 
	gg4
, 
	gg5
, 
	gg6
, 
	gg7
;

5 
°rög


6 
	$func
(
mixed
 
a
)

9 
	}
}

12 
	$¸óã
()

14 
obje˘
 
ob
;

15 
fun˘i⁄
 
f1
, 
f2
, 
f3
, 
f4
, 
f5
;

17 
ob
 = 
	`˛⁄e_obje˘
("/tests/functions");

19 
f1
 = &
ob
->
	`func
();

20 
f2
 = &
ob
->
	`func
(
f1
);

21 
f3
 = 
	`mkfun˘i⁄
("func",
ob
);

22 
f4
 = &
	`func
(Ë@ &
ob
->func();

23 
f5
 = &
ob
->
	`func
() @ &func();

25 i‡(!
	`fun˘i⁄p
(
f1
))

26 
	`throw
("parent functionp(&ob->func()) broken");

27 i‡(!
	`fun˘i⁄p
(
f2
))

28 
	`throw
("parent functionp(&ob->func(f1)) broken");

29 i‡(!
	`fun˘i⁄p
(
f3
))

30 
	`throw
("parent functionp(mkfunction(\"func\", ob)) broken");

31 i‡(!
	`fun˘i⁄p
(
f4
))

32 
	`throw
("parent functionp(&func @ &ob->func()) broken");

33 i‡(!
	`fun˘i⁄p
(
f5
))

34 
	`throw
("parent functionp(&ob->func() @ &func()) broken");

35 i‡(!
	`fun˘i⁄p
(
g1
))

36 
	`throw
("child functionp(&ob->func()) broken");

37 i‡(!
	`fun˘i⁄p
(
g2
))

38 
	`throw
("child functionp(&ob->func(&func())) broken");

39 i‡(!
	`fun˘i⁄p
(
g3
))

40 
	`throw
("child functionp(mkfunction(\"func\", ob)) broken");

41 i‡(!
	`fun˘i⁄p
(
g4
))

42 
	`throw
("child functionp(&func()) broken");

43 i‡(!
	`fun˘i⁄p
(
g5
))

44 
	`throw
("child functionp(&func(&func())) broken");

45 i‡(!
	`fun˘i⁄p
(
g6
))

46 
	`throw
("child functionp(&file_name(this_object())) broken");

47 i‡(!
	`fun˘i⁄p
(
g7
))

48 
	`throw
("child functionp(&sin(10.0)) broken");

50 i‡(
	`g6
() != "/tests/functions#1")

51 
	`throw
("child &file_name(this_object())Évaluates wrong");

53 
ob
->
	`ªmove_obje˘
();

55 i‡(
	`fun˘i⁄p
(
f1
))

56 
	`throw
("parent functionp(&ob->func()) didÇot detect destructed object");

57 i‡(
	`fun˘i⁄p
(
f2
))

58 
	`throw
("parent functionp(&ob->func(f1)) didÇot detect destructed object");

59 i‡(
	`fun˘i⁄p
(
f3
))

60 
	`throw
("parent functionp(mkfunction(\"func\", ob)) didÇot detect destructed object");

61 i‡(
	`fun˘i⁄p
(
f4
))

62 
	`throw
("parent functionp(&func() @ &ob->func()) didÇot detect destructed object");

63 i‡(
	`fun˘i⁄p
(
f5
))

64 
	`throw
("parent functionp(&ob->func() @ &func()) didÇot detect destructed object");

65 i‡(
	`fun˘i⁄p
(
g1
))

66 
	`throw
("child functionp(&ob->func()) didÇot detect destructed object");

67 i‡(
	`fun˘i⁄p
(
g2
))

68 
	`throw
("child functionp(&ob->func(&func())) didÇot detect destructed object");

69 i‡(
	`fun˘i⁄p
(
g3
))

70 
	`throw
("child functionp(mkfunction(\"func\", ob)) didÇot detect destructed object");

71 i‡(
	`fun˘i⁄p
(
g4
))

72 
	`throw
("child functionp(&func()) didÇot detect destructed object");

73 i‡(
	`fun˘i⁄p
(
g5
))

74 
	`throw
("child functionp(&func(&func())) didÇot detect destructed object");

75 i‡(!
	`fun˘i⁄p
(
g6
))

76 
	`throw
("child functionp(&file_name(this_object())) wasáffected by destructed object");

77 i‡(!
	`fun˘i⁄p
(
g7
))

78 
	`throw
("child functionp(&sin(10.0)) wasáffected by destructed object");

79 
	}
}

82 
	$£t_funcs
(
fun˘i⁄
 
f1
, fun˘i⁄ 
f2
, fun˘i⁄ 
f3
, fun˘i⁄ 
f4
,

83 
fun˘i⁄
 
f5
, fun˘i⁄ 
f6
, fun˘i⁄ 
f7
)

85 
g1
 = 
f1
;

86 
g2
 = 
f2
;

87 
g3
 = 
f3
;

88 
g4
 = 
f4
;

89 
g5
 = 
f5
;

90 
g6
 = 
f6
;

91 
g7
 = 
f7
;

92 
	}
}

	@regress/tests/test-018.c

1 #¥agm®
°ri˘_ty≥s


3 
w©chme¸ashthisdrivîwôh¨óŒyªÆlyªÆlyªÆlyªÆÃóŒyªÆlyªÆlyªÆlyªÆlyªÆlyªÆlyªÆlyªÆÃóŒyl⁄gfun˘i⁄«meohô√ed°obîóŒyªÆlyªÆlyl⁄gofcour£butIˇndoôyesiˇnôhökiˇnôhökiˇniknowiˇniknowˇnhahahahahabuâhisi§óŒyb‹ögsozzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz
(
x
);

6 
	$¸óã
()

8 
	}
}

	@regress/tests/test-019.c

1 #¥agm®
°ri˘_ty≥s


3 
touch_me
(
°rög
 
°r
, såög 
°r2
);

6 
	$¸óã
()

8 
	}
}

11 
	$touch_me
(
°rög
 
twô
, 
obje˘
 
vic
, string vic)

13 
	}
}

	@regress/tests/test-020.c

1 #¥agm®
°ri˘_ty≥s


4 
	$ã°
()

6 
	`ˇtch
(
	`this_obje˘
()->
	`n⁄exi°™t
());

9 
	}
}

12 
	$¸óã
()

14 
	`this_obje˘
()->
	`ã°
();

15 
	`ã°
();

16 
	}
}

	@regress/tests/test-021.c

1 #¥agm®
°ri˘_ty≥s


4 
	$fun˘i⁄_⁄e
(
¨g
)

6 i‡(
¨g
 != 0x1234)

7 
	`throw
("Badárgument!\n");

9 
	}
}

12 
	$fun˘i⁄_two
(
¨g
)

14 i‡(
¨g
 != 0x1234)

15 
	`throw
("Badárgument!\n");

17 
	}
}

19 
¥iv©e
 

20 
	$fun˘i⁄_thªe
(
¨g
)

22 i‡(
¨g
 != 0x1234)

23 
	`throw
("Badárgument!\n");

25 
	}
}

28 
	$¸óã
()

30 i‡(
	`ˇŒ_£lf
("function_one", 0x1234) != 0x5678)

31 
	`throw
("BadÑeturn value from call_self(\"function_one\", 0x1234)\n");

32 i‡(
	`ˇŒ_£lf
("function_two", 0x1234) != 0x5678)

33 
	`throw
("BadÑeturn value from call_self(\"function_two\", 0x1234)\n");

34 i‡(
	`ˇŒ_£lf
("function_three", 0x1234) != 0x5678)

35 
	`throw
("BadÑeturn value from call_self(\"function_three\", 0x1234)\n");

36 i‡(
	`ˇŒ_£lfv
("function_one", ({ 0x1234 }) ) != 0x5678)

37 
	`throw
("BadÑeturn value from call_selfv(\"function_one\", ({ 0x1234 }) )\n");

38 i‡(
	`ˇŒ_£lfv
("function_two", ({ 0x1234 }) ) != 0x5678)

39 
	`throw
("BadÑeturn value from call_selfv(\"function_two\", ({ 0x1234 }) )\n");

40 i‡(
	`ˇŒ_£lfv
("function_three", ({ 0x1234 }) ) != 0x5678)

41 
	`throw
("BadÑeturn value from call_selfv(\"function_three\", ({ 0x1234 }) )\n");

42 
	}
}

	@regress/tests/test-022.c

1 #¥agm®
°ri˘_ty≥s


4 
	$¸óã
()

6 
a
, 
b
;

8 
a
 = 1 ?: 2;

9 
b
 = 0 ? 1 : 2;

10 i‡(
a
 != 1)

11 
	`throw
("BadÑesult from :? operation");

12 i‡(
b
 != 2)

13 
	`throw
("BadÑesult from :? operation");

14 
	}
}

	@regress/tests/xyzzy.c

1 #¥agm®
°ri˘_ty≥s


4 
	$¸óã
()

6 
	`£t_livög_«me
("test");

7 
	`íabÀ_comm™ds
();

8 
	}
}

	@sent.h

1 
	s£¡í˚
 {

2 *
	mvîb
;

3 
˛osuª
 *
	mfun˘
;

4 
£¡í˚
 *
	m√xt
;

5 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


6 
£¡í˚
 *
	m√xt_Æl
, *
	m¥ev_Æl
;

8 
	msh‹t_vîb
;

11 
	#V_SHORT
 0x1

	)

12 
	#V_NO_SPACE
 0x2

	)

14 
£¡í˚
 *
Æloc_£¡í˚
();

16 
ªmove_£¡
 (
obje˘
 *, object *),

17 
‰ì_£¡í˚
 (
£¡í˚
 *);

	@signals.c

1 
	~<sig«l.h
>

2 
	~<°dio.h
>

4 
	~"c⁄fig.h
"

5 
	~"löt.h
"

6 
	~"öãΩªt.h
"

8 
öô_sig«ls
();

9 
dñivî_sig«ls
();

11 
	ssig_di•


13 
	msig
;

14 *
	m«me
;

15 } 
	gdi•
[] = {

16 {
SIGHUP
, "HUP"},

17 {
SIGINT
, "INT"},

19 {
SIGTERM
, "TERM"},

20 {
SIGUSR1
, "USR1"},

21 {
SIGUSR2
, "USR2"},

22 {
SIGTSTP
, "TSTP"},

23 {
SIGCONT
, "CONT"},

27 #i‡
deföed
(
__O≥nBSD__
Ë|| deföed(
__NëBSD__
Ë|| deföed(
__FªeBSD__
)

28 
sig_©omic_t
 
	g≥ndög_sig«ls
 = 0;

30 
	g≥ndög_sig«ls
 = 0;

34 
	$sig_h™dÀr
(
sig
)

36 
i
;

38 #i‡
	`deföed
(
SYSV
Ë|| deföed(
löux
)

39 ()
	`sig«l
(
sig
, 
sig_h™dÀr
);

41 
i
 = 0; 
di•
[i].
sig
 && disp[i].sig != sig; i++)

44 
≥ndög_sig«ls
 |1 << 
i
;

45 
	}
}

48 
	$öô_sig«ls
()

50 
i
;

52 
i
 = 0; 
di•
[i].
sig
; i++)

53 ()
	`sig«l
(
di•
[
i
].
sig
, 
sig_h™dÀr
);

54 
	}
}

57 
	$dñivî_sig«ls
()

59 
i
;

61 
i
 = 0; 
≥ndög_sig«ls
; i++)

63 i‡(
≥ndög_sig«ls
 & (1 << 
i
))

65 
≥ndög_sig«ls
 &~(1 << 
i
);

67 
	`push_°rög
(
di•
[
i
].
«me
, 
STRING_CSTRING
);

68 ()
	`≠∂y_ma°î_ob
(
M_EXTERNAL_SIGNAL
, 1);

71 
	}
}

	@signals.h

1 
dñivî_sig«ls
();

	@simul_efun.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<°rög.h
>

5 
	~"c⁄fig.h
"

6 
	~"löt.h
"

7 
	~"m°rög.h
"

8 
	~"öãΩªt.h
"

9 
	~"obje˘.h
"

10 
	~"exec.h
"

11 
	~"Àx.h
"

12 
	~"simuœã.h
"

14 
dump_sm¨t_log
 ();

16 
obje˘
 *
	gsimul_efun_ob
 = 0;

23 
	$gë_simul_efun
()

25 
obje˘
 *
ob
;

27 
	#SIMULFILE
 "£cuª/simul_efun.c"

	)

29 
FILE
 *
f
;

30 
¥ogøm
 *
¥og
;

31 *
cuºít_fûe
;

32 
tŸÆ_löes
;

33 
num_∑r£_îr‹
;

34 *
öhîô_fûe
;

35 *
cuºít_lﬂded_fûe
;

36 #ifde‡
USE_SWAP


37 
obje˘
 *
sw≠_ob
;

39 
	`öô_sm¨t_log
();

41 
f
 = 
	`f›í
(
SIMULFILE
, "r");

42 i‡(
f
 == 0)

44 ()
	`Ârötf
(
°dîr
, 
SIMULFILE
 "Çot found.\n");

45 
	`exô
(1);

48 
	`öô_sm¨t_log
();

49 
	`°¨t_√w_fûe
(
f
);

50 
cuºít_fûe
 = 
	`°rög_c›y
(
SIMULFILE
);

51 
cuºít_lﬂded_fûe
 = 
SIMULFILE
;

52 
	`compûe_fûe
();

53 
	`íd_√w_fûe
();

54 
cuºít_lﬂded_fûe
 = 0;

55 
tŸÆ_löes
 = 0;

56 ()
	`f˛o£
(
f
);

57 
	`‰ì
(
cuºít_fûe
);

58 
cuºít_fûe
 = 0;

59 
	`dump_sm¨t_log
();

60 i‡(
öhîô_fûe
 || 
num_∑r£_îr‹
 > 0 || 
¥og
 == 0)

62 ()
	`Ârötf
(
°dîr
, "Eº‹ i¿" 
SIMULFILE
 ".\n");

66 ()
	`Ârötf
(
°dîr
,"%†lﬂded: %d fun˘i⁄s\n", 
SIMULFILE
,

67 
¥og
->
num_fun˘i⁄s
);

68 i‡(
¥og
->
num_fun˘i⁄s
 == 0)

74 
ob
 = 
	`gë_em±y_obje˘
();

75 
ob
->
«me
 = 
	`°rög_c›y
("secure/simul_efun");

76 
ob
->
¥og
 =Örog;

77 
ob
->
¥og
->
Êags
 |
PRAGMA_RESIDENT
;

78 i‡(
obj_li°
)

80 
ob
->
√xt_Æl
 = 
obj_li°
;

81 
ob
->
¥ev_Æl
 = 
obj_li°
->prev_all;

82 
obj_li°
->
¥ev_Æl
->
√xt_Æl
 = 
ob
;

83 
obj_li°
->
¥ev_Æl
 = 
ob
;

84 
obj_li°
 = 
ob
;

87 #ifde‡
USE_SWAP


88 
sw≠_ob
 =

90 
obj_li°
 = 
ob
->
√xt_Æl
 = ob->
¥ev_Æl
 = ob;

92 #ifde‡
USE_SWAP


93 i‡(
cuºít_obje˘
)

94 
	`ac˚ss_obje˘
(
cuºít_obje˘
);

97 
simul_efun_ob
 = 
ob
;

98 
	`add_ªf
(
ob
, "simul_efun");

99 
	`íãr_obje˘_hash
(
ob
);

101 
num_v¨
, 
i
;

102 
tŸ_Æloc_v¨übÀ_size
;

104 
num_v¨
 = 
ob
->
¥og
->
num_v¨übÀs
 +

105 
ob
->
¥og
->
öhîô
[ob->¥og->
num_öhîôed
 - 1]

106 .
v¨übÀ_ödex_off£t
 + 1;

107 i‡(
ob
->
v¨übÀs
)

108 
	`Áèl
("Objectállready initialized!\n");

110 
ob
->
v¨übÀs
 = (
svÆue
 *)

111 
	`xÆloc
(
num_v¨
 * (
svÆue
));

112 
tŸ_Æloc_v¨übÀ_size
 +
num_v¨
 * (
svÆue
);

113 
i
0; i<
num_v¨
; i++)

114 
ob
->
v¨übÀs
[
i
] = 
c⁄°0
;

115 
ob
->
v¨übÀs
++;

117 
cuºít_obje˘
 = 0;

119 
simul_efun_ob
 = 
	`lﬂd_obje˘
(
SIMULFILE
, 1, 0);

122 
	}
}

	@simulate.c

1 
	~<sys/ty≥s.h
>

2 
	~<sys/°©.h
>

3 
	~<f˙é.h
>

4 
	~<°rög.h
>

5 
	~<˘y≥.h
>

6 
	~<î∫o.h
>

7 
	~<°dio.h
>

8 
	~<mem‹y.h
>

9 
	~<°d¨g.h
>

10 
	~<°dlib.h
>

11 #i‡
deföed
(
sun
Ë|| deföed(
__osf__
)

12 
	~<Æloˇ.h
>

14 #i‡
deföed
(
M_UNIX
Ë|| deföed(
_SEQUENT_
Ë|| deföed(
SOLARIS
) || \

15 
deföed
(
__O≥nBSD__
Ë|| deföed(
__NëBSD__
Ë|| 
	$deföed
(
__FªeBSD__
)

16 
	~<dúít.h
>

18 
	~<sys/dú.h
>

21 
	~"c⁄fig.h
"

22 
	~"löt.h
"

23 
	~"m°rög.h
"

24 
	~"°dio.h
"

25 
	~"öãΩªt.h
"

26 
	~"obje˘.h
"

27 
	~"m≠pög.h
"

28 
	~"£¡.h
"

29 
	~"exec.h
"

30 
	~"comm.h
"

31 
	~"mud°©.h
"

32 
	~"ö¸Æloc.h
"

33 
	~"sw≠.h
"

34 
	~"ˇŒ_out.h
"

35 
	~"maö.h
"

36 
	~"comm1.h
"

37 
	~"simuœã.h
"

38 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


39 
	~"Àx.h
"

42 
	~"ölöe_svÆue.h
"

44 
î∫o
;

45 
comp_Êag
;

47 *
öhîô_fûe
;

49 #i‡!
	`deföed
(
NeXT
Ë&& !deföed(
löux
)

50 
	`l°©
 (c⁄° *, 
°©
 *);

52 
	#l°©
 
°©


	)

54 #i‚de‡
löux


55 #ifde‡
VAX_BSD


56 
	tmode_t
;

58 
	`fchmod
 (, 
mode_t
);

60 *
œ°_vîb
, *
åig_vîb
;

61 
cuºít_time
, 
tŸ_Æloc_de°_obje˘
, 
tŸ_ªmoved_obje˘
;

63 
	`£t_ˇŒ
 (
obje˘
 *, 
£¡í˚
 *, ),

64 
	`ÀgÆ_∑th
 (*);

66 
	`öô_sm¨t_log
 ();

67 
	`dump_sm¨t_log
 ();

68 
	`ªmove_öãø˘ive
 (
öãø˘ive
 *, );

69 
	`add_a˘i⁄
 (
˛osuª
 *, 
svÆue
 *, );

70 
	`ùc_ªmove
(),

71 
	`ªmove_Æl_∂ayîs
(), 
	`íd_√w_fûe
(),

72 
	`de°ru˘2
(
obje˘
 *);

73 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


74 
	`ªmove_Æl_obje˘s
();

75 
	`‰ì_Æl_£¡
();

76 
	`tmp˛ón
();

78 *
	`dump_mÆloc_d©a
();

79 
	`°¨t_√w_fûe
 (
FILE
 *);

81 
d_Êag
, 
s_Êag
;

83 
obje˘
 *
obj_li°
, *
obj_li°_de°ru˘
, *
ma°î_ob
, *
auto_ob
;

85 
obje˘
 *
cuºít_obje˘
;

86 
obje˘
 *
comm™d_givî
;

87 
obje˘
 *
cuºít_öãø˘ive
;

89 
num_∑r£_îr‹
;

91 
	`shutdowngame
();

93 
obje˘
* 
	`föd_obje˘_no_¸óã
(*);

96 
	$föd_°©us
(
¥ogøm
 *
¥og
, *
°r
, 
nŸ_ty≥
)

98 
i
, 
j
;

99 *
su≥r_«me
 = 0;

100 *
sub_«me
;

101 *
ªÆ_«me
;

102 *
£¨ch
;

104 
v¨übÀ_ödex_found
 = 
v¨übÀ_öhîô_found
 = 255;

105 
ªÆ_«me
 = 
	`°ºchr
(
°r
, ':') + 1;

106 
sub_«me
 = 
	`°rchr
(
°r
, ':') + 2;

108 if(!(
ªÆ_«me
 = (
	`föd_s°rög
(‘ól_«mê=(*)1Ë? 
°r
 :Ñeal_name))))

110 i‡(
sub_«me
 == (*)2)

112 #ifde‡
USE_SWAP


113 
	`ac˚ss_¥ogøm
(
¥og
);

115 
i
 = 0; i < ()
¥og
->
num_v¨übÀs
; i++)

117 i‡(
¥og
->
v¨übÀ_«mes
[
i
].
«me
 =
ªÆ_«me
 &&

118 !(
¥og
->
v¨übÀ_«mes
[
i
].
ty≥
 & 
nŸ_ty≥
))

120 
v¨übÀ_ödex_found
 = 
i
;

121 
v¨übÀ_öhîô_found
 = 
¥og
->
num_öhîôed
 - 1;

122 
v¨übÀ_ty≥_mod_found
 = 
¥og
->
v¨übÀ_«mes
[
i
].
ty≥
;

123  
¥og
->
öhîô
[
v¨übÀ_öhîô_found
].
v¨übÀ_ödex_off£t
 + 
i
;

127 i‡(
sub_«me
 - 
°r
 > 2)

129 
su≥r_«me
 = 
	`xÆloc
((
size_t
)(
sub_«me
 - 
°r
 - 1));

130 ()
	`mem˝y
(
su≥r_«me
, 
°r
, (
size_t
)(
sub_«me
 - str - 2));

131 
su≥r_«me
[
sub_«me
 - 
°r
 - 2] = 0;

132 i‡(
	`°rcmp
(
su≥r_«me
, "this") == 0)

133  
	`föd_°©us
(
¥og
, 
sub_«me
, 
nŸ_ty≥
);

136 
°r
 = 
sub_«me
;

138 
j
 = 
¥og
->
num_öhîôed
 - 2; j >0 ;j -¥og->
öhîô
[j].prog->num_inherited)

140 i‡(
su≥r_«me
 &&

141 
	`°rcmp
(
su≥r_«me
, 
¥og
->
öhîô
[
j
].
«me
) == 0)

142 
£¨ch
 = 
sub_«me
;

144 
£¨ch
 = 
°r
;

145 i‡(
	`föd_°©us
(
¥og
->
öhîô
[
j
].¥og, 
£¨ch
, 
nŸ_ty≥
) != -1)

147 
ty≥1
 = 
¥og
->
öhîô
[
j
].
ty≥
;

148 i‡(
v¨übÀ_ty≥_mod_found
 & 
TYPE_MOD_PUBLIC
)

149 
ty≥1
 &~
TYPE_MOD_PRIVATE
;

150 i‡(
v¨übÀ_ty≥_mod_found
 & 
TYPE_MOD_PRIVATE
)

151 
ty≥1
 &~
TYPE_MOD_PUBLIC
;

152 
v¨übÀ_ty≥_mod_found
 |
ty≥1
 & 
TYPE_MOD_MASK
;

153 i‡(
v¨übÀ_ty≥_mod_found
 & 
nŸ_ty≥
)

156 
v¨übÀ_öhîô_found
 +
j
 -

157 (
¥og
->
öhîô
[
j
].¥og->
num_öhîôed
 - 1);

158  
¥og
->
öhîô
[
v¨übÀ_öhîô_found
].
v¨übÀ_ödex_off£t
 +

159 
v¨übÀ_ödex_found
;

163 
	}
}

167 
	$sw≠_obje˘s
(
obje˘
 *
ob1
, obje˘ *
ob2
)

169 
	`ˇŒ_out_sw≠_obje˘s
(
obje˘
 *, object *);

170 
	`°ack_sw≠_obje˘s
(
obje˘
 *, object *);

171 
¥ogøm
 *
tmp_¥og
;

172 
svÆue
 *
tmp_v¨
;

174 #ifde‡
USE_SWAP


175 
	`ªmove_ob_‰om_sw≠
(
ob1
);

176 
	`ªmove_ob_‰om_sw≠
(
ob2
);

180 
	`ˇŒ_out_sw≠_obje˘s
(
ob1
, 
ob2
);

181 
	`°ack_sw≠_obje˘s
(
ob1
, 
ob2
);

183 
tmp_v¨
 = 
ob1
->
v¨übÀs
;

184 
ob1
->
v¨übÀs
 = 
ob2
->variables;

185 
ob2
->
v¨übÀs
 = 
tmp_v¨
;

187 
tmp_¥og
 = 
ob1
->
¥og
;

188 
ob1
->
¥og
 = 
ob2
->prog;

189 
ob2
->
¥og
 = 
tmp_¥og
;

192 
ob1
->
Êags
 ^
ob2
->Êag†& 
O_CREATED
;

193 
ob2
->
Êags
 ^
ob1
->Êag†& 
O_CREATED
;

194 
ob1
->
Êags
 ^
ob2
->Êag†& 
O_CREATED
;

196 
	}
}

211 *
	gcuºít_lﬂded_fûe
 = 0;

212 #ifde‡
BINARIES


213 
ßve_bö¨y
(
¥ogøm
 *);

216 
obje˘
 *

217 
	$lﬂd_obje˘
(*
 ame
, 
d⁄t_ª£t
, 
obje˘
 *
ﬁd_ob
, 
dïth
)

219 
FILE
 *
f
;

220 
tŸÆ_löes
;

222 
obje˘
 *
ob
, *
ßve_comm™d_givî
 = 
comm™d_givî
;

223 
¥ogøm
 *
¥og
;

224 *
cuºít_fûe
;

225 
°©
 
c_°
;

226 
«me_Àngth
;

227 
ªÆ_«me
[200], 
«me
[200];

228 #ifde‡
USE_SWAP


229 
obje˘
 *
sw≠_ob
;

231 
√w_ob_«me
[200];

232 #ifde‡
BINARIES


233 
¥agma_ßve_bö¨y
;

234 
îrbö
 = 1;

235 
fûe_mtime
;

236 *
bö«me
;

237 
FILE
 *
böfûe
;

242 
 ame
[0] == '/')

243 
 ame
++;

244 ()
	`°∫˝y
(
«me
, 
 ame
, (name) - 1);

245 
«me
[Çame - 1] = '\0';

246 
«me_Àngth
 = 
	`°æí
(
«me
);

247 i‡(
«me_Àngth
 >  
«me
 - 4)

248 
«me_Àngth
 =  
«me
 - 4;

249 
«me
[
«me_Àngth
] = '\0';

250 
«me_Àngth
 >2 && 
«me
[name_length-2] == '.' &&Çame[name_length-1] == 'c') {

251 
«me
[
«me_Àngth
-2] = '\0';

252 
«me_Àngth
 -= 2;

254 i‡(
«me_Àngth
 == 0) {

255 
	`Ârötf
(
°dîr
, "NuŒ obje˘Çamêa·î såùpög of‡suffix”sËo‡%s\n", 
 ame
);

256 
	`îr‹
("Invalid objectÇame.\n");

258 i‡(
	`°r°r
(
«me
, "//"))

260 
	`îr‹
("InvÆid obje˘Çame: %s\n", 
«me
);

263 i‡(
ﬁd_ob
)

265 
obje˘
 *
övÆid_ob
;

267 ()
	`°r˝y
(
√w_ob_«me
, 
«me
);

268 ()
	`°rˇt
(
√w_ob_«me
, "#0");

269 i‡–(
övÆid_ob
 = 
	`föd_obje˘2
(
√w_ob_«me
)Ë!
NULL
 )

271 
övÆid_ob
->
¥og
->
Êags
 &~
PRAGMA_RESIDENT
;

272 
	`de°ru˘_obje˘
(
övÆid_ob
);

280 ()
	`°r˝y
(
ªÆ_«me
, 
«me
);

281 ()
	`°rˇt
(
ªÆ_«me
, ".c");

283 i‡(
dïth
 > 
MAX_INHERIT
)

285 ()
	`Ârötf
(
°dîr
, "Inhîô chaöÅoÿl⁄g f‹ %s\n", 
ªÆ_«me
);

286 
	`îr‹
("Inherit chainÅooÜong.\n");

290 #ifde‡
PURIFY


291 ()
	`mem£t
(&
c_°
, '\0', (c_st));

293 i‡(
	`°©
(
ªÆ_«me
, &
c_°
) == -1)

295 ()
	`Ârötf
(
°dîr
, "CouldÇŸÜﬂd des¸ f‹ %s\n", 
ªÆ_«me
);

296 
	`îr‹
("FailedÅoÜoad file.\n");

299 #ifde‡
BINARIES


300 
fûe_mtime
 = ()
c_°
.
°_mtime
;

305 i‡(!
	`ÀgÆ_∑th
(
ªÆ_«me
))

307 ()
	`Ârötf
(
°dîr
, "IŒegÆÖ©h«me: %s\n", 
ªÆ_«me
);

308 
	`îr‹
("IllegalÖathÇame.\n");

312 #ifde‡
BINARIES


313 
bö«me
 = (*)
	`xÆloc
(
	`°æí
(
BINARIES
) +

314 
	`°æí
(
ªÆ_«me
) + 1);

315 ()
	`•rötf
(
bö«me
, "%s%s", 
BINARIES
, 
ªÆ_«me
);

317 
îrbö
 = 1;

318 i‡(
	`°©
(
bö«me
, &
c_°
) != -1)

319 i‡((
fûe_mtime
 < 
c_°
.
°_mtime
))

320 i‡((
böfûe
 = 
	`f›í
(
bö«me
, "r")Ë!
NULL
)

322 
îrbö
 = 
	`lﬂd_bö¨y
(
böfûe
, 
ªÆ_«me
);

324 i‡(!
îrbö
 && !
öhîô_fûe
)

326 i‡(
comp_Êag
)

327 ()
	`Ârötf
(
°dîr
," %sÜoaded from binary: %s\n",

328 
ªÆ_«me
, 
bö«me
);

331 
	`‰ì
(
bö«me
);

332 
¥agma_ßve_bö¨y
 = 0;

333 i‡(
îrbö
) {

336 i‡(
comp_Êag
)

337 ()
	`Ârötf
(
°dîr
, " compûög %†...", 
ªÆ_«me
);

338 
f
 = 
	`f›í
(
ªÆ_«me
, "r");

339 i‡(
s_Êag
)

341 
num_fûîód
++;

342 
num_compûe
++;

345 i‡(
f
 == 0)

347 
	`≥º‹
(
ªÆ_«me
);

348 
	`îr‹
("CouldÇotÑeadÅhe file.\n");

351 
	`öô_sm¨t_log
();

352 
	`°¨t_√w_fûe
(
f
);

353 
cuºít_fûe
 = 
	`°rög_c›y
(
ªÆ_«me
);

354 
cuºít_lﬂded_fûe
 = 
ªÆ_«me
;

355 
	`compûe_fûe
();

356 
	`íd_√w_fûe
();

357 
cuºít_lﬂded_fûe
 = 0;

358 i‡(
comp_Êag
)

360 i‡(
öhîô_fûe
 == 0)

361 ()
	`Ârötf
(
°dîr
, " done\n");

363 ()
	`Ârötf
(
°dîr
, " suspended, compiling inherited file(s)\n");

365 
	`upd©e_compûe_av
(
tŸÆ_löes
);

366 
tŸÆ_löes
 = 0;

367 ()
	`f˛o£
(
f
);

368 
	`‰ì
(
cuºít_fûe
);

369 
cuºít_fûe
 = 0;

370 
	`dump_sm¨t_log
();

372 i‡(
öhîô_fûe
 =0 && (
num_∑r£_îr‹
 > 0 || 
¥og
 == 0))

374 i‡(
¥og
)

375 
	`‰ì_¥og
(
¥og
);

376 i‡(
num_∑r£_îr‹
 =0 && 
¥og
 == 0) {

377 
	`îr‹
("NoÖrogram in object !\n");

380 i‡(!
ﬁd_ob
)

381 
	`îr‹
("Error inÜoading object\n");

384 #ifde‡
BINARIES


394 i‡(
öhîô_fûe
)

396 *
tmp
 = 
öhîô_fûe
;

397 
Àn
 = 
	`°æí
(
öhîô_fûe
);

398 *
t1
 = 
tmp
;

400 i‡(
¥og
)

402 
	`‰ì_¥og
(
¥og
);

403 
¥og
 = 0;

405 *
t1
=='/') {

406 
t1
++;

407 
Àn
--;

409 
Àn
 >2 && 
t1
[len-2] == '.' &&Å1[len-1] == 'c') {

410 
t1
[
Àn
-2] = '\0';

411 
Àn
 -= 2;

414 i‡(
Àn
 == 0) {

415 
öhîô_fûe
 = 
NULL
;

416 
	`îr‹
("Invalid fileÇame included.\n");

420 i‡(
	`°rcmp
(
t1
, 
«me
) == 0) {

421 
öhîô_fûe
 = 
NULL
;

422 
	`îr‹
("IllegalÅo inherit self.\n");

429 
öhîô_fûe
 = 
NULL
;

431 ()
	`lﬂd_obje˘
(
t1
, 1, 0, 
dïth
 + 1);

432 
	`‰ì
(
tmp
);

436 
ob
 = 
	`lﬂd_obje˘
(
«me
, 
d⁄t_ª£t
, 
ﬁd_ob
, 
dïth
);

437  
ob
;

439 
ob
 = 
	`gë_em±y_obje˘
();

440 i‡(!
ﬁd_ob
)

441 
ob
->
«me
 = 
	`°rög_c›y
(name);

444 
ob
->
«me
 = 
	`xÆloc
(
	`°æí
(name) + 3);

445 ()
	`°r˝y
(
ob
->
«me
,Çame);

446 ()
	`°rˇt
(
ob
->
«me
, "#0");

448 
ob
->
¥og
 =Örog;

449 #ifde‡
BINARIES


450 i‡(
¥agma_ßve_bö¨y
)

452 
	`ßve_bö¨y
(
ob
->
¥og
);

453 
¥agma_ßve_bö¨y
 = 0;

456 #ifde‡
USE_SWAP


457 
	`sw≠_löío
(
ob
->
¥og
);

460 i‡(
obj_li°
)

462 
ob
->
√xt_Æl
 = 
obj_li°
;

463 
ob
->
¥ev_Æl
 = 
obj_li°
->prev_all;

465 
obj_li°
->
¥ev_Æl
->
√xt_Æl
 = 
ob
;

466 
obj_li°
->
¥ev_Æl
 = 
ob
;

467 
obj_li°
 = 
ob
;

470 #ifde‡
USE_SWAP


471 
sw≠_ob
 =

473 
obj_li°
 = 
ob
->
√xt_Æl
 = ob->
¥ev_Æl
 = ob;

475 #ifde‡
USE_SWAP


476 i‡(
cuºít_obje˘
)

477 
	`ac˚ss_obje˘
(
cuºít_obje˘
);

483 
	`íãr_obje˘_hash
(
ob
);

486 
num_v¨
, 
i
;

487 
tŸ_Æloc_v¨übÀ_size
;

489 
num_v¨
 = 
ob
->
¥og
->
num_v¨übÀs
 +

490 
ob
->
¥og
->
öhîô
[ob->¥og->
num_öhîôed
 - 1]

491 .
v¨übÀ_ödex_off£t
 + 1;

492 i‡(
ob
->
v¨übÀs
)

493 
	`Áèl
("Objectállready initialized!\n");

495 
ob
->
v¨übÀs
 = (
svÆue
 *)

496 
	`xÆloc
(
num_v¨
 * (
svÆue
));

497 
tŸ_Æloc_v¨übÀ_size
 +
num_v¨
 * (
svÆue
);

498 
i
0; i<
num_v¨
; i++)

499 
ob
->
v¨übÀs
[
i
] = 
c⁄°0
;

500 
ob
->
v¨übÀs
++;

507 i‡(
ma°î_ob
)

509 
ßve_ªsidít
;

511 
	`push_obje˘
(
cuºít_obje˘
);

512 
	`push_obje˘
(
ob
);

513 
ßve_ªsidít
 = 
ob
->
¥og
->
Êags
 & 
PRAGMA_RESIDENT
;

514 
ob
->
¥og
->
Êags
 &~
PRAGMA_RESIDENT
;

515 ()
	`≠∂y_ma°î_ob
(
M_LOADED_OBJECT
, 2);

516 i‡((
ob
->
Êags
 & 
O_DESTRUCTED
) == 0)

517 
ob
->
¥og
->
Êags
 |
ßve_ªsidít
;

519 i‡(!(
ob
->
Êags
 & (
O_CREATED
 | 
O_DESTRUCTED
)Ë&& !
d⁄t_ª£t
)

520 
	`¸óã_obje˘
(
ob
);

522 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

524 #ifde‡
DO_CLEANUP


525 
ob
->
Êags
 |
O_WILL_CLEAN_UP
;

528 
comm™d_givî
 = 
ßve_comm™d_givî
;

529 i‡(
d_Êag
 & 
DEBUG_LOAD
 && 
ob
)

530 
	`debug_mesßge
("--%†lﬂded\n", 
ob
->
«me
);

533 i‡(
ma°î_ob
 && (
ob
->
¥og
->
Êags
 & 
PRAGMA_RESIDENT
))

535 
svÆue
 *
ªt
;

536 
	`push_obje˘
(
ob
);

537 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_VALID_RESIDENT
, 1);

538 i‡(
ªt
 && (ªt->
ty≥
 !
T_NUMBER
 ||Ñë->
u
.
numbî
 == 0))

539 
ob
->
¥og
->
Êags
 &~
PRAGMA_RESIDENT
;

543  
ob
;

544 
	}
}

547 
	$make_√w_«me
(*
°r
)

549 
i
 = 1;

550 *
p
 = 
	`xÆloc
(
	`°æí
(
°r
) + 10);

552 (Ë
	`•rötf
(
p
, "%s#%d", 
°r
, 
i
);

553 
i
++;

554  
p
;

555 
	}
}

562 
obje˘
 *

563 
	$˛⁄e_obje˘
(*
°r1
)

565 
obje˘
 *
ob
, *
√w_ob
;

566 
obje˘
 *
ßve_comm™d_givî
 = 
comm™d_givî
;

567 #ifde‡
USE_SWAP


568 
obje˘
 *
sw≠_ob
;

571 
ob
 = 
	`föd_obje˘_no_¸óã
(
°r1
);

572 i‡(
ob
 =0 || ob->
su≥r
 || (ob->
Êags
 & 
O_CLONE
Ë|| ob->
¥og
->Êag†& 
PRAGMA_NO_CLONE
) {

573 
	`îr‹
("Cloningá bad object! (No Master, Master inÉnvironment or Master is clone)\n");

579 
√w_ob
 = 
	`gë_em±y_obje˘
();

581 
√w_ob
->
«me
 = 
	`make_√w_«me
(
ob
->name);

582 
√w_ob
->
Êags
 |
O_CLONE
;

583 
√w_ob
->
¥og
 = 
ob
->prog;

584 
	`ª„ªn˚_¥og
 (
ob
->
¥og
, "clone_object");

585 i‡(!
cuºít_obje˘
)

586 
	`Áèl
("clone_object() fromÇo current_object !\n");

589 i‡(
obj_li°
)

591 
√w_ob
->
√xt_Æl
 = 
obj_li°
;

592 
√w_ob
->
¥ev_Æl
 = 
obj_li°
->prev_all;

593 
obj_li°
->
¥ev_Æl
->
√xt_Æl
 = 
√w_ob
;

594 
obj_li°
->
¥ev_Æl
 = 
√w_ob
;

595 
obj_li°
 = 
√w_ob
;

598 #ifde‡
USE_SWAP


599 
sw≠_ob
 =

601 
obj_li°
 = 
√w_ob
->
√xt_Æl
 =Çew_ob->
¥ev_Æl
 =Çew_ob;

603 
	`íãr_obje˘_hash
(
√w_ob
);

605 
num_v¨
, 
i
;

606 
tŸ_Æloc_v¨übÀ_size
;

608 
num_v¨
 = 
√w_ob
->
¥og
->
num_v¨übÀs
 +

609 
√w_ob
->
¥og
->
öhîô
[
ob
->¥og->
num_öhîôed
 - 1]

610 .
v¨übÀ_ödex_off£t
 + 1;

611 i‡(
√w_ob
->
v¨übÀs
)

612 
	`Áèl
("Objectállready initialized!\n");

614 
√w_ob
->
v¨übÀs
 = (
svÆue
 *)

615 
	`xÆloc
(
num_v¨
 * (
svÆue
));

616 
tŸ_Æloc_v¨übÀ_size
 +
num_v¨
 * (
svÆue
);

617 
i
0; i<
num_v¨
; i++)

618 
√w_ob
->
v¨übÀs
[
i
] = 
c⁄°0
;

619 
√w_ob
->
v¨übÀs
++;

621 i‡(
ma°î_ob
)

623 
	`push_obje˘
(
cuºít_obje˘
);

624 
	`push_obje˘
(
√w_ob
);

625 ()
	`≠∂y_ma°î_ob
(
M_CLONED_OBJECT
, 2);

626 i‡(
√w_ob
->
Êags
 & 
O_DESTRUCTED
)

629 i‡(!(
ob
->
Êags
 & 
O_CREATED
))

630 
	`¸óã_obje˘
(
√w_ob
);

631 
comm™d_givî
 = 
ßve_comm™d_givî
;

633 i‡(
√w_ob
->
Êags
 & 
O_DESTRUCTED
)

635  
√w_ob
;

636 
	}
}

638 
obje˘
 *

639 
	$ívú⁄mít
(
svÆue
 *
¨g
)

641 
obje˘
 *
ob
 = 
cuºít_obje˘
;

643 i‡(
¨g
 &&árg->
ty≥
 =
T_OBJECT
)

644 
ob
 = 
¨g
->
u
.ob;

645 i‡(
¨g
 &&árg->
ty≥
 =
T_STRING
)

646 
ob
 = 
	`föd_obje˘2
(
¨g
->
u
.
°rög
);

647 i‡(
ob
 =0 || ob->
su≥r
 =0 || (ob->
Êags
 & 
O_DESTRUCTED
))

649 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
) {

650 
	`îr‹
("environment() off destructed object.\n");

653  
ob
->
su≥r
;

654 
	}
}

666 
	$comm™d_f‹_obje˘
(*
°r
, 
obje˘
 *
ob
)

668 
buff
[1000];

669 
evÆ_co°
;

670 
ßve_evÆ_co°
 = 
evÆ_co°
 - 1000;

672 i‡(
	`°æí
(
°r
Ë> (
buff
) - 1) {

673 
	`îr‹
("TooÜong command.\n");

676 i‡(
ob
 == 0)

677 
ob
 = 
cuºít_obje˘
;

678 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

680 ()
	`°∫˝y
(
buff
, 
°r
,  buff);

681 
buff
[ buff - 1] = '\0';

682 i‡(
	`∑r£_comm™d
(
buff
, 
ob
))

683  
evÆ_co°
 - 
ßve_evÆ_co°
;

686 
	}
}

692 
obje˘
 *
obje˘_¥e£¡2
 (*, object *);

694 
obje˘
 *

695 
	$obje˘_¥e£¡
(
svÆue
 *
v
, svÆuê*
whîe
)

697 
i
;

698 
obje˘
 *
ªt
;

700 i‡(
v
->
ty≥
 =
T_OBJECT
)

701 i‡(
v
->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
)

704 
whîe
->
ty≥
)

706 
T_OBJECT
:

707 i‡(
whîe
->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
)

710 i‡(
v
->
ty≥
 =
T_OBJECT
)

712 i‡(
v
->
u
.
ob
->
su≥r
 =
whîe
->u.ob)

713  
v
->
u
.
ob
;

718  
	`obje˘_¥e£¡2
(
v
->
u
.
°rög
, 
whîe
->u.
ob
->
c⁄èös
);

719 
T_POINTER
:

720 i‡(
v
->
ty≥
 =
T_OBJECT
)

722 
i
 = 0 ; i < 
whîe
->
u
.
vec
->
size
 ; i++)

724 i‡(
whîe
->
u
.
vec
->
ôem
[
i
].
ty≥
 !
T_OBJECT
)

726 i‡(
v
->
u
.
ob
->
su≥r
 =
whîe
->u.
vec
->
ôem
[
i
].u.ob)

727  
v
->
u
.
ob
;

732 
i
 = 0 ; i < 
whîe
->
u
.
vec
->
size
 ; i++)

734 i‡(
whîe
->
u
.
vec
->
ôem
[
i
].
ty≥
 !
T_OBJECT
)

736 i‡–(
ªt
 =

737 
	`obje˘_¥e£¡2
(
v
->
u
.
°rög
,

738 
whîe
->
u
.
vec
->
ôem
[
i
].u.
ob
->
c⁄èös
)Ë!
NULL
 )

739  
ªt
;

744 
	`îr‹
("Så™gêty≥ %d i¿obje˘_¥e£¡.\n", 
whîe
->
ty≥
);

748 
	}
}

750 
obje˘
 *

751 
	$obje˘_¥e£¡2
(*
°r
, 
obje˘
 *
ob
)

753 
svÆue
 *
ªt
;

754 *
p
;

755 
cou¡
 = 0, 
Àngth
;

756 *
ôem
;

758 
ôem
 = 
	`°rög_c›y
(
°r
);

759 
Àngth
 = 
	`°æí
(
ôem
);

760 
p
 = 
ôem
 + 
Àngth
 - 1;

761 i‡(*
p
 >= '0' && *p <= '9')

763 
p
 > 
ôem
 && *p >= '0' && *p <= '9')

764 
p
--;

765 i‡(
p
 > 
ôem
 && *p == ' ')

767 
cou¡
 = 
	`©oi
(
p
+1) - 1;

768 *
p
 = '\0';

769 
Àngth
 = 
p
 - 
ôem
;

772 ; 
ob
; ob = ob->
√xt_öv
)

774 
	`push_°rög
(
ôem
, 
STRING_MSTRING
);

775 
ªt
 = 
	`≠∂y
("id", 
ob
, 1, 1);

776 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

778 
	`‰ì
(
ôem
);

781 i‡(
ªt
 =0 || (ªt->
ty≥
 =
T_NUMBER
 &&Ñë->
u
.
numbî
 == 0))

783 i‡(
cou¡
-- > 0)

785 
	`‰ì
(
ôem
);

786  
ob
;

788 
	`‰ì
(
ôem
);

790 
	}
}

799 
	$de°ru˘_obje˘
(
obje˘
 *
ob
)

801 
gdex˚±i⁄
 
ex˚±i⁄_‰ame
;

802 #ifde‡
USE_SWAP


803 
obje˘
 *
sw≠_ob
;

805 
obje˘
 *
vbfc_obje˘
;

806 
svÆue
 *
ªt
;

807 
obje˘
 *
sob
, **
µ
;

808 
si
, 
i
;

810 i‡(
ob
 =
NULL
 || (ob->
Êags
 & 
O_DESTRUCTED
))

817 i‡–(!(
ob
->
Êags
 & 
O_CLONE
Ë&& (ob->
¥og
->Êag†& 
PRAGMA_RESIDENT
)) ||

818 
ob
 =
auto_ob
 || ob =
ma°î_ob
 || ob =
simul_efun_ob
)

820 
obje˘
 *
√w_ob
;

822 
√w_ob
 = 
	`lﬂd_obje˘
(
ob
->
«me
, 1, ob, 0);

823 i‡(!
√w_ob
) {

824 
	`îr‹
("C™ÇŸ compûêthê√w %s,áb‹tög de°ru˘i⁄ o‡thêﬁd.\n", 
ob
->
¥og
->
«me
);

830 i‡(
ob
 =
ma°î_ob
 || ob =
auto_ob
 ||

831 
ob
 =
simul_efun_ob
)

832 
ob
->
¥og
->
Êags
 |
PRAGMA_RESIDENT
;

834 
	`sw≠_obje˘s
(
ob
, 
√w_ob
);

835 i‡(
ob
 =
ma°î_ob
)

837 
	`ma°î_ob_lﬂded
();

839 
	`ma°î_ob_lﬂded
();

841 i‡(
√w_ob
 &&Çew_ob->
Êags
 & 
O_CREATED
)

842 
	`ª¸óã_obje˘
(
ob
, 
√w_ob
);

843 
ob
 = 
√w_ob
;

844 
ob
->
¥og
->
Êags
 &~
PRAGMA_RESIDENT
;

847 
	`push_obje˘
(
ob
);

848 ()
	`≠∂y_ma°î_ob
(
M_DESTRUCTED_OBJECT
, 1);

849 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
) ;

854 i‡(
ob
->
shadowed
 && !ob->
shadowög
)

856 
svÆue
 
svp
;

857 
obje˘
 *
ob2
;

859 
svp
.
ty≥
 = 
T_OBJECT
;

860 
ob2
 = 
ob
->
shadowed
; ob2; )

862 
svp
.
u
.
ob
 = 
ob2
;

863 
ob2
 = ob2->
shadowed
;

864 i‡(
svp
.
u
.
ob
->
shadowed
) {

865 
	`‰ì_obje˘
(
svp
.
u
.
ob
->
shadowed
, "destruct_object-5");

866 
svp
.
u
.
ob
->
shadowed
 = 0;

868 i‡(
svp
.
u
.
ob
->
shadowög
) {

869 
	`‰ì_obje˘
(
svp
.
u
.
ob
->
shadowög
, "destruct_object-6");

870 
svp
.
u
.
ob
->
shadowög
 = 0;

872 
	`de°ru˘_obje˘
(
ob2
);

873 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
) ;

880 i‡(
ob
->
shadowög
) {

881 
	`ch™ge_ªf
(
ob
->
shadowög
->
shadowed
, ob->shadowed, "destruct_object-1");

882 
ob
->
shadowög
->
shadowed
 = ob->shadowed;

885 i‡(
ob
->
shadowed
) {

886 
	`ch™ge_ªf
(
ob
->
shadowed
->
shadowög
, ob->shadowing, "destruct_object-2");

887 
ob
->
shadowed
->
shadowög
 = ob->shadowing;

889 i‡(
ob
->
shadowög
) {

890 
	`‰ì_obje˘
(
ob
->
shadowög
, "destruct_object-3");

891 
ob
->
shadowög
 = 0;

893 i‡(
ob
->
shadowed
) {

894 
	`‰ì_obje˘
(
ob
->
shadowed
, "destruct_object-4");

895 
ob
->
shadowed
 = 0;

898 i‡(
d_Êag
 & 
DEBUG_DESTRUCT
)

899 
	`debug_mesßge
("De°ru˘ obje˘ %†‘e‡%d)\n", 
ob
->
«me
, ob->
ªf
);

905 
svÆue
 
svp
;

906 
svp
.
ty≥
 = 
T_OBJECT
;

907 
ob
->
c⁄èös
)

909 
svp
.
u
.
ob
 = ob->
c⁄èös
;

910 
	`push_obje˘
(
ob
->
c⁄èös
);

914 ()
	`≠∂y_ma°î_ob
(
M_DESTRUCT_ENVIRONMENT_OF
,1);

915 i‡(
svp
.
u
.
ob
 =ob->
c⁄èös
)

916 
	`de°ru˘_obje˘
(
ob
->
c⁄èös
);

917 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
) ;

921 i‡(
ob
->
öãø˘ive
)

923 
obje˘
 *
ßve
=
comm™d_givî
;

925 
comm™d_givî
=
ob
;

926 i‡(
ob
->
öãø˘ive
->
ed_buf„r
)

928 
	`ßve_ed_buf„r
();

930 
	`ßve_ed_buf„r
();

932 
comm™d_givî
=
ßve
;

933 
	`ªmove_öãø˘ive
(
ob
->
öãø˘ive
, 0);

934 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
) ;

941 i‡(
ob
->
su≥r
) {

942 i‡(
ob
->
su≥r
->
Êags
 & 
O_ENABLE_COMMANDS
)

943 
	`ªmove_£¡
(
ob
, ob->
su≥r
);

944 
µ
 = &
ob
->
su≥r
->
c⁄èös
; *pp; )

946 i‡((*
µ
)->
Êags
 & 
O_ENABLE_COMMANDS
)

947 
	`ªmove_£¡
(
ob
, *
µ
);

948 i‡(*
µ
 !
ob
)

949 
µ
 = &(*µ)->
√xt_öv
;

951 *
µ
 = (*µ)->
√xt_öv
;

955 
ex˚±i⁄_‰ame
.
e_ex˚±i⁄
 = 
NULL
;

956 
ex˚±i⁄_‰ame
.
e_ˇtch
 = 0;

959 i‡(
ob
->
Êags
 & 
O_CREATED
)

961 
i
 = 
ob
->
¥og
->
num_öhîôed
 - 1; i >= 0; i--)

962 i‡(!(
ob
->
¥og
->
öhîô
[
i
].
ty≥
 & 
TYPE_MOD_SECOND
) &&

963 
ob
->
¥og
->
öhîô
[
i
].¥og->
dt‹_ödex
 !=

966 
	`push_p›_îr‹_c⁄ãxt
(1);

974 
si
 = 
i
;

975 
sob
 = 
ob
;

976 i‡(
	`£tjmp
(
ex˚±i⁄_‰ame
.
e_c⁄ãxt
))

978 
i
 = 
si
;

979 
ob
 = 
sob
;

980 
	`push_p›_îr‹_c⁄ãxt
(-1);

984 
i
 = 
si
;

985 
ob
 = 
sob
;

986 
ex˚±i⁄
 = &
ex˚±i⁄_‰ame
;

987 
	`ˇŒ_fun˘i⁄
(
ob
, 
i
,

988 ()
ob
->
¥og
->
öhîô
[
i
].¥og->
dt‹_ödex
, 0);

989 
	`p›_°ack
();

990 
	`push_p›_îr‹_c⁄ãxt
(0);

991 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

997 
	`ªmove_obje˘_‰om_°ack
(
ob
);

1005 #ifde‡
USE_SWAP


1006 i‡(
ob
 =
sw≠_ob
)

1007 
sw≠_ob
 = 
ob
->
¥ev_Æl
;

1009 i‡(
ob
 =
obj_li°
)

1010 
obj_li°
 = 
ob
->
√xt_Æl
;

1012 
ob
->
¥ev_Æl
->
√xt_Æl
 = ob->next_all;

1013 
ob
->
√xt_Æl
->
¥ev_Æl
 = ob->prev_all;

1014 i‡(
ob
->
√xt_Æl
 == ob)

1016 #ifde‡
USE_SWAP


1017 
sw≠_ob
 = 0;

1019 
obj_li°
 = 0;

1022 
	`dñëe_Æl_ˇŒs
(
ob
);

1023 
	`ªmove_obje˘_hash
(
ob
);

1024 i‡(
ob
->
livög_«me
)

1025 
	`ªmove_livög_«me
(
ob
);

1026 
ob
->
su≥r
 = 0;

1027 
ob
->
√xt_öv
 = 0;

1028 
ob
->
c⁄èös
 = 0;

1029 
ob
->
Êags
 &~
O_ENABLE_COMMANDS
;

1030 
ob
->
√xt_Æl
 = 
obj_li°_de°ru˘
;

1031 
ob
->
¥ev_Æl
 = 0;

1032 
obj_li°_de°ru˘
 = 
ob
;

1033 
ob
->
Êags
 |
O_DESTRUCTED
;

1035 
tŸ_Æloc_de°_obje˘
++;

1036 i‡(
ob
 =
vbfc_obje˘
)

1038 
	`‰ì_obje˘
(
vbfc_obje˘
, "destruct_object");

1039 
vbfc_obje˘
 = 0;

1040 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_GET_VBFC_OBJECT
, 0);

1041 i‡(
ªt
 &&Ñë->
ty≥
 =
T_OBJECT
)

1043 
vbfc_obje˘
 = 
ªt
->
u
.
ob
;

1044 
	`INCREF
(
vbfc_obje˘
->
ªf
);

1047 
	}
}

1053 
	$de°ru˘2
(
obje˘
 *
ob
)

1055 
£¡í˚
 *
s
;

1056 
num_v¨
;

1057 
tŸ_Æloc_v¨übÀ_size
;

1059 i‡(
d_Êag
 & 
DEBUG_DESTRUCT
)

1060 
	`debug_mesßge
("De°ru˘-2 obje˘ %†‘e‡%d)\n", 
ob
->
«me
, ob->
ªf
);

1062 i‡(
ob
->
öãø˘ive
)

1063 
	`ªmove_öãø˘ive
(
ob
->
öãø˘ive
, 0);

1065 #ifde‡
USE_SWAP


1066 
	`ªmove_ob_‰om_sw≠
(
ob
);

1082 
i
;

1083 
num_v¨
 = 
ob
->
¥og
->
num_v¨übÀs
 +

1084 
ob
->
¥og
->
öhîô
[ob->¥og->
num_öhîôed
 - 1].

1085 
v¨übÀ_ödex_off£t
 + 1;

1087 
ob
->
v¨übÀs
--;

1088 
i
=0; i < 
num_v¨
; i++) {

1089 
	`‰ì_svÆue
(&
ob
->
v¨übÀs
[
i
]);

1090 
ob
->
v¨übÀs
[
i
].
ty≥
 = 
T_NUMBER
;

1091 
ob
->
v¨übÀs
[
i
].
u
.
numbî
 = 0;

1093 
	`‰ì
((*)(
ob
->
v¨übÀs
));

1094 
ob
->
v¨übÀs
 = 0;

1095 
tŸ_Æloc_v¨übÀ_size
 -
num_v¨
 * (
svÆue
);

1098 
	`‰ì_¥og
(
ob
->
¥og
);

1099 
ob
->
¥og
 = 0;

1101 
s
 = 
ob
->
£¡
; s;)

1103 
£¡í˚
 *
√xt
;

1104 
√xt
 = 
s
->next;

1105 
	`‰ì_£¡í˚
(
s
);

1106 
s
 = 
√xt
;

1108 
	`dñëe_Æl_ˇŒs
(
ob
);

1109 
	`‰ì_obje˘
(
ob
, "destruct_object");

1110 
	}
}

1120 
	$íabÀ_comm™ds
(
num
)

1122 i‡(
cuºít_obje˘
->
Êags
 & 
O_DESTRUCTED
)

1124 i‡(
d_Êag
 & 
DEBUG_LIVING
)

1126 
	`debug_mesßge
("Enable commands %s (ref %d)\n",

1127 
cuºít_obje˘
->
«me
, cuºít_obje˘->
ªf
);

1129 i‡(
num
)

1131 
cuºít_obje˘
->
Êags
 |
O_ENABLE_COMMANDS
;

1132 
comm™d_givî
 = 
cuºít_obje˘
;

1136 
cuºít_obje˘
->
Êags
 &~
O_ENABLE_COMMANDS
;

1137 i‡(
comm™d_givî
 =
cuºít_obje˘
)

1138 
comm™d_givî
 = 0;

1140 
	}
}

1147 
	$öput_to
(
˛osuª
 *
fun
, 
n€cho_Êag
)

1149 
£¡í˚
 *
s
;

1150 
ªt
;

1152 i‡(!
comm™d_givî
 || comm™d_givî->
Êags
 & 
O_DESTRUCTED
)

1155 
s
 = 
	`Æloc_£¡í˚
();

1156 i‡((
ªt
 = 
	`£t_ˇŒ
(
comm™d_givî
, 
s
, 
n€cho_Êag
)) > 0)

1158 
s
->
fun˘
 = 
fun
;

1159 
	`INCREF
(
fun
->
ªf
);

1164 
	`‰ì_£¡í˚
(
s
);

1165  
ªt
;

1167 
	}
}

1169 
	#MAX_LINES
 50

	)

1175 
	$p°rcmp
(c⁄° *
p1
, c⁄° *
p2
)

1177  
	`°rcmp
(((c⁄° 
svÆue
 *Ë
p1
)->
u
.
°rög
,

1178 ((c⁄° 
svÆue
 *Ë
p2
)->
u
.
°rög
);

1179 
	}
}

1196 
ve˘‹
 *

1197 
	$gë_dú
(*
∑th
)

1199 
ve˘‹
 *
v
;

1200 
size_t
 
cou¡
 = 0;

1201 
i
;

1202 
DIR
 *
dúp
;

1203 
«mñí
, 
do_m©ch
 = 0;

1204 #i‡
	`deföed
(
_AIX
Ë|| deföed(
M_UNIX
Ë|| deföed(
__osf__
Ë|| deföed(
_SEQUENT_
) || \

1205 
	`deföed
(
SOLARIS
Ë|| deföed(
__NëBSD__
Ë|| deföed(
__FªeBSD__
) || \

1206 
	`deföed
(
__O≥nBSD__
)

1207 
dúít
 *
de
;

1209 
dúe˘
 *
de
;

1211 
°©
 
°
;

1212 *
ãmµ©h
;

1213 *
p
;

1214 *
ªgexp
 = 0;

1216 i‡(!
∑th
)

1219 
∑th
 = 
	`check_vÆid_∑th
’©h, 
cuºít_obje˘
, "get_dir", 0);

1221 i‡(
∑th
 == 0)

1229 
ãmµ©h
 = (*Ë
	`Æloˇ
(
	`°æí
(
∑th
) + 2);

1230 i‡(
	`°æí
(
∑th
)<2) {

1231 
ãmµ©h
[0] = 
∑th
[0] ?Öath[0] : '.';

1232 
ãmµ©h
[1] = '\000';

1233 
p
 = 
ãmµ©h
;

1235 ()
	`°r˝y
(
ãmµ©h
, 
∑th
);

1239 i‡((
p
 = 
	`°ºchr
(
ãmµ©h
, '/')) == 0)

1240 
p
 = 
ãmµ©h
;

1241 i‡((
p
[0] == '/' &&Ö[1] == '.' &&Ö[2] == '\0') ||

1242 (
p
[0] == '/' &&Ö[1] == '\0'))

1243 *
p
 = '\0';

1246 i‡(
	`°©
(
ãmµ©h
, &
°
) < 0)

1248 i‡(*
p
 == '\0')

1250 
ªgexp
 = (*)
	`Æloˇ
(
	`°æí
(
p
)+2);

1251 i‡(
p
 !
ãmµ©h
)

1253 ()
	`°r˝y
(
ªgexp
, 
p
 + 1);

1254 *
p
 = '\0';

1258 ()
	`°r˝y
(
ªgexp
, 
p
);

1259 ()
	`°r˝y
(
ãmµ©h
, ".");

1261 
do_m©ch
 = 1;

1263 i‡(*
p
 !'\0' && 
	`°rcmp
(
ãmµ©h
, "."))

1265 i‡(*
p
 == '/' && *(p + 1) != '\0')

1266 
p
++;

1267 
v
 = 
	`Æloˇã_¨øy
(1);

1268 
v
->
ôem
[0].
ty≥
 = 
T_STRING
;

1269 
v
->
ôem
[0].
°rög_ty≥
 = 
STRING_MSTRING
;

1270 
v
->
ôem
[0].
u
.
°rög
 = 
	`make_m°rög
(
p
);

1271  
v
;

1274 i‡((
dúp
 = 
	`›ídú
(
ãmµ©h
)) == 0)

1276 
	`ªwöddú
(
dúp
);

1281 
de
 = 
	`ªaddú
(
dúp
); de; de =Ñeaddir(dirp))

1283 #i‡
	`deföed
(
M_UNIX
Ë|| deföed(
_SEQUENT_
Ë|| deföed(
SOLARIS
Ë|| deföed(
löux
)

1284 
«mñí
 = 
	`°æí
(
de
->
d_«me
);

1286 
«mñí
 = 
de
->
d_«mÀn
;

1288 i‡(!
do_m©ch
 && (
	`°rcmp
(
de
->
d_«me
, ".") == 0 ||

1289 
	`°rcmp
(
de
->
d_«me
, "..") == 0))

1291 i‡(
do_m©ch
 && !
	`m©ch_°rög
(
ªgexp
, 
de
->
d_«me
))

1293 
cou¡
++;

1294 i‡–
cou¡
 >
MAX_ARRAY_SIZE
)

1300 
v
 = 
	`Æloˇã_¨øy
(()
cou¡
);

1301 i‡(
cou¡
 == 0)

1304 ()
	`˛o£dú
(
dúp
);

1305  
v
;

1307 
	`ªwöddú
(
dúp
);

1308 
i
 = 0, 
de
 = 
	`ªaddú
(
dúp
); i < 
cou¡
; de =Ñeaddir(dirp))

1310 #i‡
	`deföed
(
M_UNIX
Ë|| deföed(
_SEQUENT_
Ë|| deföed(
SOLARIS
Ë|| deföed(
löux
)

1311 
«mñí
 = 
	`°æí
(
de
->
d_«me
);

1313 
«mñí
 = 
de
->
d_«mÀn
;

1315 i‡(!
do_m©ch
 && (
	`°rcmp
(
de
->
d_«me
, ".") == 0 ||

1316 
	`°rcmp
(
de
->
d_«me
, "..") == 0))

1318 i‡(
do_m©ch
 && !
	`m©ch_°rög
(
ªgexp
, 
de
->
d_«me
))

1320 
de
->
d_«me
[
«mñí
] = '\0';

1321 
v
->
ôem
[
i
].
ty≥
 = 
T_STRING
;

1322 
v
->
ôem
[
i
].
°rög_ty≥
 = 
STRING_MSTRING
;

1323 
v
->
ôem
[
i
].
u
.
°rög
 = 
	`make_m°rög
(
de
->
d_«me
);

1324 
i
++;

1326 ()
	`˛o£dú
(
dúp
);

1328 
	`qs‹t
((*)
v
->
ôem
, 
cou¡
,  v->ôem[0], 
p°rcmp
);

1329  
v
;

1330 
	}
}

1333 
	$èû
(*
∑th
)

1335 
buff
[1000];

1336 
FILE
 *
f
;

1337 
°©
 
°
;

1338 
off_t
 
off£t
;

1340 
∑th
 = 
	`check_vÆid_∑th
’©h, 
cuºít_obje˘
, "tail", 0);

1342 i‡(
∑th
 == 0)

1344 
f
 = 
	`f›í
(
∑th
, "r");

1345 i‡(
s_Êag
)

1346 
num_fûîód
++;

1348 i‡(
f
 == 0)

1350 i‡(
	`f°©
(
	`fûío
(
f
), &
°
) == -1)

1351 
	`Áèl
("CouldÇot statán open file.\n");

1352 
off£t
 = 
°
.
°_size
 - 54 * 20;

1353 i‡(
off£t
 < 0)

1354 
off£t
 = 0;

1355 i‡(
	`f£ek
(
f
, (Ë
off£t
, 0) == -1)

1356 
	`Áèl
("CouldÇot seek.\n");

1358 i‡(
off£t
 > 0)

1359 (Ë
	`fgës
(
buff
,  buff, 
f
);

1360 
	`fgës
(
buff
,  buff, 
f
))

1361 ()
	`add_mesßge
("%s", 
buff
);

1362 ()
	`f˛o£
(
f
);

1364 
	}
}

1368 
	$ªmove_fûe
(*
∑th
)

1370 
∑th
 = 
	`check_vÆid_∑th
’©h, 
cuºít_obje˘
, "remove_file", 1);

1372 i‡(
∑th
 == 0)

1374 i‡(
	`u∆ök
(
∑th
) == -1)

1377 
	}
}

1384 
obje˘
 *

1385 
	$föd_obje˘
(*
°r
)

1387 
obje˘
 *
ob
;

1390 
°r
[0] == '/')

1391 
°r
++;

1392 
ob
 = 
	`föd_obje˘2
(
°r
);

1393 i‡(
ob
)

1394  
ob
;

1395 
ob
 = 
	`lﬂd_obje˘
(
°r
, 0, 0, 0);

1396 i‡(!
ob
 || (ob->
Êags
 & 
O_DESTRUCTED
))

1398  
ob
;

1399 
	}
}

1402 
obje˘
 *
	$föd_obje˘_no_¸óã
(
°r
)

1403 *
°r
;

1405 
obje˘
 *
ob
;

1408 
°r
[0] == '/')

1409 
°r
++;

1410 
ob
 = 
	`föd_obje˘2
(
°r
);

1411 i‡(
ob
)

1412  
ob
;

1413 
ob
 = 
	`lﬂd_obje˘
(
°r
, 1, 0, 0);

1414 i‡(!
ob
 || (ob->
Êags
 & 
O_DESTRUCTED
))

1416  
ob
;

1417 
	}
}

1420 
obje˘
 *

1421 
	$föd_obje˘2
(*
°r
)

1423 
obje˘
 *
ob
;

1424 
Àn
, 
Àn2
;

1427 
°r
[0] == '/')

1428 
°r
++;

1430 
Àn
 = 
Àn2
 = 
	`°æí
(
°r
);

1431 
°r
[
Àn2
-2] == '.' && str[len2-1] == 'c')

1432 
Àn2
 -= 2;

1433 i‡(
Àn
 !
Àn2
) {

1435 *
p
 = 
	`Æloˇ
(
Àn2
 + 2);

1437 ()
	`°∫˝y
(
p
, 
°r
, 
Àn2
);

1438 
°r
 = 
p
;

1439 
°r
[
Àn2
] = '\0';

1441 i‡–(
ob
 = 
	`lookup_obje˘_hash
(
°r
)Ë!
NULL
 ) {

1442  
ob
;

1445 
	}
}

1450 
	$≠∂y_comm™d
(*
com
)

1452 
vÆue
 *
ªt
;

1454 i‡(
comm™d_givî
 == 0) {

1455 
	`îr‹
("command_giver == 0 !\n");

1458 
ªt
 = 
	`≠∂y
(
com
, 
comm™d_givî
->
su≥r
, 0, 1);

1459 i‡(
ªt
 != 0)

1461 ()
	`add_mesßge
("Result:");

1462 i‡(
ªt
->
ty≥
 =
T_STRING
)

1463 ()
	`add_mesßge
("%s\n", 
ªt
->
u
.
°rög
);

1464 i‡(
ªt
->
ty≥
 =
T_NUMBER
)

1465 ()
	`add_mesßge
("%d\n", 
ªt
->
u
.
numbî
);

1468 ()
	`add_mesßge
("Eº‹áµly_comm™d: fun˘i⁄ %†nŸ found.\n", 
com
);

1469 
	}
}

1485 
	$upd©e_a˘i⁄s
(
obje˘
 *
aob
)

1487 
obje˘
 *
µ
, *
ob
, *
√xt_ob
;

1488 
obje˘
 *
ßve_cmd
 = 
comm™d_givî
, *
ôem
 = 
aob
;

1489 
svÆue
 *
ªt
;

1495 i‡(
ôem
->
su≥r
)

1497 i‡(
ôem
->
su≥r
->
Êags
 & 
O_ENABLE_COMMANDS
)

1498 
	`ªmove_£¡
(
ôem
, iãm->
su≥r
);

1500 
µ
 = 
ôem
->
su≥r
->
c⁄èös
;Öp;)

1502 i‡(
µ
 !
ôem
 && (µ->
Êags
 & 
O_ENABLE_COMMANDS
))

1503 
	`ªmove_£¡
(
ôem
, 
µ
);

1504 
µ
 = 
ôem
->
√xt_öv
;

1511 
µ
 = 
ôem
->
c⁄èös
;Öp;)

1513 i‡(
µ
->
Êags
 & 
O_ENABLE_COMMANDS
)

1514 
	`ªmove_£¡
(
ôem
, 
µ
);

1515 
µ
 = 
ôem
->
√xt_öv
;

1526 
ob
 = 
ôem
->
su≥r
;

1532 i‡(
ôem
->
su≥r
)

1534 i‡(
ôem
->
su≥r
->
Êags
 & 
O_ENABLE_COMMANDS
)

1536 
comm™d_givî
 = 
ôem
->
su≥r
;

1537 #ifde‡
USE_ENCOUNTER_NOT_INIT


1538 
	`push_obje˘
(
ôem
);

1539 
ªt
 = 
	`≠∂y
("ícou¡î", 
ôem
->
su≥r
, 1, 1);

1540 i‡(!
ªt
)

1541 ()
	`≠∂y
("öô", 
ôem
, 0, 1);

1543 ()
	`≠∂y
("öô", 
ôem
, 0, 1);

1545 i‡(
ob
 !
ôem
->
su≥r
 ||

1546 (
ôem
->
Êags
 & 
O_DESTRUCTED
) ||

1547 (
ob
->
Êags
 & 
O_DESTRUCTED
))

1549 
comm™d_givî
 = 
ßve_cmd
;

1554 
µ
 = 
ôem
->
su≥r
->
c⁄èös
;Öp;)

1556 
√xt_ob
 = 
µ
->
√xt_öv
;

1557 i‡(
µ
 !
ôem
 && (µ->
Êags
 & 
O_ENABLE_COMMANDS
))

1559 
comm™d_givî
 = 
µ
;

1560 #ifde‡
USE_ENCOUNTER_NOT_INIT


1561 
	`push_obje˘
(
ôem
);

1562 
ªt
 = 
	`≠∂y
("ícou¡î", 
µ
, 1, 1);

1563 i‡(!
ªt
)

1564 ()
	`≠∂y
("öô", 
ôem
, 0, 1);

1566 ()
	`≠∂y
("öô", 
ôem
, 0, 1);

1568 i‡(
ob
 !
ôem
->
su≥r
 ||

1569 (
ôem
->
Êags
 & 
O_DESTRUCTED
) ||

1570 (
ob
->
Êags
 & 
O_DESTRUCTED
) ||

1571 (
√xt_ob
->
Êags
 & 
O_DESTRUCTED
))

1573 
comm™d_givî
 = 
ßve_cmd
;

1577 
µ
 = 
√xt_ob
;

1584 
µ
 = 
ôem
->
c⁄èös
;Öp;)

1586 
√xt_ob
 = 
µ
->
√xt_öv
;

1587 i‡(
µ
->
Êags
 & 
O_ENABLE_COMMANDS
)

1589 
comm™d_givî
 = 
µ
;

1590 #ifde‡
USE_ENCOUNTER_NOT_INIT


1591 
	`push_obje˘
(
ôem
);

1592 
ªt
 = 
	`≠∂y
("ícou¡î", 
µ
, 1, 1);

1593 i‡(!
ªt
)

1594 ()
	`≠∂y
("öô", 
ôem
, 0, 1);

1596 ()
	`≠∂y
("öô", 
ôem
, 0, 1);

1598 i‡(
ob
 !
ôem
->
su≥r
 ||

1599 (
ôem
->
Êags
 & 
O_DESTRUCTED
) ||

1600 (
ob
->
Êags
 & 
O_DESTRUCTED
) ||

1601 (
√xt_ob
->
Êags
 & 
O_DESTRUCTED
))

1604 
comm™d_givî
 = 
ßve_cmd
;

1608 
µ
 = 
√xt_ob
;

1610 
	}
}

1620 
	$move_obje˘
(
obje˘
 *
de°
)

1622 
obje˘
 **
µ
, *
ob
, *
√xt_ob
;

1623 
obje˘
 *
ßve_cmd
 = 
comm™d_givî
, *
ôem
 = 
cuºít_obje˘
;

1624 
svÆue
 *
ªt
;

1626 i‡(
ôem
->
Êags
 & 
O_DESTRUCTED
)

1629 
ob
 = 
de°
; ob; ob = ob->
su≥r
)

1630 i‡(
ob
 =
ôem
) {

1631 
	`îr‹
("Can't move object inside itself.\n");

1634 i‡(
ôem
->
shadowög
) {

1635 
	`îr‹
("Can't moveán objectÅhat is shadowing.\n");

1643 i‡(
s_Êag
)

1644 
num_move
++;

1646 i‡(
ôem
->
su≥r
)

1648 
okey
 = 0;

1650 i‡(
ôem
->
Êags
 & 
O_ENABLE_COMMANDS
)

1651 
	`ªmove_£¡
(
ôem
->
su≥r
, item);

1653 i‡(
ôem
->
su≥r
->
Êags
 & 
O_ENABLE_COMMANDS
)

1654 
	`ªmove_£¡
(
ôem
, iãm->
su≥r
);

1656 
µ
 = &
ôem
->
su≥r
->
c⁄èös
; *pp;)

1658 i‡(*
µ
 !
ôem
)

1660 i‡((*
µ
)->
Êags
 & 
O_ENABLE_COMMANDS
)

1661 
	`ªmove_£¡
(
ôem
, *
µ
);

1662 i‡(
ôem
->
Êags
 & 
O_ENABLE_COMMANDS
)

1663 
	`ªmove_£¡
(*
µ
, 
ôem
);

1664 
µ
 = &(*µ)->
√xt_öv
;

1667 *
µ
 = 
ôem
->
√xt_öv
;

1668 
okey
 = 1;

1670 i‡(!
okey
)

1672 
	`Áèl
("FailedÅo find object %s in superÜist of %s.\n",

1673 
ôem
->
«me
, iãm->
su≥r
->name);

1675 
	`Áèl
("FailedÅo find object in superÜist\n");

1678 
ôem
->
√xt_öv
 = 
de°
->
c⁄èös
;

1679 
de°
->
c⁄èös
 = 
ôem
;

1680 
ôem
->
su≥r
 = 
de°
;

1689 i‡(
ôem
->
Êags
 & 
O_ENABLE_COMMANDS
)

1691 
comm™d_givî
 = 
ôem
;

1692 #ifde‡
USE_ENCOUNTER_NOT_INIT


1693 
	`push_obje˘
(
de°
);

1694 
ªt
 = 
	`≠∂y
("ícou¡î", 
ôem
, 1, 1);

1695 i‡(!
ªt
)

1696 ()
	`≠∂y
("öô", 
de°
, 0, 1);

1698 ()
	`≠∂y
("öô", 
de°
, 0, 1);

1700 i‡((
de°
->
Êags
 & 
O_DESTRUCTED
Ë|| 
ôem
->
su≥r
 != dest)

1702 
comm™d_givî
 = 
ßve_cmd
;

1710 
ob
 = 
de°
->
c⁄èös
; ob; ob=
√xt_ob
)

1712 
√xt_ob
 = 
ob
->
√xt_öv
;

1713 i‡(
ob
 =
ôem
)

1715 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
) {

1716 
	`îr‹
("An object was destructedát call of init()\n");

1719 i‡(
ob
->
Êags
 & 
O_ENABLE_COMMANDS
)

1721 
comm™d_givî
 = 
ob
;

1722 #ifde‡
USE_ENCOUNTER_NOT_INIT


1723 
	`push_obje˘
(
ôem
);

1724 
ªt
 = 
	`≠∂y
("ícou¡î", 
ob
, 1, 1);

1725 i‡(!
ªt
)

1726 ()
	`≠∂y
("öô", 
ôem
, 0, 1);

1728 ()
	`≠∂y
("öô", 
ôem
, 0, 1);

1730 i‡(
de°
 !
ôem
->
su≥r
)

1732 
comm™d_givî
 = 
ßve_cmd
;

1736 i‡(
ôem
->
Êags
 & 
O_DESTRUCTED
) {

1737 
	`îr‹
("The objectÅo be moved was destructedát call of init()\n");

1740 i‡(
ôem
->
Êags
 & 
O_ENABLE_COMMANDS
)

1742 
comm™d_givî
 = 
ôem
;

1743 #ifde‡
USE_ENCOUNTER_NOT_INIT


1744 
	`push_obje˘
(
ob
);

1745 
ªt
 = 
	`≠∂y
("ícou¡î", 
ôem
, 1, 1);

1746 i‡(!
ªt
)

1747 ()
	`≠∂y
("öô", 
ob
, 0, 1);

1749 (Ë
	`≠∂y
("öô", 
ob
, 0, 1);

1751 i‡(
de°
 !
ôem
->
su≥r
)

1753 
comm™d_givî
 = 
ßve_cmd
;

1758 i‡(
de°
->
Êags
 & 
O_DESTRUCTED
) {

1759 
	`îr‹
("The destinationÅo moveÅo was destructedát call of init()\n");

1762 i‡(
de°
->
Êags
 & 
O_ENABLE_COMMANDS
)

1764 
comm™d_givî
 = 
de°
;

1765 #ifde‡
USE_ENCOUNTER_NOT_INIT


1766 
	`push_obje˘
(
ôem
);

1767 
ªt
 = 
	`≠∂y
("ícou¡î", 
de°
, 1, 1);

1768 i‡(!
ªt
)

1769 ()
	`≠∂y
("öô", 
ôem
, 0, 1);

1771 ()
	`≠∂y
("öô", 
ôem
, 0, 1);

1774 
comm™d_givî
 = 
ßve_cmd
;

1775 
	}
}

1777 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


1778 
£¡í˚
 *
	g£¡_‰ì
 = 
NULL
;

1780 
	gtŸ_Æloc_£¡í˚
;

1781 
	gtŸ_cuºít_Æloc_£¡í˚
;

1783 
£¡í˚
 *

1784 
	$Æloc_£¡í˚
()

1786 
£¡í˚
 *
p
;

1788 
p
 = (
£¡í˚
 *Ë
	`xÆloc
( *p);

1789 
tŸ_Æloc_£¡í˚
++;

1790 
tŸ_cuºít_Æloc_£¡í˚
++;

1791 
p
->
vîb
 = 
NULL
;

1792 
p
->
fun˘
 = 
NULL
;

1793 
p
->
√xt
 = 
NULL
;

1794 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


1795 
p
->
¥ev_Æl
 = 
NULL
;

1796 
p
->
√xt_Æl
 = 
£¡_‰ì
;

1797 i‡(
£¡_‰ì
 !
NULL
)

1798 
£¡_‰ì
->
¥ev_Æl
 = 
p
;

1799 
£¡_‰ì
 = 
p
;

1802  
p
;

1803 
	}
}

1805 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


1807 
	$‰ì_Æl_£¡
()

1809 
£¡í˚
 *
p
;

1811 ; 
£¡_‰ì
 ; sít_‰ì = 
p
) {

1812 
p
 = 
£¡_‰ì
->
√xt_Æl
;

1813 
	`‰ì
(
£¡_‰ì
);

1814 
tŸ_cuºít_Æloc_£¡í˚
--;

1815 
tŸ_Æloc_£¡í˚
--;

1817 
	}
}

1821 
	$‰ì_£¡í˚
(
£¡í˚
 *
p
)

1823 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


1824 i‡(
p
->
¥ev_Æl
)

1825 
p
->
¥ev_Æl
->
√xt_Æl
 =Ö->next_all;

1826 i‡(
p
->
√xt_Æl
)

1827 
p
->
√xt_Æl
->
¥ev_Æl
 =Ö->prev_all;

1828 i‡(
p
 =
£¡_‰ì
)

1829 
£¡_‰ì
 = 
p
->
√xt_Æl
;

1831 i‡(
p
->
fun˘
)

1832 
	`‰ì_˛osuª
(
p
->
fun˘
);

1833 
p
->
fun˘
 = 
NULL
;

1834 i‡(
p
->
vîb
)

1835 
	`‰ì_s°rög
(
p
->
vîb
);

1836 
p
->
vîb
 = 
NULL
;

1837 
	`‰ì
((*)
p
);

1838 
tŸ_cuºít_Æloc_£¡í˚
--;

1839 
tŸ_Æloc_£¡í˚
--;

1840 
	}
}

1847 
	$∂ayî_∑r£r
(*
buff
)

1849 
£¡í˚
 *
s
;

1850 
size_t
 
Àngth
;

1851 *
p
;

1852 
obje˘
 *
ßve_cuºít_obje˘
 = 
cuºít_obje˘
;

1853 
vîb_c›y
[100], *
sub°_buff
 = 
NULL
;

1854 
svÆue
 *
ªt
;

1855 
obje˘
 *
cmd_givî
 = 
comm™d_givî
;

1856 
obje˘
 *
theobj
;

1858 #ifde‡
DEBUG


1859 i‡(
d_Êag
 & 
DEBUG_COMMAND
)

1860 
	`debug_mesßge
("cmd [%s]: %s\n", 
cmd_givî
->
«me
, 
buff
);

1865 
p
 = 
buff
 + 
	`°æí
(buff) - 1;Ö >= buff;Ö--)

1867 i‡(*
p
 != ' ')

1869 *
p
 = '\0';

1874 *
buff
 == ' ')

1875 
buff
++;

1877 i‡(
buff
[0] == '\0')

1883 
	`push_°rög
(
buff
, 
STRING_MSTRING
);

1884 
	`push_obje˘
(
cmd_givî
);

1885 
ªt
 = 
	`≠∂y_ma°î_ob
(
M_MODIFY_COMMAND
, 2);

1887 i‡(
ªt
 &&Ñë->
ty≥
 =
T_STRING
)

1888 
sub°_buff
 = 
	`°rög_c›y
(
ªt
->
u
.
°rög
);

1889 i‡(
ªt
 =
NULL
)

1890 
sub°_buff
 = 
	`°rög_c›y
(
buff
);

1892 i‡(
sub°_buff
 =
NULL
)

1895 
p
 = 
	`°Ωbrk
(
sub°_buff
, " \t\v\f\r\n");

1896 i‡(
p
 == 0)

1897 
Àngth
 = 
	`°æí
(
sub°_buff
);

1899 
Àngth
 = 
p
 - 
sub°_buff
;

1900 i‡(!*
sub°_buff
 ||

1901 !
cmd_givî
 || (cmd_givî->
Êags
 & 
O_DESTRUCTED
))

1904 
	`˛ór_nŸify
();

1905 
s
 = 
cmd_givî
->
£¡
; s; s = s->
√xt
)

1907 
size_t
 
Àn
, 
c›y_Àn
;

1909 i‡(
s
->
vîb
 == 0) {

1910 
	`îr‹
("An 'action' did something, butÑeturned 0 or hadán undefined verb.\n");

1913 
Àn
 = 
	`°æí
(
s
->
vîb
);

1914 i‡(
s
->
sh‹t_vîb
)

1916 i‡(
Àn
 && 
	`°∫cmp
(
s
->
vîb
, 
sub°_buff
,Üen) != 0)

1918 i‡(
s
->
sh‹t_vîb
 =
V_NO_SPACE
)

1919 
Àngth
 = 
Àn
;

1921 #i‚de‡
COMPAT_ADD_ACTIONS


1922 i‡(
Àn
 && 
Àngth
 >Üen)

1925 
Àn
 = 
Àngth
;

1930 i‡(
Àn
 !
Àngth
)

1932 i‡(
	`°∫cmp
(
sub°_buff
, 
s
->
vîb
, 
Àngth
))

1938 #ifde‡
DEBUG


1939 i‡(
d_Êag
 & 
DEBUG_COMMAND
)

1940 
	`debug_mesßge
("Loˇ»comm™d %s\n", 
	`gë˛osuª«me
(
s
->
fun˘
));

1942 i‡(
Àngth
 > 
vîb_c›y
)

1943 
c›y_Àn
 =  
vîb_c›y
 - 1;

1945 
c›y_Àn
 = 
Àngth
;

1946 ()
	`°∫˝y
(
vîb_c›y
, 
sub°_buff
, 
c›y_Àn
);

1947 
vîb_c›y
[
c›y_Àn
] = '\0';

1948 
œ°_vîb
 = 
vîb_c›y
;

1949 
åig_vîb
 = 
s
->
vîb
;

1951 
theobj
 = 
s
->
fun˘
->
funobj
;

1959 i‡(
cuºít_obje˘
 == 0)

1960 
cuºít_obje˘
 = 
theobj
;

1964 
comm™d_givî
 = 
cmd_givî
;

1966 
p
 = 
sub°_buff
 + (
s
->
sh‹t_vîb
 =
V_NO_SPACE
 ? 
Àn
 : 
Àngth
);

1967 *
p
 !'\0' && 
	`is•a˚
(*p))

1968 
p
++;

1969 #ifde‡
DEBUG


1970 i‡(
d_Êag
 & 
DEBUG_COMMAND
)

1971 
	`debug_mesßge
("Vîb i†%†[%s],árg†\"%s\"\n", 
œ°_vîb
, 
åig_vîb
, 
p
 ?Ö : "[none]");

1973 i‡(*
p
 != '\0') {

1974 
	`push_°rög
(
p
, 
STRING_MSTRING
);

1975 ()
	`ˇŒ_v¨
(1, 
s
->
fun˘
);

1979 ()
	`ˇŒ_v¨
(0, 
s
->
fun˘
);

1981 i‡(
cmd_givî
 == 0) {

1982 
	`p›_°ack
();

1983 i‡(
sub°_buff
)

1984 
	`‰ì
(
sub°_buff
);

1988 
cuºít_obje˘
 = 
ßve_cuºít_obje˘
;

1989 
œ°_vîb
 = 0;

1990 
åig_vîb
 = 0;

1992 i‡(
•
->
ty≥
 =
T_NUMBER
 && sp->
u
.
numbî
 == 0) {

1995 
£¡í˚
 *
s0
;

1997 
	`p›_°ack
();

1999 
s0
 = 
cmd_givî
->
£¡
; s0 && s0 !
s
; s0 = s0->
√xt
)

2002 i‡(!
s0
) {

2003 
s
 = 0;

2008 
	`p›_°ack
();

2011 i‡(
sub°_buff
)

2012 
	`‰ì
(
sub°_buff
);

2013 i‡(
s
 == 0)

2015 
	`nŸify_no_comm™d
();

2019 
	}
}

2035 
	$add_a˘i⁄
(
˛osuª
 *
func
, 
svÆue
 *
cmd
, 
Êag
)

2037 
£¡í˚
 *
p
;

2038 
obje˘
 *
ob
;

2040 i‡(
cuºít_obje˘
->
Êags
 & 
O_DESTRUCTED
)

2042 
ob
 = 
cuºít_obje˘
;

2043 i‡(
comm™d_givî
 =0 || (comm™d_givî->
Êags
 & 
O_DESTRUCTED
))

2045 i‡(
ob
 !
comm™d_givî
 && ob->
su≥r
 != command_giver &&

2046 
ob
->
su≥r
 !
comm™d_givî
->super && ob != command_giver->super) {

2047 
	`îr‹
("add_action from objectÅhat wasÇotÖresent.\n");

2050 i‡(!
	`ÀgÆ_˛osuª
(
func
))

2052 
	`îr‹
("add_actionÅo function in destructed object.\n");

2055 #ifde‡
DEBUG


2056 i‡(
d_Êag
 & 
DEBUG_ADD_ACTION
)

2057 
	`debug_mesßge
("--Addá˘i⁄ %s\n", 
	`gë˛osuª«me
(
func
));

2062 
p
 = 
	`Æloc_£¡í˚
();

2063 
p
->
fun˘
 = 
func
;

2064 
	`INCREF
(
func
->
ªf
);

2065 
p
->
√xt
 = 
comm™d_givî
->
£¡
;

2066 
p
->
sh‹t_vîb
 = 
Êag
;

2067 i‡(
cmd
)

2068 
p
->
vîb
 = 
	`make_s°rög
(
cmd
->
u
.
°rög
);

2070 
p
->
vîb
 = 0;

2071 
comm™d_givî
->
£¡
 = 
p
;

2072 
	}
}

2079 
	$ªmove_£¡
(
obje˘
 *
ob
, obje˘ *
∂ayî
)

2081 
£¡í˚
 **
s
;

2083 
s
&
∂ayî
->
£¡
; *s;)

2085 
£¡í˚
 *
tmp
;

2086 i‡((*
s
)->
fun˘
->
funobj
 =
ob
) {

2087 i‡(
d_Êag
 & 
DEBUG_SENTENCE
)

2088 
	`debug_mesßge
("--U∆ökög síãn˚ %s\n", 
	`gë˛osuª«me
((*
s
)->
fun˘
));

2089 
tmp
 = *
s
;

2090 *
s
 = 
tmp
->
√xt
;

2091 
	`‰ì_£¡í˚
(
tmp
);

2093 
s
 = &((*s)->
√xt
);

2096 
	}
}

2099 
	gdeböf
[8192];

2100 #ifde‡
USE_SWAP


2101 
	gsw≠_out_obj_£c
, 
	gsw≠_out_obj_mö
, 
	gsw≠_out_obj_hour
;

2102 
	gsw≠_out_¥og_£c
, 
	gsw≠_out_¥og_mö
, 
	gsw≠_out_¥og_hour
;

2103 
	gsw≠_ö_obj_£c
, 
	gsw≠_ö_obj_mö
, 
	gsw≠_ö_obj_hour
;

2104 
	gsw≠_ö_¥og_£c
, 
	gsw≠_ö_¥og_mö
, 
	gsw≠_ö_¥og_hour
;

2108 
	$gë_gamedrivî_öfo
(*
°r
)

2110 
tmp
[1024];

2111 
¥oc
;

2112 
tŸ
;

2113 
ªs
, 
vîbo£
 = 0;

2114 *
ª£rved_¨ó
;

2115 
tŸ_Æloc_obje˘
, 
tŸ_Æloc_obje˘_size
,

2116 
num_¨øys
, 
tŸÆ_¨øy_size
, 
num_m≠pögs
,

2117 
tŸÆ_m≠pög_size
;

2118 
tŸÆ_num_¥og_blocks
, 
tŸÆ_¥og_block_size
;

2119 
num_di°ö˘_°rögs_sh¨ed
, 
num_di°ö˘_°rögs_mÆlo˚d
;

2120 
byãs_di°ö˘_°rögs_sh¨ed
, 
byãs_di°ö˘_°rögs_mÆlo˚d
;

2121 
ovîhód_byãs_sh¨ed
, 
ovîhód_byãs_mÆlo˚d
;

2122 
num_ˇŒ
, 
ˇŒ_out_size
;

2123 
globˇche_åõs
, 
globˇche_hôs
, 
funm≠_åõs
;

2124 
ve˘‹
 
nuŒ_ve˘‹
;

2125 
ˇche_åõs
, 
ˇche_hôs
;

2126 
tŸÆ_¥ogøm_size
;

2127 
tŸ_Æloc_v¨übÀ_size
;

2128 
num_˛osuªs
, 
tŸÆ_˛osuª_size
;

2130 #ifde‡
USE_SWAP


2131 
num_sw≠≥d_¨øys
, 
size_sw≠≥d_¨øys
;

2132 
num_sw≠≥d_˛osuªs
, 
size_sw≠≥d_˛osuªs
;

2133 
num_sw≠≥d_m≠pögs
, 
size_sw≠≥d_m≠pögs
;

2134 
num_°rögs_sw≠≥d
, 
size_°rögs_sw≠≥d
;

2135 
obj_sw≠≥d
, 
obj_byãs_sw≠≥d
;

2136 
¥ogøm_byãs_sw≠≥d
;

2137 
¥ogøms_sw≠≥d
;

2138 
u_öt
 
sw≠_cursize
, 
sw≠_mö‰ì
, 
sw≠_max‰ì
;

2139 
tŸÆ_byãs_sw≠≥d
;

2140 
tŸÆ_sw≠_chaös
;

2141 
tŸÆ_‰ì_blocks
;

2142 
œ°_addªss
;

2143 
u£d_mem‹y
;

2144 
¥ogøm
 *
sw≠_¥og
;

2145 
obje˘
 *
sw≠_ob
;

2146 #ifde‡
DO_CLEANUP


2147 
tŸÆ_˛ón_ups
;

2148 
˛ón_up_ªtu∫0
;

2149 
˛ón_up_ªtu∫1
;

2150 
˛ón_up_de°ru˘
;

2154 #ifde‡
COMM_STAT


2155 
add_mesßge_ˇŒs
,
öë_∑ckës
,
öë_vﬁume
;

2157 ()
	`°r˝y
(
deböf
,"");

2159 i‡(
	`°rcmp
(
°r
, "status") == 0 || strcmp(str, "statusÅables") == 0)

2162 #ifde‡
COMM_STAT


2163 
add_mesßge_ˇŒs
,
öë_∑ckës
,
öë_vﬁume
;

2166 i‡(
	`°rcmp
(
°r
, "statusÅables") == 0)

2167 
vîbo£
 = 1;

2168 i‡(
ª£rved_¨ó
)

2169 
ªs
 = 
RESERVED_SIZE
;

2171 
ªs
 = 0;

2172 #ifde‡
COMM_STAT


2174 i‡(
vîbo£
)

2176 ()
	`•rötf
(
tmp
,"CÆl†tÿadd_mesßge: %d Packës: %d Avîagê∑ckë size: %f\n\n",
add_mesßge_ˇŒs
,
öë_∑ckës
,()
öë_vﬁume
/inet_packets);

2177 ()
	`°rˇt
(
deböf
, 
tmp
);

2180 i‡(!
vîbo£
)

2182 ()
	`•rötf
(
tmp
,"Síãn˚s:\t\t\t%8d %8d\n", 
tŸ_Æloc_£¡í˚
,

2183 
tŸ_Æloc_£¡í˚
 * (Ë (
£¡í˚
));

2184 ()
	`°rˇt
(
deböf
, 
tmp
);

2186 ()
	`•rötf
(
tmp
,"Objects:\t\t\t%8d %8d (%d dest, %dÑmd)\n",

2187 
tŸ_Æloc_obje˘
, 
tŸ_Æloc_obje˘_size
,

2188 
tŸ_Æloc_de°_obje˘
, 
tŸ_ªmoved_obje˘
);

2189 ()
	`°rˇt
(
deböf
, 
tmp
);

2191 #ifde‡
USE_SWAP


2192 ()
	`•rötf
(
tmp
,"Variables:\t\t\t\t %8d (%d swapped, %d Kbytes)\n",

2193 
tŸ_Æloc_v¨übÀ_size
,

2194 
obj_sw≠≥d
, ()
obj_byãs_sw≠≥d
 / 1024);

2196 ()
	`•rötf
(
tmp
,"Variables:\t\t\t\t %8d\n",

2197 
tŸ_Æloc_v¨übÀ_size
);

2199 ()
	`°rˇt
(
deböf
, 
tmp
);

2201 #ifde‡
USE_SWAP


2202 ()
	`•rötf
(
tmp
,"Arrays:\t\t\t\t%8d %8d (%d swapped, %d Kbytes)\n",

2203 
num_¨øys
, 
tŸÆ_¨øy_size
,

2204 
num_sw≠≥d_¨øys
, 
size_sw≠≥d_¨øys
 / 1024);

2206 ()
	`•rötf
(
tmp
,"Arrays:\t\t\t\t%8d %8d\n",

2207 
num_¨øys
, 
tŸÆ_¨øy_size
);

2209 ()
	`°rˇt
(
deböf
, 
tmp
);

2211 ()
	`•rötf
(
tmp
,"CÆl_outs:\t\t\t%8d %8d\n", 
num_ˇŒ
,

2212 
ˇŒ_out_size
);

2213 ()
	`°rˇt
(
deböf
, 
tmp
);

2215 #ifde‡
USE_SWAP


2216 ()
	`•rötf
(
tmp
,"Mappings:\t\t\t%8d %8d (%d swapped, %d Kbytes)\n",

2217 
num_m≠pögs
, 
tŸÆ_m≠pög_size
,

2218 
num_sw≠≥d_m≠pögs
, 
size_sw≠≥d_m≠pögs
 / 1024);

2220 ()
	`•rötf
(
tmp
,"Mappings:\t\t\t%8d %8d\n",

2221 
num_m≠pögs
, 
tŸÆ_m≠pög_size
);

2223 ()
	`°rˇt
(
deböf
, 
tmp
);

2225 #ifde‡
USE_SWAP


2226 ()
	`•rötf
(
tmp
,"Functions:\t\t\t%8d %8d (%d swapped, %d Kbytes)\n",

2227 
num_˛osuªs
, 
tŸÆ_˛osuª_size
,

2228 
num_sw≠≥d_˛osuªs
, 
size_sw≠≥d_˛osuªs
 / 1024);

2230 ()
	`•rötf
(
tmp
,"Functions:\t\t\t%8d %8d\n",

2231 
num_˛osuªs
, 
tŸÆ_˛osuª_size
);

2233 ()
	`°rˇt
(
deböf
, 
tmp
);

2235 ()
	`•rötf
(
tmp
,"Strings:\t\t\t%8d %8ld (%ld overhead)\n",

2236 
num_di°ö˘_°rögs_sh¨ed
 + 
num_di°ö˘_°rögs_mÆlo˚d
,

2237 
byãs_di°ö˘_°rögs_sh¨ed
 + 
byãs_di°ö˘_°rögs_mÆlo˚d
,

2238 
ovîhód_byãs_sh¨ed
 + 
ovîhód_byãs_mÆlo˚d
);

2239 ()
	`°rˇt
(
deböf
, 
tmp
);

2240 #ifde‡
USE_SWAP


2241 ()
	`•rötf
(
tmp
,"\t\t\t\t\t\t (%d swapped, %u Kbytes)\n",

2242 
num_°rögs_sw≠≥d
, ()
size_°rögs_sw≠≥d
 >> 10);

2243 ()
	`°rˇt
(
deböf
, 
tmp
);

2246 ()
	`•rötf
(
tmp
,"Prog blocks:\t\t\t%8d %8d\n",

2247 
tŸÆ_num_¥og_blocks
, 
tŸÆ_¥og_block_size
);

2248 ()
	`°rˇt
(
deböf
, 
tmp
);

2250 #ifde‡
USE_SWAP


2251 ()
	`•rötf
(
tmp
,"Programs:\t\t\t\t %8d (%d swapped, %d Kbytes)\n",

2252 
tŸÆ_¥ogøm_size
, 
¥ogøms_sw≠≥d
, 
¥ogøm_byãs_sw≠≥d
 / 1024);

2254 ()
	`•rötf
(
tmp
,"Progøms:\t\t\t\à%8d\n", 
tŸÆ_¥ogøm_size
);

2256 ()
	`°rˇt
(
deböf
, 
tmp
);

2258 ()
	`•rötf
(
tmp
,"Mem‹yÑe£rved:\t\t\à%8d\n", 
ªs
);

2259 ()
	`°rˇt
(
deböf
, 
tmp
);

2262 i‡(
vîbo£
)

2264 #ifde‡
CACHE_STATS


2265 
ˇŒ_ˇche_ßves
;

2266 
globÆ_ˇche_ßves
;

2267 
£¨ches_√eded
;

2268 
£¨ches_d⁄e
;

2269 
globÆ_fú°_ßves
;

2270 
ˇŒ_fú°_ßves
;

2273 i‡(
globˇche_åõs
 < 1)

2274 
globˇche_åõs
 = 1;

2275 i‡(
funm≠_åõs
 < 1)

2276 
funm≠_åõs
 = 1;

2277 ()
	`°rˇt
(
deböf
, 
	`°©_livög_obje˘s
());

2278 ()
	`°rˇt
(
deböf
, "\nFunction calls:\n--------------------------\n");

2279 
¥oc
 = 100.0 * ((
ˇche_hôs
 * 1.0Ë/ 
ˇche_åõs
);

2280 ()
	`•rötf
(
tmp
,"Call cache, Tries: %10d Hits: %10d Miss: %10d Rate: %3.1f%%\n",

2281 
ˇche_åõs
, 
ˇche_hôs
,

2282 
ˇche_åõs
 - 
ˇche_hôs
, 
¥oc
);

2283 ()
	`°rˇt
(
deböf
, 
tmp
);

2284 #ifde‡
CACHE_STATS


2285 ()
	`•rötf
(
tmp
, "searches saved %10d %3d%%\n",

2286 
ˇŒ_fú°_ßves
,

2287 ()(100.0 * ((
ˇŒ_fú°_ßves
 * 1.0) /

2288 (
£¨ches_√eded
 +

2289 
globÆ_fú°_ßves


2290 + 
ˇŒ_fú°_ßves
))));

2291 ()
	`°rˇt
(
deböf
, 
tmp
);

2294 #ifde‡
GLOBAL_CACHE


2295 
¥oc
 = 100.0 * ((
globˇche_hôs
 * 1.0Ë/ 
globˇche_åõs
);

2296 ()
	`•rötf
(
tmp
,"Global cache, Tries: %10d Hits: %10d Miss: %10d Rate: %3.1f%%\n",

2297 
globˇche_åõs
, 
globˇche_hôs
,

2298 
globˇche_åõs
 -
globˇche_hôs
, 
¥oc
);

2299 ()
	`°rˇt
(
deböf
, 
tmp
);

2300 #ifde‡
CACHE_STATS


2301 ()
	`•rötf
(
tmp
, "searches saved %10d %3d%%\n",

2302 
globÆ_fú°_ßves
,

2303 ()(100.0 * ((
globÆ_fú°_ßves
 * 1.0) /

2304 (
£¨ches_√eded
 +

2305 
globÆ_fú°_ßves


2306 + 
ˇŒ_fú°_ßves
))));

2307 ()
	`°rˇt
(
deböf
, 
tmp
);

2311 #ifde‡
CACHE_STATS


2312 ()
	`°rˇt
(
deböf
, "Secondary hits:\n");

2313 ()
	`•rötf
(
tmp
,"£¨che†√eded : %10d\n", 
£¨ches_√eded
);

2314 ()
	`°rˇt
(
deböf
, 
tmp
);

2315 ()
	`•rötf
(
tmp
,"call cache saves : %10d %3d%%\n",

2316 
ˇŒ_ˇche_ßves
, ()(100.0 * ((call_cache_saves * 1.0) /

2317 
£¨ches_√eded
)));

2318 ()
	`°rˇt
(
deböf
, 
tmp
);

2319 ()
	`•rötf
(
tmp
,"global cache saves : %10d %3d%%\n",

2320 
globÆ_ˇche_ßves
,

2321 ()(100.0 * ((
globÆ_ˇche_ßves
 * 1.0) /

2322 
£¨ches_√eded
)));

2323 ()
	`°rˇt
(
deböf
, 
tmp
);

2324 ()
	`•rötf
(
tmp
,"£¨che†d⁄ê : %10d\n", 
£¨ches_d⁄e
);

2325 ()
	`°rˇt
(
deböf
, 
tmp
);

2326 ()
	`•rötf
(
tmp
,"TotalÇeeded : %10d %3d%% done\n",

2327 
£¨ches_√eded
 + 
globÆ_fú°_ßves
 + 
ˇŒ_fú°_ßves
,

2328 ()(100.0 * ((
£¨ches_d⁄e
 * 1.0) /

2329 (
£¨ches_√eded
 +

2330 
globÆ_fú°_ßves


2331 + 
ˇŒ_fú°_ßves
))));

2332 ()
	`°rˇt
(
deböf
, 
tmp
);

2334 #ifde‡
USE_SWAP


2335 #ifde‡
DO_CLEANUP


2336 ()
	`°rˇt
(
deböf
, "\nClean-ups:\n--------------------------------------\n");

2337 ()
	`•rötf
(
tmp
, "TŸÆ: %8u\n", 
tŸÆ_˛ón_ups
);

2338 ()
	`°rˇt
(
deböf
, 
tmp
);

2339 ()
	`•rötf
(
tmp
, "De°ru˘: %8u\n", 
˛ón_up_de°ru˘
);

2340 ()
	`°rˇt
(
deböf
, 
tmp
);

2341 ()
	`•rötf
(
tmp
, "Rëu∫ 0: %8u\n", 
˛ón_up_ªtu∫0
);

2342 ()
	`°rˇt
(
deböf
, 
tmp
);

2343 ()
	`•rötf
(
tmp
, "Rëu∫ 1: %8u\n", 
˛ón_up_ªtu∫1
);

2344 ()
	`°rˇt
(
deböf
, 
tmp
);

2346 ()
	`°rˇt
(
deböf
, "\nSwap:\n--------------------------------------\n");

2347 ()
	`•rötf
(
tmp
, "Swapped: %8u Kbytes in %d chains.\n",

2348 ()
tŸÆ_byãs_sw≠≥d
 >> 10, 
tŸÆ_sw≠_chaös
);

2349 ()
	`°rˇt
(
deböf
, 
tmp
);

2350 ()
	`•rötf
(
tmp
, "File: %8u Kbytes.\n",

2351 ()
œ°_addªss
 >> 10);

2352 ()
	`°rˇt
(
deböf
, 
tmp
);

2353 ()
	`•rötf
(
tmp
, "Free: %8u blocks.\n",

2354 ()
tŸÆ_‰ì_blocks
);

2355 ()
	`°rˇt
(
deböf
, 
tmp
);

2356 ()
	`•rötf
(
tmp
, "Bitmap: %8u Kbytes. (%u..%u)\n",

2357 
sw≠_cursize
 >> 10, 
sw≠_mö‰ì
, 
sw≠_max‰ì
);

2358 ()
	`°rˇt
(
deböf
, 
tmp
);

2359 ()
	`•rötf
(
tmp
, "Time: %8d sec⁄ds.\n", 
cuºít_time
 -

2360 (
sw≠_¥og
->
time_of_ªf
 < 
sw≠_ob
->time_of_ref ?

2361 
sw≠_¥og
->
time_of_ªf
 :

2362 
sw≠_¥og
->
time_of_ªf
));

2363 ()
	`°rˇt
(
deböf
, 
tmp
);

2364 ()
	`•rötf
(
tmp
,"Objects: %d/%d/%d in, %d/%d/%d out.\n",

2365 
sw≠_ö_obj_£c
, 
sw≠_ö_obj_mö
, 
sw≠_ö_obj_hour
,

2366 
sw≠_out_obj_£c
, 
sw≠_out_obj_mö
, 
sw≠_out_obj_hour
);

2367 ()
	`°rˇt
(
deböf
, 
tmp
);

2368 ()
	`•rötf
(
tmp
,"Programs: %d/%d/%d in, %d/%d/%d out.\n",

2369 
sw≠_ö_¥og_£c
, 
sw≠_ö_¥og_mö
, 
sw≠_ö_¥og_hour
,

2370 
sw≠_out_¥og_£c
, 
sw≠_out_¥og_mö
, 
sw≠_out_¥og_hour
);

2371 ()
	`°rˇt
(
deböf
, 
tmp
);

2373 
	`add_°rög_°©us
(
deböf
);

2375 
	`add_ŸabÀ_°©us
(
deböf
);

2377 ()
	`°rˇt
(
deböf
, "\nReferences:\n--------------------------------\n");

2378 ()
	`•rötf
(
tmp
, "NuŒ ve˘‹: %d\n", 
nuŒ_ve˘‹
.
ªf
);

2379 ()
	`°rˇt
(
deböf
, 
tmp
);

2382 
tŸ
 = 
tŸÆ_¥og_block_size
 +

2383 
tŸÆ_¥ogøm_size
 +

2384 
tŸ_Æloc_£¡í˚
 * (
£¡í˚
) +

2385 
tŸÆ_¨øy_size
 +

2386 
tŸ_Æloc_v¨übÀ_size
 +

2387 
ˇŒ_out_size
 +

2388 
tŸÆ_m≠pög_size
 +

2389 
byãs_di°ö˘_°rögs_sh¨ed
 + 
ovîhód_byãs_sh¨ed
 +

2390 
byãs_di°ö˘_°rögs_mÆlo˚d
 + 
ovîhód_byãs_mÆlo˚d
 +

2391 
tŸ_Æloc_obje˘_size
 + 
ªs
;

2393 i‡(!
vîbo£
)

2395 #ifde‡
USE_SWAP


2396 i‡(
u£d_mem‹y
)

2398 ()
	`•rötf
(
tmp
,"Othî:\t\t\t\t\à%8ld\n", ()
u£d_mem‹y
 - 
tŸ
);

2399 ()
	`°rˇt
(
deböf
, 
tmp
);

2400 
tŸ
 = ()
u£d_mem‹y
;

2403 ()
	`°rˇt
(
deböf
, "\t\t\t\t\t --------\n");

2404 ()
	`•rötf
(
tmp
,"TŸÆ:\t\t\t\t\à%8ld\n", 
tŸ
);

2405 ()
	`°rˇt
(
deböf
, 
tmp
);

2408  
	`make_m°rög
(
deböf
);

2409 
	}
}

2411 
ve˘‹
 *

2412 
	$gë_loˇl_comm™ds
(
obje˘
 *
ob
)

2414 
£¡í˚
 *
s
;

2415 
ve˘‹
 *
ªt
;

2416 
ve˘‹
 *
ªt2
;

2417 
num
;

2419 
num
 = 0, 
s
 = 
ob
->
£¡
; s; s = s->
√xt
)

2420 
num
++;

2422 
ªt2
 = 
	`Æloˇã_¨øy
(
num
);

2425 
num
 = 0, 
s
 = 
ob
->
£¡
; s; s = s->
√xt
,Çum++)

2427 
ªt2
->
ôem
[
num
].
ty≥
 = 
T_POINTER
;

2428 
ªt2
->
ôem
[
num
].
u
.
vec
 = 
ªt
 = 
	`Æloˇã_¨øy
(4);

2430 
ªt
->
ôem
[0].
ty≥
 = 
T_STRING
;

2431 
ªt
->
ôem
[0].
°rög_ty≥
 = 
STRING_SSTRING
;

2432 
ªt
->
ôem
[0].
u
.
°rög
 = 
	`ª„ªn˚_s°rög
(
s
->
vîb
);

2434 
ªt
->
ôem
[1].
ty≥
 = 
T_NUMBER
;

2435 
ªt
->
ôem
[1].
u
.
numbî
 = 
s
->
sh‹t_vîb
;

2437 i‡(
s
->
fun˘
->
funobj
) {

2438 
ªt
->
ôem
[2].
ty≥
 = 
T_OBJECT
;

2439 
ªt
->
ôem
[2].
u
.
ob
 = 
s
->
fun˘
->
funobj
;

2440 
	`add_ªf
(
ªt
->
ôem
[2].
u
.
ob
,"get_local_commands");

2443 
ªt
->
ôem
[3].
ty≥
 = 
T_STRING
;

2444 
ªt
->
ôem
[3].
°rög_ty≥
 = 
STRING_MSTRING
;

2445 
ªt
->
ôem
[3].
u
.
°rög
 = 
	`make_m°rög
(
	`gë˛osuª«me
(
s
->
fun˘
));

2447  
ªt2
;

2448 
	}
}

2452 
	$Áèl
(*
fmt
, ...)

2454 
va_li°
 
¨gp
;

2455 
buf
[512];

2457 
ö_Áèl
 = 0;

2459 i‡(
ö_Áèl
)

2460 
	`ab‹t
();

2461 
ö_Áèl
 = 1;

2463 
	`va_°¨t
(
¨gp
, 
fmt
);

2464 ()
	`vÂrötf
(
°dîr
, 
fmt
, 
¨gp
);

2466 ()
	`fÊush
(
°dîr
);

2467 i‡(
cuºít_obje˘
)

2468 (Ë
	`Ârötf
(
°dîr
, "Current object was %s\n",

2469 
cuºít_obje˘
->
«me
);

2470 ()
	`v•rötf
(
buf
, 
fmt
, 
¨gp
);

2472 
	`va_íd
(
¨gp
);

2473 
	`debug_mesßge
("%s", 
buf
);

2475 i‡(
cuºít_obje˘
)

2476 
	`debug_mesßge
("Cuºíàobje˘ wa†%s\n", 
cuºít_obje˘
->
«me
);

2477 
	`debug_mesßge
("Dump of variables:\n");

2478 (Ë
	`dump_åa˚
(1);

2479 
	`ab‹t
();

2480 
	}
}

2482 
	gnum_îr‹
 = 0;

2499 
	$throw_îr‹
()

2501 
svÆue
 
ˇtch_vÆue
;

2503 i‡(
ex˚±i⁄
->
e_ˇtch
)

2505 
	`l⁄gjmp
(
ex˚±i⁄
->
e_c⁄ãxt
, 1);

2506 
	`Áèl
("Throw_error failed!\n");

2508 i‡(
ˇtch_vÆue
.
ty≥
 =
T_STRING
)

2509 
	`îr‹
(
ˇtch_vÆue
.
u
.
°rög
);

2511 
	`îr‹
("Throw withÇo catch.\n");

2513 
	}
}

2515 
	gemsg_buf
[2000];

2519 
	$îr‹
(*
fmt
, ...)

2521 
svÆue
 
ˇtch_vÆue
;

2522 *
obje˘_«me
;

2524 
va_li°
 
¨gp
;

2525 
	`va_°¨t
(
¨gp
, 
fmt
);

2526 ()
	`v•rötf
(
emsg_buf
 + 1, 
fmt
, 
¨gp
);

2528 
	`va_íd
(
¨gp
);

2530 
emsg_buf
[0] = '*';

2531 i‡(
ex˚±i⁄
 !
NULL
 &&Éx˚±i⁄->
e_ˇtch
)

2533 
	`‰ì_svÆue
(&
ˇtch_vÆue
);

2534 
ˇtch_vÆue
.
ty≥
 = 
T_STRING
;

2535 
ˇtch_vÆue
.
°rög_ty≥
 = 
STRING_MSTRING
;

2536 
ˇtch_vÆue
.
u
.
°rög
 = 
	`make_m°rög
(
emsg_buf
);

2537 
	`l⁄gjmp
(
ex˚±i⁄
->
e_c⁄ãxt
, 1);

2538 
	`Áèl
("Catch()Üongjump failed\n");

2540 
num_îr‹
++;

2541 i‡(
num_îr‹
 <= 1)

2544 
	`debug_mesßge
("%s", 
emsg_buf
+1);

2546 
obje˘_«me
 = 
	`dump_åa˚
(0);

2547 ()
	`fÊush
(
°dout
);

2548 i‡(
obje˘_«me
) {

2549 
obje˘
 *
ob
;

2550 
ob
 = 
	`föd_obje˘2
(
obje˘_«me
);

2551 i‡(!
ob
) {

2552 
	`debug_mesßge
("error whenÉxecutingÖrogram in destroyed object %s\n",

2553 
obje˘_«me
);

2562 
	`ª£t_machöe
 (0);

2563 
	`push_°rög
(
emsg_buf
, 
STRING_MSTRING
);

2564 i‡(
cuºít_obje˘
)

2566 
	`push_obje˘
(
cuºít_obje˘
);

2568 i‡(
cuºít_¥og
)

2569 
	`push_°rög
(
cuºít_¥og
->
«me
, 
STRING_MSTRING
);

2571 
	`push_°rög
("<?? >", 
STRING_CSTRING
);

2573 
	`push_°rög
(
	`gë_§ccode_posôi⁄_if_™y
(), 
STRING_MSTRING
);

2577 
	`push_numbî
(0);

2578 
	`push_°rög
("<?? >", 
STRING_CSTRING
);

2579 
	`push_°rög
("", 
STRING_CSTRING
);

2581 ()
	`≠∂y_ma°î_ob
(
M_RUNTIME_ERROR
, 4);

2585 
	`debug_mesßge
("Too many simultaneousÉrrors.\n");

2588 
num_îr‹
--;

2589 i‡(
ex˚±i⁄
 !
NULL
)

2590 
	`l⁄gjmp
(
ex˚±i⁄
->
e_c⁄ãxt
, 1);

2591 
	`ab‹t
();

2593 
	}
}

2599 
	$ÀgÆ_∑th
(*
∑th
)

2601 *
p
;

2603 i‡(
∑th
 =
NULL
 || 
	`°rchr
(path, ' '))

2605 i‡(
∑th
[0] == '/')

2607 
p
 = 
	`°rchr
(
∑th
, '.');Ö;Ö = strchr(p+1, '.'))

2609 i‡(
p
[1] == '.')

2613 
	}
}

2619 
	sîr‹_msg
 {

2620 
îr‹_msg
 *
	m√xt
;

2621 *
	mfûe
;

2622 *
	mmsg
;

2623 } *
	gsm¨t_log_msg
 = 
NULL
;

2626 
	$öô_sm¨t_log
()

2628 
îr‹_msg
 *
¥ev
;

2630 
sm¨t_log_msg
)

2632 
¥ev
 = 
sm¨t_log_msg
;

2633 
sm¨t_log_msg
 = sm¨t_log_msg->
√xt
;

2634 
	`‰ì_m°rög
(
¥ev
->
fûe
);

2635 
	`‰ì_m°rög
(
¥ev
->
msg
);

2636 
	`‰ì
((*)
¥ev
);

2638 
	}
}

2641 
	$dump_sm¨t_log
()

2643 
îr‹_msg
 *
¥ev
;

2645 i‡(!
ma°î_ob
)

2647 
	`öô_sm¨t_log
();

2651 
sm¨t_log_msg
)

2653 
¥ev
 = 
sm¨t_log_msg
;

2654 
sm¨t_log_msg
 = sm¨t_log_msg->
√xt
;

2655 
	`push_m°rög
(
¥ev
->
fûe
);

2656 
	`push_m°rög
(
¥ev
->
msg
);

2657 
	`‰ì
((*)
¥ev
);

2658 ()
	`≠∂y_ma°î_ob
(
M_LOG_ERROR
, 2);

2660 
	}
}

2663 
	$sm¨t_log
(*
îr‹_fûe
, 
löe
, *
wh©
)

2665 
buff
[500];

2666 
îr‹_msg
 **
œ°
;

2668 
œ°
 = &
sm¨t_log_msg
; *œ°;Üa° = &(*œ°)->
√xt
)

2669 i‡(
îr‹_fûe
 == 0)

2671 i‡(
	`°æí
(
wh©
Ë+ såÀn(
îr‹_fûe
Ë>  
buff
 - 100)

2672 
wh©
 = "...[tooÜongÉrror message]...";

2673 i‡(
	`°æí
(
wh©
Ë+ såÀn(
îr‹_fûe
Ë>  
buff
 - 100)

2674 
îr‹_fûe
 = "...[tooÜong filename]...";

2675 ()
	`•rötf
(
buff
, "%†löê%d:%s\n", 
îr‹_fûe
, 
löe
, 
wh©
);

2676 *
œ°
 = (
îr‹_msg
 *)
	`xÆloc
((error_msg));

2677 (*
œ°
)->
√xt
 = 
NULL
;

2678 (*
œ°
)->
fûe
 = 
	`make_m°rög
(
îr‹_fûe
);

2679 (*
œ°
)->
msg
 = 
	`make_m°rög
(
buff
);

2680 
	}
}

2694 
	$check_vÆid_∑th
(*
∑th
, 
obje˘
 *
ob
,

2695 *
ˇŒ_fun
, 
wrôeÊg
)

2697 
svÆue
 *
v
;

2699 
	`push_°rög
(
∑th
, 
STRING_MSTRING
);

2700 
	`push_obje˘
(
ob
);

2701 
	`push_°rög
(
ˇŒ_fun
, 
STRING_MSTRING
);

2702 i‡(
wrôeÊg
)

2703 
v
 = 
	`≠∂y_ma°î_ob
(
M_VALID_WRITE
, 3);

2705 
v
 = 
	`≠∂y_ma°î_ob
(
M_VALID_READ
, 3);

2706 i‡(
v
 && (v->
ty≥
 !
T_NUMBER
 || v->
u
.
numbî
 == 0))

2708 i‡(
∑th
[0] == '/')

2709 
∑th
++;

2710 i‡(
∑th
[0] == '\0')

2711 
∑th
 = ".";

2712 i‡(
	`ÀgÆ_∑th
(
∑th
))

2713  
∑th
;

2715 
	}
}

2720 
	ggame_is_beög_shut_down
;

2724 
	$°¨tshutdowngame
(
¨g
)

2726 
game_is_beög_shut_down
 = 1;

2727 
	}
}

2735 
	$shutdowngame
()

2737 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


2738 *
ª£rved_¨ó
;

2739 
Õc_¥edef_s
 *
Õ
;

2740 *
p
;

2743 
	`ªmove_Æl_∂ayîs
();

2744 
	`ùc_ªmove
();

2745 #ifde‡
USE_SWAP


2746 
	`u∆ök_sw≠_fûe
();

2748 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


2749 i‡(
ª£rved_¨ó
) {

2750 
	`‰ì
(
ª£rved_¨ó
);

2751 
ª£rved_¨ó
 = 
NULL
;

2753 
	`‰ì_∑r£_öf‹m©i⁄
();

2754 
	`ªmove_Æl_obje˘s
();

2755 (
Õ
 = 
Õc_¥edefs
Ë!
NULL
) {

2756 
Õc_¥edefs
 =Üpc_¥edefs->
√xt
;

2757 i‡(
Õ
->
Êag
)

2758 
	`‰ì
(
Õ
->
Êag
);

2759 
	`‰ì
(
Õ
);

2761 
	`‰ì_öc_li°
();

2762 
	`ªmove_de°ru˘ed_obje˘s
();

2763 
	`‰ì_Æl_£¡
();

2764 
	`tmp˛ón
();

2765 ()
	`°r˝y
(
deböf
, 
p
 = 
	`gë_gamedrivî_öfo
("status"));

2766 
	`‰ì_m°rög
(
p
);

2767 
	`add_°rög_°©us
(
deböf
 + 
	`°æí
(debinf));

2768 
	`Âuts
(
deböf
, 
°dîr
);

2769 #ifde‡
USE_SWAP


2770 
	`˛o£_sw≠_fûe
();

2772 
	`ªmove_°rög_hash
();

2773 
	`˛ór_ŸabÀ
();

2774 
	`˛ór_ù_èbÀ
();

2775 i‡(
öhîô_fûe
)

2776 
	`‰ì
(
öhîô_fûe
);

2777 
öhîô_fûe
 = 
NULL
;

2778 ()
	`≠∂y
(
NULL
, NULL, 0, 0);

2779 #i‚de‡
MALLOC_sysmÆloc


2780 
	`Âutc
('\n', 
°dîr
);

2781 
	`Âuts
(
	`dump_mÆloc_d©a
(), 
°dîr
);

2784 #ifde‡
OPCPROF


2785 
	`›cdump
();

2787 
	}
}

2796 
	$¶ow_shut_down
(
möuãs
)

2801 
	`push_numbî
(
möuãs
);

2802 (Ë
	`≠∂y_ma°î_ob
(
M_MEMORY_FAILURE
, 1);

2803 
	}
}

2806 
	$m©ch_°rög
(*
m©ch
, *
°r
)

2808 
i
;

2810 
agaö
:

2811 i‡(*
°r
 ='\0' && *
m©ch
 == '\0')

2813 *
m©ch
)

2816 i‡(*
°r
 == '\0')

2818 
°r
++;

2819 
m©ch
++;

2820 
agaö
;

2822 
m©ch
++;

2823 i‡(*
m©ch
 == '\0')

2825 
i
=0; 
°r
[i] != '\0'; i++)

2826 i‡(
	`m©ch_°rög
(
m©ch
, 
°r
+
i
))

2832 
m©ch
++;

2833 i‡(*
m©ch
 == '\0')

2837 i‡(*
m©ch
 =*
°r
) {

2838 
m©ch
++;

2839 
°r
++;

2840 
agaö
;

2844 
	}
}

2851 #i‚de‡
S_ISDIR


2852 
	#S_ISDIR
(
m
Ë(((m)&
S_IFMT
Ë=
S_IFDIR
)

	)

2855 #i‚de‡
S_ISREG


2856 
	#S_ISREG
(
m
Ë(((m)&
S_IFMT
Ë=
S_IFREG
)

	)

2860 
	$isdú
(*
∑th
)

2862 
°©
 
°©s
;

2864  
	`°©
 (
∑th
, &
°©s
Ë=0 && 
	`S_ISDIR
 (°©s.
°_mode
);

2865 
	}
}

2868 
	$°rù_åaûög_¶ashes
(*
∑th
)

2870 
œ°
;

2872 
œ°
 = 
	`°æí
 (
∑th
) - 1;

2873 
œ°
 > 0 && 
∑th
[last] == '/')

2874 
∑th
[
œ°
--] = '\0';

2875 
	}
}

2877 
°©
 
	gto_°©s
, 
	g‰om_°©s
;

2880 
	$c›y
 (*
‰om
, *
to
)

2882 
buf
[1024 * 8];

2883 
Àn
;

2884 
ifd
;

2885 
ofd
;

2887 i‡(!
	`S_ISREG
 (
‰om_°©s
.
°_mode
))

2889 
	`îr‹
("ˇ¬Ÿ movê`%s'á¸os†fûesy°ems: NŸáÑeguœ∏fûe\n", 
‰om
);

2893 i‡(
	`u∆ök
 (
to
Ë&& 
î∫o
 !
ENOENT
)

2895 
	`îr‹
("ˇ¬ŸÑemovê`%s'\n", 
to
);

2899 
ifd
 = 
	`›í
 (
‰om
, 
O_RDONLY
, 0);

2900 i‡(
ifd
 < 0)

2902 
	`îr‹
 ("%s: o≥¿Áûed\n", 
‰om
);

2905 
ofd
 = 
	`›í
 (
to
, 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
, 0600);

2906 i‡(
ofd
 < 0)

2908 
	`îr‹
 ("%s: o≥¿Áûed\n", 
to
);

2909 ()
	`˛o£
 (
ifd
);

2912 #i‚de‡
FCHMOD_MISSING


2913 i‡(
	`fchmod
 (
ofd
, (
mode_t
)(
‰om_°©s
.
°_mode
 & 0777)))

2915 
	`îr‹
 ("%s: fchmod faûed\n", 
to
);

2916 ()
	`˛o£
 (
ifd
);

2917 ()
	`˛o£
 (
ofd
);

2918 ()
	`u∆ök
 (
to
);

2923 (
Àn
 = 
	`ªad
 (
ifd
, 
buf
,  (buf))) > 0)

2925 
wrŸe
 = 0;

2926 *
bp
 = 
buf
;

2930 
wrŸe
 = 
	`wrôe
 (
ofd
, 
bp
, (
size_t
)
Àn
);

2931 i‡(
wrŸe
 < 0)

2933 
	`îr‹
 ("%s: wrôêÁûed\n", 
to
);

2934 ()
	`˛o£
 (
ifd
);

2935 ()
	`˛o£
 (
ofd
);

2936 ()
	`u∆ök
 (
to
);

2939 
bp
 +
wrŸe
;

2940 
Àn
 -
wrŸe
;

2941 } 
Àn
 > 0);

2943 i‡(
Àn
 < 0)

2945 
	`îr‹
 ("%s:Ñód faûed\n", 
‰om
);

2946 ()
	`˛o£
 (
ifd
);

2947 ()
	`˛o£
 (
ofd
);

2948 ()
	`u∆ök
 (
to
);

2952 i‡(
	`˛o£
 (
ifd
) < 0)

2954 
	`îr‹
 ("%s: clo£ faûed", 
‰om
);

2955 ()
	`˛o£
 (
ofd
);

2958 i‡(
	`˛o£
 (
ofd
) < 0)

2960 
	`îr‹
 ("%s: clo£ faûed", 
to
);

2964 #ifde‡
FCHMOD_MISSING


2965 i‡(
	`chmod
 (
to
, 
‰om_°©s
.
°_mode
 & 0777))

2967 
	`îr‹
 ("%s: chmod faûed\n", 
to
);

2973 
	}
}

2980 
	$do_move
 (*
‰om
, *
to
)

2982 i‡(
	`l°©
 (
‰om
, &
‰om_°©s
) != 0)

2984 
	`îr‹
 ("%s:Ü°© faûed\n", 
‰om
);

2988 i‡(
	`l°©
 (
to
, &
to_°©s
) == 0)

2990 i‡(
‰om_°©s
.
°_dev
 =
to_°©s
.st_dev

2991 && 
‰om_°©s
.
°_öo
 =
to_°©s
.st_ino)

2993 
	`îr‹
 ("`%s'ánd `%s'áªÅhêßmêfûe", 
‰om
, 
to
);

2997 i‡(
	`S_ISDIR
 (
to_°©s
.
°_mode
))

2999 
	`îr‹
 ("%s: c™nŸ ovîwrôêdúe˘‹y", 
to
);

3004 i‡(
î∫o
 !
ENOENT
)

3006 
	`îr‹
 ("%s: unknow¿îr‹\n", 
to
);

3009 #i‡
	`deföed
(
SYSV
Ë&& !deföed(
_SEQUENT_
)

3010 i‡(
	`isdú
(
‰om
))

3012 
cmd_buf
[100];

3013 ()
	`•rötf
(
cmd_buf
, "/u§/lib/mv_dú %†%s", 
‰om
, 
to
);

3014  !
	`sy°em
(
cmd_buf
);

3017 i‡(
	`ª«me
 (
‰om
, 
to
) == 0)

3022 i‡(
î∫o
 !
EXDEV
)

3024 
	`îr‹
 ("ˇ¬Ÿ movê`%s'Åÿ`%s'", 
‰om
, 
to
);

3030 i‡(
	`c›y
 (
‰om
, 
to
))

3033 i‡(
	`u∆ök
 (
‰om
))

3035 
	`îr‹
 ("ˇ¬ŸÑemovê`%s'", 
‰om
);

3040 
	}
}

3059 
	$do_ª«me
(* 
‰
, *
t
)

3061 *
‰om
, *
to
;

3063 
‰om
 = 
	`check_vÆid_∑th
(
‰
, 
cuºít_obje˘
, "do_rename_from", 1);

3064 if(!
‰om
)

3066 
to
 = 
	`check_vÆid_∑th
(
t
, 
cuºít_obje˘
, "do_rename_to", 1);

3067 if(!
to
)

3069 if(*
to
 ='\0' && 
	`°rcmp
(
t
, "/") == 0)

3071 
to
 = (*)
	`Æloˇ
(3);

3072 ()
	`°r˝y
(
to
, "./");

3074 
	`°rù_åaûög_¶ashes
 (
‰om
);

3075 i‡(
	`isdú
 (
to
))

3078 *
˝
;

3079 *
√wto
;

3081 
˝
 = 
	`°ºchr
 (
‰om
, '/');

3082 i‡(
˝
)

3083 
˝
++;

3085 
˝
 = 
‰om
;

3087 
√wto
 = (*Ë
	`Æloˇ
 (
	`°æí
 (
to
Ë+ 1 + såÀ¿(
˝
) + 1);

3088 ()
	`•rötf
 (
√wto
, "%s/%s", 
to
, 
˝
);

3089  
	`do_move
 (
‰om
, 
√wto
);

3092  
	`do_move
 (
‰om
, 
to
);

3093 
	}
}

	@simulate.h

1 
upd©e_a˘i⁄s
(
obje˘
 *
aob
);

2 *
gë_gamedrivî_öfo
(*
°r
);

3 
Áèl
(*
fmt
, ...);

4 
îr‹
(*
fmt
, ...);

	@smalloc.c

16 #i‡
deföed
(
sun
)

17 
	~<sys/ty≥s.h
>

20 
	~<°dio.h
>

21 
	~<°rög.h
>

22 
	~"c⁄fig.h
"

23 
	~"löt.h
"

24 
	~"simuœã.h
"

26 #ifde‡
USE_SWAP


27 
u£d_mem‹y
;

32 
	#MALLOC_ALIGN
 8

	)

33 
	#MALLOC_ALIGN_8


	)

35 
	#MALLOC_ALIGN
 4

	)

41 
	#SBRK_OK


	)

42 #i‡
deföed
(
__O≥nBSD__
Ë|| deföed(
__bsdi__
Ë|| deföed(
__NëBSD__
) || \

43 
	$deföed
(
__FªeBSD__
)

44 
	#POINTER
 *

	)

46 
	#POINTER
 *

	)

48 
	#FREE_RETURN_TYPE
 

	)

49 
	#FREE_RETURN
 ;

	)

50 
	#SFREE_RETURN_TYPE
 
FREE_RETURN_TYPE


	)

51 
	#SFREE_RETURN
 
FREE_RETURN


	)

53 
	#FIT_STYLE_FAST_FIT


	)

55 #unde‡
LARGE_TRACE


57 
	#Áke
(
s
)

	)

59 
	#smÆloc
 
mÆloc


	)

60 
	#s‰ì
 
‰ì


	)

61 
	#§óŒoc
 
ªÆloc


	)

63 
	#SMALL_BLOCK_MAX_BYTES
 128

	)

64 
	#SMALL_CHUNK_SIZE
 0x4000

	)

65 
	#CHUNK_SIZE
 0x40000

	)

67 
	#SINT
 ()

	)

68 
	#SMALL_BLOCK_MAX
 (
SMALL_BLOCK_MAX_BYTES
/
SINT
)

	)

70 
	#PREV_BLOCK
 0x80000000

	)

71 
	#THIS_BLOCK
 0x40000000

	)

72 
	#NO_REF
 0x20000000

	)

73 
	#MASK
 0x0FFFFFFF

	)

75 
	#MAGIC
 0x17952932

	)

79 #i‡
	`deföed
–
©¨i°
 ) || deföed–
löux
 ) || deföed–
AMIGA
 )

80 
	tu
;

82 
	tu
;

85 
u
 *
œ°_smÆl_chunk
 = 0;

86 
u
 *
sÊèbÀ
[
SMALL_BLOCK_MAX
]={0,0,0,0,0,0,0,0
	}
};

87 
u
 *
	g√xt_unu£d
=0;

88 
u
 
	gunu£d_size
=0;

92 #i‚de‡
FIT_STYLE_FAST_FIT


93 
u
 *
	g‰ì_li°
=0;

95 
u
 *
	g°¨t_√xt_block
=0;

97 #ifde‡
SMALLOC_STATISTICS


101 
	gsmÆl_cou¡
[
SMALL_BLOCK_MAX
]={0,0,0,0,0,0,0,0};

102 
	gsmÆl_tŸÆ
[
SMALL_BLOCK_MAX
]={0,0,0,0,0,0,0,0};

103 
	gsmÆl_max
[
SMALL_BLOCK_MAX
] ={0,0,0,0,0,0,0,0};

104 
	gsmÆl_‰ì
[
SMALL_BLOCK_MAX
] ={0,0,0,0,0,0,0,0};

107 °ru˘ { 
	mcou¡î
, 
	msize
; } 
	tt_°©
;

108 
	#cou¡
(
a
,
b
Ë{á.
size
+=(b); i‡((b)<0Ë--a.
cou¡î
; ++a.cou¡î; }

	)

109 
	#cou¡_up
(
a
,
b
Ë{á.
size
+=(b); ++a.
cou¡î
; }

	)

110 
	#cou¡_back
(
a
,
b
Ë{á.
size
-=(b); --a.
cou¡î
; }

	)

112 
	gdebugmÆloc
=0;

118 *
œrge_mÆloc
(
u
);

119 
œrge_‰ì
(*);

120 
buûd_block
(
u
 *, u);

121 
m¨k_block
(
u
 *);

122 *
esbrk
(
u
);

123 *
esbrk
(
u
);

124 
add_to_‰ì_li°
(
u
 *);

125 
ªmove_‰om_‰ì_li°
(
u
 *);

126 #i‚de‡
FIT_STYLE_FAST_FIT


127 
show_block
(
u
 *);

129 *
dump_mÆloc_d©a
();

130 
mÆloc_size_mask
();

131 
mÆlo˚d_size
(
POINTER
);

133 
	#s_size_±r
(
p
Ë’)

	)

134 
	#s_√xt_±r
(
p
Ë((
u
 **Ë’+1))

	)

136 
t_°©
 
	gsmÆl_Æloc_°©
={0,0};

137 
t_°©
 
	gsmÆl_‰ì_°©
={0,0};

138 
t_°©
 
	gsmÆl_chunk_°©
={0,0};

140 
POINTER


141 
	$smÆloc
(
u
 
size
)

144 
u
 *
ãmp
;

146 #ifde‡
DEBUG


147 i‡(
size
 == 0)

148 
	`Áèl
("Malloc size 0.\n");

150 i‡(
size
 > 
SMALL_BLOCK_MAX_BYTES
)

151  
	`œrge_mÆloc
(
size
);

153 
size
 = (size+7) & ~3;

154 
	#SIZE_INDEX
(
u_¨øy
, 
size
Ë(*(
u
*Ë((*)u_¨øy-8+size))

	)

155 
	#SIZE_PNT_INDEX
(
u_¨øy
, 
size
Ë(*(
u
**)((*)u_¨øy-8+size))

	)

157 
	`cou¡_up
(
smÆl_Æloc_°©
,
size
);

161 
	`SIZE_INDEX
(
smÆl_cou¡
, 
size
) += 1;

162 
	`SIZE_INDEX
(
smÆl_tŸÆ
, 
size
) += 1;

163 i‡(
	`SIZE_INDEX
(
smÆl_cou¡
, 
size
Ë> SIZE_INDEX(
smÆl_max
, size))

164 
	`SIZE_INDEX
(
smÆl_max
, 
size
ËSIZE_INDEX(
smÆl_cou¡
, size);

166 i‡((
ãmp
 = 
	`SIZE_PNT_INDEX
(
sÊèbÀ
, 
size
)Ë!
NULL
)

168 
	`cou¡_back
(
smÆl_‰ì_°©
, 
size
);

169 
ãmp
++;

170 
	`SIZE_PNT_INDEX
(
sÊèbÀ
, 
size
Ë* (
u
 **Ë
ãmp
;

171 #ifde‡
USE_SWAP


172 
u£d_mem‹y
 +
size
;

174 
	`Áke
("From freeÜist.");

175  (*Ë
ãmp
;

178 i‡(
unu£d_size
<
size
)

180 
	`Áke
("AllocatingÇew small chunk.");

181 i‡(
unu£d_size
) {

182 i‡(
unu£d_size
 < 8) {

183 *
	`s_size_±r
(
√xt_unu£d
) = 0;

185 *
	`s_size_±r
(
√xt_unu£d
Ë
unu£d_size
>>2;

186 *
	`s_√xt_±r
(
√xt_unu£d
Ë
	`SIZE_PNT_INDEX
(
sÊèbÀ
, 
unu£d_size
);

187 
	`SIZE_PNT_INDEX
(
sÊèbÀ
, 
unu£d_size
Ë
√xt_unu£d
;

188 
	`cou¡_up
(
smÆl_‰ì_°©
, 
unu£d_size
);

191 
√xt_unu£d
 = (
u
 *Ë
	`œrge_mÆloc
(
SMALL_CHUNK_SIZE
 + (u*));

192 #ifde‡
USE_SWAP


193 
u£d_mem‹y
 -
SMALL_CHUNK_SIZE
 + (
u
*);

195 i‡(
√xt_unu£d
 == 0)

197 *
√xt_unu£d
 = (
u
)
œ°_smÆl_chunk
;

198 
œ°_smÆl_chunk
 = 
√xt_unu£d
++;

199 
	`cou¡_up
(
smÆl_chunk_°©
, 
SMALL_CHUNK_SIZE
+
SINT
+(
u
*));

200 
unu£d_size
 = 
SMALL_CHUNK_SIZE
;

203 
	`Áke
("Allocated from chunk.");

207 
ãmp
 = (
u
 *Ë
	`s_√xt_±r
(
√xt_unu£d
);

209 *
	`s_size_±r
(
√xt_unu£d
Ë
size
>>2;

210 
√xt_unu£d
 +
size
>>2;

211 
unu£d_size
 -
size
;

212 #ifde‡
USE_SWAP


213 
u£d_mem‹y
 +
size
;

216 
	`Áke
("allocation from chunk successful\n");

217  (*Ë
ãmp
;

218 
	}
}

220 #ifde‡
DEBUG


221 *
	gdebug_‰ì_±r
;

224 
	$mÆloc_size_mask
(Ë{  
MASK
; 
	}
}

226 
	$mÆlo˚d_size
(
±r
)

227 
POINTER
 
±r
;

229  ((
u
 *)
±r
)[-1] & 
MASK
;

230 
	}
}

232 
SFREE_RETURN_TYPE
 
	$s‰ì
(
±r
)

233 
POINTER
 
±r
;

235 
u
 *
block
;

236 
u
 
i
;

238 #ifde‡
DEBUG


239 
debug_‰ì_±r
 = 
±r
;

241 
block
 = (
u
 *Ë
±r
;

242 
block
 -= 1;

243 
i
 = (*
	`s_size_±r
(
block
Ë& 
MASK
);

244 #ifde‡
USE_SWAP


245 
u£d_mem‹y
 -
i
 << 2;

248 i‡(
i
 > 
SMALL_BLOCK_MAX
 + 1) {

249 
	`Áke
("sfree callsÜarge_free");

250 
	`œrge_‰ì
(
±r
);

251 
SFREE_RETURN


254 
	`cou¡_back
(
smÆl_Æloc_°©
, 
i
 << 2);

255 
	`cou¡_up
(
smÆl_‰ì_°©
, 
i
 << 2);

256 
i
 -= 2;

257 *
	`s_√xt_±r
(
block
Ë
sÊèbÀ
[
i
];

258 
sÊèbÀ
[
i
] = 
block
;

260 
smÆl_‰ì
[
i
] += 1;

262 
	`Áke
("Freed");

263 
SFREE_RETURN


264 
	}
}

270 
	#BEST_FIT
 0

	)

271 
	#FIRST_FIT
 1

	)

272 
	#HYBRID
 2

	)

274 
	#fô_°yÀ
 
BEST_FIT


	)

276 #i‚de‡
fô_°yÀ


277 
	gfô_°yÀ
 =
BEST_FIT
;

280 
	#l_size_±r
(
p
Ë’)

	)

281 
	#l_√xt_±r
(
p
Ë(*((
u
 **Ë’+1)))

	)

282 
	#l_¥ev_±r
(
p
Ë(*((
u
 **Ë’+2)))

	)

283 
	#l_√xt_block
(
p
Ë’ + (
MASK
 & (*’))Ë)

	)

284 
	#l_¥ev_block
(
p
Ë’ - (
MASK
 & (*’-1))Ë)

	)

285 
	#l_¥ev_‰ì
(
p
Ë(!(*∞& 
PREV_BLOCK
))

	)

286 
	#l_√xt_‰ì
(
p
Ë(!(*
	`l_√xt_block
’Ë& 
THIS_BLOCK
))

	)

288 #ifde‡
FIT_STYLE_FAST_FIT


290 #i‡
deföed
(
©¨i°
Ë|| deföed (
sun
Ë|| deföed(
AMIGA
)

292 
	tbÆ™˚_t
;

293 
	#BALANCE_T_BITS
 8

	)

295 
	tbÆ™˚_t
;

296 
	#BALANCE_T_BITS
 16

	)

298 #i‡(
deföed
(
©¨i°
Ë&& !deföed(
ATARI_TT
)Ë|| deföed(
•¨c
Ë|| deföed(
AMIGA
)

300 
	#NO_BARREL_SHIFT


	)

303 
	s‰ì_block
 {

304 
u
 
	msize
;

305 
‰ì_block
 *
	m∑ª¡
, *
	mÀ·
, *
	mright
;

306 
bÆ™˚_t
 
	mbÆ™˚
;

307 
	mÆign_dummy
;

313 
‰ì_block
 
dummy2
;

314 
‰ì_block
 
	gdummy
 =

315 { 0, &
dummy2
, 0, 0, 0 };

316 
‰ì_block
 
	gdummy2
 =

317 { 0, 0, &
dummy
, 0, -1 };

319 
‰ì_block
 *
	g‰ì_åì
 = &
dummy2
;

321 #ifde‡
DEBUG_AVL


322 
	göc⁄si°ícy
 = 0;

324 
	$check_avl
(
∑ª¡
, 
p
)

325 
‰ì_block
 *
∑ª¡
, *
p
;

327 
À·
, 
right
;

329 i‡(!
p
)  0;

330 
À·
 = 
	`check_avl
(
p
,Ö->left );

331 
right
 = 
	`check_avl
(
p
,Ö->right);

332 i‡(
p
->
bÆ™˚
 !
right
 - 
À·
 ||Ö->balance < -1 ||Ö->balance > 1) {

333 ()
	`¥ötf
("Inconsistency inávlÇode!\n");

334 ()
	`¥ötf
("node:%x\n",
p
);

335 ()
	`¥ötf
("size: %d\n", 
p
->
size
);

336 ()
	`¥ötf
("À·Çode:%x\n",
p
->
À·
);

337 ()
	`¥ötf
("À· height: %d\n",
À·
 );

338 ()
	`¥ötf
("righànode:%x\n",
p
->
right
);

339 ()
	`¥ötf
("righàheight: %d\n",
right
);

340 ()
	`¥ötf
("ÆÀged bÆ™˚: %d\n",
p
->
bÆ™˚
);

341 
öc⁄si°ícy
 = 1;

343 i‡(
p
->
∑ª¡
 !=Öarent) {

344 ()
	`¥ötf
("Inconsistency inávlÇode!\n");

345 ()
	`¥ötf
("node:%x\n",
p
);

346 ()
	`¥ötf
("size: %d\n", 
p
->
size
);

347 ()
	`¥ötf
("∑ª¡: %x\n", 
∑ª¡
);

348 ()
	`¥ötf
("∑ª¡ size: %d\n", 
∑ª¡
->
size
);

349 ()
	`¥ötf
("ÆÀgedÖ¨ít: %x\n", 
p
->
∑ª¡
);

350 ()
	`¥ötf
("ÆÀgedÖ¨íàsize: %d\n", 
p
->
∑ª¡
->
size
);

351 ()
	`¥ötf
("À· height: %d\n",
À·
 );

352 ()
	`¥ötf
("righàheight: %d\n",
right
);

353 ()
	`¥ötf
("ÆÀged bÆ™˚: %d\n",
p
->
bÆ™˚
);

354 
öc⁄si°ícy
 = 1;

356  
À·
 > 
right
 ?Üeft+1 :Ñight+1;

357 
	}
}

360 
	$do_check_avl
() {

361 
	`check_avl
(0, 
‰ì_åì
);

362 i‡(
öc⁄si°ícy
) {

363 ()
	`fÊush
(
°dîr
);

364 ()
	`fÊush
(
°dout
);

365 
	`Áèl
("Inconsistency could crashÅhe driver\n");

368 
	}
}

371 
t_°©
 
	gœrge_‰ì_°©
;

372 
	$ªmove_‰om_‰ì_li°
(
±r
)

373 
u
 *
±r
;

375 
‰ì_block
 *
p
, *
q
, *
r
, *
s
, *
t
;

377 
	`Áke
((
	`do_check_avl
(),"remove_from_free_list called"));

378 
p
 = (
‰ì_block
 *)(
±r
+1);

379 
	`cou¡_back
(
œrge_‰ì_°©
, 
p
->
size
 << 2);

380 #ifde‡
DEBUG_AVL


381 ()
	`¥ötf
("node:%x\n",
p
);

382 ()
	`¥ötf
("size:%d\n",
p
->
size
);

384 i‡(
p
->
À·
) {

385 i‡((
q
 = 
p
->
right
Ë!
NULL
) {

386 
	`Áke
("two childs");

387 
s
 = 
q
;

388  ; 
r
 = 
q
, q =Ñ->
À·
; );

389 i‡(
r
 =
s
) {

390 
r
->
À·
 = 
s
 = 
p
->left;

391 
s
->
∑ª¡
 = 
r
;

392 i‡((
r
->
∑ª¡
 = 
s
 = 
p
->∑ª¡Ë!
NULL
) {

393 i‡(
p
 =
s
->
À·
) {

394 
s
->
À·
 = 
r
;

396 
s
->
right
 = 
r
;

399 
‰ì_åì
 = 
r
;

401 
r
->
bÆ™˚
 = 
p
->balance;

402 
p
 = 
r
;

403 
bÆ™˚_right
;

405 
t
 = 
r
->
∑ª¡
;

406 i‡((
t
->
À·
 = 
s
 = 
r
->
right
Ë!
NULL
) {

407 
s
->
∑ª¡
 = 
t
;

409 
r
->
bÆ™˚
 = 
p
->balance;

410 
r
->
À·
 = 
s
 = 
p
->left;

411 
s
->
∑ª¡
 = 
r
;

412 
r
->
right
 = 
s
 = 
p
->right;

413 
s
->
∑ª¡
 = 
r
;

414 i‡((
r
->
∑ª¡
 = 
s
 = 
p
->∑ª¡Ë!
NULL
) {

415 i‡(
p
 =
s
->
À·
) {

416 
s
->
À·
 = 
r
;

418 
s
->
right
 = 
r
;

421 
‰ì_åì
 = 
r
;

423 
p
 = 
t
;

424 
bÆ™˚_À·
;

430 
	`Áke
("noÑight child, butÜeft child");

431 
s
 = 
p
;

432 
p
 = 
s
->
∑ª¡
;

433 
r
 = 
s
->
À·
;

434 
r
->
∑ª¡
 = 
p
;

435 i‡(
s
 =
p
->
À·
) {

436 
p
->
À·
 = 
r
;

437 
bÆ™˚_À·
;

439 
p
->
right
 = 
r
;

440 
bÆ™˚_right
;

446 
	`Áke
("noÜeft child");

447 
s
 = 
p
;

448 
p
 = 
s
->
∑ª¡
;

449 i‡((
q
 = 
r
 = 
s
->
right
Ë!
NULL
) {

450 
r
->
∑ª¡
 = 
p
;

452 i‡(
s
 =
p
->
À·
) {

453 
p
->
À·
 = 
r
;

454 
bÆ™˚_À·
;

456 
p
->
right
 = 
r
;

457 
bÆ™˚_right
;

460 
bÆ™˚_q
:

461 
r
 = 
p
;

462 
p
 = 
q
;

463 i‡(
r
 =
p
->
right
) {

464 
bÆ™˚_t
 
b
;

465 
bÆ™˚_right
:

466 
b
 = 
p
->
bÆ™˚
;

467 i‡(
b
 > 0) {

468 
p
->
bÆ™˚
 = 0;

469 i‡((
q
 = 
p
->
∑ª¡
Ë!
NULL
)

470 
bÆ™˚_q
;

472 } i‡(
b
 < 0) {

473 
r
 = 
p
->
À·
;

474 
b
 = 
r
->
bÆ™˚
;

475 i‡(
b
 <= 0) {

477 #ifde‡
DEBUG_AVL


478 
	`Áke
("R-Rotation.");

479 ()
	`¥ötf
("r->bÆ™˚: %d\n", 
r
->
bÆ™˚
);

481 i‡((
p
->
À·
 = 
s
 = 
r
->
right
Ë!
NULL
) {

482 
s
->
∑ª¡
 = 
p
;

484 
r
->
right
 = 
p
;

485 
s
 = 
p
->
∑ª¡
;

486 
p
->
∑ª¡
 = 
r
;

487 
b
 += 1;

488 
r
->
bÆ™˚
 = 
b
;

489 
b
 = -b;

490 #ifde‡
DEBUG_AVL


491 ()
	`¥ötf
("nodêr: %x\n", 
r
);

492 ()
	`¥ötf
("r->bÆ™˚: %d\n", 
r
->
bÆ™˚
);

493 ()
	`¥ötf
("nodêp: %x\n", 
p
);

494 
p
->
bÆ™˚
 = 
b
;

495 ()
	`¥ötf
("p->bÆ™˚: %d\n", 
p
->
bÆ™˚
);

496 ()
	`¥ötf
("r-height: %d\n", 
	`check_avl
(
r
->
∑ª¡
,Ñ));

498 i‡((
r
->
∑ª¡
 = 
s
Ë!
NULL
) {

499 i‡((
p
->
bÆ™˚
 = 
b
Ë!
NULL
) {

500 i‡(
p
 =
s
->
À·
) {

501 
s
->
À·
 = 
r
;

504 
s
->
right
 = 
r
;

508 i‡(
p
 =
s
->
À·
) {

509 
	`Áke
("left fromÖarent");

510 
bÆ™˚_À·_s
;

512 
	`Áke
("right fromÖarent");

513 
p
 = 
s
;

514 
p
->
right
 = 
r
;

515 
bÆ™˚_right
;

518 
p
->
bÆ™˚
 = 
b
;

519 
‰ì_åì
 = 
r
;

523 
bÆ™˚_t
 
b2
;

525 
	`Áke
("LR-Rotation.");

526 
t
 = 
r
->
right
;

527 
b
 = 
t
->
bÆ™˚
;

528 i‡((
p
->
À·
 = 
s
 = 
t
->
right
Ë!
NULL
) {

529 
s
->
∑ª¡
 = 
p
;

531 i‡((
r
->
right
 = 
s
 = 
t
->
À·
Ë!
NULL
) {

532 
s
->
∑ª¡
 = 
r
;

534 
t
->
À·
 = 
r
;

535 
t
->
right
 = 
p
;

536 
r
->
∑ª¡
 = 
t
;

537 
s
 = 
p
->
∑ª¡
;

538 
p
->
∑ª¡
 = 
t
;

539 #ifde‡
NO_BARREL_SHIFT


540 
b
 = -b;

541 
b2
 = 
b
 >> 1;

542 
r
->
bÆ™˚
 = 
b2
;

543 
b
 -
b2
;

544 
p
->
bÆ™˚
 = 
b
;

546 
b2
 = ()
b
 >> 7;

547 
p
->
bÆ™˚
 = 
b2
;

548 
b2
 = -b2 -
b
;

549 
r
->
bÆ™˚
 = 
b2
;

551 
t
->
bÆ™˚
 = 0;

552 #ifde‡
DEBUG_AVL


553 ()
	`¥ötf
("t-height: %d\n", 
	`check_avl
(
t
->
∑ª¡
,Å));

555 i‡((
t
->
∑ª¡
 = 
s
Ë!
NULL
) {

556 i‡(
p
 =
s
->
À·
) {

557 
p
 = 
s
;

558 
s
->
À·
 = 
t
;

559 
bÆ™˚_À·
;

561 
p
 = 
s
;

562 
s
->
right
 = 
t
;

563 
bÆ™˚_right
;

566 
‰ì_åì
 = 
t
;

570 
p
->
bÆ™˚
 = -1;

574 
bÆ™˚_t
 
b
;

576 
bÆ™˚_À·
;

577 
bÆ™˚_À·_s
:

578 
p
 = 
s
;

579 
s
->
À·
 = 
r
;

580 
bÆ™˚_À·
:

581 
b
 = 
p
->
bÆ™˚
;

582 i‡(
b
 < 0) {

583 
p
->
bÆ™˚
 = 0;

584 i‡((
q
 = 
p
->
∑ª¡
Ë!
NULL
)

585 
bÆ™˚_q
;

587 } i‡(
b
 > 0) {

588 
r
 = 
p
->
right
;

589 
b
 = 
r
->
bÆ™˚
;

590 i‡(
b
 >= 0) {

592 #ifde‡
DEBUG_AVL


593 
	`Áke
("L-Rotation.");

594 ()
	`¥ötf
("r->bÆ™˚: %d\n", 
r
->
bÆ™˚
);

596 i‡((
p
->
right
 = 
s
 = 
r
->
À·
Ë!
NULL
) {

597 
s
->
∑ª¡
 = 
p
;

599 
	`Áke
("subtreeÑelocated");

600 
r
->
À·
 = 
p
;

601 
s
 = 
p
->
∑ª¡
;

602 
p
->
∑ª¡
 = 
r
;

603 
b
 -= 1;

604 
r
->
bÆ™˚
 = 
b
;

605 
b
 = -b;

606 #ifde‡
DEBUG_AVL


607 
	`Áke
("balances calculated");

608 ()
	`¥ötf
("nodêr: %x\n", 
r
);

609 ()
	`¥ötf
("r->bÆ™˚: %d\n", 
r
->
bÆ™˚
);

610 ()
	`¥ötf
("nodêp: %x\n", 
p
);

611 
p
->
bÆ™˚
 = 
b
;

612 ()
	`¥ötf
("p->bÆ™˚: %d\n", 
p
->
bÆ™˚
);

613 ()
	`¥ötf
("r-height: %d\n", 
	`check_avl
(
r
->
∑ª¡
,Ñ));

615 i‡((
r
->
∑ª¡
 = 
s
Ë!
NULL
) {

616 i‡((
p
->
bÆ™˚
 = 
b
Ë!
NULL
) {

617 i‡(
p
 =
s
->
À·
) {

618 
s
->
À·
 = 
r
;

621 
s
->
right
 = 
r
;

625 i‡(
p
 =
s
->
À·
) {

626 
	`Áke
("left fromÖarent");

627 
bÆ™˚_À·_s
;

629 
	`Áke
("right fromÖarent");

630 
p
 = 
s
;

631 
p
->
right
 = 
r
;

632 
bÆ™˚_right
;

635 
p
->
bÆ™˚
 = 
b
;

636 
‰ì_åì
 = 
r
;

640 
bÆ™˚_t
 
b2
;

642 
	`Áke
("RL-Rotation.");

643 
t
 = 
r
->
À·
;

644 
b
 = 
t
->
bÆ™˚
;

645 i‡((
p
->
right
 = 
s
 = 
t
->
À·
Ë!
NULL
) {

646 
s
->
∑ª¡
 = 
p
;

648 i‡((
r
->
À·
 = 
s
 = 
t
->
right
Ë!
NULL
) {

649 
s
->
∑ª¡
 = 
r
;

651 
t
->
right
 = 
r
;

652 
t
->
À·
 = 
p
;

653 
r
->
∑ª¡
 = 
t
;

654 
s
 = 
p
->
∑ª¡
;

655 
p
->
∑ª¡
 = 
t
;

656 #ifde‡
NO_BARREL_SHIFT


657 
b
 = -b;

658 
b2
 = 
b
 >> 1;

659 
p
->
bÆ™˚
 = 
b2
;

660 
b
 -
b2
;

661 
r
->
bÆ™˚
 = 
b
;

663 
b2
 = ()
b
 >> 7;

664 
r
->
bÆ™˚
 = 
b2
;

665 
b2
 = -b2 -
b
;

666 
p
->
bÆ™˚
 = 
b2
;

668 
t
->
bÆ™˚
 = 0;

669 i‡((
t
->
∑ª¡
 = 
s
Ë!
NULL
) {

670 i‡(
p
 =
s
->
À·
) {

671 
p
 = 
s
;

672 
s
->
À·
 = 
t
;

673 
bÆ™˚_À·
;

675 
s
->
right
 = 
t
;

676 
p
 = 
s
;

677 
bÆ™˚_right
;

680 
‰ì_åì
 = 
t
;

684 
p
->
bÆ™˚
++;

688 
	}
}

690 
	$add_to_‰ì_li°
(
±r
)

691 
u
 *
±r
;

693 
u
 
size
;

694 
‰ì_block
 *
p
, *
q
, *
r
;

700 
	`Áke
((
	`do_check_avl
(),"add_to_free_list called"));

701 
size
 = *
±r
 & 
MASK
;

702 #ifde‡
DEBUG_AVL


703 ()
	`¥ötf
("size:%d\n",
size
);

705 
q
 = (
‰ì_block
 *)
size
;

707 
r
 = (
‰ì_block
 *)(
±r
+1);

708 
	`cou¡_up
(
œrge_‰ì_°©
, 
size
 << 2);

709 
q
 = 
‰ì_åì
;

711 
p
 = (
‰ì_block
 *)
q
;

712 #ifde‡
DEBUG_AVL


713 ()
	`¥ötf
("checkedÇodêsizê%d\n",
p
->
size
);

715 i‡(
size
 < 
p
->size) {

716 i‡((
q
 = 
p
->
À·
Ë!
NULL
) {

719 
	`Áke
("addÜeft");

720 
p
->
À·
 = 
r
;

723 i‡((
q
 = 
p
->
right
Ë!
NULL
) {

726 
	`Áke
("addÑight");

727 
p
->
right
 = 
r
;

731 
r
->
size
 = size;

732 
r
->
∑ª¡
 = 
p
;

733 
r
->
À·
 = 0;

734 
r
->
right
 = 0;

735 
r
->
bÆ™˚
 = 0;

736 #ifde‡
DEBUG_AVL


737 
	`Áke
("builtÇewÜeaf.");

738 ()
	`¥ötf
("p->bÆ™˚:%d\n",
p
->
bÆ™˚
);

741 
‰ì_block
 *
s
;

743 i‡(
r
 =
p
->
À·
) {

744 
bÆ™˚_t
 
b
;

746 i‡–!(
b
 = 
p
->
bÆ™˚
) ) {

747 #ifde‡
DEBUG_AVL


748 ()
	`¥ötf
("p->size: %d\n", 
p
->
size
);

749 ()
	`¥ötf
("p->bÆ™˚: %d\n", 
p
->
bÆ™˚
);

750 ()
	`¥ötf
("p->right-h: %d\n", 
	`check_avl
(
p
,Ö->
right
));

751 ()
	`¥ötf
("p->À· -h: %d\n", 
	`check_avl
(
p
,Ö->
À·
 ));

752 
	`Áke
("growthÖropagation fromÜeft side");

754 
p
->
bÆ™˚
 = -1;

755 } i‡(
b
 < 0) {

756 #ifde‡
DEBUG_AVL


757 ()
	`¥ötf
("p->bÆ™˚:%d\n",
p
->
bÆ™˚
);

759 i‡(
r
->
bÆ™˚
 < 0) {

761 
	`Áke
("R-Rotation");

762 i‡((
p
->
À·
 = 
s
 = 
r
->
right
Ë!
NULL
) {

763 
s
->
∑ª¡
 = 
p
;

765 
r
->
right
 = 
p
;

766 
p
->
bÆ™˚
 = 0;

767 
r
->
bÆ™˚
 = 0;

768 
s
 = 
p
->
∑ª¡
;

769 
p
->
∑ª¡
 = 
r
;

770 i‡((
r
->
∑ª¡
 = 
s
Ë!
NULL
) {

771 i‡–
s
->
À·
 =
p
) {

772 
s
->
À·
 = 
r
;

774 
s
->
right
 = 
r
;

777 
‰ì_åì
 = 
r
;

781 
bÆ™˚_t
 
b2
;

782 
‰ì_block
 *
t
 = 
r
->
right
;

784 #ifde‡
DEBUG_AVL


785 
	`Áke
("LR-Rotation");

786 ()
	`¥ötf
("à%x\n",
t
);

787 ()
	`¥ötf
("r->bÆ™˚:%d\n",
r
->
bÆ™˚
);

789 i‡((
p
->
À·
 = 
s
 = 
t
->
right
Ë!
NULL
) {

790 
s
->
∑ª¡
 = 
p
;

792 
	`Áke
("relocatedÑight subtree");

793 
t
->
right
 = 
p
;

794 i‡((
r
->
right
 = 
s
 = 
t
->
À·
Ë!
NULL
) {

795 
s
->
∑ª¡
 = 
r
;

797 
	`Áke
("relocatedÜeft subtree");

798 
t
->
À·
 = 
r
;

799 
b
 = 
t
->
bÆ™˚
;

800 #ifde‡
NO_BARREL_SHIFT


801 
b
 = -b;

802 
b2
 = 
b
 >> 1;

803 
r
->
bÆ™˚
 = 
b2
;

804 
b
 -
b2
;

805 
p
->
bÆ™˚
 = 
b
;

807 
b2
 = ()
b
 >> 7;

808 
p
->
bÆ™˚
 = 
b2
;

809 
b2
 = -b2 -
b
;

810 
r
->
bÆ™˚
 = 
b2
;

812 
t
->
bÆ™˚
 = 0;

813 
	`Áke
("balances calculated");

814 
s
 = 
p
->
∑ª¡
;

815 
p
->
∑ª¡
 = 
t
;

816 
r
->
∑ª¡
 = 
t
;

817 i‡((
t
->
∑ª¡
 = 
s
Ë!
NULL
) {

818 i‡–
s
->
À·
 =
p
) {

819 
s
->
À·
 = 
t
;

821 
s
->
right
 = 
t
;

824 
‰ì_åì
 = 
t
;

826 #ifde‡
DEBUG_AVL


827 ()
	`¥ötf
("p->bÆ™˚:%d\n",
p
->
bÆ™˚
);

828 ()
	`¥ötf
("r->bÆ™˚:%d\n",
r
->
bÆ™˚
);

829 ()
	`¥ötf
("t->bÆ™˚:%d\n",
t
->
bÆ™˚
);

830 
	`Áke
((
	`do_check_avl
(),"LR-Rotation completed."));

835 
p
->
bÆ™˚
 = 0;

836 
	`Áke
("growth ofÜeft side balancedÅheÇode");

840 
bÆ™˚_t
 
b
;

842 i‡–!(
b
 = 
p
->
bÆ™˚
) ) {

843 
	`Áke
("growthÖropagation fromÑight side");

844 
p
->
bÆ™˚
++;

845 } i‡(
b
 > 0) {

846 i‡(
r
->
bÆ™˚
 > 0) {

848 
	`Áke
("L-Rotation");

849 i‡((
p
->
right
 = 
s
 = 
r
->
À·
Ë!
NULL
) {

850 
s
->
∑ª¡
 = 
p
;

852 
r
->
À·
 = 
p
;

853 
p
->
bÆ™˚
 = 0;

854 
r
->
bÆ™˚
 = 0;

855 
s
 = 
p
->
∑ª¡
;

856 
p
->
∑ª¡
 = 
r
;

857 i‡((
r
->
∑ª¡
 = 
s
Ë!
NULL
) {

858 i‡–
s
->
À·
 =
p
) {

859 
s
->
À·
 = 
r
;

861 
s
->
right
 = 
r
;

864 
‰ì_åì
 = 
r
;

868 
bÆ™˚_t
 
b2
;

869 
‰ì_block
 *
t
 = 
r
->
À·
;

871 #ifde‡
DEBUG_AVL


872 
	`Áke
("RL-Rotation");

873 ()
	`¥ötf
("à%x\n",
t
);

874 ()
	`¥ötf
("r->bÆ™˚:%d\n",
r
->
bÆ™˚
);

876 i‡((
p
->
right
 = 
s
 = 
t
->
À·
Ë!
NULL
) {

877 
s
->
∑ª¡
 = 
p
;

879 
	`Áke
("relocatedÜeft subtree");

880 
t
->
À·
 = 
p
;

881 i‡((
r
->
À·
 = 
s
 = 
t
->
right
Ë!
NULL
) {

882 
s
->
∑ª¡
 = 
r
;

884 
	`Áke
("relocatedÑight subtree");

885 
t
->
right
 = 
r
;

886 
b
 = 
t
->
bÆ™˚
;

887 #ifde‡
NO_BARREL_SHIFT


888 
b
 = -b;

889 
b2
 = 
b
 >> 1;

890 
p
->
bÆ™˚
 = 
b2
;

891 
b
 -
b2
;

892 
r
->
bÆ™˚
 = 
b
;

894 
b2
 = ()
b
 >> 7;

895 
r
->
bÆ™˚
 = 
b2
;

896 
b2
 = -b2 -
b
;

897 
p
->
bÆ™˚
 = 
b2
;

899 
t
->
bÆ™˚
 = 0;

900 
s
 = 
p
->
∑ª¡
;

901 
p
->
∑ª¡
 = 
t
;

902 
r
->
∑ª¡
 = 
t
;

903 i‡((
t
->
∑ª¡
 = 
s
Ë!
NULL
) {

904 i‡–
s
->
À·
 =
p
) {

905 
s
->
À·
 = 
t
;

907 
s
->
right
 = 
t
;

910 
‰ì_åì
 = 
t
;

912 
	`Áke
("RL-Rotation completed.");

916 #ifde‡
DEBUG_AVL


917 ()
	`¥ötf
("p->bÆ™˚: %d\n", 
p
->
bÆ™˚
);

918 ()
	`¥ötf
("p->right-h: %d\n", 
	`check_avl
(
p
,Ö->
right
));

919 ()
	`¥ötf
("p->À· -h: %d\n", 
	`check_avl
(
p
,Ö->
À·
 ));

921 
p
->
bÆ™˚
 = 0;

922 
	`Áke
("growth ofÑight side balancedÅheÇode");

926 
r
 = 
p
;

927 
p
 =Ö->
∑ª¡
;

928 } (
q
 = 
p
Ë!
NULL
);

929 
	`Áke
((
	`do_check_avl
(),"add_to_free_list successful"));

930 
	}
}

934 
	$show_block
(
±r
)

935 
u
 *
±r
;

937 ()
	`¥ötf
("[%c%d: %d] ",(*
±r
 & 
THIS_BLOCK
 ? '+' : '-'),

938 (Ë
±r
, *±∏& 
MASK
);

939 
	}
}

941 
	$show_‰ì_li°
()

943 
u
 *
p
;

944 
p
 = 
‰ì_li°
;

945 
p
) {

946 
	`show_block
(
p
);

947 
p
 = 
	`l_√xt_±r
(p);

949 ()
	`¥ötf
("\n");

950 
	}
}

952 
t_°©
 
	gœrge_‰ì_°©
;

953 
	$ªmove_‰om_‰ì_li°
(
±r
)

954 
u
 *
±r
;

956 
	`cou¡_back
(
œrge_‰ì_°©
, (*
±r
 & 
MASK
) << 2);

958 i‡(
	`l_¥ev_±r
(
±r
))

959 
	`l_√xt_±r
(
	`l_¥ev_±r
(
±r
)) =Ü_next_ptr(ptr);

961 
‰ì_li°
 = 
	`l_√xt_±r
(
±r
);

963 i‡(
	`l_√xt_±r
(
±r
))

964 
	`l_¥ev_±r
(
	`l_√xt_±r
(
±r
)) =Ü_prev_ptr(ptr);

965 
	}
}

967 
	$add_to_‰ì_li°
(
±r
)

968 
u
 *
±r
;

970 
	`puts
();

971 
	`cou¡_up
(
œrge_‰ì_°©
, (*
±r
 & 
MASK
) << 2);

973 #ifde‡
DEBUG


974 i‡(
‰ì_li°
 && 
	`l_¥ev_±r
(free_list))

975 
	`puts
("FreeÜist consistencyÉrror.");

978 
	`l_√xt_±r
(
±r
Ë
‰ì_li°
;

979 i‡(
‰ì_li°
)

980 
	`l_¥ev_±r
(
‰ì_li°
Ë
±r
;

981 
	`l_¥ev_±r
(
±r
) = 0;

982 
‰ì_li°
 = 
±r
;

983 
	}
}

986 
	$buûd_block
(
±r
, 
size
)

987 
u
 *
±r
;

988 
u
 
size
;

990 
u
 
tmp
;

992 
tmp
 = (*
±r
 & 
PREV_BLOCK
Ë| 
size
;

993 *(
±r
+
size
-1) = size;

994 *(
±r
Ë
tmp
;

995 *(
±r
+
size
Ë&~
PREV_BLOCK
;

996 
	}
}

998 
	$m¨k_block
(
±r
)

999 
u
 *
±r
;

1001 *
	`l_√xt_block
(
±r
Ë|
PREV_BLOCK
;

1002 *
±r
 |
THIS_BLOCK
;

1003 
	}
}

1009 
t_°©
 
	gsbrk_°©
;

1011 *
	$esbrk
(
size
)

1012 
u
 
size
;

1014 #ifde‡
SBRK_OK


1015 #i‡
	`deföed
(
__bsdi__
Ë|| deföed(
__NëBSD__
Ë|| deföed(
__FªeBSD__
) || \

1016 
	`deföed
(
__O≥nBSD__
)

1017 *
	`sbrk
();

1018 *
	`brk
(c⁄° *
addr
);

1020 #i‚de‡
löux


1021 *
	`sbrk
();

1023 
	`brk
();

1025 *
cuºít_bªak
=0;

1027 i‡(
cuºít_bªak
 == 0)

1028 
cuºít_bªak
 = 
	`sbrk
(0);

1029 i‡(
	`brk
(
cuºít_bªak
 + 
size
Ë=(
POINTER
)-1)

1031 
	`cou¡_up
(
sbrk_°©
,
size
);

1032 
cuºít_bªak
 +
size
;

1033  
cuºít_bªak
 - 
size
;

1035 
	`cou¡_up
(
sbrk_°©
,
size
);

1036  
	`mÆloc
(
size
);

1038 
	}
}

1040 
t_°©
 
	gœrge_Æloc_°©
;

1042 
	$œrge_mÆloc
(
u
 
size
)

1044 
u
 
ªÆ_size
;

1045 
u
 *
±r
;

1047 
	`Áke
("large_malloc called");

1048 #ifde‡
LARGE_TRACE


1049 ()
	`¥ötf
("ªque°:%d.",
size
);

1051 
size
 = (size + 7) >> 2;

1052 
	`cou¡_up
(
œrge_Æloc_°©
, 
size
 << 2);

1055 
ªåy
:

1057 
±r
 = 0;

1059 #ifde‡
FIT_STYLE_FAST_FIT


1061 
‰ì_block
 *
p
, *
q
, *
r
;

1062 
u
 
mö•lô
;

1063 
u
 
ãmpsize
;

1065 
±r
++;

1066 
mö•lô
 = 
size
 + 
SMALL_BLOCK_MAX
 + 1;

1067 
q
 = 
‰ì_åì
;

1069 
p
 = 
q
;

1070 #ifde‡
DEBUG_AVL


1071 ()
	`¥ötf
("checkedÇodêsizê%d\n",
p
->
size
);

1073 
ãmpsize
 = 
p
->
size
;

1074 i‡(
mö•lô
 < 
ãmpsize
) {

1075 
±r
 = (
u
*)
p
;

1076 i‡((
q
 = 
p
->
À·
Ë!
NULL
) {

1081 } i‡(
size
 > 
ãmpsize
) {

1082 i‡((
q
 = 
p
->
right
Ë!
NULL
) {

1087 i‡(
size
 =
ãmpsize
) {

1088 
±r
 = (
u
*)
p
;

1092 i‡((
q
 = 
p
->
À·
Ë!
NULL
) {

1093 
r
 = 
p
;

1099 
p
 = 
q
;

1100 
ãmpsize
 = 
p
->
size
;

1101 i‡(
size
 < 
ãmpsize
) {

1102 i‡((
q
 = 
p
->
À·
Ë!
NULL
) {

1106 } i‡(
size
 > 
ãmpsize
 ) {

1107 i‡((
q
 = 
p
->
right
Ë!
NULL
) {

1112 
±r
 = (
u
*)
p
;

1113 
found_fô
;

1116 
p
 = 
r
;

1118 
ãmpsize
 = 
p
->
size
;

1119 i‡(
mö•lô
 > 
ãmpsize
) {

1120 i‡((
q
 = 
p
->
right
Ë!
NULL
) {

1122 
p
 = 
q
;

1123 
ãmpsize
 = 
p
->
size
;

1124 i‡(
mö•lô
 <
ãmpsize
) {

1125 
±r
 = (
u
*)
p
;

1126 i‡((
q
 = 
p
->
À·
Ë!
NULL
) {

1131 i‡((
q
 = 
p
->
right
Ë!
NULL
) {

1142 
±r
 = (
u
*)
p
;

1146 
found_fô
:

1147 
±r
--;

1149 
u
 
be°_size
;

1150 
u
 *
fú°
, *
be°
;

1151 #ifde‡
LARGE_TRACE


1152 
u
 
£¨ch_Àngth
=0;

1155 
fú°
 = 
be°
 = 0;

1156 
be°_size
 = 
MASK
;

1157 
±r
 = 
‰ì_li°
;

1159 
±r
) {

1160 
u
 
ãmpsize
;

1161 #ifde‡
LARGE_TRACE


1162 
£¨ch_Àngth
++;

1165 
ãmpsize
 = *
±r
 & 
MASK
;

1166 i‡(
ãmpsize
 =
size
) {

1167 
be°
 = 
fú°
 = 
±r
;

1173 i‡(
ãmpsize
 >
size
 + 
SMALL_BLOCK_MAX
 + 1)

1176 i‡(!
fú°
)

1178 
fú°
 = 
±r
;

1179 i‡(
fô_°yÀ
 =
FIRST_FIT
)

1184 
ãmpsize
 -
size
;

1185 i‡(
ãmpsize
>0 &&Åempsize<=
be°_size
)

1187 
be°
 = 
±r
;

1188 
be°_size
 = 
ãmpsize
;

1191 
±r
 = 
	`l_√xt_±r
(ptr);

1194 #ifde‡
LARGE_TRACE


1195 ()
	`¥ötf
("£¨chÜígth %d\n",
£¨ch_Àngth
);

1197 i‡(
fô_°yÀ
==
BEST_FIT
Ë
±r
 = 
be°
;

1198 
±r
 = 
fú°
;

1203 i‡(!
±r
)

1205 
u
 
chunk_size
, 
block_size
;

1206 
block_size
 = 
size
*
SINT
;

1207 i‡(
block_size
 > 
CHUNK_SIZE
)

1208 
chunk_size
 = 
block_size
;

1210 
chunk_size
 = 
CHUNK_SIZE
;

1212 #ifde‡
SBRK_OK


1213 i‡(!
°¨t_√xt_block
) {

1214 
°¨t_√xt_block
 = (
u
 *Ë
	`esbrk
(
SINT
);

1215 i‡(!
°¨t_√xt_block
)

1216 
	`Áèl
("Couldn't mallocánything\n");

1217 *(
°¨t_√xt_block
Ë
PREV_BLOCK
;

1218 
	`Áke
("AllocatedÜittle fake block");

1221 
±r
 = (
u
 *Ë
	`esbrk
(
chunk_size
);

1223 
±r
 = (
u
 *Ë
	`esbrk
(
chunk_size
+
SINT
);

1225 i‡(
±r
 == 0) {

1228 *
ª£rved_¨ó
;

1229 
¶ow_shut_down_to_do
;

1230 
goög_to_exô
=0;

1231 
mess1
[] = "Temporary out of MEMORY. FreeingÑeserve.\n";

1232 
mess2
[] = "Totally out of MEMORY.\n";

1234 i‡(
goög_to_exô
)

1235 
	`exô
(3);

1236 i‡(
ª£rved_¨ó
) {

1237 
	`s‰ì
(
ª£rved_¨ó
);

1238 
ª£rved_¨ó
 = 0;

1239 ()
	`wrôe
(1, 
mess1
, (mess1)-1);

1240 
¶ow_shut_down_to_do
 = 6;

1241 
f‹˚_m‹e
 = 0;

1242 
ªåy
;

1244 
goög_to_exô
 = 1;

1245 ()
	`wrôe
(1, 
mess2
, (mess2)-1);

1246 ()
	`dump_åa˚
(0);

1247 
	`exô
(2);

1250 #ifde‡
SBRK_OK


1251 
±r
 -= 1;

1253 i‡(
°¨t_√xt_block
 =
±r
) {

1254 
±r
 -= 1;

1255 
chunk_size
 +
SINT
;

1257 *
±r
 = 
PREV_BLOCK
;

1258 
°¨t_√xt_block
 = (
u
*)((*)
±r
 + 
chunk_size
);

1260 
block_size
 = 
chunk_size
 / 
SINT
;

1264 
	`buûd_block
(
±r
,
block_size
);

1265 
	`Áke
("Built memory block description.");

1266 *
	`l_√xt_block
(
±r
)=
THIS_BLOCK
;

1267 
	`add_to_‰ì_li°
(
±r
);

1269 
	`ªmove_‰om_‰ì_li°
(
±r
);

1270 
ªÆ_size
 = *
±r
 & 
MASK
;

1272 i‡(
ªÆ_size
 - 
size
) {

1274 
	`buûd_block
(
±r
+
size
, 
ªÆ_size
-size);

1275 
	`Áke
("BuiltÉmpty block");

1279 i‡(
ªÆ_size
 - 
size
 >
SMALL_BLOCK_MAX
 + 1) {

1280 
	`add_to_‰ì_li°
(
±r
+
size
);

1282 
	`m¨k_block
(
±r
+
size
);

1284 
	`buûd_block
(
±r
, 
size
);

1286 #ifde‡
USE_SWAP


1287 
u£d_mem‹y
 +
size
 << 2;

1290 
	`m¨k_block
(
±r
);

1291 
	`Áke
("builtállocated block");

1292  (*Ë(
±r
 + 1);

1293 
	}
}

1295 
	$œrge_‰ì
(
±r
)

1296 *
±r
;

1298 
u
 
size
, *
p
;

1299 
p
 = (
u
 *Ë
±r
;

1300 
p
-=1;

1301 
size
 = *
p
 & 
MASK
;

1302 i‡(!(*
p
 & 
THIS_BLOCK
))

1303 
	`Áèl
("Freeing free block!\n");

1305 
	`cou¡_back
(
œrge_Æloc_°©
, (
size
 << 2));

1307 i‡(!(*(
p
+
size
Ë& 
THIS_BLOCK
)) {

1308 
	`ªmove_‰om_‰ì_li°
(
p
+
size
);

1309 
size
 +(*(
p
+sizeË& 
MASK
);

1310 *
p
 = (*∞& 
PREV_BLOCK
Ë| 
size
;

1313 i‡(
	`l_¥ev_‰ì
(
p
)) {

1314 
	`ªmove_‰om_‰ì_li°
(
	`l_¥ev_block
(
p
));

1315 
size
 +(*
	`l_¥ev_block
(
p
Ë& 
MASK
);

1316 
p
 = 
	`l_¥ev_block
(p);

1319 
	`buûd_block
(
p
, 
size
);

1321 
	`add_to_‰ì_li°
(
p
);

1322 
	}
}

1324 
POINTER
 
	$§óŒoc
(
p
, 
size
)

1325 
POINTER
 
p
; 
u
 
size
;

1327 *
q
, 
ﬁd_size
;

1328 *
t
;

1330 i‡(
p
 =
NULL
)

1331  
	`mÆloc
(
size
);

1333 
q
 = (*Ë
p
;

1335 #i‡
MALLOC_ALIGN
 > 4

1336  !(
ﬁd_size
 = *--
q
) );

1337 
ﬁd_size
 = ((ﬁd_sizê& 
MASK
)-1)*();

1339 --
q
;

1340 
ﬁd_size
 = ((*
q
 & 
MASK
)-1)*();

1342 i‡(
ﬁd_size
 >
size
)

1343  
p
;

1345 
t
 = 
	`mÆloc
(
size
);

1346 i‡(
t
 == 0)  (*) 0;

1348 ()
	`mem˝y
(
t
, 
p
, 
ﬁd_size
);

1349 
	`‰ì
(
p
);

1350  
t
;

1351 
	}
}

1353 
	#dump_°©
(
°r
Ë()
	`°rˇt
(
mbuf
, så)

	)

1354 
	#dump_°©1
(
°r
,
p
Ë()
	`•rötf
(
smbuf
,°r,p); ()
	`°rˇt
(
mbuf
, smbuf)

	)

1355 
	#dump_°©2
(
°r
,
°©
Ë()
	`•rötf
(
smbuf
,°r,°©.
cou¡î
,°©.
size
); ()
	`°rˇt
(
mbuf
,smbuf)

	)

1358 
	$dump_mÆloc_d©a
()

1360 
mbuf
[1024];

1361 
smbuf
[100];

1363 ()
	`°r˝y
(
mbuf
,"Type Count Space (bytes)\n");

1364 
	`dump_°©2
("sbrkÑeque°s: %8d %10d (a)\n",
sbrk_°©
);

1365 
	`dump_°©2
("œrgêblocks: %8d %10d (b)\n",
œrge_Æloc_°©
);

1366 
	`dump_°©2
("œrgê‰ì blocks: %8d %10d (c)\n\n",
œrge_‰ì_°©
);

1367 
	`dump_°©2
("smÆ»chunks: %8d %10d (d)\n",
smÆl_chunk_°©
);

1368 
	`dump_°©2
("smÆ»blocks: %8d %10d (e)\n",
smÆl_Æloc_°©
);

1369 
	`dump_°©2
("smÆ»‰ì blocks: %8d %10d (f)\n",
smÆl_‰ì_°©
);

1371 
	`dump_°©1
("unu£d from cuºíàchunk %10d (g)\n\n",
unu£d_size
<<2);

1372 
	`dump_°©
(" Small blocksáre stored in small chunks, whicháreállocatedás\n");

1373 
	`dump_°©
("large blocks. Therefore,ÅheÅotalÜarge blocksállocated (b)Ölus\n");

1374 
	`dump_°©
("theÜarge free blocks (c) shouldÉqualÅotal storage from sbrk (a).\n");

1375 
	`dump_°©
("Similarly, (e) + (f) + (g)Équals (d). TheÅotalámount of storage\n");

1376 
	`dump_°©
("wasted is (c) + (f) + (g);Åheámountállocated is (b) - (f) - (g).\n");

1377  
mbuf
;

1378 
	}
}

1383 
POINTER
 
	$ˇŒoc
(
√Àm
, 
sizñ
)

1384 
u
 
√Àm
, 
sizñ
;

1386 *
p
;

1388 i‡(
√Àm
 =0 || 
sizñ
 == 0)

1390 
p
 = 
	`mÆloc
(
√Àm
 * 
sizñ
);

1391 i‡(
p
 == 0)

1393 ()
	`mem£t
(
p
, '\0', 
√Àm
 * 
sizñ
);

1394  
p
;

1395 
	}
}

1403 
	gdebugmÆloc
;

1408 
	$vîify_sÊèbÀ
() {

1409 
u
 *
p
;

1410 
i
, 
j
;

1411 
íd
;

1413 i‡(!
debugmÆloc
)

1415 i‡(
unu£d_size
 > 
SMALL_CHUNK_SIZE
)

1416 
	`≠a
();

1417 
i
=0; i < 
SMALL_BLOCK_MAX
; i++) {

1418 
j
=0, 
p
 = 
sÊèbÀ
[
i
];Ö;Ö = * (
u
 **) (p + 1), j++) {

1419 i‡(
p
 < (
u
 *)&
íd
 ||Ö > (u *) 0xfffff)

1420 
	`≠a
();

1421 i‡(*
p
 - 2 !
i
)

1422 
	`≠a
();

1424 i‡(
p
 >
√xt_unu£d
 &&Ö <Çext_unu£d + (
unu£d_size
>>2))

1425 
	`≠a
();

1427 
p
 = 
‰ì_li°
;

1428 
p
) {

1429 i‡(
p
 >
√xt_unu£d
 &&Ö <Çext_unu£d + (
unu£d_size
>>2))

1430 
	`≠a
();

1431 
p
 = 
	`l_√xt_±r
(p);

1433 
	}
}

1435 
	$vîify_‰ì
(
±r
)

1436 
u
 *
±r
;

1438 
u
 *
p
;

1439 
i
, 
j
;

1441 i‡(!
debugmÆloc
)

1443 
i
=0; i < 
SMALL_BLOCK_MAX
; i++) {

1444 
j
=0, 
p
 = 
sÊèbÀ
[
i
];Ö;Ö = * (
u
 **) (p + 1), j++) {

1445 i‡(*
p
 - 2 !
i
)

1446 
	`≠a
();

1447 i‡(
±r
 >
p
 &&Ötr <Ö + *p)

1448 
	`≠a
();

1449 i‡(
p
 >
±r
 &&Ö <Ötr + *ptr)

1450 
	`≠a
();

1451 i‡(
p
 >
√xt_unu£d
 &&Ö <Çext_unu£d + (
unu£d_size
>>2))

1452 
	`≠a
();

1456 
p
 = 
‰ì_li°
;

1457 
p
) {

1458 i‡(
±r
 >
p
 &&Öå <Ö + (*∞& 
MASK
))

1459 
	`≠a
();

1460 i‡(
p
 >
±r
 &&Ö <Öå + (*±∏& 
MASK
))

1461 
	`≠a
();

1462 i‡(
p
 >
√xt_unu£d
 &&Ö <Çext_unu£d + (
unu£d_size
>>2))

1463 
	`≠a
();

1464 
p
 = 
	`l_√xt_±r
(p);

1466 i‡(
±r
 >
√xt_unu£d
 &&Öå <Çext_unu£d + (
unu£d_size
>>2))

1467 
	`≠a
();

1468 
	}
}

1470 
	$≠a
() {

1471 
i
;

1472 
i
/0;

1473 
	}
}

1475 *
	gªf
;

1476 
	$ã°_mÆloc
(
p
)

1477 *
p
;

1479 i‡(
p
 =
ªf
)

1480 ()
	`¥ötf
("Found 0x%x\n", 
p
);

1481 
	}
}

	@snprintf.c

23 
	~<°d¨g.h
>

24 
	~<°rög.h
>

26 
fmt°r
(*, , , );

27 
fmäum
(, , , , , );

28 
do°r
(*, );

29 
d›r
(*, c⁄° *, 
va_li°
);

31 *
	gouçut
, *
	gíd
;

35 
	$¢¥ötf
(*
°r
, 
size_t
 
cou¡
, c⁄° *
fmt
, ...)

37 
va_li°
 
≠
;

38 
Àn
;

40 
	`va_°¨t
(
≠
, 
fmt
);

41 
Àn
 = 
	`v¢¥ötf
(
°r
, 
cou¡
, 
fmt
, 
≠
);

42 
	`va_íd
(
≠
);

43  
Àn
;

44 
	}
}

47 
	$v¢¥ötf
(*
°r
, 
size_t
 
cou¡
, c⁄° *
fmt
, 
va_li°
 
¨gs
)

49 
°r
[0] = 0;

50 
íd
 = 
°r
 + 
cou¡
 - 1;

51 
	`d›r
(
°r
, 
fmt
, 
¨gs
);

52 i‡(
cou¡
 > 0)

53 
íd
[0] = 0;

54  
	`°æí
(
°r
);

55 
	}
}

58 
	$d›r_outch
(
c
)

60 i‡(
íd
 =0 || 
ouçut
 <Énd)

61 *
ouçut
++ = 
c
;

62 
	}
}

69 
	$d›r
(*
buf„r
, c⁄° *
f‹m©
, 
va_li°
 
¨gs
)

71 
ch
;

72 
vÆue
;

73 
l⁄gÊag
 = 0;

74 
poötÊag
 = 0;

75 
maxwidth
 = 0;

76 *
°rvÆue
;

77 
lju°
;

78 
Àn
;

79 
z∑d
;

81 
ouçut
 = 
buf„r
;

82 (
ch
 = *
f‹m©
++) != '\0') {

83 
ch
) {

85 
lju°
 = 
Àn
 = 
z∑d
 = 
maxwidth
 = 0;

86 
l⁄gÊag
 = 
poötÊag
 = 0;

87 
√xtch
:

88 
ch
 = *
f‹m©
++;

89 
ch
) {

91 
	`do°r
("**end of format**" , 0);

94 
lju°
 = 1;

95 
√xtch
;

97 i‡(
Àn
 =0 && !
poötÊag
)

98 
z∑d
 = '0';

103 i‡(
poötÊag
)

104 
maxwidth
 = maxwidth*10 + 
ch
 - '0';

106 
Àn
 =Üí*10 + 
ch
 - '0';

107 
√xtch
;

109 i‡(
poötÊag
)

110 
maxwidth
 = 
	`va_¨g
(
¨gs
, );

112 
Àn
 = 
	`va_¨g
(
¨gs
, );

113 
√xtch
;

115 
poötÊag
 = 1;

116 
√xtch
;

118 
l⁄gÊag
 = 1;

119 
√xtch
;

122 i‡(
l⁄gÊag
)

123 
vÆue
 = 
	`va_¨g
(
¨gs
, );

125 
vÆue
 = 
	`va_¨g
(
¨gs
, );

126 
	`fmäum
(
vÆue
, 10,0, 
lju°
, 
Àn
, 
z∑d
);

129 i‡(
l⁄gÊag
)

130 
vÆue
 = 
	`va_¨g
(
¨gs
, );

132 
vÆue
 = 
	`va_¨g
(
¨gs
, );

133 
	`fmäum
(
vÆue
, 8,0, 
lju°
, 
Àn
, 
z∑d
);

136 i‡(
l⁄gÊag
)

137 
vÆue
 = 
	`va_¨g
(
¨gs
, );

139 
vÆue
 = 
	`va_¨g
(
¨gs
, );

140 
	`fmäum
(
vÆue
, 10,1, 
lju°
, 
Àn
, 
z∑d
);

143 i‡(
l⁄gÊag
)

144 
vÆue
 = 
	`va_¨g
(
¨gs
, );

146 
vÆue
 = 
	`va_¨g
(
¨gs
, );

147 
	`fmäum
(
vÆue
, 16,0, 
lju°
, 
Àn
, 
z∑d
);

150 i‡(
l⁄gÊag
)

151 
vÆue
 = 
	`va_¨g
(
¨gs
, );

153 
vÆue
 = 
	`va_¨g
(
¨gs
, );

154 
	`fmäum
(
vÆue
,-16,0, 
lju°
, 
Àn
, 
z∑d
);

157 
°rvÆue
 = 
	`va_¨g
(
¨gs
, *);

158 i‡(
maxwidth
 > 0 || !
poötÊag
) {

159 i‡(
poötÊag
 && 
Àn
 > 
maxwidth
)

160 
Àn
 = 
maxwidth
;

161 
	`fmt°r
(
°rvÆue
, 
lju°
, 
Àn
, 
maxwidth
);

165 
ch
 = 
	`va_¨g
(
¨gs
, );

166 
	`d›r_outch
(
ch
);

169 
	`d›r_outch
(
ch
);

172 
	`do°r
("???????" , 0);

176 
	`d›r_outch
(
ch
);

180 *
ouçut
 = 0;

181 
	}
}

184 
	$fmt°r
(*
vÆue
, 
lju°
, 
Àn
, 
maxwidth
)

186 
∑dÀn
, 
Àngth
;

188 i‡(
vÆue
 == 0)

189 
vÆue
 = "<NULL>";

191 
Àngth
 = 
	`°æí
(
vÆue
);

192 i‡(
Àngth
 > 
maxwidth
 && maxwidth)

193 
Àngth
 = 
maxwidth
;

194 
∑dÀn
 = 
Àn
 - 
Àngth
;

195 i‡(
∑dÀn
 < 0)

196 
∑dÀn
 = 0;

197 i‡(
lju°
)

198 
∑dÀn
 = -padlen;

199 
∑dÀn
 > 0) {

200 
	`d›r_outch
(' ');

201 --
∑dÀn
;

203 
	`do°r
(
vÆue
, 
maxwidth
);

204 
∑dÀn
 < 0) {

205 
	`d›r_outch
(' ');

206 ++
∑dÀn
;

208 
	}
}

211 
	$fmäum
(
vÆue
, 
ba£
, 
dosign
, 
lju°
, 
Àn
, 
z∑d
)

213 
signvÆue
 = 0;

214 
uvÆue
;

215 
c⁄vît
[20];

216 
∂a˚
 = 0;

217 
∑dÀn
 = 0;

218 
ˇps
 = 0;

220 
uvÆue
 = 
vÆue
;

221 i‡(
dosign
) {

222 i‡(
vÆue
 < 0) {

223 
signvÆue
 = '-';

224 
uvÆue
 = -
vÆue
;

227 i‡(
ba£
 < 0) {

228 
ˇps
 = 1;

229 
ba£
 = -base;

232 
c⁄vît
[
∂a˚
++] = (
ˇps
 ? "0123456789ABCDEF" : "0123456789abcdef")

233 [()(
uvÆue
 % ()
ba£
)];

234 
uvÆue
 = (uvÆuê/ ()
ba£
);

235 } 
uvÆue
);

236 
c⁄vît
[
∂a˚
] = 0;

237 
∑dÀn
 = 
Àn
 - 
∂a˚
;

238 i‡(
∑dÀn
 < 0)

239 
∑dÀn
 = 0;

240 i‡(
lju°
)

241 
∑dÀn
 = -padlen;

242 i‡(
z∑d
 && 
∑dÀn
 > 0) {

243 i‡(
signvÆue
) {

244 
	`d›r_outch
(
signvÆue
);

245 --
∑dÀn
;

246 
signvÆue
 = 0;

248 
∑dÀn
 > 0) {

249 
	`d›r_outch
(
z∑d
);

250 --
∑dÀn
;

253 
∑dÀn
 > 0) {

254 
	`d›r_outch
(' ');

255 --
∑dÀn
;

257 i‡(
signvÆue
)

258 
	`d›r_outch
(
signvÆue
);

259 
∂a˚
 > 0)

260 
	`d›r_outch
(
c⁄vît
[--
∂a˚
]);

261 
∑dÀn
 < 0) {

262 
	`d›r_outch
(' ');

263 ++
∑dÀn
;

265 
	}
}

268 
	$do°r
(*
°r
, 
cut
)

270 i‡(
cut
)

271 *
°r
 && 
cut
-- > 0)

272 
	`d›r_outch
(*
°r
++);

274 *
°r
)

275 
	`d›r_outch
(*
°r
++);

276 
	}
}

	@sprintf.c

52 
	~<°dio.h
>

53 
	~<°rög.h
>

54 
	~<sys/ty≥s.h
>

56 
	~"c⁄fig.h
"

57 
	~"löt.h
"

58 
	~"°dio.h
"

59 
	~"öãΩªt.h
"

60 
	~"m≠pög.h
"

61 
	~"obje˘.h
"

62 
	~"£¡.h
"

63 
	~"simuœã.h
"

64 
	~"m°rög.h
"

66 
	~"ölöe_svÆue.h
"

72 #unde‡
RETURN_ERROR_MESSAGES


75 *
°rög_c›y
(*);

76 
add_ödít
(**, 
size_t
 *, );

78 
obje˘
 *
cuºít_obje˘
;

80 
	tf‹m©_öfo
;

110 
	#INFO_T
 0xF

	)

111 
	#INFO_T_ERROR
 0x1

	)

112 
	#INFO_T_NULL
 0x2

	)

113 
	#INFO_T_LPC
 0x3

	)

114 
	#INFO_T_STRING
 0x4

	)

115 
	#INFO_T_FLOAT_E
 0x05

	)

116 
	#INFO_T_FLOAT_F
 0x06

	)

117 
	#INFO_T_FLOAT_G
 0x07

	)

118 
	#INFO_T_INT
 0x8

	)

119 
	#INFO_T_CHAR
 0x9

	)

120 
	#INFO_T_OCT
 0xA

	)

121 
	#INFO_T_HEX
 0xB

	)

122 
	#INFO_T_C_HEX
 0xC

	)

124 
	#INFO_J
 0x30

	)

125 
	#INFO_J_CENTRE
 0x10

	)

126 
	#INFO_J_LEFT
 0x20

	)

128 
	#INFO_PP
 0xC0

	)

129 
	#INFO_PP_SPACE
 0x40

	)

130 
	#INFO_PP_PLUS
 0x80

	)

132 
	#INFO_ARRAY
 0x100

	)

133 
	#INFO_COLS
 0x200

	)

134 
	#INFO_TABLE
 0x400

	)

136 
	#BUFF_SIZE
 10000

	)

138 
	#ERROR
(
x
Ë
	`l⁄gjmp
(
îr‹_jmp
, x)

	)

139 
	#ERR_BUFF_OVERFLOW
 0x1

	)

140 
	#ERR_TO_FEW_ARGS
 0x2

	)

141 
	#ERR_INVALID_STAR
 0x3

	)

142 
	#ERR_PREC_EXPECTED
 0x4

	)

143 
	#ERR_INVALID_FORMAT_STR
 0x5

	)

144 
	#ERR_INCORRECT_ARG_S
 0x6

	)

145 
	#ERR_CST_REQUIRES_FS
 0x7

	)

146 
	#ERR_BAD_INT_TYPE
 0x8

	)

147 
	#ERR_UNDEFINED_TYPE
 0x9

	)

148 
	#ERR_QUOTE_EXPECTED
 0xA

	)

149 
	#ERR_UNEXPECTED_EOS
 0xB

	)

150 
	#ERR_NULL_PS
 0xC

	)

151 
	#ERR_BAD_FLOAT_TYPE
 0xD

	)

153 
	#ADD_CHAR
(
x
) {\

154 
buff
[
bpos
++] = 
x
;\

155 i‡(
bpos
 > 
BUFF_SIZE
Ë
	`ERROR
(
ERR_BUFF_OVERFLOW
); \

156 
cuΩos
++;\

157 }

	)

159 
	#GET_NEXT_ARG
 {\

160 i‡(++
¨g
 >
¨gc
Ë
	`ERROR
(
ERR_TO_FEW_ARGS
); \

161 
ˇrg
 = (
¨gv
 + 
¨g
);\

162 }

	)

164 
	#SAVE_CHAR
(
poöãr
) {\

165 
ßvech¨s
 *
√w
;\

166 
√w
 = (
ßvech¨s
 *)
	`xÆloc
((savechars));\

167 
√w
->
wh©
 = *(
poöãr
);\

168 
√w
->
whîe
 = 
poöãr
;\

169 
√w
->
√xt
 = 
ßves
;\

170 
ßves
 = 
√w
;\

171 }

	)

176 
	sSaveCh¨s


178 
	mwh©
;

179 *
	mwhîe
;

180 
SaveCh¨s
 *
	m√xt
;

181 } 
	tßvech¨s
;

183 
	sCﬁumnSœshTabÀ


185 
	uCSTD©a


187 *
	mcﬁ
;

188 **
	mèb
;

189 } 
	md
;

190 
	mnocﬁs
;

191 *
	m∑d
;

192 
	m°¨t
;

193 
	msize
;

194 
	m¥ec
;

195 
f‹m©_öfo
 
	möfo
;

196 
CﬁumnSœshTabÀ
 *
	m√xt
;

197 } 
	tc°
;

199 
	gbuff
[
BUFF_SIZE
];

200 
	gbpos
;

201 
	gcuΩos
;

202 
jmp_buf
 
	gîr‹_jmp
;

203 
svÆue
 *
	g˛ón
;

204 
ßvech¨s
 *
	gßves
;

205 
	gˇŒ_ma°î_ob
;

211 
	$°ødd
(**
d°
, 
size_t
 *
size
, *
add
)

213 
i
;

214 *
tmp
;

216 i‡((
i
 = (
	`°æí
(*
d°
Ë+ såÀn(
add
))Ë>*
size
)

218 *
size
 +
i
 + 1;

219 i‡(*
size
 >
BUFF_SIZE
)

220 
	`ERROR
(
ERR_BUFF_OVERFLOW
);

221 
tmp
 = 
	`Æloˇã_m°rög
((
size_t
)*
size
);

222 ()
	`°r˝y
(
tmp
, *
d°
);

223 
	`‰ì_m°rög
(*
d°
);

224 *
d°
 = 
tmp
;

226 ()
	`°rˇt
(*
d°
, 
add
);

227 
	}
}

230 
	$numadd
(**
d°
, 
size_t
 *
size
, 
num
)

232 
i
, 
j
, 
nve
;

233 *
tmp
;

235 i‡(
num
 < 0)

237 
num
 *= -1;

238 
nve
 = 1;

241 
nve
 = 0;

243 
i
 = 10, 
j
 = 0; 
num
 >= i && j < 30; i *= 10, j++)

245 
i
 = 
	`°æí
(*
d°
Ë+ 
nve
;

246 i‡((
i
 + 
j
Ë>*
size
)

248 *
size
 +
i
 + 
j
 + 1;

249 
tmp
 = 
	`Æloˇã_m°rög
((
size_t
)*
size
);

250 i‡(*
size
 >
BUFF_SIZE
)

251 
	`ERROR
(
ERR_BUFF_OVERFLOW
);

252 ()
	`°r˝y
(
tmp
, *
d°
);

253 
	`‰ì_m°rög
(*
d°
);

254 *
d°
 = 
tmp
;

256 i‡(
nve
)

257 (*
d°
)[
i
 - 1] = '-';

258 (*
d°
)[
i
 + 
j
 + 1] = '\0';

259  ; 
j
 >0; j--, 
num
 /= 10)

260 (*
d°
)[
i
 + 
j
] = (
num
 % 10) + '0';

261 
	}
}

268 
	$add_ödít
(**
d°
, 
size_t
 *
size
, 
ödít
)

270 
i
;

271 *
tmp
;

273 
i
 = 
	`°æí
(*
d°
);

274 i‡((
i
 + 
ödít
Ë>*
size
)

276 *
size
 +
i
 + 
ödít
 + 1;

277 i‡(*
size
 >
BUFF_SIZE
)

278 
	`ERROR
(
ERR_BUFF_OVERFLOW
);

279 
tmp
 = 
	`Æloˇã_m°rög
(*
size
);

280 ()
	`°r˝y
(
tmp
, *
d°
);

281 
	`‰ì_m°rög
(*
d°
);

282 *
d°
 = 
tmp
;

284  ; 
ödít
; indent--)

285 (*
d°
)[
i
++] = ' ';

286 (*
d°
)[
i
] = '\0';

287 
	}
}

295 
	$svÆue_to_°rög
(
svÆue
 *
obj
, **
°r
, 
size_t
 
size
, 
ödít
,

296 
åaûög
)

298 
i
;

299 i‡(
ödít
 >= 0)

300 
	`add_ödít
(
°r
, &
size
, 
ödít
);

302 
ödít
 = -indent;

304 
obj
->
ty≥
)

306 
T_INVALID
:

307 
	`°ødd
(
°r
,&
size
,"T_INVALID");

309 
T_LVALUE
:

310 
	`°ødd
(
°r
, &
size
, "lvalue: ");

311 
	`svÆue_to_°rög
(
obj
->
u
.
lvÆue
, 
°r
, 
size
, - 
ödít
 - 2, 
åaûög
);

313 
T_NUMBER
:

314 
	`numadd
(
°r
, &
size
, 
obj
->
u
.
numbî
);

316 
T_FLOAT
:

318 
buf„r
[1024];

319 ()
	`•rötf
(
buf„r
,"%8e",
obj
->
u
.
ªÆ
);

320 
	`°ødd
(
°r
,&
size
,
buf„r
);

323 
T_STRING
:

324 
	`°ødd
(
°r
, &
size
, "\"");

325 
	`°ødd
(
°r
, &
size
, 
obj
->
u
.
°rög
);

326 
	`°ødd
(
°r
, &
size
, "\"");

328 
T_POINTER
:

329 i‡(!(
obj
->
u
.
vec
->
size
))

331 
	`°ødd
(
°r
, &
size
, "({ })");

335 
	`°ødd
(
°r
, &
size
, "({ /* sizeof() == ");

336 
	`numadd
(
°r
, &
size
, 
obj
->
u
.
vec
->size);

337 
	`°ødd
(
°r
, &
size
, " */\n");

338 
i
 = 0; i < (
obj
->
u
.
vec
->
size
) - 1; i++)

339 
	`svÆue_to_°rög
(&(
obj
->
u
.
vec
->
ôem
[
i
]), 
°r
, 
size
,

340 
ödít
 + 2 , 1);

341 
	`svÆue_to_°rög
(&(
obj
->
u
.
vec
->
ôem
[
i
]), 
°r
, 
size
, 
ödít
 + 2, 0);

342 
	`°ødd
(
°r
, &
size
, " })");

345 
T_OBJECT
:

346 i‡(
obj
->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
)

347 
	`numadd
(
°r
, &
size
, 0);

350 
svÆue
 *
ãmp
;

352 
	`°ødd
(
°r
, &
size
, 
obj
->
u
.
ob
->
«me
);

353 i‡(
ˇŒ_ma°î_ob
)

355 
	`push_obje˘
(
obj
->
u
.
ob
);

356 
ãmp
 = 
	`≠∂y_ma°î_ob
(
M_OBJECT_NAME
, 1);

357 i‡(
ãmp
 && (ãmp->
ty≥
 =
T_STRING
))

359 
	`°ødd
(
°r
, &
size
, " (\"");

360 
	`°ødd
(
°r
, &
size
, 
ãmp
->
u
.
°rög
);

361 
	`°ødd
(
°r
, &
size
, "\")");

366 
T_MAPPING
:

367 i‡(!(
obj
->
u
.
m≠
->
ˇrd
))

369 
	`°ødd
(
°r
, &
size
, "([ ])");

373 
≠aú
 *
∑ú
 = 0;

374 
j
;

375 
	`°ødd
(
°r
, &
size
, "([ /* sizeof() == ");

376 
	`numadd
(
°r
, &
size
, 
obj
->
u
.
m≠
->
ˇrd
);

377 
	`°ødd
(
°r
, &
size
, " */\n");

378 
j
 = 
obj
->
u
.
m≠
->
size
 - 1; obj->u.m≠->
∑ús
[j] == 0 && j >= 0; j--);

379 
i
 = 0; i <
j
; i++)

381 
∑ú
 = 
obj
->
u
.
m≠
->
∑ús
[
i
];

382 (
i
 !
j
Ë? 
∑ú
 :Öaú->
√xt
;Öair =Öair->next)

384 
	`svÆue_to_°rög
(&(
∑ú
->
¨g
), 
°r
, 
size
, 
ödít
 + 2, 0);

385 
	`°ødd
(
°r
, &
size
, " : ");

386 
	`svÆue_to_°rög
(&(
∑ú
->
vÆ
), 
°r
, 
size
, -
ödít
 - 2, 1);

389 i‡(
∑ú
)

391 
	`svÆue_to_°rög
(&(
∑ú
->
¨g
), 
°r
, 
size
, 
ödít
 + 2, 0);

392 
	`°ødd
(
°r
, &
size
, " : ");

393 
	`svÆue_to_°rög
(&(
∑ú
->
vÆ
), 
°r
, 
size
, -
ödít
 - 2, 0);

395 
	`°ødd
(
°r
, &
size
, " ])");

399 
T_FUNCTION
:

400 
	`°ødd
(
°r
, &
size
, "<<FUNCTION ");

401 
	`°ødd
(
°r
, &
size
, 
	`show_˛osuª
(
obj
->
u
.
func
));

402 
	`°ødd
(
°r
, &
size
, ">>");

406 
	`°ødd
(
°r
, &
size
, "!ERROR: GARBAGE SVALUE!");

408 i‡(
åaûög
Ë
	`°ødd
(
°r
, &
size
, ",\n");

409 
	}
}

418 
	$add_ju°ifõd
(*
°r
, *
∑d
, 
fs
, 
f‹m©_öfo
 
föfo
, 
åaûög
)

420 
size_t
 
Àn
;

421 
i
;

423 
Àn
 = 
	`°æí
(
°r
);

424 
föfo
 & 
INFO_J
)

426 
INFO_J_LEFT
:

427 
i
 = 0; i < 
Àn
; i++)

428 
	`ADD_CHAR
(
°r
[
i
]);

429 
fs
 -
Àn
;

430 
Àn
 = 
	`°æí
(
∑d
);

431 i‡(
åaûög
)

432 
i
 = 0; 
fs
 > 0; i++, fs--)

434 i‡(
∑d
[
i
%
Àn
] == '\\')

435 
i
++;

436 
	`ADD_CHAR
(
∑d
[
i
 % 
Àn
]);

439 
INFO_J_CENTRE
:

441 
j
, 
l
;

443 
l
 = 
	`°æí
(
∑d
);

444 
j
 = (
fs
 - 
Àn
) / 2 + (fs -Üen) % 2;

445 
i
 = 0; i < 
j
; i++)

447 i‡(
Àn
 && 
∑d
[
i
 %Üen] == '\\')

449 
i
++;

450 
j
++;

452 
	`ADD_CHAR
(
∑d
[
i
 % 
l
]);

454 
i
 = 0; i < 
Àn
; i++)

455 
	`ADD_CHAR
(
°r
[
i
]);

456 
j
 = (
fs
 - 
Àn
) / 2;

457 i‡(
åaûög
)

458 
i
 = 0; i < 
j
; i++)

460 i‡(
∑d
[
i
 % 
l
] == '\\')

462 
i
++;

463 
j
++;

465 
	`ADD_CHAR
(
∑d
[
i
 % 
l
]);

470 
l
;

472 
fs
 -
Àn
;

473 
l
 = 
	`°æí
(
∑d
);

474 
i
 = 0; i < 
fs
; i++)

476 i‡(
∑d
[
i
 % 
l
] == '\\')

478 
i
++;

479 
fs
++;

481 
	`ADD_CHAR
(
∑d
[
i
 % 
l
]);

483 
i
 = 0; i < 
Àn
; i++)

484 
	`ADD_CHAR
(
°r
[
i
]);

487 
	}
}

496 
	$add_cﬁumn
(
c°
 **
cﬁumn
, 
åaûög
)

498 
d⁄e
;

499 
ßve
;

501 
d⁄e
 = 0;

502 (
d⁄e
 < (*
cﬁumn
)->
¥ec
) &&

503 ((*
cﬁumn
)->
d
.
cﬁ
)[
d⁄e
] &&

504 (((*
cﬁumn
)->
d
.
cﬁ
)[
d⁄e
] != '\n');

505 
d⁄e
++)

507 i‡(((*
cﬁumn
)->
d
.
cﬁ
)[
d⁄e
] && (((*column)->d.col)[done] != '\n'))

509 
ßve
 = 
d⁄e
;

510  ; 
d⁄e
 && (((*
cﬁumn
)->
d
.
cﬁ
)[done] != ' '); done--)

515 i‡(!
d⁄e
)

516 
d⁄e
 = 
ßve
;

518 
ßve
 = ((*
cﬁumn
)->
d
.
cﬁ
)[
d⁄e
];

519 ((*
cﬁumn
)->
d
.
cﬁ
)[
d⁄e
] = '\0';

520 
	`add_ju°ifõd
(((*
cﬁumn
)->
d
.
cﬁ
), (*cﬁumn)->
∑d
, (*cﬁumn)->
size
,

521 (*
cﬁumn
)->
öfo
,

522 (
åaûög
 || ((*
cﬁumn
)->
√xt
)));

523 ((*
cﬁumn
)->
d
.
cﬁ
)[
d⁄e
] = 
ßve
;

524 ((*
cﬁumn
)->
d
.
cﬁ
Ë+
d⁄e
;

529 i‡(!(*((*
cﬁumn
)->
d
.
cﬁ
)) || !(*(++((*column)->d.col))))

531 
c°
 *
ãmp
;

532 
ªt
;

534 i‡(*(((*
cﬁumn
)->
d
.
cﬁ
) - 1) == '\n')

535 
ªt
 = 2;

537 
ªt
 = 1;

538 
ãmp
 = (*
cﬁumn
)->
√xt
;

539 
	`‰ì
((*)(*
cﬁumn
));

540 (*
cﬁumn
Ë
ãmp
;

541  
ªt
;

544 
	}
}

552 
	$add_èbÀ
(
c°
 **
èbÀ
, 
åaûög
)

554 
ßve
;

555 
d⁄e
, 
i
;

556 
	#TAB
 (*
èbÀ
)

	)

558 
i
 = 0; i < 
TAB
->
nocﬁs
 && (TAB->
d
.
èb
[i]); i++)

560 
d⁄e
 = 0; ((
TAB
->
d
.
èb
[
i
])[done]) &&

561 ((
TAB
->
d
.
èb
[
i
])[
d⁄e
] != '\n'); done++)

563 
ßve
 = (
TAB
->
d
.
èb
[
i
])[
d⁄e
];

564 (
TAB
->
d
.
èb
[
i
])[
d⁄e
] = '\0';

565 
	`add_ju°ifõd
((
TAB
->
d
.
èb
[
i
]), TAB->
∑d
, TAB->
size
, TAB->
öfo
,

566 (
åaûög
 || (
i
 < 
TAB
->
nocﬁs
-1Ë|| (TAB->
√xt
)));

567 (
TAB
->
d
.
èb
[
i
])[
d⁄e
] = 
ßve
;

568 (
TAB
->
d
.
èb
[
i
]Ë+
d⁄e
;

569 i‡(!(*(
TAB
->
d
.
èb
[
i
])) || !(*(++(TAB->d.tab[i]))))

570 (
TAB
->
d
.
èb
[
i
]) = 0;

572 i‡(
åaûög
 && 
i
 < 
TAB
->
nocﬁs
)

573  ; 
i
 < 
TAB
->
nocﬁs
; i++)

574 
d⁄e
 = 0; d⁄ê< 
TAB
->
size
; done++)

575 
	`ADD_CHAR
(' ');

576 i‡(!
TAB
->
d
.
èb
[0])

578 
c°
 *
ãmp
;

580 
ãmp
 = 
TAB
->
√xt
;

581 i‡(
TAB
->
d
.
èb
)

582 
	`‰ì
((*Ë
TAB
->
d
.
èb
);

583 
	`‰ì
((*Ë
TAB
);

584 
TAB
 = 
ãmp
;

588 
	}
}

598 
	$°rög_¥öt_f‹m©ãd
(
ˇŒ_ma°î
, *
f‹m©_°r
, 
¨gc
, 
svÆue
 *
¨gv
)

600 
f‹m©_öfo
 
föfo
;

601 
c°
 *
c°s
;

602 
svÆue
 *
ˇrg
;

603 vﬁ©ûê
√Àmno
;

604 
Âos
;

605 
¨g
;

606 
fs
;

607 
¥ec
;

608 
i
;

609 *
∑d
;

611 
√Àmno
 = 0;

612 
ˇŒ_ma°î_ob
 = 
ˇŒ_ma°î
;

613 i‡((
i
 = 
	`£tjmp
(
îr‹_jmp
)) != 0) {

614 *
îr
 = 
NULL
;

616 i‡(
˛ón
)

618 
	`‰ì_svÆue
(
˛ón
);

619 
	`‰ì
(
˛ón
);

620 
˛ón
 = 
NULL
;

622 
ßves
)

624 
ßvech¨s
 *
tmp
;

626 *
ßves
->
whîe
 = saves->
wh©
;

627 
tmp
 = 
ßves
;

628 
ßves
 = saves->
√xt
;

629 
	`‰ì
(
tmp
);

631 
i
)

633 
ERR_BUFF_OVERFLOW
:

634 
îr
 = "BUFF_SIZE overflowed...";

636 
ERR_TO_FEW_ARGS
:

637 
îr
 = "Moreárguments specifiedÅhanÖassed.";

639 
ERR_INVALID_STAR
:

640 
îr
 = "IncorrectárgumentÅypeÅo *.";

642 
ERR_PREC_EXPECTED
:

643 
îr
 = "ExpectedÖrecisionÇot found.";

645 
ERR_INVALID_FORMAT_STR
:

646 
îr
 = "Error in format string.";

648 
ERR_INCORRECT_ARG_S
:

649 
îr
 = "IncorrectárgumentÅoÅype %s";

651 
ERR_CST_REQUIRES_FS
:

652 
îr
 = "Column/table modeÑequiresá field size.";

654 
ERR_BAD_INT_TYPE
:

655 
îr
 = "!feature - bad integerÅype!";

657 
ERR_UNDEFINED_TYPE
:

658 
îr
 = "!feature - undefinedÅype!";

660 
ERR_QUOTE_EXPECTED
:

661 
îr
 = "QuoteÉxpected in format string.";

663 
ERR_UNEXPECTED_EOS
:

664 
îr
 = "UnexpectedÉnd of format string.";

666 
ERR_NULL_PS
:

667 
îr
 = "NullÖad string specified.";

669 
ERR_BAD_FLOAT_TYPE
:

670 
îr
 = "!feature - bad floatÅype!";

673 #ifde‡
RETURN_ERROR_MESSAGES


674 ()
	`•rötf
(
buff
,

675 "ERROR: (sÌrötf(): !„©uª - undeföedÉº‹ 0x%X !\n", 
i
);

676 ()
	`Ârötf
(
°dîr
, "%s:%s: %s", 
cuºít_obje˘
->
«me
,

677 
	`gë_§ccode_posôi⁄_if_™y
(), 
buff
);

678  
buff
;

680 
	`îr‹
("ERROR: (sÌrötf(): !„©uª - undeföedÉº‹ 0x%X !\n", 
i
);

683 #ifde‡
RETURN_ERROR_MESSAGES


684 ()
	`•rötf
(
buff
, "ERROR: (sÌrötf(): %s\n", 
îr
);

685 ()
	`Ârötf
(
°dîr
, "%s:%s: %s", 
cuºít_obje˘
->
«me
,

686 
	`gë_§ccode_posôi⁄_if_™y
(), 
buff
);

687  
buff
;

689 
	`îr‹
("ERROR: (sÌrötf(): %s\n", 
îr
);

692 
¨g
 = ()-1;

693 
bpos
 = 0;

694 
cuΩos
 = 0;

695 
c°s
 = 0;

696 
Âos
 = 0 ;; fpos++)

698 i‡((
f‹m©_°r
[
Âos
] == '\n') || (!format_str[fpos]))

700 
cﬁumn_°©
 = 0;

702 i‡(!
c°s
)

704 i‡(!
f‹m©_°r
[
Âos
])

706 
	`ADD_CHAR
('\n');

707 
cuΩos
 = 0;

710 
	`ADD_CHAR
('\n');

711 
cuΩos
 = 0;

712 
c°s
)

714 
c°
 **
ãmp
;

716 
ãmp
 = &
c°s
;

717 *
ãmp
)

719 i‡((*
ãmp
)->
öfo
 & 
INFO_COLS
)

721 i‡(*((*
ãmp
)->
d
.
cﬁ
-1) != '\n')

722 *((*
ãmp
)->
d
.
cﬁ
) == ' ')

723 (*
ãmp
)->
d
.
cﬁ
++;

724 
i
 = 
cuΩos
; i < (*
ãmp
)->
°¨t
; i++)

725 
	`ADD_CHAR
(' ');

726 
cﬁumn_°©
 = 
	`add_cﬁumn
(
ãmp
, 0);

727 i‡(!
cﬁumn_°©
)

728 
ãmp
 = &((*ãmp)->
√xt
);

732 
i
 = 
cuΩos
; i < (*
ãmp
)->
°¨t
; i++)

733 
	`ADD_CHAR
(' ');

734 i‡(!
	`add_èbÀ
(
ãmp
, 0))

735 
ãmp
 = &((*ãmp)->
√xt
);

738 i‡(
c°s
 || 
f‹m©_°r
[
Âos
] == '\n')

739 
	`ADD_CHAR
('\n');

740 
cuΩos
 = 0;

742 i‡(
cﬁumn_°©
 == 2)

743 
	`ADD_CHAR
('\n');

744 i‡(!
f‹m©_°r
[
Âos
])

748 i‡(
f‹m©_°r
[
Âos
] == '%')

750 i‡(
f‹m©_°r
[
Âos
+1] == '%')

752 
	`ADD_CHAR
('%');

753 
Âos
++;

756 
GET_NEXT_ARG
;

757 
fs
 = 0;

758 
¥ec
 = 0;

759 
∑d
 = " ";

760 
föfo
 = 0;

761 
Âos
++; !(
föfo
 & 
INFO_T
); fpos++)

763 i‡(!
f‹m©_°r
[
Âos
])

765 
föfo
 |
INFO_T_ERROR
;

768 i‡(((
f‹m©_°r
[
Âos
] >= '0') && (format_str[fpos] <= '9'))

769 || (
f‹m©_°r
[
Âos
] == '*'))

771 i‡(
¥ec
 == -1) {

772 i‡(
f‹m©_°r
[
Âos
] == '*')

774 i‡(
ˇrg
->
ty≥
 !
T_NUMBER
)

775 
	`ERROR
(
ERR_INVALID_STAR
);

776 
¥ec
 = 
ˇrg
->
u
.
numbî
;

777 
GET_NEXT_ARG
;

780 
¥ec
 = 
f‹m©_°r
[
Âos
] - '0';

781 
Âos
++;

782 (
f‹m©_°r
[
Âos
] >= '0') &&

783 (
f‹m©_°r
[
Âos
] <= '9'); fpos++)

785 
¥ec
 =Öªc*10 + 
f‹m©_°r
[
Âos
] - '0';

790 i‡((
f‹m©_°r
[
Âos
] == '0') &&

791 (((
f‹m©_°r
[
Âos
+1] >= '1') &&

792 (
f‹m©_°r
[
Âos
+1] <= '9')) ||

793 (
f‹m©_°r
[
Âos
+1] == '*')))

794 
∑d
 = "0";

797 i‡(
f‹m©_°r
[
Âos
] == '*')

799 i‡(
ˇrg
->
ty≥
 !
T_NUMBER
)

800 
	`ERROR
(
ERR_INVALID_STAR
);

801 
fs
 = 
ˇrg
->
u
.
numbî
;

802 i‡(
¥ec
 == -2)

803 
¥ec
 = 
fs
;

804 
GET_NEXT_ARG
;

807 
fs
 = 
f‹m©_°r
[
Âos
] - '0';

809 
Âos
++;

810 (
f‹m©_°r
[
Âos
]>='0') &&

811 (
f‹m©_°r
[
Âos
]<='9'); fpos++)

813 
fs
 = fs*10 + 
f‹m©_°r
[
Âos
] - '0';

815 i‡(
¥ec
 == -2)

817 
¥ec
 = 
fs
;

820 
Âos
--;

823 
f‹m©_°r
[
Âos
])

826 
föfo
 |
INFO_PP_SPACE
;

828 '+': 
föfo
 |
INFO_PP_PLUS
; ;

829 '-': 
föfo
 |
INFO_J_LEFT
; ;

830 '|': 
föfo
 |
INFO_J_CENTRE
; ;

831 '@': 
föfo
 |
INFO_ARRAY
; ;

832 '=': 
föfo
 |
INFO_COLS
; ;

833 '#': 
föfo
 |
INFO_TABLE
; ;

834 '.': 
¥ec
 = -1; ;

835 ':': 
¥ec
 = -2; ;

836 '%': 
föfo
 |
INFO_T_NULL
; ;

837 'O': 
föfo
 |
INFO_T_LPC
; ;

838 's': 
föfo
 |
INFO_T_STRING
; ;

839 'd': 
föfo
 |
INFO_T_INT
; ;

840 'i': 
föfo
 |
INFO_T_INT
; ;

841 'c': 
föfo
 |
INFO_T_CHAR
; ;

842 'o': 
föfo
 |
INFO_T_OCT
; ;

843 'x': 
föfo
 |
INFO_T_HEX
; ;

844 'X': 
föfo
 |
INFO_T_C_HEX
; ;

845 'e': 
föfo
 |
INFO_T_FLOAT_E
; ;

846 'f': 
föfo
 |
INFO_T_FLOAT_F
; ;

847 'g': 
föfo
 |
INFO_T_FLOAT_G
; ;

849 
∑d
 = &(
f‹m©_°r
[++
Âos
]);

852 i‡(!
f‹m©_°r
[
Âos
])

853 
	`ERROR
(
ERR_UNEXPECTED_EOS
);

854 i‡(
f‹m©_°r
[
Âos
] == '\\')

856 
Âos
 += 2;

859 i‡(
f‹m©_°r
[
Âos
] == '\'')

861 i‡(
f‹m©_°r
+
Âos
 =
∑d
)

862 
	`ERROR
(
ERR_NULL_PS
);

863 
	`SAVE_CHAR
(
f‹m©_°r
 + 
Âos
);

864 
f‹m©_°r
[
Âos
] = '\0';

867 
Âos
++;

870 : 
föfo
 |
INFO_T_ERROR
;

873 i‡(
¥ec
 < 0)

874 
	`ERROR
(
ERR_PREC_EXPECTED
);

878 i‡(
föfo
 & 
INFO_ARRAY
)

880 i‡(
ˇrg
->
ty≥
 !
T_POINTER
 || c¨g->
u
.
vec
->
size
 == 0)

882 
Âos
--;

885 
ˇrg
 = (
¨gv
 + 
¨g
)->
u
.
vec
->
ôem
;

886 
√Àmno
 = 1;

890 i‡((
föfo
 & 
INFO_T
Ë=
INFO_T_LPC
)

892 
˛ón
 = (
svÆue
 *)
	`xÆloc
((svalue));

893 
˛ón
->
ty≥
 = 
T_STRING
;

894 
˛ón
->
°rög_ty≥
 = 
STRING_MSTRING
;

895 
˛ón
->
u
.
°rög
 = 
	`Æloˇã_m°rög
(512);

896 
˛ón
->
u
.
°rög
[0] = '\0';

897 
	`svÆue_to_°rög
(
ˇrg
, &(
˛ón
->
u
.
°rög
), 512, 0, 0);

898 
ˇrg
 = 
˛ón
;

900 
föfo
 ^
INFO_T_LPC
;

901 
föfo
 |
INFO_T_STRING
;

903 i‡((
föfo
 & 
INFO_T
Ë=
INFO_T_ERROR
)

905 
	`ERROR
(
ERR_INVALID_FORMAT_STR
);

907 i‡((
föfo
 & 
INFO_T
Ë=
INFO_T_NULL
)

910 ()
	`Ârötf
(
°dîr
, "%s: (s)printf: INFO_T_NULL.... found.\n",

911 
cuºít_obje˘
->
«me
);

912 
	`ADD_CHAR
('%');

913 } i‡((
föfo
 & 
INFO_T
Ë=
INFO_T_STRING
)

915 
¶í
;

917 i‡(
ˇrg
->
ty≥
 !
T_STRING
)

918 
	`ERROR
(
ERR_INCORRECT_ARG_S
);

919 
¶í
 = 
	`°æí
(
ˇrg
->
u
.
°rög
);

920 i‡((
föfo
 & 
INFO_COLS
Ë|| (föfÿ& 
INFO_TABLE
))

922 
c°
 **
ãmp
;

924 i‡(!
fs
)

925 
	`ERROR
(
ERR_CST_REQUIRES_FS
);

927 
ãmp
 = &
c°s
;

928 *
ãmp
)

929 
ãmp
 = &((*ãmp)->
√xt
);

930 i‡(
föfo
 & 
INFO_COLS
)

932 *
ãmp
 = (
c°
 *)
	`xÆloc
((cst));

933 (*
ãmp
)->
√xt
 = 0;

934 (*
ãmp
)->
d
.
cﬁ
 = 
ˇrg
->
u
.
°rög
;

935 (*
ãmp
)->
∑d
 =Öad;

936 (*
ãmp
)->
size
 = 
fs
;

937 (*
ãmp
)->
¥ec
 = (¥ecË?Öª¯: 
fs
;

938 (*
ãmp
)->
öfo
 = 
föfo
;

939 (*
ãmp
)->
°¨t
 = 
cuΩos
;

940 i‡((
	`add_cﬁumn
(
ãmp
, (((
f‹m©_°r
[
Âos
] != '\n')

941 && (
f‹m©_°r
[
Âos
] !'\0')Ë|| ((
föfo
 & 
INFO_ARRAY
)

942 && (
√Àmno
 < (
¨gv
+
¨g
)->
u
.
vec
->
size
)))) == 2)

943 && !
f‹m©_°r
[
Âos
])

945 
	`ADD_CHAR
('\n');

950 
n
, 
Àn
, 
max
;

952 
	#TABLE
 
ˇrg
->
u
.
°rög


	)

953 (*
ãmp
Ë(
c°
 *)
	`xÆloc
((cst));

954 (*
ãmp
)->
∑d
 =Öad;

955 (*
ãmp
)->
öfo
 = 
föfo
;

956 (*
ãmp
)->
°¨t
 = 
cuΩos
;

957 (*
ãmp
)->
√xt
 = 0;

958 
max
 = 
Àn
 = 0;

959 
n
 = 1;

960 
i
 = 0; 
TABLE
[i]; i++)

962 i‡(
TABLE
[
i
] == '\n')

964 i‡(
Àn
 > 
max
)

965 
max
 = 
Àn
;

966 
Àn
 = 0;

967 i‡(
TABLE
[
i
 + 1])

968 
n
++;

971 
Àn
++;

973 i‡(
¥ec
)

975 (*
ãmp
)->
size
 = 
fs
/
¥ec
;

979 i‡(
Àn
 > 
max
)

980 
max
 = 
Àn
;

981 
¥ec
 = 
fs
/(
max
+2);

982 i‡(!
¥ec
)

983 
¥ec
 = 1;

984 (*
ãmp
)->
size
 = 
fs
 / 
¥ec
;

986 
Àn
 = 
n
 / 
¥ec
;

987 i‡(
n
 < 
¥ec
)

988 
¥ec
 = 
n
;

989 i‡(
Àn
 * 
¥ec
 < 
n
)

990 
Àn
++;

991 i‡(
Àn
 > 1 && 
n
 % 
¥ec
)

992 
¥ec
 -’ª¯- 
n
 %ÖªcË/ 
Àn
;

993 (*
ãmp
)->
d
.
èb
 = (**)
	`xÆloc
(
¥ec
*(*));

994 (*
ãmp
)->
nocﬁs
 = 
¥ec
;

995 (*
ãmp
)->
d
.
èb
[0] = 
TABLE
;

996 i‡(
¥ec
 == 1)

997 
add_èbÀ_now
;

998 
i
 = 1;

999 
n
 = 0;

1000 
fs
 = 0; 
TABLE
[fs]; fs++)

1002 i‡(
TABLE
[
fs
] == '\n')

1004 i‡(++
n
 >
Àn
)

1006 i‡(
ˇrg
 !
˛ón
)

1007 
	`SAVE_CHAR
(((
TABLE
Ë+ 
fs
));

1008 
TABLE
[
fs
] = '\0';

1009 (*
ãmp
)->
d
.
èb
[
i
++] = 
TABLE
+
fs
+1;

1010 i‡(
i
 >
¥ec
)

1011 
add_èbÀ_now
;

1012 
n
 = 0;

1016 
add_èbÀ_now
:

1017 ()
	`add_èbÀ
(
ãmp
, (((
f‹m©_°r
[
Âos
] != '\n') &&

1018 (
f‹m©_°r
[
Âos
] != '\0')) ||

1019 ((
föfo
 & 
INFO_ARRAY
) &&

1020 (
√Àmno
 < (
¨gv
 + 
¨g
)->
u
.
vec
->
size
))));

1025 i‡(
¥ec
 &&Öª¯< 
¶í
)

1027 i‡(
ˇrg
 !
˛ón
)

1028 
	`SAVE_CHAR
(((
ˇrg
->
u
.
°rög
)+
¥ec
));

1029 
ˇrg
->
u
.
°rög
[
¥ec
] = '\0';

1030 
¶í
 = 
¥ec
;

1032 i‡(
fs
 && fs>
¶í
) {

1033 
	`add_ju°ifõd
(
ˇrg
->
u
.
°rög
, 
∑d
, 
fs
, 
föfo
,

1034 (((
f‹m©_°r
[
Âos
] != '\n') &&

1035 (
f‹m©_°r
[
Âos
] != '\0'))

1036 || ((
föfo
 & 
INFO_ARRAY
) &&

1037 (
√Àmno
 < (
¨gv
 + 
¨g
)->
u
.
vec
->
size
)))

1038 || 
ˇrg
->
u
.
°rög
[
¶í
 - 1] != '\n');

1042 
i
 = 0; i < 
¶í
; i++)

1043 
	`ADD_CHAR
(
ˇrg
->
u
.
°rög
[
i
]);

1046 } i‡(
föfo
 & 
INFO_T_INT
) {

1047 
chót
[4];

1048 
ãmp
[100];

1050 *
chót
 = '%';

1051 
i
 = 1;

1052 
föfo
 & 
INFO_PP
)

1054 
INFO_PP_SPACE
:

1055 
chót
[
i
++] = ' ';

1057 
INFO_PP_PLUS
:

1058 
chót
[
i
++] = '+';

1061 
föfo
 & 
INFO_T
)

1063 
INFO_T_INT
:

1064 
chót
[
i
++] = 'd'; ;

1065 
INFO_T_CHAR
: 
chót
[
i
++] = 'c'; ;

1066 
INFO_T_OCT
: 
chót
[
i
++] = 'o'; ;

1067 
INFO_T_HEX
: 
chót
[
i
++] = 'x'; ;

1068 
INFO_T_C_HEX
: 
chót
[
i
++] = 'X'; ;

1069 : 
	`ERROR
(
ERR_BAD_INT_TYPE
);

1071 i‡(
ˇrg
->
ty≥
 !
T_NUMBER
)

1073 #ifde‡
RETURN_ERROR_MESSAGES


1074 ()
	`•rötf
(
buff
,

1076 
chót
[
i
-1]);

1077 ()
	`Ârötf
(
°dîr
, "%s:%s: %s", 
cuºít_obje˘
->
«me
,

1078 
	`gë_§ccode_posôi⁄_if_™y
(), 
buff
);

1079  
buff
;

1081 
	`îr‹
("ERROR: (s)printf(): incorrectárgumentÅypeÅo %%%c.\n",

1082 
chót
[
i
-1]);

1085 
chót
[
i
] = '\0';

1086 ()
	`•rötf
(
ãmp
, 
chót
, 
ˇrg
->
u
.
numbî
);

1088 
tm∂
 = 
	`°æí
(
ãmp
);

1090 i‡(
¥ec
 && 
tm∂
 >Örec)

1091 
ãmp
[
¥ec
] = '\0';

1092 i‡(
tm∂
 < 
fs
)

1093 
	`add_ju°ifõd
(
ãmp
, 
∑d
, 
fs
, 
föfo
,

1094 (((
f‹m©_°r
[
Âos
] != '\n') &&

1095 (
f‹m©_°r
[
Âos
] != '\0')) ||

1096 ((
föfo
 & 
INFO_ARRAY
) &&

1097 (
√Àmno
 < (
¨gv
+
¨g
)->
u
.
vec
->
size
))));

1099 
i
 = 0; i < 
tm∂
; i++)

1100 
	`ADD_CHAR
(
ãmp
[
i
]);

1103 i‡((
i
=
föfo
&
INFO_T
Ë=
INFO_T_FLOAT_E
 ||

1104 
i
 =
INFO_T_FLOAT_F
 || i =
INFO_T_FLOAT_G
)

1106 
chót
[50];

1107 
ãmp
[100];

1109 *
chót
 = '%';

1110 
i
 = 1;

1111 
föfo
 & 
INFO_PP
)

1113 
INFO_PP_SPACE
:

1114 
chót
[
i
++] = ' ';

1116 
INFO_PP_PLUS
:

1117 
chót
[
i
++] = '+';

1120 i‡(
¥ec
 > 0)

1122 
chót
[
i
++] = '.';

1123 
chót
[
i
] = '\0';

1124 ()
	`•rötf
(
chót
,"%s%d",chót,
¥ec
);

1125 
i
 = 
	`°æí
(
chót
);

1127 
föfo
 & 
INFO_T
)

1129 
INFO_T_FLOAT_E
: 
chót
[
i
++] = 'e'; ;

1130 
INFO_T_FLOAT_F
: 
chót
[
i
++] = 'f'; ;

1131 
INFO_T_FLOAT_G
: 
chót
[
i
++] = 'g'; ;

1132 : 
	`ERROR
(
ERR_BAD_FLOAT_TYPE
);

1134 i‡(
ˇrg
->
ty≥
 !
T_FLOAT
)

1136 #ifde‡
RETURN_ERROR_MESSAGES


1137 ()
	`•rötf
(
buff
,

1138 "ERROR: (sÌrötf(): inc‹ª˘árgumíàty≥Åÿ%%%c.\n",
chót
[
i
-1]);

1139 ()
	`Ârötf
(
°dîr
, "%s:%s: %s", 
cuºít_obje˘
->
«me
,

1140 
	`gë_§ccode_posôi⁄_if_™y
(), 
buff
);

1141  
buff
;

1143 
	`îr‹
("ERROR: (sÌrötf(): inc‹ª˘árgumíàty≥Åÿ%%%c.\n",
chót
[
i
-1]);

1146 
chót
[
i
] = '\0';

1147 ()
	`•rötf
(
ãmp
,
chót
,
ˇrg
->
u
.
ªÆ
);

1149 
tm∂
 = 
	`°æí
(
ãmp
);

1151 i‡(
tm∂
 < 
fs
)

1152 
	`add_ju°ifõd
(
ãmp
, 
∑d
, 
fs
, 
föfo
,

1153 (((
f‹m©_°r
[
Âos
] != '\n') &&

1154 (
f‹m©_°r
[
Âos
] != '\0')) ||

1155 ((
föfo
 & 
INFO_ARRAY
) &&

1156 (
√Àmno
 < (
¨gv
+
¨g
)->
u
.
vec
->
size
))));

1158 
i
 = 0; i < 
tm∂
; i++)

1159 
	`ADD_CHAR
(
ãmp
[
i
]);

1163 
	`ERROR
(
ERR_UNDEFINED_TYPE
);

1165 i‡(
˛ón
)

1167 
	`‰ì_svÆue
(
˛ón
);

1168 
	`‰ì
(
˛ón
);

1169 
˛ón
 = 0;

1171 i‡(!(
föfo
 & 
INFO_ARRAY
))

1173 i‡(
√Àmno
 >(
¨gv
+
¨g
)->
u
.
vec
->
size
)

1175 
ˇrg
 = (
¨gv
 + 
¨g
)->
u
.
vec
->
ôem
 + 
√Àmno
++;

1177 
Âos
--;

1180 
	`ADD_CHAR
(
f‹m©_°r
[
Âos
]);

1182 
	`ADD_CHAR
('\0');

1183 
ßves
)

1185 
ßvech¨s
 *
tmp
;

1186 *(
ßves
->
whîe
Ëßves->
wh©
;

1187 
tmp
 = 
ßves
;

1188 
ßves
 = saves->
√xt
;

1189 
	`‰ì
((*)
tmp
);

1191  
buff
;

1192 
	}
}

	@strerror.c

34 
	~<î∫o.h
>

35 
	~<limôs.h
>

36 
	~<°dio.h
>

37 
	~<°rög.h
>

39 #i‚de‡
__SYS_ERRLIST


40 
	#__SYS_ERRLIST


	)

42 
sys_√º
;

43 *
sys_îæi°
[];

47 
	$ôﬂ
(
num
)

48 
num
;

50 
buf„r
[11];

51 *
p
;

53 
p
 = 
buf„r
 + 4;

54 
num
 >= 10) {

55 *--
p
 = (
num
 % 10) + '0';

56 
num
 /= 10;

58 *
p
 = (
num
 % 10) + '0';

59  
p
;

60 
	}
}

63 
	$°ªº‹
(
num
)

64 
num
;

66 
	#UPREFIX
 "Unknow¿îr‹: "

	)

67 
î∫um
;

68 
buf
[
NL_TEXTMAX
];

70 
î∫um
 = 
num
;

71 i‡(
î∫um
 < 
sys_√º
) {

72 (
sys_îæi°
[
î∫um
]);

74 
	`°r˝y
(
buf
, 
UPREFIX
);

75 
	`°∫ˇt
(
buf
, 
	`ôﬂ
(
î∫um
), 
NL_TEXTMAX
-
	`°æí
(buf)-1);

78  
buf
;

79 
	}
}

	@strpbrk.c

34 #i‡
deföed
(
LIBC_SCCS
Ë&& !deföed(
löt
)

35 *
	gsccsid
 = "from: @(#)strpbrk.c 5.8 (Berkeley) 1/26/91";

38 
	~<°rög.h
>

44 
	$°Ωbrk
(
s1
, 
s2
)

45 c⁄° *
s1
, *
s2
;

47 c⁄° *
sˇ≈
;

48 
c
, 
sc
;

50 (
c
 = *
s1
++) != 0) {

51 
sˇ≈
 = 
s2
; (
sc
 = *scanp++) != 0;)

52 i‡(
sc
 =
c
)

53  ((*)(
s1
 - 1));

55  (
NULL
);

56 
	}
}

	@strtod.c

16 
	~<°dlib.h
>

17 
	~<˘y≥.h
>

19 #i‚de‡
TRUE


20 
	#TRUE
 1

	)

21 
	#FALSE
 0

	)

23 #i‚de‡
NULL


24 
	#NULL
 0

	)

27 
	gmaxExp⁄ít
 = 511;

32 
	gpowîsOf10
[] = {

66 
	$°πod
(
°rög
, 
ídPå
)

67 *
°rög
;

79 **
ídPå
;

82 
sign
, 
expSign
 = 
FALSE
;

83 
‰a˘i⁄
, 
dblExp
, *
d
;

84 *
p
, 
c
;

85 
exp
 = 0;

86 
‰acExp
 = 0;

96 
m™tSize
;

97 
decPt
;

100 *
pExp
;

108 
p
 = 
°rög
;

109 
	`is•a˚
(*
p
)) {

110 
p
 += 1;

112 i‡(*
p
 == '-') {

113 
sign
 = 
TRUE
;

114 
p
 += 1;

116 i‡(*
p
 == '+') {

117 
p
 += 1;

119 
sign
 = 
FALSE
;

127 
decPt
 = -1;

128 
m™tSize
 = 0; ; mantSize += 1)

130 
c
 = *
p
;

131 i‡(!
	`isdigô
(
c
)) {

132 i‡((
c
 !'.'Ë|| (
decPt
 >= 0)) {

135 
decPt
 = 
m™tSize
;

137 
p
 += 1;

147 
pExp
 = 
p
;

148 
p
 -
m™tSize
;

149 i‡(
decPt
 < 0) {

150 
decPt
 = 
m™tSize
;

152 
m™tSize
 -= 1;

154 i‡(
m™tSize
 > 18) {

155 
‰acExp
 = 
decPt
 - 18;

156 
m™tSize
 = 18;

158 
‰acExp
 = 
decPt
 - 
m™tSize
;

160 i‡(
m™tSize
 == 0) {

161 
‰a˘i⁄
 = 0.0;

162 
p
 = 
°rög
;

163 
d⁄e
;

165 
‰ac1
, 
‰ac2
;

166 
‰ac1
 = 0;

167  ; 
m™tSize
 > 9; mantSize -= 1)

169 
c
 = *
p
;

170 
p
 += 1;

171 i‡(
c
 == '.') {

172 
c
 = *
p
;

173 
p
 += 1;

175 
‰ac1
 = 10*‰ac1 + (
c
 - '0');

177 
‰ac2
 = 0;

178 ; 
m™tSize
 > 0; mantSize -= 1)

180 
c
 = *
p
;

181 
p
 += 1;

182 i‡(
c
 == '.') {

183 
c
 = *
p
;

184 
p
 += 1;

186 
‰ac2
 = 10*‰ac2 + (
c
 - '0');

188 
‰a˘i⁄
 = (1.0e9 * 
‰ac1
Ë+ 
‰ac2
;

195 
p
 = 
pExp
;

196 i‡((*
p
 == 'E') || (*p == 'e')) {

197 
p
 += 1;

198 i‡(*
p
 == '-') {

199 
expSign
 = 
TRUE
;

200 
p
 += 1;

202 i‡(*
p
 == '+') {

203 
p
 += 1;

205 
expSign
 = 
FALSE
;

207 
	`isdigô
(*
p
)) {

208 
exp
 =Éx∞* 10 + (*
p
 - '0');

209 
p
 += 1;

212 i‡(
expSign
) {

213 
exp
 = 
‰acExp
 -Éxp;

215 
exp
 = 
‰acExp
 +Éxp;

225 i‡(
exp
 < 0) {

226 
expSign
 = 
TRUE
;

227 
exp
 = -exp;

229 
expSign
 = 
FALSE
;

231 i‡(
exp
 > 
maxExp⁄ít
) {

232 
exp
 = 
maxExp⁄ít
;

234 
dblExp
 = 1.0;

235 
d
 = 
powîsOf10
; 
exp
 != 0;Éxp >>= 1, d += 1) {

236 i‡(
exp
 & 01) {

237 
dblExp
 **
d
;

240 i‡(
expSign
) {

241 
‰a˘i⁄
 /
dblExp
;

243 
‰a˘i⁄
 *
dblExp
;

246 
d⁄e
:

247 i‡(
ídPå
 !
NULL
) {

248 *
ídPå
 = 
p
;

251 i‡(
sign
) {

252  -
‰a˘i⁄
;

254  
‰a˘i⁄
;

255 
	}
}

	@super_snoop.c

1 
	~<°dio.h
>

2 
	~<°rög.h
>

3 
	~<f˙é.h
>

4 
	~<uni°d.h
>

5 
	~"c⁄fig.h
"

7 #ifde‡
SUPER_SNOOP


8 
	~"obje˘.h
"

9 
	~"comm.h
"

10 
	~"su≥r_¢o›.h
"

12 vﬁ©ûê
	gnum_su≥r_¢o›ed
;

13 
öãø˘ive
 *
Æl_∂ayîs
[
MAX_PLAYERS
];

14 
	gsu≥r_¢o›ed
[256][16];

15 
	gsu≥r_¢o›fûe
[256][32];

18 
	$ªad_¢o›_fûe
()

20 
FILE
 *
f
;

21 
i
;

22 
f
 = 
	`f›í
("../snoops/snooped","r");

23 i‡(
f
 =
NULL
)

25 
num_su≥r_¢o›ed
 = 0;

28 
i
 = 0; 
	`fsˇnf
(
f
, "%s", 
su≥r_¢o›ed
[i]Ë!
EOF
 && i < 256 ; i++)

30 ()
	`°r˝y
(
su≥r_¢o›fûe
[
i
], "../snoops/");

31 ()
	`°rˇt
(
su≥r_¢o›fûe
[
i
], 
su≥r_¢o›ed
[i]);

33 
num_su≥r_¢o›ed
 = 
i
;

34 
	}
}

37 
	$upd©e_¢o›_fûe
()

39 
i
, 
j
;

41 
i
 = 0; 
num_su≥r_¢o›ed
 && i < 
MAX_PLAYERS
; i++)

42 i‡(
Æl_∂ayîs
[
i
] &&áŒ_∂ayîs[i]->
¢o›_fd
 >= 0) {

43 ()
	`˛o£
(
Æl_∂ayîs
[
i
]->
¢o›_fd
);

44 
Æl_∂ayîs
[
i
]->
¢o›_fd
 = -1;

45 
num_su≥r_¢o›ed
--;

47 
	`ªad_¢o›_fûe
();

48 
i
 = 0; i < 
MAX_PLAYERS
; i++)

49 
j
 = 0; j < 
num_su≥r_¢o›ed
; j++)

50 i‡(
Æl_∂ayîs
[
i
] &&áŒ_∂ayîs[i]->
ob
 &&

51 
Æl_∂ayîs
[
i
]->
ob
->
livög_«me
 &&

52 
	`°rcmp
(
Æl_∂ayîs
[
i
]->
ob
->
livög_«me
, 
su≥r_¢o›ed
[
j
]) == 0) {

53 
Æl_∂ayîs
[
i
]->
¢o›_fd
 = 
	`›í
(
su≥r_¢o›fûe
[
j
],

54 
O_WRONLY
 | 
O_APPEND
 | 
O_CREAT
,

58 
	}
}

61 
	$check_su≥r¢o›
(
obje˘
 *
ob
)

63 
i
;

65 i‡(!
ob
 || !ob->
öãø˘ive
)

68 i‡(
ob
->
öãø˘ive
->
¢o›_fd
 >= 0) {

69 ()
	`˛o£
(
ob
->
öãø˘ive
->
¢o›_fd
);

70 
ob
->
öãø˘ive
->
¢o›_fd
 = -1;

72 i‡(!
ob
->
livög_«me
 || !*ob->living_name)

75 
i
 = 0; i < 
num_su≥r_¢o›ed
; i++) {

76 i‡(
	`°rcmp
(
ob
->
livög_«me
, 
su≥r_¢o›ed
[
i
]) == 0) {

77 
ob
->
öãø˘ive
->
¢o›_fd
 = 
	`›í
(
su≥r_¢o›fûe
[
i
], 
O_WRONLY
 | 
O_APPEND
 | 
O_CREAT
, 0600);

81 
	}
}

	@super_snoop.h

1 #ifde‡
SUPER_SNOOP


2 
ªad_¢o›_fûe
();

3 
upd©e_¢o›_fûe
();

4 
check_su≥r¢o›
(
obje˘
 *);

	@swap.c

6 
	~<sys/ty≥s.h
>

7 
	~<sys/°©.h
>

8 
	~<î∫o.h
>

9 
	~<f˙é.h
>

10 
	~<°dio.h
>

11 
	~<°rög.h
>

12 
	~<°dlib.h
>

14 
	~"c⁄fig.h
"

16 
	gtŸÆ_num_¥og_blocks
 = 0;

17 
	gtŸÆ_¥og_block_size
 = 0;

18 
	gtŸÆ_¥ogøm_size
 = 0;

19 
	gtŸ_Æloc_v¨übÀ_size
 = 0;

20 
	gu£d_mem‹y
;

22 #ifde‡
USE_SWAP


23 #ifde‡
DO_CLEANUP


24 
	gtŸÆ_˛ón_ups
 = 0;

25 
	g˛ón_up_ªtu∫0
 = 0;

26 
	g˛ón_up_ªtu∫1
 = 0;

27 
	g˛ón_up_de°ru˘
 = 0;

30 
	~"löt.h
"

31 
	~"m°rög.h
"

32 
	~"öãΩªt.h
"

33 
	~"obje˘.h
"

34 
	~"exec.h
"

35 
	~"mud°©.h
"

36 
	~"m≠pög.h
"

37 
	~"maö.h
"

38 
	~"simuœã.h
"

40 
	~"ölöe_svÆue.h
"

42 #i‡
deföed
(
sun
Ë|| deföed(
__osf__
)

43 
	~<Æloˇ.h
>

46 #i‚de‡
SEEK_SET


47 
	#SEEK_SET
 0

	)

48 
	#SEEK_CUR
 1

	)

49 
	#SEEK_END
 2

	)

52 #i‚de‡
NBBY


53 
	#NBBY
 8

	)

56 #i‚de‡
NBULONG


57 
	#NBULONG
 (
NBBY
 * (
u_l⁄g
)Ë

	)

60 
	#BUFFER_DATA_SIZE
 256

	)

61 
	#BUFFER_PTR_SIZE
 (
BUFFER_DATA_SIZE
 / ())

	)

63 
	sbuf„r


65 
u_öt
 
	mbu‚um
;

66 
u_sh‹t
 
	moff£t
;

69 
	md©a
[
BUFFER_DATA_SIZE
];

70 
u_öt
 
	maddr
[
BUFFER_PTR_SIZE
];

71 } 
	mu
;

74 
	#SWAPIO_UNDEFINED
 0

	)

75 
	#SWAPIO_READ
 1

	)

76 
	#SWAPIO_WRITE
 2

	)

78 #ifde‡
SWAP_STDIO


79 
FILE
 *
	gsw≠_Â
;

80 
	gsw≠_pos
 = -1;

81 
	gsw≠_io
 = 
SWAPIO_UNDEFINED
;

83 
	gsw≠_fd
;

84 
off_t
 
	gsw≠_off
 = -1;

86 
	gsw≠_fûe
[80];

87 
u_l⁄g
 *
	gsw≠_bôm≠
;

88 
u_öt
 
	gsw≠_cursize
;

89 
u_öt
 
	gsw≠_mö‰ì
;

90 
u_öt
 
	gsw≠_max‰ì
;

91 #ifde‡
DEBUG


92 
u_öt
 
	gsw≠_maxÆloc
;

95 
	gœ°_addªss
 = 0;

96 
	gtŸÆ_byãs_sw≠≥d
 = 0;

97 
	gtŸÆ_sw≠_chaös
 = 0;

98 
	gtŸÆ_‰ì_blocks
 = 0;

100 
	#ffs
 
_ffs


	)

102 #i‡
deföed
(
__i386__
Ë&& deföed(
__GNUC__
)

103 
__ölöe__
 

104 
	$ffs
(
u_l⁄g
 
öput
)

106 
ªsu…
;

108 
	`__asm
("bsÊ %1, %0" : "Ù" (
ªsu…
Ë: "r" (
öput
));

109  
ªsu…
;

110 
	}
}

113 #ifde‡
__GNUC__


114 
	g__ölöe__


117 
	$ffs
(
u_l⁄g
 
mask
)

119 
bô
;

121 
bô
 = 0; !(
mask
 & 1); bit++)

122 
mask
 >>= 1;

123 (
bô
);

124 
	}
}

128 
	$öô_sw≠
()

130 *
p
, 
hn
[80];

131 
öôülized
 = 0;

133 i‡(
öôülized
)

136 
öôülized
 = 1;

138 ()
	`gëho°«me
(
hn
, (hn));

139 i‡((
p
 = 
	`°rchr
(
hn
, '.')Ë!
NULL
)

140 *
p
 = '\0';

142 ()
	`•rötf
(
sw≠_fûe
, "%s.%s.%d", 
SWAP_FILE
, 
hn
, ()
	`gëpid
());

144 #ifde‡
SWAP_STDIO


145 
sw≠_Â
 = 
	`f›í
(
sw≠_fûe
, "w+");

146 i‡(
sw≠_Â
 =
NULL
)

147 
	`Áèl
("Can't create swapfile.\n");

149 
sw≠_fd
 = 
	`›í
(
sw≠_fûe
, 
O_RDWR
 | 
O_CREAT
 | 
O_TRUNC
, 0600);

150 i‡(
sw≠_fd
 == -1)

151 
	`Áèl
("Can't create swapfile.\n");

154 
sw≠_cursize
 = 
	`gë∑gesize
();

156 
sw≠_bôm≠
 = 
	`xÆloc
(
sw≠_cursize
);

157 ()
	`mem£t
(
sw≠_bôm≠
, 0xFF, 
sw≠_cursize
);

158 
sw≠_bôm≠
[0] &= ~1;

160 
sw≠_mö‰ì
 = 0;

161 
sw≠_max‰ì
 = 
sw≠_cursize
 * 
NBBY
 - 1;

162 #ifde‡
DEBUG


163 
sw≠_maxÆloc
 = 0;

165 
	}
}

172 
	$exãnd_sw≠_bôm≠
()

174 
u_öt
 
size
;

175 
u_ch¨
 *
˝
;

177 
size
 = 
sw≠_cursize
;

178 
sw≠_cursize
 <<= 1;

180 
˝
 = 
	`xÆloc
(
sw≠_cursize
);

182 ()
	`mem˝y
(
˝
, 
sw≠_bôm≠
, 
size
);

183 ()
	`mem£t
(
˝
 + 
size
, 0xFF, size);

185 
	`‰ì
(
sw≠_bôm≠
);

186 
sw≠_bôm≠
 = (
u_l⁄g
 *)
˝
;

188 
sw≠_mö‰ì
 = 
size
 * 
NBBY
;

189 
sw≠_max‰ì
 = 
sw≠_cursize
 * 
NBBY
 - 1;

190 
	}
}

196 
u_öt


197 
	$Æloc_sw≠
()

199 
u_öt
 
möb
;

200 
u_öt
 
maxb
;

201 
u_öt
 
b
, 
c
;

202 
u_l⁄g
 
l
, *
Õ
;

204 #ifde‡
DEBUG


205 i‡(
sw≠_max‰ì
 !
sw≠_cursize
 * 
NBBY
 - 1)

206 
	`Áèl
("alloc_swap: swap_maxfree was stomped upon, is %u, should be %u\n",

207 
sw≠_max‰ì
, 
sw≠_cursize
 * 
NBBY
 - 1);

212 
möb
 = 
sw≠_mö‰ì
 / 
NBULONG
;

213 
maxb
 = 
sw≠_max‰ì
 / 
NBULONG
;

215 
Õ
 = &
sw≠_bôm≠
[
möb
];

217 
b
 = 
möb
; b <
maxb
; b++)

219 i‡((
l
 = *
Õ
) != 0)

221 
c
 = 
	`ffs
(
l
);

222 *
Õ
 &~(1L << 
c
);

223 
b
 = (b * 
NBULONG
Ë+ 
c
;

224 
sw≠_mö‰ì
 = 
b
 + 1;

225 i‡(
œ°_addªss
 < 
sw≠_mö‰ì
 * 
BUFFER_DATA_SIZE
)

226 
œ°_addªss
 = 
sw≠_mö‰ì
 * 
BUFFER_DATA_SIZE
;

227 i‡(
tŸÆ_‰ì_blocks
 > 0)

228 
tŸÆ_‰ì_blocks
--;

229 #ifde‡
DEBUG


230 i‡(
sw≠_maxÆloc
 < 
b
)

231 
sw≠_maxÆloc
 = 
b
;

233  
b
;

235 
Õ
++;

238 
	`exãnd_sw≠_bôm≠
();

240 
	}
}

247 
	$‰ì_sw≠
(
u_öt
 
blkno
)

249 #ifde‡
DEBUG


250 i‡(
sw≠_max‰ì
 !
sw≠_cursize
 * 
NBBY
 - 1)

251 
	`Áèl
("alloc_swap: swap_maxfree was stomped upon, is %u, should be %u\n",

252 
sw≠_max‰ì
, 
sw≠_cursize
 * 
NBBY
 - 1);

253 i‡(
blkno
 > 
sw≠_maxÆloc
)

254 
	`Áèl
("free_swap: freeing block %uÖastÉnd ofállocated blocks %u\n",

255 
blkno
, 
sw≠_maxÆloc
);

256 i‡(
sw≠_bôm≠
[
blkno
 / 
NBULONG
] & (1L << (blkno % NBULONG)))

257 
	`Áèl
("‰ì_sw≠: block %uáÃódy fªe\n", 
blkno
);

260 
sw≠_bôm≠
[
blkno
 / 
NBULONG
] |= 1L << (blkno % NBULONG);

262 i‡(
sw≠_mö‰ì
 > 
blkno
)

263 
sw≠_mö‰ì
 = 
blkno
;

265 
tŸÆ_‰ì_blocks
++;

266 
	}
}

271 #ifde‡
SWAP_STDIO


273 
	$bªad
(
u_öt
 
blkno
, 
buf„r
 *
bp
)

275 
pos
;

277 
pos
 = ()
blkno
 * 
BUFFER_DATA_SIZE
;

279 i‡(
sw≠_pos
 !
pos
 || 
sw≠_io
 !
SWAPIO_READ
) {

280 i‡(
	`fÊush
(
sw≠_Â
Ë=
EOF
)

281 
	`Áèl
("bread: cannot fflush swap\n");

282 i‡(
	`f£ek
(
sw≠_Â
, 
pos
, 
SEEK_SET
) == -1)

283 
	`Áèl
("bread: cannot seekÅo block %d: %s\n",

284 
blkno
, 
	`°ªº‹
(
	`„º‹
(
sw≠_Â
)));

287 i‡(
	`‰ód
(
bp
->
u
.
d©a
, 
BUFFER_DATA_SIZE
, 1, 
sw≠_Â
) != 1)

288 
	`Áèl
("bread: cannotÑead block %d: %s\n",

289 
blkno
, 
	`°ªº‹
(
	`„º‹
(
sw≠_Â
)));

291 
sw≠_pos
 = 
pos
 + 
BUFFER_DATA_SIZE
;

292 
sw≠_io
 = 
SWAPIO_READ
;

293 
	}
}

296 
	$bªad
(
u_öt
 
blkno
, 
buf„r
 *
bp
)

298 
off_t
 
off
;

299 *
buf
;

300 
cc
, 
Àn
;

302 
off
 = (
off_t
)
blkno
 * 
BUFFER_DATA_SIZE
;

304 i‡(
sw≠_off
 !
off
) {

305 i‡(
	`l£ek
(
sw≠_fd
, 
off
, 
SEEK_SET
Ë=(
off_t
)-1)

306 
	`Áèl
("bread: cannot seekÅo block %d: %s\n",

307 
blkno
, 
	`°ªº‹
(
î∫o
));

310 
buf
 = 
bp
->
u
.
d©a
;

311 
Àn
 = 
BUFFER_DATA_SIZE
;

313 
Àn
 > 0)

315 
cc
 = 
	`ªad
(
sw≠_fd
, 
buf
, 
Àn
);

316 i‡(
cc
 == -1)

317 
	`Áèl
("bread: cannotÑead block %d: %s\n",

318 
blkno
, 
	`°ªº‹
(
î∫o
));

319 i‡(
cc
 == 0)

320 
	`Áèl
("bªad: c™nŸÑód block %d: EOF\n", 
blkno
);

321 
buf
 +
cc
;

322 
Àn
 -
cc
;

325 
sw≠_off
 = 
off
 + 
BUFFER_DATA_SIZE
;

326 
	}
}

332 #ifde‡
SWAP_STDIO


334 
	$bwrôe
(
u_öt
 
blkno
, 
buf„r
 *
bp
)

336 
pos
;

338 
pos
 = ()
blkno
 * 
BUFFER_DATA_SIZE
;

340 i‡(
sw≠_pos
 !
pos
 || 
sw≠_io
 !
SWAPIO_WRITE
) {

341 i‡(
	`fÊush
(
sw≠_Â
Ë=
EOF
)

342 
	`Áèl
("bread: cannot fflush swap\n");

343 i‡(
	`f£ek
(
sw≠_Â
, 
pos
, 
SEEK_SET
) == -1)

344 
	`Áèl
("bwrite: cannot seekÅo block %d: %s\n",

345 
blkno
, 
	`°ªº‹
(
	`„º‹
(
sw≠_Â
)));

348 i‡(
	`fwrôe
(
bp
->
u
.
d©a
, 
BUFFER_DATA_SIZE
, 1, 
sw≠_Â
) != 1)

349 
	`Áèl
("bwrite: cannot write block %d: %s\n",

350 
blkno
, 
	`°ªº‹
(
	`„º‹
(
sw≠_Â
)));

352 
sw≠_pos
 = 
pos
 + 
BUFFER_DATA_SIZE
;

353 
sw≠_io
 = 
SWAPIO_WRITE
;

354 
	}
}

357 
	$bwrôe
(
u_öt
 
blkno
, 
buf„r
 *
bp
)

359 
off_t
 
off
;

360 *
buf
;

361 
cc
, 
Àn
;

363 
off
 = (
off_t
)
blkno
 * 
BUFFER_DATA_SIZE
;

365 i‡(
sw≠_off
 !
off
) {

366 i‡(
	`l£ek
(
sw≠_fd
, 
off
, 
SEEK_SET
Ë=(
off_t
)-1)

367 
	`Áèl
("bwrite: cannot seekÅo block %d: %s\n",

368 
blkno
, 
	`°ªº‹
(
î∫o
));

371 
buf
 = 
bp
->
u
.
d©a
;

372 
Àn
 = 
BUFFER_DATA_SIZE
;

374 
Àn
 > 0)

376 
cc
 = 
	`wrôe
(
sw≠_fd
, 
buf
, 
Àn
);

377 i‡(
cc
 == -1)

378 
	`Áèl
("bwrite: cannot write block %d: %s\n",

379 
blkno
, 
	`°ªº‹
(
î∫o
));

380 
buf
 +
cc
;

381 
Àn
 -
cc
;

384 
sw≠_off
 = 
off
 + 
BUFFER_DATA_SIZE
;

385 
	}
}

389 
	$u∆ök_sw≠_fûe
()

391 ()
	`u∆ök
(
sw≠_fûe
);

392 
	}
}

394 #ifde‡
DEALLOCATE_MEMORY_AT_SHUTDOWN


396 
	$˛o£_sw≠_fûe
()

398 
	`‰ì
(
sw≠_bôm≠
);

399 #ifde‡
SWAP_STDIO


400 ()
	`f˛o£
(
sw≠_Â
);

402 ()
	`˛o£
(
sw≠_fd
);

404 
	}
}

407 
buf„r
 *

408 
	$°¨t_ªad
(
u_öt
 
blkno
)

410 
buf„r
 *
bp
;

412 
bp
 = (
buf„r
 *)
	`xÆloc
((buffer));

413 
bp
->
bu‚um
 = 
blkno
;

414 
bp
->
off£t
 = (
u_öt
);

416 i‡(
blkno
 == 0)

417 
	`Áèl
("start_read: bad chain blockÇumber.\n");

419 
	`bªad
(
blkno
, 
bp
);

421  
bp
;

422 
	}
}

425 
	$sw≠_ªad
(
buf„r
 *
bp
, *
buf
, 
u_öt
 
Àn
)

427 
size_t
 
cc
;

429 
tŸÆ_byãs_sw≠≥d
 -
Àn
;

431 
Àn
 > 0)

433 
cc
 = 
BUFFER_DATA_SIZE
 - 
bp
->
off£t
;

434 i‡(
cc
 == 0)

436 
	`‰ì_sw≠
(
bp
->
bu‚um
);

437 
bp
->
bu‚um
 = bp->
u
.
addr
[0];

438 
bp
->
off£t
 = (
u_öt
);

439 i‡(
bp
->
bu‚um
 == 0)

440 
	`Áèl
("swap_read: block chain overrun.\n");

441 
	`bªad
(
bp
->
bu‚um
, bp);

442 
cc
 = 
BUFFER_DATA_SIZE
 - 
bp
->
off£t
;

444 i‡(
cc
 > 
Àn
)

445 
cc
 = 
Àn
;

446 ()
	`mem˝y
(
buf
, &
bp
->
u
.
d©a
[bp->
off£t
], 
cc
);

447 
buf
 +
cc
;

448 
Àn
 -
cc
;

449 
bp
->
off£t
 +
cc
;

451 
	}
}

454 
	$íd_ªad
(
buf„r
 *
bp
)

456 
	`‰ì_sw≠
(
bp
->
bu‚um
);

458 i‡(
bp
->
u
.
addr
[0] != 0)

459 
	`Áèl
("end_read: swap chain underrun.\n");

461 
	`‰ì
(
bp
);

463 
tŸÆ_sw≠_chaös
--;

464 
	}
}

466 
buf„r
 *

467 
	$°¨t_wrôe
(
u_öt
 *
blkno
)

469 
buf„r
 *
bp
;

471 i‡(*
blkno
 != 0)

472 
	`Áèl
("°¨t_wrôe: blknÿ%d.\n", *
blkno
);

474 *
blkno
 = 
	`Æloc_sw≠
();

476 
bp
 = (
buf„r
 *)
	`xÆloc
((buffer));

477 
bp
->
bu‚um
 = *
blkno
;

478 
bp
->
off£t
 = (
u_öt
);

480 ()
	`mem£t
(
bp
->
u
.
d©a
, '\0', 
BUFFER_DATA_SIZE
);

482 
tŸÆ_sw≠_chaös
++;

484  
bp
;

485 
	}
}

488 
	$sw≠_wrôe
(
buf„r
 *
bp
, *
buf
, 
u_öt
 
Àn
)

490 
size_t
 
cc
;

492 
tŸÆ_byãs_sw≠≥d
 +
Àn
;

494 
Àn
 > 0)

496 
cc
 = 
BUFFER_DATA_SIZE
 - 
bp
->
off£t
;

497 i‡(
cc
 == 0)

499 i‡(
bp
->
u
.
addr
[0] != 0)

500 
	`Áèl
("sw≠_wrôe: blknÿ%d.\n", 
bp
->
u
.
addr
[0]);

501 
bp
->
u
.
addr
[0] = 
	`Æloc_sw≠
();

502 
	`bwrôe
(
bp
->
bu‚um
, bp);

503 
bp
->
bu‚um
 = bp->
u
.
addr
[0];

504 
bp
->
off£t
 = (
u_öt
);

505 ()
	`mem£t
(
bp
->
u
.
d©a
, '\0', 
BUFFER_DATA_SIZE
);

506 
cc
 = 
BUFFER_DATA_SIZE
 - 
bp
->
off£t
;

508 i‡(
cc
 > 
Àn
)

509 
cc
 = 
Àn
;

510 ()
	`mem˝y
(&
bp
->
u
.
d©a
[bp->
off£t
], 
buf
, 
cc
);

511 
buf
 +
cc
;

512 
Àn
 -
cc
;

513 
bp
->
off£t
 +
cc
;

515 
	}
}

518 
	$íd_wrôe
(
buf„r
 *
bp
)

520 i‡(
bp
->
u
.
addr
[0] != 0)

521 
	`Áèl
("íd_wrôe: blknÿ%d.\n", 
bp
->
u
.
addr
[0]);

523 
	`bwrôe
(
bp
->
bu‚um
, bp);

525 
	`‰ì
(
bp
);

526 
	}
}

528 
	#Æign
(
x
Ë–((xË+ (()-1ËË& ~(()-1Ë)

	)

530 
obje˘
 *
	gsw≠_ob
 = 0;

531 
¥ogøm
 *
	gsw≠_¥og
 = 0;

532 
	gmax_sw≠_mem‹y
 = 0x40000001;

533 
	gmö_sw≠_mem‹y
 = 0x40000000;

534 
	gmö_sw≠_time
 = 0x40000000;

535 
	gmax_sw≠_time
 = 0x40000001;

537 
¥ogøm
 *
¥og_li°
;

538 
obje˘
 *
obj_li°
;

539 
cuºít_time
;

540 
tŸ_Æloc_obje˘_size
;

541 
	gtŸÆ_löío_sw≠≥d
 = 0;

542 
	gobj_sw≠≥d
 = 0;

543 
	gobj_byãs_sw≠≥d
 = 0;

545 
	g¥ogøm_byãs_sw≠≥d
 = 0, 
	g¥ogøms_sw≠≥d
 = 0;

547 
	gsw≠_out_¥og
, 
	gsw≠_out_obj
;

548 
	gsw≠_ö_¥og
, 
	gsw≠_ö_obj
;

550 
d_Êag
;

552 
	gnum_sw≠≥d
;

553 
	gnum_sw≠≥d_¨øys
, 
	gsize_sw≠≥d_¨øys
;

554 
	gnum_sw≠≥d_m≠pögs
, 
	gsize_sw≠≥d_m≠pögs
;

555 
	gnum_°rögs_sw≠≥d
, 
	gsize_°rögs_sw≠≥d
;

556 
	gnum_sw≠≥d_˛osuªs
, 
	gsize_sw≠≥d_˛osuªs
;

559 
	$sw≠_svÆue
(
buf„r
 *
buf
, 
svÆue
 *
¨g
)

561 
¨g
->
ty≥
)

563 
T_OBJECT
:

564 i‡(
¨g
->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
) {

568 
	`‰ì_svÆue
(
¨g
);

571 
T_NUMBER
:

572 
T_FLOAT
:

573 
¨g
->
ty≥
 |
T_LVALUE
;

574 
	`sw≠_wrôe
(
buf
, (*)
¨g
, (
svÆue
));

575 *
¨g
 = 
c⁄°0
;

577 
T_STRING
:

579 
size_t
 
Àn
;

580 *
°r
;

582 
°r
 = 
¨g
->
u
.
°rög
;

583 
Àn
 = 
¨g
->
u
.
numbî
 = 
	`°æí
(
°r
) + 1;

584 
	`sw≠_wrôe
(
buf
, (*)
¨g
, (
svÆue
));

585 
	`sw≠_wrôe
(
buf
, 
°r
, 
Àn
);

586 
num_°rögs_sw≠≥d
++;

587 
size_°rögs_sw≠≥d
 +
Àn
;

588 
¨g
->
°rög_ty≥
)

590 
STRING_MSTRING
:

591 
	`‰ì_m°rög
(
°r
);

593 
STRING_SSTRING
:

594 
	`‰ì_s°rög
(
°r
);

596 
STRING_CSTRING
:

600 ()
	`¥ötf
("SWAP ERROR buf=%lx\n", (Ë
buf
);

601 
	`Áèl
("Invalid variable value (1).\n");

603 
	`debug_mesßge
("SWAP FAILED: InvÆid v¨übÀ vÆuê(1Ë%d %d.\n", 
¨g
->
ty≥
,árg->
°rög_ty≥
);

607 *
¨g
 = 
c⁄°0
;

610 
T_POINTER
:

612 
ve˘‹
 *
v
;

614 
v
 = 
¨g
->
u
.
vec
;

615 i‡(
v
->
ªf
 != 1)

617 
¨g
->
ty≥
 |
T_LVALUE
;

618 
	`sw≠_wrôe
(
buf
, (*)
¨g
, (
svÆue
));

619 *
¨g
 = 
c⁄°0
;

623 
i
;

625 
¨g
->
u
.
numbî
 = 
v
->
size
;

626 
	`sw≠_wrôe
(
buf
, (*)
¨g
, (
svÆue
));

627 
i
 = 0; i < 
v
->
size
; i++)

628 
	`sw≠_svÆue
(
buf
, &
v
->
ôem
[
i
]);

629 *
¨g
 = 
c⁄°0
;

630 
num_sw≠≥d_¨øys
++;

631 
size_sw≠≥d_¨øys
 +(
ve˘‹
) +

632 (
svÆue
Ë* 
v
->
size
 - 1;

633 
	`‰ì_ve˘‹
(
v
);

637 
T_MAPPING
:

639 
m≠pög
 *
m
;

640 
≠aú
 *
∑ú
;

641 
i
, 
j
;

643 
m
 = 
¨g
->
u
.
m≠
;

644 i‡(
m
->
ªf
 != 1)

646 
¨g
->
ty≥
 |
T_LVALUE
;

647 
	`sw≠_wrôe
(
buf
, (*)
¨g
, (
svÆue
));

648 *
¨g
 = 
c⁄°0
;

652 
size
;

654 
size
 = 
¨g
->
u
.
numbî
 = 
m
->
ˇrd
;

655 
¨g
->
°rög_ty≥
 = 
m
->
size
;

657 
	`sw≠_wrôe
(
buf
, (*)
¨g
, (
svÆue
));

659 
i
 = 
j
 = 0; i < 
m
->
size
; i++)

660 
∑ú
 = 
m
->
∑ús
[
i
];Öaú;Öaú =Öaú->
√xt
)

662 
	`sw≠_svÆue
(
buf
, &
∑ú
->
¨g
);

663 
	`sw≠_svÆue
(
buf
, &
∑ú
->
vÆ
);

664 
j
++;

666 i‡(
j
 !
size
)

667 
	`Áèl
("Wr⁄g c¨döÆôy o‡m≠pög (%d !%d).\n", 
j
, 
size
);

669 
num_sw≠≥d_m≠pögs
++;

670 
size_sw≠≥d_m≠pögs
 +(
m≠pög
) +

671 
m
->
ˇrd
 * (
≠aú
) +

672 
m
->
size
 * (
≠aú
 *);

674 
	`‰ì_m≠pög
(
m
);

675 *
¨g
 = 
c⁄°0
;

679 
T_FUNCTION
:

682 
˛osuª
 *
f
;

684 
f
 = 
¨g
->
u
.
func
;

685 ()
	`¥ötf
("sw≠ ouà˛osuª(%lxËªf=%d %s\n", ()
f
, f->
ªf
, 
	`show_˛osuª
(f));

686 i‡(
f
->
ªf
 != 1) {

688 
¨g
->
ty≥
 |
T_LVALUE
;

689 
	`sw≠_wrôe
(
buf
, (*)
¨g
, (
svÆue
));

690 *
¨g
 = 
c⁄°0
;

693 
svÆue
 
theobj
, 
thórgs
, 
thío
;

695 
¨g
->
u
.
numbî
 = 
f
->
fu¡y≥
;

696 
	`sw≠_wrôe
(
buf
, (*)
¨g
, (
svÆue
));

697 
thío
.
ty≥
 = 
T_NUMBER
;

698 
thío
.
u
.
numbî
 = (
f
->
fu¬o
 << 16Ë| f->
funöh
;

699 
	`sw≠_svÆue
(
buf
, &
thío
);

700 i‡(
f
->
fu¡y≥
 =
FUN_EFUN
 || f->
funobj
 == 0) {

701 
theobj
 = 
c⁄°0
;

703 
theobj
.
ty≥
 = 
T_OBJECT
;

704 
theobj
.
u
.
ob
 = 
f
->
funobj
;

706 
thórgs
.
ty≥
 = 
T_POINTER
;

707 
thórgs
.
u
.
vec
 = 
f
->
fu«rgs
;

708 
	`sw≠_svÆue
(
buf
, &
theobj
);

709 
	`sw≠_svÆue
(
buf
, &
thórgs
);

710 
	`‰ì_˛osuª
(
f
);

711 *
¨g
 = 
c⁄°0
;

712 
num_sw≠≥d_˛osuªs
++;

713 
size_sw≠≥d_˛osuªs
 +(
˛osuª
);

719 ()
	`¥ötf
("SWAP ERROR buf=%lx\n", (Ë
buf
);

720 
	`Áèl
("Invalid variableÅype (2).\n");

722 
	}
}

725 
	$unsw≠_svÆue
(
buf„r
 *
buf
, 
svÆue
 *
¨g
)

727 
	`sw≠_ªad
(
buf
, (*)
¨g
, (
svÆue
));

728 i‡(
¨g
->
ty≥
 & 
T_LVALUE
)

730 
¨g
->
ty≥
 &~
T_LVALUE
;

731 i‡(
¨g
->
ty≥
 =
T_OBJECT
 && (¨g->
u
.
ob
->
Êags
 & 
O_DESTRUCTED
))

732 
	`‰ì_svÆue
(
¨g
);

733 i‡(!(
¨g
->
ty≥
 &

734 (
T_OBJECT
 | 
T_NUMBER
 | 
T_FLOAT
 | 
T_POINTER
 | 
T_MAPPING
 | 
T_FUNCTION
)))

736 ()
	`¥ötf
("SWAP ERROR buf=%lx\n", (Ë
buf
);

737 
	`Áèl
("Invalid variableÜvalue (3).\n");

741 
¨g
->
ty≥
)

743 
T_STRING
:

745 
size_t
 
Àn
;

746 *
°r
;

748 
Àn
 = 
¨g
->
u
.
numbî
;

749 
¨g
->
°rög_ty≥
) {

750 
STRING_SSTRING
:

751 
STRING_CSTRING
:

752 
°r
 = 
	`Æloˇ
(
Àn
);

753 
	`sw≠_ªad
(
buf
, 
°r
, 
Àn
);

754 
¨g
->
°rög_ty≥
 = 
STRING_SSTRING
;

755 
¨g
->
u
.
°rög
 = 
	`make_s°rög
(
°r
);

757 
STRING_MSTRING
:

758 
¨g
->
°rög_ty≥
 = 
STRING_MSTRING
;

759 
¨g
->
u
.
°rög
 = 
	`Æloˇã_m°rög
(
Àn
 - 1);

760 
	`sw≠_ªad
(
buf
, 
¨g
->
u
.
°rög
, 
Àn
);

763 
	`debug_mesßge
("SWAP FAILED: Invalid variable value (5) %d %d.\n",

764 
¨g
->
ty≥
,árg->
°rög_ty≥
);

766 
num_°rögs_sw≠≥d
--;

767 
size_°rögs_sw≠≥d
 -
Àn
;

770 
T_POINTER
:

772 
size
, 
i
;

773 
ve˘‹
 *
v
;

775 
size
 = 
¨g
->
u
.
numbî
;

776 
v
 = 
	`Æloˇã_¨øy
(
size
);

777 
i
 = 0; i < 
size
; i++)

778 
	`unsw≠_svÆue
(
buf
, &
v
->
ôem
[
i
]);

780 
¨g
->
u
.
vec
 = 
v
;

781 
num_sw≠≥d_¨øys
--;

782 
size_sw≠≥d_¨øys
 -(
ve˘‹
) +

783 (
svÆue
Ë* 
size
 - 1;

786 
T_MAPPING
:

788 
size
, 
i
;

789 
svÆue
 
m¨g
, *
mvÆ
;

791 
size
 = 
¨g
->
u
.
numbî
;

792 
¨g
->
u
.
m≠
 = 
	`Æloˇã_m≠
(
size
);

793 
i
 = 0; i < 
size
; i++)

795 
	`unsw≠_svÆue
(
buf
, &
m¨g
);

796 
mvÆ
 = 
	`gë_m≠_lvÆue
(
¨g
->
u
.
m≠
, &
m¨g
, 1);

797 
	`unsw≠_svÆue
(
buf
, 
mvÆ
);

798 
	`‰ì_svÆue
(&
m¨g
);

801 
num_sw≠≥d_m≠pögs
--;

802 
size_sw≠≥d_m≠pögs
 -(
m≠pög
) +

803 
size
 * (
≠aú
) +

804 
¨g
->
°rög_ty≥
 * (
≠aú
 *);

808 
T_FUNCTION
:

810 
svÆue
 
theobj
, 
thórgs
, 
thío
;

811 
·y≥
 = 
¨g
->
u
.
numbî
;

812 
˛osuª
 *
f
 = 
¨g
->
u
.
func
 = 
	`Æloc_˛osuª
(
·y≥
);

814 ()
	`¥ötf
("swap in closure\n");

815 
	`unsw≠_svÆue
(
buf
, &
thío
);

816 
f
->
fu¬o
 = ()
thío
.
u
.
numbî
 >> 16;

817 
f
->
funöh
 = 
thío
.
u
.
numbî
 & 0xffff;

818 
	`unsw≠_svÆue
(
buf
, &
theobj
);

819 
	`unsw≠_svÆue
(
buf
, &
thórgs
);

820 i‡(
theobj
.
ty≥
 !
T_OBJECT
)

821 
f
->
funobj
 = 0;

823 
f
->
funobj
 = 
theobj
.
u
.
ob
;

824 
f
->
fu«rgs
 = 
thórgs
.
u
.
vec
;

825 
num_sw≠≥d_˛osuªs
--;

826 
size_sw≠≥d_˛osuªs
 -(
˛osuª
);

832 ()
	`¥ötf
("SWAP ERROR buf=%lx\n", (Ë
buf
);

833 
	`Áèl
("Invalid variable value (4).\n");

835 
	`debug_mesßge
("SWAP FAILED: InvÆid v¨übÀ vÆuê(2Ë%d.\n", 
¨g
->
ty≥
);

839 
	}
}

846 
	$sw≠_obje˘
(
obje˘
 *
ob
)

848 
size
;

849 
num_v¨s
, 
i
;

850 
buf„r
 *
buf
;

852 i‡(
ob
->
Êags
 & (
O_DESTRUCTED
 | 
O_SWAPPED
))

855 i‡(
d_Êag
 & 
DEBUG_SWAP
)

857 ()
	`Ârötf
(
°dîr
, "Swap object %s (ref %d) from 0x%lx\n",

858 
ob
->
«me
, ob->
ªf
, (Ëob->
v¨übÀs
);

860 i‡(!
ob
->
v¨übÀs
)

863 
ob
->
v¨übÀs
--;

864 
num_v¨s
 = 
ob
->
¥og
->
öhîô
[ob->¥og->
num_öhîôed
 - 1].

865 
v¨übÀ_ödex_off£t
 + 
ob
->
¥og
->
num_v¨übÀs
 + 1;

866 
size
 = 
num_v¨s
 * (
svÆue
);

868 
buf
 = 
	`°¨t_wrôe
((
u_öt
 *)&
ob
->
sw≠_num
);

870 
i
 = 0; i < 
num_v¨s
; i++)

871 
	`sw≠_svÆue
(
buf
, &
ob
->
v¨übÀs
[
i
]);

872 
	`íd_wrôe
(
buf
);

874 
	`‰ì
((*)
ob
->
v¨übÀs
);

875 
ob
->
v¨übÀs
 = 
NULL
;

876 
obj_byãs_sw≠≥d
 +
size
;

877 
obj_sw≠≥d
++;

878 
tŸ_Æloc_v¨übÀ_size
 -
size
;

880 
num_sw≠≥d
++;

881 
sw≠_out_obj
++;

882 
ob
->
Êags
 |
O_SWAPPED
;

883 
	}
}

886 
	$lﬂd_ob_‰om_sw≠
(
obje˘
 *
ob
)

888 
i
;

889 
size_t
 
size
;

890 
num_v¨
;

891 
buf„r
 *
buf
;

893 i‡(!(
ob
->
Êags
 & 
O_SWAPPED
))

894 
	`Áèl
("Swapping inÇot swapped out object!\n");

897 i‡(
d_Êag
 & 
DEBUG_SWAP
)

899 ()
	`Ârötf
(
°dîr
,"Unsw≠ obje˘ %†‘e‡%dË‰om 0x%lx\n", 
ob
->
«me
, ob->
ªf
, (Ëob->
v¨übÀs
);

901 
size
 = (
num_v¨
 = 
ob
->
¥og
->
öhîô
[ob->¥og->
num_öhîôed
 - 1].
v¨übÀ_ödex_off£t
 +

902 
ob
->
¥og
->
num_v¨übÀs
 + 1Ë* (
svÆue
);

904 
ob
->
v¨übÀs
 = (
svÆue
 *)
	`xÆloc
(
size
);

906 
buf
 = 
	`°¨t_ªad
((
u_öt
)
ob
->
sw≠_num
);

907 
i
 = 0; i < 
num_v¨
; i++)

908 
	`unsw≠_svÆue
(
buf
, &
ob
->
v¨übÀs
[
i
]);

909 
	`íd_ªad
(
buf
);

910 
ob
->
sw≠_num
 = 0;

912 
ob
->
Êags
 &~
O_SWAPPED
;

913 
obj_byãs_sw≠≥d
 -
size
;

914 
obj_sw≠≥d
--;

915 
tŸ_Æloc_v¨übÀ_size
 +
size
;

916 
sw≠_ö_obj
++;

917 
num_sw≠≥d
--;

918 
ob
->
v¨übÀs
++;

919 
	}
}

922 
	$sw≠_£gmít
(*
hdr
, 
£gmít_desc
 *
£g
)

924 
£˘i⁄_desc
 *
£˘
;

925 *
block
 = *(**)(
hdr
 + 
£g
->
±r_off£t
);

926 
i
;

928 i‡(*(*)(
hdr
 + 
£g
->
sw≠_idx_off£t
) == 0)

930 
buf„r
 *
buf
;

932 
buf
 = 
	`°¨t_wrôe
((
u_öt
 *)(
hdr
 + 
£g
->
sw≠_idx_off£t
));

933 
	`sw≠_wrôe
(
buf
, 
block
, *(
u_öt
 *)(
hdr
 + 
£g
->
size_off£t
));

934 
	`íd_wrôe
(
buf
);

937 i‡(*(*)(
hdr
 + 
£g
->
sw≠_idx_off£t
) == -1)

938 
	`Áèl
("error while swapping segment.\n");

940 
£˘
 = 
£g
->
£˘i⁄s
, 
i
 = 0; se˘->
£˘i⁄
 != -1; sect++, i++)

941 i‡(
£˘
->
±r_off£t
 != -1)

942 *(*)(
hdr
 + 
£˘
->
±r_off£t
) =

943 *(**)(
hdr
 + 
£˘
->
±r_off£t
Ë- 
block
;

946 
	`‰ì
(
block
);

947  *(*)(
hdr
 + 
£g
->
size_off£t
);

948 
	}
}

951 
	$unsw≠_£gmít
(*
hdr
, 
£gmít_desc
 *
£g
)

953 
£˘i⁄_desc
 *
£˘
;

954 *
block
;

955 
i
;

956 
buf„r
 *
buf
;

958 
block
 = 
	`xÆloc
((
size_t
)*(*)(
hdr
 + 
£g
->
size_off£t
));

960 
buf
 = 
	`°¨t_ªad
(*(
u_öt
 *)(
hdr
 + 
£g
->
sw≠_idx_off£t
));

961 
	`sw≠_ªad
(
buf
, 
block
, *(
u_öt
 *)(
hdr
 + 
£g
->
size_off£t
));

962 
	`íd_ªad
(
buf
);

963 *(
u_öt
 *)(
hdr
 + 
£g
->
sw≠_idx_off£t
) = 0;

965 
£˘
 = 
£g
->
£˘i⁄s
, 
i
 = 0; se˘->
£˘i⁄
 != -1; sect++, i++)

966 i‡(
£˘
->
±r_off£t
 != -1)

967 *(**)(
hdr
 + 
£˘
->
±r_off£t
) =

968 
block
 + ()*(*)(
hdr
 + 
£˘
->
±r_off£t
);

970 *(**)(
hdr
 + 
£g
->
±r_off£t
Ë
block
;

971  *(*)(
hdr
 + 
£g
->
size_off£t
);

972 
	}
}

980 
	$sw≠_löío
(
¥ogøm
 *
¥og
)

982 
size
;

984 i‡(
d_Êag
 & 
DEBUG_SWAP
)

985 
	`debug_mesßge
("Sw≠Üöíÿf‹ %†‘e‡%d)\n", 
¥og
->
«me
);

987 i‡(!
¥og
->
löe_numbîs
)

989 
size
 = 
	`sw≠_£gmít
((*)
¥og
, 
£gm_desc
 + 
S_DBG
);

990 
tŸÆ_löío_sw≠≥d
 +
size
;

991 
num_sw≠≥d
++;

992 
	}
}

998 
	$lﬂd_löío_‰om_sw≠
(
¥ogøm
 *
¥og
)

1000 
size
;

1002 i‡(
¥og
->
löe_numbîs
)

1005 i‡(
¥og
->
sw≠_löío_ödex
 == 0)

1006 
	`Áèl
("LoadingÇot swappedÜinenoinfo.\n");

1008 
size
 = 
	`unsw≠_£gmít
((*)
¥og
, 
£gm_desc
 + 
S_DBG
);

1009 
tŸÆ_löío_sw≠≥d
 -
size
;

1010 
num_sw≠≥d
--;

1012 
	}
}

1015 
	$sw≠_¥ogøm
(
¥ogøm
 *
¥og
)

1017 
size
;

1019 i‡(
¥og
->
löe_numbîs
)

1020 
	`sw≠_löío
(
¥og
);

1021 i‡(
¥og
->
¥ogøm
 == (*)0)

1023 i‡(
d_Êag
 & 
DEBUG_SWAP
) {

1024 
	`debug_mesßge
("Sw≠Örogøm %†‘e‡%d)\n", 
¥og
->
«me
,Örog->
ªf
);

1027 
size
 = 
	`sw≠_£gmít
((*)
¥og
, 
£gm_desc
 + 
S_EXEQ
);

1028 
tŸÆ_¥ogøm_size
 -
size
;

1029 
¥ogøm_byãs_sw≠≥d
 +
size
;

1030 
¥ogøms_sw≠≥d
++;

1031 
sw≠_out_¥og
++;

1032 
num_sw≠≥d
++;

1033 
	}
}

1036 
	$lﬂd_¥og_‰om_sw≠
(
¥ogøm
 *
¥og
)

1038 
size
;

1040 i‡(
¥og
->
¥ogøm
 !(*)0 ||Örog->
sw≠_num
 == 0)

1043 i‡(
d_Êag
 & 
DEBUG_SWAP
) {

1044 
	`debug_mesßge
("Unsw≠Örogøm %†‘e‡%d)\n", 
¥og
->
«me
,Örog->
ªf
);

1047 
size
 = 
	`unsw≠_£gmít
((*)
¥og
, 
£gm_desc
 + 
S_EXEQ
);

1048 
sw≠_ö_¥og
++;

1049 
tŸÆ_¥ogøm_size
 +
size
;

1050 
¥ogøm_byãs_sw≠≥d
 -
size
;

1051 
¥ogøms_sw≠≥d
--;

1052 
num_sw≠≥d
--;

1053 
	}
}

1056 
	$ªmove_ob_‰om_sw≠
(
obje˘
 *
ob
)

1058 i‡(
ob
->
Êags
 & 
O_SWAPPED
)

1059 
	`lﬂd_ob_‰om_sw≠
(
ob
);

1060 
	}
}

1063 
	$ªmove_¥og_‰om_sw≠
(
¥ogøm
 *
¥og
)

1065 i‡(
¥og
->
sw≠_num
 != 0)

1066 i‡(
¥og
->
¥ogøm
 == (*)0)

1067 
	`lﬂd_¥og_‰om_sw≠
(
¥og
);

1069 i‡(
¥og
->
sw≠_löío_ödex
 != 0)

1070 
	`lﬂd_löío_‰om_sw≠
(
¥og
);

1071 
	}
}

1073 #ifde‡
DO_CLEANUP


1075 
	$åy_˛ón_up
(
obje˘
 *
ob
)

1077 
gdex˚±i⁄
 
ex˚±i⁄_‰ame
;

1078 
evÆ_co°
;

1079 
svÆue
 *
ªt
;

1085 i‡(
ob
->
Êags
 & 
O_WILL_CLEAN_UP
)

1087 
tŸÆ_˛ón_ups
++;

1089 i‡(
d_Êag
 & 
DEBUG_CLEAN_UP
)

1090 
	`Ârötf
(
°dîr
, "˛ó¿u∞%s\n", 
sw≠_ob
->
«me
);

1092 
ex˚±i⁄_‰ame
.
e_ex˚±i⁄
 = 
ex˚±i⁄
;

1093 
ex˚±i⁄_‰ame
.
e_ˇtch
 = 0;

1094 
ex˚±i⁄
 = &
ex˚±i⁄_‰ame
;

1103 i‡(
	`£tjmp
(
ex˚±i⁄_‰ame
.
e_c⁄ãxt
))

1105 
	`˛ór_°©e
();

1107 
	`˛ór_°©e
();

1108 
	`debug_mesßge
("Error in clean_up.\n");

1109 
ªt
 = 
NULL
;

1113 
evÆ_co°
 = 0;

1114 
	`push_numbî
(
ob
->
Êags
 & (
O_CLONE
|
O_SWAPPED
Ë? 0 : ob->
¥og
->
ªf
);

1115 
ªt
 = 
	`≠∂y
("˛ón_up", 
ob
, 1, 0);

1117 
ex˚±i⁄
 = 
ex˚±i⁄_‰ame
.
e_ex˚±i⁄
;

1118 i‡(
ob
->
Êags
 & 
O_DESTRUCTED
)

1120 
˛ón_up_de°ru˘s
++;

1121  
FALSE
;

1123 i‡(
ªt
 =
NULL
 ||

1124 (
ªt
->
ty≥
 =
T_NUMBER
 &&Ñë->
u
.
numbî
 == 0))

1126 
˛ón_up_ªtu∫0
++;

1127 
ob
->
Êags
 &~
O_WILL_CLEAN_UP
;

1131 
˛ón_up_ªtu∫1
++;

1134  
TRUE
;

1135 
	}
}

1139 
	$åy_to_sw≠
(vﬁ©ûê*
öãru±ed
)

1141 
sw≠_time
;

1145 i‡(
sw≠_ob
 && 
sw≠_¥og
 && 
u£d_mem‹y
 >
mö_sw≠_mem‹y
)

1146 
sw≠_ob
 !
obj_li°
 && 
sw≠_¥og
 !
¥og_li°
)

1148 
sw≠_time
 = (
u£d_mem‹y
 < 
max_sw≠_mem‹y
) ?

1149 
max_sw≠_time
 : 
mö_sw≠_time
;

1151 i‡(
sw≠_ob
->
time_of_ªf
 > 
sw≠_¥og
->time_of_ref)

1153 i‡(
cuºít_time
 - 
sw≠_¥og
->
time_of_ªf
 < 
sw≠_time
)

1155 
	`sw≠_¥ogøm
(
sw≠_¥og
);

1156 
sw≠_¥og
 = sw≠_¥og->
¥ev_Æl
;

1160 i‡(
cuºít_time
 - 
sw≠_ob
->
time_of_ªf
 < 
sw≠_time
)

1163 #ifde‡
DO_CLEANUP


1164 i‡(
	`åy_˛ón_up
(
sw≠_ob
))

1165 
	`sw≠_obje˘
(
sw≠_ob
);

1167 
	`sw≠_obje˘
(
sw≠_ob
);

1170 
sw≠_ob
 = sw≠_ob->
¥ev_Æl
;

1172 i‡(*
öãru±ed
)

1175 
	}
}

	@swap.h

1 #ifde‡
USE_SWAP


2 
öô_sw≠
();

3 
lﬂd_ob_‰om_sw≠
(
obje˘
 *);

4 
lﬂd_¥og_‰om_sw≠
(
¥ogøm
 *
¥og
);

5 
lﬂd_löío_‰om_sw≠
(
¥ogøm
 *
¥og
);

6 
sw≠_löío
(
¥ogøm
 *
¥og
);

7 
ªmove_ob_‰om_sw≠
(
obje˘
 *
ob
);

8 
ªmove_¥og_‰om_sw≠
(
¥ogøm
 *
¥og
);

	@sysmalloc.c

5 
	~<°dio.h
>

6 
	~<°dlib.h
>

7 
	~<°rög.h
>

8 #i‡!
deföed
(
__NëBSD__
Ë&& !deföed(
__FªeBSD__
Ë&& !deföed(
__bsdi__
) && \

9 !
	$deföed
(
__O≥nBSD__
)

10 
	~<mÆloc.h
>

13 *
	`dump_mÆloc_d©a
();

14 
	`sysmÆloc_öô
();

17 
	$sysmÆloc_öô
()

19 #i‡!
	`deföed
(
__NëBSD__
Ë&& !deföed(
__FªeBSD__
Ë&& !deföed(
__bsdi__
) && \

20 !
	`deföed
(
__O≥nBSD__
)

21 
	`mÆl›t
(
M_MXFAST
, 100);

22 
	`mÆl›t
(
M_NLBLKS
, 1000);

23 
	`mÆl›t
(
M_GRAIN
, 8);

25 
	}
}

27 
	#dump_°©
(
°r
Ë()
	`°rˇt
(
mbuf
, så)

	)

28 
	#dump_°©1
(
°r
,
p
Ë()
	`•rötf
(
smbuf
,°r,p); ()
	`°rˇt
(
mbuf
, smbuf)

	)

29 
	#dump_°©2
(
°r
,
°©
,
°©2
Ë()
	`•rötf
(
smbuf
,°r,°©,°©2); ()
	`°rˇt
(
mbuf
,smbuf)

	)

32 
	$dump_mÆloc_d©a
()

34 #i‡
	`deföed
(
__NëBSD__
Ë|| deföed(
__FªeBSD__
Ë|| deföed(
__bsdi__
) || \

35 
	`deföed
(
__O≥nBSD__
)

38 
mbuf
[1024];

39 
smbuf
[100];

40 
mÆlöfo
 
mem
;

42 
mem
 = 
	`mÆlöfo
();

44 #i‡
	`deföed
(
__osf__
Ë|| deföed(
_SEQUENT_
Ë|| deföed(
SOLARIS
)

45 ()
	`°r˝y
(
mbuf
,"Type Count Space (bytes)\n");

46 
	`dump_°©2
("sbrkÑequests: %8d %10d (a)\n",

47 
mem
.
‹dblks
, mem.
¨ía
);

48 
	`dump_°©2
("large blocks: %8d %10d (b)\n",

49 0, 
mem
.
u‹dblks
);

50 
	`dump_°©2
("large free blocks: %8d %10d (c)\n\n",

51 0, 
mem
.
f‹dblks
);

52 
	`dump_°©2
("small blocks: %8d %10d (e)\n",

53 
mem
.
smblks
, mem.
usmblks
);

54 
	`dump_°©2
("small free blocks: %8d %10d (f)\n",

55 0, 
mem
.
fsmblks
);

58 ()
	`°r˝y
(
mbuf
,"Type Count Space (bytes)\n");

59 
	`dump_°©2
("sbrkÑequests: %8d %10d (a)\n",

60 
mem
.
‹dblks
, mem.
¨ía
);

61 
	`dump_°©2
("large blocks: %8d %10d (b)\n",

62 
mem
.
Æloˇãd
, mem.
u‹dblks
);

63 
	`dump_°©2
("large free blocks: %8d %10d (c)\n\n",

64 
mem
.
‹dblks
 - mem.
Æloˇãd
, mem.
f‹dblks
);

65 
	`dump_°©2
("small blocks: %8d %10d (e)\n",

66 0, 
mem
.
usmblks
);

67 
	`dump_°©2
("small free blocks: %8d %10d (f)\n",

68 0, 
mem
.
fsmblks
);

70  
mbuf
;

72 
	}
}

	@tcpsvc.c

32 
	~<°dio.h
>

33 
	~<°rög.h
>

34 
	~<î∫o.h
>

35 
	~<uni°d.h
>

36 
	~<sys/ty≥s.h
>

37 
	~<sys/sockë.h
>

38 
	~<√töë/ö.h
>

39 
	~<¨∑/öë.h
>

40 
	~"c⁄fig.h
"

41 
	~"löt.h
"

42 
	~"öãΩªt.h
"

43 
	~"simuœã.h
"

44 
	~"ndesc.h
"

45 
	~"nqueue.h
"

46 
	~"√t.h
"

48 #i‚de‡
INADDR_LOOPBACK


49 
	#INADDR_LOOPBACK
 0x7f000001

	)

52 #i‚de‡
EPROTO


53 
	#EPROTO
 
EPROTOTYPE


	)

56 #ifde‡
SERVICE_PORT


66 
u_ch¨
 
	mts_Êags
;

67 
nqueue_t
 * 
	mts_ˇnq
;

68 
nqueue_t
 * 
	mts_øwq
;

69 } 
	tt˝svc_t
;

74 
	#TF_CLOSE
 0x01

	)

75 
	#TF_ENABC
 0x02

	)

76 
	#TF_ENABR
 0x04

	)

81 
	#TCPSVC_RAWQ_SIZE
 1536

	)

82 
	#TCPSVC_CANQ_SIZE
 1536

	)

87 
	#TCPSVC_MAX
 32

	)

89 
ndesc_t
 *
	gt˝svc_nd
 = 
NULL
;

90 
	gt˝svc_cou¡
 = 0;

95 
t˝svc_t
 *

96 
	$t˝svc_Æloc
()

98 
t˝svc_t
 *
t•
;

100 
t•
 = 
	`xÆloc
( (
t˝svc_t
));

101 
t•
->
ts_Êags
 = 
TF_ENABC
;

102 
t•
->
ts_øwq
 = 
	`nq_Æloc
(
TCPSVC_RAWQ_SIZE
);

103 
t•
->
ts_ˇnq
 = 
	`nq_Æloc
(
TCPSVC_CANQ_SIZE
);

105  
t•
;

106 
	}
}

112 
	$t˝svc_‰ì
(
t˝svc_t
 *
t•
)

114 
	`nq_‰ì
(
t•
->
ts_øwq
);

115 
	`nq_‰ì
(
t•
->
ts_ˇnq
);

116 
	`‰ì
(
t•
);

117 
	}
}

123 
	$t˝svc_disc⁄√˘
(
ndesc_t
 *
nd
, 
t˝svc_t
 *
t•
)

125 i‡(
t•
->
ts_Êags
 & 
TF_CLOSE
)

128 
t•
->
ts_Êags
 |
TF_CLOSE
;

129 
	`nd_íabÀ
(
nd
, 
ND_C
);

130 
	}
}

136 
	$t˝svc_ªad
(
ndesc_t
 *
nd
, 
t˝svc_t
 *
t•
)

138 
cc
;

140 i‡(!
	`nq_fuŒ
(
t•
->
ts_øwq
))

142 
cc
 = 
	`nq_ªcv
(
t•
->
ts_øwq
, 
	`nd_fd
(
nd
), 
NULL
);

143 i‡(
cc
 == -1)

145 
î∫o
)

147 
EWOULDBLOCK
:

148 
EINTR
:

149 
EPROTO
:

153 
	`t˝svc_disc⁄√˘
(
nd
, 
t•
);

158 i‡(
cc
 == 0)

160 
	`t˝svc_disc⁄√˘
(
nd
, 
t•
);

164 i‡(
t•
->
ts_Êags
 & 
TF_ENABC
)

166 
t•
->
ts_Êags
 &~
TF_ENABC
;

167 
	`nd_íabÀ
(
nd
, 
ND_C
);

170 i‡(!
	`nq_fuŒ
(
t•
->
ts_øwq
))

174 
t•
->
ts_Êags
 |
TF_ENABR
;

175 
	`nd_dißbÀ
(
nd
, 
ND_R
);

176 
	}
}

182 
	$t˝svc_wrôe
(
ndesc_t
 *
nd
, 
t˝svc_t
 *
t•
)

184 i‡(!
	`nq_em±y
(
t•
->
ts_ˇnq
))

186 i‡(
	`nq_£nd
(
t•
->
ts_ˇnq
, 
	`nd_fd
(
nd
), 
NULL
) == -1)

188 
î∫o
)

190 
EWOULDBLOCK
:

191 
EINTR
:

192 
EPROTO
:

196 
	`t˝svc_disc⁄√˘
(
nd
, 
t•
);

201 i‡(!
	`nq_em±y
(
t•
->
ts_ˇnq
))

205 
	`nq_öô
(
t•
->
ts_ˇnq
);

207 
	`nd_dißbÀ
(
nd
, 
ND_W
);

208 
	`nd_íabÀ
(
nd
, 
ND_C
);

209 
	}
}

215 
	$t˝svc_shutdown
(
ndesc_t
 *
nd
, 
t˝svc_t
 *
t•
)

217 i‡(
t•
 !
NULL
)

219 
	`t˝svc_‰ì
(
t•
);

220 
t˝svc_cou¡
--;

224 
t˝svc_nd
 = 
NULL
;

227 ()
	`˛o£
(
	`nd_fd
(
nd
));

228 
	`nd_dëach
(
nd
);

229 
	}
}

235 
	$t˝svc_˛ónup
(
ndesc_t
 *
nd
, 
t˝svc_t
 *
t•
)

237 
u_ch¨
 
c
;

238 
svÆue
 *
svp
;

239 
gdex˚±i⁄
 
ex˚±i⁄_‰ame
;

241 i‡(
t•
->
ts_Êags
 & 
TF_CLOSE
)

243 
	`t˝svc_shutdown
(
nd
, 
t•
);

249 i‡(
	`nq_em±y
(
t•
->
ts_øwq
))

251 
	`nq_öô
(
t•
->
ts_øwq
);

252 i‡(
t•
->
ts_Êags
 & 
TF_ENABR
)

254 
t•
->
ts_Êags
 &~
TF_ENABR
;

255 
	`nd_íabÀ
(
nd
, 
ND_R
);

257 
t•
->
ts_Êags
 |
TF_ENABC
;

258 
	`nd_dißbÀ
(
nd
, 
ND_C
);

261 
c
 = 
	`nq_gëc
(
t•
->
ts_øwq
);

262 i‡(
c
 == '\n')

264 i‡(!
	`nq_fuŒ
(
t•
->
ts_ˇnq
))

265 
	`nq_putc
(
t•
->
ts_ˇnq
, 
c
);

268 
	`nd_dißbÀ
(
nd
, 
ND_C
);

269 
	`nd_íabÀ
(
nd
, 
ND_W
);

271 i‡(
	`nq_fuŒ
(
t•
->
ts_ˇnq
))

273 
	`nq_öô
(
t•
->
ts_ˇnq
);

274 
	`nq_puts
(
t•
->
ts_ˇnq
, (
u_ch¨
 *)"ERROR ServiceÑequestÅooÜong.\n");

275 
	`t˝svc_disc⁄√˘
(
nd
, 
t•
);

279 
	`nq_putc
(
t•
->
ts_ˇnq
, '\0');

281 
ex˚±i⁄_‰ame
.
e_ex˚±i⁄
 = 
ex˚±i⁄
;

282 
ex˚±i⁄_‰ame
.
e_ˇtch
 = 0;

284 
ex˚±i⁄
 = &
ex˚±i⁄_‰ame
;

286 i‡(
	`£tjmp
(
ex˚±i⁄_‰ame
.
e_c⁄ãxt
) == 0)

288 
	`push_°rög
((*)
	`nq_Ωå
(
t•
->
ts_ˇnq
), 
STRING_MSTRING
);

289 
svp
 = 
	`≠∂y_ma°î_ob
(
M_INCOMING_SERVICE
, 1);

293 
svp
 = 
NULL
;

296 
ex˚±i⁄
 =Éx˚±i⁄->
e_ex˚±i⁄
;

298 
	`nq_öô
(
t•
->
ts_ˇnq
);

300 i‡(
svp
 =
NULL
 || svp->
ty≥
 !
T_STRING
)

302 
	`nq_puts
(
t•
->
ts_ˇnq
, (
u_ch¨
 *)"ERROR Service callsÇot supported.\n");

303 
	`t˝svc_disc⁄√˘
(
nd
, 
t•
);

307 i‡(
	`°æí
(
svp
->
u
.
°rög
Ë> 
	`nq_size
(
t•
->
ts_ˇnq
))

309 
	`nq_puts
(
t•
->
ts_ˇnq
, (
u_ch¨
 *)"ERROR ServiceÑesponseÅooÜong.\n");

310 
	`t˝svc_disc⁄√˘
(
nd
, 
t•
);

314 
	`nq_puts
(
t•
->
ts_ˇnq
, (
u_ch¨
 *)
svp
->
u
.
°rög
);

316 
	}
}

322 
	$t˝svc_ac˚±
(
ndesc_t
 *
nd
, *
vp
)

324 
s
, 
addæí
;

325 
sockaddr_ö
 
addr
;

326 
t˝svc_t
 *
t•
;

328 
addæí
 =  (
addr
);

330 
s
 = 
	`ac˚±
(
	`nd_fd
(
nd
), (
sockaddr
 *)&
addr
, &
addæí
);

331 i‡(
s
 == -1)

333 
î∫o
)

336 
	`Áèl
("svc_£rvî:ác˚±(Ëî∫ÿ%d.\n", 
î∫o
);

337 
EWOULDBLOCK
:

338 
EINTR
:

339 
EPROTO
:

340 
ECONNRESET
:

345 i‡(
addr
.
sö_addr
.
s_addr
 !
	`ht⁄l
(
INADDR_LOOPBACK
))

347 #ifde‡
ALLOWED_SERVICE


348 i‡(
addr
.
sö_addr
.
s_addr
 !
	`ht⁄l
(
ALLOWED_SERVICE
))

351 ()
	`Ârötf
(
°dîr
, "SERVICE PORT ACCESS FROM %s %d\n",

352 
	`öë_¡ﬂ
(
addr
.
sö_addr
), 
	`¡ohs
◊ddr.
sö_p‹t
));

353 ()
	`˛o£
(
s
);

358 
	`íabÀ_nbio
(
s
);

360 
t•
 = 
	`t˝svc_Æloc
();

361 
nd
 = 
	`nd_©èch
(
s
, 
t˝svc_ªad
, 
t˝svc_wrôe
, 
NULL
, 
t˝svc_˛ónup
,

362 
t˝svc_shutdown
, 
t•
);

364 i‡(++
t˝svc_cou¡
 > 
TCPSVC_MAX
)

366 
	`nq_puts
(
t•
->
ts_ˇnq
, (
u_ch¨
 *)"ERROR Too many services in use.\n");

367 
	`nd_íabÀ
(
nd
, 
ND_W
);

368 
	`t˝svc_disc⁄√˘
(
nd
, 
t•
);

372 
	`nd_íabÀ
(
nd
, 
ND_R
);

373 
	}
}

379 
	$t˝svc_öô
()

381 
£rvi˚_p‹t
;

382 
s
;

383 
sockaddr_ö
 
addr
;

385 i‡(
£rvi˚_p‹t
 < 0)

388 
s
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 
IPPROTO_TCP
);

389 i‡(
s
 == -1)

392 
	`íabÀ_ªu£addr
(
s
);

394 
	`mem£t
(&
addr
, 0,  (addr));

395 
addr
.
sö_Ámûy
 = 
AF_INET
;

396 
addr
.
sö_p‹t
 = 
	`ht⁄s
((
u_sh‹t
)
£rvi˚_p‹t
);

397 
addr
.
sö_addr
.
s_addr
 = 
INADDR_ANY
;

399 i‡(
	`böd
(
s
, (
sockaddr
 *)&
addr
,  (addr)) == -1)

401 ()
	`˛o£
(
s
);

405 i‡(
	`li°í
(
s
, 5) == -1)

407 ()
	`˛o£
(
s
);

411 
	`íabÀ_nbio
(
s
);

413 
t˝svc_nd
 = 
	`nd_©èch
(
s
, 
t˝svc_ac˚±
, 
NULL
, NULL, NULL,

414 
t˝svc_shutdown
, 
NULL
);

415 
	`nd_íabÀ
(
t˝svc_nd
, 
ND_R
);

416 
	}
}

	@tcpsvc.h

32 
t˝svc_öô
();

33 
t˝svc_shutdown
();

	@telnet.c

32 
	~<°dio.h
>

33 
	~<°rög.h
>

34 
	~<î∫o.h
>

35 
	~<uni°d.h
>

36 
	~<sys/ty≥s.h
>

37 
	~<sys/sockë.h
>

38 
	~<√töë/ö.h
>

39 
	~<¨∑/ã ë.h
>

40 
	~"c⁄fig.h
"

41 
	~"∑tchÀvñ.h
"

42 
	~"löt.h
"

43 
	~"maö.h
"

44 
	~"öãΩªt.h
"

45 
	~"simuœã.h
"

46 
	~"nqueue.h
"

47 
	~"ndesc.h
"

48 
	~"√t.h
"

49 
	~"ã ë.h
"

50 
	~"comm.h
"

52 
	göãø˘ive
;

54 #i‚de‡
EPROTO


55 
	#EPROTO
 
EPROTOTYPE


	)

65 
	#TELNET_CANQ_SIZE
 512

	)

66 
	#TELNET_RAWQ_SIZE
 256

	)

67 
	#TELNET_OPTQ_SIZE
 512

	)

68 
	#TELNET_OUTQ_SIZE
 (8192 + 1024)

	)

73 
	#TELNET_OUTQ_LOWAT
 256

	)

74 
	#TELNET_OUTQ_HIWAT
 (
TELNET_OUTQ_SIZE
 - 256)

	)

83 
	#TELNET_OUTQ_REQUIRED
 12

	)

91 
	#TELNET_RCVBUF_SIZE
 1024

	)

92 
	#TELNET_SNDBUF_SIZE
 
TELNET_OUTQ_SIZE


	)

97 
	#NUL
 0

	)

98 
	#BEL
 7

	)

99 
	#BS
 8

	)

100 
	#LF
 10

	)

101 
	#CR
 13

	)

102 
	#DEL
 127

	)

107 
ã ë_t
 *

108 
	$ã ë_Æloc
()

110 
i
;

111 
ã ë_t
 *
ç
;

113 
ç
 = 
	`xÆloc
( (
ã ë_t
));

114 
ç
->
t_Êags
 = 
TF_ENABW
;

115 
ç
->
t_°©e
 = 
TS_DATA
;

116 
ç
->
t_nd
 = 
NULL
;

117 
ç
->
t_øwq
 = 
	`nq_Æloc
(
TELNET_RAWQ_SIZE
);

118 
ç
->
t_ˇnq
 = 
	`nq_Æloc
(
TELNET_CANQ_SIZE
);

119 
ç
->
t_›tq
 = 
NULL
;

120 
ç
->
t_outq
 = 
	`nq_Æloc
(
TELNET_OUTQ_SIZE
);

121 
ç
->
t_ù
 = 
NULL
;

122 
ç
->
t_rbÀn
 = 0;

123 
ç
->
t_sbÀn
 = 0;

125 
i
 = 0; i < 
OP_SIZE
; i++)

127 
ç
->
t_›tb
[
i
].
o_us
 = 
OS_NO
;

128 
ç
->
t_›tb
[
i
].
o_usq
 = 
OQ_EMPTY
;

129 
ç
->
t_›tb
[
i
].
o_him
 = 
OS_NO
;

130 
ç
->
t_›tb
[
i
].
o_himq
 = 
OQ_EMPTY
;

133  
ç
;

134 
	}
}

140 
	$ã ë_‰ì
(
ã ë_t
 *
ç
)

142 
	`nq_‰ì
(
ç
->
t_øwq
);

143 
	`nq_‰ì
(
ç
->
t_ˇnq
);

144 i‡(
ç
->
t_›tq
 !
NULL
)

145 
	`nq_‰ì
(
ç
->
t_›tq
);

146 
	`nq_‰ì
(
ç
->
t_outq
);

147 
	`‰ì
(
ç
);

148 
	}
}

154 
	$ã ë_©èch
(
ã ë_t
 *
ç
, 
öãø˘ive
 *
ù
)

156 
ç
->
t_Êags
 |
TF_ATTACH
;

157 
ç
->
t_ù
 = 
ù
;

158 
	}
}

164 
	$ã ë_dëach
(
ã ë_t
 *
ç
)

166 i‡((
ç
->
t_Êags
 & 
TF_ATTACH
) == 0)

169 
ç
->
t_Êags
 ^
TF_ATTACH
;

170 
ç
->
t_ù
 = 
NULL
;

172 
	`nd_íabÀ
(
ç
->
t_nd
, 
ND_C
);

173 
	}
}

179 
	$ã ë_Êush
(
ã ë_t
 *
ç
)

181 i‡(!
	`nq_em±y
(
ç
->
t_outq
))

182 
	`nq_£nd
(
ç
->
t_outq
, 
	`nd_fd
—p->
t_nd
), &ç->
t_sbÀn
);

183 
	}
}

189 
	$ã ë_íabr
(
ã ë_t
 *
ç
)

191 i‡(
ç
->
t_Êags
 & 
TF_ENABR
)

193 
ç
->
t_Êags
 &~
TF_ENABR
;

194 
	`nd_íabÀ
(
ç
->
t_nd
, 
ND_R
);

196 
	}
}

202 
	$ã ë_íabw
(
ã ë_t
 *
ç
)

204 i‡(
ç
->
t_Êags
 & 
TF_ENABW
)

206 
ç
->
t_Êags
 &~
TF_ENABW
;

207 
	`nd_íabÀ
(
ç
->
t_nd
, 
ND_W
);

209 
	}
}

215 
	$ã ë_ouçut
(
ã ë_t
 *
ç
, 
u_ch¨
 *
˝
)

217 
Àn
;

218 
u_ch¨
 
c
, *
bp
, 
buf
[
TELNET_OUTQ_SIZE
 + 3];

220 i‡(
ç
->
t_Êags
 & 
TF_OVFLOUTQ
)

223 
bp
 = 
buf
;

225 
bp
 < &
buf
[
TELNET_OUTQ_SIZE
] && *
˝
 != '\0')

227 
c
 = *
˝
++;

228 
c
)

230 
LF
:

231 *
bp
++ = 
CR
;

234 
IAC
:

235 *
bp
++ = 
IAC
;

238 *
bp
++ = 
c
;

241 *
bp
 = '\0';

243 
Àn
 = 
bp
 - 
buf
;

245 i‡(
Àn
 == 0)

248 i‡(
	`nq_Àn
(
ç
->
t_outq
Ë+ 
Àn
 >
TELNET_OUTQ_HIWAT
)

250 
	`ã ë_Êush
(
ç
);

251 i‡(
	`nq_Àn
(
ç
->
t_outq
Ë+ 
Àn
 >
TELNET_OUTQ_HIWAT
)

253 
ç
->
t_Êags
 |
TF_OVFLOUTQ
;

254 
	`ã ë_íabw
(
ç
);

259 
	`nq_puts
(
ç
->
t_outq
, 
buf
);

261 
	`ã ë_íabw
(
ç
);

262 
	}
}

268 
	$ã ë_disc⁄√˘
(
ã ë_t
 *
ç
)

270 i‡((
ç
->
t_Êags
 & 
TF_ATTACH
) == 0)

273 
	`ªmove_öãø˘ive
(
ç
->
t_ù
, 1);

274 
	}
}

280 
	$ã ë_ˇnq_putc
(
ã ë_t
 *
ç
, 
u_ch¨
 
c
)

282 i‡(
ç
->
t_Êags
 & (
TF_OVFLCANQ
 | 
TF_SYNCH
))

285 i‡(!
	`nq_fuŒ
(
ç
->
t_ˇnq
))

287 
	`nq_putc
(
ç
->
t_ˇnq
, 
c
);

291 
ç
->
t_Êags
 |
TF_OVFLCANQ
;

292 i‡(
	`nq_avaû
(
ç
->
t_outq
) > 0)

294 
	`nq_putc
(
ç
->
t_outq
, 
BEL
);

295 
	`ã ë_íabw
(
ç
);

298 
	}
}

304 
	$ã ë_›tq_putc
(
ã ë_t
 *
ç
, 
u_ch¨
 
c
)

306 i‡(
ç
->
t_Êags
 & 
TF_OVFLOPTQ
)

309 i‡(!
	`nq_fuŒ
(
ç
->
t_›tq
))

310 
	`nq_putc
(
ç
->
t_›tq
, 
c
);

312 
ç
->
t_Êags
 |
TF_OVFLOPTQ
;

313 
	}
}

319 
	$ã ë_eﬁ
(
ã ë_t
 *
ç
)

321 *
˝
;

323 i‡(
ç
->
t_Êags
 & 
TF_SYNCH
)

326 i‡(
	`nq_fuŒ
(
ç
->
t_ˇnq
))

328 
ç
->
t_Êags
 &~
TF_OVFLCANQ
;

329 
˝
 = "";

333 
	`nq_putc
(
ç
->
t_ˇnq
, '\0');

334 
˝
 = (*)
	`nq_Ωå
(
ç
->
t_ˇnq
);

337 i‡(
ç
->
t_Êags
 & 
TF_ATTACH
)

338 
	`öãø˘ive_öput
(
ç
->
t_ù
, 
˝
);

340 
	`nq_öô
(
ç
->
t_ˇnq
);

342 
ç
->
t_Êags
 &~
TF_GA
;

343 
	}
}

349 
	$ã ë_dm
(
ã ë_t
 *
ç
)

351 i‡((
ç
->
t_Êags
 & 
TF_URGENT
) == 0)

352 
ç
->
t_Êags
 &~
TF_SYNCH
;

353 
	}
}

359 
	$ã ë_ayt
(
ndesc_t
 *
nd
, 
ã ë_t
 *
ç
)

361 
u_ch¨
 
vîsi⁄
[13];

363 
	`•rötf
(
vîsi⁄
, "[%6.8s%02d]\r\n", 
GAME_VERSION
, 
PATCH_LEVEL
);

365 
	`nq_puts
(
ç
->
t_outq
, 
vîsi⁄
);

367 
	`ã ë_íabw
(
ç
);

368 
	}
}

373 
INLINE
 

374 
	$ã ë_ec
(
ã ë_t
 *
ç
)

376 i‡(
ç
->
t_Êags
 & (
TF_OVFLCANQ
 | 
TF_SYNCH
))

379 i‡(!
	`nq_em±y
(
ç
->
t_ˇnq
))

380 
	`nq_u≈utc
(
ç
->
t_ˇnq
);

381 
	}
}

387 
	$ã ë_ñ
(
ã ë_t
 *
ç
)

389 i‡(
ç
->
t_Êags
 & (
TF_OVFLCANQ
 | 
TF_SYNCH
))

392 
	`nq_öô
(
ç
->
t_ˇnq
);

393 
	}
}

399 
	$ã ë_sb
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

401 i‡(
ç
->
t_›tq
 =
NULL
)

402 
ç
->
t_›tq
 = 
	`nq_Æloc
(
TELNET_OPTQ_SIZE
);

404 
ç
->
t_›t
 = 
›t
;

405 
	}
}

411 
	$ã ë_£
(
ã ë_t
 *
ç
)

413 
ç
->
t_Êags
 &~
TF_OVFLOPTQ
;

414 
	`nq_öô
(
ç
->
t_›tq
);

415 
	}
}

422 
›t_t
 *

423 
	$ã ë_gë_›ç
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

425 
›t
)

427 
TELOPT_ECHO
:

428  &
ç
->
t_›tb
[
OP_ECHO
];

430 
TELOPT_SGA
:

431  &
ç
->
t_›tb
[
OP_SGA
];

433 
TELOPT_CDM
:

434  &
ç
->
t_›tb
[
OP_CDM
];

437  
NULL
;

439 
	}
}

445 
	$ã ë_À«bp
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

447 
›t
)

449 
TELOPT_ECHO
:

452 
TELOPT_SGA
:

455 
TELOPT_CDM
:

461 
	}
}

467 
	$ã ë_ª«bp
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

469 
›t
)

471 
TELOPT_SGA
:

477 
	}
}

483 
	$ã ë_£nd_ga
(
ã ë_t
 *
ç
)

485 
nqueue_t
 *
nq
;

487 
nq
 = 
ç
->
t_outq
;

489 
	`nq_putc
(
nq
, 
IAC
);

490 
	`nq_putc
(
nq
, 
GA
);

491 
	`ã ë_íabw
(
ç
);

492 
	}
}

498 
	$ã ë_£nd_wûl
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

500 
nqueue_t
 *
nq
;

502 
nq
 = 
ç
->
t_outq
;

504 
	`nq_putc
(
nq
, 
IAC
);

505 
	`nq_putc
(
nq
, 
WILL
);

506 
	`nq_putc
(
nq
, 
›t
);

507 
	`ã ë_íabw
(
ç
);

508 
	}
}

514 
	$ã ë_£nd_w⁄t
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

516 
nqueue_t
 *
nq
;

518 
nq
 = 
ç
->
t_outq
;

520 
	`nq_putc
(
nq
, 
IAC
);

521 
	`nq_putc
(
nq
, 
WONT
);

522 
	`nq_putc
(
nq
, 
›t
);

523 
	`ã ë_íabw
(
ç
);

524 
	}
}

530 
	$ã ë_£nd_do
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

532 
nqueue_t
 *
nq
;

534 
nq
 = 
ç
->
t_outq
;

536 
	`nq_putc
(
nq
, 
IAC
);

537 
	`nq_putc
(
nq
, 
DO
);

538 
	`nq_putc
(
nq
, 
›t
);

539 
	`ã ë_íabw
(
ç
);

540 
	}
}

546 
	$ã ë_£nd_d⁄t
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

548 
nqueue_t
 *
nq
;

550 
nq
 = 
ç
->
t_outq
;

552 
	`nq_putc
(
nq
, 
IAC
);

553 
	`nq_putc
(
nq
, 
DONT
);

554 
	`nq_putc
(
nq
, 
›t
);

555 
	`ã ë_íabw
(
ç
);

556 
	}
}

562 
	$ã ë_ack_À«b
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

564 
›t
)

566 
TELOPT_SGA
:

567 
ç
->
t_Êags
 |
TF_SGA
;

570 
	}
}

576 
	$ã ë_ack_ldißb
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

578 
›t
)

580 
TELOPT_SGA
:

581 
ç
->
t_Êags
 &~
TF_SGA
;

584 
	}
}

590 
	$ã ë_ack_ª«b
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

592 
	}
}

598 
	$ã ë_ack_rdißb
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

600 
	}
}

606 
	$ã ë_√g_À«b
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

608 
›t_t
 *
›
;

610 
›
 = 
	`ã ë_gë_›ç
(
ç
, 
›t
);

611 i‡(
›
 =
NULL
)

614 
›
->
o_us
)

616 
OS_NO
:

617 
›
->
o_us
 = 
OS_WANTYES
;

618 
	`ã ë_£nd_wûl
(
ç
, 
›t
);

621 
OS_YES
:

624 
OS_WANTNO
:

625 
›
->
o_usq
)

627 
OQ_EMPTY
:

628 
›
->
o_usq
 = 
OQ_OPPOSITE
;

631 
OQ_OPPOSITE
:

636 
OS_WANTYES
:

637 
›
->
o_usq
)

639 
OQ_EMPTY
:

642 
OQ_OPPOSITE
:

643 
›
->
o_usq
 = 
OQ_EMPTY
;

648 
	}
}

654 
	$ã ë_√g_ldißb
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

656 
›t_t
 *
›
;

658 
›
 = 
	`ã ë_gë_›ç
(
ç
, 
›t
);

659 i‡(
›
 =
NULL
)

662 
›
->
o_us
)

664 
OS_NO
:

667 
OS_YES
:

668 
›
->
o_us
 = 
OS_WANTNO
;

669 
	`ã ë_£nd_w⁄t
(
ç
, 
›t
);

672 
OS_WANTNO
:

673 
›
->
o_usq
)

675 
OQ_EMPTY
:

678 
OQ_OPPOSITE
:

679 
›
->
o_usq
 = 
OQ_EMPTY
;

684 
OS_WANTYES
:

685 
›
->
o_usq
)

687 
OQ_EMPTY
:

688 
›
->
o_usq
 = 
OQ_OPPOSITE
;

691 
OQ_OPPOSITE
:

696 
	}
}

702 
	$ã ë_√g_ª«b
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

704 
›t_t
 *
›
;

706 
›
 = 
	`ã ë_gë_›ç
(
ç
, 
›t
);

707 i‡(
›
 =
NULL
)

710 
›
->
o_him
)

712 
OS_NO
:

713 
›
->
o_him
 = 
OS_WANTYES
;

714 
	`ã ë_£nd_do
(
ç
, 
›t
);

717 
OS_YES
:

720 
OS_WANTNO
:

721 
›
->
o_himq
)

723 
OQ_EMPTY
:

724 
›
->
o_himq
 = 
OQ_OPPOSITE
;

727 
OQ_OPPOSITE
:

732 
OS_WANTYES
:

733 
›
->
o_himq
)

735 
OQ_EMPTY
:

738 
OQ_OPPOSITE
:

739 
›
->
o_himq
 = 
OQ_EMPTY
;

744 
	}
}

751 
	$ã ë_√g_rdißb
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

753 
›t_t
 *
›
;

755 
›
 = 
	`ã ë_gë_›ç
(
ç
, 
›t
);

756 i‡(
›
 =
NULL
)

759 
›
->
o_him
)

761 
OS_NO
:

764 
OS_YES
:

765 
›
->
o_him
 = 
OS_WANTNO
;

766 
	`ã ë_£nd_d⁄t
(
ç
, 
›t
);

769 
OS_WANTNO
:

770 
›
->
o_himq
)

772 
OQ_EMPTY
:

775 
OQ_OPPOSITE
:

776 
›
->
o_himq
 = 
OQ_EMPTY
;

781 
OS_WANTYES
:

782 
›
->
o_himq
)

784 
OQ_EMPTY
:

785 
›
->
o_himq
 = 
OQ_OPPOSITE
;

788 
OQ_OPPOSITE
:

793 
	}
}

800 
	$ã ë_íabÀ_echo
(
ã ë_t
 *
ç
)

802 i‡(
	`nq_avaû
(
ç
->
t_outq
) < 3)

805 
	`ã ë_√g_À«b
(
ç
, 
TELOPT_ECHO
);

806 
	}
}

812 
	$ã ë_dißbÀ_echo
(
ã ë_t
 *
ç
)

814 i‡(
	`nq_avaû
(
ç
->
t_outq
) < 3)

817 
	`ã ë_√g_ldißb
(
ç
, 
TELOPT_ECHO
);

818 
	}
}

824 
	$ã ë_wûl
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

826 
›t_t
 *
›
;

828 
›
 = 
	`ã ë_gë_›ç
(
ç
, 
›t
);

829 i‡(
›
 =
NULL
)

831 
	`ã ë_£nd_d⁄t
(
ç
, 
›t
);

835 
›
->
o_him
)

837 
OS_NO
:

838 i‡(
	`ã ë_ª«bp
(
ç
, 
›t
))

840 
›
->
o_him
 = 
OS_YES
;

841 
	`ã ë_£nd_do
(
ç
, 
›t
);

842 
	`ã ë_ack_ª«b
(
ç
, 
›t
);

846 
	`ã ë_£nd_d⁄t
(
ç
, 
›t
);

850 
OS_YES
:

853 
OS_WANTNO
:

854 
›
->
o_himq
)

856 
OQ_EMPTY
:

857 
›
->
o_him
 = 
OS_NO
;

858 
	`ã ë_ack_rdißb
(
ç
, 
›t
);

861 
OQ_OPPOSITE
:

862 
›
->
o_him
 = 
OS_YES
;

863 
›
->
o_himq
 = 
OQ_EMPTY
;

864 
	`ã ë_ack_ª«b
(
ç
, 
›t
);

869 
OS_WANTYES
:

870 
›
->
o_himq
)

872 
OQ_EMPTY
:

873 
›
->
o_him
 = 
OS_YES
;

874 
	`ã ë_ack_ª«b
(
ç
, 
›t
);

877 
OQ_OPPOSITE
:

878 
›
->
o_him
 = 
OS_WANTNO
;

879 
›
->
o_himq
 = 
OQ_EMPTY
;

880 
	`ã ë_£nd_d⁄t
(
ç
, 
›t
);

884 
	}
}

890 
	$ã ë_w⁄t
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

892 
›t_t
 *
›
;

894 
›
 = 
	`ã ë_gë_›ç
(
ç
, 
›t
);

895 i‡(
›
 =
NULL
)

898 
›
->
o_him
)

900 
OS_NO
:

903 
OS_YES
:

904 
›
->
o_him
 = 
OS_NO
;

905 
	`ã ë_£nd_d⁄t
(
ç
, 
›t
);

906 
	`ã ë_ack_rdißb
(
ç
, 
›t
);

909 
OS_WANTNO
:

910 
›
->
o_himq
)

912 
OQ_EMPTY
:

913 
›
->
o_him
 = 
OS_NO
;

914 
	`ã ë_ack_rdißb
(
ç
, 
›t
);

917 
OQ_OPPOSITE
:

918 
›
->
o_him
 = 
OS_WANTYES
;

919 
›
->
o_himq
 = 
OQ_EMPTY
;

920 
	`ã ë_£nd_do
(
ç
, 
›t
);

925 
OS_WANTYES
:

926 
›
->
o_himq
)

928 
OQ_EMPTY
:

929 
›
->
o_him
 = 
OS_NO
;

930 
	`ã ë_ack_rdißb
(
ç
, 
›t
);

933 
OQ_OPPOSITE
:

934 
›
->
o_him
 = 
OS_NO
;

935 
›
->
o_himq
 = 
OQ_EMPTY
;

936 
	`ã ë_ack_rdißb
(
ç
, 
›t
);

941 
	}
}

947 
	$ã ë_do
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

949 
›t_t
 *
›
;

951 i‡(
›t
 =
TELOPT_TM
)

953 
	`ã ë_£nd_wûl
(
ç
, 
›t
);

957 
›
 = 
	`ã ë_gë_›ç
(
ç
, 
›t
);

958 i‡(
›
 =
NULL
)

960 
	`ã ë_£nd_w⁄t
(
ç
, 
›t
);

964 
›
->
o_us
)

966 
OS_NO
:

967 i‡(
	`ã ë_À«bp
(
ç
, 
›t
))

969 
›
->
o_us
 = 
OS_YES
;

970 
	`ã ë_£nd_wûl
(
ç
, 
›t
);

971 
	`ã ë_ack_À«b
(
ç
, 
›t
);

975 
	`ã ë_£nd_w⁄t
(
ç
, 
›t
);

979 
OS_YES
:

982 
OS_WANTNO
:

983 
›
->
o_usq
)

985 
OQ_EMPTY
:

986 
›
->
o_us
 = 
OS_NO
;

987 
	`ã ë_ack_ldißb
(
ç
, 
›t
);

990 
OQ_OPPOSITE
:

991 
›
->
o_us
 = 
OS_YES
;

992 
›
->
o_usq
 = 
OQ_EMPTY
;

993 
	`ã ë_ack_À«b
(
ç
, 
›t
);

998 
OS_WANTYES
:

999 
›
->
o_usq
)

1001 
OQ_EMPTY
:

1002 
›
->
o_us
 = 
OS_YES
;

1003 
	`ã ë_ack_À«b
(
ç
, 
›t
);

1006 
OQ_OPPOSITE
:

1007 
›
->
o_us
 = 
OS_WANTNO
;

1008 
›
->
o_usq
 = 
OQ_EMPTY
;

1009 
	`ã ë_£nd_w⁄t
(
ç
, 
›t
);

1013 
	}
}

1019 
	$ã ë_d⁄t
(
ã ë_t
 *
ç
, 
u_ch¨
 
›t
)

1021 
›t_t
 *
›
;

1023 
›
 = 
	`ã ë_gë_›ç
(
ç
, 
›t
);

1024 i‡(
›
 =
NULL
)

1027 
›
->
o_us
)

1029 
OS_NO
:

1032 
OS_YES
:

1033 
›
->
o_us
 = 
OS_NO
;

1034 
	`ã ë_£nd_w⁄t
(
ç
, 
›t
);

1035 
	`ã ë_ack_ldißb
(
ç
, 
›t
);

1038 
OS_WANTNO
:

1039 
›
->
o_usq
)

1041 
OQ_EMPTY
:

1042 
›
->
o_us
 = 
OS_NO
;

1043 
	`ã ë_ack_ldißb
(
ç
, 
›t
);

1046 
OQ_OPPOSITE
:

1047 
›
->
o_us
 = 
OS_WANTYES
;

1048 
›
->
o_usq
 = 
OQ_EMPTY
;

1049 
	`ã ë_£nd_wûl
(
ç
, 
›t
);

1054 
OS_WANTYES
:

1055 
›
->
o_usq
)

1057 
OQ_EMPTY
:

1058 
›
->
o_us
 = 
OS_NO
;

1059 
	`ã ë_ack_ldißb
(
ç
, 
›t
);

1062 
OQ_OPPOSITE
:

1063 
›
->
o_us
 = 
OS_NO
;

1064 
›
->
o_usq
 = 
OQ_EMPTY
;

1065 
	`ã ë_ack_ldißb
(
ç
, 
›t
);

1070 
	}
}

1077 
	$ã ë_öput
(
ndesc_t
 *
nd
, 
ã ë_t
 *
ç
)

1079 
u_ch¨
 
c
;

1081 !
	`nq_em±y
(
ç
->
t_øwq
))

1083 i‡(
	`nq_avaû
(
ç
->
t_outq
Ë< 
TELNET_OUTQ_REQUIRED
)

1085 
ç
->
t_Êags
 |
TF_FLOWC
;

1086 
	`nd_dißbÀ
(
nd
, 
ND_C
);

1090 
c
 = 
	`nq_gëc
(
ç
->
t_øwq
);

1092 
ç
->
t_°©e
)

1094 
TS_DATA
:

1095 
c
)

1097 
NUL
:

1100 
BS
:

1101 
	`ã ë_ec
(
ç
);

1104 
LF
:

1105 
	`ã ë_eﬁ
(
ç
);

1108 
CR
:

1109 
ç
->
t_°©e
 = 
TS_CR
;

1112 
DEL
:

1113 
	`ã ë_ec
(
ç
);

1116 
IAC
:

1117 
ç
->
t_°©e
 = 
TS_IAC
;

1121 
	`ã ë_ˇnq_putc
(
ç
, 
c
);

1126 
TS_CR
:

1127 
	`ã ë_eﬁ
(
ç
);

1128 
ç
->
t_°©e
 = 
TS_DATA
;

1131 
TS_IAC
:

1132 
ç
->
t_°©e
 = 
TS_DATA
;

1133 
c
)

1135 
DM
:

1136 
	`ã ë_dm
(
ç
);

1139 
AYT
:

1140 
	`ã ë_ayt
(
nd
, 
ç
);

1143 
EC
:

1144 
	`ã ë_ec
(
ç
);

1147 
EL
:

1148 
	`ã ë_ñ
(
ç
);

1151 
SB
:

1152 
ç
->
t_°©e
 = 
TS_IAC_SB
;

1155 
WILL
:

1156 
ç
->
t_°©e
 = 
TS_IAC_WILL
;

1159 
WONT
:

1160 
ç
->
t_°©e
 = 
TS_IAC_WONT
;

1163 
DO
:

1164 
ç
->
t_°©e
 = 
TS_IAC_DO
;

1167 
DONT
:

1168 
ç
->
t_°©e
 = 
TS_IAC_DONT
;

1171 
IAC
:

1172 
	`ã ë_ˇnq_putc
(
ç
, 
c
);

1177 
TS_IAC_SB
:

1178 
	`ã ë_sb
(
ç
, 
c
);

1179 
ç
->
t_°©e
 = 
TS_IAC_SB_DATA
;

1182 
TS_IAC_SB_DATA
:

1183 
c
)

1185 
IAC
:

1186 
ç
->
t_°©e
 = 
TS_IAC_SB_IAC
;

1190 
	`ã ë_›tq_putc
(
ç
, 
c
);

1195 
TS_IAC_SB_IAC
:

1196 
ç
->
t_°©e
 = 
TS_IAC_SB_DATA
;

1197 
c
)

1199 
SE
:

1200 
	`ã ë_£
(
ç
);

1201 
ç
->
t_°©e
 = 
TS_DATA
;

1204 
IAC
:

1205 
	`ã ë_›tq_putc
(
ç
, 
c
);

1210 
TS_IAC_WILL
:

1211 
	`ã ë_wûl
(
ç
, 
c
);

1212 
ç
->
t_°©e
 = 
TS_DATA
;

1215 
TS_IAC_WONT
:

1216 
	`ã ë_w⁄t
(
ç
, 
c
);

1217 
ç
->
t_°©e
 = 
TS_DATA
;

1220 
TS_IAC_DO
:

1221 
	`ã ë_do
(
ç
, 
c
);

1222 
ç
->
t_°©e
 = 
TS_DATA
;

1225 
TS_IAC_DONT
:

1226 
	`ã ë_d⁄t
(
ç
, 
c
);

1227 
ç
->
t_°©e
 = 
TS_DATA
;

1232 i‡((
ç
->
t_Êags
 & (
TF_SGA
 | 
TF_GA
)) == 0)

1234 i‡(
	`nq_avaû
(
ç
->
t_outq
) >= 2)

1236 
ç
->
t_Êags
 |
TF_GA
;

1237 
	`ã ë_£nd_ga
(
ç
);

1241 
	`nq_öô
(
ç
->
t_øwq
);

1243 
	`ã ë_íabr
(
ç
);

1245 
	`nd_dißbÀ
(
nd
, 
ND_C
);

1246 
	}
}

1252 
	$ã ë_ªad
(
ndesc_t
 *
nd
, 
ã ë_t
 *
ç
)

1254 
cc
;

1256 i‡(!
	`nq_fuŒ
(
ç
->
t_øwq
))

1258 i‡(
ç
->
t_Êags
 & 
TF_URGENT
)

1260 i‡(
	`©_m¨k
(
	`nd_fd
(
nd
)))

1262 
ç
->
t_Êags
 &~
TF_URGENT
;

1263 
	`nd_íabÀ
(
nd
, 
ND_X
);

1267 
cc
 = 
	`nq_ªcv
(
ç
->
t_øwq
, 
	`nd_fd
(
nd
), &ç->
t_rbÀn
);

1268 i‡(
cc
 == -1)

1270 
î∫o
)

1272 
EWOULDBLOCK
:

1273 
EINTR
:

1274 
EPROTO
:

1278 
	`ã ë_disc⁄√˘
(
ç
);

1283 i‡(
cc
 == 0)

1285 
	`ã ë_disc⁄√˘
(
ç
);

1289 i‡((
ç
->
t_Êags
 & 
TF_FLOWC
) == 0)

1290 
	`nd_íabÀ
(
nd
, 
ND_C
);

1292 
	`ã ë_íabr
(
ç
);

1294 i‡(!
	`nq_fuŒ
(
ç
->
t_øwq
))

1298 
ç
->
t_Êags
 |
TF_ENABR
;

1299 
	`nd_dißbÀ
(
nd
, 
ND_R
);

1300 
	}
}

1306 
	$ã ë_wrôe
(
ndesc_t
 *
nd
, 
ã ë_t
 *
ç
)

1308 i‡(!
	`nq_em±y
(
ç
->
t_outq
))

1310 i‡(
	`nq_£nd
(
ç
->
t_outq
, 
	`nd_fd
(
nd
), &ç->
t_sbÀn
) == -1)

1312 
î∫o
)

1314 
EWOULDBLOCK
:

1315 
EINTR
:

1316 
EPROTO
:

1320 
	`ã ë_disc⁄√˘
(
ç
);

1326 i‡(
ç
->
t_Êags
 & 
TF_OVFLOUTQ
)

1328 i‡(
	`nq_Àn
(
ç
->
t_outq
Ë< 
TELNET_OUTQ_LOWAT
)

1330 
ç
->
t_Êags
 &~
TF_OVFLOUTQ
;

1331 
	`nq_puts
(
ç
->
t_outq
, (
u_ch¨
 *)"*** Truncated. ***\r\n");

1335 i‡(
ç
->
t_Êags
 & 
TF_FLOWC
)

1337 i‡(
	`nq_Àn
(
ç
->
t_outq
Ë< 
TELNET_OUTQ_HIWAT
)

1339 
ç
->
t_Êags
 &~
TF_FLOWC
;

1340 
	`nd_íabÀ
(
nd
, 
ND_C
);

1344 i‡(!
	`nq_em±y
(
ç
->
t_outq
))

1347 
	`nq_öô
(
ç
->
t_outq
);

1349 
ç
->
t_Êags
 |
TF_ENABW
;

1350 
	`nd_dißbÀ
(
nd
, 
ND_W
);

1351 
	}
}

1357 
	$ã ë_ex˚±i⁄
(
ndesc_t
 *
nd
, 
ã ë_t
 *
ç
)

1359 
ç
->
t_Êags
 |
TF_SYNCH
 | 
TF_URGENT
;

1360 
	`nq_öô
(
ç
->
t_ˇnq
);

1361 
	`nd_dißbÀ
(
nd
, 
ND_X
);

1362 
	}
}

1368 
	$ã ë_shutdown
(
ndesc_t
 *
nd
, 
ã ë_t
 *
ç
)

1370 i‡(
ç
 !
NULL
)

1372 
	`ã ë_Êush
(
ç
);

1373 
	`ã ë_‰ì
(
ç
);

1376 ()
	`˛o£
(
	`nd_fd
(
nd
));

1377 
	`nd_dëach
(
nd
);

1378 
	}
}

1384 
	$ã ë_˛ónup
(
ndesc_t
 *
nd
, 
ã ë_t
 *
ç
)

1386 i‡((
ç
->
t_Êags
 & 
TF_ATTACH
) == 0)

1388 
	`ã ë_shutdown
(
nd
, 
ç
);

1392 
	`ã ë_öput
(
nd
, 
ç
);

1394 
	}
}

1400 
	$ã ë_ac˚±
(
ndesc_t
 *
nd
, *
vp
)

1402 
addæí
, 
s
;

1403 
sockaddr_ö
 
addr
;

1404 
ã ë_t
 *
ç
;

1405 *
ù
;

1407 
addæí
 =  (
addr
);

1409 
s
 = 
	`ac˚±
(
	`nd_fd
(
nd
), (
sockaddr
 *)&
addr
, &
addæí
);

1410 i‡(
s
 == -1)

1412 
î∫o
)

1415 
	`Áèl
("ã ë_ac˚±:ác˚±(Ëî∫ÿ%d.\n", 
î∫o
);

1416 
EWOULDBLOCK
:

1417 
EINTR
:

1418 
EPROTO
:

1419 
ECONNRESET
:

1424 
	`íabÀ_nbio
(
s
);

1425 
	`íabÀ_oobölöe
(
s
);

1426 
	`íabÀ_lowdñay
(
s
);

1427 
	`£t_rcvsize
(
s
, 
TELNET_RCVBUF_SIZE
);

1428 
	`£t_¢dsize
(
s
, 
TELNET_SNDBUF_SIZE
);

1430 
ç
 = 
	`ã ë_Æloc
();

1431 
nd
 = 
	`nd_©èch
(
s
, 
ã ë_ªad
, 
ã ë_wrôe
, 
ã ë_ex˚±i⁄
,

1432 
ã ë_˛ónup
, 
ã ë_shutdown
, 
ç
);

1433 
ç
->
t_nd
 = 
nd
;

1435 
ù
 = (*)
	`√w_∂ayî
(
ç
, &
addr
, 
addæí
);

1436 i‡(
ù
 =
NULL
)

1438 
	`ã ë_shutdown
(
nd
, 
ç
);

1442 
	`ã ë_©èch
(
ç
, 
ù
);

1443 
	`nd_íabÀ
(
nd
, 
ND_R
 | 
ND_X
 | 
ND_C
);

1445 
	}
}

1451 
	$ã ë_öô
(
u_sh‹t
 
p‹t
)

1453 
s
;

1454 
sockaddr_ö
 
addr
;

1455 
ndesc_t
 *
nd
;

1457 
s
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 
IPPROTO_TCP
);

1458 i‡(
s
 == -1)

1459 
	`Áèl
("ã ë_öô: sockë(Ëîr‹ = %d.\n", 
î∫o
);

1461 
	`íabÀ_ªu£addr
(
s
);

1463 
	`mem£t
(&
addr
, 0,  (addr));

1464 
addr
.
sö_Ámûy
 = 
AF_INET
;

1465 
addr
.
sö_p‹t
 = 
	`ht⁄s
(
p‹t
);

1466 
addr
.
sö_addr
.
s_addr
 = 
INADDR_ANY
;

1468 i‡(
	`böd
(
s
, (
sockaddr
 *)&
addr
,  (addr)) == -1)

1470 i‡(
î∫o
 =
EADDRINUSE
)

1472 ()
	`Ârötf
(
°dîr
, "Socketálready bound!\n");

1473 
	`debug_mesßge
("Socketálready bound!\n");

1474 
	`exô
(
î∫o
);

1478 
	`Áèl
("ã ë_öô: böd(Ëîr‹ = %d.\n", 
î∫o
);

1482 i‡(
	`li°í
(
s
, 5) == -1)

1483 
	`Áèl
("ã ë_öô:Üi°í(Ëîr‹ = %d.\n", 
î∫o
);

1485 
	`íabÀ_nbio
(
s
);

1487 
nd
 = 
	`nd_©èch
(
s
, 
ã ë_ac˚±
, 
NULL
, NULL, NULL, 
ã ë_shutdown
,

1488 
NULL
);

1489 
	`nd_íabÀ
(
nd
, 
ND_R
);

1490 
	}
}

	@telnet.h

36 
u_ch¨
 
	mo_us
;

37 
u_ch¨
 
	mo_usq
;

38 
u_ch¨
 
	mo_him
;

39 
u_ch¨
 
	mo_himq
;

40 } 
	t›t_t
;

45 
	#OS_NO
 0

	)

46 
	#OS_YES
 1

	)

47 
	#OS_WANTNO
 2

	)

48 
	#OS_WANTYES
 3

	)

53 
	#OQ_EMPTY
 0

	)

54 
	#OQ_OPPOSITE
 2

	)

59 
	#OP_ECHO
 0

	)

60 
	#OP_SGA
 1

	)

61 
	#OP_CDM
 2

	)

62 
	#OP_SIZE
 3

	)

68 
u_sh‹t
 
	mt_Êags
;

69 
u_ch¨
 
	mt_°©e
;

70 
u_ch¨
 
	mt_›t
;

71 
›t_t
 
	mt_›tb
[
OP_SIZE
];

72 
ndesc_t
 * 
	mt_nd
;

73 
nqueue_t
 * 
	mt_øwq
;

74 
nqueue_t
 * 
	mt_ˇnq
;Çqueue_à* 
	mt_›tq
;

75 
nqueue_t
 * 
	mt_outq
;

76 * 
	mt_ù
;

77 
u_öt
 
	mt_rbÀn
;

78 
u_öt
 
	mt_sbÀn
;

79 } 
	tã ë_t
;

84 
	#TF_ATTACH
 0x0001

	)

85 
	#TF_ENABR
 0x0002

	)

86 
	#TF_ENABW
 0x0004

	)

87 
	#TF_FLOWC
 0x0008

	)

88 
	#TF_OVFLCANQ
 0x0010

	)

89 
	#TF_OVFLOPTQ
 0x0020

	)

90 
	#TF_OVFLOUTQ
 0x0040

	)

91 
	#TF_SYNCH
 0x0080

	)

92 
	#TF_URGENT
 0x0100

	)

93 
	#TF_GA
 0x0200

	)

94 
	#TF_ECHO
 0x1000

	)

95 
	#TF_SGA
 0x2000

	)

100 
	#TS_DATA
 0

	)

101 
	#TS_CR
 1

	)

102 
	#TS_IAC
 2

	)

103 
	#TS_IAC_SB
 3

	)

104 
	#TS_IAC_SB_DATA
 4

	)

105 
	#TS_IAC_SB_IAC
 5

	)

106 
	#TS_IAC_WILL
 6

	)

107 
	#TS_IAC_WONT
 7

	)

108 
	#TS_IAC_DO
 8

	)

109 
	#TS_IAC_DONT
 9

	)

111 
	#TELOPT_CDM
 205

	)

113 
ã ë_dëach
(
ã ë_t
 *);

114 
ã ë_ouçut
(
ã ë_t
 *, 
u_ch¨
 *);

115 
ã ë_íabÀ_echo
(
ã ë_t
 *);

116 
ã ë_dißbÀ_echo
(
ã ë_t
 *);

117 
ã ë_öô
(
u_sh‹t
);

	@ualarm.c

34 
	~<sys/time.h
>

35 
	~<uni°d.h
>

37 
	#USPS
 1000000

	)

45 
	$uÆ¨m
(
u£cs
, 
ªlﬂd
)

46 
u£cs
;

47 
ªlﬂd
;

49 
ôimîvÆ
 
√w
, 
ﬁd
;

51 
√w
.
ô_öãrvÆ
.
tv_u£c
 = 
ªlﬂd
 % 
USPS
;

52 
√w
.
ô_öãrvÆ
.
tv_£c
 = 
ªlﬂd
 / 
USPS
;

54 
√w
.
ô_vÆue
.
tv_u£c
 = 
u£cs
 % 
USPS
;

55 
√w
.
ô_vÆue
.
tv_£c
 = 
u£cs
 / 
USPS
;

57 i‡(
	`£tôimî
(
ITIMER_REAL
, &
√w
, &
ﬁd
) == 0)

58  (
ﬁd
.
ô_vÆue
.
tv_£c
 * 
USPS
 + old.ô_vÆue.
tv_u£c
);

61 
	}
}

	@udpsvc.c

32 
	~<°dio.h
>

33 
	~<î∫o.h
>

34 
	~<°rög.h
>

35 
	~<sys/ty≥s.h
>

36 
	~<sys/sockë.h
>

37 
	~<√töë/ö.h
>

38 
	~<¨∑/öë.h
>

39 
	~"c⁄fig.h
"

40 
	~"löt.h
"

41 
	~"maö.h
"

42 
	~"öãΩªt.h
"

43 
	~"simuœã.h
"

44 
	~"ndesc.h
"

45 
	~"nqueue.h
"

46 
	~"√t.h
"

48 #ifde‡
CATCH_UDP_PORT


50 #i‚de‡
INADDR_NONE


51 
	#INADDR_NONE
 0xffffffff

	)

61 
	#UDPSVC_RAWQ_SIZE
 1024

	)

63 
ndesc_t
 *
	gudpsvc_nd
 = 
NULL
;

69 
	$udpsvc_£nd
(*
de°
, 
p‹t
, *
˝
)

71 
sockaddr_ö
 
addr
;

72 
cc
;

74 i‡(
udpsvc_nd
 =
NULL
 || 
p‹t
 < 0)

77 
	`mem£t
(&
addr
, 0,  (addr));

78 
addr
.
sö_Ámûy
 = 
AF_INET
;

79 
addr
.
sö_p‹t
 = 
	`ht⁄s
((
u_sh‹t
)
p‹t
);

80 
addr
.
sö_addr
.
s_addr
 = 
	`öë_addr
(
de°
);

82 i‡(
addr
.
sö_addr
.
s_addr
 =
INADDR_NONE
)

84 #ifde‡
UDP_SEND_HOSTNAME


85 
ho°ít
 *
hp
;

87 
hp
 = 
	`gëho°by«me
(
addr
);

88 i‡(
hp
 =
NULL
)

90 
	`mem˝y
(&
addr
.
sö_addr
, 
hp
->
h_addr
, hp->
h_Àngth
);

96 
cc
 = 
	`£ndto
(
	`nd_fd
(
udpsvc_nd
), 
˝
, 
	`°æí
(cp), 0,

97 (
sockaddr
 *)&
addr
,  (addr));

99  
cc
 != -1;

100 
	}
}

106 
	$udpsvc_ªad
(
ndesc_t
 *
nd
, 
nqueue_t
 *
nq
)

108 
addæí
, 
cc
;

109 
sockaddr_ö
 
addr
;

111 
addæí
 =  (
addr
);

113 
cc
 = 
	`ªcv‰om
(
	`nd_fd
(
nd
), 
	`nq_w±r
(
nq
), 
	`nq_size
(nq) - 1, 0,

114 (
sockaddr
 *)&
addr
, &
addæí
);

116 i‡(
cc
 == -1)

119 
	`nq_w±r
(
nq
)[
cc
] = '\0';

122 
	`push_°rög
(
	`öë_¡ﬂ
(
addr
.
sö_addr
), 
STRING_MSTRING
);

123 
	`push_°rög
((*)
	`nq_Ωå
(
nq
), 
STRING_MSTRING
);

124 ()
	`≠∂y_ma°î_ob
(
M_INCOMING_UDP
, 2);

125 
	}
}

131 
	$udpsvc_shutdown
(
ndesc_t
 *
nd
, 
nqueue_t
 *
nq
)

133 ()
	`˛o£
(
	`nd_fd
(
nd
));

134 
	`nq_‰ì
(
nq
);

135 
	`nd_dëach
(
nd
);

136 
udpsvc_nd
 = 
NULL
;

137 
	}
}

143 
	$udpsvc_öô
(
p‹t
)

145 
s
;

146 
sockaddr_ö
 
addr
;

147 
nqueue_t
 *
nq
;

149 
s
 = 
	`sockë
(
AF_INET
, 
SOCK_DGRAM
, 
IPPROTO_UDP
);

150 i‡(
s
 == -1)

151 
	`Áèl
("udp_öô: sockë(Ëîr‹ = %d.\n", 
î∫o
);

153 
	`íabÀ_ªu£addr
(
s
);

155 
	`mem£t
(&
addr
, 0,  (addr));

156 
addr
.
sö_Ámûy
 = 
AF_INET
;

157 
addr
.
sö_p‹t
 = 
	`ht⁄s
((
u_sh‹t
)
p‹t
);

158 
addr
.
sö_addr
.
s_addr
 = 
INADDR_ANY
;

160 i‡(
	`böd
(
s
, (
sockaddr
 *)&
addr
,  (addr)) == -1)

162 i‡(
î∫o
 =
EADDRINUSE
)

164 ()
	`Ârötf
(
°dîr
, "UDP Socketálready bound!\n");

165 
	`debug_mesßge
("UDP Socketálready bound!\n");

166 ()
	`˛o£
(
s
);

171 
	`Áèl
("udp_öô: böd(Ëîr‹ = %d.\n", 
î∫o
);

175 
	`íabÀ_nbio
(
s
);

177 
nq
 = 
	`nq_Æloc
(
UDPSVC_RAWQ_SIZE
);

178 
udpsvc_nd
 = 
	`nd_©èch
(
s
, 
udpsvc_ªad
, 
NULL
, NULL, NULL, 
udpsvc_shutdown
,

179 
nq
);

180 
	`nd_íabÀ
(
udpsvc_nd
, 
ND_R
);

181 
	}
}

	@udpsvc.h

32 
udpsvc_öô
();

33 
udpsvc_shutdown
();

34 
udpsvc_£nd
(*, , *);

	@util/hname.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<°rög.h
>

4 
	~<f˙é.h
>

5 
	~<uni°d.h
>

6 
	~<sys/ty≥s.h
>

7 
	~<sys/time.h
>

8 
	~<sys/sockë.h
>

9 
	~<√töë/ö.h
>

10 
	~<¨∑/öë.h
>

11 
	~<√tdb.h
>

14 
	$gë_auth_«me
(
ªmŸe
, 
loˇl_p‹t
, 
ªmŸe_p‹t
)

16 
sockaddr_ö
 
ß
;

17 
s
, 
Êags
;

18 
buf
[1024];

19 
u£r_«me
[1024];

20 
buÊí
;

21 
i
, 
n
;

22 
timevÆ
 
timeout
;

23 
fd_£t
 
fs
;

25 if((
s
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 0)) == -1) {

28 ()
	`mem£t
(&
ß
, 0, (sa));

29 
ß
.
sö_Ámûy
 = 
AF_INET
;

30 
ß
.
sö_p‹t
 = 
	`ht⁄s
(113);

31 
ß
.
sö_addr
.
s_addr
 = 
ªmŸe
;

32 i‡(
	`c⁄√˘
(
s
, (
sockaddr
 *)&
ß
, (sa)) == -1) {

33 ()
	`˛o£
(
s
);

36 ()
	`•rötf
(
buf
, "%u , %u\r\n", 
ªmŸe_p‹t
, 
loˇl_p‹t
);

37 
buÊí
 = 
	`°æí
(
buf
);

38 
Êags
 = 
	`f˙é
(
s
, 
F_GETFL
);

39 ()
	`f˙é
(
s
, 
F_SETFL
, 
Êags
 | 
O_NDELAY
);

41 
	`FD_ZERO
(&
fs
);

42 
	`FD_SET
(
s
, &
fs
);

43 
timeout
.
tv_£c
 = 5;

44 
timeout
.
tv_u£c
 = 0;

45 i‡(
	`£À˘
(
s
 + 1, 
NULL
, &
fs
, NULL, &
timeout
) == 0 ||

46 !
	`FD_ISSET
(
s
, &
fs
)) {

47 ()
	`˛o£
(
s
);

50 i‡(
	`wrôe
(
s
, 
buf
, 
buÊí
) != buflen) {

51 ()
	`˛o£
(
s
);

55 
	`FD_ZERO
(&
fs
);

56 
	`FD_SET
(
s
, &
fs
);

57 
timeout
.
tv_£c
 = 10;

58 
timeout
.
tv_u£c
 = 0;

59 i‡(
	`£À˘
(
s
 + 1, &
fs
, 
NULL
, NULL, &
timeout
) == 0 ||

60 !
	`FD_ISSET
(
s
, &
fs
)) {

61 ()
	`˛o£
(
s
);

65 
n
 = 
i
 = 0; i <  
buf
 - 1;Ç++) {

66 
	`FD_ZERO
(&
fs
);

67 
	`FD_SET
(
s
, &
fs
);

68 
timeout
.
tv_£c
 = 1;

69 
timeout
.
tv_u£c
 = 0;

70 i‡(
	`£À˘
(
s
 + 1, &
fs
, 
NULL
, NULL, &
timeout
) == 0 ||

71 !
	`FD_ISSET
(
s
, &
fs
))

73 i‡(
	`ªad
(
s
, 
buf
 + 
i
, 1) != 1)

75 i‡(
buf
[
i
] == '\n')

77 i‡–
buf
[
i
] != '\t' && buf[i] != '\r')

78 
i
++;

79 i‡(
n
 > 2000) {

81 ()
	`˛o£
(
s
);

85 
buf
[
i
] = 0;

86 ()
	`˛o£
(
s
);

88 if(
	`ssˇnf
(
buf
, "%*u , %*u : USERID :%*[^:]:%s", 
u£r_«me
) != 1)

91  
u£r_«me
;

92 
	}
}

96 
	$maö
(
¨gc
, *
¨gv
[])

98 
buf
[0x100];

99 *
p‹t1
;

100 *
p‹t2
;

101 
addr
;

102 
ho°ít
 *
hp
;

103 *
«me
;

105 #i‚de‡
SOLARIS


106 ()
	`£éöebuf
(
°dout
);

108 ()
	`¥ötf
("\n");

110 i‡(
	`fgës
(
buf
, (buf), 
°dö
Ë=
NULL
)

112 i‡((
«me
 = 
	`°rchr
(
buf
, '\n')Ë!
NULL
)

113 *
«me
 = '\0';

114 
p‹t1
 = 
	`°rchr
(
buf
, ';');

115 i‡(
p‹t1
) {

116 *
p‹t1
 = 0;

117 
p‹t1
++;

118 
p‹t2
 = 
	`°rchr
(
p‹t1
, ',');

119 i‡(
p‹t2
) {

120 *
p‹t2
 = 0;

121 
p‹t2
++;

125 
p‹t2
 = 0;

127 
addr
 = 
	`öë_addr
(
buf
);

128 i‡(
addr
 != ()-1) {

129 i‡(
p‹t2
)

130 
«me
 = 
	`gë_auth_«me
(
addr
, 
	`©oi
(
p‹t1
),átoi(
p‹t2
));

132 
«me
 = "";

133 
hp
 = 
	`gëho°byaddr
((*)&
addr
, 4, 
AF_INET
);

134 i‡(!
hp
) {

135 ()
	`¶ìp
(5);

136 
hp
 = 
	`gëho°byaddr
((*)&
addr
, 4, 
AF_INET
);

138 i‡(
hp
) {

139 i‡(
p‹t2
)

140 ()
	`¥ötf
("%†%s,%s,%s:%s\n", 
buf
, 
hp
->
h_«me
,

141 
p‹t1
,
p‹t2
,
«me
);

143 ()
	`¥ötf
("%†%s\n", 
buf
, 
hp
->
h_«me
);

145 i‡(
p‹t2
)

146 ()
	`¥ötf
("%†%s,%s,%s:%s\n", 
buf
, buf, 
p‹t1
, 
p‹t2
, 
«me
);

151 
	}
}

	@vprintf.c

47 
	~<°dio.h
>

48 
	~<°d¨g.h
>

50 
	#LONGINT


	)

52 #i‡!
deföed
(
löt
)

53 
	gsccsid
[] = "@(#)vprint.c 1.1 (USC) 2/7/89";

54 
	grcsid
[] = "@(#)$Id: vprintf.c,v 1.4 1996/10/13 03:36:10Åholo Exp $";

57 #i‚de‡
__STDC__


58 
	#NOVOID


	)

61 #ifde‡
OSK


62 
	#LONGINT


	)

63 
	#INTSPRINTF


	)

67 #ifde‡
NOVOID


68 *
	tpoöãr
;

70 *
	tpoöãr
;

73 #ifde‡
INTSPRINTF


74 
	#S¥ötf
(
°rög
,
f‹m©
,
¨g
Ë(
	`•rötf
((°rög),(f‹m©),◊rg)))

	)

76 
	#S¥ötf
(
°rög
,
f‹m©
,
¨g
) (\

77 
	`•rötf
((
°rög
),(
f‹m©
),(
¨g
)),\

78 
	`°æí
(
°rög
)\

79 )

	)

82 *
	töç
;

85 #ifde‡
__STDC__


86 
	$v•rötf
 (*
de°
, c⁄° *
f‹m©
, 
va_li°
 
¨gs
)

88 
	$v•rötf
 (
de°
, 
f‹m©
, 
¨gs
)

89 *
de°
;

90 *
f‹m©
;

91 
va_li°
 
¨gs
;

94 *
dp
 = 
de°
;

95 
c
;

96 *
ç
;

97 
ãmpfmt
[64];

99 #i‚de‡
LONGINT


100 
l⁄gÊag
;

104 
ãmpfmt
[0] = '%';

105 
c
 = *
f‹m©
++) {

106 i‡(
c
 == '%') {

107 
ç
 = &
ãmpfmt
[1];

108 #i‚de‡
LONGINT


109 
l⁄gÊag
 = 0;

111 
c⁄töue_f‹m©
:

112 
c
 = *
f‹m©
++) {

114 *
ç
++ = 
c
;

115 *
ç
 = '\0';

116 
dp
 +
	`S¥ötf
 (dp, 
ãmpfmt
, 
	`va_¨g
 (
¨gs
, *));

122 #ifde‡
UNSIGNEDSPECIAL


123 *
ç
++ = 
c
;

124 *
ç
 = '\0';

125 #i‚de‡
LONGINT


126 i‡(
l⁄gÊag
)

127 
dp
 +
	`S¥ötf
 (dp, 
ãmpfmt
, 
	`va_¨g
 (
¨gs
, ));

130 
dp
 +
	`S¥ötf
 (dp, 
ãmpfmt
, 
	`va_¨g
 (
¨gs
, ));

136 *
ç
++ = 
c
;

137 *
ç
 = '\0';

138 #i‚de‡
LONGINT


139 i‡(
l⁄gÊag
)

140 
dp
 +
	`S¥ötf
 (dp, 
ãmpfmt
, 
	`va_¨g
 (
¨gs
, ));

143 
dp
 +
	`S¥ötf
 (dp, 
ãmpfmt
, 
	`va_¨g
 (
¨gs
, ));

150 *
ç
++ = 
c
;

151 *
ç
 = '\0';

152 
dp
 +
	`S¥ötf
 (dp, 
ãmpfmt
, 
	`va_¨g
 (
¨gs
, ));

155 *
ç
++ = 
c
;

156 *
ç
 = '\0';

157 
dp
 +
	`S¥ötf
 (dp, 
ãmpfmt
, 
	`va_¨g
 (
¨gs
, 
poöãr
));

175 *
ç
++ = 
c
;

176 
c⁄töue_f‹m©
;

178 #i‚de‡
LONGINT


179 
l⁄gÊag
 = 1;

180 *
ç
++ = 
c
;

182 
c⁄töue_f‹m©
;

184 
ç
 +
	`S¥ötf
 (ç, "%d", 
	`va_¨g
 (
¨gs
, ));

185 
c⁄töue_f‹m©
;

187 *
	`va_¨g
 (
¨gs
, 
öç
Ë
dp
 - 
de°
;

191 *
dp
++ = 
c
;

195 *
dp
++ = 
c
;

197 *
dp
 = '\0';

198  
dp
 - 
de°
;

199 
	}
}

203 #ifde‡
__STDC__


204 
	$vÂrötf
 (
FILE
 *
de°
, c⁄° *
f‹m©
, 
va_li°
 
¨gs
)

206 
	$vÂrötf
 (
de°
, 
f‹m©
, 
¨gs
)

207 
FILE
 *
de°
;

208 *
f‹m©
;

209 
va_li°
 
¨gs
;

212 
c
;

213 *
ç
;

214 
cou¡
 = 0;

215 
ãmpfmt
[64];

217 #i‚de‡
LONGINT


218 
l⁄gÊag
;

222 
ãmpfmt
[0] = '%';

223 
c
 = *
f‹m©
++) {

224 i‡(
c
 == '%') {

225 
ç
 = &
ãmpfmt
[1];

226 #i‚de‡
LONGINT


227 
l⁄gÊag
 = 0;

229 
c⁄töue_f‹m©
:

230 
c
 = *
f‹m©
++) {

232 *
ç
++ = 
c
;

233 *
ç
 = '\0';

234 
cou¡
 +
	`Ârötf
 (
de°
, 
ãmpfmt
, 
	`va_¨g
 (
¨gs
, *));

240 #ifde‡
UNSIGNEDSPECIAL


241 *
ç
++ = 
c
;

242 *
ç
 = '\0';

243 #i‚de‡
LONGINT


244 i‡(
l⁄gÊag
)

245 
cou¡
 +
	`Ârötf
 (
de°
, 
ãmpfmt
, 
	`va_¨g
 (
¨gs
, ));

248 
cou¡
 +
	`Ârötf
 (
de°
, 
ãmpfmt
, 
	`va_¨g
 (
¨gs
, ));

254 *
ç
++ = 
c
;

255 *
ç
 = '\0';

256 #i‚de‡
LONGINT


257 i‡(
l⁄gÊag
)

258 
cou¡
 +
	`Ârötf
 (
de°
, 
ãmpfmt
, 
	`va_¨g
 (
¨gs
, ));

261 
cou¡
 +
	`Ârötf
 (
de°
, 
ãmpfmt
, 
	`va_¨g
 (
¨gs
, ));

268 *
ç
++ = 
c
;

269 *
ç
 = '\0';

270 
cou¡
 +
	`Ârötf
 (
de°
, 
ãmpfmt
, 
	`va_¨g
 (
¨gs
, ));

273 *
ç
++ = 
c
;

274 *
ç
 = '\0';

275 
cou¡
 +
	`Ârötf
 (
de°
, 
ãmpfmt
, 
	`va_¨g
 (
¨gs
, 
poöãr
));

293 *
ç
++ = 
c
;

294 
c⁄töue_f‹m©
;

296 #i‚de‡
LONGINT


297 
l⁄gÊag
 = 1;

298 *
ç
++ = 
c
;

300 
c⁄töue_f‹m©
;

302 
ç
 +
	`S¥ötf
 (ç, "%d", 
	`va_¨g
 (
¨gs
, ));

303 
c⁄töue_f‹m©
;

305 *
	`va_¨g
 (
¨gs
, 
öç
Ë
cou¡
;

309 
	`putc
 (
c
, 
de°
);

310 
cou¡
++;

314 
	`putc
 (
c
, 
de°
);

315 
cou¡
++;

318  
cou¡
;

319 
	}
}

322 #ifde‡
__STDC__


323 
	$v¥ötf
 (c⁄° *
f‹m©
, 
va_li°
 
¨gs
)

325 
	$v¥ötf
 (
f‹m©
, 
¨gs
)

326 *
f‹m©
;

327 
va_li°
 
¨gs
;

330 
nch¨s
;

331 
nch¨s
 = 
	`vÂrötf
 (
°dout
, 
f‹m©
, 
¨gs
);

332  
nch¨s
;

333 
	}
}

	@wildmat.c

38 
wûdm©
(*, *);

39 
DoM©ch
(*, *);

41 
	#TRUE
 1

	)

42 
	#FALSE
 0

	)

43 
	#ABORT
 -1

	)

47 
	#NEGATE_CLASS
 '^'

	)

49 
	#OPTIMIZE_JUST_STAR


	)

51 #unde‡
MATCH_TAR_PATTERN


58 
	$DoM©ch
(
ãxt
, 
p
)

59 *
ãxt
;

60 *
p
;

62 
œ°
;

63 
m©ched
;

64 
ªvî£
;

66  ; *
p
; 
ãxt
++,Ö++) {

67 i‡(*
ãxt
 ='\0' && *
p
 != '*')

68  
ABORT
;

69 *
p
) {

72 
p
++;

75 i‡(*
ãxt
 !*
p
)

76  
FALSE
;

82 *++
p
 == '*')

85 i‡(*
p
 == '\0')

87  
TRUE
;

88 *
ãxt
)

89 i‡((
m©ched
 = 
	`DoM©ch
(
ãxt
++, 
p
)Ë!
FALSE
)

90  
m©ched
;

91  
ABORT
;

93 
ªvî£
 = 
p
[1] =
NEGATE_CLASS
 ? 
TRUE
 : 
FALSE
;

94 i‡(
ªvî£
)

96 
p
++;

97 
m©ched
 = 
FALSE
;

98 i‡(
p
[1] == ']' ||Ö[1] == '-')

99 i‡(*++
p
 =*
ãxt
)

100 
m©ched
 = 
TRUE
;

101 
œ°
 = *
p
; *++p && *p != ']';Üast = *p)

103 i‡(*
p
 == '-' &&Ö[1] != ']'

104 ? *
ãxt
 <*++
p
 && *ãxà>
œ°
 : *text == *p)

105 
m©ched
 = 
TRUE
;

106 i‡(
m©ched
 =
ªvî£
)

107  
FALSE
;

112 #ifdef 
MATCH_TAR_PATTERN


113 i‡(*
ãxt
 == '/')

114  
TRUE
;

116  *
ãxt
 == '\0';

117 
	}
}

124 
	$wûdm©
(
ãxt
, 
p
)

125 *
ãxt
;

126 *
p
;

128 #ifdef 
OPTIMIZE_JUST_STAR


129 i‡(
p
[0] == '*' &&Ö[1] == '\0')

130  
TRUE
;

132  
	`DoM©ch
(
ãxt
, 
p
Ë=
TRUE
;

133 
	}
}

137 #if 
deföed
(
TEST
)

138 
	~<°dio.h
>

141 *
gës
();

145 
	$maö
()

147 
p
[80];

148 
ãxt
[80];

150 ()
	`¥ötf
("WildmatÅester. EnterÖattern,Åhen stringsÅoÅest.\n");

151 ()
	`¥ötf
("A blankÜine getsÖrompts foráÇewÖattern;á blankÖattern\n");

152 ()
	`¥ötf
("exitsÅheÖrogram.\n");

155 ()
	`¥ötf
("\nEnterÖattern: ");

156 ()
	`fÊush
(
°dout
);

157 i‡(
	`gës
(
p
Ë=
NULL
 ||Ö[0] == '\0')

160 ()
	`¥ötf
("EnterÅext: ");

161 ()
	`fÊush
(
°dout
);

162 i‡(
	`gës
(
ãxt
Ë=
NULL
)

163 
	`exô
(0);

164 i‡(
ãxt
[0] == '\0')

167 ()
	`¥ötf
(" %s\n", 
	`wûdm©
(
ãxt
, 
p
) ? "YES" : "NO");

171 
	`exô
(0);

173 
	}
}

	@/usr/include/arpa/inet.h

18 #i‚de‡
_ARPA_INET_H


19 
	#_ARPA_INET_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<√töë/ö.h
>

25 #i‚de‡
__sockÀn_t_deföed


26 
__sockÀn_t
 
	tsockÀn_t
;

27 
	#__sockÀn_t_deföed


	)

30 
__BEGIN_DECLS


34 
ö_addr_t
 
	$öë_addr
 (c⁄° *
__˝
Ë
__THROW
;

37 
ö_addr_t
 
	$öë_ aof
 (
ö_addr
 
__ö
Ë
__THROW
;

41 
ö_addr
 
	$öë_makóddr
 (
ö_addr_t
 
__√t
, in_addr_à
__ho°
)

42 
__THROW
;

45 
ö_addr_t
 
	$öë_√tof
 (
ö_addr
 
__ö
Ë
__THROW
;

49 
ö_addr_t
 
	$öë_√tw‹k
 (c⁄° *
__˝
Ë
__THROW
;

53 *
	$öë_¡ﬂ
 (
ö_addr
 
__ö
Ë
__THROW
;

58 
	$öë_±⁄
 (
__af
, c⁄° *
__ª°ri˘
 
__˝
,

59 *
__ª°ri˘
 
__buf
Ë
__THROW
;

64 c⁄° *
	$öë_¡›
 (
__af
, c⁄° *
__ª°ri˘
 
__˝
,

65 *
__ª°ri˘
 
__buf
, 
sockÀn_t
 
__Àn
)

66 
__THROW
;

70 #ifde‡
__USE_MISC


73 
	$öë_©⁄
 (c⁄° *
__˝
, 
ö_addr
 *
__öp
Ë
__THROW
;

77 *
	$öë_√è
 (
ö_addr_t
 
__√t
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

82 *
	$öë_√t_¡›
 (
__af
, c⁄° *
__˝
, 
__bôs
,

83 *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

88 
	$öë_√t_±⁄
 (
__af
, c⁄° *
__˝
,

89 *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

94 
	$öë_nßp_addr
 (c⁄° *
__˝
,

95 *
__buf
, 
__Àn
Ë
__THROW
;

99 *
	$öë_nßp_¡ﬂ
 (
__Àn
, c⁄° *
__˝
,

100 *
__buf
Ë
__THROW
;

103 
__END_DECLS


	@/usr/include/arpa/telnet.h

32 #i‚de‡
_ARPA_TELNET_H


33 
	#_ARPA_TELNET_H
 1

	)

38 
	#IAC
 255

	)

39 
	#DONT
 254

	)

40 
	#DO
 253

	)

41 
	#WONT
 252

	)

42 
	#WILL
 251

	)

43 
	#SB
 250

	)

44 
	#GA
 249

	)

45 
	#EL
 248

	)

46 
	#EC
 247

	)

47 
	#AYT
 246

	)

48 
	#AO
 245

	)

49 
	#IP
 244

	)

50 
	#BREAK
 243

	)

51 
	#DM
 242

	)

52 
	#NOP
 241

	)

53 
	#SE
 240

	)

54 
	#EOR
 239

	)

55 
	#ABORT
 238

	)

56 
	#SUSP
 237

	)

57 
	#xEOF
 236

	)

59 
	#SYNCH
 242

	)

61 #ifde‡
TELCMDS


62 *
	gãlcmds
[] = {

68 *
ãlcmds
[];

71 
	#TELCMD_FIRST
 
xEOF


	)

72 
	#TELCMD_LAST
 
IAC


	)

73 
	#TELCMD_OK
(
x
Ë(()(xË<
TELCMD_LAST
 && \

74 ()(
x
Ë>
TELCMD_FIRST
)

	)

75 
	#TELCMD
(
x
Ë
ãlcmds
[(x)-
TELCMD_FIRST
]

	)

78 
	#TELOPT_BINARY
 0

	)

79 
	#TELOPT_ECHO
 1

	)

80 
	#TELOPT_RCP
 2

	)

81 
	#TELOPT_SGA
 3

	)

82 
	#TELOPT_NAMS
 4

	)

83 
	#TELOPT_STATUS
 5

	)

84 
	#TELOPT_TM
 6

	)

85 
	#TELOPT_RCTE
 7

	)

86 
	#TELOPT_NAOL
 8

	)

87 
	#TELOPT_NAOP
 9

	)

88 
	#TELOPT_NAOCRD
 10

	)

89 
	#TELOPT_NAOHTS
 11

	)

90 
	#TELOPT_NAOHTD
 12

	)

91 
	#TELOPT_NAOFFD
 13

	)

92 
	#TELOPT_NAOVTS
 14

	)

93 
	#TELOPT_NAOVTD
 15

	)

94 
	#TELOPT_NAOLFD
 16

	)

95 
	#TELOPT_XASCII
 17

	)

96 
	#TELOPT_LOGOUT
 18

	)

97 
	#TELOPT_BM
 19

	)

98 
	#TELOPT_DET
 20

	)

99 
	#TELOPT_SUPDUP
 21

	)

100 
	#TELOPT_SUPDUPOUTPUT
 22

	)

101 
	#TELOPT_SNDLOC
 23

	)

102 
	#TELOPT_TTYPE
 24

	)

103 
	#TELOPT_EOR
 25

	)

104 
	#TELOPT_TUID
 26

	)

105 
	#TELOPT_OUTMRK
 27

	)

106 
	#TELOPT_TTYLOC
 28

	)

107 
	#TELOPT_3270REGIME
 29

	)

108 
	#TELOPT_X3PAD
 30

	)

109 
	#TELOPT_NAWS
 31

	)

110 
	#TELOPT_TSPEED
 32

	)

111 
	#TELOPT_LFLOW
 33

	)

112 
	#TELOPT_LINEMODE
 34

	)

113 
	#TELOPT_XDISPLOC
 35

	)

114 
	#TELOPT_OLD_ENVIRON
 36

	)

115 
	#TELOPT_AUTHENTICATION
 37

	)

116 
	#TELOPT_ENCRYPT
 38

	)

117 
	#TELOPT_NEW_ENVIRON
 39

	)

118 
	#TELOPT_EXOPL
 255

	)

121 
	#NTELOPTS
 (1+
TELOPT_NEW_ENVIRON
)

	)

122 #ifde‡
TELOPTS


123 *
	gãl›ts
[
NTELOPTS
+1] = {

136 
	#TELOPT_FIRST
 
TELOPT_BINARY


	)

137 
	#TELOPT_LAST
 
TELOPT_NEW_ENVIRON


	)

138 
	#TELOPT_OK
(
x
Ë(()(xË<
TELOPT_LAST
)

	)

139 
	#TELOPT
(
x
Ë
ãl›ts
[(x)-
TELOPT_FIRST
]

	)

143 
	#TELQUAL_IS
 0

	)

144 
	#TELQUAL_SEND
 1

	)

145 
	#TELQUAL_INFO
 2

	)

146 
	#TELQUAL_REPLY
 2

	)

147 
	#TELQUAL_NAME
 3

	)

149 
	#LFLOW_OFF
 0

	)

150 
	#LFLOW_ON
 1

	)

151 
	#LFLOW_RESTART_ANY
 2

	)

152 
	#LFLOW_RESTART_XON
 3

	)

158 
	#LM_MODE
 1

	)

159 
	#LM_FORWARDMASK
 2

	)

160 
	#LM_SLC
 3

	)

162 
	#MODE_EDIT
 0x01

	)

163 
	#MODE_TRAPSIG
 0x02

	)

164 
	#MODE_ACK
 0x04

	)

165 
	#MODE_SOFT_TAB
 0x08

	)

166 
	#MODE_LIT_ECHO
 0x10

	)

168 
	#MODE_MASK
 0x1f

	)

171 
	#MODE_FLOW
 0x0100

	)

172 
	#MODE_ECHO
 0x0200

	)

173 
	#MODE_INBIN
 0x0400

	)

174 
	#MODE_OUTBIN
 0x0800

	)

175 
	#MODE_FORCE
 0x1000

	)

177 
	#SLC_SYNCH
 1

	)

178 
	#SLC_BRK
 2

	)

179 
	#SLC_IP
 3

	)

180 
	#SLC_AO
 4

	)

181 
	#SLC_AYT
 5

	)

182 
	#SLC_EOR
 6

	)

183 
	#SLC_ABORT
 7

	)

184 
	#SLC_EOF
 8

	)

185 
	#SLC_SUSP
 9

	)

186 
	#SLC_EC
 10

	)

187 
	#SLC_EL
 11

	)

188 
	#SLC_EW
 12

	)

189 
	#SLC_RP
 13

	)

190 
	#SLC_LNEXT
 14

	)

191 
	#SLC_XON
 15

	)

192 
	#SLC_XOFF
 16

	)

193 
	#SLC_FORW1
 17

	)

194 
	#SLC_FORW2
 18

	)

196 
	#NSLC
 18

	)

202 
	#SLC_NAMELIST
 "0", "SYNCH", "BRK", "IP", "AO", "AYT", "EOR", \

204 "LNEXT", "XON", "XOFF", "FORW1", "FORW2", 0,

	)

205 #ifdef 
SLC_NAMES


206 *
	g¶c_«mes
[] = {

207 
SLC_NAMELIST


210 *
¶c_«mes
[];

211 
	#SLC_NAMES
 
SLC_NAMELIST


	)

214 
	#SLC_NAME_OK
(
x
Ë(()(xË<
NSLC
)

	)

215 
	#SLC_NAME
(
x
Ë
¶c_«mes
[x]

	)

217 
	#SLC_NOSUPPORT
 0

	)

218 
	#SLC_CANTCHANGE
 1

	)

219 
	#SLC_VARIABLE
 2

	)

220 
	#SLC_DEFAULT
 3

	)

221 
	#SLC_LEVELBITS
 0x03

	)

223 
	#SLC_FUNC
 0

	)

224 
	#SLC_FLAGS
 1

	)

225 
	#SLC_VALUE
 2

	)

227 
	#SLC_ACK
 0x80

	)

228 
	#SLC_FLUSHIN
 0x40

	)

229 
	#SLC_FLUSHOUT
 0x20

	)

231 
	#OLD_ENV_VAR
 1

	)

232 
	#OLD_ENV_VALUE
 0

	)

233 
	#NEW_ENV_VAR
 0

	)

234 
	#NEW_ENV_VALUE
 1

	)

235 
	#ENV_ESC
 2

	)

236 
	#ENV_USERVAR
 3

	)

245 
	#AUTH_WHO_CLIENT
 0

	)

246 
	#AUTH_WHO_SERVER
 1

	)

247 
	#AUTH_WHO_MASK
 1

	)

252 
	#AUTH_HOW_ONE_WAY
 0

	)

253 
	#AUTH_HOW_MUTUAL
 2

	)

254 
	#AUTH_HOW_MASK
 2

	)

256 
	#AUTHTYPE_NULL
 0

	)

257 
	#AUTHTYPE_KERBEROS_V4
 1

	)

258 
	#AUTHTYPE_KERBEROS_V5
 2

	)

259 
	#AUTHTYPE_SPX
 3

	)

260 
	#AUTHTYPE_MINK
 4

	)

261 
	#AUTHTYPE_CNT
 5

	)

263 
	#AUTHTYPE_TEST
 99

	)

265 #ifdef 
AUTH_NAMES


266 *
	gauthty≥_«mes
[] = {

270 *
authty≥_«mes
[];

273 
	#AUTHTYPE_NAME_OK
(
x
Ë(()(xË< 
AUTHTYPE_CNT
)

	)

274 
	#AUTHTYPE_NAME
(
x
Ë
authty≥_«mes
[x]

	)

279 
	#ENCRYPT_IS
 0

	)

280 
	#ENCRYPT_SUPPORT
 1

	)

281 
	#ENCRYPT_REPLY
 2

	)

282 
	#ENCRYPT_START
 3

	)

283 
	#ENCRYPT_END
 4

	)

284 
	#ENCRYPT_REQSTART
 5

	)

285 
	#ENCRYPT_REQEND
 6

	)

286 
	#ENCRYPT_ENC_KEYID
 7

	)

287 
	#ENCRYPT_DEC_KEYID
 8

	)

288 
	#ENCRYPT_CNT
 9

	)

290 
	#ENCTYPE_ANY
 0

	)

291 
	#ENCTYPE_DES_CFB64
 1

	)

292 
	#ENCTYPE_DES_OFB64
 2

	)

293 
	#ENCTYPE_CNT
 3

	)

295 #ifdef 
ENCRYPT_NAMES


296 *
	gí¸y±_«mes
[] = {

301 *
	gí˘y≥_«mes
[] = {

305 *
í¸y±_«mes
[];

306 *
í˘y≥_«mes
[];

310 
	#ENCRYPT_NAME_OK
(
x
Ë(()(xË< 
ENCRYPT_CNT
)

	)

311 
	#ENCRYPT_NAME
(
x
Ë
í¸y±_«mes
[x]

	)

313 
	#ENCTYPE_NAME_OK
(
x
Ë(()(xË< 
ENCTYPE_CNT
)

	)

314 
	#ENCTYPE_NAME
(
x
Ë
í˘y≥_«mes
[x]

	)

	@/usr/include/ctype.h

22 #i‚def 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 
	g__BEGIN_DECLS


30 #i‚de‡
_ISbô


39 
	~<ídün.h
>

40 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


41 
	#_ISbô
(
bô
Ë(1 << (bô))

	)

43 
	#_ISbô
(
bô
Ë((bôË< 8 ? ((1 << (bô)Ë<< 8Ë: ((1 << (bô)Ë>> 8))

	)

48 
	m_ISuµî
 = 
_ISbô
 (0),

49 
	m_ISlowî
 = 
_ISbô
 (1),

50 
	m_ISÆpha
 = 
_ISbô
 (2),

51 
	m_ISdigô
 = 
_ISbô
 (3),

52 
	m_ISxdigô
 = 
_ISbô
 (4),

53 
	m_IS•a˚
 = 
_ISbô
 (5),

54 
	m_IS¥öt
 = 
_ISbô
 (6),

55 
	m_ISgøph
 = 
_ISbô
 (7),

56 
	m_ISbœnk
 = 
_ISbô
 (8),

57 
	m_IS˙ål
 = 
_ISbô
 (9),

58 
	m_ISpun˘
 = 
_ISbô
 (10),

59 
	m_ISÆnum
 = 
_ISbô
 (11)

79 c⁄° **
	$__˘y≥_b_loc
 ()

80 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

81 c⁄° 
__öt32_t
 **
	$__˘y≥_tﬁowî_loc
 ()

82 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

83 c⁄° 
__öt32_t
 **
	$__˘y≥_touµî_loc
 ()

84 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

87 #i‚de‡
__˝lu•lus


88 
	#__is˘y≥
(
c
, 
ty≥
) \

89 ((*
	`__˘y≥_b_loc
 ())[(Ë(
c
)] & (Ë
ty≥
)

	)

90 #ñi‡
deföed
 
__USE_EXTERN_INLINES


91 
	#__is˘y≥_f
(
ty≥
) \

92 
__exã∫_ölöe
 \

93 
is
##
	`ty≥
 (
__c
Ë
__THROW
 \

95  (*
	`__˘y≥_b_loc
 ())[(Ë(
__c
)] & (Ë
_IS
##
ty≥
; \

96 
	}

	)
}

99 
	#__ißscii
(
c
Ë(((cË& ~0x7fË=0Ë

	)

100 
	#__tﬂscii
(
c
Ë((cË& 0x7fË

	)

102 
	#__ex˘y≥
(
«me
Ë
	`«me
 (Ë
__THROW


	)

104 
__BEGIN_NAMESPACE_STD


110 
__ex˘y≥
 (
iß um
);

111 
__ex˘y≥
 (
ißÕha
);

112 
__ex˘y≥
 (
is˙ål
);

113 
__ex˘y≥
 (
isdigô
);

114 
__ex˘y≥
 (
i¶owî
);

115 
__ex˘y≥
 (
isgøph
);

116 
__ex˘y≥
 (
i•röt
);

117 
__ex˘y≥
 (
i•un˘
);

118 
__ex˘y≥
 (
is•a˚
);

119 
__ex˘y≥
 (
isuµî
);

120 
__ex˘y≥
 (
isxdigô
);

124 
	$tﬁowî
 (
__c
Ë
__THROW
;

127 
	$touµî
 (
__c
Ë
__THROW
;

129 
__END_NAMESPACE_STD


133 #ifdef 
__USE_ISOC99


134 
__BEGIN_NAMESPACE_C99


136 
	`__ex˘y≥
 (
isbœnk
);

138 
__END_NAMESPACE_C99


141 #ifde‡
__USE_GNU


143 
	$is˘y≥
 (
__c
, 
__mask
Ë
__THROW
;

146 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


150 
	$ißscii
 (
__c
Ë
__THROW
;

154 
	$tﬂscii
 (
__c
Ë
__THROW
;

158 
	`__ex˘y≥
 (
_touµî
);

159 
	`__ex˘y≥
 (
_tﬁowî
);

163 
	#__tobody
(
c
, 
f
, 
a
, 
¨gs
) \

164 (
__exãnsi⁄__
 \

165 ({ 
__ªs
; \

166 i‡( (
c
) > 1) \

168 i‡(
	`__buûtö_c⁄°™t_p
 (
c
)) \

170 
__c
 = (
c
); \

171 
__ªs
 = 
__c
 < -128 || __¯> 255 ? __¯: (
a
)[__c]; \

174 
__ªs
 = 
f
 
¨gs
; \

177 
__ªs
 = (
a
)[(Ë(
c
)]; \

178 
__ªs
; 
	}
}))

	)

180 #i‡!
deföed
 
__NO_CTYPE


181 #ifde‡
__is˘y≥_f


182 
	$__is˘y≥_f
 (
Ænum
)

183 
	$__is˘y≥_f
 (
Æpha
)

184 
	$__is˘y≥_f
 (
˙ål
)

185 
	$__is˘y≥_f
 (
digô
)

186 
	$__is˘y≥_f
 (
lowî
)

187 
	$__is˘y≥_f
 (
gøph
)

188 
	$__is˘y≥_f
 (
¥öt
)

189 
	$__is˘y≥_f
 (
pun˘
)

190 
	$__is˘y≥_f
 (
•a˚
)

191 
	$__is˘y≥_f
 (
uµî
)

192 
	$__is˘y≥_f
 (
xdigô
)

193 #ifde‡
__USE_ISOC99


194 
	$__is˘y≥_f
 (
bœnk
)

196 #ñi‡
deföed
 
__is˘y≥


197 
	#iß um
(
c
Ë
	`__is˘y≥
((c), 
_ISÆnum
)

	)

198 
	#ißÕha
(
c
Ë
	`__is˘y≥
((c), 
_ISÆpha
)

	)

199 
	#is˙ål
(
c
Ë
	`__is˘y≥
((c), 
_IS˙ål
)

	)

200 
	#isdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISdigô
)

	)

201 
	#i¶owî
(
c
Ë
	`__is˘y≥
((c), 
_ISlowî
)

	)

202 
	#isgøph
(
c
Ë
	`__is˘y≥
((c), 
_ISgøph
)

	)

203 
	#i•röt
(
c
Ë
	`__is˘y≥
((c), 
_IS¥öt
)

	)

204 
	#i•un˘
(
c
Ë
	`__is˘y≥
((c), 
_ISpun˘
)

	)

205 
	#is•a˚
(
c
Ë
	`__is˘y≥
((c), 
_IS•a˚
)

	)

206 
	#isuµî
(
c
Ë
	`__is˘y≥
((c), 
_ISuµî
)

	)

207 
	#isxdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISxdigô
)

	)

208 #ifde‡
__USE_ISOC99


209 
	#isbœnk
(
c
Ë
	`__is˘y≥
((c), 
_ISbœnk
)

	)

213 #ifde‡
__USE_EXTERN_INLINES


214 
__exã∫_ölöe
 

215 
	`__NTH
 (
	$tﬁowî
 (
__c
))

217  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_tﬁowî_loc
 ())[__c] : __c;

218 
	}
}

220 
__exã∫_ölöe
 

221 
__NTH
 (
	$touµî
 (
__c
))

223  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_touµî_loc
 ())[__c] : __c;

224 
	}
}

227 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


228 
	#tﬁowî
(
c
Ë
	`__tobody
 (c, 
tﬁowî
, *
	`__˘y≥_tﬁowî_loc
 (), (c))

	)

229 
	#touµî
(
c
Ë
	`__tobody
 (c, 
touµî
, *
	`__˘y≥_touµî_loc
 (), (c))

	)

232 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


233 
	#ißscii
(
c
Ë
	`__ißscii
 (c)

	)

234 
	#tﬂscii
(
c
Ë
	`__tﬂscii
 (c)

	)

236 
	#_tﬁowî
(
c
Ë((Ë(*
	`__˘y≥_tﬁowî_loc
 ())[(Ë(c)])

	)

237 
	#_touµî
(
c
Ë((Ë(*
	`__˘y≥_touµî_loc
 ())[(Ë(c)])

	)

243 #ifde‡
__USE_XOPEN2K8


257 
	~<xloˇÀ.h
>

261 
	#__is˘y≥_l
(
c
, 
ty≥
, 
loˇÀ
) \

262 ((
loˇÀ
)->
__˘y≥_b
[(Ë(
c
)] & (Ë
ty≥
)

	)

264 
	#__ex˘y≥_l
(
«me
) \

265 
	`«me
 (, 
__loˇÀ_t
Ë
__THROW


	)

271 
__ex˘y≥_l
 (
iß um_l
);

272 
__ex˘y≥_l
 (
ißÕha_l
);

273 
__ex˘y≥_l
 (
is˙ål_l
);

274 
__ex˘y≥_l
 (
isdigô_l
);

275 
__ex˘y≥_l
 (
i¶owî_l
);

276 
__ex˘y≥_l
 (
isgøph_l
);

277 
__ex˘y≥_l
 (
i•röt_l
);

278 
__ex˘y≥_l
 (
i•un˘_l
);

279 
__ex˘y≥_l
 (
is•a˚_l
);

280 
__ex˘y≥_l
 (
isuµî_l
);

281 
__ex˘y≥_l
 (
isxdigô_l
);

283 
__ex˘y≥_l
 (
isbœnk_l
);

287 
	$__tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

288 
	$tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

291 
	$__touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

292 
	$touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

294 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


295 
	#__tﬁowî_l
(
c
, 
loˇÀ
) \

296 
	`__tobody
 (
c
, 
__tﬁowî_l
, (
loˇÀ
)->
__˘y≥_tﬁowî
, (c,ÜoˇÀ))

	)

297 
	#__touµî_l
(
c
, 
loˇÀ
) \

298 
	`__tobody
 (
c
, 
__touµî_l
, (
loˇÀ
)->
__˘y≥_touµî
, (c,ÜoˇÀ))

	)

299 
	#tﬁowî_l
(
c
, 
loˇÀ
Ë
	`__tﬁowî_l
 ((c), (loˇÀ))

	)

300 
	#touµî_l
(
c
, 
loˇÀ
Ë
	`__touµî_l
 ((c), (loˇÀ))

	)

304 #i‚de‡
__NO_CTYPE


305 
	#__iß um_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆnum
, (l))

	)

306 
	#__ißÕha_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆpha
, (l))

	)

307 
	#__is˙ål_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS˙ål
, (l))

	)

308 
	#__isdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISdigô
, (l))

	)

309 
	#__i¶owî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISlowî
, (l))

	)

310 
	#__isgøph_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISgøph
, (l))

	)

311 
	#__i•röt_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS¥öt
, (l))

	)

312 
	#__i•un˘_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISpun˘
, (l))

	)

313 
	#__is•a˚_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS•a˚
, (l))

	)

314 
	#__isuµî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISuµî
, (l))

	)

315 
	#__isxdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISxdigô
, (l))

	)

317 
	#__isbœnk_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISbœnk
, (l))

	)

319 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


320 
	#__ißscii_l
(
c
,
l
Ë(÷), 
	`__ißscii
 (c))

	)

321 
	#__tﬂscii_l
(
c
,
l
Ë(÷), 
	`__tﬂscii
 (c))

	)

324 
	#iß um_l
(
c
,
l
Ë
	`__iß um_l
 ((c), (l))

	)

325 
	#ißÕha_l
(
c
,
l
Ë
	`__ißÕha_l
 ((c), (l))

	)

326 
	#is˙ål_l
(
c
,
l
Ë
	`__is˙ål_l
 ((c), (l))

	)

327 
	#isdigô_l
(
c
,
l
Ë
	`__isdigô_l
 ((c), (l))

	)

328 
	#i¶owî_l
(
c
,
l
Ë
	`__i¶owî_l
 ((c), (l))

	)

329 
	#isgøph_l
(
c
,
l
Ë
	`__isgøph_l
 ((c), (l))

	)

330 
	#i•röt_l
(
c
,
l
Ë
	`__i•röt_l
 ((c), (l))

	)

331 
	#i•un˘_l
(
c
,
l
Ë
	`__i•un˘_l
 ((c), (l))

	)

332 
	#is•a˚_l
(
c
,
l
Ë
	`__is•a˚_l
 ((c), (l))

	)

333 
	#isuµî_l
(
c
,
l
Ë
	`__isuµî_l
 ((c), (l))

	)

334 
	#isxdigô_l
(
c
,
l
Ë
	`__isxdigô_l
 ((c), (l))

	)

336 
	#isbœnk_l
(
c
,
l
Ë
	`__isbœnk_l
 ((c), (l))

	)

338 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


339 
	#ißscii_l
(
c
,
l
Ë
	`__ißscii_l
 ((c), (l))

	)

340 
	#tﬂscii_l
(
c
,
l
Ë
	`__tﬂscii_l
 ((c), (l))

	)

347 
__END_DECLS


	@/usr/include/dirent.h

22 #i‚def 
_DIRENT_H


23 
	#_DIRENT_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


29 
	~<bôs/ty≥s.h
>

31 #ifde‡
__USE_XOPEN


32 #i‚de‡
__öo_t_deföed


33 #i‚de‡
__USE_FILE_OFFSET64


34 
__öo_t
 
	töo_t
;

36 
__öo64_t
 
	töo_t
;

38 
	#__öo_t_deföed


	)

40 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__öo64_t_deföed


41 
__öo64_t
 
	töo64_t
;

42 
	#__öo64_t_deföed


	)

61 
	~<bôs/dúít.h
>

63 #i‡(
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
Ë&& !deföed 
d_fûío


64 
	#d_öo
 
d_fûío


	)

81 #ifde‡
_DIRENT_HAVE_D_NAMLEN


82 
	#_D_EXACT_NAMLEN
(
d
Ë((d)->
d_«mÀn
)

	)

83 
	#_D_ALLOC_NAMLEN
(
d
Ë(
	`_D_EXACT_NAMLEN
 (dË+ 1)

	)

85 
	#_D_EXACT_NAMLEN
(
d
Ë(
	`°æí
 ((d)->
d_«me
))

	)

86 #ifde‡
_DIRENT_HAVE_D_RECLEN


87 
	#_D_ALLOC_NAMLEN
(
d
Ë(((*Ë(dË+ (d)->
d_ª˛í
Ë- &(d)->
d_«me
[0])

	)

89 
	#_D_ALLOC_NAMLEN
(
d
Ë( (d)->
d_«me
 > 1 ?  (d)->d_name : \

90 
	`_D_EXACT_NAMLEN
 (
d
Ë+ 1)

	)

95 #ifde‡
__USE_BSD


99 
	mDT_UNKNOWN
 = 0,

100 
	#DT_UNKNOWN
 
DT_UNKNOWN


	)

101 
	mDT_FIFO
 = 1,

102 
	#DT_FIFO
 
DT_FIFO


	)

103 
	mDT_CHR
 = 2,

104 
	#DT_CHR
 
DT_CHR


	)

105 
	mDT_DIR
 = 4,

106 
	#DT_DIR
 
DT_DIR


	)

107 
	mDT_BLK
 = 6,

108 
	#DT_BLK
 
DT_BLK


	)

109 
	mDT_REG
 = 8,

110 
	#DT_REG
 
DT_REG


	)

111 
	mDT_LNK
 = 10,

112 
	#DT_LNK
 
DT_LNK


	)

113 
	mDT_SOCK
 = 12,

114 
	#DT_SOCK
 
DT_SOCK


	)

115 
	mDT_WHT
 = 14

116 
	#DT_WHT
 
DT_WHT


	)

120 
	#IFTODT
(
mode
Ë(((modeË& 0170000Ë>> 12)

	)

121 
	#DTTOIF
(
dúty≥
Ë((dúty≥Ë<< 12)

	)

127 
__dú°ªam
 
	tDIR
;

134 
DIR
 *
	$›ídú
 (c⁄° *
__«me
Ë
	`__n⁄nuŒ
 ((1));

136 #ifde‡
__USE_XOPEN2K8


141 
DIR
 *
	`fd›ídú
 (
__fd
);

149 
	$˛o£dú
 (
DIR
 *
__dúp
Ë
	`__n⁄nuŒ
 ((1));

161 #i‚de‡
__USE_FILE_OFFSET64


162 
dúít
 *
	$ªaddú
 (
DIR
 *
__dúp
Ë
	`__n⁄nuŒ
 ((1));

164 #ifde‡
__REDIRECT


165 
dúít
 *
	`__REDIRECT
 (
ªaddú
, (
DIR
 *
__dúp
), 
ªaddú64
)

166 
	`__n⁄nuŒ
 ((1));

168 
	#ªaddú
 
ªaddú64


	)

172 #ifde‡
__USE_LARGEFILE64


173 
dúít64
 *
	$ªaddú64
 (
DIR
 *
__dúp
Ë
	`__n⁄nuŒ
 ((1));

176 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


182 #i‚de‡
__USE_FILE_OFFSET64


183 
	$ªaddú_r
 (
DIR
 *
__ª°ri˘
 
__dúp
,

184 
dúít
 *
__ª°ri˘
 
__íåy
,

185 
dúít
 **
__ª°ri˘
 
__ªsu…
)

186 
	`__n⁄nuŒ
 ((1, 2, 3));

188 #ifde‡
__REDIRECT


189 
	`__REDIRECT
 (
ªaddú_r
,

190 (
DIR
 *
__ª°ri˘
 
__dúp
,

191 
dúít
 *
__ª°ri˘
 
__íåy
,

192 
dúít
 **
__ª°ri˘
 
__ªsu…
),

193 
ªaddú64_r
Ë
	`__n⁄nuŒ
 ((1, 2, 3));

195 
	#ªaddú_r
 
ªaddú64_r


	)

199 #ifde‡
__USE_LARGEFILE64


200 
	$ªaddú64_r
 (
DIR
 *
__ª°ri˘
 
__dúp
,

201 
dúít64
 *
__ª°ri˘
 
__íåy
,

202 
dúít64
 **
__ª°ri˘
 
__ªsu…
)

203 
	`__n⁄nuŒ
 ((1, 2, 3));

208 
	$ªwöddú
 (
DIR
 *
__dúp
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

210 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


211 
	~<bôs/ty≥s.h
>

214 
	$£ekdú
 (
DIR
 *
__dúp
, 
__pos
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

217 
	$ãŒdú
 (
DIR
 *
__dúp
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

220 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN2K8


223 
	$dúfd
 (
DIR
 *
__dúp
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

225 #i‡
deföed
 
__OPTIMIZE__
 && deföed 
_DIR_dúfd


226 
	#dúfd
(
dúp
Ë
	`_DIR_dúfd
 (dúp)

	)

229 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC


230 #i‚de‡
MAXNAMLEN


232 
	~<bôs/posix1_lim.h
>

235 #ifde‡
NAME_MAX


236 
	#MAXNAMLEN
 
NAME_MAX


	)

238 
	#MAXNAMLEN
 255

	)

243 
	#__√ed_size_t


	)

244 
	~<°ddef.h
>

253 #i‚de‡
__USE_FILE_OFFSET64


254 
	`sˇndú
 (c⁄° *
__ª°ri˘
 
__dú
,

255 
dúít
 ***
__ª°ri˘
 
__«mñi°
,

256 (*
__£À˘‹
Ë(c⁄° 
dúít
 *),

257 (*
__cmp
Ë(c⁄° 
dúít
 **,

258 c⁄° 
dúít
 **))

259 
	`__n⁄nuŒ
 ((1, 2));

261 #ifde‡
__REDIRECT


262 
	`__REDIRECT
 (
sˇndú
,

263 (c⁄° *
__ª°ri˘
 
__dú
,

264 
dúít
 ***
__ª°ri˘
 
__«mñi°
,

265 (*
__£À˘‹
Ë(c⁄° 
dúít
 *),

266 (*
__cmp
Ë(c⁄° 
dúít
 **,

267 c⁄° 
dúít
 **)),

268 
sˇndú64
Ë
	`__n⁄nuŒ
 ((1, 2));

270 
	#sˇndú
 
sˇndú64


	)

274 #i‡
deföed
 
__USE_GNU
 && deföed 
__USE_LARGEFILE64


277 
	`sˇndú64
 (c⁄° *
__ª°ri˘
 
__dú
,

278 
dúít64
 ***
__ª°ri˘
 
__«mñi°
,

279 (*
__£À˘‹
Ë(c⁄° 
dúít64
 *),

280 (*
__cmp
Ë(c⁄° 
dúít64
 **,

281 c⁄° 
dúít64
 **))

282 
	`__n⁄nuŒ
 ((1, 2));

285 #ifde‡
__USE_GNU


291 #i‚de‡
__USE_FILE_OFFSET64


292 
	`sˇndú©
 (
__dfd
, c⁄° *
__ª°ri˘
 
__dú
,

293 
dúít
 ***
__ª°ri˘
 
__«mñi°
,

294 (*
__£À˘‹
Ë(c⁄° 
dúít
 *),

295 (*
__cmp
Ë(c⁄° 
dúít
 **,

296 c⁄° 
dúít
 **))

297 
	`__n⁄nuŒ
 ((2, 3));

299 #ifde‡
__REDIRECT


300 
	`__REDIRECT
 (
sˇndú©
,

301 (
__dfd
, c⁄° *
__ª°ri˘
 
__dú
,

302 
dúít
 ***
__ª°ri˘
 
__«mñi°
,

303 (*
__£À˘‹
Ë(c⁄° 
dúít
 *),

304 (*
__cmp
Ë(c⁄° 
dúít
 **,

305 c⁄° 
dúít
 **)),

306 
sˇndú©64
Ë
	`__n⁄nuŒ
 ((2, 3));

308 
	#sˇndú©
 
sˇndú©64


	)

314 
	`sˇndú©64
 (
__dfd
, c⁄° *
__ª°ri˘
 
__dú
,

315 
dúít64
 ***
__ª°ri˘
 
__«mñi°
,

316 (*
__£À˘‹
Ë(c⁄° 
dúít64
 *),

317 (*
__cmp
Ë(c⁄° 
dúít64
 **,

318 c⁄° 
dúít64
 **))

319 
	`__n⁄nuŒ
 ((2, 3));

323 #i‚de‡
__USE_FILE_OFFSET64


324 
	$Æphas‹t
 (c⁄° 
dúít
 **
__e1
,

325 c⁄° 
dúít
 **
__e2
)

326 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

328 #ifde‡
__REDIRECT


329 
	`__REDIRECT_NTH
 (
Æphas‹t
,

330 (c⁄° 
dúít
 **
__e1
,

331 c⁄° 
dúít
 **
__e2
),

332 
Æphas‹t64
Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

334 
	#Æphas‹t
 
Æphas‹t64


	)

338 #i‡
deföed
 
__USE_GNU
 && deföed 
__USE_LARGEFILE64


339 
	$Æphas‹t64
 (c⁄° 
dúít64
 **
__e1
,

340 c⁄° 
dúít64
 **
__e2
)

341 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

346 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC


351 #i‚de‡
__USE_FILE_OFFSET64


352 
__ssize_t
 
	$gëdúíåõs
 (
__fd
, *
__ª°ri˘
 
__buf
,

353 
size_t
 
__nbyãs
,

354 
__off_t
 *
__ª°ri˘
 
__ba£p
)

355 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

357 #ifde‡
__REDIRECT


358 
__ssize_t
 
	`__REDIRECT_NTH
 (
gëdúíåõs
,

359 (
__fd
, *
__ª°ri˘
 
__buf
,

360 
size_t
 
__nbyãs
,

361 
__off64_t
 *
__ª°ri˘
 
__ba£p
),

362 
gëdúíåõs64
Ë
	`__n⁄nuŒ
 ((2, 4));

364 
	#gëdúíåõs
 
gëdúíåõs64


	)

368 #ifde‡
__USE_LARGEFILE64


369 
__ssize_t
 
	$gëdúíåõs64
 (
__fd
, *
__ª°ri˘
 
__buf
,

370 
size_t
 
__nbyãs
,

371 
__off64_t
 *
__ª°ri˘
 
__ba£p
)

372 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

376 #ifde‡
__USE_GNU


378 #i‚de‡
__USE_FILE_OFFSET64


379 
	$vîsi⁄s‹t
 (c⁄° 
dúít
 **
__e1
,

380 c⁄° 
dúít
 **
__e2
)

381 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

383 #ifde‡
__REDIRECT


384 
	`__REDIRECT_NTH
 (
vîsi⁄s‹t
,

385 (c⁄° 
dúít
 **
__e1
,

386 c⁄° 
dúít
 **
__e2
),

387 
vîsi⁄s‹t64
)

388 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

390 
	#vîsi⁄s‹t
 
vîsi⁄s‹t64


	)

394 #ifde‡
__USE_LARGEFILE64


395 
	$vîsi⁄s‹t64
 (c⁄° 
dúít64
 **
__e1
,

396 c⁄° 
dúít64
 **
__e2
)

397 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

401 
__END_DECLS


	@/usr/include/errno.h

22 #i‚def 
_ERRNO_H


26 #i‚def 
__√ed_Em©h


27 
	#_ERRNO_H
 1

	)

28 
	~<„©uªs.h
>

31 
	g__BEGIN_DECLS


35 
	~<bôs/î∫o.h
>

36 #unde‡
__√ed_Em©h


38 #ifdef 
_ERRNO_H


45 #i‚def 
î∫o


46 
î∫o
;

49 #ifde‡
__USE_GNU


54 *
¥ogøm_övoˇti⁄_«me
, *
¥ogøm_övoˇti⁄_sh‹t_«me
;

58 
	g__END_DECLS


66 #i‡
deföed
 
__USE_GNU
 || deföed 
__√ed_îr‹_t


67 #i‚de‡
__îr‹_t_deföed


68 
	tîr‹_t
;

69 
	#__îr‹_t_deföed
 1

	)

71 #unde‡
__√ed_îr‹_t


	@/usr/include/fcntl.h

22 #i‚def 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


31 
	~<bôs/ty≥s.h
>

35 
	~<bôs/f˙é.h
>

40 #i‚de‡
__mode_t_deföed


41 
__mode_t
 
	tmode_t
;

42 
	#__mode_t_deföed


	)

45 #i‚de‡
__off_t_deföed


46 #i‚de‡
__USE_FILE_OFFSET64


47 
__off_t
 
	toff_t
;

49 
__off64_t
 
	toff_t
;

51 
	#__off_t_deföed


	)

54 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


55 
__off64_t
 
	toff64_t
;

56 
	#__off64_t_deföed


	)

59 #i‚de‡
__pid_t_deföed


60 
__pid_t
 
	tpid_t
;

61 
	#__pid_t_deföed


	)

65 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


66 
	#__√ed_time•ec


	)

67 
	~<time.h
>

68 
	~<bôs/°©.h
>

70 
	#S_IFMT
 
__S_IFMT


	)

71 
	#S_IFDIR
 
__S_IFDIR


	)

72 
	#S_IFCHR
 
__S_IFCHR


	)

73 
	#S_IFBLK
 
__S_IFBLK


	)

74 
	#S_IFREG
 
__S_IFREG


	)

75 #ifde‡
__S_IFIFO


76 
	#S_IFIFO
 
__S_IFIFO


	)

78 #ifde‡
__S_IFLNK


79 
	#S_IFLNK
 
__S_IFLNK


	)

81 #i‡(
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8
Ë&& deföed 
__S_IFSOCK


82 
	#S_IFSOCK
 
__S_IFSOCK


	)

87 
	#S_ISUID
 
__S_ISUID


	)

88 
	#S_ISGID
 
__S_ISGID


	)

90 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


92 
	#S_ISVTX
 
__S_ISVTX


	)

95 
	#S_IRUSR
 
__S_IREAD


	)

96 
	#S_IWUSR
 
__S_IWRITE


	)

97 
	#S_IXUSR
 
__S_IEXEC


	)

99 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

101 
	#S_IRGRP
 (
S_IRUSR
 >> 3Ë

	)

102 
	#S_IWGRP
 (
S_IWUSR
 >> 3Ë

	)

103 
	#S_IXGRP
 (
S_IXUSR
 >> 3Ë

	)

105 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

107 
	#S_IROTH
 (
S_IRGRP
 >> 3Ë

	)

108 
	#S_IWOTH
 (
S_IWGRP
 >> 3Ë

	)

109 
	#S_IXOTH
 (
S_IXGRP
 >> 3Ë

	)

111 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

114 #ifdef 
__USE_MISC


115 #i‚de‡
R_OK


118 
	#R_OK
 4

	)

119 
	#W_OK
 2

	)

120 
	#X_OK
 1

	)

121 
	#F_OK
 0

	)

126 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


127 
	#SEEK_SET
 0

	)

128 
	#SEEK_CUR
 1

	)

129 
	#SEEK_END
 2

	)

137 
f˙é
 (
__fd
, 
__cmd
, ...);

145 #i‚de‡
__USE_FILE_OFFSET64


146 
	$›í
 (c⁄° *
__fûe
, 
__oÊag
, ...Ë
	`__n⁄nuŒ
 ((1));

148 #ifde‡
__REDIRECT


149 
	`__REDIRECT
 (
›í
, (c⁄° *
__fûe
, 
__oÊag
, ...), 
›í64
)

150 
	`__n⁄nuŒ
 ((1));

152 
	#›í
 
›í64


	)

155 #ifde‡
__USE_LARGEFILE64


156 
	$›í64
 (c⁄° *
__fûe
, 
__oÊag
, ...Ë
	`__n⁄nuŒ
 ((1));

159 #ifde‡
__USE_ATFILE


169 #i‚de‡
__USE_FILE_OFFSET64


170 
	$›í©
 (
__fd
, c⁄° *
__fûe
, 
__oÊag
, ...)

171 
	`__n⁄nuŒ
 ((2));

173 #ifde‡
__REDIRECT


174 
	`__REDIRECT
 (
›í©
, (
__fd
, c⁄° *
__fûe
, 
__oÊag
,

175 ...), 
›í©64
Ë
	`__n⁄nuŒ
 ((2));

177 
	#›í©
 
›í©64


	)

180 #ifde‡
__USE_LARGEFILE64


181 
	$›í©64
 (
__fd
, c⁄° *
__fûe
, 
__oÊag
, ...)

182 
	`__n⁄nuŒ
 ((2));

191 #i‚de‡
__USE_FILE_OFFSET64


192 
	$¸ót
 (c⁄° *
__fûe
, 
mode_t
 
__mode
Ë
	`__n⁄nuŒ
 ((1));

194 #ifde‡
__REDIRECT


195 
	`__REDIRECT
 (
¸ót
, (c⁄° *
__fûe
, 
mode_t
 
__mode
),

196 
¸ót64
Ë
	`__n⁄nuŒ
 ((1));

198 
	#¸ót
 
¸ót64


	)

201 #ifde‡
__USE_LARGEFILE64


202 
	$¸ót64
 (c⁄° *
__fûe
, 
mode_t
 
__mode
Ë
	`__n⁄nuŒ
 ((1));

205 #i‡!
deföed
 
F_LOCK
 && (deföed 
__USE_MISC
 || (deföed 
__USE_XOPEN_EXTENDED
 \

206 && !
deföed
 
__USE_POSIX
))

215 
	#F_ULOCK
 0

	)

216 
	#F_LOCK
 1

	)

217 
	#F_TLOCK
 2

	)

218 
	#F_TEST
 3

	)

220 #i‚de‡
__USE_FILE_OFFSET64


221 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Àn
);

223 #ifde‡
__REDIRECT


224 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
), 
lockf64
);

226 
	#lockf
 
lockf64


	)

229 #ifde‡
__USE_LARGEFILE64


230 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Àn
);

234 #ifde‡
__USE_XOPEN2K


237 #i‚de‡
__USE_FILE_OFFSET64


238 
	$posix_Ádvi£
 (
__fd
, 
off_t
 
__off£t
, off_à
__Àn
,

239 
__advi£
Ë
__THROW
;

241 #ifde‡
__REDIRECT_NTH


242 
	`__REDIRECT_NTH
 (
posix_Ádvi£
, (
__fd
, 
__off64_t
 
__off£t
,

243 
__off64_t
 
__Àn
, 
__advi£
),

244 
posix_Ádvi£64
);

246 
	#posix_Ádvi£
 
posix_Ádvi£64


	)

249 #ifde‡
__USE_LARGEFILE64


250 
	$posix_Ádvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_à
__Àn
,

251 
__advi£
Ë
__THROW
;

259 #i‚de‡
__USE_FILE_OFFSET64


260 
	`posix_ÁŒoˇã
 (
__fd
, 
off_t
 
__off£t
, off_à
__Àn
);

262 #ifde‡
__REDIRECT


263 
	`__REDIRECT
 (
posix_ÁŒoˇã
, (
__fd
, 
__off64_t
 
__off£t
,

264 
__off64_t
 
__Àn
),

265 
posix_ÁŒoˇã64
);

267 
	#posix_ÁŒoˇã
 
posix_ÁŒoˇã64


	)

270 #ifde‡
__USE_LARGEFILE64


271 
	`posix_ÁŒoˇã64
 (
__fd
, 
off64_t
 
__off£t
, off64_à
__Àn
);

277 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄
 \

278 && 
deföed
 
__va_¨g_∑ck_Àn


279 
	~<bôs/f˙é2.h
>

282 
__END_DECLS


	@/usr/include/limits.h

22 #i‚de‡
_LIBC_LIMITS_H_


23 
	#_LIBC_LIMITS_H_
 1

	)

25 
	~<„©uªs.h
>

31 
	#MB_LEN_MAX
 16

	)

36 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2

41 #i‚de‡
_LIMITS_H


42 
	#_LIMITS_H
 1

	)

44 
	~<bôs/w‹dsize.h
>

53 
	#CHAR_BIT
 8

	)

56 
	#SCHAR_MIN
 (-128)

	)

57 
	#SCHAR_MAX
 127

	)

60 
	#UCHAR_MAX
 255

	)

63 #ifde‡
__CHAR_UNSIGNED__


64 
	#CHAR_MIN
 0

	)

65 
	#CHAR_MAX
 
UCHAR_MAX


	)

67 
	#CHAR_MIN
 
SCHAR_MIN


	)

68 
	#CHAR_MAX
 
SCHAR_MAX


	)

72 
	#SHRT_MIN
 (-32768)

	)

73 
	#SHRT_MAX
 32767

	)

76 
	#USHRT_MAX
 65535

	)

79 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

80 
	#INT_MAX
 2147483647

	)

83 
	#UINT_MAX
 4294967295U

	)

86 #i‡
__WORDSIZE
 == 64

87 
	#LONG_MAX
 9223372036854775807L

	)

89 
	#LONG_MAX
 2147483647L

	)

91 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

94 #i‡
__WORDSIZE
 == 64

95 
	#ULONG_MAX
 18446744073709551615UL

	)

97 
	#ULONG_MAX
 4294967295UL

	)

100 #ifde‡
__USE_ISOC99


103 
	#LLONG_MAX
 9223372036854775807LL

	)

104 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

107 
	#ULLONG_MAX
 18446744073709551615ULL

	)

121 #i‡
deföed
 
__GNUC__
 && !deföed 
_GCC_LIMITS_H_


123 #ö˛ude_√xà<
limôs
.
h
>

129 #i‡
deföed
 
__USE_ISOC99
 && deföed 
__GNUC__


130 #i‚de‡
LLONG_MIN


131 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

133 #i‚de‡
LLONG_MAX


134 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

136 #i‚de‡
ULLONG_MAX


137 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

141 #ifdef 
__USE_POSIX


143 
	~<bôs/posix1_lim.h
>

146 #ifdef 
__USE_POSIX2


147 
	~<bôs/posix2_lim.h
>

150 #ifdef 
__USE_XOPEN


151 
	~<bôs/x›í_lim.h
>

	@/usr/include/malloc.h

19 #i‚de‡
_MALLOC_H


20 
	#_MALLOC_H
 1

	)

22 
	~<„©uªs.h
>

23 
	~<°ddef.h
>

24 
	~<°dio.h
>

26 #ifde‡
_LIBC


27 
	#__MALLOC_HOOK_VOLATILE


	)

28 
	#__MALLOC_DEPRECATED


	)

30 
	#__MALLOC_HOOK_VOLATILE
 vﬁ©ûe

	)

31 
	#__MALLOC_DEPRECATED
 
__©åibuã_dïªˇãd__


	)

35 
__BEGIN_DECLS


38 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

41 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

42 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

49 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

50 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

53 
	$‰ì
 (*
__±r
Ë
__THROW
;

56 
	$c‰ì
 (*
__±r
Ë
__THROW
;

59 *
	$memÆign
 (
size_t
 
__Æignmít
, size_à
__size
)

60 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

63 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

67 *
	$pvÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

71 *(*
__m‹ec‹e
Ë(
±rdiff_t
 
__size
);

74 *
	$__deÁu…_m‹ec‹e
 (
±rdiff_t
 
__size
)

75 
__THROW
 
__©åibuã_mÆloc__
;

79 
	smÆlöfo


81 
¨ía
;

82 
‹dblks
;

83 
smblks
;

84 
hblks
;

85 
hblkhd
;

86 
usmblks
;

87 
fsmblks
;

88 
u‹dblks
;

89 
f‹dblks
;

90 
kìpco°
;

94 
mÆlöfo
 
	$mÆlöfo
 (Ë
__THROW
;

97 #i‚de‡
M_MXFAST


98 
	#M_MXFAST
 1

	)

100 #i‚de‡
M_NLBLKS


101 
	#M_NLBLKS
 2

	)

103 #i‚de‡
M_GRAIN


104 
	#M_GRAIN
 3

	)

106 #i‚de‡
M_KEEP


107 
	#M_KEEP
 4

	)

111 
	#M_TRIM_THRESHOLD
 -1

	)

112 
	#M_TOP_PAD
 -2

	)

113 
	#M_MMAP_THRESHOLD
 -3

	)

114 
	#M_MMAP_MAX
 -4

	)

115 
	#M_CHECK_ACTION
 -5

	)

116 
	#M_PERTURB
 -6

	)

117 
	#M_ARENA_TEST
 -7

	)

118 
	#M_ARENA_MAX
 -8

	)

121 
	$mÆl›t
 (
__∑øm
, 
__vÆ
Ë
__THROW
;

125 
	$mÆloc_åim
 (
size_t
 
__∑d
Ë
__THROW
;

129 
size_t
 
	$mÆloc_ußbÀ_size
 (*
__±r
Ë
__THROW
;

132 
	$mÆloc_°©s
 (Ë
__THROW
;

135 
	$mÆloc_öfo
 (
__›ti⁄s
, 
FILE
 *
__Â
Ë
__THROW
;

138 *
	$mÆloc_gë_°©e
 (Ë
__THROW
;

142 
	$mÆloc_£t_°©e
 (*
__±r
Ë
__THROW
;

147 (*
__MALLOC_HOOK_VOLATILE
 
__mÆloc_öôülize_hook
) ()

148 
__MALLOC_DEPRECATED
;

150 (*
__MALLOC_HOOK_VOLATILE
 
__‰ì_hook
Ë(*
__±r
,

152 
__MALLOC_DEPRECATED
;

153 *(*
__MALLOC_HOOK_VOLATILE
 
__mÆloc_hook
)(
size_t
 
__size
,

155 
__MALLOC_DEPRECATED
;

156 *(*
__MALLOC_HOOK_VOLATILE
 
__ªÆloc_hook
)(*
__±r
,

157 
size_t
 
__size
,

159 
__MALLOC_DEPRECATED
;

160 *(*
__MALLOC_HOOK_VOLATILE
 
__memÆign_hook
)(
size_t
 
__Æignmít
,

161 
size_t
 
__size
,

163 
__MALLOC_DEPRECATED
;

164 (*
__MALLOC_HOOK_VOLATILE
 
__a·î_m‹ec‹e_hook
) ();

167 
	$__mÆloc_check_öô
 (Ë
__THROW
 
__MALLOC_DEPRECATED
;

170 
__END_DECLS


	@/usr/include/math.h

23 #i‚def 
_MATH_H


24 
	#_MATH_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


32 
	~<bôs/huge_vÆ.h
>

33 #ifde‡
__USE_ISOC99


34 
	~<bôs/huge_vÆf.h
>

35 
	~<bôs/huge_vÆl.h
>

38 
	~<bôs/öf.h
>

41 
	~<bôs/«n.h
>

45 
	~<bôs/m©hdef.h
>

52 
	#__MATHCALL
(
fun˘i⁄
,
suffix
, 
¨gs
) \

53 
	`__MATHDECL
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
)

	)

54 
	#__MATHDECL
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

55 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
); \

56 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
)

	)

57 
	#__MATHCALLX
(
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

58 
	`__MATHDECLX
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
)

	)

59 
	#__MATHDECLX
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

60 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
); \

61 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
)

	)

62 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

63 
ty≥
 
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
Ë
¨gs
 
__THROW


	)

65 
	#_MdoubÀ_
 

	)

66 
	#__MATH_PRECNAME
(
«me
,
r
Ë
	`__CONCAT
“ame,r)

	)

67 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

68 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

69 
	~<bôs/m©hˇŒs.h
>

70 #unde‡
_MdoubÀ_


71 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


72 #unde‡
_MdoubÀ_END_NAMESPACE


73 #unde‡
__MATH_PRECNAME


75 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


81 #i‚de‡
_MÊﬂt_


82 
	#_MÊﬂt_
 

	)

84 
	#_MdoubÀ_
 
_MÊﬂt_


	)

85 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
f
##
	)
r

86 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

87 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

88 
	~<bôs/m©hˇŒs.h
>

89 #unde‡
_MdoubÀ_


90 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


91 #unde‡
_MdoubÀ_END_NAMESPACE


92 #unde‡
__MATH_PRECNAME


94 #i‡!(
deföed
 
__NO_LONG_DOUBLE_MATH
 && deföed 
_LIBC
) \

95 || 
deföed
 
__LDBL_COMPAT


96 #ifde‡
__LDBL_COMPAT


98 #ifde‡
__USE_ISOC99


99 
	$__∆dbl_√xâow¨df
 (
__x
, 
__y
)

100 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

101 #ifde‡
__REDIRECT_NTH


102 
	`__REDIRECT_NTH
 (
√xâow¨df
, (
__x
, 
__y
),

103 
__∆dbl_√xâow¨df
)

104 
	`__©åibuã__
 ((
__c⁄°__
));

105 
	`__REDIRECT_NTH
 (
√xâow¨d
, (
__x
, 
__y
),

106 
√xè·î
Ë
	`__©åibuã__
 ((
__c⁄°__
));

107 
	`__REDIRECT_NTH
 (
√xâow¨dl
,

108 (
__x
, 
__y
),

109 
√xè·î
Ë
	`__©åibuã__
 ((
__c⁄°__
));

113 #unde‡
__MATHDECL_1


114 
	#__MATHDECL_2
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
Æüs
) \

115 
ty≥
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
), \

116 
¨gs
, 
Æüs
)

	)

117 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

118 
	`__MATHDECL_2
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
	`__CONCAT
(fun˘i⁄,suffix))

	)

124 #i‚de‡
_Ml⁄g_doubÀ_


125 
	#_Ml⁄g_doubÀ_
 

	)

127 
	#_MdoubÀ_
 
_Ml⁄g_doubÀ_


	)

128 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
l
##
	)
r

129 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

130 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

131 
	#__MATH_DECLARE_LDOUBLE
 1

	)

132 
	~<bôs/m©hˇŒs.h
>

133 #unde‡
_MdoubÀ_


134 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


135 #unde‡
_MdoubÀ_END_NAMESPACE


136 #unde‡
__MATH_PRECNAME


141 #unde‡
__MATHDECL_1


142 #unde‡
__MATHDECL


143 #unde‡
__MATHCALL


146 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


148 
signgam
;

153 #ifde‡
__USE_ISOC99


191 
FP_NAN
 =

192 
	#FP_NAN
 0

	)

193 
FP_NAN
,

194 
FP_INFINITE
 =

195 
	#FP_INFINITE
 1

	)

196 
FP_INFINITE
,

197 
FP_ZERO
 =

198 
	#FP_ZERO
 2

	)

199 
FP_ZERO
,

200 
FP_SUBNORMAL
 =

201 
	#FP_SUBNORMAL
 3

	)

202 
FP_SUBNORMAL
,

203 
FP_NORMAL
 =

204 
	#FP_NORMAL
 4

	)

205 
FP_NORMAL


209 #ifde‡
__NO_LONG_DOUBLE_MATH


210 
	#Â˛assify
(
x
) \

211 ( (
x
Ë= (Ë? 
	`__Â˛assifyf
 (xË: 
	`__Â˛assify
 (x))

	)

213 
	#Â˛assify
(
x
) \

214 ( (
x
) ==  () \

215 ? 
	`__Â˛assifyf
 (
x
) \

216 :  (
x
) ==  () \

217 ? 
	`__Â˛assify
 (
x
Ë: 
	`__Â˛assifyl
 (x))

	)

221 #ifde‡
__NO_LONG_DOUBLE_MATH


222 
	#signbô
(
x
) \

223 ( (
x
Ë= (Ë? 
	`__signbôf
 (xË: 
	`__signbô
 (x))

	)

225 
	#signbô
(
x
) \

226 ( (
x
) ==  () \

227 ? 
	`__signbôf
 (
x
) \

228 :  (
x
) ==  () \

229 ? 
	`__signbô
 (
x
Ë: 
	`__signbôl
 (x))

	)

233 #ifde‡
__NO_LONG_DOUBLE_MATH


234 
	#isföôe
(
x
) \

235 ( (
x
Ë= (Ë? 
	`__föôef
 (xË: 
	`__föôe
 (x))

	)

237 
	#isföôe
(
x
) \

238 ( (
x
) ==  () \

239 ? 
	`__föôef
 (
x
) \

240 :  (
x
) ==  () \

241 ? 
	`__föôe
 (
x
Ë: 
	`__föôñ
 (x))

	)

245 
	#i¢‹mÆ
(
x
Ë(
	`Â˛assify
 (xË=
FP_NORMAL
)

	)

249 #ifde‡
__NO_LONG_DOUBLE_MATH


250 
	#i¢™
(
x
) \

251 ( (
x
Ë= (Ë? 
	`__i¢™f
 (xË: 
	`__i¢™
 (x))

	)

253 
	#i¢™
(
x
) \

254 ( (
x
) ==  () \

255 ? 
	`__i¢™f
 (
x
) \

256 :  (
x
) ==  () \

257 ? 
	`__i¢™
 (
x
Ë: 
	`__i¢™l
 (x))

	)

261 #ifde‡
__NO_LONG_DOUBLE_MATH


262 
	#isöf
(
x
) \

263 ( (
x
Ë= (Ë? 
	`__isöff
 (xË: 
	`__isöf
 (x))

	)

265 
	#isöf
(
x
) \

266 ( (
x
) ==  () \

267 ? 
	`__isöff
 (
x
) \

268 :  (
x
) ==  () \

269 ? 
	`__isöf
 (
x
Ë: 
	`__isöÊ
 (x))

	)

273 
	#MATH_ERRNO
 1

	)

274 
	#MATH_ERREXCEPT
 2

	)

279 #i‚de‡
__FAST_MATH__


280 
	#m©h_îrh™dlög
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

285 #ifde‡
__USE_GNU


287 #ifde‡
__NO_LONG_DOUBLE_MATH


288 
	#issig«lög
(
x
) \

289 ( (
x
Ë= (Ë? 
	`__issig«lögf
 (xË: 
	`__issig«lög
 (x))

	)

291 
	#issig«lög
(
x
) \

292 ( (
x
) ==  () \

293 ? 
	`__issig«lögf
 (
x
) \

294 :  (
x
) ==  () \

295 ? 
	`__issig«lög
 (
x
Ë: 
	`__issig«lögl
 (x))

	)

299 #ifdef 
__USE_MISC


303 
_IEEE_
 = -1,

304 
_SVID_
,

305 
_XOPEN_
,

306 
_POSIX_
,

307 
_ISOC_


308 } 
	t_LIB_VERSION_TYPE
;

313 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

317 #ifde‡
__USE_SVID


323 #ifde‡
__˝lu•lus


324 
__ex˚±i⁄


326 
ex˚±i⁄


329 
ty≥
;

330 *
«me
;

331 
¨g1
;

332 
¨g2
;

333 
ªtvÆ
;

334 
	}
};

336 #ifde‡
__˝lu•lus


337 
	$m©hîr
 (
__ex˚±i⁄
 *
__exc
Ë
	`throw
 ();

339 
	`m©hîr
 (
ex˚±i⁄
 *
__exc
);

342 
	#X_TLOSS
 1.41484755040568800000e+16

	)

345 
	#DOMAIN
 1

	)

346 
	#SING
 2

	)

347 
	#OVERFLOW
 3

	)

348 
	#UNDERFLOW
 4

	)

349 
	#TLOSS
 5

	)

350 
	#PLOSS
 6

	)

353 
	#HUGE
 3.40282347e+38F

	)

357 #ifde‡
__USE_XOPEN


359 
	#MAXFLOAT
 3.40282347e+38F

	)

366 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


367 
	#M_E
 2.7182818284590452354

	)

368 
	#M_LOG2E
 1.4426950408889634074

	)

369 
	#M_LOG10E
 0.43429448190325182765

	)

370 
	#M_LN2
 0.69314718055994530942

	)

371 
	#M_LN10
 2.30258509299404568402

	)

372 
	#M_PI
 3.14159265358979323846

	)

373 
	#M_PI_2
 1.57079632679489661923

	)

374 
	#M_PI_4
 0.78539816339744830962

	)

375 
	#M_1_PI
 0.31830988618379067154

	)

376 
	#M_2_PI
 0.63661977236758134308

	)

377 
	#M_2_SQRTPI
 1.12837916709551257390

	)

378 
	#M_SQRT2
 1.41421356237309504880

	)

379 
	#M_SQRT1_2
 0.70710678118654752440

	)

385 #ifde‡
__USE_GNU


386 
	#M_El
 2.718281828459045235360287471352662498L

	)

387 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

388 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

389 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

390 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

391 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

392 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

393 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

394 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

395 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

396 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

397 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

398 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

405 #i‡
deföed
 
__STRICT_ANSI__
 && !deföed 
__NO_MATH_INLINES


406 
	#__NO_MATH_INLINES
 1

	)

409 #i‡
deföed
 
__USE_ISOC99
 && 
	`__GNUC_PREREQ
(2,97)

416 
	#isgª©î
(
x
, 
y
Ë
	`__buûtö_isgª©î
(x, y)

	)

417 
	#isgª©îequÆ
(
x
, 
y
Ë
	`__buûtö_isgª©îequÆ
(x, y)

	)

418 
	#i¶ess
(
x
, 
y
Ë
	`__buûtö_i¶ess
(x, y)

	)

419 
	#i¶es£quÆ
(
x
, 
y
Ë
	`__buûtö_i¶es£quÆ
(x, y)

	)

420 
	#i¶essgª©î
(
x
, 
y
Ë
	`__buûtö_i¶essgª©î
(x, y)

	)

421 
	#isun‹dîed
(
u
, 
v
Ë
	`__buûtö_isun‹dîed
(u, v)

	)

425 #ifde‡
__USE_EXTERN_INLINES


426 
	~<bôs/m©hölöe.h
>

431 #i‡
deföed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

432 
	~<bôs/m©h-föôe.h
>

435 #ifde‡
__USE_ISOC99


439 #i‚de‡
isgª©î


440 
	#isgª©î
(
x
, 
y
) \

441 (
__exãnsi⁄__
 \

442 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

443 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x > __y; 
	}
}))

	)

447 #i‚de‡
isgª©îequÆ


448 
	#isgª©îequÆ
(
x
, 
y
) \

449 (
__exãnsi⁄__
 \

450 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

451 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x >__y; }))

	)

455 #i‚de‡
i¶ess


456 
	#i¶ess
(
x
, 
y
) \

457 (
__exãnsi⁄__
 \

458 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

459 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x < __y; }))

	)

463 #i‚de‡
i¶es£quÆ


464 
	#i¶es£quÆ
(
x
, 
y
) \

465 (
__exãnsi⁄__
 \

466 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

467 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x <__y; }))

	)

471 #i‚de‡
i¶essgª©î


472 
	#i¶essgª©î
(
x
, 
y
) \

473 (
__exãnsi⁄__
 \

474 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

475 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& (__x < __y || __y < __x); }))

	)

479 #i‚de‡
isun‹dîed


480 
	#isun‹dîed
(
u
, 
v
) \

481 (
__exãnsi⁄__
 \

482 ({ 
	`__ty≥of__
(
u
Ë
__u
 = (u); __ty≥of__(
v
Ë
__v
 = (v); \

483 
	`Â˛assify
 (
__u
Ë=
FP_NAN
 || fp˛assify (
__v
Ë=FP_NAN; }))

	)

488 
	g__END_DECLS


	@/usr/include/memory.h

22 #i‚def 
_MEMORY_H


23 
	#_MEMORY_H
 1

	)

25 
	~<„©uªs.h
>

28 #i‚def 
_STRING_H


29 
	~<°rög.h
>

	@/usr/include/netdb.h

22 #i‚def 
_NETDB_H


23 
	#_NETDB_H
 1

	)

25 
	~<„©uªs.h
>

27 
	~<√töë/ö.h
>

28 
	~<°döt.h
>

29 #ifde‡
__USE_MISC


32 
	~<Ωc/√tdb.h
>

35 #ifde‡
__USE_GNU


36 
	#__√ed_sigevít_t


	)

37 
	~<bôs/sigöfo.h
>

38 
	#__√ed_time•ec


	)

39 
	~<time.h
>

42 
	~<bôs/√tdb.h
>

45 
	#_PATH_HEQUIV
 "/ëc/ho°s.equiv"

	)

46 
	#_PATH_HOSTS
 "/ëc/ho°s"

	)

47 
	#_PATH_NETWORKS
 "/ëc/√tw‹ks"

	)

48 
	#_PATH_NSSWITCH_CONF
 "/ëc/nsswôch.c⁄f"

	)

49 
	#_PATH_PROTOCOLS
 "/ëc/¥Ÿocﬁs"

	)

50 
	#_PATH_SERVICES
 "/ëc/£rvi˚s"

	)

53 
	g__BEGIN_DECLS


55 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8


58 
	#h_î∫o
 (*
	`__h_î∫o_loˇti⁄
 ())

	)

61 *
	$__h_î∫o_loˇti⁄
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

65 
	#HOST_NOT_FOUND
 1

	)

66 
	#TRY_AGAIN
 2

	)

68 
	#NO_RECOVERY
 3

	)

70 
	#NO_DATA
 4

	)

73 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


74 
	#NETDB_INTERNAL
 -1

	)

75 
	#NETDB_SUCCESS
 0

	)

76 
	#NO_ADDRESS
 
NO_DATA


	)

79 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_XOPEN_EXTENDED


81 
	#IPPORT_RESERVED
 1024

	)

84 #ifde‡
__USE_GNU


86 
	#SCOPE_DELIMITER
 '%'

	)

89 #ifde‡
__USE_MISC


92 
	$hîr‹
 (c⁄° *
__°r
Ë
__THROW
;

95 c⁄° *
	$h°ªº‹
 (
__îr_num
Ë
__THROW
;

100 
	sho°ít


102 *
h_«me
;

103 **
h_Æü£s
;

104 
h_addπy≥
;

105 
h_Àngth
;

106 **
h_addr_li°
;

107 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


108 
	#h_addr
 
h_addr_li°
[0]

	)

117 
	`£tho°ít
 (
__°ay_›í
);

123 
	`ídho°ít
 ();

130 
ho°ít
 *
	`gëho°ít
 ();

137 
ho°ít
 *
	`gëho°byaddr
 (c⁄° *
__addr
, 
__sockÀn_t
 
__Àn
,

138 
__ty≥
);

144 
ho°ít
 *
	`gëho°by«me
 (c⁄° *
__«me
);

146 #ifde‡
__USE_MISC


155 
ho°ít
 *
	`gëho°by«me2
 (c⁄° *
__«me
, 
__af
);

167 
	`gëho°ít_r
 (
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

168 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

169 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

170 *
__ª°ri˘
 
__h_î∫›
);

172 
	`gëho°byaddr_r
 (c⁄° *
__ª°ri˘
 
__addr
, 
__sockÀn_t
 
__Àn
,

173 
__ty≥
,

174 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

175 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

176 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

177 *
__ª°ri˘
 
__h_î∫›
);

179 
	`gëho°by«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

180 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

181 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

182 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

183 *
__ª°ri˘
 
__h_î∫›
);

185 
	`gëho°by«me2_r
 (c⁄° *
__ª°ri˘
 
__«me
, 
__af
,

186 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

187 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

188 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

189 *
__ª°ri˘
 
__h_î∫›
);

198 
	`£äëít
 (
__°ay_›í
);

204 
	`íd√ã¡
 ();

211 
√ã¡
 *
	`gë√ã¡
 ();

218 
√ã¡
 *
	`gë√tbyaddr
 (
uöt32_t
 
__√t
, 
__ty≥
);

224 
√ã¡
 *
	`gë√tby«me
 (c⁄° *
__«me
);

226 #ifdef 
__USE_MISC


237 
	`gë√ã¡_r
 (
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

238 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

239 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

240 *
__ª°ri˘
 
__h_î∫›
);

242 
	`gë√tbyaddr_r
 (
uöt32_t
 
__√t
, 
__ty≥
,

243 
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

244 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

245 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

246 *
__ª°ri˘
 
__h_î∫›
);

248 
	`gë√tby«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

249 
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

250 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

251 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

252 *
__ª°ri˘
 
__h_î∫›
);

257 
	s£rvít


259 *
s_«me
;

260 **
s_Æü£s
;

261 
s_p‹t
;

262 *
s_¥Ÿo
;

270 
	`£t£rvít
 (
__°ay_›í
);

276 
	`íd£rvít
 ();

283 
£rvít
 *
	`gë£rvít
 ();

290 
£rvít
 *
	`gë£rvby«me
 (c⁄° *
__«me
, c⁄° *
__¥Ÿo
);

297 
£rvít
 *
	`gë£rvbyp‹t
 (
__p‹t
, c⁄° *
__¥Ÿo
);

300 #ifdef 
__USE_MISC


308 
	`gë£rvít_r
 (
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

309 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

310 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

312 
	`gë£rvby«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

313 c⁄° *
__ª°ri˘
 
__¥Ÿo
,

314 
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

315 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

316 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

318 
	`gë£rvbyp‹t_r
 (
__p‹t
, c⁄° *
__ª°ri˘
 
__¥Ÿo
,

319 
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

320 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

321 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

326 
	s¥Ÿ€¡


328 *
p_«me
;

329 **
p_Æü£s
;

330 
p_¥Ÿo
;

338 
	`£çrŸ€¡
 (
__°ay_›í
);

344 
	`íd¥Ÿ€¡
 ();

351 
¥Ÿ€¡
 *
	`gë¥Ÿ€¡
 ();

357 
¥Ÿ€¡
 *
	`gë¥Ÿoby«me
 (c⁄° *
__«me
);

363 
¥Ÿ€¡
 *
	`gë¥Ÿobynumbî
 (
__¥Ÿo
);

366 #ifdef 
__USE_MISC


374 
	`gë¥Ÿ€¡_r
 (
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

375 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

376 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

378 
	`gë¥Ÿoby«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

379 
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

380 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

381 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

383 
	`gë¥Ÿobynumbî_r
 (
__¥Ÿo
,

384 
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

385 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

386 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

395 
	`£äëgª¡
 (c⁄° *
__√tgroup
);

403 
	`íd√tgª¡
 ();

412 
	`gë√tgª¡
 (**
__ª°ri˘
 
__ho°p
,

413 **
__ª°ri˘
 
__u£Ω
,

414 **
__ª°ri˘
 
__domaöp
);

423 
	`ö√tgr
 (c⁄° *
__√tgroup
, c⁄° *
__ho°
,

424 c⁄° *
__u£r
, c⁄° *
__domaö
);

432 
	`gë√tgª¡_r
 (**
__ª°ri˘
 
__ho°p
,

433 **
__ª°ri˘
 
__u£Ω
,

434 **
__ª°ri˘
 
__domaöp
,

435 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
);

439 #ifde‡
__USE_BSD


451 
	`rcmd
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

452 c⁄° *
__ª°ri˘
 
__locu£r
,

453 c⁄° *
__ª°ri˘
 
__ªmu£r
,

454 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
);

463 
	`rcmd_af
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

464 c⁄° *
__ª°ri˘
 
__locu£r
,

465 c⁄° *
__ª°ri˘
 
__ªmu£r
,

466 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
,

467 
ß_Ámûy_t
 
__af
);

479 
	`ªxec
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

480 c⁄° *
__ª°ri˘
 
__«me
,

481 c⁄° *
__ª°ri˘
 
__∑ss
,

482 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
);

491 
	`ªxec_af
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

492 c⁄° *
__ª°ri˘
 
__«me
,

493 c⁄° *
__ª°ri˘
 
__∑ss
,

494 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
,

495 
ß_Ámûy_t
 
__af
);

505 
	`ru£rok
 (c⁄° *
__rho°
, 
__su£r
,

506 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
);

515 
	`ru£rok_af
 (c⁄° *
__rho°
, 
__su£r
,

516 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
,

517 
ß_Ámûy_t
 
__af
);

528 
	`úu£rok
 (
uöt32_t
 
__øddr
, 
__su£r
,

529 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
);

539 
	`úu£rok_af
 (c⁄° *
__øddr
, 
__su£r
,

540 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
,

541 
ß_Ámûy_t
 
__af
);

551 
	`ºesvp‹t
 (*
__Æp‹t
);

560 
	`ºesvp‹t_af
 (*
__Æp‹t
, 
ß_Ámûy_t
 
__af
);

565 #ifdef 
__USE_POSIX


567 
	saddröfo


569 
ai_Êags
;

570 
ai_Ámûy
;

571 
ai_sockty≥
;

572 
ai_¥Ÿocﬁ
;

573 
sockÀn_t
 
ai_addæí
;

574 
sockaddr
 *
ai_addr
;

575 *
ai_ˇn⁄«me
;

576 
addröfo
 *
ai_√xt
;

579 #ifde‡
__USE_GNU


581 
	sgaicb


583 c⁄° *
¨_«me
;

584 c⁄° *
¨_£rvi˚
;

585 c⁄° 
addröfo
 *
¨_ªque°
;

586 
addröfo
 *
¨_ªsu…
;

588 
__ªtu∫
;

589 
__glibc_ª£rved
[5];

593 
	#GAI_WAIT
 0

	)

594 
	#GAI_NOWAIT
 1

	)

598 
	#AI_PASSIVE
 0x0001

	)

599 
	#AI_CANONNAME
 0x0002

	)

600 
	#AI_NUMERICHOST
 0x0004

	)

601 
	#AI_V4MAPPED
 0x0008

	)

602 
	#AI_ALL
 0x0010

	)

603 
	#AI_ADDRCONFIG
 0x0020

	)

605 #ifde‡
__USE_GNU


606 
	#AI_IDN
 0x0040

	)

609 
	#AI_CANONIDN
 0x0080

	)

610 
	#AI_IDN_ALLOW_UNASSIGNED
 0x0100

	)

612 
	#AI_IDN_USE_STD3_ASCII_RULES
 0x0200

	)

615 
	#AI_NUMERICSERV
 0x0400

	)

618 
	#EAI_BADFLAGS
 -1

	)

619 
	#EAI_NONAME
 -2

	)

620 
	#EAI_AGAIN
 -3

	)

621 
	#EAI_FAIL
 -4

	)

622 
	#EAI_FAMILY
 -6

	)

623 
	#EAI_SOCKTYPE
 -7

	)

624 
	#EAI_SERVICE
 -8

	)

625 
	#EAI_MEMORY
 -10

	)

626 
	#EAI_SYSTEM
 -11

	)

627 
	#EAI_OVERFLOW
 -12

	)

628 #ifde‡
__USE_GNU


629 
	#EAI_NODATA
 -5

	)

630 
	#EAI_ADDRFAMILY
 -9

	)

631 
	#EAI_INPROGRESS
 -100

	)

632 
	#EAI_CANCELED
 -101

	)

633 
	#EAI_NOTCANCELED
 -102

	)

634 
	#EAI_ALLDONE
 -103

	)

635 
	#EAI_INTR
 -104

	)

636 
	#EAI_IDN_ENCODE
 -105

	)

639 #ifde‡
__USE_MISC


640 
	#NI_MAXHOST
 1025

	)

641 
	#NI_MAXSERV
 32

	)

644 
	#NI_NUMERICHOST
 1

	)

645 
	#NI_NUMERICSERV
 2

	)

646 
	#NI_NOFQDN
 4

	)

647 
	#NI_NAMEREQD
 8

	)

648 
	#NI_DGRAM
 16

	)

649 #ifde‡
__USE_GNU


650 
	#NI_IDN
 32

	)

651 
	#NI_IDN_ALLOW_UNASSIGNED
 64

	)

653 
	#NI_IDN_USE_STD3_ASCII_RULES
 128

	)

662 
	`gëaddröfo
 (c⁄° *
__ª°ri˘
 
__«me
,

663 c⁄° *
__ª°ri˘
 
__£rvi˚
,

664 c⁄° 
addröfo
 *
__ª°ri˘
 
__ªq
,

665 
addröfo
 **
__ª°ri˘
 
__∑i
);

668 
	$‰ìaddröfo
 (
addröfo
 *
__ai
Ë
__THROW
;

671 c⁄° *
	$gai_°ªº‹
 (
__ecode
Ë
__THROW
;

677 
	`gë«meöfo
 (c⁄° 
sockaddr
 *
__ª°ri˘
 
__ß
,

678 
sockÀn_t
 
__ßÀn
, *
__ª°ri˘
 
__ho°
,

679 
sockÀn_t
 
__ho°Àn
, *
__ª°ri˘
 
__£rv
,

680 
sockÀn_t
 
__£rvÀn
, 
__Êags
);

683 #ifde‡
__USE_GNU


692 
	`gëaddröfo_a
 (
__mode
, 
gaicb
 *
__li°
[
__ª°ri˘_¨r
],

693 
__ít
, 
sigevít
 *
__ª°ri˘
 
__sig
);

703 
	`gai_su•íd
 (c⁄° 
gaicb
 *c⁄° 
__li°
[], 
__ít
,

704 c⁄° 
time•ec
 *
__timeout
);

707 
	$gai_îr‹
 (
gaicb
 *
__ªq
Ë
__THROW
;

710 
	$gai_ˇn˚l
 (
gaicb
 *
__gaicbp
Ë
__THROW
;

713 
__END_DECLS


	@/usr/include/netinet/in.h

18 #i‚def 
_NETINET_IN_H


19 
	#_NETINET_IN_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<°döt.h
>

23 
	~<sys/sockë.h
>

24 
	~<bôs/ty≥s.h
>

27 
__BEGIN_DECLS


30 
uöt32_t
 
	tö_addr_t
;

31 
	sö_addr


33 
ö_addr_t
 
	ms_addr
;

37 
	~<bôs/ö.h
>

42 
	mIPPROTO_IP
 = 0,

43 
	#IPPROTO_IP
 
IPPROTO_IP


	)

44 
	mIPPROTO_ICMP
 = 1,

45 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

46 
	mIPPROTO_IGMP
 = 2,

47 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

48 
	mIPPROTO_IPIP
 = 4,

49 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

50 
	mIPPROTO_TCP
 = 6,

51 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

52 
	mIPPROTO_EGP
 = 8,

53 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

54 
	mIPPROTO_PUP
 = 12,

55 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

56 
	mIPPROTO_UDP
 = 17,

57 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

58 
	mIPPROTO_IDP
 = 22,

59 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

60 
	mIPPROTO_TP
 = 29,

61 
	#IPPROTO_TP
 
IPPROTO_TP


	)

62 
	mIPPROTO_DCCP
 = 33,

63 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

64 
	mIPPROTO_IPV6
 = 41,

65 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

66 
	mIPPROTO_RSVP
 = 46,

67 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

68 
	mIPPROTO_GRE
 = 47,

69 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

70 
	mIPPROTO_ESP
 = 50,

71 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

72 
	mIPPROTO_AH
 = 51,

73 
	#IPPROTO_AH
 
IPPROTO_AH


	)

74 
	mIPPROTO_MTP
 = 92,

75 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

76 
	mIPPROTO_BEETPH
 = 94,

77 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

78 
	mIPPROTO_ENCAP
 = 98,

79 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

80 
	mIPPROTO_PIM
 = 103,

81 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

82 
	mIPPROTO_COMP
 = 108,

83 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

84 
	mIPPROTO_SCTP
 = 132,

85 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

86 
	mIPPROTO_UDPLITE
 = 136,

87 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

88 
	mIPPROTO_RAW
 = 255,

89 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

90 
	mIPPROTO_MAX


96 #i‚de‡
__USE_KERNEL_IPV6_DEFS


99 
	mIPPROTO_HOPOPTS
 = 0,

100 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

101 
	mIPPROTO_ROUTING
 = 43,

102 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

103 
	mIPPROTO_FRAGMENT
 = 44,

104 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

105 
	mIPPROTO_ICMPV6
 = 58,

106 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

107 
	mIPPROTO_NONE
 = 59,

108 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

109 
	mIPPROTO_DSTOPTS
 = 60,

110 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

111 
	mIPPROTO_MH
 = 135

112 
	#IPPROTO_MH
 
IPPROTO_MH


	)

117 
uöt16_t
 
	tö_p‹t_t
;

122 
	mIPPORT_ECHO
 = 7,

123 
	mIPPORT_DISCARD
 = 9,

124 
	mIPPORT_SYSTAT
 = 11,

125 
	mIPPORT_DAYTIME
 = 13,

126 
	mIPPORT_NETSTAT
 = 15,

127 
	mIPPORT_FTP
 = 21,

128 
	mIPPORT_TELNET
 = 23,

129 
	mIPPORT_SMTP
 = 25,

130 
	mIPPORT_TIMESERVER
 = 37,

131 
	mIPPORT_NAMESERVER
 = 42,

132 
	mIPPORT_WHOIS
 = 43,

133 
	mIPPORT_MTP
 = 57,

135 
	mIPPORT_TFTP
 = 69,

136 
	mIPPORT_RJE
 = 77,

137 
	mIPPORT_FINGER
 = 79,

138 
	mIPPORT_TTYLINK
 = 87,

139 
	mIPPORT_SUPDUP
 = 95,

142 
	mIPPORT_EXECSERVER
 = 512,

143 
	mIPPORT_LOGINSERVER
 = 513,

144 
	mIPPORT_CMDSERVER
 = 514,

145 
	mIPPORT_EFSSERVER
 = 520,

148 
	mIPPORT_BIFFUDP
 = 512,

149 
	mIPPORT_WHOSERVER
 = 513,

150 
	mIPPORT_ROUTESERVER
 = 520,

153 
	mIPPORT_RESERVED
 = 1024,

156 
	mIPPORT_USERRESERVED
 = 5000

164 
	#IN_CLASSA
(
a
Ë((((
ö_addr_t
)◊)Ë& 0x80000000Ë=0)

	)

165 
	#IN_CLASSA_NET
 0xff000000

	)

166 
	#IN_CLASSA_NSHIFT
 24

	)

167 
	#IN_CLASSA_HOST
 (0xfffffff‡& ~
IN_CLASSA_NET
)

	)

168 
	#IN_CLASSA_MAX
 128

	)

170 
	#IN_CLASSB
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xc0000000Ë=0x80000000)

	)

171 
	#IN_CLASSB_NET
 0xffff0000

	)

172 
	#IN_CLASSB_NSHIFT
 16

	)

173 
	#IN_CLASSB_HOST
 (0xfffffff‡& ~
IN_CLASSB_NET
)

	)

174 
	#IN_CLASSB_MAX
 65536

	)

176 
	#IN_CLASSC
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xe0000000Ë=0xc0000000)

	)

177 
	#IN_CLASSC_NET
 0xffffff00

	)

178 
	#IN_CLASSC_NSHIFT
 8

	)

179 
	#IN_CLASSC_HOST
 (0xfffffff‡& ~
IN_CLASSC_NET
)

	)

181 
	#IN_CLASSD
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xf0000000Ë=0xe0000000)

	)

182 
	#IN_MULTICAST
(
a
Ë
	`IN_CLASSD
◊)

	)

184 
	#IN_EXPERIMENTAL
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xe0000000Ë=0xe0000000)

	)

185 
	#IN_BADCLASS
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xf0000000Ë=0xf0000000)

	)

188 
	#INADDR_ANY
 ((
ö_addr_t
Ë0x00000000)

	)

190 
	#INADDR_BROADCAST
 ((
ö_addr_t
Ë0xffffffff)

	)

192 
	#INADDR_NONE
 ((
ö_addr_t
Ë0xffffffff)

	)

195 
	#IN_LOOPBACKNET
 127

	)

197 #i‚de‡
INADDR_LOOPBACK


198 
	#INADDR_LOOPBACK
 ((
ö_addr_t
Ë0x7f000001Ë

	)

202 
	#INADDR_UNSPEC_GROUP
 ((
ö_addr_t
Ë0xe0000000Ë

	)

203 
	#INADDR_ALLHOSTS_GROUP
 ((
ö_addr_t
Ë0xe0000001Ë

	)

204 
	#INADDR_ALLRTRS_GROUP
 ((
ö_addr_t
Ë0xe0000002Ë

	)

205 
	#INADDR_MAX_LOCAL_GROUP
 ((
ö_addr_t
Ë0xe00000ffË

	)

207 #i‚de‡
__USE_KERNEL_IPV6_DEFS


209 
	sö6_addr


213 
uöt8_t
 
	m__u6_addr8
[16];

214 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


215 
uöt16_t
 
	m__u6_addr16
[8];

216 
uöt32_t
 
	m__u6_addr32
[4];

218 } 
	m__ö6_u
;

219 
	#s6_addr
 
__ö6_u
.
__u6_addr8


	)

220 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


221 
	#s6_addr16
 
__ö6_u
.
__u6_addr16


	)

222 
	#s6_addr32
 
__ö6_u
.
__u6_addr32


	)

227 c⁄° 
ö6_addr
 
ö6addr_™y
;

228 c⁄° 
ö6_addr
 
ö6addr_lo›back
;

229 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

230 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

232 
	#INET_ADDRSTRLEN
 16

	)

233 
	#INET6_ADDRSTRLEN
 46

	)

237 
	ssockaddr_ö


239 
__SOCKADDR_COMMON
 (
sö_
);

240 
ö_p‹t_t
 
	msö_p‹t
;

241 
ö_addr
 
	msö_addr
;

244 
	msö_zîo
[ (
sockaddr
) -

245 
__SOCKADDR_COMMON_SIZE
 -

246  (
ö_p‹t_t
) -

247  (
ö_addr
)];

250 #i‚de‡
__USE_KERNEL_IPV6_DEFS


252 
	ssockaddr_ö6


254 
__SOCKADDR_COMMON
 (
sö6_
);

255 
ö_p‹t_t
 
	msö6_p‹t
;

256 
uöt32_t
 
	msö6_Êowöfo
;

257 
ö6_addr
 
	msö6_addr
;

258 
uöt32_t
 
	msö6_sc›e_id
;

262 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


264 
	sù_mªq


267 
ö_addr
 
	mimr_mu…üddr
;

270 
ö_addr
 
	mimr_öãrÁ˚
;

273 
	sù_mªq_sour˚


276 
ö_addr
 
	mimr_mu…üddr
;

279 
ö_addr
 
	mimr_öãrÁ˚
;

282 
ö_addr
 
	mimr_sour˚addr
;

286 #i‚de‡
__USE_KERNEL_IPV6_DEFS


288 
	sùv6_mªq


291 
ö6_addr
 
	mùv6mr_mu…üddr
;

294 
	mùv6mr_öãrÁ˚
;

298 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


300 
	sgroup_ªq


303 
uöt32_t
 
	mgr_öãrÁ˚
;

306 
sockaddr_°‹age
 
	mgr_group
;

309 
	sgroup_sour˚_ªq


312 
uöt32_t
 
	mg§_öãrÁ˚
;

315 
sockaddr_°‹age
 
	mg§_group
;

318 
sockaddr_°‹age
 
	mg§_sour˚
;

323 
	sù_msfûãr


326 
ö_addr
 
	mimsf_mu…üddr
;

329 
ö_addr
 
	mimsf_öãrÁ˚
;

332 
uöt32_t
 
	mimsf_fmode
;

335 
uöt32_t
 
	mimsf_num§c
;

337 
ö_addr
 
	mimsf_¶i°
[1];

340 
	#IP_MSFILTER_SIZE
(
num§c
Ë( (
ù_msfûãr
) \

341 -  (
ö_addr
) \

342 + (
num§c
Ë*  (
ö_addr
))

	)

344 
	sgroup_fûãr


347 
uöt32_t
 
	mgf_öãrÁ˚
;

350 
sockaddr_°‹age
 
	mgf_group
;

353 
uöt32_t
 
	mgf_fmode
;

356 
uöt32_t
 
	mgf_num§c
;

358 
sockaddr_°‹age
 
	mgf_¶i°
[1];

361 
	#GROUP_FILTER_SIZE
(
num§c
Ë( (
group_fûãr
) \

362 -  (
sockaddr_°‹age
) \

363 + ((
num§c
) \

364 *  (
sockaddr_°‹age
)))

	)

374 
uöt32_t
 
	$¡ohl
 (
uöt32_t
 
__√é⁄g
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

375 
uöt16_t
 
	$¡ohs
 (
uöt16_t
 
__√tsh‹t
)

376 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

377 
uöt32_t
 
	$ht⁄l
 (
uöt32_t
 
__ho°l⁄g
)

378 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

379 
uöt16_t
 
	$ht⁄s
 (
uöt16_t
 
__ho°sh‹t
)

380 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

382 
	~<ídün.h
>

385 
	~<bôs/byãsw≠.h
>

387 #ifde‡
__OPTIMIZE__


391 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


394 
	#¡ohl
(
x
Ë(x)

	)

395 
	#¡ohs
(
x
Ë(x)

	)

396 
	#ht⁄l
(
x
Ë(x)

	)

397 
	#ht⁄s
(
x
Ë(x)

	)

399 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


400 
	#¡ohl
(
x
Ë
	`__bsw≠_32
 (x)

	)

401 
	#¡ohs
(
x
Ë
	`__bsw≠_16
 (x)

	)

402 
	#ht⁄l
(
x
Ë
	`__bsw≠_32
 (x)

	)

403 
	#ht⁄s
(
x
Ë
	`__bsw≠_16
 (x)

	)

408 #ifde‡
__GNUC__


409 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

410 (
__exãnsi⁄__
 \

411 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

412 
__a
->
s6_addr32
[0] == 0 \

413 && 
__a
->
s6_addr32
[1] == 0 \

414 && 
__a
->
s6_addr32
[2] == 0 \

415 && 
__a
->
s6_addr32
[3] =0; 
	}
}))

	)

417 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

418 (
__exãnsi⁄__
 \

419 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

420 
__a
->
s6_addr32
[0] == 0 \

421 && 
__a
->
s6_addr32
[1] == 0 \

422 && 
__a
->
s6_addr32
[2] == 0 \

423 && 
__a
->
s6_addr32
[3] =
	`ht⁄l
 (1); }))

	)

425 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

426 (
__exãnsi⁄__
 \

427 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

428 (
__a
->
s6_addr32
[0] & 
	`ht⁄l
 (0xffc00000)Ë=ht⁄»(0x„800000); }))

	)

430 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

431 (
__exãnsi⁄__
 \

432 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

433 (
__a
->
s6_addr32
[0] & 
	`ht⁄l
 (0xffc00000)Ë=ht⁄»(0x„c00000); }))

	)

435 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

436 (
__exãnsi⁄__
 \

437 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

438 
__a
->
s6_addr32
[0] == 0 \

439 && 
__a
->
s6_addr32
[1] == 0 \

440 && 
__a
->
s6_addr32
[2] =
	`ht⁄l
 (0xffff); }))

	)

442 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

443 (
__exãnsi⁄__
 \

444 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

445 
__a
->
s6_addr32
[0] == 0 \

446 && 
__a
->
s6_addr32
[1] == 0 \

447 && 
__a
->
s6_addr32
[2] == 0 \

448 && 
	`¡ohl
 (
__a
->
s6_addr32
[3]Ë> 1; }))

	)

450 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

451 (
__exãnsi⁄__
 \

452 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

453 c⁄° 
ö6_addr
 *
__b
 = (c⁄° ö6_add∏*Ë(
b
); \

454 
__a
->
s6_addr32
[0] =
__b
->s6_addr32[0] \

455 && 
__a
->
s6_addr32
[1] =
__b
->s6_addr32[1] \

456 && 
__a
->
s6_addr32
[2] =
__b
->s6_addr32[2] \

457 && 
__a
->
s6_addr32
[3] =
__b
->s6_addr32[3]; }))

	)

459 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

460 (((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0 \

461 && ((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0 \

462 && ((c⁄° 
uöt32_t
 *Ë(
a
))[2] == 0 \

463 && ((c⁄° 
uöt32_t
 *Ë(
a
))[3] =0)

	)

465 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

466 (((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0 \

467 && ((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0 \

468 && ((c⁄° 
uöt32_t
 *Ë(
a
))[2] == 0 \

469 && ((c⁄° 
uöt32_t
 *Ë(
a
))[3] =
	`ht⁄l
 (1))

	)

471 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

472 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] & 
	`ht⁄l
 (0xffc00000)) \

473 =
	`ht⁄l
 (0x„800000))

	)

475 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

476 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] & 
	`ht⁄l
 (0xffc00000)) \

477 =
	`ht⁄l
 (0x„c00000))

	)

479 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

480 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0) \

481 && (((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0) \

482 && (((c⁄° 
uöt32_t
 *Ë(
a
))[2] =
	`ht⁄l
 (0xffff)))

	)

484 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

485 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0) \

486 && (((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0) \

487 && (((c⁄° 
uöt32_t
 *Ë(
a
))[2] == 0) \

488 && (
	`¡ohl
 (((c⁄° 
uöt32_t
 *Ë(
a
))[3]Ë> 1))

	)

490 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

491 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] =((c⁄° uöt32_à*Ë(
b
))[0]) \

492 && (((c⁄° 
uöt32_t
 *Ë(
a
))[1] =((c⁄° uöt32_à*Ë(
b
))[1]) \

493 && (((c⁄° 
uöt32_t
 *Ë(
a
))[2] =((c⁄° uöt32_à*Ë(
b
))[2]) \

494 && (((c⁄° 
uöt32_t
 *Ë(
a
))[3] =((c⁄° uöt32_à*Ë(
b
))[3]))

	)

497 
	#IN6_IS_ADDR_MULTICAST
(
a
Ë(((c⁄° 
uöt8_t
 *Ë◊))[0] =0xff)

	)

499 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


501 
	$bödªsvp‹t
 (
__sockfd
, 
sockaddr_ö
 *
__sock_ö
Ë
__THROW
;

504 
	$bödªsvp‹t6
 (
__sockfd
, 
sockaddr_ö6
 *
__sock_ö
)

505 
__THROW
;

509 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

510 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

511 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x1))

	)

513 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

514 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

515 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x2))

	)

517 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

518 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

519 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x5))

	)

521 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

522 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

523 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x8))

	)

525 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

526 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

527 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0xe))

	)

530 #ifde‡
__USE_GNU


531 
cmsghdr
;

534 
	sö6_pktöfo


536 
ö6_addr
 
ùi6_addr
;

537 
ùi6_ifödex
;

541 
	sù6_mtuöfo


543 
sockaddr_ö6
 
ù6m_addr
;

544 
uöt32_t
 
ù6m_mtu
;

549 
	$öë6_›ti⁄_•a˚
 (
__nbyãs
)

550 
__THROW
 
__©åibuã_dïªˇãd__
;

551 
	$öë6_›ti⁄_öô
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

552 
__ty≥
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

553 
	$öë6_›ti⁄_≠≥nd
 (
cmsghdr
 *
__cmsg
,

554 c⁄° 
uöt8_t
 *
__ty≥p
, 
__mu…x
,

555 
__∂usy
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

556 
uöt8_t
 *
	$öë6_›ti⁄_Æloc
 (
cmsghdr
 *
__cmsg
, 
__d©Æí
,

557 
__mu…x
, 
__∂usy
)

558 
__THROW
 
__©åibuã_dïªˇãd__
;

559 
	$öë6_›ti⁄_√xt
 (c⁄° 
cmsghdr
 *
__cmsg
,

560 
uöt8_t
 **
__çåp
)

561 
__THROW
 
__©åibuã_dïªˇãd__
;

562 
	$öë6_›ti⁄_föd
 (c⁄° 
cmsghdr
 *
__cmsg
,

563 
uöt8_t
 **
__çåp
, 
__ty≥
)

564 
__THROW
 
__©åibuã_dïªˇãd__
;

568 
	$öë6_›t_öô
 (*
__extbuf
, 
sockÀn_t
 
__exéí
Ë
__THROW
;

569 
	$öë6_›t_≠≥nd
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

570 
uöt8_t
 
__ty≥
, 
sockÀn_t
 
__Àn
, uöt8_à
__Æign
,

571 **
__d©abuÂ
Ë
__THROW
;

572 
	$öë6_›t_föish
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
)

573 
__THROW
;

574 
	$öë6_›t_£t_vÆ
 (*
__d©abuf
, 
__off£t
, *
__vÆ
,

575 
sockÀn_t
 
__vÆÀn
Ë
__THROW
;

576 
	$öë6_›t_√xt
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

577 
uöt8_t
 *
__ty≥p
, 
sockÀn_t
 *
__À≈
,

578 **
__d©abuÂ
Ë
__THROW
;

579 
	$öë6_›t_föd
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

580 
uöt8_t
 
__ty≥
, 
sockÀn_t
 *
__À≈
,

581 **
__d©abuÂ
Ë
__THROW
;

582 
	$öë6_›t_gë_vÆ
 (*
__d©abuf
, 
__off£t
, *
__vÆ
,

583 
sockÀn_t
 
__vÆÀn
Ë
__THROW
;

587 
sockÀn_t
 
	$öë6_πh_•a˚
 (
__ty≥
, 
__£gmíts
Ë
__THROW
;

588 *
	$öë6_πh_öô
 (*
__bp
, 
sockÀn_t
 
__bp_Àn
, 
__ty≥
,

589 
__£gmíts
Ë
__THROW
;

590 
	$öë6_πh_add
 (*
__bp
, c⁄° 
ö6_addr
 *
__addr
Ë
__THROW
;

591 
	$öë6_πh_ªvî£
 (c⁄° *
__ö
, *
__out
Ë
__THROW
;

592 
	$öë6_πh_£gmíts
 (c⁄° *
__bp
Ë
__THROW
;

593 
ö6_addr
 *
	$öë6_πh_gëaddr
 (c⁄° *
__bp
, 
__ödex
)

594 
__THROW
;

600 
	$gëùv4sour˚fûãr
 (
__s
, 
ö_addr
 
__öãrÁ˚_addr
,

601 
ö_addr
 
__group
, 
uöt32_t
 *
__fmode
,

602 
uöt32_t
 *
__num§c
, 
ö_addr
 *
__¶i°
)

603 
__THROW
;

606 
	$£tùv4sour˚fûãr
 (
__s
, 
ö_addr
 
__öãrÁ˚_addr
,

607 
ö_addr
 
__group
, 
uöt32_t
 
__fmode
,

608 
uöt32_t
 
__num§c
,

609 c⁄° 
ö_addr
 *
__¶i°
)

610 
__THROW
;

614 
	$gësour˚fûãr
 (
__s
, 
uöt32_t
 
__öãrÁ˚_addr
,

615 c⁄° 
sockaddr
 *
__group
,

616 
sockÀn_t
 
__grou∂í
, 
uöt32_t
 *
__fmode
,

617 
uöt32_t
 *
__num§c
,

618 
sockaddr_°‹age
 *
__¶i°
Ë
__THROW
;

621 
	$£tsour˚fûãr
 (
__s
, 
uöt32_t
 
__öãrÁ˚_addr
,

622 c⁄° 
sockaddr
 *
__group
,

623 
sockÀn_t
 
__grou∂í
, 
uöt32_t
 
__fmode
,

624 
uöt32_t
 
__num§c
,

625 c⁄° 
sockaddr_°‹age
 *
__¶i°
Ë
__THROW
;

628 
__END_DECLS


	@/usr/include/setjmp.h

22 #i‚def 
_SETJMP_H


23 
	#_SETJMP_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


29 
	~<bôs/£tjmp.h
>

30 
	~<bôs/sig£t.h
>

34 
	s__jmp_buf_èg


40 
__jmp_buf
 
	m__jmpbuf
;

41 
	m__mask_was_ßved
;

42 
__sig£t_t
 
	m__ßved_mask
;

46 
__BEGIN_NAMESPACE_STD


48 
__jmp_buf_èg
 
	tjmp_buf
[1];

52 
	$£tjmp
 (
jmp_buf
 
__ív
Ë
__THROWNL
;

54 
__END_NAMESPACE_STD


59 
	$__sig£tjmp
 (
__jmp_buf_èg
 
__ív
[1], 
__ßvemask
Ë
__THROWNL
;

63 
	$_£tjmp
 (
__jmp_buf_èg
 
__ív
[1]Ë
__THROWNL
;

67 
	#£tjmp
(
ív
Ë
	`_£tjmp
 (ív)

	)

70 
__BEGIN_NAMESPACE_STD


74 
	$l⁄gjmp
 (
__jmp_buf_èg
 
__ív
[1], 
__vÆ
)

75 
__THROWNL
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

77 
__END_NAMESPACE_STD


79 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


83 
	$_l⁄gjmp
 (
__jmp_buf_èg
 
__ív
[1], 
__vÆ
)

84 
__THROWNL
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

88 #ifdef 
__USE_POSIX


92 
__jmp_buf_èg
 
	tsigjmp_buf
[1];

96 
	#sig£tjmp
(
ív
, 
ßvemask
Ë
	`__sig£tjmp
 (ív, savemask)

	)

102 
	$sigl⁄gjmp
 (
sigjmp_buf
 
__ív
, 
__vÆ
)

103 
__THROWNL
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

108 #i‡
__USE_FORTIFY_LEVEL
 > 0

109 
	~<bôs/£tjmp2.h
>

112 
__END_DECLS


	@/usr/include/signal.h

22 #i‚def 
_SIGNAL_H


24 #i‡!
deföed
 
__√ed_sig_©omic_t
 && !deföed 
__√ed_sig£t_t


25 
	#_SIGNAL_H


	)

28 
	~<„©uªs.h
>

30 
	g__BEGIN_DECLS


32 
	~<bôs/sig£t.h
>

36 #i‡
deföed
 
__√ed_sig_©omic_t
 || deföed 
_SIGNAL_H


37 #i‚de‡
__sig_©omic_t_deföed


38 
	#__sig_©omic_t_deföed


	)

39 
__BEGIN_NAMESPACE_STD


40 
__sig_©omic_t
 
	tsig_©omic_t
;

41 
	g__END_NAMESPACE_STD


43 #unde‡
__√ed_sig_©omic_t


46 #i‡
deföed
 
__√ed_sig£t_t
 || (deföed 
_SIGNAL_H
 && deföed 
__USE_POSIX
)

47 #i‚de‡
__sig£t_t_deföed


48 
	#__sig£t_t_deföed


	)

49 
__sig£t_t
 
	tsig£t_t
;

51 #unde‡
__√ed_sig£t_t


54 #ifde‡
_SIGNAL_H


56 
	~<bôs/ty≥s.h
>

57 
	~<bôs/signum.h
>

59 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


60 #i‚de‡
__pid_t_deföed


61 
__pid_t
 
	tpid_t
;

62 
	#__pid_t_deföed


	)

64 #ifde‡
__USE_XOPEN


66 #i‚de‡
__uid_t_deföed


67 
__uid_t
 
	tuid_t
;

68 
	#__uid_t_deföed


	)

72 #ifde‡
__USE_POSIX199309


74 
	#__√ed_time•ec


	)

75 
	~<time.h
>

78 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_XOPEN_EXTENDED


80 
	~<bôs/sigöfo.h
>

85 (*
	t__sigh™dÀr_t
) ();

90 
__sigh™dÀr_t
 
	$__sysv_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

91 
__THROW
;

92 #ifde‡
__USE_GNU


93 
__sigh™dÀr_t
 
	$sysv_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

94 
__THROW
;

100 
__BEGIN_NAMESPACE_STD


101 #ifde‡
__USE_BSD


102 
__sigh™dÀr_t
 
	$sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

103 
__THROW
;

106 #ifde‡
__REDIRECT_NTH


107 
__sigh™dÀr_t
 
	`__REDIRECT_NTH
 (
sig«l
,

108 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
),

109 
__sysv_sig«l
);

111 
	#sig«l
 
__sysv_sig«l


	)

114 
__END_NAMESPACE_STD


116 #ifde‡
__USE_XOPEN


119 
__sigh™dÀr_t
 
	$bsd_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

120 
__THROW
;

126 #ifde‡
__USE_POSIX


127 
	$kûl
 (
__pid_t
 
__pid
, 
__sig
Ë
__THROW
;

130 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


134 
	$kûÕg
 (
__pid_t
 
__pgΩ
, 
__sig
Ë
__THROW
;

137 
__BEGIN_NAMESPACE_STD


139 
	$øi£
 (
__sig
Ë
__THROW
;

140 
__END_NAMESPACE_STD


142 #ifde‡
__USE_SVID


144 
__sigh™dÀr_t
 
	$ssig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

145 
__THROW
;

146 
	$gsig«l
 (
__sig
Ë
__THROW
;

149 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN2K


151 
	`psig«l
 (
__sig
, c⁄° *
__s
);

154 #ifde‡
__USE_XOPEN2K


156 
	`psigöfo
 (c⁄° 
sigöfo_t
 *
__pöfo
, c⁄° *
__s
);

167 
	`__sig∑u£
 (
__sig_‹_mask
, 
__is_sig
);

169 #ifde‡
__USE_XOPEN


170 #ifde‡
__GNUC__


171 
	$sig∑u£
 (
__sig
Ë
	`__asm__
 ("__xpg_sigpause");

174 
	#sig∑u£
(
sig
Ë
	`__sig∑u£
 ((sig), 1)

	)

179 #ifde‡
__USE_BSD


186 
	#sigmask
(
sig
Ë
	`__sigmask
(sig)

	)

189 
	$sigblock
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

192 
	$sig£tmask
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

195 
	$siggëmask
 (Ë
__THROW
 
__©åibuã_dïªˇãd__
;

199 #ifde‡
__USE_MISC


200 
	#NSIG
 
_NSIG


	)

203 #ifde‡
__USE_GNU


204 
__sigh™dÀr_t
 
	tsigh™dÀr_t
;

208 #ifde‡
__USE_BSD


209 
__sigh™dÀr_t
 
	tsig_t
;

212 #ifde‡
__USE_POSIX


215 
	$sigem±y£t
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

218 
	$sigfûl£t
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

221 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

224 
	$sigdñ£t
 (
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

227 
	$sigismembî
 (c⁄° 
sig£t_t
 *
__£t
, 
__signo
)

228 
__THROW
 
	`__n⁄nuŒ
 ((1));

230 #ifde‡
__USE_GNU


232 
	$sigi£m±y£t
 (c⁄° 
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

235 
	$sig™d£t
 (
sig£t_t
 *
__£t
, c⁄° sig£t_à*
__À·
,

236 c⁄° 
sig£t_t
 *
__right
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

239 
	$sig‹£t
 (
sig£t_t
 *
__£t
, c⁄° sig£t_à*
__À·
,

240 c⁄° 
sig£t_t
 *
__right
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

245 
	~<bôs/siga˘i⁄.h
>

248 
	$sig¥ocmask
 (
__how
, c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
,

249 
sig£t_t
 *
__ª°ri˘
 
__o£t
Ë
__THROW
;

256 
	$sigsu•íd
 (c⁄° 
sig£t_t
 *
__£t
Ë
	`__n⁄nuŒ
 ((1));

259 
	$siga˘i⁄
 (
__sig
, c⁄° 
siga˘i⁄
 *
__ª°ri˘
 
__a˘
,

260 
siga˘i⁄
 *
__ª°ri˘
 
__ﬂ˘
Ë
__THROW
;

263 
	$sig≥ndög
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

270 
	$sigwaô
 (c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
, *__ª°ri˘ 
__sig
)

271 
	`__n⁄nuŒ
 ((1, 2));

273 #ifde‡
__USE_POSIX199309


278 
	$sigwaôöfo
 (c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
,

279 
sigöfo_t
 *
__ª°ri˘
 
__öfo
Ë
	`__n⁄nuŒ
 ((1));

286 
	$sigtimedwaô
 (c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
,

287 
sigöfo_t
 *
__ª°ri˘
 
__öfo
,

288 c⁄° 
time•ec
 *
__ª°ri˘
 
__timeout
)

289 
	`__n⁄nuŒ
 ((1));

293 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, c⁄° 
sigvÆ
 
__vÆ
)

294 
__THROW
;

299 #ifde‡
__USE_BSD


303 c⁄° *c⁄° 
_sys_sigli°
[
_NSIG
];

304 c⁄° *c⁄° 
sys_sigli°
[
_NSIG
];

307 
	ssigvec


309 
__sigh™dÀr_t
 
sv_h™dÀr
;

310 
sv_mask
;

312 
sv_Êags
;

313 
	#sv_⁄°ack
 
sv_Êags


	)

317 
	#SV_ONSTACK
 (1 << 0)

	)

318 
	#SV_INTERRUPT
 (1 << 1)

	)

319 
	#SV_RESETHAND
 (1 << 2)

	)

327 
	$sigvec
 (
__sig
, c⁄° 
sigvec
 *
__vec
,

328 
sigvec
 *
__ovec
Ë
__THROW
;

332 
	~<bôs/sigc⁄ãxt.h
>

335 
	$sigªtu∫
 (
sigc⁄ãxt
 *
__s˝
Ë
__THROW
;

340 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


341 
	#__√ed_size_t


	)

342 
	~<°ddef.h
>

347 
	$sigöãºu±
 (
__sig
, 
__öãºu±
Ë
__THROW
;

349 
	~<bôs/sig°ack.h
>

350 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


352 
	~<sys/uc⁄ãxt.h
>

358 
	$sig°ack
 (
sig°ack
 *
__ss
, sig°ack *
__oss
)

359 
__THROW
 
__©åibuã_dïªˇãd__
;

363 
	$sigÆt°ack
 (c⁄° 
sigÆt°ack
 *
__ª°ri˘
 
__ss
,

364 
sigÆt°ack
 *
__ª°ri˘
 
__oss
Ë
__THROW
;

368 #ifde‡
__USE_XOPEN_EXTENDED


372 
	$sighﬁd
 (
__sig
Ë
__THROW
;

375 
	$sigªl£
 (
__sig
Ë
__THROW
;

378 
	$sigign‹e
 (
__sig
Ë
__THROW
;

381 
__sigh™dÀr_t
 
	$sig£t
 (
__sig
, 
__sigh™dÀr_t
 
__di•
Ë
__THROW
;

384 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


387 
	~<bôs/±hªadty≥s.h
>

388 
	~<bôs/sigthªad.h
>

395 
	$__libc_cuºít_sigπmö
 (Ë
__THROW
;

397 
	$__libc_cuºít_sigπmax
 (Ë
__THROW
;

401 
__END_DECLS


	@/usr/include/stdio.h

23 #i‚de‡
_STDIO_H


25 #i‡!
deföed
 
__√ed_FILE
 && !deföed 
__√ed___FILE


26 
	#_STDIO_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


31 
	#__√ed_size_t


	)

32 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

35 
	~<bôs/ty≥s.h
>

36 
	#__√ed_FILE


	)

37 
	#__√ed___FILE


	)

41 #i‡!
deföed
 
__FILE_deföed
 && deföed 
__√ed_FILE


44 
	g_IO_FILE
;

46 
__BEGIN_NAMESPACE_STD


48 
_IO_FILE
 
	tFILE
;

49 
	g__END_NAMESPACE_STD


50 #i‡
deföed
 
__USE_LARGEFILE64
 || deföed 
__USE_SVID
 || deföed 
__USE_POSIX
 \

51 || 
deföed
 
	g__USE_BSD
 || deföed 
	g__USE_ISOC99
 || deföed 
	g__USE_XOPEN
 \

52 || 
deföed
 
__USE_POSIX2


53 
	$__USING_NAMESPACE_STD
(
FILE
)

56 
	#__FILE_deföed
 1

	)

58 #unde‡
__√ed_FILE


61 #i‡!
deföed
 
____FILE_deföed
 && deföed 
__√ed___FILE


64 
_IO_FILE
 
	t__FILE
;

66 
	#____FILE_deföed
 1

	)

68 #unde‡
__√ed___FILE


71 #ifdef 
_STDIO_H


72 
	#_STDIO_USES_IOSTREAM


	)

74 
	~<libio.h
>

76 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


77 #ifde‡
__GNUC__


78 #i‚de‡
_VA_LIST_DEFINED


79 
_G_va_li°
 
	tva_li°
;

80 
	#_VA_LIST_DEFINED


	)

83 
	~<°d¨g.h
>

87 #ifde‡
__USE_XOPEN2K8


88 #i‚de‡
__off_t_deföed


89 #i‚de‡
__USE_FILE_OFFSET64


90 
__off_t
 
	toff_t
;

92 
__off64_t
 
	toff_t
;

94 
	#__off_t_deföed


	)

96 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


97 
__off64_t
 
	toff64_t
;

98 
	#__off64_t_deföed


	)

101 #i‚de‡
__ssize_t_deföed


102 
__ssize_t
 
	tssize_t
;

103 
	#__ssize_t_deföed


	)

108 
__BEGIN_NAMESPACE_STD


109 #i‚de‡
__USE_FILE_OFFSET64


110 
_G_Âos_t
 
	tÂos_t
;

112 
_G_Âos64_t
 
	tÂos_t
;

114 
__END_NAMESPACE_STD


115 #ifde‡
__USE_LARGEFILE64


116 
_G_Âos64_t
 
	tÂos64_t
;

120 
	#_IOFBF
 0

	)

121 
	#_IOLBF
 1

	)

122 
	#_IONBF
 2

	)

126 #i‚de‡
BUFSIZ


127 
	#BUFSIZ
 
_IO_BUFSIZ


	)

133 #i‚de‡
EOF


134 
	#EOF
 (-1)

	)

140 
	#SEEK_SET
 0

	)

141 
	#SEEK_CUR
 1

	)

142 
	#SEEK_END
 2

	)

143 #ifde‡
__USE_GNU


144 
	#SEEK_DATA
 3

	)

145 
	#SEEK_HOLE
 4

	)

149 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


151 
	#P_tmpdú
 "/tmp"

	)

164 
	~<bôs/°dio_lim.h
>

168 
_IO_FILE
 *
°dö
;

169 
_IO_FILE
 *
°dout
;

170 
_IO_FILE
 *
°dîr
;

172 
	#°dö
 
°dö


	)

173 
	#°dout
 
°dout


	)

174 
	#°dîr
 
°dîr


	)

176 
__BEGIN_NAMESPACE_STD


178 
	$ªmove
 (c⁄° *
__fûíame
Ë
__THROW
;

180 
	$ª«me
 (c⁄° *
__ﬁd
, c⁄° *
__√w
Ë
__THROW
;

181 
__END_NAMESPACE_STD


183 #ifde‡
__USE_ATFILE


185 
	$ª«mót
 (
__ﬁdfd
, c⁄° *
__ﬁd
, 
__√wfd
,

186 c⁄° *
__√w
Ë
__THROW
;

189 
__BEGIN_NAMESPACE_STD


194 #i‚de‡
__USE_FILE_OFFSET64


195 
FILE
 *
	$tmpfûe
 (Ë
__wur
;

197 #ifde‡
__REDIRECT


198 
FILE
 *
	`__REDIRECT
 (
tmpfûe
, (), 
tmpfûe64
Ë
__wur
;

200 
	#tmpfûe
 
tmpfûe64


	)

204 #ifde‡
__USE_LARGEFILE64


205 
FILE
 *
	$tmpfûe64
 (Ë
__wur
;

209 *
	$tm≤am
 (*
__s
Ë
__THROW
 
__wur
;

210 
__END_NAMESPACE_STD


212 #ifde‡
__USE_MISC


215 *
	$tm≤am_r
 (*
__s
Ë
__THROW
 
__wur
;

219 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


227 *
	$ãm≤am
 (c⁄° *
__dú
, c⁄° *
__pfx
)

228 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

232 
__BEGIN_NAMESPACE_STD


237 
	`f˛o£
 (
FILE
 *
__°ªam
);

242 
	`fÊush
 (
FILE
 *
__°ªam
);

243 
__END_NAMESPACE_STD


245 #ifde‡
__USE_MISC


252 
	`fÊush_u∆ocked
 (
FILE
 *
__°ªam
);

255 #ifde‡
__USE_GNU


262 
	`f˛o£Æl
 ();

266 
__BEGIN_NAMESPACE_STD


267 #i‚de‡
__USE_FILE_OFFSET64


272 
FILE
 *
	$f›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

273 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

278 
FILE
 *
	$‰e›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

279 c⁄° *
__ª°ri˘
 
__modes
,

280 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

282 #ifde‡
__REDIRECT


283 
FILE
 *
	`__REDIRECT
 (
f›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

284 c⁄° *
__ª°ri˘
 
__modes
), 
f›í64
)

285 
__wur
;

286 
FILE
 *
	`__REDIRECT
 (
‰e›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

287 c⁄° *
__ª°ri˘
 
__modes
,

288 
FILE
 *
__ª°ri˘
 
__°ªam
), 
‰e›í64
)

289 
__wur
;

291 
	#f›í
 
f›í64


	)

292 
	#‰e›í
 
‰e›í64


	)

295 
__END_NAMESPACE_STD


296 #ifde‡
__USE_LARGEFILE64


297 
FILE
 *
	$f›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

298 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

299 
FILE
 *
	$‰e›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

300 c⁄° *
__ª°ri˘
 
__modes
,

301 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

304 #ifdef 
__USE_POSIX


306 
FILE
 *
	$fd›í
 (
__fd
, c⁄° *
__modes
Ë
__THROW
 
__wur
;

309 #ifdef 
__USE_GNU


312 
FILE
 *
	$f›ícookõ
 (*
__ª°ri˘
 
__magic_cookõ
,

313 c⁄° *
__ª°ri˘
 
__modes
,

314 
_IO_cookõ_io_fun˘i⁄s_t
 
__io_funcs
Ë
__THROW
 
__wur
;

317 #ifde‡
__USE_XOPEN2K8


319 
FILE
 *
	$fmem›í
 (*
__s
, 
size_t
 
__Àn
, c⁄° *
__modes
)

320 
__THROW
 
__wur
;

325 
FILE
 *
	$›í_mem°ªam
 (**
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
 
__wur
;

329 
__BEGIN_NAMESPACE_STD


332 
	$£tbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
Ë
__THROW
;

336 
	$£tvbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

337 
__modes
, 
size_t
 
__n
Ë
__THROW
;

338 
__END_NAMESPACE_STD


340 #ifdef 
__USE_BSD


343 
	$£tbuf„r
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

344 
size_t
 
__size
Ë
__THROW
;

347 
	$£éöebuf
 (
FILE
 *
__°ªam
Ë
__THROW
;

351 
__BEGIN_NAMESPACE_STD


356 
	`Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

357 c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

362 
	`¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

364 
	$•rötf
 (*
__ª°ri˘
 
__s
,

365 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROWNL
;

371 
	`vÂrötf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

372 
_G_va_li°
 
__¨g
);

377 
	`v¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
);

379 
	$v•rötf
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

380 
_G_va_li°
 
__¨g
Ë
__THROWNL
;

381 
__END_NAMESPACE_STD


383 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


384 
__BEGIN_NAMESPACE_C99


386 
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

387 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

388 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

390 
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

391 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

392 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

393 
__END_NAMESPACE_C99


396 #ifde‡
__USE_GNU


399 
	$va•rötf
 (**
__ª°ri˘
 
__±r
, c⁄° *__ª°ri˘ 
__f
,

400 
_G_va_li°
 
__¨g
)

401 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 0))Ë
__wur
;

402 
	$__a•rötf
 (**
__ª°ri˘
 
__±r
,

403 c⁄° *
__ª°ri˘
 
__fmt
, ...)

404 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

405 
	$a•rötf
 (**
__ª°ri˘
 
__±r
,

406 c⁄° *
__ª°ri˘
 
__fmt
, ...)

407 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

410 #ifde‡
__USE_XOPEN2K8


412 
	$vd¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
,

413 
_G_va_li°
 
__¨g
)

414 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

415 
	$d¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
, ...)

416 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

420 
__BEGIN_NAMESPACE_STD


425 
	$fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

426 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

431 
	$sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

433 
	$ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

434 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

436 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

437 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

438 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

439 #ifde‡
__REDIRECT


443 
	`__REDIRECT
 (
fsˇnf
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

444 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

445 
__isoc99_fsˇnf
Ë
__wur
;

446 
	`__REDIRECT
 (
sˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

447 
__isoc99_sˇnf
Ë
__wur
;

448 
	`__REDIRECT_NTH
 (
ssˇnf
, (c⁄° *
__ª°ri˘
 
__s
,

449 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

450 
__isoc99_ssˇnf
);

452 
	$__isoc99_fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

453 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

454 
	$__isoc99_sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

455 
	$__isoc99_ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

456 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

457 
	#fsˇnf
 
__isoc99_fsˇnf


	)

458 
	#sˇnf
 
__isoc99_sˇnf


	)

459 
	#ssˇnf
 
__isoc99_ssˇnf


	)

463 
__END_NAMESPACE_STD


465 #ifdef 
__USE_ISOC99


466 
__BEGIN_NAMESPACE_C99


471 
	$vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

472 
_G_va_li°
 
__¨g
)

473 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

479 
	$vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

480 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

483 
	$vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

484 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

485 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

487 #i‡!
deföed
 
__USE_GNU
 \

488 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

489 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

490 #ifde‡
__REDIRECT


494 
	`__REDIRECT
 (
vfsˇnf
,

495 (
FILE
 *
__ª°ri˘
 
__s
,

496 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
),

497 
__isoc99_vfsˇnf
)

498 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

499 
	`__REDIRECT
 (
vsˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
,

500 
_G_va_li°
 
__¨g
), 
__isoc99_vsˇnf
)

501 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

502 
	`__REDIRECT_NTH
 (
vssˇnf
,

503 (c⁄° *
__ª°ri˘
 
__s
,

504 c⁄° *
__ª°ri˘
 
__f‹m©
,

505 
_G_va_li°
 
__¨g
), 
__isoc99_vssˇnf
)

506 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

508 
	$__isoc99_vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
,

509 c⁄° *
__ª°ri˘
 
__f‹m©
,

510 
_G_va_li°
 
__¨g
Ë
__wur
;

511 
	$__isoc99_vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
,

512 
_G_va_li°
 
__¨g
Ë
__wur
;

513 
	$__isoc99_vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

514 c⁄° *
__ª°ri˘
 
__f‹m©
,

515 
_G_va_li°
 
__¨g
Ë
__THROW
;

516 
	#vfsˇnf
 
__isoc99_vfsˇnf


	)

517 
	#vsˇnf
 
__isoc99_vsˇnf


	)

518 
	#vssˇnf
 
__isoc99_vssˇnf


	)

522 
__END_NAMESPACE_C99


526 
__BEGIN_NAMESPACE_STD


531 
	`fgëc
 (
FILE
 *
__°ªam
);

532 
	`gëc
 (
FILE
 *
__°ªam
);

538 
	`gëch¨
 ();

539 
__END_NAMESPACE_STD


543 
	#gëc
(
_Â
Ë
	`_IO_gëc
 (_Â)

	)

545 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


550 
	`gëc_u∆ocked
 (
FILE
 *
__°ªam
);

551 
	`gëch¨_u∆ocked
 ();

554 #ifde‡
__USE_MISC


561 
	`fgëc_u∆ocked
 (
FILE
 *
__°ªam
);

565 
__BEGIN_NAMESPACE_STD


573 
	`Âutc
 (
__c
, 
FILE
 *
__°ªam
);

574 
	`putc
 (
__c
, 
FILE
 *
__°ªam
);

580 
	`putch¨
 (
__c
);

581 
__END_NAMESPACE_STD


585 
	#putc
(
_ch
, 
_Â
Ë
	`_IO_putc
 (_ch, _Â)

	)

587 #ifde‡
__USE_MISC


594 
	`Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

597 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


602 
	`putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

603 
	`putch¨_u∆ocked
 (
__c
);

607 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 \

608 || (
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

610 
	`gëw
 (
FILE
 *
__°ªam
);

613 
	`putw
 (
__w
, 
FILE
 *
__°ªam
);

617 
__BEGIN_NAMESPACE_STD


622 *
	$fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

623 
__wur
;

625 #i‡!
deföed
 
__USE_ISOC11
 \

626 || (
deföed
 
__˝lu•lus
 && __cplusplus <= 201103L)

638 *
	$gës
 (*
__s
Ë
__wur
 
__©åibuã_dïªˇãd__
;

640 
__END_NAMESPACE_STD


642 #ifde‡
__USE_GNU


649 *
	$fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
,

650 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

654 #ifdef 
__USE_XOPEN2K8


665 
_IO_ssize_t
 
	$__gëdñim
 (**
__ª°ri˘
 
__löïå
,

666 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

667 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

668 
_IO_ssize_t
 
	$gëdñim
 (**
__ª°ri˘
 
__löïå
,

669 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

670 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

678 
_IO_ssize_t
 
	$gëlöe
 (**
__ª°ri˘
 
__löïå
,

679 
size_t
 *
__ª°ri˘
 
__n
,

680 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

684 
__BEGIN_NAMESPACE_STD


689 
	`Âuts
 (c⁄° *
__ª°ri˘
 
__s
, 
FILE
 *__ª°ri˘ 
__°ªam
);

695 
	`puts
 (c⁄° *
__s
);

702 
	`ungëc
 (
__c
, 
FILE
 *
__°ªam
);

709 
size_t
 
	$‰ód
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

710 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

715 
size_t
 
	`fwrôe
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

716 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__s
);

717 
__END_NAMESPACE_STD


719 #ifde‡
__USE_GNU


726 
	`Âuts_u∆ocked
 (c⁄° *
__ª°ri˘
 
__s
,

727 
FILE
 *
__ª°ri˘
 
__°ªam
);

730 #ifde‡
__USE_MISC


737 
size_t
 
	$‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

738 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

739 
size_t
 
	`fwrôe_u∆ocked
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

740 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
);

744 
__BEGIN_NAMESPACE_STD


749 
	`f£ek
 (
FILE
 *
__°ªam
, 
__off
, 
__whí˚
);

754 
	$·ñl
 (
FILE
 *
__°ªam
Ë
__wur
;

759 
	`ªwöd
 (
FILE
 *
__°ªam
);

760 
__END_NAMESPACE_STD


767 #i‡
deföed
 
__USE_LARGEFILE
 || deföed 
__USE_XOPEN2K


768 #i‚de‡
__USE_FILE_OFFSET64


773 
	`f£eko
 (
FILE
 *
__°ªam
, 
__off_t
 
__off
, 
__whí˚
);

778 
__off_t
 
	$·ñlo
 (
FILE
 *
__°ªam
Ë
__wur
;

780 #ifde‡
__REDIRECT


781 
	`__REDIRECT
 (
f£eko
,

782 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
),

783 
f£eko64
);

784 
__off64_t
 
	`__REDIRECT
 (
·ñlo
, (
FILE
 *
__°ªam
), 
·ñlo64
);

786 
	#f£eko
 
f£eko64


	)

787 
	#·ñlo
 
·ñlo64


	)

792 
__BEGIN_NAMESPACE_STD


793 #i‚de‡
__USE_FILE_OFFSET64


798 
	`fgëpos
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos_t
 *__ª°ri˘ 
__pos
);

803 
	`f£ços
 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
);

805 #ifde‡
__REDIRECT


806 
	`__REDIRECT
 (
fgëpos
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

807 
Âos_t
 *
__ª°ri˘
 
__pos
), 
fgëpos64
);

808 
	`__REDIRECT
 (
f£ços
,

809 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
), 
f£ços64
);

811 
	#fgëpos
 
fgëpos64


	)

812 
	#f£ços
 
f£ços64


	)

815 
__END_NAMESPACE_STD


817 #ifde‡
__USE_LARGEFILE64


818 
	`f£eko64
 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
);

819 
__off64_t
 
	$·ñlo64
 (
FILE
 *
__°ªam
Ë
__wur
;

820 
	`fgëpos64
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos64_t
 *__ª°ri˘ 
__pos
);

821 
	`f£ços64
 (
FILE
 *
__°ªam
, c⁄° 
Âos64_t
 *
__pos
);

824 
__BEGIN_NAMESPACE_STD


826 
	$˛óªº
 (
FILE
 *
__°ªam
Ë
__THROW
;

828 
	$„of
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

830 
	$„º‹
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

831 
__END_NAMESPACE_STD


833 #ifde‡
__USE_MISC


835 
	$˛óªº_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

836 
	$„of_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

837 
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

841 
__BEGIN_NAMESPACE_STD


846 
	`≥º‹
 (c⁄° *
__s
);

847 
__END_NAMESPACE_STD


853 
	~<bôs/sys_îæi°.h
>

856 #ifdef 
__USE_POSIX


858 
	$fûío
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

861 #ifde‡
__USE_MISC


863 
	$fûío_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

867 #i‡(
deföed
 
__USE_POSIX2
 || deföed 
__USE_SVID
 || deföed 
__USE_BSD
 || \

868 
deföed
 
__USE_MISC
)

873 
FILE
 *
	$p›í
 (c⁄° *
__comm™d
, c⁄° *
__modes
Ë
__wur
;

879 
	`p˛o£
 (
FILE
 *
__°ªam
);

883 #ifdef 
__USE_POSIX


885 *
	$˘îmid
 (*
__s
Ë
__THROW
;

889 #ifde‡
__USE_XOPEN


891 *
	`cu£rid
 (*
__s
);

895 #ifdef 
__USE_GNU


896 
ob°ack
;

899 
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

900 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

901 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

902 
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

903 c⁄° *
__ª°ri˘
 
__f‹m©
,

904 
_G_va_li°
 
__¨gs
)

905 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

909 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


913 
	$Êockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

917 
	$·rylockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

920 
	$fu∆ockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

923 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


927 
	#__√ed_gë›t


	)

928 
	~<gë›t.h
>

933 #ifde‡
__USE_EXTERN_INLINES


934 
	~<bôs/°dio.h
>

936 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


937 
	~<bôs/°dio2.h
>

939 #ifde‡
__LDBL_COMPAT


940 
	~<bôs/°dio-ldbl.h
>

943 
__END_DECLS


	@/usr/include/stdlib.h

22 #i‚def 
_STDLIB_H


24 
	~<„©uªs.h
>

27 
	#__√ed_size_t


	)

28 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


29 
	#__√ed_wch¨_t


	)

30 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

34 
	g__BEGIN_DECLS


36 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


37 
	#_STDLIB_H
 1

	)

39 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
Ë&& !deföed 
_SYS_WAIT_H


41 
	~<bôs/waôÊags.h
>

42 
	~<bôs/waô°©us.h
>

44 #ifde‡
__USE_BSD


49 #i‡
deföed
 
__GNUC__
 && !deföed 
__˝lu•lus


50 
	#__WAIT_INT
(
°©us
) \

51 (
	`__exãnsi⁄__
 (((uni⁄ { 
	`__ty≥of
(
°©us
Ë
__ö
; 
__i
; }) \

52 { .
__ö
 = (
°©us
Ë}).
__i
))

	)

54 
	#__WAIT_INT
(
°©us
Ë(*(*Ë&(°©us))

	)

62 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2 || deföed 
__˝lu•lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
waô
 *
	m__u±r
;

70 *
	m__ùå
;

71 } 
	t__WAIT_STATUS
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
°©us
Ë(°©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (°©us))

	)

85 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
 (
	`__WAIT_INT
 (°©us))

	)

86 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
 (
	`__WAIT_INT
 (°©us))

	)

87 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
 (
	`__WAIT_INT
 (°©us))

	)

88 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (°©us))

	)

89 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (°©us))

	)

90 #ifde‡
__WIFCONTINUED


91 
	#WIFCONTINUED
(
°©us
Ë
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (°©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquŸ
;

100 
	mªm
;

101 } 
	tdiv_t
;

104 #i‚de‡
__ldiv_t_deföed


107 
	mquŸ
;

108 
	mªm
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_deföed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__Œdiv_t_deföed


115 
__BEGIN_NAMESPACE_C99


117 
__exãnsi⁄__
 struct

119 
	mquŸ
;

120 
	mªm
;

121 } 
	tŒdiv_t
;

122 
	#__Œdiv_t_deföed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__˘y≥_gë_mb_cur_max
 ())

	)

139 
size_t
 
	$__˘y≥_gë_mb_cur_max
 (Ë
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (c⁄° *
__≈å
)

145 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

147 
	$©oi
 (c⁄° *
__≈å
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

150 
	$©ﬁ
 (c⁄° *
__≈å
)

151 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

152 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_ISOC99
 || deföed 
__USE_MISC


155 
__BEGIN_NAMESPACE_C99


157 
__exãnsi⁄__
 
	$©ﬁl
 (c⁄° *
__≈å
)

158 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$°πod
 (c⁄° *
__ª°ri˘
 
__≈å
,

165 **
__ª°ri˘
 
__íd±r
)

166 
__THROW
 
	`__n⁄nuŒ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$°πof
 (c⁄° *
__ª°ri˘
 
__≈å
,

173 **
__ª°ri˘
 
__íd±r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

175 
	$°πﬁd
 (c⁄° *
__ª°ri˘
 
__≈å
,

176 **
__ª°ri˘
 
__íd±r
)

177 
__THROW
 
	`__n⁄nuŒ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$°πﬁ
 (c⁄° *
__ª°ri˘
 
__≈å
,

184 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

185 
__THROW
 
	`__n⁄nuŒ
 ((1));

187 
	$°πoul
 (c⁄° *
__ª°ri˘
 
__≈å
,

188 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

189 
__THROW
 
	`__n⁄nuŒ
 ((1));

190 
__END_NAMESPACE_STD


192 #ifde‡
__USE_BSD


194 
__exãnsi⁄__


195 
	$°πoq
 (c⁄° *
__ª°ri˘
 
__≈å
,

196 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

197 
__THROW
 
	`__n⁄nuŒ
 ((1));

199 
__exãnsi⁄__


200 
	$°πouq
 (c⁄° *
__ª°ri˘
 
__≈å
,

201 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

202 
__THROW
 
	`__n⁄nuŒ
 ((1));

205 #i‡
deföed
 
__USE_ISOC99
 || deföed 
__USE_MISC


206 
__BEGIN_NAMESPACE_C99


208 
__exãnsi⁄__


209 
	$°πﬁl
 (c⁄° *
__ª°ri˘
 
__≈å
,

210 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

211 
__THROW
 
	`__n⁄nuŒ
 ((1));

213 
__exãnsi⁄__


214 
	$°πouŒ
 (c⁄° *
__ª°ri˘
 
__≈å
,

215 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

216 
__THROW
 
	`__n⁄nuŒ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifde‡
__USE_GNU


235 
	~<xloˇÀ.h
>

239 
	$°πﬁ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

240 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

241 
__loˇÀ_t
 
__loc
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

243 
	$°πoul_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

244 **
__ª°ri˘
 
__íd±r
,

245 
__ba£
, 
__loˇÀ_t
 
__loc
)

246 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

248 
__exãnsi⁄__


249 
	$°πﬁl_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

250 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

251 
__loˇÀ_t
 
__loc
)

252 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

254 
__exãnsi⁄__


255 
	$°πouŒ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

256 **
__ª°ri˘
 
__íd±r
,

257 
__ba£
, 
__loˇÀ_t
 
__loc
)

258 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

260 
	$°πod_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

261 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

262 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

264 
	$°πof_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

265 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

266 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

268 
	$°πﬁd_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

269 **
__ª°ri˘
 
__íd±r
,

270 
__loˇÀ_t
 
__loc
)

271 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

275 #ifde‡
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__exã∫_ölöe
 

278 
	`__NTH
 (
	$©oi
 (c⁄° *
__≈å
))

280  (Ë
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

281 
	}
}

282 
__exã∫_ölöe
 

283 
__NTH
 (
	$©ﬁ
 (c⁄° *
__≈å
))

285  
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__exãnsi⁄__
 
__exã∫_ölöe
 

292 
__NTH
 (
	$©ﬁl
 (c⁄° *
__≈å
))

294  
	`°πﬁl
 (
__≈å
, (**Ë
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
Ë
__THROW
 
__wur
;

308 
	$a64l
 (c⁄° *
__s
)

309 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

313 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_BSD


314 
	~<sys/ty≥s.h
>

321 
	$øndom
 (Ë
__THROW
;

324 
	$§™dom
 (
__£ed
Ë
__THROW
;

330 *
	$öô°©e
 (
__£ed
, *
__°©ebuf
,

331 
size_t
 
__°©ñí
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

335 *
	$£t°©e
 (*
__°©ebuf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

338 #ifde‡
__USE_MISC


343 
	søndom_d©a


345 
öt32_t
 *
Âå
;

346 
öt32_t
 *
Ωå
;

347 
öt32_t
 *
°©e
;

348 
ønd_ty≥
;

349 
ønd_deg
;

350 
ønd_£p
;

351 
öt32_t
 *
íd_±r
;

354 
	$øndom_r
 (
øndom_d©a
 *
__ª°ri˘
 
__buf
,

355 
öt32_t
 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

357 
	$§™dom_r
 (
__£ed
, 
øndom_d©a
 *
__buf
)

358 
__THROW
 
	`__n⁄nuŒ
 ((2));

360 
	$öô°©e_r
 (
__£ed
, *
__ª°ri˘
 
__°©ebuf
,

361 
size_t
 
__°©ñí
,

362 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

363 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

365 
	$£t°©e_r
 (*
__ª°ri˘
 
__°©ebuf
,

366 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

367 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$ønd
 (Ë
__THROW
;

376 
	$§™d
 (
__£ed
Ë
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifde‡
__USE_POSIX


381 
	$ønd_r
 (*
__£ed
Ë
__THROW
;

385 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


389 
	$dønd48
 (Ë
__THROW
;

390 
	$î™d48
 (
__xsubi
[3]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

393 
	$Ã™d48
 (Ë
__THROW
;

394 
	$ƒ™d48
 (
__xsubi
[3])

395 
__THROW
 
	`__n⁄nuŒ
 ((1));

398 
	$mønd48
 (Ë
__THROW
;

399 
	$jønd48
 (
__xsubi
[3])

400 
__THROW
 
	`__n⁄nuŒ
 ((1));

403 
	$§™d48
 (
__£edvÆ
Ë
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__n⁄nuŒ
 ((1));

406 
	$lc⁄g48
 (
__∑øm
[7]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

408 #ifde‡
__USE_MISC


412 
	sdønd48_d©a


414 
__x
[3];

415 
__ﬁd_x
[3];

416 
__c
;

417 
__öô
;

418 
__exãnsi⁄__
 
__a
;

423 
	$dønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

424 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

425 
	$î™d48_r
 (
__xsubi
[3],

426 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

427 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

430 
	$Ã™d48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

431 *
__ª°ri˘
 
__ªsu…
)

432 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

433 
	$ƒ™d48_r
 (
__xsubi
[3],

434 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

435 *
__ª°ri˘
 
__ªsu…
)

436 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

439 
	$mønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

440 *
__ª°ri˘
 
__ªsu…
)

441 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

442 
	$jønd48_r
 (
__xsubi
[3],

443 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

444 *
__ª°ri˘
 
__ªsu…
)

445 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

448 
	$§™d48_r
 (
__£edvÆ
, 
dønd48_d©a
 *
__buf„r
)

449 
__THROW
 
	`__n⁄nuŒ
 ((2));

451 
	$£ed48_r
 (
__£ed16v
[3],

452 
dønd48_d©a
 *
__buf„r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

454 
	$lc⁄g48_r
 (
__∑øm
[7],

455 
dønd48_d©a
 *
__buf„r
)

456 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

462 #i‚de‡
__mÆloc_™d_ˇŒoc_deföed


463 
	#__mÆloc_™d_ˇŒoc_deföed


	)

464 
__BEGIN_NAMESPACE_STD


466 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

468 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

469 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

470 
__END_NAMESPACE_STD


473 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


474 
__BEGIN_NAMESPACE_STD


480 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

481 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

483 
	$‰ì
 (*
__±r
Ë
__THROW
;

484 
__END_NAMESPACE_STD


486 #ifdef 
__USE_MISC


488 
	$c‰ì
 (*
__±r
Ë
__THROW
;

491 #i‡
deföed
 
__USE_GNU
 || deföed 
__USE_BSD
 || deföed 
__USE_MISC


492 
	~<Æloˇ.h
>

495 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

496 || 
deföed
 
__USE_BSD


498 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

501 #ifde‡
__USE_XOPEN2K


503 
	$posix_memÆign
 (**
__mem±r
, 
size_t
 
__Æignmít
, size_à
__size
)

504 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

507 #ifde‡
__USE_ISOC11


509 *
	$Æig√d_Æloc
 (
size_t
 
__Æignmít
, size_à
__size
)

510 
__THROW
 
__©åibuã_mÆloc__
 
	`__©åibuã_Æloc_size__
 ((2)Ë
__wur
;

513 
__BEGIN_NAMESPACE_STD


515 
	$ab‹t
 (Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

519 
	`©exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

521 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


523 #ifde‡
__˝lu•lus


524 "C++" 
	`©_quick_exô
 ((*
__func
) ())

525 
__THROW
 
	`__asm
 ("©_quick_exô"Ë
	`__n⁄nuŒ
 ((1));

527 
	`©_quick_exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

530 
__END_NAMESPACE_STD


532 #ifdef 
__USE_MISC


535 
	`⁄_exô
 ((*
__func
Ë(
__°©us
, *
__¨g
), *__arg)

536 
__THROW
 
	`__n⁄nuŒ
 ((1));

539 
__BEGIN_NAMESPACE_STD


543 
	$exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

545 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


549 
	$quick_exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

551 
__END_NAMESPACE_STD


553 #ifde‡
__USE_ISOC99


554 
__BEGIN_NAMESPACE_C99


557 
	$_Exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

558 
__END_NAMESPACE_C99


562 
__BEGIN_NAMESPACE_STD


564 *
	$gëív
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

565 
__END_NAMESPACE_STD


567 #ifde‡
__USE_GNU


570 *
	$£cuª_gëív
 (c⁄° *
__«me
)

571 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

574 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


578 
	$puãnv
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

581 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


584 
	$£ãnv
 (c⁄° *
__«me
, c⁄° *
__vÆue
, 
__ª∂a˚
)

585 
__THROW
 
	`__n⁄nuŒ
 ((2));

588 
	$un£ãnv
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

591 #ifdef 
__USE_MISC


595 
	$˛óªnv
 (Ë
__THROW
;

599 #i‡
deföed
 
__USE_MISC
 \

600 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
)

606 *
	$mkãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

609 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 \

610 || 
deföed
 
__USE_XOPEN2K8


619 #i‚de‡
__USE_FILE_OFFSET64


620 
	$mk°emp
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

622 #ifde‡
__REDIRECT


623 
	`__REDIRECT
 (
mk°emp
, (*
__ãm∂©e
), 
mk°emp64
)

624 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

626 
	#mk°emp
 
mk°emp64


	)

629 #ifde‡
__USE_LARGEFILE64


630 
	$mk°emp64
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

634 #ifde‡
__USE_MISC


641 #i‚de‡
__USE_FILE_OFFSET64


642 
	$mk°emps
 (*
__ãm∂©e
, 
__suffixÀn
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

644 #ifde‡
__REDIRECT


645 
	`__REDIRECT
 (
mk°emps
, (*
__ãm∂©e
, 
__suffixÀn
),

646 
mk°emps64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

648 
	#mk°emps
 
mk°emps64


	)

651 #ifde‡
__USE_LARGEFILE64


652 
	$mk°emps64
 (*
__ãm∂©e
, 
__suffixÀn
)

653 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

657 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K8


663 *
	$mkdãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

666 #ifde‡
__USE_GNU


673 #i‚de‡
__USE_FILE_OFFSET64


674 
	$mko°emp
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

676 #ifde‡
__REDIRECT


677 
	`__REDIRECT
 (
mko°emp
, (*
__ãm∂©e
, 
__Êags
), 
mko°emp64
)

678 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

680 
	#mko°emp
 
mko°emp64


	)

683 #ifde‡
__USE_LARGEFILE64


684 
	$mko°emp64
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

693 #i‚de‡
__USE_FILE_OFFSET64


694 
	$mko°emps
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

695 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

697 #ifde‡
__REDIRECT


698 
	`__REDIRECT
 (
mko°emps
, (*
__ãm∂©e
, 
__suffixÀn
,

699 
__Êags
), 
mko°emps64
)

700 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

702 
	#mko°emps
 
mko°emps64


	)

705 #ifde‡
__USE_LARGEFILE64


706 
	$mko°emps64
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

707 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

712 
__BEGIN_NAMESPACE_STD


717 
	$sy°em
 (c⁄° *
__comm™d
Ë
__wur
;

718 
__END_NAMESPACE_STD


721 #ifdef 
__USE_GNU


724 *
	$ˇn⁄iˇlize_fûe_«me
 (c⁄° *
__«me
)

725 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

728 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


734 *
	$ªÆ∑th
 (c⁄° *
__ª°ri˘
 
__«me
,

735 *
__ª°ri˘
 
__ªsﬁved
Ë
__THROW
 
__wur
;

740 #i‚de‡
__COMPAR_FN_T


741 
	#__COMPAR_FN_T


	)

742 (*
	t__com∑r_‚_t
) (const *, const *);

744 #ifdef 
__USE_GNU


745 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

748 #ifde‡
__USE_GNU


749 (*
	t__com∑r_d_‚_t
) (const *, const *, *);

752 
__BEGIN_NAMESPACE_STD


755 *
	$b£¨ch
 (c⁄° *
__key
, c⁄° *
__ba£
,

756 
size_t
 
__nmemb
, size_à
__size
, 
__com∑r_‚_t
 
__com∑r
)

757 
	`__n⁄nuŒ
 ((1, 2, 5)Ë
__wur
;

759 #ifde‡
__USE_EXTERN_INLINES


760 
	~<bôs/°dlib-b£¨ch.h
>

765 
	$qs‹t
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

766 
__com∑r_‚_t
 
__com∑r
Ë
	`__n⁄nuŒ
 ((1, 4));

767 #ifde‡
__USE_GNU


768 
	$qs‹t_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

769 
__com∑r_d_‚_t
 
__com∑r
, *
__¨g
)

770 
	`__n⁄nuŒ
 ((1, 4));

775 
	$abs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

776 
	$œbs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

777 
__END_NAMESPACE_STD


779 #ifde‡
__USE_ISOC99


780 
__exãnsi⁄__
 
	$Œabs
 (
__x
)

781 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

785 
__BEGIN_NAMESPACE_STD


789 
div_t
 
	$div
 (
__numî
, 
__díom
)

790 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

791 
ldiv_t
 
	$ldiv
 (
__numî
, 
__díom
)

792 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

793 
__END_NAMESPACE_STD


795 #ifde‡
__USE_ISOC99


796 
__BEGIN_NAMESPACE_C99


797 
__exãnsi⁄__
 
Œdiv_t
 
	$Œdiv
 (
__numî
,

798 
__díom
)

799 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

800 
__END_NAMESPACE_C99


804 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

805 || 
deföed
 
__USE_SVID


812 *
	$ecvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

813 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

818 *
	$fcvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

819 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

824 *
	$gcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

825 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

828 #ifde‡
__USE_MISC


830 *
	$qecvt
 (
__vÆue
, 
__ndigô
,

831 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

832 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

833 *
	$qfcvt
 (
__vÆue
, 
__ndigô
,

834 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

835 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

836 *
	$qgcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

837 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

842 
	$ecvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

843 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

844 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

845 
	$fcvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

846 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

847 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

849 
	$qecvt_r
 (
__vÆue
, 
__ndigô
,

850 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

851 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

852 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

853 
	$qfcvt_r
 (
__vÆue
, 
__ndigô
,

854 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

855 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

856 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

860 
__BEGIN_NAMESPACE_STD


863 
	$mbÀn
 (c⁄° *
__s
, 
size_t
 
__n
Ë
__THROW
;

866 
	$mbtowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

867 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

870 
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
Ë
__THROW
;

874 
size_t
 
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__pwcs
,

875 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

877 
size_t
 
	$wc°ombs
 (*
__ª°ri˘
 
__s
,

878 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__pwcs
, 
size_t
 
__n
)

879 
__THROW
;

880 
__END_NAMESPACE_STD


883 #ifde‡
__USE_SVID


888 
	$Ωm©ch
 (c⁄° *
__ª•⁄£
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

892 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


899 
	$gësub›t
 (**
__ª°ri˘
 
__›ti⁄p
,

900 *c⁄° *
__ª°ri˘
 
__tokís
,

901 **
__ª°ri˘
 
__vÆuï
)

902 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3)Ë
__wur
;

906 #ifde‡
__USE_XOPEN


908 
	$£tkey
 (c⁄° *
__key
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

914 #ifde‡
__USE_XOPEN2KXSI


916 
	$posix_›í±
 (
__oÊag
Ë
__wur
;

919 #ifde‡
__USE_XOPEN


924 
	$gø¡±
 (
__fd
Ë
__THROW
;

928 
	$u∆ock±
 (
__fd
Ë
__THROW
;

933 *
	$±¢ame
 (
__fd
Ë
__THROW
 
__wur
;

936 #ifde‡
__USE_GNU


940 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

941 
__THROW
 
	`__n⁄nuŒ
 ((2));

944 
	`gë±
 ();

947 #ifde‡
__USE_BSD


951 
	$gëlﬂdavg
 (
__lﬂdavg
[], 
__√Àm
)

952 
__THROW
 
	`__n⁄nuŒ
 ((1));

955 
	~<bôs/°dlib-Êﬂt.h
>

958 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


959 
	~<bôs/°dlib.h
>

961 #ifde‡
__LDBL_COMPAT


962 
	~<bôs/°dlib-ldbl.h
>

966 #unde‡
__√ed_mÆloc_™d_ˇŒoc


968 
__END_DECLS


	@/usr/include/string.h

22 #i‚def 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


30 
	#__√ed_size_t


	)

31 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

39 #i‡
deföed
 
__˝lu•lus
 && (__˝lu•lu†>199711L || 
__GNUC_PREREQ
 (4, 4))

40 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

44 
__BEGIN_NAMESPACE_STD


46 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

47 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

50 *
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

51 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

52 
__END_NAMESPACE_STD


57 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN


58 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

59 
__c
, 
size_t
 
__n
)

60 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

64 
__BEGIN_NAMESPACE_STD


66 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

69 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

70 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

73 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


76 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

77 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

78 c⁄° *
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

79 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

81 #ifde‡
__OPTIMIZE__


82 
__exã∫_Æways_ölöe
 *

83 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


85  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

88 
__exã∫_Æways_ölöe
 const *

89 
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


91  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

94 
	}
}

96 *
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

97 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

99 
__END_NAMESPACE_STD


101 #ifde‡
__USE_GNU


104 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


105 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

106 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

107 "C++" c⁄° *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

108 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

110 *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

111 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

115 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


116 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

117 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

118 "C++" c⁄° *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

119 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

121 *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

122 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

127 
__BEGIN_NAMESPACE_STD


129 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

130 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

132 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

133 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

134 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

137 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

138 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

140 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

141 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

144 
	$°rcmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

145 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

147 
	$°∫cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

151 
	$°rcﬁl
 (c⁄° *
__s1
, c⁄° *
__s2
)

152 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

154 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

155 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

156 
__THROW
 
	`__n⁄nuŒ
 ((2));

157 
__END_NAMESPACE_STD


159 #ifde‡
__USE_XOPEN2K8


163 
	~<xloˇÀ.h
>

166 
	$°rcﬁl_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
__loˇÀ_t
 
__l
)

167 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

169 
size_t
 
	$°rx‰m_l
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

170 
__loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

173 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 \

174 || 
deföed
 
__USE_XOPEN2K8


176 *
	$°rdup
 (c⁄° *
__s
)

177 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

183 #i‡
deföed
 
__USE_XOPEN2K8


184 *
	$°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

185 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

188 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


190 
	#°rdu∑
(
s
) \

191 (
__exãnsi⁄__
 \

193 c⁄° *
__ﬁd
 = (
s
); \

194 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

195 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

196 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

197 
	}
}))

	)

200 
	#°∫du∑
(
s
, 
n
) \

201 (
__exãnsi⁄__
 \

203 c⁄° *
__ﬁd
 = (
s
); \

204 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

205 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

206 
__√w
[
__Àn
] = '\0'; \

207 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

208 }))

	)

211 
	g__BEGIN_NAMESPACE_STD


213 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


216 *
°rchr
 (*
__s
, 
__c
)

217 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

218 c⁄° *
°rchr
 (c⁄° *
__s
, 
__c
)

219 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

221 #ifde‡
__OPTIMIZE__


222 
__exã∫_Æways_ölöe
 *

223 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


225  
__buûtö_°rchr
 (
__s
, 
__c
);

228 
__exã∫_Æways_ölöe
 const *

229 
°rchr
 (c⁄° *
__s
, 
__c
Ë
	g__THROW


231  
__buûtö_°rchr
 (
__s
, 
__c
);

236 *
	$°rchr
 (c⁄° *
__s
, 
__c
)

237 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

240 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


243 *
	`°ºchr
 (*
__s
, 
__c
)

244 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

245 c⁄° *
	`°ºchr
 (c⁄° *
__s
, 
__c
)

246 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

248 #ifde‡
__OPTIMIZE__


249 
__exã∫_Æways_ölöe
 *

250 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


252  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

255 
__exã∫_Æways_ölöe
 const *

256 
	`°ºchr
 (c⁄° *
__s
, 
__c
Ë
__THROW


258  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

261 
	}
}

263 *
	$°ºchr
 (c⁄° *
__s
, 
__c
)

264 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

266 
__END_NAMESPACE_STD


268 #ifde‡
__USE_GNU


271 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


272 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

273 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

274 "C++" c⁄° *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

275 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

277 *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

278 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

282 
__BEGIN_NAMESPACE_STD


285 
size_t
 
	$°rc•n
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

286 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

289 
size_t
 
	$°r•n
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

290 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

292 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


295 *
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
)

296 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

297 c⁄° *
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

298 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

300 #ifde‡
__OPTIMIZE__


301 
__exã∫_Æways_ölöe
 *

302 
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
Ë
__THROW


304  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

307 
__exã∫_Æways_ölöe
 const *

308 
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
Ë
__THROW


310  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

313 
	}
}

315 *
	$°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

316 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

319 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


322 *
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

323 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

324 c⁄° *
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

325 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

327 #ifde‡
__OPTIMIZE__


328 
__exã∫_Æways_ölöe
 *

329 
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


331  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

334 
__exã∫_Æways_ölöe
 const *

335 
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


337  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

340 
	}
}

342 *
	$°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

343 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

348 *
	$°πok
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
)

349 
__THROW
 
	`__n⁄nuŒ
 ((2));

350 
__END_NAMESPACE_STD


354 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

355 c⁄° *
__ª°ri˘
 
__dñim
,

356 **
__ª°ri˘
 
__ßve_±r
)

357 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

358 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


359 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
,

360 **
__ª°ri˘
 
__ßve_±r
)

361 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

364 #ifde‡
__USE_GNU


366 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


367 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

368 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

369 "C++" c⁄° *
	$°rˇ£°r
 (c⁄° *
__hay°ack
,

370 c⁄° *
__√edÀ
)

371 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

373 *
	$°rˇ£°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

374 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

378 #ifde‡
__USE_GNU


382 *
	$memmem
 (c⁄° *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

383 c⁄° *
__√edÀ
, 
size_t
 
__√edÀÀn
)

384 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3));

388 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

389 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

390 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

391 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

392 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

393 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

397 
__BEGIN_NAMESPACE_STD


399 
size_t
 
	$°æí
 (c⁄° *
__s
)

400 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

401 
__END_NAMESPACE_STD


403 #ifdef 
__USE_XOPEN2K8


406 
size_t
 
	$°∫Àn
 (c⁄° *
__°rög
, 
size_t
 
__maxÀn
)

407 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

411 
__BEGIN_NAMESPACE_STD


413 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

414 
__END_NAMESPACE_STD


415 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_MISC


423 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


426 #ifde‡
__REDIRECT_NTH


427 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

428 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

429 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2));

431 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

432 
__THROW
 
	`__n⁄nuŒ
 ((2));

433 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

438 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

439 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

443 #ifde‡
__USE_XOPEN2K8


445 *
	$°ªº‹_l
 (
__î∫um
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

451 
	$__bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

453 #ifde‡
__USE_BSD


455 
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__n
)

456 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

459 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

462 
	$bcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

463 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

466 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


469 *
	`ödex
 (*
__s
, 
__c
)

470 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

471 c⁄° *
	`ödex
 (c⁄° *
__s
, 
__c
)

472 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

474 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


475 
__exã∫_Æways_ölöe
 *

476 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


478  
	`__buûtö_ödex
 (
__s
, 
__c
);

481 
__exã∫_Æways_ölöe
 const *

482 
	`ödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


484  
	`__buûtö_ödex
 (
__s
, 
__c
);

487 
	}
}

489 *
	$ödex
 (c⁄° *
__s
, 
__c
)

490 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

494 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


497 *
	`rödex
 (*
__s
, 
__c
)

498 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

499 c⁄° *
	`rödex
 (c⁄° *
__s
, 
__c
)

500 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

502 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


503 
__exã∫_Æways_ölöe
 *

504 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


506  
	`__buûtö_rödex
 (
__s
, 
__c
);

509 
__exã∫_Æways_ölöe
 const *

510 
	`rödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


512  
	`__buûtö_rödex
 (
__s
, 
__c
);

515 
	}
}

517 *
	$rödex
 (c⁄° *
__s
, 
__c
)

518 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

523 
	$ffs
 (
__i
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

527 #ifdef 
__USE_GNU


528 
	$ff¶
 (
__l
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

529 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

530 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

534 
	$°rˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

535 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

538 
	$°∫ˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

539 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

542 #ifdef 
__USE_GNU


545 
	$°rˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

546 
__loˇÀ_t
 
__loc
)

547 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

549 
	$°∫ˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

550 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
)

551 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

554 #ifdef 
__USE_BSD


557 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

558 c⁄° *
__ª°ri˘
 
__dñim
)

559 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

562 #ifdef 
__USE_XOPEN2K8


564 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

567 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

568 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

569 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

570 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

574 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

575 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

576 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

577 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

578 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

579 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

582 #ifdef 
__USE_GNU


584 
	$°rvîscmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

585 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

588 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

591 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

593 #i‚de‡
ba£«me


598 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


599 "C++" *
	$ba£«me
 (*
__fûíame
)

600 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

601 "C++" c⁄° *
	$ba£«me
 (c⁄° *
__fûíame
)

602 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

604 *
	$ba£«me
 (c⁄° *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

610 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

611 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__OPTIMIZE_SIZE__
 \

612 && !
deföed
 
__NO_INLINE__
 && !deföed 
__˝lu•lus


632 
	~<bôs/°rög.h
>

635 
	~<bôs/°rög2.h
>

638 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


640 
	~<bôs/°rög3.h
>

644 
__END_DECLS


	@/usr/include/time.h

22 #i‚def 
_TIME_H


24 #i‡(! 
deföed
 
__√ed_time_t
 && !deföed 
__√ed_˛ock_t
 && \

25 ! 
deföed
 
	g__√ed_time•ec
)

26 
	#_TIME_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__√ed_size_t


	)

36 
	#__√ed_NULL


	)

37 
	~<°ddef.h
>

41 
	~<bôs/time.h
>

44 #i‡!
deföed
 
__STRICT_ANSI__
 && !deföed 
__USE_XOPEN2K


45 #i‚de‡
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #i‡!
deföed
 
__˛ock_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_˛ock_t
)

53 
	#__˛ock_t_deföed
 1

	)

55 
	~<bôs/ty≥s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__˛ock_t
 
	t˛ock_t
;

60 
	g__END_NAMESPACE_STD


61 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


62 
	$__USING_NAMESPACE_STD
(
˛ock_t
)

66 #unde‡
__√ed_˛ock_t


68 #i‡!
deföed
 
__time_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_time_t
)

69 
	#__time_t_deföed
 1

	)

71 
	~<bôs/ty≥s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC
 || deföed 
__USE_SVID


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #unde‡
__√ed_time_t


84 #i‡!
deföed
 
__˛ockid_t_deföed
 && \

85 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_˛ockid_t
)

86 
	#__˛ockid_t_deföed
 1

	)

88 
	~<bôs/ty≥s.h
>

91 
__˛ockid_t
 
	t˛ockid_t
;

94 #unde‡
__˛ockid_time_t


96 #i‡!
deföed
 
__timî_t_deföed
 && \

97 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_timî_t
)

98 
	#__timî_t_deföed
 1

	)

100 
	~<bôs/ty≥s.h
>

103 
__timî_t
 
	ttimî_t
;

106 #unde‡
__√ed_timî_t


109 #i‡(!
deföed
 
__time•ec_deföed
 \

110 && ((
deföed
 
_TIME_H
 \

111 && (
deföed
 
__USE_POSIX199309
 || deföed 
__USE_MISC
 \

112 || 
deföed
 
__USE_ISOC11
)) \

113 || 
deföed
 
__√ed_time•ec
))

114 
	#__time•ec_deföed
 1

	)

116 
	~<bôs/ty≥s.h
>

120 
	stime•ec


122 
__time_t
 
tv_£c
;

123 
__sysˇŒ_¶⁄g_t
 
tv_n£c
;

127 #unde‡
__√ed_time•ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mö
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_m⁄
;

140 
tm_yór
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd°
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 c⁄° *
tm_z⁄e
;

149 
__tm_gmtoff
;

150 c⁄° *
__tm_z⁄e
;

153 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifde‡
__USE_POSIX199309


161 
	sôimî•ec


163 
time•ec
 
ô_öãrvÆ
;

164 
time•ec
 
ô_vÆue
;

168 
sigevít
;

172 #ifde‡
__USE_XOPEN2K


173 #i‚de‡
__pid_t_deföed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_deföed


	)

180 #ifde‡
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
˛ock_t
 
	$˛ock
 (Ë
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__timî
Ë
__THROW
;

195 
	$dif·ime
 (
time_t
 
__time1
,Åime_à
__time0
)

196 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

199 
time_t
 
	$mktime
 (
tm
 *
__ç
Ë
__THROW
;

205 
size_t
 
	$°r·ime
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

206 c⁄° *
__ª°ri˘
 
__f‹m©
,

207 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifde‡
__USE_XOPEN


213 *
	$°Ωtime
 (c⁄° *
__ª°ri˘
 
__s
,

214 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
)

215 
__THROW
;

218 #ifde‡
__USE_XOPEN2K8


221 
	~<xloˇÀ.h
>

223 
size_t
 
	$°r·ime_l
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

224 c⁄° *
__ª°ri˘
 
__f‹m©
,

225 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

226 
__loˇÀ_t
 
__loc
Ë
__THROW
;

229 #ifde‡
__USE_GNU


230 *
	$°Ωtime_l
 (c⁄° *
__ª°ri˘
 
__s
,

231 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
,

232 
__loˇÀ_t
 
__loc
Ë
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

243 
tm
 *
	$loˇ…ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

244 
__END_NAMESPACE_STD


246 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


249 
tm
 *
	$gmtime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

250 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

254 
tm
 *
	$loˇ…ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

255 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$as˘ime
 (c⁄° 
tm
 *
__ç
Ë
__THROW
;

264 *
	$˘ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

265 
__END_NAMESPACE_STD


267 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


272 *
	$as˘ime_r
 (c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

273 *
__ª°ri˘
 
__buf
Ë
__THROW
;

276 *
	$˘ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

277 *
__ª°ri˘
 
__buf
Ë
__THROW
;

282 *
__tz«me
[2];

283 
__daylight
;

284 
__timez⁄e
;

287 #ifdef 
__USE_POSIX


289 *
tz«me
[2];

293 
	$tz£t
 (Ë
__THROW
;

296 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


297 
daylight
;

298 
timez⁄e
;

301 #ifde‡
__USE_SVID


304 
	$°ime
 (c⁄° 
time_t
 *
__whí
Ë
__THROW
;

310 
	#__i¶óp
(
yór
) \

311 ((
yór
Ë% 4 =0 && ((yórË% 100 !0 || (yórË% 400 =0))

	)

314 #ifde‡
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__ç
Ë
__THROW
;

322 
time_t
 
	$timñoˇl
 (
tm
 *
__ç
Ë
__THROW
;

325 
	$dysize
 (
__yór
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

329 #ifde‡
__USE_POSIX199309


334 
	`«no¶ìp
 (c⁄° 
time•ec
 *
__ªque°ed_time
,

335 
time•ec
 *
__ªmaöög
);

339 
	$˛ock_gëªs
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ªs
Ë
__THROW
;

342 
	$˛ock_gëtime
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ç
Ë
__THROW
;

345 
	$˛ock_£âime
 (
˛ockid_t
 
__˛ock_id
, c⁄° 
time•ec
 *
__ç
)

346 
__THROW
;

348 #ifde‡
__USE_XOPEN2K


353 
	`˛ock_«no¶ìp
 (
˛ockid_t
 
__˛ock_id
, 
__Êags
,

354 c⁄° 
time•ec
 *
__ªq
,

355 
time•ec
 *
__ªm
);

358 
	$˛ock_gë˝u˛ockid
 (
pid_t
 
__pid
, 
˛ockid_t
 *
__˛ock_id
Ë
__THROW
;

363 
	$timî_¸óã
 (
˛ockid_t
 
__˛ock_id
,

364 
sigevít
 *
__ª°ri˘
 
__evp
,

365 
timî_t
 *
__ª°ri˘
 
__timîid
Ë
__THROW
;

368 
	$timî_dñëe
 (
timî_t
 
__timîid
Ë
__THROW
;

371 
	$timî_£âime
 (
timî_t
 
__timîid
, 
__Êags
,

372 c⁄° 
ôimî•ec
 *
__ª°ri˘
 
__vÆue
,

373 
ôimî•ec
 *
__ª°ri˘
 
__ovÆue
Ë
__THROW
;

376 
	$timî_gëtime
 (
timî_t
 
__timîid
, 
ôimî•ec
 *
__vÆue
)

377 
__THROW
;

380 
	$timî_gëovîrun
 (
timî_t
 
__timîid
Ë
__THROW
;

384 #ifde‡
__USE_ISOC11


386 
	$time•ec_gë
 (
time•ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__n⁄nuŒ
 ((1));

391 #ifde‡
__USE_XOPEN_EXTENDED


403 
gëd©e_îr
;

412 
tm
 *
	`gëd©e
 (c⁄° *
__°rög
);

415 #ifde‡
__USE_GNU


426 
	`gëd©e_r
 (c⁄° *
__ª°ri˘
 
__°rög
,

427 
tm
 *
__ª°ri˘
 
__ªsbuÂ
);

430 
__END_DECLS


	@/usr/include/unistd.h

22 #i‚def 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


32 #ifde‡
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #ñi‡
deföed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #ñi‡
deföed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #ñi‡
deföed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifde‡
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #ñi‡
deföed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #ñi‡
deföed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

71 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

75 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

79 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

83 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

86 #ifde‡
__USE_XOPEN2K8


87 
	#_XOPEN_VERSION
 700

	)

88 #ñi‡
deföed
 
__USE_XOPEN2K


89 
	#_XOPEN_VERSION
 600

	)

90 #ñi‡
deföed
 
__USE_UNIX98


91 
	#_XOPEN_VERSION
 500

	)

93 
	#_XOPEN_VERSION
 4

	)

97 
	#_XOPEN_XCU_VERSION
 4

	)

100 
	#_XOPEN_XPG2
 1

	)

101 
	#_XOPEN_XPG3
 1

	)

102 
	#_XOPEN_XPG4
 1

	)

105 
	#_XOPEN_UNIX
 1

	)

108 
	#_XOPEN_CRYPT
 1

	)

112 
	#_XOPEN_ENH_I18N
 1

	)

115 
	#_XOPEN_LEGACY
 1

	)

202 
	~<bôs/posix_›t.h
>

205 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


206 
	~<bôs/ívú⁄míts.h
>

210 
	#STDIN_FILENO
 0

	)

211 
	#STDOUT_FILENO
 1

	)

212 
	#STDERR_FILENO
 2

	)

217 
	~<bôs/ty≥s.h
>

219 #i‚def 
__ssize_t_deföed


220 
__ssize_t
 
	tssize_t
;

221 
	#__ssize_t_deföed


	)

224 
	#__√ed_size_t


	)

225 
	#__√ed_NULL


	)

226 
	~<°ddef.h
>

228 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


231 #i‚de‡
__gid_t_deföed


232 
__gid_t
 
	tgid_t
;

233 
	#__gid_t_deföed


	)

236 #i‚de‡
__uid_t_deföed


237 
__uid_t
 
	tuid_t
;

238 
	#__uid_t_deföed


	)

241 #i‚de‡
__off_t_deföed


242 #i‚de‡
__USE_FILE_OFFSET64


243 
__off_t
 
	toff_t
;

245 
__off64_t
 
	toff_t
;

247 
	#__off_t_deföed


	)

249 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


250 
__off64_t
 
	toff64_t
;

251 
	#__off64_t_deföed


	)

254 #i‚de‡
__u£c⁄ds_t_deföed


255 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

256 
	#__u£c⁄ds_t_deföed


	)

259 #i‚de‡
__pid_t_deföed


260 
__pid_t
 
	tpid_t
;

261 
	#__pid_t_deföed


	)

265 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


266 #i‚de‡
__öçå_t_deföed


267 
__öçå_t
 
	töçå_t
;

268 
	#__öçå_t_deföed


	)

272 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


273 #i‚de‡
__sockÀn_t_deföed


274 
__sockÀn_t
 
	tsockÀn_t
;

275 
	#__sockÀn_t_deföed


	)

281 
	#R_OK
 4

	)

282 
	#W_OK
 2

	)

283 
	#X_OK
 1

	)

284 
	#F_OK
 0

	)

287 
	$ac˚ss
 (c⁄° *
__«me
, 
__ty≥
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

289 #ifde‡
__USE_GNU


292 
	$euidac˚ss
 (c⁄° *
__«me
, 
__ty≥
)

293 
__THROW
 
	`__n⁄nuŒ
 ((1));

296 
	$óc˚ss
 (c⁄° *
__«me
, 
__ty≥
)

297 
__THROW
 
	`__n⁄nuŒ
 ((1));

300 #ifde‡
__USE_ATFILE


304 
	$Ác˚sßt
 (
__fd
, c⁄° *
__fûe
, 
__ty≥
, 
__Êag
)

305 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

310 #i‚def 
_STDIO_H


311 
	#SEEK_SET
 0

	)

312 
	#SEEK_CUR
 1

	)

313 
	#SEEK_END
 2

	)

314 #ifde‡
__USE_GNU


315 
	#SEEK_DATA
 3

	)

316 
	#SEEK_HOLE
 4

	)

320 #i‡
deföed
 
__USE_BSD
 && !deföed 
L_SET


322 
	#L_SET
 
SEEK_SET


	)

323 
	#L_INCR
 
SEEK_CUR


	)

324 
	#L_XTND
 
SEEK_END


	)

333 #i‚de‡
__USE_FILE_OFFSET64


334 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__whí˚
Ë
__THROW
;

336 #ifde‡
__REDIRECT_NTH


337 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

338 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
),

339 
l£ek64
);

341 
	#l£ek
 
l£ek64


	)

344 #ifde‡
__USE_LARGEFILE64


345 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
)

346 
__THROW
;

353 
	`˛o£
 (
__fd
);

360 
ssize_t
 
	$ªad
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
Ë
__wur
;

366 
ssize_t
 
	$wrôe
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
Ë
__wur
;

368 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


369 #i‚de‡
__USE_FILE_OFFSET64


376 
ssize_t
 
	$¥ód
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

377 
__off_t
 
__off£t
Ë
__wur
;

384 
ssize_t
 
	$pwrôe
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

385 
__off_t
 
__off£t
Ë
__wur
;

387 #ifde‡
__REDIRECT


388 
ssize_t
 
	`__REDIRECT
 (
¥ód
, (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

389 
__off64_t
 
__off£t
),

390 
¥ód64
Ë
__wur
;

391 
ssize_t
 
	`__REDIRECT
 (
pwrôe
, (
__fd
, c⁄° *
__buf
,

392 
size_t
 
__nbyãs
, 
__off64_t
 
__off£t
),

393 
pwrôe64
Ë
__wur
;

395 
	#¥ód
 
¥ód64


	)

396 
	#pwrôe
 
pwrôe64


	)

400 #ifde‡
__USE_LARGEFILE64


404 
ssize_t
 
	$¥ód64
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

405 
__off64_t
 
__off£t
Ë
__wur
;

408 
ssize_t
 
	$pwrôe64
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

409 
__off64_t
 
__off£t
Ë
__wur
;

417 
	$pùe
 (
__pùedes
[2]Ë
__THROW
 
__wur
;

419 #ifde‡
__USE_GNU


422 
	$pùe2
 (
__pùedes
[2], 
__Êags
Ë
__THROW
 
__wur
;

432 
	$Æ¨m
 (
__£c⁄ds
Ë
__THROW
;

444 
	`¶ìp
 (
__£c⁄ds
);

446 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

447 || 
deföed
 
__USE_BSD


452 
__u£c⁄ds_t
 
	$uÆ¨m
 (
__u£c⁄ds_t
 
__vÆue
, __u£c⁄ds_à
__öãrvÆ
)

453 
__THROW
;

460 
	`u¶ìp
 (
__u£c⁄ds_t
 
__u£c⁄ds
);

469 
	`∑u£
 ();

473 
	$chown
 (c⁄° *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

474 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

476 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


478 
	$fchown
 (
__fd
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
Ë
__THROW
 
__wur
;

483 
	$lchown
 (c⁄° *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

484 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

488 #ifde‡
__USE_ATFILE


491 
	$fchow«t
 (
__fd
, c⁄° *
__fûe
, 
__uid_t
 
__ow√r
,

492 
__gid_t
 
__group
, 
__Êag
)

493 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

497 
	$chdú
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

499 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


501 
	$fchdú
 (
__fd
Ë
__THROW
 
__wur
;

511 *
	$gëcwd
 (*
__buf
, 
size_t
 
__size
Ë
__THROW
 
__wur
;

513 #ifdef 
__USE_GNU


517 *
	$gë_cuºít_dú_«me
 (Ë
__THROW
;

520 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

521 || 
deföed
 
__USE_BSD


525 *
	$gëwd
 (*
__buf
)

526 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
 
__wur
;

531 
	$dup
 (
__fd
Ë
__THROW
 
__wur
;

534 
	$dup2
 (
__fd
, 
__fd2
Ë
__THROW
;

536 #ifde‡
__USE_GNU


539 
	$dup3
 (
__fd
, 
__fd2
, 
__Êags
Ë
__THROW
;

543 **
__ívú⁄
;

544 #ifde‡
__USE_GNU


545 **
ívú⁄
;

551 
	$execve
 (c⁄° *
__∑th
, *c⁄° 
__¨gv
[],

552 *c⁄° 
__ívp
[]Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

554 #ifde‡
__USE_XOPEN2K8


557 
	$„xecve
 (
__fd
, *c⁄° 
__¨gv
[], *c⁄° 
__ívp
[])

558 
__THROW
 
	`__n⁄nuŒ
 ((2));

563 
	$execv
 (c⁄° *
__∑th
, *c⁄° 
__¨gv
[])

564 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

568 
	$exe˛e
 (c⁄° *
__∑th
, c⁄° *
__¨g
, ...)

569 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

573 
	$exe˛
 (c⁄° *
__∑th
, c⁄° *
__¨g
, ...)

574 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

578 
	$execvp
 (c⁄° *
__fûe
, *c⁄° 
__¨gv
[])

579 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

584 
	$exe˛p
 (c⁄° *
__fûe
, c⁄° *
__¨g
, ...)

585 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

587 #ifde‡
__USE_GNU


590 
	$execv≥
 (c⁄° *
__fûe
, *c⁄° 
__¨gv
[],

591 *c⁄° 
__ívp
[])

592 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

596 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


598 
	$ni˚
 (
__öc
Ë
__THROW
 
__wur
;

603 
	$_exô
 (
__°©us
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

609 
	~<bôs/c⁄‚ame.h
>

612 
	$∑thc⁄f
 (c⁄° *
__∑th
, 
__«me
)

613 
__THROW
 
	`__n⁄nuŒ
 ((1));

616 
	$Â©hc⁄f
 (
__fd
, 
__«me
Ë
__THROW
;

619 
	$sysc⁄f
 (
__«me
Ë
__THROW
;

621 #ifdef 
__USE_POSIX2


623 
size_t
 
	$c⁄f°r
 (
__«me
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

628 
__pid_t
 
	$gëpid
 (Ë
__THROW
;

631 
__pid_t
 
	$gëµid
 (Ë
__THROW
;

634 
__pid_t
 
	$gëpgΩ
 (Ë
__THROW
;

637 
__pid_t
 
	$__gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

638 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


639 
__pid_t
 
	$gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

646 
	$£çgid
 (
__pid_t
 
__pid
, __pid_à
__pgid
Ë
__THROW
;

648 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


660 
	$£çgΩ
 (Ë
__THROW
;

667 
__pid_t
 
	$£tsid
 (Ë
__THROW
;

669 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


671 
__pid_t
 
	$gësid
 (
__pid_t
 
__pid
Ë
__THROW
;

675 
__uid_t
 
	$gëuid
 (Ë
__THROW
;

678 
__uid_t
 
	$gëeuid
 (Ë
__THROW
;

681 
__gid_t
 
	$gëgid
 (Ë
__THROW
;

684 
__gid_t
 
	$gëegid
 (Ë
__THROW
;

689 
	$gëgroups
 (
__size
, 
__gid_t
 
__li°
[]Ë
__THROW
 
__wur
;

691 #ifdef 
__USE_GNU


693 
	$group_membî
 (
__gid_t
 
__gid
Ë
__THROW
;

700 
	$£tuid
 (
__uid_t
 
__uid
Ë
__THROW
 
__wur
;

702 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


705 
	$£åeuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
Ë
__THROW
 
__wur
;

708 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


710 
	$£ãuid
 (
__uid_t
 
__uid
Ë
__THROW
 
__wur
;

717 
	$£tgid
 (
__gid_t
 
__gid
Ë
__THROW
 
__wur
;

719 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


722 
	$£åegid
 (
__gid_t
 
__rgid
, __gid_à
__egid
Ë
__THROW
 
__wur
;

725 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


727 
	$£ãgid
 (
__gid_t
 
__gid
Ë
__THROW
 
__wur
;

730 #ifde‡
__USE_GNU


733 
	$gëªsuid
 (
__uid_t
 *
__ruid
, __uid_à*
__euid
, __uid_à*
__suid
)

734 
__THROW
;

738 
	$gëªsgid
 (
__gid_t
 *
__rgid
, __gid_à*
__egid
, __gid_à*
__sgid
)

739 
__THROW
;

743 
	$£åesuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
, __uid_à
__suid
)

744 
__THROW
 
__wur
;

748 
	$£åesgid
 (
__gid_t
 
__rgid
, __gid_à
__egid
, __gid_à
__sgid
)

749 
__THROW
 
__wur
;

756 
__pid_t
 
	$f‹k
 (Ë
__THROWNL
;

758 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

759 || 
deföed
 
__USE_BSD


764 
__pid_t
 
	$vf‹k
 (Ë
__THROW
;

770 *
	$ây«me
 (
__fd
Ë
__THROW
;

774 
	$ây«me_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

775 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

779 
	$ißây
 (
__fd
Ë
__THROW
;

781 #i‡
deföed
 
__USE_BSD
 \

782 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_UNIX98
)

785 
	$ây¶Ÿ
 (Ë
__THROW
;

790 
	$lök
 (c⁄° *
__‰om
, c⁄° *
__to
)

791 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

793 #ifde‡
__USE_ATFILE


796 
	$lök©
 (
__‰omfd
, c⁄° *
__‰om
, 
__tofd
,

797 c⁄° *
__to
, 
__Êags
)

798 
__THROW
 
	`__n⁄nuŒ
 ((2, 4)Ë
__wur
;

801 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


803 
	$symlök
 (c⁄° *
__‰om
, c⁄° *
__to
)

804 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

809 
ssize_t
 
	$ªadlök
 (c⁄° *
__ª°ri˘
 
__∑th
,

810 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

811 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

814 #ifde‡
__USE_ATFILE


816 
	$symlök©
 (c⁄° *
__‰om
, 
__tofd
,

817 c⁄° *
__to
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

820 
ssize_t
 
	$ªadlök©
 (
__fd
, c⁄° *
__ª°ri˘
 
__∑th
,

821 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

822 
__THROW
 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
;

826 
	$u∆ök
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

828 #ifde‡
__USE_ATFILE


830 
	$u∆ök©
 (
__fd
, c⁄° *
__«me
, 
__Êag
)

831 
__THROW
 
	`__n⁄nuŒ
 ((2));

835 
	$rmdú
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

839 
__pid_t
 
	$tcgëpgΩ
 (
__fd
Ë
__THROW
;

842 
	$tc£çgΩ
 (
__fd
, 
__pid_t
 
__pgΩ_id
Ë
__THROW
;

849 *
	`gëlogö
 ();

850 #i‡
deföed
 
__USE_REENTRANT
 || deföed 
__USE_POSIX199506


857 
	$gëlogö_r
 (*
__«me
, 
size_t
 
__«me_Àn
Ë
	`__n⁄nuŒ
 ((1));

860 #ifdef 
__USE_BSD


862 
	$£éogö
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

866 #ifdef 
__USE_POSIX2


870 
	#__√ed_gë›t


	)

871 
	~<gë›t.h
>

875 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


879 
	$gëho°«me
 (*
__«me
, 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

883 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_UNIX98
)

886 
	$£tho°«me
 (c⁄° *
__«me
, 
size_t
 
__Àn
)

887 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

891 
	$£tho°id
 (
__id
Ë
__THROW
 
__wur
;

897 
	$gëdomaö«me
 (*
__«me
, 
size_t
 
__Àn
)

898 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

899 
	$£tdomaö«me
 (c⁄° *
__«me
, 
size_t
 
__Àn
)

900 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

906 
	$vh™gup
 (Ë
__THROW
;

909 
	$ªvoke
 (c⁄° *
__fûe
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

917 
	$¥ofû
 (*
__ßm∂e_buf„r
, 
size_t
 
__size
,

918 
size_t
 
__off£t
, 
__sˇÀ
)

919 
__THROW
 
	`__n⁄nuŒ
 ((1));

925 
	$ac˘
 (c⁄° *
__«me
Ë
__THROW
;

929 *
	$gëu£rshñl
 (Ë
__THROW
;

930 
	$ídu£rshñl
 (Ë
__THROW
;

931 
	$£tu£rshñl
 (Ë
__THROW
;

937 
	$d´m⁄
 (
__nochdú
, 
__no˛o£
Ë
__THROW
 
__wur
;

941 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

944 
	$chroŸ
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

948 *
	$gë∑ss
 (c⁄° *
__¥om±
Ë
	`__n⁄nuŒ
 ((1));

956 
	`fsync
 (
__fd
);

959 #ifde‡
__USE_GNU


962 
	$syncfs
 (
__fd
Ë
__THROW
;

966 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


969 
	`gëho°id
 ();

972 
	$sync
 (Ë
__THROW
;

975 #i‡
deföed
 
__USE_BSD
 || !deföed 
__USE_XOPEN2K


978 
	$gë∑gesize
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

983 
	$gëdèbÀsize
 (Ë
__THROW
;

989 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


992 #i‚de‡
__USE_FILE_OFFSET64


993 
	$åunˇã
 (c⁄° *
__fûe
, 
__off_t
 
__Àngth
)

994 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

996 #ifde‡
__REDIRECT_NTH


997 
	`__REDIRECT_NTH
 (
åunˇã
,

998 (c⁄° *
__fûe
, 
__off64_t
 
__Àngth
),

999 
åunˇã64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1001 
	#åunˇã
 
åunˇã64


	)

1004 #ifde‡
__USE_LARGEFILE64


1005 
	$åunˇã64
 (c⁄° *
__fûe
, 
__off64_t
 
__Àngth
)

1006 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1011 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_POSIX199309
 \

1012 || 
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


1015 #i‚de‡
__USE_FILE_OFFSET64


1016 
	$·runˇã
 (
__fd
, 
__off_t
 
__Àngth
Ë
__THROW
 
__wur
;

1018 #ifde‡
__REDIRECT_NTH


1019 
	`__REDIRECT_NTH
 (
·runˇã
, (
__fd
, 
__off64_t
 
__Àngth
),

1020 
·runˇã64
Ë
__wur
;

1022 
	#·runˇã
 
·runˇã64


	)

1025 #ifde‡
__USE_LARGEFILE64


1026 
	$·runˇã64
 (
__fd
, 
__off64_t
 
__Àngth
Ë
__THROW
 
__wur
;

1032 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

1033 || 
deföed
 
__USE_MISC


1037 
	$brk
 (*
__addr
Ë
__THROW
 
__wur
;

1043 *
	$sbrk
 (
öçå_t
 
__dñè
Ë
__THROW
;

1047 #ifde‡
__USE_MISC


1058 
	$sysˇŒ
 (
__sy¢o
, ...Ë
__THROW
;

1063 #i‡(
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
Ë&& !deföed 
F_LOCK


1075 
	#F_ULOCK
 0

	)

1076 
	#F_LOCK
 1

	)

1077 
	#F_TLOCK
 2

	)

1078 
	#F_TEST
 3

	)

1080 #i‚de‡
__USE_FILE_OFFSET64


1081 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Àn
Ë
__wur
;

1083 #ifde‡
__REDIRECT


1084 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
),

1085 
lockf64
Ë
__wur
;

1087 
	#lockf
 
lockf64


	)

1090 #ifde‡
__USE_LARGEFILE64


1091 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
Ë
__wur
;

1096 #ifde‡
__USE_GNU


1101 
	#TEMP_FAILURE_RETRY
(
ex¥essi⁄
) \

1102 (
__exãnsi⁄__
 \

1103 ({ 
__ªsu…
; \

1104 dÿ
__ªsu…
 = (Ë(
ex¥essi⁄
); \

1105 
__ªsu…
 =-1L && 
î∫o
 =
EINTR
); \

1106 
__ªsu…
; 
	}
}))

	)

1109 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_UNIX98


1112 
fd©async
 (
__fûdes
);

1118 #ifdef 
__USE_XOPEN


1120 *
	$¸y±
 (c⁄° *
__key
, c⁄° *
__ß…
)

1121 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1125 
	$í¸y±
 (*
__glibc_block
, 
__edÊag
)

1126 
__THROW
 
	`__n⁄nuŒ
 ((1));

1133 
	$swab
 (c⁄° *
__ª°ri˘
 
__‰om
, *__ª°ri˘ 
__to
,

1134 
ssize_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1140 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K


1142 *
	$˘îmid
 (*
__s
Ë
__THROW
;

1147 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


1148 
	~<bôs/uni°d.h
>

1151 
__END_DECLS


	@/usr/include/endian.h

18 #i‚def 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<„©uªs.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<bôs/ídün.h
>

40 #i‚de‡
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_BSD


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËLO, 
	)
HI

53 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËHI, 
	)
LO

58 #i‡
deföed
 
__USE_BSD
 && !deföed 
__ASSEMBLER__


60 
	~<bôs/byãsw≠.h
>

62 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


63 
	#htobe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

64 
	#htﬁe16
(
x
Ë(x)

	)

65 
	#be16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

66 
	#À16toh
(
x
Ë(x)

	)

68 
	#htobe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

69 
	#htﬁe32
(
x
Ë(x)

	)

70 
	#be32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

71 
	#À32toh
(
x
Ë(x)

	)

73 
	#htobe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

74 
	#htﬁe64
(
x
Ë(x)

	)

75 
	#be64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

76 
	#À64toh
(
x
Ë(x)

	)

79 
	#htobe16
(
x
Ë(x)

	)

80 
	#htﬁe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

81 
	#be16toh
(
x
Ë(x)

	)

82 
	#À16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

84 
	#htobe32
(
x
Ë(x)

	)

85 
	#htﬁe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

86 
	#be32toh
(
x
Ë(x)

	)

87 
	#À32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

89 
	#htobe64
(
x
Ë(x)

	)

90 
	#htﬁe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

91 
	#be64toh
(
x
Ë(x)

	)

92 
	#À64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

	@/usr/include/features.h

18 #i‚def 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

101 #unde‡
__USE_ISOC11


102 #unde‡
__USE_ISOC99


103 #unde‡
__USE_ISOC95


104 #unde‡
__USE_ISOCXX11


105 #unde‡
__USE_POSIX


106 #unde‡
__USE_POSIX2


107 #unde‡
__USE_POSIX199309


108 #unde‡
__USE_POSIX199506


109 #unde‡
__USE_XOPEN


110 #unde‡
__USE_XOPEN_EXTENDED


111 #unde‡
__USE_UNIX98


112 #unde‡
__USE_XOPEN2K


113 #unde‡
__USE_XOPEN2KXSI


114 #unde‡
__USE_XOPEN2K8


115 #unde‡
__USE_XOPEN2K8XSI


116 #unde‡
__USE_LARGEFILE


117 #unde‡
__USE_LARGEFILE64


118 #unde‡
__USE_FILE_OFFSET64


119 #unde‡
__USE_BSD


120 #unde‡
__USE_SVID


121 #unde‡
__USE_MISC


122 #unde‡
__USE_ATFILE


123 #unde‡
__USE_GNU


124 #unde‡
__USE_REENTRANT


125 #unde‡
__USE_FORTIFY_LEVEL


126 #unde‡
__KERNEL_STRICT_NAMES


130 #i‚de‡
_LOOSE_KERNEL_NAMES


131 
	#__KERNEL_STRICT_NAMES


	)

141 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


142 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

143 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

145 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

150 #ifde‡
_GNU_SOURCE


151 #unde‡
_ISOC95_SOURCE


152 
	#_ISOC95_SOURCE
 1

	)

153 #unde‡
_ISOC99_SOURCE


154 
	#_ISOC99_SOURCE
 1

	)

155 #unde‡
_ISOC11_SOURCE


156 
	#_ISOC11_SOURCE
 1

	)

157 #unde‡
_POSIX_SOURCE


158 
	#_POSIX_SOURCE
 1

	)

159 #unde‡
_POSIX_C_SOURCE


160 
	#_POSIX_C_SOURCE
 200809L

	)

161 #unde‡
_XOPEN_SOURCE


162 
	#_XOPEN_SOURCE
 700

	)

163 #unde‡
_XOPEN_SOURCE_EXTENDED


164 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

165 #unde‡
_LARGEFILE64_SOURCE


166 
	#_LARGEFILE64_SOURCE
 1

	)

167 #unde‡
_DEFAULT_SOURCE


168 
	#_DEFAULT_SOURCE
 1

	)

169 #unde‡
_BSD_SOURCE


170 
	#_BSD_SOURCE
 1

	)

171 #unde‡
_SVID_SOURCE


172 
	#_SVID_SOURCE
 1

	)

173 #unde‡
_ATFILE_SOURCE


174 
	#_ATFILE_SOURCE
 1

	)

179 #i‡(
deföed
 
_DEFAULT_SOURCE
 \

180 || (!
deföed
 
	g__STRICT_ANSI__
 \

181 && !
deföed
 
	g_ISOC99_SOURCE
 \

182 && !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 \

183 && !
deföed
 
	g_XOPEN_SOURCE
 \

184 && !
deföed
 
	g_BSD_SOURCE
 && !deföed 
	g_SVID_SOURCE
))

185 #unde‡
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

187 #unde‡
_BSD_SOURCE


188 
	#_BSD_SOURCE
 1

	)

189 #unde‡
_SVID_SOURCE


190 
	#_SVID_SOURCE
 1

	)

194 #i‡(
deföed
 
_ISOC11_SOURCE
 \

195 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

196 
	#__USE_ISOC11
 1

	)

200 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

201 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

202 
	#__USE_ISOC99
 1

	)

206 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

207 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

208 
	#__USE_ISOC95
 1

	)

215 #i‡((
deföed
 
__˝lu•lus
 && __cplusplus >= 201103L) \

216 || 
deföed
 
__GXX_EXPERIMENTAL_CXX0X__
)

217 
	#__USE_ISOCXX11
 1

	)

223 #ifde‡
_DEFAULT_SOURCE


224 #i‡!
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE


225 
	#__USE_POSIX_IMPLICITLY
 1

	)

227 #unde‡
_POSIX_SOURCE


228 
	#_POSIX_SOURCE
 1

	)

229 #unde‡
_POSIX_C_SOURCE


230 
	#_POSIX_C_SOURCE
 200809L

	)

232 #i‡((!
deföed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

233 !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

234 
	#_POSIX_SOURCE
 1

	)

235 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

236 
	#_POSIX_C_SOURCE
 2

	)

237 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

238 
	#_POSIX_C_SOURCE
 199506L

	)

239 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

240 
	#_POSIX_C_SOURCE
 200112L

	)

242 
	#_POSIX_C_SOURCE
 200809L

	)

244 
	#__USE_POSIX_IMPLICITLY
 1

	)

247 #i‡
deföed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >1 || deföed 
_XOPEN_SOURCE


248 
	#__USE_POSIX
 1

	)

251 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


252 
	#__USE_POSIX2
 1

	)

255 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199309L

256 
	#__USE_POSIX199309
 1

	)

259 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199506L

260 
	#__USE_POSIX199506
 1

	)

263 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200112L

264 
	#__USE_XOPEN2K
 1

	)

265 #unde‡
__USE_ISOC95


266 
	#__USE_ISOC95
 1

	)

267 #unde‡
__USE_ISOC99


268 
	#__USE_ISOC99
 1

	)

271 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200809L

272 
	#__USE_XOPEN2K8
 1

	)

273 #unde‡
_ATFILE_SOURCE


274 
	#_ATFILE_SOURCE
 1

	)

277 #ifdef 
_XOPEN_SOURCE


278 
	#__USE_XOPEN
 1

	)

279 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

280 
	#__USE_XOPEN_EXTENDED
 1

	)

281 
	#__USE_UNIX98
 1

	)

282 #unde‡
_LARGEFILE_SOURCE


283 
	#_LARGEFILE_SOURCE
 1

	)

284 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

285 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

286 
	#__USE_XOPEN2K8
 1

	)

287 
	#__USE_XOPEN2K8XSI
 1

	)

289 
	#__USE_XOPEN2K
 1

	)

290 
	#__USE_XOPEN2KXSI
 1

	)

291 #unde‡
__USE_ISOC95


292 
	#__USE_ISOC95
 1

	)

293 #unde‡
__USE_ISOC99


294 
	#__USE_ISOC99
 1

	)

297 #ifde‡
_XOPEN_SOURCE_EXTENDED


298 
	#__USE_XOPEN_EXTENDED
 1

	)

303 #ifde‡
_LARGEFILE_SOURCE


304 
	#__USE_LARGEFILE
 1

	)

307 #ifde‡
_LARGEFILE64_SOURCE


308 
	#__USE_LARGEFILE64
 1

	)

311 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

312 
	#__USE_FILE_OFFSET64
 1

	)

315 #i‡
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE


316 
	#__USE_MISC
 1

	)

319 #ifdef 
_BSD_SOURCE


320 
	#__USE_BSD
 1

	)

323 #ifdef 
_SVID_SOURCE


324 
	#__USE_SVID
 1

	)

327 #ifdef 
_ATFILE_SOURCE


328 
	#__USE_ATFILE
 1

	)

331 #ifdef 
_GNU_SOURCE


332 
	#__USE_GNU
 1

	)

335 #i‡
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE


336 
	#__USE_REENTRANT
 1

	)

339 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

340 && 
__GNUC_PREREQ
 (4, 1Ë&& 
deföed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

341 #i‡
_FORTIFY_SOURCE
 > 1

342 
	#__USE_FORTIFY_LEVEL
 2

	)

344 
	#__USE_FORTIFY_LEVEL
 1

	)

347 
	#__USE_FORTIFY_LEVEL
 0

	)

352 
	~<°dc-¥edef.h
>

360 #unde‡
__GNU_LIBRARY__


361 
	#__GNU_LIBRARY__
 6

	)

365 
	#__GLIBC__
 2

	)

366 
	#__GLIBC_MINOR__
 19

	)

368 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

369 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

372 #i‚de‡
__ASSEMBLER__


373 #i‚de‡
_SYS_CDEFS_H


374 
	~<sys/cdefs.h
>

379 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


380 
	#__USE_LARGEFILE
 1

	)

381 
	#__USE_LARGEFILE64
 1

	)

387 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

388 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

389 && 
deföed
 
	g__exã∫_ölöe


390 
	#__USE_EXTERN_INLINES
 1

	)

398 
	~<gnu/°ubs.h
>

	@/usr/include/getopt.h

19 #i‚de‡
_GETOPT_H


21 #i‚de‡
__√ed_gë›t


22 
	#_GETOPT_H
 1

	)

32 #i‡!
deföed
 
__GNU_LIBRARY__


33 
	~<˘y≥.h
>

36 #i‚de‡
__THROW


37 #i‚de‡
__GNUC_PREREQ


38 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë(0)

	)

40 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

41 
	#__THROW
 
	`throw
 ()

	)

43 
	#__THROW


	)

47 #ifdef 
__˝lu•lus


57 *
›èrg
;

71 
›töd
;

76 
›ãº
;

80 
›t›t
;

82 #i‚de‡
__√ed_gë›t


104 
	s›ti⁄


106 c⁄° *
	g«me
;

109 
	ghas_¨g
;

110 *
	gÊag
;

111 
	gvÆ
;

116 
	#no_¨gumít
 0

	)

117 
	#ªquúed_¨gumít
 1

	)

118 
	#›ti⁄Æ_¨gumít
 2

	)

146 #ifde‡
__GNU_LIBRARY__


150 
gë›t
 (
___¨gc
, *c⁄° *
___¨gv
, c⁄° *
__sh‹t›ts
)

151 
__THROW
;

153 #i‡
deföed
 
__√ed_gë›t
 && deföed 
__USE_POSIX2
 \

154 && !
deföed
 
	g__USE_POSIX_IMPLICITLY
 && !deföed 
	g__USE_GNU


158 #ifde‡
__REDIRECT


159 
__REDIRECT_NTH
 (
gë›t
, (
___¨gc
, *c⁄° *
___¨gv
,

160 c⁄° *
__sh‹t›ts
),

161 
__posix_gë›t
);

163 
__posix_gë›t
 (
___¨gc
, *c⁄° *
___¨gv
,

164 c⁄° *
__sh‹t›ts
Ë
__THROW
;

165 
	#gë›t
 
__posix_gë›t


	)

169 
gë›t
 ();

172 #i‚de‡
__√ed_gë›t


173 
gë›t_l⁄g
 (
___¨gc
, *c⁄° *
___¨gv
,

174 c⁄° *
__sh‹t›ts
,

175 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

176 
__THROW
;

177 
gë›t_l⁄g_⁄ly
 (
___¨gc
, *c⁄° *
___¨gv
,

178 c⁄° *
__sh‹t›ts
,

179 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

180 
__THROW
;

184 #ifdef 
__˝lu•lus


189 #unde‡
__√ed_gë›t


	@/usr/include/libio.h

28 #i‚de‡
_IO_STDIO_H


29 
	#_IO_STDIO_H


	)

31 
	~<_G_c⁄fig.h
>

33 
	#_IO_Âos_t
 
_G_Âos_t


	)

34 
	#_IO_Âos64_t
 
_G_Âos64_t


	)

35 
	#_IO_size_t
 
size_t


	)

36 
	#_IO_ssize_t
 
__ssize_t


	)

37 
	#_IO_off_t
 
__off_t


	)

38 
	#_IO_off64_t
 
__off64_t


	)

39 
	#_IO_pid_t
 
__pid_t


	)

40 
	#_IO_uid_t
 
__uid_t


	)

41 
	#_IO_ic⁄v_t
 
_G_ic⁄v_t


	)

42 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

43 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

44 
	#_IO_va_li°
 
_G_va_li°


	)

45 
	#_IO_wöt_t
 
wöt_t


	)

48 
	#__√ed___va_li°


	)

49 
	~<°d¨g.h
>

50 #ifde‡
__GNUC_VA_LIST


51 #unde‡
_IO_va_li°


52 
	#_IO_va_li°
 
__gnuc_va_li°


	)

55 #i‚de‡
__P


56 
	~<sys/cdefs.h
>

59 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

61 #i‚de‡
EOF


62 
	#EOF
 (-1)

	)

64 #i‚de‡
NULL


65 #i‡
deföed
 
__GNUG__
 && \

66 (
	g__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 >= 8))

67 
	#NULL
 (
__nuŒ
)

	)

69 #i‡!
deföed
(
__˝lu•lus
)

70 
	#NULL
 ((*)0)

	)

72 
	#NULL
 (0)

	)

77 
	#_IOS_INPUT
 1

	)

78 
	#_IOS_OUTPUT
 2

	)

79 
	#_IOS_ATEND
 4

	)

80 
	#_IOS_APPEND
 8

	)

81 
	#_IOS_TRUNC
 16

	)

82 
	#_IOS_NOCREATE
 32

	)

83 
	#_IOS_NOREPLACE
 64

	)

84 
	#_IOS_BIN
 128

	)

92 
	#_IO_MAGIC
 0xFBAD0000

	)

93 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

94 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

95 
	#_IO_USER_BUF
 1

	)

96 
	#_IO_UNBUFFERED
 2

	)

97 
	#_IO_NO_READS
 4

	)

98 
	#_IO_NO_WRITES
 8

	)

99 
	#_IO_EOF_SEEN
 0x10

	)

100 
	#_IO_ERR_SEEN
 0x20

	)

101 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

102 
	#_IO_LINKED
 0x80

	)

103 
	#_IO_IN_BACKUP
 0x100

	)

104 
	#_IO_LINE_BUF
 0x200

	)

105 
	#_IO_TIED_PUT_GET
 0x400

	)

106 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

107 
	#_IO_IS_APPENDING
 0x1000

	)

108 
	#_IO_IS_FILEBUF
 0x2000

	)

109 
	#_IO_BAD_SEEN
 0x4000

	)

110 
	#_IO_USER_LOCK
 0x8000

	)

112 
	#_IO_FLAGS2_MMAP
 1

	)

113 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

114 #ifde‡
_LIBC


115 
	#_IO_FLAGS2_FORTIFY
 4

	)

117 
	#_IO_FLAGS2_USER_WBUF
 8

	)

118 #ifde‡
_LIBC


119 
	#_IO_FLAGS2_SCANF_STD
 16

	)

120 
	#_IO_FLAGS2_NOCLOSE
 32

	)

121 
	#_IO_FLAGS2_CLOEXEC
 64

	)

125 
	#_IO_SKIPWS
 01

	)

126 
	#_IO_LEFT
 02

	)

127 
	#_IO_RIGHT
 04

	)

128 
	#_IO_INTERNAL
 010

	)

129 
	#_IO_DEC
 020

	)

130 
	#_IO_OCT
 040

	)

131 
	#_IO_HEX
 0100

	)

132 
	#_IO_SHOWBASE
 0200

	)

133 
	#_IO_SHOWPOINT
 0400

	)

134 
	#_IO_UPPERCASE
 01000

	)

135 
	#_IO_SHOWPOS
 02000

	)

136 
	#_IO_SCIENTIFIC
 04000

	)

137 
	#_IO_FIXED
 010000

	)

138 
	#_IO_UNITBUF
 020000

	)

139 
	#_IO_STDIO
 040000

	)

140 
	#_IO_DONT_CLOSE
 0100000

	)

141 
	#_IO_BOOLALPHA
 0200000

	)

144 
_IO_jump_t
; 
	g_IO_FILE
;

147 #ifde‡
_IO_MTSAFE_IO


148 #i‡
deföed
 
__GLIBC__
 && __GLIBC__ >= 2

149 
	~<bôs/°dio-lock.h
>

154 
	t_IO_lock_t
;

160 
	s_IO_m¨kî
 {

161 
_IO_m¨kî
 *
	m_√xt
;

162 
_IO_FILE
 *
	m_sbuf
;

166 
	m_pos
;

168 
£t_°ªampos
(
°ªampos
 
•
Ë{ 
	m_•os
 = sp; }

169 
£t_off£t
(
off£t
Ë{ 
	m_pos
 = off£t; 
	m_•os
 = (
°ªampos
)(-2); }

170 
	mpublic
:

171 
°ªamm¨kî
(
°ªambuf
 *
sb
);

172 ~
°ªamm¨kî
();

173 
ßvög
(Ë{  
	m_•os
 == -2; }

174 
dñè
(
°ªamm¨kî
&);

175 
dñè
();

180 
	e__codecvt_ªsu…


182 
	m__codecvt_ok
,

183 
	m__codecvt_∑πül
,

184 
	m__codecvt_îr‹
,

185 
	m__codecvt_noc⁄v


188 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


191 
	s_IO_codecvt


193 (*
	m__codecvt_de°r
Ë(
	m_IO_codecvt
 *);

194 
__codecvt_ªsu…
 (*
__codecvt_do_out
Ë(
	m_IO_codecvt
 *,

195 
	m__mb°©e_t
 *,

196 c⁄° 
	mwch¨_t
 *,

197 c⁄° 
	mwch¨_t
 *,

198 c⁄° 
	mwch¨_t
 **, *,

200 
__codecvt_ªsu…
 (*
__codecvt_do_unshi·
Ë(
	m_IO_codecvt
 *,

201 
	m__mb°©e_t
 *, *,

203 
__codecvt_ªsu…
 (*
__codecvt_do_ö
Ë(
	m_IO_codecvt
 *,

204 
	m__mb°©e_t
 *,

206 c⁄° **, 
	mwch¨_t
 *,

207 
	mwch¨_t
 *, wchar_t **);

208 (*
	m__codecvt_do_ícodög
Ë(
	m_IO_codecvt
 *);

209 (*
	m__codecvt_do_Æways_noc⁄v
Ë(
	m_IO_codecvt
 *);

210 (*
	m__codecvt_do_Àngth
Ë(
	m_IO_codecvt
 *, 
	m__mb°©e_t
 *,

211 c⁄° *, c⁄° *, 
	m_IO_size_t
);

212 (*
	m__codecvt_do_max_Àngth
Ë(
	m_IO_codecvt
 *);

214 
_IO_ic⁄v_t
 
	m__cd_ö
;

215 
_IO_ic⁄v_t
 
	m__cd_out
;

219 
	s_IO_wide_d©a


221 
wch¨_t
 *
	m_IO_ªad_±r
;

222 
wch¨_t
 *
	m_IO_ªad_íd
;

223 
wch¨_t
 *
	m_IO_ªad_ba£
;

224 
wch¨_t
 *
	m_IO_wrôe_ba£
;

225 
wch¨_t
 *
	m_IO_wrôe_±r
;

226 
wch¨_t
 *
	m_IO_wrôe_íd
;

227 
wch¨_t
 *
	m_IO_buf_ba£
;

228 
wch¨_t
 *
	m_IO_buf_íd
;

230 
wch¨_t
 *
	m_IO_ßve_ba£
;

231 
wch¨_t
 *
	m_IO_backup_ba£
;

233 
wch¨_t
 *
	m_IO_ßve_íd
;

235 
__mb°©e_t
 
	m_IO_°©e
;

236 
__mb°©e_t
 
	m_IO_œ°_°©e
;

237 
_IO_codecvt
 
	m_codecvt
;

239 
wch¨_t
 
	m_sh‹tbuf
[1];

241 c⁄° 
_IO_jump_t
 *
	m_wide_vèbÀ
;

245 
	s_IO_FILE
 {

246 
	m_Êags
;

247 
	#_IO_fûe_Êags
 
_Êags


	)

251 * 
	m_IO_ªad_±r
;

252 * 
	m_IO_ªad_íd
;

253 * 
	m_IO_ªad_ba£
;

254 * 
	m_IO_wrôe_ba£
;

255 * 
	m_IO_wrôe_±r
;

256 * 
	m_IO_wrôe_íd
;

257 * 
	m_IO_buf_ba£
;

258 * 
	m_IO_buf_íd
;

260 *
	m_IO_ßve_ba£
;

261 *
	m_IO_backup_ba£
;

262 *
	m_IO_ßve_íd
;

264 
_IO_m¨kî
 *
	m_m¨kîs
;

266 
_IO_FILE
 *
	m_chaö
;

268 
	m_fûío
;

270 
	m_blksize
;

272 
	m_Êags2
;

274 
_IO_off_t
 
	m_ﬁd_off£t
;

276 
	#__HAVE_COLUMN


	)

278 
	m_cur_cﬁumn
;

279 sig√d 
	m_vèbÀ_off£t
;

280 
	m_sh‹tbuf
[1];

284 
_IO_lock_t
 *
	m_lock
;

285 #ifde‡
_IO_USE_OLD_IO_FILE


288 
	s_IO_FILE_com∂ëe


290 
_IO_FILE
 
	m_fûe
;

292 #i‡
deföed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

293 
_IO_off64_t
 
	m_off£t
;

294 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


296 
_IO_codecvt
 *
	m_codecvt
;

297 
_IO_wide_d©a
 *
	m_wide_d©a
;

298 
_IO_FILE
 *
	m_‰ìªs_li°
;

299 *
	m_‰ìªs_buf
;

300 
size_t
 
	m_‰ìªs_size
;

302 *
	m__∑d1
;

303 *
	m__∑d2
;

304 *
	m__∑d3
;

305 *
	m__∑d4
;

306 
size_t
 
	m__∑d5
;

308 
	m_mode
;

310 
	m_unu£d2
[15 *  (Ë- 4 *  (*Ë-  (
size_t
)];

314 #i‚de‡
__˝lu•lus


315 
_IO_FILE
 
	t_IO_FILE
;

318 
	g_IO_FILE_∂us
;

320 
_IO_FILE_∂us
 
_IO_2_1_°dö_
;

321 
_IO_FILE_∂us
 
_IO_2_1_°dout_
;

322 
_IO_FILE_∂us
 
_IO_2_1_°dîr_
;

323 #i‚de‡
_LIBC


324 
	#_IO_°dö
 ((
_IO_FILE
*)(&
_IO_2_1_°dö_
))

	)

325 
	#_IO_°dout
 ((
_IO_FILE
*)(&
_IO_2_1_°dout_
))

	)

326 
	#_IO_°dîr
 ((
_IO_FILE
*)(&
_IO_2_1_°dîr_
))

	)

328 
_IO_FILE
 *
_IO_°dö
 
©åibuã_hiddí
;

329 
_IO_FILE
 *
_IO_°dout
 
©åibuã_hiddí
;

330 
_IO_FILE
 *
_IO_°dîr
 
©åibuã_hiddí
;

338 
__ssize_t
 
	t__io_ªad_‚
 (*
	t__cookõ
, *
	t__buf
, 
	tsize_t
 
	t__nbyãs
);

346 
__ssize_t
 
	t__io_wrôe_‚
 (*
	t__cookõ
, c⁄° *
	t__buf
,

347 
	tsize_t
 
	t__n
);

355 
	t__io_£ek_‚
 (*
	t__cookõ
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

358 
	t__io_˛o£_‚
 (*
	t__cookõ
);

361 #ifde‡
_GNU_SOURCE


363 
__io_ªad_‚
 
	tcookõ_ªad_fun˘i⁄_t
;

364 
__io_wrôe_‚
 
	tcookõ_wrôe_fun˘i⁄_t
;

365 
__io_£ek_‚
 
	tcookõ_£ek_fun˘i⁄_t
;

366 
__io_˛o£_‚
 
	tcookõ_˛o£_fun˘i⁄_t
;

371 
__io_ªad_‚
 *
	mªad
;

372 
__io_wrôe_‚
 *
	mwrôe
;

373 
__io_£ek_‚
 *
	m£ek
;

374 
__io_˛o£_‚
 *
	m˛o£
;

375 } 
	t_IO_cookõ_io_fun˘i⁄s_t
;

376 
_IO_cookõ_io_fun˘i⁄s_t
 
	tcookõ_io_fun˘i⁄s_t
;

378 
	g_IO_cookõ_fûe
;

381 
_IO_cookõ_öô
 (
_IO_cookõ_fûe
 *
__cfûe
, 
__ªad_wrôe
,

382 *
__cookõ
, 
_IO_cookõ_io_fun˘i⁄s_t
 
__‚s
);

386 #ifde‡
__˝lu•lus


390 
__undîÊow
 (
_IO_FILE
 *);

391 
__uÊow
 (
_IO_FILE
 *);

392 
__ovîÊow
 (
_IO_FILE
 *, );

393 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


394 
_IO_wöt_t
 
__wundîÊow
 (
_IO_FILE
 *);

395 
_IO_wöt_t
 
__wuÊow
 (
_IO_FILE
 *);

396 
_IO_wöt_t
 
__wovîÊow
 (
_IO_FILE
 *, _IO_wint_t);

399 #i‡ 
__GNUC__
 >= 3

400 
	#_IO_BE
(
ex¥
, 
ªs
Ë
	`__buûtö_ex≥˘
 (”x¥),Ñes)

	)

402 
	#_IO_BE
(
ex¥
, 
ªs
Ë”x¥)

	)

405 
	#_IO_gëc_u∆ocked
(
_Â
) \

406 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

407 ? 
	`__uÊow
 (
_Â
Ë: *(*Ë(_Â)->
_IO_ªad_±r
++)

	)

408 
	#_IO_≥ekc_u∆ocked
(
_Â
) \

409 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

410 && 
	`__undîÊow
 (
_Â
Ë=
EOF
 ? EOF \

411 : *(*Ë(
_Â
)->
_IO_ªad_±r
)

	)

412 
	#_IO_putc_u∆ocked
(
_ch
, 
_Â
) \

413 (
	`_IO_BE
 ((
_Â
)->
_IO_wrôe_±r
 >(_Â)->
_IO_wrôe_íd
, 0) \

414 ? 
	`__ovîÊow
 (
_Â
, (Ë(
_ch
)) \

415 : (Ë(*(
_Â
)->
_IO_wrôe_±r
++ = (
_ch
)))

	)

417 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


418 
	#_IO_gëwc_u∆ocked
(
_Â
) \

419 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

420 || ((
_Â
)->
_wide_d©a
->
_IO_ªad_±r
 \

421 >(
_Â
)->
_wide_d©a
->
_IO_ªad_íd
), 0) \

422 ? 
	`__wuÊow
 (
_Â
Ë: (
_IO_wöt_t
Ë*(_Â)->
_wide_d©a
->
_IO_ªad_±r
++)

	)

423 
	#_IO_putwc_u∆ocked
(
_wch
, 
_Â
) \

424 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

425 || ((
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
 \

426 >(
_Â
)->
_wide_d©a
->
_IO_wrôe_íd
), 0) \

427 ? 
	`__wovîÊow
 (
_Â
, 
_wch
) \

428 : (
_IO_wöt_t
Ë(*(
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
++ = (
_wch
)))

	)

431 
	#_IO_„of_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_EOF_SEEN
Ë!0)

	)

432 
	#_IO_„º‹_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_ERR_SEEN
Ë!0)

	)

434 
_IO_gëc
 (
_IO_FILE
 *
__Â
);

435 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__Â
);

436 
_IO_„of
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

437 
_IO_„º‹
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

439 
_IO_≥ekc_locked
 (
_IO_FILE
 *
__Â
);

442 
	#_IO_PENDING_OUTPUT_COUNT
(
_Â
) \

443 ((
_Â
)->
_IO_wrôe_±r
 - (_Â)->
_IO_wrôe_ba£
)

	)

445 
_IO_Êockfûe
 (
_IO_FILE
 *Ë
__THROW
;

446 
_IO_fu∆ockfûe
 (
_IO_FILE
 *Ë
__THROW
;

447 
_IO_·rylockfûe
 (
_IO_FILE
 *Ë
__THROW
;

449 #ifde‡
_IO_MTSAFE_IO


450 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_locked
 (_Â)

	)

451 
	#_IO_Êockfûe
(
_Â
) \

452 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_Êockfûe
 (_Â)

	)

453 
	#_IO_fu∆ockfûe
(
_Â
) \

454 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_fu∆ockfûe
 (_Â)

	)

456 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_u∆ocked
 (_Â)

	)

457 
	#_IO_Êockfûe
(
_Â
Ë

	)

458 
	#_IO_fu∆ockfûe
(
_Â
Ë

	)

459 
	#_IO_·rylockfûe
(
_Â
Ë

	)

460 
	#_IO_˛ónup_ªgi⁄_°¨t
(
_f˘
, 
_Â
Ë

	)

461 
	#_IO_˛ónup_ªgi⁄_íd
(
_Doô
Ë

	)

464 
_IO_vfsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, const * __restrict,

465 
_IO_va_li°
, *
__ª°ri˘
);

466 
_IO_vÂrötf
 (
_IO_FILE
 *
__ª°ri˘
, const *__restrict,

467 
_IO_va_li°
);

468 
_IO_ssize_t
 
_IO_∑dn
 (
_IO_FILE
 *, , _IO_ssize_t);

469 
_IO_size_t
 
_IO_sgën
 (
_IO_FILE
 *, *, _IO_size_t);

471 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

472 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

474 
_IO_‰ì_backup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

476 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


477 
_IO_wöt_t
 
_IO_gëwc
 (
_IO_FILE
 *
__Â
);

478 
_IO_wöt_t
 
_IO_putwc
 (
wch¨_t
 
__wc
, 
_IO_FILE
 *
__Â
);

479 
_IO_fwide
 (
_IO_FILE
 *
__Â
, 
__mode
Ë
__THROW
;

480 #i‡
__GNUC__
 >= 2

483 #i‡
deföed
 
_LIBC
 && deföed 
SHARED


484 
	~<shlib-com∑t.h
>

485 #i‡
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

486 
	#_IO_fwide_maybe_öcom∑tibÀ
 \

487 (
	`__buûtö_ex≥˘
 (&
_IO_°dö_u£d
 =
NULL
, 0))

	)

488 c⁄° 
_IO_°dö_u£d
;

489 
wók_exã∫
 (
_IO_°dö_u£d
);

492 #i‚de‡
_IO_fwide_maybe_öcom∑tibÀ


493 
	#_IO_fwide_maybe_öcom∑tibÀ
 (0)

	)

497 
	#_IO_fwide
(
__Â
, 
__mode
) \

498 ({ 
__ªsu…
 = (
__mode
); \

499 i‡(
__ªsu…
 < 0 && ! 
_IO_fwide_maybe_öcom∑tibÀ
) \

501 i‡((
__Â
)->
_mode
 == 0) \

503 (
__Â
)->
_mode
 = -1; \

504 
__ªsu…
 = (
__Â
)->
_mode
; \

506 i‡(
	`__buûtö_c⁄°™t_p
 (
__mode
) && (__mode) == 0) \

507 
__ªsu…
 = 
_IO_fwide_maybe_öcom∑tibÀ
 ? -1 : (
__Â
)->
_mode
; \

509 
__ªsu…
 = 
	`_IO_fwide
 (
__Â
, __result); \

510 
__ªsu…
; })

	)

513 
_IO_vfwsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, c⁄° 
wch¨_t
 * __restrict,

514 
_IO_va_li°
, *
__ª°ri˘
);

515 
_IO_vfw¥ötf
 (
_IO_FILE
 *
__ª°ri˘
, c⁄° 
wch¨_t
 *__restrict,

516 
_IO_va_li°
);

517 
_IO_ssize_t
 
_IO_w∑dn
 (
_IO_FILE
 *, 
wöt_t
, _IO_ssize_t);

518 
_IO_‰ì_wbackup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

521 #ifde‡
__LDBL_COMPAT


522 
	~<bôs/libio-ldbl.h
>

525 #ifde‡
__˝lu•lus


	@/usr/include/rpc/netdb.h

36 #i‚de‡
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<„©uªs.h
>

41 
	#__√ed_size_t


	)

42 
	~<°ddef.h
>

44 
__BEGIN_DECLS


46 
	sΩ˚¡


48 *
	mr_«me
;

49 **
	mr_Æü£s
;

50 
	mr_numbî
;

53 
	$£åp˚¡
 (
__°ay›í
Ë
__THROW
;

54 
	$ídΩ˚¡
 (Ë
__THROW
;

55 
Ω˚¡
 *
	$gëΩcby«me
 (c⁄° *
__«me
Ë
__THROW
;

56 
Ω˚¡
 *
	$gëΩcbynumbî
 (
__numbî
Ë
__THROW
;

57 
Ω˚¡
 *
	$gëΩ˚¡
 (Ë
__THROW
;

59 #ifde‡
__USE_MISC


60 
	$gëΩcby«me_r
 (c⁄° *
__«me
, 
Ω˚¡
 *
__ªsu…_buf
,

61 *
__buf„r
, 
size_t
 
__buÊí
,

62 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

64 
	$gëΩcbynumbî_r
 (
__numbî
, 
Ω˚¡
 *
__ªsu…_buf
,

65 *
__buf„r
, 
size_t
 
__buÊí
,

66 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

68 
	$gëΩ˚¡_r
 (
Ω˚¡
 *
__ªsu…_buf
, *
__buf„r
,

69 
size_t
 
__buÊí
, 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

72 
__END_DECLS


	@/usr/include/stdint.h

22 #i‚de‡
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	~<„©uªs.h
>

26 
	~<bôs/wch¨.h
>

27 
	~<bôs/w‹dsize.h
>

34 #i‚de‡
__öt8_t_deföed


35 
	#__öt8_t_deföed


	)

36 sig√d 
	töt8_t
;

37 
	töt16_t
;

38 
	töt32_t
;

39 #i‡
__WORDSIZE
 == 64

40 
	töt64_t
;

42 
__exãnsi⁄__


43 
	töt64_t
;

48 
	tuöt8_t
;

49 
	tuöt16_t
;

50 #i‚de‡
__uöt32_t_deföed


51 
	tuöt32_t
;

52 
	#__uöt32_t_deföed


	)

54 #i‡
__WORDSIZE
 == 64

55 
	tuöt64_t
;

57 
__exãnsi⁄__


58 
	tuöt64_t
;

65 sig√d 
	töt_Àa°8_t
;

66 
	töt_Àa°16_t
;

67 
	töt_Àa°32_t
;

68 #i‡
__WORDSIZE
 == 64

69 
	töt_Àa°64_t
;

71 
__exãnsi⁄__


72 
	töt_Àa°64_t
;

76 
	tuöt_Àa°8_t
;

77 
	tuöt_Àa°16_t
;

78 
	tuöt_Àa°32_t
;

79 #i‡
__WORDSIZE
 == 64

80 
	tuöt_Àa°64_t
;

82 
__exãnsi⁄__


83 
	tuöt_Àa°64_t
;

90 sig√d 
	töt_Á°8_t
;

91 #i‡
__WORDSIZE
 == 64

92 
	töt_Á°16_t
;

93 
	töt_Á°32_t
;

94 
	töt_Á°64_t
;

96 
	töt_Á°16_t
;

97 
	töt_Á°32_t
;

98 
__exãnsi⁄__


99 
	töt_Á°64_t
;

103 
	tuöt_Á°8_t
;

104 #i‡
__WORDSIZE
 == 64

105 
	tuöt_Á°16_t
;

106 
	tuöt_Á°32_t
;

107 
	tuöt_Á°64_t
;

109 
	tuöt_Á°16_t
;

110 
	tuöt_Á°32_t
;

111 
__exãnsi⁄__


112 
	tuöt_Á°64_t
;

117 #i‡
__WORDSIZE
 == 64

118 #i‚de‡
__öçå_t_deföed


119 
	töçå_t
;

120 
	#__öçå_t_deföed


	)

122 
	tuöçå_t
;

124 #i‚de‡
__öçå_t_deföed


125 
	töçå_t
;

126 
	#__öçå_t_deföed


	)

128 
	tuöçå_t
;

133 #i‡
__WORDSIZE
 == 64

134 
	tötmax_t
;

135 
	tuötmax_t
;

137 
__exãnsi⁄__


138 
	tötmax_t
;

139 
__exãnsi⁄__


140 
	tuötmax_t
;

144 #i‡
__WORDSIZE
 == 64

145 
	#__INT64_C
(
c
Ë¯## 
L


	)

146 
	#__UINT64_C
(
c
Ë¯## 
UL


	)

148 
	#__INT64_C
(
c
Ë¯## 
LL


	)

149 
	#__UINT64_C
(
c
Ë¯## 
ULL


	)

155 
	#INT8_MIN
 (-128)

	)

156 
	#INT16_MIN
 (-32767-1)

	)

157 
	#INT32_MIN
 (-2147483647-1)

	)

158 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

160 
	#INT8_MAX
 (127)

	)

161 
	#INT16_MAX
 (32767)

	)

162 
	#INT32_MAX
 (2147483647)

	)

163 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

166 
	#UINT8_MAX
 (255)

	)

167 
	#UINT16_MAX
 (65535)

	)

168 
	#UINT32_MAX
 (4294967295U)

	)

169 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

173 
	#INT_LEAST8_MIN
 (-128)

	)

174 
	#INT_LEAST16_MIN
 (-32767-1)

	)

175 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

176 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

178 
	#INT_LEAST8_MAX
 (127)

	)

179 
	#INT_LEAST16_MAX
 (32767)

	)

180 
	#INT_LEAST32_MAX
 (2147483647)

	)

181 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

184 
	#UINT_LEAST8_MAX
 (255)

	)

185 
	#UINT_LEAST16_MAX
 (65535)

	)

186 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

187 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

191 
	#INT_FAST8_MIN
 (-128)

	)

192 #i‡
__WORDSIZE
 == 64

193 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

194 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

196 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

197 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

199 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

201 
	#INT_FAST8_MAX
 (127)

	)

202 #i‡
__WORDSIZE
 == 64

203 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

204 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

206 
	#INT_FAST16_MAX
 (2147483647)

	)

207 
	#INT_FAST32_MAX
 (2147483647)

	)

209 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINT_FAST8_MAX
 (255)

	)

213 #i‡
__WORDSIZE
 == 64

214 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

215 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

217 
	#UINT_FAST16_MAX
 (4294967295U)

	)

218 
	#UINT_FAST32_MAX
 (4294967295U)

	)

220 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

224 #i‡
__WORDSIZE
 == 64

225 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

226 
	#INTPTR_MAX
 (9223372036854775807L)

	)

227 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

229 
	#INTPTR_MIN
 (-2147483647-1)

	)

230 
	#INTPTR_MAX
 (2147483647)

	)

231 
	#UINTPTR_MAX
 (4294967295U)

	)

236 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

238 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

241 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

247 #i‡
__WORDSIZE
 == 64

248 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

249 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

251 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

252 
	#PTRDIFF_MAX
 (2147483647)

	)

256 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

257 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

260 #i‡
__WORDSIZE
 == 64

261 
	#SIZE_MAX
 (18446744073709551615UL)

	)

263 
	#SIZE_MAX
 (4294967295U)

	)

267 #i‚de‡
WCHAR_MIN


269 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

270 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

274 
	#WINT_MIN
 (0u)

	)

275 
	#WINT_MAX
 (4294967295u)

	)

278 
	#INT8_C
(
c
Ë
	)
c

279 
	#INT16_C
(
c
Ë
	)
c

280 
	#INT32_C
(
c
Ë
	)
c

281 #i‡
__WORDSIZE
 == 64

282 
	#INT64_C
(
c
Ë¯## 
L


	)

284 
	#INT64_C
(
c
Ë¯## 
LL


	)

288 
	#UINT8_C
(
c
Ë
	)
c

289 
	#UINT16_C
(
c
Ë
	)
c

290 
	#UINT32_C
(
c
Ë¯## 
U


	)

291 #i‡
__WORDSIZE
 == 64

292 
	#UINT64_C
(
c
Ë¯## 
UL


	)

294 
	#UINT64_C
(
c
Ë¯## 
ULL


	)

298 #i‡
__WORDSIZE
 == 64

299 
	#INTMAX_C
(
c
Ë¯## 
L


	)

300 
	#UINTMAX_C
(
c
Ë¯## 
UL


	)

302 
	#INTMAX_C
(
c
Ë¯## 
LL


	)

303 
	#UINTMAX_C
(
c
Ë¯## 
ULL


	)

	@/usr/include/xlocale.h

20 #i‚de‡
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loˇÀ_°ru˘


30 
__loˇÀ_d©a
 *
	m__loˇÀs
[13];

33 c⁄° *
	m__˘y≥_b
;

34 c⁄° *
	m__˘y≥_tﬁowî
;

35 c⁄° *
	m__˘y≥_touµî
;

38 c⁄° *
	m__«mes
[13];

39 } *
	t__loˇÀ_t
;

42 
__loˇÀ_t
 
	tloˇÀ_t
;

	@/usr/include/_G_config.h

4 #i‚de‡
_G_c⁄fig_h


5 
	#_G_c⁄fig_h
 1

	)

9 
	~<bôs/ty≥s.h
>

10 
	#__√ed_size_t


	)

11 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


12 
	#__√ed_wch¨_t


	)

14 
	#__√ed_NULL


	)

15 
	~<°ddef.h
>

16 
	#__√ed_mb°©e_t


	)

17 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


18 
	#__√ed_wöt_t


	)

20 
	~<wch¨.h
>

23 
__off_t
 
	m__pos
;

24 
__mb°©e_t
 
	m__°©e
;

25 } 
	t_G_Âos_t
;

28 
__off64_t
 
	m__pos
;

29 
__mb°©e_t
 
	m__°©e
;

30 } 
	t_G_Âos64_t
;

31 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


32 
	~<gc⁄v.h
>

35 
__gc⁄v_öfo
 
	m__cd
;

38 
__gc⁄v_öfo
 
	m__cd
;

39 
__gc⁄v_°ï_d©a
 
	m__d©a
;

40 } 
	m__comböed
;

41 } 
	t_G_ic⁄v_t
;

46 
	#_G_va_li°
 
__gnuc_va_li°


	)

48 
	#_G_HAVE_MMAP
 1

	)

49 
	#_G_HAVE_MREMAP
 1

	)

51 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

54 
	#_G_HAVE_ST_BLKSIZE
 
	`deföed
 (
_STATBUF_ST_BLKSIZE
)

	)

56 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/stdc-predef.h

18 #i‚def 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifde‡
__GCC_IEC_559


37 #i‡
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifde‡
__GCC_IEC_559_COMPLEX


45 #i‡
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

54 
	#__STDC_ISO_10646__
 201103L

	)

57 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/gconv.h

22 #i‚de‡
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<„©uªs.h
>

26 
	#__√ed_mb°©e_t


	)

27 
	#__√ed_wöt_t


	)

28 
	~<wch¨.h
>

29 
	#__√ed_size_t


	)

30 
	#__√ed_wch¨_t


	)

31 
	~<°ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¨_t
Ë0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004

64 
	g__gc⁄v_°ï
;

65 
	g__gc⁄v_°ï_d©a
;

66 
	g__gc⁄v_lﬂded_obje˘
;

67 
	g__gc⁄v_å™s_d©a
;

71 (*
	t__gc⁄v_f˘
Ë(
	t__gc⁄v_°ï
 *, 
	t__gc⁄v_°ï_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wöt_t
 (*
	t__gc⁄v_btowc_f˘
Ë(
	t__gc⁄v_°ï
 *, );

79 (*
	t__gc⁄v_öô_f˘
Ë(
	t__gc⁄v_°ï
 *);

80 (*
	t__gc⁄v_íd_f˘
Ë(
	t__gc⁄v_°ï
 *);

84 (*
	t__gc⁄v_å™s_f˘
Ë(
	t__gc⁄v_°ï
 *,

85 
	t__gc⁄v_°ï_d©a
 *, *,

89 
	tsize_t
 *);

92 (*
	t__gc⁄v_å™s_c⁄ãxt_f˘
) (*, const *,

97 (*
	t__gc⁄v_å™s_quîy_f˘
) (const *, const ***,

98 
	tsize_t
 *);

101 (*
	t__gc⁄v_å™s_öô_f˘
) (**, const *);

102 (*
	t__gc⁄v_å™s_íd_f˘
) (*);

104 
	s__gc⁄v_å™s_d©a


107 
__gc⁄v_å™s_f˘
 
__å™s_f˘
;

108 
__gc⁄v_å™s_c⁄ãxt_f˘
 
__å™s_c⁄ãxt_f˘
;

109 
__gc⁄v_å™s_íd_f˘
 
__å™s_íd_f˘
;

110 *
__d©a
;

111 
__gc⁄v_å™s_d©a
 *
__√xt
;

116 
	s__gc⁄v_°ï


118 
__gc⁄v_lﬂded_obje˘
 *
__shlib_h™dÀ
;

119 c⁄° *
__mod«me
;

121 
__cou¡î
;

123 *
__‰om_«me
;

124 *
__to_«me
;

126 
__gc⁄v_f˘
 
__f˘
;

127 
__gc⁄v_btowc_f˘
 
__btowc_f˘
;

128 
__gc⁄v_öô_f˘
 
__öô_f˘
;

129 
__gc⁄v_íd_f˘
 
__íd_f˘
;

133 
__mö_√eded_‰om
;

134 
__max_√eded_‰om
;

135 
__mö_√eded_to
;

136 
__max_√eded_to
;

139 
__°©eful
;

141 *
__d©a
;

146 
	s__gc⁄v_°ï_d©a


148 *
__outbuf
;

149 *
__outbu„nd
;

153 
__Êags
;

157 
__övoˇti⁄_cou¡î
;

161 
__öã∫Æ_u£
;

163 
__mb°©e_t
 *
__°©ï
;

164 
__mb°©e_t
 
__°©e
;

168 
__gc⁄v_å™s_d©a
 *
__å™s
;

173 
	s__gc⁄v_öfo


175 
size_t
 
__n°ïs
;

176 
__gc⁄v_°ï
 *
__°ïs
;

177 
__exãnsi⁄__
 
__gc⁄v_°ï_d©a
 
__d©a
 
__Êex¨r
;

178 } *
	t__gc⁄v_t
;

	@/usr/include/wchar.h

23 #i‚de‡
_WCHAR_H


25 #i‡!
deföed
 
__√ed_mb°©e_t
 && !deföed 
__√ed_wöt_t


26 
	#_WCHAR_H
 1

	)

27 
	~<„©uªs.h
>

30 #ifde‡
_WCHAR_H


32 
	#__√ed___FILE


	)

33 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


34 
	#__√ed_FILE


	)

36 
	~<°dio.h
>

38 
	#__√ed___va_li°


	)

39 
	~<°d¨g.h
>

41 
	~<bôs/wch¨.h
>

44 
	#__√ed_size_t


	)

45 
	#__√ed_wch¨_t


	)

46 
	#__√ed_NULL


	)

48 #i‡
deföed
 
_WCHAR_H
 || deföed 
__√ed_wöt_t
 || !deföed 
__WINT_TYPE__


49 #unde‡
__√ed_wöt_t


50 
	#__√ed_wöt_t


	)

51 
	~<°ddef.h
>

55 #i‚de‡
_WINT_T


60 
	#_WINT_T


	)

61 
	twöt_t
;

65 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES
 \

66 && 
deföed
 
__WINT_TYPE__


67 
__BEGIN_NAMESPACE_STD


68 
__WINT_TYPE__
 
	twöt_t
;

69 
	g__END_NAMESPACE_STD


74 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

75 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

79 #i‡(
deföed
 
_WCHAR_H
 || deföed 
__√ed_mb°©e_t
Ë&& !deföed 
____mb°©e_t_deföed


80 
	#____mb°©e_t_deföed
 1

	)

84 
	m__cou¡
;

87 #ifde‡
__WINT_TYPE__


88 
__WINT_TYPE__
 
	m__wch
;

90 
wöt_t
 
	m__wch
;

92 
	m__wchb
[4];

93 } 
	m__vÆue
;

94 } 
	t__mb°©e_t
;

96 #unde‡
__√ed_mb°©e_t


101 #ifde‡
_WCHAR_H


103 #i‚de‡
__mb°©e_t_deföed


104 
__BEGIN_NAMESPACE_C99


106 
__mb°©e_t
 
	tmb°©e_t
;

107 
	g__END_NAMESPACE_C99


108 
	#__mb°©e_t_deföed
 1

	)

111 #ifde‡
__USE_GNU


112 
	$__USING_NAMESPACE_C99
(
mb°©e_t
)

115 #i‚de‡
WCHAR_MIN


117 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

118 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

121 #i‚de‡
WEOF


122 
	#WEOF
 (0xffffffffu)

	)

127 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_UNIX98


128 
	~<w˘y≥.h
>

132 
__BEGIN_DECLS


134 
__BEGIN_NAMESPACE_STD


137 
tm
;

138 
__END_NAMESPACE_STD


142 
	$__USING_NAMESPACE_STD
(
tm
)

145 
__BEGIN_NAMESPACE_STD


147 
wch¨_t
 *
	$wcs˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

148 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

150 
wch¨_t
 *
	$wc¢˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

151 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

152 
__THROW
;

155 
wch¨_t
 *
	$wcsˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

156 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

158 
wch¨_t
 *
	$wc¢ˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

159 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

160 
__THROW
;

163 
	$wcscmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
)

164 
__THROW
 
__©åibuã_puª__
;

166 
	$wc¢cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

167 
__THROW
 
__©åibuã_puª__
;

168 
__END_NAMESPACE_STD


170 #ifde‡
__USE_XOPEN2K8


172 
	$wcsˇ£cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
Ë
__THROW
;

175 
	$wc¢ˇ£cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

176 
size_t
 
__n
Ë
__THROW
;

180 
	~<xloˇÀ.h
>

182 
	$wcsˇ£cmp_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

183 
__loˇÀ_t
 
__loc
Ë
__THROW
;

185 
	$wc¢ˇ£cmp_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

186 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

189 
__BEGIN_NAMESPACE_STD


192 
	$wcscﬁl
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
Ë
__THROW
;

196 
size_t
 
	$wcsx‰m
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

197 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

198 
__END_NAMESPACE_STD


200 #ifde‡
__USE_XOPEN2K8


206 
	$wcscﬁl_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

207 
__loˇÀ_t
 
__loc
Ë
__THROW
;

212 
size_t
 
	$wcsx‰m_l
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

213 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

216 
wch¨_t
 *
	$wcsdup
 (c⁄° 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_mÆloc__
;

219 
__BEGIN_NAMESPACE_STD


221 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


222 "C++" 
wch¨_t
 *
	$wcschr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

223 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

224 "C++" c⁄° 
wch¨_t
 *
	$wcschr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

225 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

227 
wch¨_t
 *
	$wcschr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

228 
__THROW
 
__©åibuã_puª__
;

231 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


232 "C++" 
wch¨_t
 *
	$wc§chr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

233 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

234 "C++" c⁄° 
wch¨_t
 *
	$wc§chr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

235 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

237 
wch¨_t
 *
	$wc§chr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

238 
__THROW
 
__©åibuã_puª__
;

240 
__END_NAMESPACE_STD


242 #ifde‡
__USE_GNU


245 
wch¨_t
 *
	$wcsch∫ul
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__wc
)

246 
__THROW
 
__©åibuã_puª__
;

249 
__BEGIN_NAMESPACE_STD


252 
size_t
 
	$wcsc•n
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ªje˘
)

253 
__THROW
 
__©åibuã_puª__
;

256 
size_t
 
	$wcs•n
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

257 
__THROW
 
__©åibuã_puª__
;

259 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


260 "C++" 
wch¨_t
 *
	$wc•brk
 (
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

261 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

262 "C++" c⁄° 
wch¨_t
 *
	$wc•brk
 (c⁄° 
wch¨_t
 *
__wcs
,

263 c⁄° 
wch¨_t
 *
__ac˚±
)

264 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

266 
wch¨_t
 *
	$wc•brk
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

267 
__THROW
 
__©åibuã_puª__
;

270 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


271 "C++" 
wch¨_t
 *
	$wcs°r
 (
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

272 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

273 "C++" c⁄° 
wch¨_t
 *
	$wcs°r
 (c⁄° 
wch¨_t
 *
__hay°ack
,

274 c⁄° 
wch¨_t
 *
__√edÀ
)

275 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

277 
wch¨_t
 *
	$wcs°r
 (c⁄° 
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

278 
__THROW
 
__©åibuã_puª__
;

282 
wch¨_t
 *
	$wc°ok
 (
wch¨_t
 *
__ª°ri˘
 
__s
,

283 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__dñim
,

284 
wch¨_t
 **
__ª°ri˘
 
__±r
Ë
__THROW
;

287 
size_t
 
	$wc¶í
 (c⁄° 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_puª__
;

288 
__END_NAMESPACE_STD


290 #ifde‡
__USE_XOPEN


292 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


293 "C++" 
wch¨_t
 *
	$wcswcs
 (
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

294 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

295 "C++" c⁄° 
wch¨_t
 *
	$wcswcs
 (c⁄° 
wch¨_t
 *
__hay°ack
,

296 c⁄° 
wch¨_t
 *
__√edÀ
)

297 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

299 
wch¨_t
 *
	$wcswcs
 (c⁄° 
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

300 
__THROW
 
__©åibuã_puª__
;

304 #ifde‡
__USE_XOPEN2K8


306 
size_t
 
	$wc¢Àn
 (c⁄° 
wch¨_t
 *
__s
, 
size_t
 
__maxÀn
)

307 
__THROW
 
__©åibuã_puª__
;

311 
__BEGIN_NAMESPACE_STD


313 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


314 "C++" 
wch¨_t
 *
	$wmemchr
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

316 "C++" c⁄° 
wch¨_t
 *
	$wmemchr
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__c
,

317 
size_t
 
__n
)

318 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

320 
wch¨_t
 *
	$wmemchr
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

321 
__THROW
 
__©åibuã_puª__
;

325 
	$wmemcmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

326 
__THROW
 
__©åibuã_puª__
;

329 
wch¨_t
 *
	$wmem˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

330 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

334 
wch¨_t
 *
	$wmemmove
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

335 
__THROW
;

338 
wch¨_t
 *
	$wmem£t
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
Ë
__THROW
;

339 
__END_NAMESPACE_STD


341 #ifde‡
__USE_GNU


344 
wch¨_t
 *
	$wmemp˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

345 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
)

346 
__THROW
;

350 
__BEGIN_NAMESPACE_STD


353 
wöt_t
 
	$btowc
 (
__c
Ë
__THROW
;

357 
	$w˘ob
 (
wöt_t
 
__c
Ë
__THROW
;

361 
	$mbsöô
 (c⁄° 
mb°©e_t
 *
__ps
Ë
__THROW
 
__©åibuã_puª__
;

365 
size_t
 
	$mbπowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

366 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

367 
mb°©e_t
 *
__ª°ri˘
 
__p
Ë
__THROW
;

370 
size_t
 
	$w¸tomb
 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wc
,

371 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

374 
size_t
 
	$__mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

375 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

376 
size_t
 
	$mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

377 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

378 
__END_NAMESPACE_STD


380 #ifde‡
__USE_EXTERN_INLINES


386 
wöt_t
 
	$__btowc_Æüs
 (
__c
Ë
	`__asm
 ("btowc");

387 
__exã∫_ölöe
 
wöt_t


388 
	`__NTH
 (
	$btowc
 (
__c
))

389 {  (
	`__buûtö_c⁄°™t_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

390 ? (
wöt_t
Ë
__c
 : 
	`__btowc_Æüs
 (__c)); 
	}
}

392 
	$__w˘ob_Æüs
 (
wöt_t
 
__c
Ë
	`__asm
 ("wctob");

393 
__exã∫_ölöe
 

394 
	`__NTH
 (
	$w˘ob
 (
wöt_t
 
__wc
))

395 {  (
	`__buûtö_c⁄°™t_p
 (
__wc
Ë&& __w¯>
L
'\0' && __wc <= L'\x7f'

396 ? (Ë
__wc
 : 
	`__w˘ob_Æüs
 (__wc)); 
	}
}

398 
__exã∫_ölöe
 
size_t


399 
__NTH
 (
	$mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

400 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

401 {  (
__ps
 !
NULL


402 ? 
	`mbπowc
 (
NULL
, 
__s
, 
__n
, 
__ps
Ë: 
	`__mbæí
 (__s, __n, NULL)); 
	}
}

405 
__BEGIN_NAMESPACE_STD


408 
size_t
 
	$mb§towcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

409 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

410 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

414 
size_t
 
	$wc§tombs
 (*
__ª°ri˘
 
__d°
,

415 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

416 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

417 
__END_NAMESPACE_STD


420 #ifdef 
__USE_XOPEN2K8


423 
size_t
 
	$mb¢πowcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

424 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

425 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

429 
size_t
 
	$wc¢πombs
 (*
__ª°ri˘
 
__d°
,

430 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

431 
size_t
 
__nwc
, size_à
__Àn
,

432 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

437 #ifde‡
__USE_XOPEN


439 
	$wcwidth
 (
wch¨_t
 
__c
Ë
__THROW
;

443 
	$wcswidth
 (c⁄° 
wch¨_t
 *
__s
, 
size_t
 
__n
Ë
__THROW
;

447 
__BEGIN_NAMESPACE_STD


450 
	$wc°od
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

451 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

452 
__END_NAMESPACE_STD


454 #ifde‡
__USE_ISOC99


455 
__BEGIN_NAMESPACE_C99


457 
	$wc°of
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

458 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

459 
	$wc°ﬁd
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

460 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

461 
__END_NAMESPACE_C99


465 
__BEGIN_NAMESPACE_STD


468 
	$wc°ﬁ
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

469 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

473 
	$wc°oul
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

474 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

475 
__THROW
;

476 
__END_NAMESPACE_STD


478 #ifde‡
__USE_ISOC99


479 
__BEGIN_NAMESPACE_C99


482 
__exãnsi⁄__


483 
	$wc°ﬁl
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

484 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

485 
__THROW
;

489 
__exãnsi⁄__


490 
	$wc°ouŒ
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

491 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

492 
__ba£
Ë
__THROW
;

493 
__END_NAMESPACE_C99


496 #ifde‡
__USE_GNU


499 
__exãnsi⁄__


500 
	$wc°oq
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

501 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

502 
__THROW
;

506 
__exãnsi⁄__


507 
	$wc°ouq
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

508 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

509 
__ba£
Ë
__THROW
;

512 #ifde‡
__USE_GNU


526 
	~<xloˇÀ.h
>

530 
	$wc°ﬁ_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

531 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

532 
__loˇÀ_t
 
__loc
Ë
__THROW
;

534 
	$wc°oul_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

535 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

536 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

538 
__exãnsi⁄__


539 
	$wc°ﬁl_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

540 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

541 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

543 
__exãnsi⁄__


544 
	$wc°ouŒ_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

545 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

546 
__ba£
, 
__loˇÀ_t
 
__loc
)

547 
__THROW
;

549 
	$wc°od_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

550 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

551 
__THROW
;

553 
	$wc°of_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

554 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

555 
__THROW
;

557 
	$wc°ﬁd_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

558 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

559 
__loˇÀ_t
 
__loc
Ë
__THROW
;

563 #ifde‡
__USE_XOPEN2K8


566 
wch¨_t
 *
	$w˝˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

567 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

571 
wch¨_t
 *
	$w˝n˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

572 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

573 
__THROW
;

580 
__FILE
 *
	$›í_wmem°ªam
 (
wch¨_t
 **
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
;

583 #i‡
deföed
 
__USE_ISOC95
 || deföed 
__USE_UNIX98


584 
__BEGIN_NAMESPACE_STD


587 
	$fwide
 (
__FILE
 *
__Â
, 
__mode
Ë
__THROW
;

594 
	`fw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

595 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

601 
	`w¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

604 
	$sw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

605 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

606 
__THROW
 ;

612 
	`vfw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__s
,

613 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

614 
__gnuc_va_li°
 
__¨g
)

620 
	`vw¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

621 
__gnuc_va_li°
 
__¨g
)

625 
	$vsw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

626 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

627 
__gnuc_va_li°
 
__¨g
)

628 
__THROW
 ;

635 
	`fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

636 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

642 
	`wsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

645 
	$swsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

646 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

647 
__THROW
 ;

649 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

650 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

651 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

652 #ifde‡
__REDIRECT


656 
	`__REDIRECT
 (
fwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__°ªam
,

657 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

658 
__isoc99_fwsˇnf
)

660 
	`__REDIRECT
 (
wsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

661 
__isoc99_wsˇnf
)

663 
	`__REDIRECT_NTH
 (
swsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

664 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

665 ...), 
__isoc99_swsˇnf
)

668 
	`__isoc99_fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

669 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

670 
	`__isoc99_wsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

671 
	$__isoc99_swsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

672 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

673 
__THROW
;

674 
	#fwsˇnf
 
__isoc99_fwsˇnf


	)

675 
	#wsˇnf
 
__isoc99_wsˇnf


	)

676 
	#swsˇnf
 
__isoc99_swsˇnf


	)

680 
__END_NAMESPACE_STD


683 #ifde‡
__USE_ISOC99


684 
__BEGIN_NAMESPACE_C99


689 
	`vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

690 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

691 
__gnuc_va_li°
 
__¨g
)

697 
	`vwsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

698 
__gnuc_va_li°
 
__¨g
)

701 
	$vswsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

702 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

703 
__gnuc_va_li°
 
__¨g
)

704 
__THROW
 ;

706 #i‡!
deföed
 
__USE_GNU
 \

707 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

708 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

709 #ifde‡
__REDIRECT


710 
	`__REDIRECT
 (
vfwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__s
,

711 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

712 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vfwsˇnf
)

714 
	`__REDIRECT
 (
vwsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

715 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vwsˇnf
)

717 
	`__REDIRECT_NTH
 (
vswsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

718 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

719 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vswsˇnf
)

722 
	`__isoc99_vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

723 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

724 
__gnuc_va_li°
 
__¨g
);

725 
	`__isoc99_vwsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

726 
__gnuc_va_li°
 
__¨g
);

727 
	$__isoc99_vswsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

728 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

729 
__gnuc_va_li°
 
__¨g
Ë
__THROW
;

730 
	#vfwsˇnf
 
__isoc99_vfwsˇnf


	)

731 
	#vwsˇnf
 
__isoc99_vwsˇnf


	)

732 
	#vswsˇnf
 
__isoc99_vswsˇnf


	)

736 
__END_NAMESPACE_C99


740 
__BEGIN_NAMESPACE_STD


745 
wöt_t
 
	`fgëwc
 (
__FILE
 *
__°ªam
);

746 
wöt_t
 
	`gëwc
 (
__FILE
 *
__°ªam
);

752 
wöt_t
 
	`gëwch¨
 ();

759 
wöt_t
 
	`Âutwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

760 
wöt_t
 
	`putwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

766 
wöt_t
 
	`putwch¨
 (
wch¨_t
 
__wc
);

774 
wch¨_t
 *
	`fgëws
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

775 
__FILE
 *
__ª°ri˘
 
__°ªam
);

781 
	`Âutws
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__ws
,

782 
__FILE
 *
__ª°ri˘
 
__°ªam
);

789 
wöt_t
 
	`ungëwc
 (wöt_à
__wc
, 
__FILE
 *
__°ªam
);

790 
__END_NAMESPACE_STD


793 #ifde‡
__USE_GNU


801 
wöt_t
 
	`gëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

802 
wöt_t
 
	`gëwch¨_u∆ocked
 ();

810 
wöt_t
 
	`fgëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

818 
wöt_t
 
	`Âutwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

827 
wöt_t
 
	`putwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

828 
wöt_t
 
	`putwch¨_u∆ocked
 (
wch¨_t
 
__wc
);

837 
wch¨_t
 *
	`fgëws_u∆ocked
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

838 
__FILE
 *
__ª°ri˘
 
__°ªam
);

846 
	`Âutws_u∆ocked
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__ws
,

847 
__FILE
 *
__ª°ri˘
 
__°ªam
);

851 
__BEGIN_NAMESPACE_C99


855 
size_t
 
	$wcs·ime
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

856 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

857 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

858 
__END_NAMESPACE_C99


860 #ifde‡
__USE_GNU


861 
	~<xloˇÀ.h
>

865 
size_t
 
	$wcs·ime_l
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

866 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

867 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

868 
__loˇÀ_t
 
__loc
Ë
__THROW
;

877 #i‡
deföed
 
__USE_UNIX98
 && !deföed 
__USE_GNU


878 
	#__√ed_iswxxx


	)

879 
	~<w˘y≥.h
>

883 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


884 
	~<bôs/wch¨2.h
>

887 #ifde‡
__LDBL_COMPAT


888 
	~<bôs/wch¨-ldbl.h
>

891 
__END_DECLS


899 #unde‡
__√ed_mb°©e_t


900 #unde‡
__√ed_wöt_t


	@/usr/include/wctype.h

23 #i‚de‡
_WCTYPE_H


25 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 #i‚de‡
__√ed_iswxxx


29 
	#_WCTYPE_H
 1

	)

32 
	#__√ed_wöt_t


	)

33 
	~<wch¨.h
>

37 #i‚de‡
WEOF


38 
	#WEOF
 (0xffffffffu)

	)

41 #unde‡
__√ed_iswxxx


46 #i‚de‡
__iswxxx_deföed


47 
	#__iswxxx_deföed
 1

	)

49 
__BEGIN_NAMESPACE_C99


52 
	tw˘y≥_t
;

53 
	g__END_NAMESPACE_C99


55 #i‚de‡
_ISwbô


60 
	~<ídün.h
>

61 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


62 
	#_ISwbô
(
bô
Ë(1 << (bô))

	)

64 
	#_ISwbô
(
bô
) \

65 ((
bô
) < 8 ? () ((1UL << (bit)) << 24) \

66 : ((
bô
) < 16 ? () ((1UL << (bit)) << 8) \

67 : ((
bô
) < 24 ? () ((1UL << (bit)) >> 8) \

68 : (Ë((1UL << (
bô
)Ë>> 24))))

	)

73 
	m__ISwuµî
 = 0,

74 
	m__ISwlowî
 = 1,

75 
	m__ISwÆpha
 = 2,

76 
	m__ISwdigô
 = 3,

77 
	m__ISwxdigô
 = 4,

78 
	m__ISw•a˚
 = 5,

79 
	m__ISw¥öt
 = 6,

80 
	m__ISwgøph
 = 7,

81 
	m__ISwbœnk
 = 8,

82 
	m__ISw˙ål
 = 9,

83 
	m__ISwpun˘
 = 10,

84 
	m__ISwÆnum
 = 11,

86 
	m_ISwuµî
 = 
_ISwbô
 (
__ISwuµî
),

87 
	m_ISwlowî
 = 
_ISwbô
 (
__ISwlowî
),

88 
	m_ISwÆpha
 = 
_ISwbô
 (
__ISwÆpha
),

89 
	m_ISwdigô
 = 
_ISwbô
 (
__ISwdigô
),

90 
	m_ISwxdigô
 = 
_ISwbô
 (
__ISwxdigô
),

91 
	m_ISw•a˚
 = 
_ISwbô
 (
__ISw•a˚
),

92 
	m_ISw¥öt
 = 
_ISwbô
 (
__ISw¥öt
),

93 
	m_ISwgøph
 = 
_ISwbô
 (
__ISwgøph
),

94 
	m_ISwbœnk
 = 
_ISwbô
 (
__ISwbœnk
),

95 
	m_ISw˙ål
 = 
_ISwbô
 (
__ISw˙ål
),

96 
	m_ISwpun˘
 = 
_ISwbô
 (
__ISwpun˘
),

97 
	m_ISwÆnum
 = 
_ISwbô
 (
__ISwÆnum
)

102 
__BEGIN_DECLS


104 
__BEGIN_NAMESPACE_C99


111 
	$iswÆnum
 (
wöt_t
 
__wc
Ë
__THROW
;

117 
	$iswÆpha
 (
wöt_t
 
__wc
Ë
__THROW
;

120 
	$isw˙ål
 (
wöt_t
 
__wc
Ë
__THROW
;

124 
	$iswdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

128 
	$iswgøph
 (
wöt_t
 
__wc
Ë
__THROW
;

133 
	$iswlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

136 
	$isw¥öt
 (
wöt_t
 
__wc
Ë
__THROW
;

141 
	$iswpun˘
 (
wöt_t
 
__wc
Ë
__THROW
;

146 
	$isw•a˚
 (
wöt_t
 
__wc
Ë
__THROW
;

151 
	$iswuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

156 
	$iswxdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

161 #ifde‡
__USE_ISOC99


162 
	$iswbœnk
 (
wöt_t
 
__wc
Ë
__THROW
;

171 
w˘y≥_t
 
	$w˘y≥
 (c⁄° *
__¥›îty
Ë
__THROW
;

175 
	$isw˘y≥
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
Ë
__THROW
;

176 
__END_NAMESPACE_C99


183 
__BEGIN_NAMESPACE_C99


186 c⁄° 
	t__öt32_t
 *
	tw˘øns_t
;

187 
__END_NAMESPACE_C99


188 #ifde‡
__USE_GNU


189 
	$__USING_NAMESPACE_C99
(
w˘øns_t
)

192 
__BEGIN_NAMESPACE_C99


194 
wöt_t
 
	$towlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

197 
wöt_t
 
	$towuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

198 
__END_NAMESPACE_C99


200 
__END_DECLS


207 #ifde‡
_WCTYPE_H


213 
__BEGIN_DECLS


215 
__BEGIN_NAMESPACE_C99


218 
w˘øns_t
 
	$w˘øns
 (c⁄° *
__¥›îty
Ë
__THROW
;

221 
wöt_t
 
	$tow˘øns
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
Ë
__THROW
;

222 
__END_NAMESPACE_C99


224 #ifde‡
__USE_XOPEN2K8


226 
	~<xloˇÀ.h
>

230 
	$iswÆnum_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

236 
	$iswÆpha_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

239 
	$isw˙ål_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

243 
	$iswdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

247 
	$iswgøph_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

252 
	$iswlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

255 
	$isw¥öt_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

260 
	$iswpun˘_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

265 
	$isw•a˚_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

270 
	$iswuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

275 
	$iswxdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

280 
	$iswbœnk_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

284 
w˘y≥_t
 
	$w˘y≥_l
 (c⁄° *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

285 
__THROW
;

289 
	$isw˘y≥_l
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
, 
__loˇÀ_t
 
__loˇÀ
)

290 
__THROW
;

298 
wöt_t
 
	$towlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

301 
wöt_t
 
	$towuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

305 
w˘øns_t
 
	$w˘øns_l
 (c⁄° *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

306 
__THROW
;

309 
wöt_t
 
	$tow˘øns_l
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
,

310 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

314 
__END_DECLS


	@
1
.
1
/usr/include
158
2437
alloca.c
alloca.h
array.c
backend.c
bibopmalloc.c
bibopmalloc.h
binaries.c
binaries.h
call_out.c
call_out.h
clib/efun.c
clib/gl_language.c
clib/stdobject.c
comm.h
comm1.c
comm1.h
config.h
debug.c
debugmalloc.c
dmalloc.c
doc/function_references/for_each.c
doc/function_references/funtest.c
drand48.c
drand48.h
ed.c
exec.h
func_spec.c
gc.c
genfkntab.c
gmalloc.c
hash.c
hash.h
hname.c
hname.h
incralloc.h
inline_eqs.h
inline_svalue.h
instrs.h
interface.c
interface.h
interpret.c
interpret.h
lex.c
lex.h
lint.h
main.c
main.h
make_func.y
make_table.c
mapping.c
mapping.h
mstring.c
mstring.h
mudstat.c
mudstat.h
ndesc.c
ndesc.h
net.c
net.h
nqueue.c
nqueue.h
object.c
object.h
otable.c
parse.c
patchlevel.h
port.c
postlang.y
prelang.y
regexp.c
regexp.h
regress/secure/auto.c
regress/secure/master.c
regress/secure/simul_efun.c
regress/secure/vbfc_object.c
regress/tests/base.c
regress/tests/functions.c
regress/tests/test-001.c
regress/tests/test-002.c
regress/tests/test-003.c
regress/tests/test-004.c
regress/tests/test-005.c
regress/tests/test-006.c
regress/tests/test-007.c
regress/tests/test-008.c
regress/tests/test-009.c
regress/tests/test-010.c
regress/tests/test-011.c
regress/tests/test-012.c
regress/tests/test-013.c
regress/tests/test-014.c
regress/tests/test-015.c
regress/tests/test-016.c
regress/tests/test-017.c
regress/tests/test-018.c
regress/tests/test-019.c
regress/tests/test-020.c
regress/tests/test-021.c
regress/tests/test-022.c
regress/tests/xyzzy.c
sent.h
signals.c
signals.h
simul_efun.c
simulate.c
simulate.h
smalloc.c
snprintf.c
sprintf.c
strerror.c
strpbrk.c
strtod.c
super_snoop.c
super_snoop.h
swap.c
swap.h
sysmalloc.c
tcpsvc.c
tcpsvc.h
telnet.c
telnet.h
ualarm.c
udpsvc.c
udpsvc.h
util/hname.c
vprintf.c
wildmat.c
/usr/include/arpa/inet.h
/usr/include/arpa/telnet.h
/usr/include/ctype.h
/usr/include/dirent.h
/usr/include/errno.h
/usr/include/fcntl.h
/usr/include/limits.h
/usr/include/malloc.h
/usr/include/math.h
/usr/include/memory.h
/usr/include/netdb.h
/usr/include/netinet/in.h
/usr/include/setjmp.h
/usr/include/signal.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/endian.h
/usr/include/features.h
/usr/include/getopt.h
/usr/include/libio.h
/usr/include/rpc/netdb.h
/usr/include/stdint.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/stdc-predef.h
/usr/include/gconv.h
/usr/include/wchar.h
/usr/include/wctype.h
